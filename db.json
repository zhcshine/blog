{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/next/source/js/affix.js","path":"js/affix.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/js.cookie.js","path":"js/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/algolia-search.js","path":"js/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/exturl.js","path":"js/exturl.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/scrollspy.js","path":"js/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/next-boot.js","path":"js/next-boot.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/post-details.js","path":"js/post-details.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/scroll-cookie.js","path":"js/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/schemes/pisces.js","path":"js/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/README.md","path":"lib/needsharebutton/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/LICENSE","path":"lib/needsharebutton/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","path":"lib/needsharebutton/needsharebutton.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","path":"lib/needsharebutton/needsharebutton.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1}],"Cache":[{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1563878031931},{"_id":"themes/next/.all-contributorsrc","hash":"5bb216803dfae519400901569a32b23020a6d621","modified":1563878031931},{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1563878031931},{"_id":"themes/next/.eslintrc.json","hash":"cc5f297f0322672fe3f684f823bc4659e4a54c41","modified":1563878031931},{"_id":"themes/next/.gitattributes","hash":"a54f902957d49356376b59287b894b1a3d7a003f","modified":1563878031931},{"_id":"themes/next/.gitignore","hash":"b80cec1d5e6a73d1cec382aad8046d1352a1e963","modified":1563878031931},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1563878031931},{"_id":"themes/next/LICENSE.md","hash":"18144d8ed58c75af66cb419d54f3f63374cd5c5b","modified":1563878031931},{"_id":"themes/next/.travis.yml","hash":"3d1dc928c4a97933e64379cfde749dedf62f252c","modified":1563878031931},{"_id":"themes/next/bower.json","hash":"e6a80b9ed2d618d1cca5781952c67167a7cfac07","modified":1563878031934},{"_id":"themes/next/_config.yml","hash":"fee173eec13fd4a6e93c76ec2cde52143cddbf83","modified":1564016882136},{"_id":"themes/next/README.md","hash":"2fcc7621e898732ef7976b89ca2511f84c577c35","modified":1563878031934},{"_id":"themes/next/crowdin.yml","hash":"e026078448c77dcdd9ef50256bb6635a8f83dca6","modified":1563878031934},{"_id":"themes/next/gulpfile.coffee","hash":"899001c864f975082ca1bc6b3fe3c614007baf8a","modified":1563878031934},{"_id":"themes/next/package.json","hash":"abefbba4150026ec8b3d8e79c7e874964bd3dc76","modified":1563878031937},{"_id":"source/_posts/apache入门基础.md","hash":"db33cf4cd92d1cddefdf3c1522dd0a042a8373b3","modified":1563931449746},{"_id":"source/adadd/index.md","hash":"9c57d061635a0bb25a2c8750a06a7a347669d012","modified":1563861103850},{"_id":"source/_drafts/Window常用软件，网站及其使用方法.md","hash":"e27b0ebc5dcdd6131860ea07c3255cc0686ab581","modified":1563861103850},{"_id":"source/_posts/centos7.2使用rabbitMQ.md","hash":"11e77b05e20b5a0b33f743cf36be8e0513cd5f67","modified":1563861103850},{"_id":"source/_posts/centos7.2安装及使用docker.md","hash":"30b95071128e47c28cf050214540847edb79b92b","modified":1563861103850},{"_id":"source/_posts/centos7服务器基础配置.md","hash":"6e992bc3a12ae97fd9eb484fbb500ea2acde0f0f","modified":1564744090459},{"_id":"source/_posts/centos7.2安装使用sentry.md","hash":"85c91bbb682e1e22705c96ee61cef9c933c7cad3","modified":1563861103850},{"_id":"source/_posts/centos安装s_h_a_d_o_w_s_o_c_k_s服务.md","hash":"dd5db87af23422ec7663e7c9885330ef4e1deb2f","modified":1563931472490},{"_id":"source/_posts/css兼容性汇总.md","hash":"0134bac64cb73e4478d6b6ceb3b271e17a4378be","modified":1563931472476},{"_id":"source/_posts/centos7.2安装使用openResty.md","hash":"6da727cbbd4ecfec94de930633ab12f0a0366816","modified":1563861103850},{"_id":"source/_posts/django入门基础.md","hash":"9078ee5b1a9d058c4b6d6887a7452455c6a03593","modified":1563931547823},{"_id":"source/_posts/c开发gtk+-入门基础.md","hash":"ff5839e634bd7dae3051a6edc243cdc17f8e09e3","modified":1564128422461},{"_id":"source/_posts/django环境部署.md","hash":"face26e872409a4480e3c83fa44c19eb5bcd3b2e","modified":1564744157542},{"_id":"source/_posts/excel入门基础.md","hash":"fab368a0fc8cf5bedfd1f37d706a76a342efac91","modified":1563931547833},{"_id":"source/_posts/ffmpeg命令基础.md","hash":"864f870e2a65d508f117338029108b048811d22e","modified":1563931144256},{"_id":"source/_posts/ffmpeg封装与解封装基础.md","hash":"8611d843a70da5f7a1541a2c6794392a5fa9a22b","modified":1563931247723},{"_id":"source/_posts/ffmpeg滤镜基础.md","hash":"899ea44bc3e9f93254573dcdb5ca8b88924130ed","modified":1563931144270},{"_id":"source/_posts/ffmpeg直播基础.md","hash":"e9ab06da53ad72d784f982913c9dce0c14c1b93c","modified":1563931196380},{"_id":"source/_posts/ffmpeg录制基础.md","hash":"c2e42d7cc16abdc16077685d6e10fc4a2137d520","modified":1563933300296},{"_id":"source/_posts/ffmpeg视频基础.md","hash":"1bd4682c57b0c07348f49ba5e628b75954aff556","modified":1563931001880},{"_id":"source/_posts/ffmpeg音频基础.md","hash":"8830e60355ee82c92e96926f383cf454b0069201","modified":1563930909376},{"_id":"source/_posts/git入门基础.md","hash":"353dfff38e0f7bb45f247ed08225d4ba10eb3165","modified":1563931566416},{"_id":"source/_posts/java入门基础.md","hash":"821e092c9066dd5458036060a476e165ba131b79","modified":1563931608603},{"_id":"source/_posts/jetbrains使用配置.md","hash":"bd6a724c7dcaf69ab6ddb4b06602f15aa6079997","modified":1563931616666},{"_id":"source/_posts/linux命令记录.md","hash":"9ab030e1508f8fcd9a853709f6f3dda4fb7d8ebb","modified":1563962719961},{"_id":"source/_posts/javascript入门基础.md","hash":"1e09b30eb4368c93ed32e8159ecd8280e5678353","modified":1563931586183},{"_id":"source/_posts/linux守护进程.md","hash":"d294666b580dd3b8dcc8fcaca63d70194554d9cc","modified":1564128422477},{"_id":"source/_posts/mysql主从复制.md","hash":"7dd1d7aee2dab5ffb477bd89f54e215b2bf38dd6","modified":1563931658890},{"_id":"source/_posts/centos7创建nagios监控集群服务.md","hash":"4ac9e04c45e81320694072e2388e0dc70c985975","modified":1563861103847},{"_id":"source/_posts/node入门基础.md","hash":"bddd814288ad4a485eb292bb30b051f6cf76efa4","modified":1564128422471},{"_id":"source/_posts/oracle virtualbox入门基础.md","hash":"c1866b3bf30150930c9d9c74f2d1705553c75272","modified":1563931731966},{"_id":"source/_posts/php将pdf转为jpg，png图片.md","hash":"68939e1c13d00043cdf4d7db03af179fff2a3ab8","modified":1563931752170},{"_id":"source/_posts/pythontkinter入门基础.md","hash":"7bbd1d2bd0513f74541526283188bd55cec4cc6c","modified":1563932239180},{"_id":"source/_posts/postgresql入门基础.md","hash":"6c0a5800781c249e5af9cc2d57f026e57024c874","modified":1563949481084},{"_id":"source/_posts/python从excel导出数据并批量替换word文档内容.md","hash":"e4f30ea1c540850008b2ea5c1b1e872a948e68c1","modified":1563932223210},{"_id":"source/_posts/python入门基础.md","hash":"b68d86a005080a62dfff087a20612e17b8e3fbbb","modified":1563931872816},{"_id":"source/_posts/python将office word 转为html 并提取相关图片信息.md","hash":"a5c8fef682b61e6ce05ae7a6855a0defb2ea8546","modified":1563931970250},{"_id":"source/_posts/minicat-manjaro-18-0-4-dev.md","hash":"eb6ee2b030f335f4ea9cb07c48d46039d94af92c","modified":1564127926167},{"_id":"source/_posts/redis基础.md","hash":"e80a3320fb397b2a43466e7a63342a5716a803c4","modified":1563932000923},{"_id":"source/_posts/centos7配置keepalived实现高可用集群.md","hash":"15ee758e3f11d6ab548c99f6f1b3c6d29a6de0af","modified":1563861103847},{"_id":"source/_posts/python爬虫scrapy框架入门基础.md","hash":"4d9d2e04d2d6d8bc66cab944c09c9efb8e65a55f","modified":1563931989180},{"_id":"source/_posts/selenium入门基础.md","hash":"0d4da7bdd018671a740c3fe9ac33b7ea4a3261ee","modified":1563932036506},{"_id":"source/_posts/rsync同步web服务器.md","hash":"78edcf7b32363045816ac25fd271a21b9a482ed3","modified":1563932022843},{"_id":"source/_posts/sublime入门基础.md","hash":"874da8e6f60e6d498124111c415fbf244be12b26","modified":1563932055320},{"_id":"source/_posts/thinkphp入门基础.md","hash":"4e14143411f39582a0abe544d09c9dbcdf24c38b","modified":1563932075226},{"_id":"source/_posts/linux开发环境常用软件.md","hash":"e00ed674a16ddba9baa88b8970d6976b447867b5","modified":1563861103847},{"_id":"source/_posts/mysql入门基础.md","hash":"51c00fd61513065234a9eafb23edddd767e7134e","modified":1564365550494},{"_id":"source/_posts/ubuntu14.04服务器基础配置.md","hash":"596ad36dd38c0f27450884a52e305be093feb476","modified":1563861103847},{"_id":"source/_posts/ubuntu16.04安装及使用SVN.md","hash":"93e407b7ee654897f7ff14b5500bd1e9671c7b41","modified":1563861103850},{"_id":"source/_posts/ubuntu配置Gitlab服务.md","hash":"72623d530264451b9f015620f96d4a1e8c238acf","modified":1563879549597},{"_id":"source/_posts/linux环境nginx-php-fpm权限问题.md","hash":"fd850fbb87e724b89dd9681eba8f8ffa9d859024","modified":1563932183340},{"_id":"source/_posts/unittest单元测试.md","hash":"7351b8dc43e85665fd19a7a53e56baf1243e9c65","modified":1563932107600},{"_id":"source/_posts/windowsserver服务器基础设置.md","hash":"2954cbe2fd024499901bb18007a7fda7e64fe63f","modified":1563932202606},{"_id":"source/_posts/windows软件运行时错误429,ACTIVEX部件不能创建对象的解决方法.md","hash":"b6d215a7ac7a458cc92a2c639d8a69e0f1cce803","modified":1563932120850},{"_id":"source/_posts/window常用软件.md","hash":"aa1b59ac4ca35e9b16ba0fdf4b1a8acf1e476023","modified":1563932134620},{"_id":"source/_posts/wireshark抓包基础.md","hash":"ea0da3536877a38e3cfcfc2cd0976b8852ad3216","modified":1563932145666},{"_id":"source/_posts/wordpress插件开发基础入门.md","hash":"6d61273a4873d597ff971f4a7b4538711e602f93","modified":1563932155020},{"_id":"source/_posts/zabbix入门基础.md","hash":"c032eae8b9fe323d381aba2232bfea0aca57823f","modified":1563932170136},{"_id":"source/_posts/局域网部分电脑不能连接网络,局域网共享文件夹,打印机等情况.md","hash":"71305748d1a53a56c0f211ee335dc9295fe6d11d","modified":1563864641023},{"_id":"source/_posts/vuejs.md","hash":"2cd7a3110cabb2a4f5d8231f8089827a955eb946","modified":1563861103850},{"_id":"source/_posts/ubuntu本地配置SSL.md","hash":"02d2fb522db1aa5f210d555da19fc4a6675edc95","modified":1563861103847},{"_id":"source/_posts/ubuntu16.04安装及使用docker(一).md","hash":"6695f855b509a1fa7af91c31a575425f46c7f363","modified":1563861103847},{"_id":"source/_posts/微信本地开发及线上环境搭建.md","hash":"0cb1cfbb6cba4f130204fec969bff8daa7720d54","modified":1563861103847},{"_id":"source/_posts/最新在linux-ubuntu中安装qq的办法.md","hash":"4f43e7bd8696a2b474bee2ea1462088ced55199b","modified":1563861103847},{"_id":"source/sample-page/index.md","hash":"508f79919f59d5856fba8fd090289beef7cee8b6","modified":1563861103850},{"_id":"source/_posts/硬链接软链接方式.md","hash":"78574c882cb4e2b11af8296721ab547cbb79e5b1","modified":1563861103847},{"_id":"themes/next/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1563878031931},{"_id":"themes/next/.git/COMMIT_EDITMSG","hash":"1fc1ecc6f5383154b921e7b90209517e89923ae7","modified":1564017525050},{"_id":"themes/next/.git/config","hash":"3aa58ad32c5b537b7b64d00c59cc2787e74a3fd2","modified":1563878031931},{"_id":"themes/next/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1563877954734},{"_id":"themes/next/.git/index","hash":"1b4f25d3cfbefefdc67e1ec53e552053aa6a4e57","modified":1564017525050},{"_id":"themes/next/.git/packed-refs","hash":"46868a1939ddb5713ec97b676cd19ce7982e045a","modified":1563878031927},{"_id":"themes/next/layout/_layout.swig","hash":"cacd1eb993458ad76741707186b7a468e3f2ce9e","modified":1563878031934},{"_id":"themes/next/layout/archive.swig","hash":"7e8f3a41a68e912f2b2aaba905d314306ccaf794","modified":1563878031937},{"_id":"themes/next/layout/category.swig","hash":"dda0e6b2139decaf5e865d22ec9d45fdb615a703","modified":1563878031937},{"_id":"themes/next/layout/page.swig","hash":"29c64c7031aaf276d3d11cdf2e95025996fd6eed","modified":1563878031937},{"_id":"themes/next/layout/schedule.swig","hash":"3268dd3d90d8b0e142cfa1a2ebb23355baeda148","modified":1563878031937},{"_id":"themes/next/layout/index.swig","hash":"9b4733d037c360e8504645b1d6c6dd17817c9d7b","modified":1563878031937},{"_id":"themes/next/layout/tag.swig","hash":"a6be69a90924c9d2f4d90fb4867234859bd2c2e9","modified":1563878031937},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"c149f003d03501565e7688915cd8f2e99fbf8f42","modified":1563878031931},{"_id":"themes/next/layout/post.swig","hash":"f74929fd792541916eb25c2addfb35431be071ba","modified":1563878031937},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"d366609651386c65ee842d47d10d7cf971790383","modified":1563878031931},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"3239625bb2573e61f7bcce27a74882a9ff7021e9","modified":1563878031931},{"_id":"themes/next/.github/auto_assign.yml","hash":"cb68a1dca1c4623448c2ca899614a9f21df1b036","modified":1563878031931},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"00c25366764e6b9ccb40b877c60dc13b2916bbf7","modified":1563878031931},{"_id":"themes/next/.github/eslint-disable-bot.yml","hash":"16541fb7b80f5ab90135db96285badb63c4d7d3e","modified":1563878031931},{"_id":"themes/next/.github/config.yml","hash":"8a5cbf5aa9529390fe0a782758aca9c3a02f9dcf","modified":1563878031931},{"_id":"themes/next/.github/lock.yml","hash":"585d2c471047be320aa62f2b74dad797bf09c530","modified":1563878031931},{"_id":"themes/next/.github/mergeable.yml","hash":"0ee56e23bbc71e1e76427d2bd255a9879bd36e22","modified":1563878031931},{"_id":"themes/next/.github/release-drafter.yml","hash":"c9fdbbdf712327a8ae1ed5972973a75802e245bc","modified":1563878031931},{"_id":"themes/next/.github/topissuebot.yml","hash":"10665bf2b5aba351725715c71e94ad183a0e8f18","modified":1563878031931},{"_id":"themes/next/.github/stale.yml","hash":"41bf97ee86b8940a0b2e754499ec77fd2b44b717","modified":1563878031931},{"_id":"themes/next/docs/ALGOLIA-SEARCH.md","hash":"4094dab82cbdfdd0de117e94b508bbd5ceb3d363","modified":1563878031934},{"_id":"themes/next/.github/weekly-digest.yml","hash":"404e4ccb7fcd6587bc9b0247a7a7ff256d21f2cb","modified":1563878031931},{"_id":"themes/next/docs/AGPL3.md","hash":"0d2b8c5fa8a614723be0767cc3bca39c49578036","modified":1563878031934},{"_id":"themes/next/docs/DATA-FILES.md","hash":"8e1962dd3e1b700169b3ae5bba43992f100651ce","modified":1563878031934},{"_id":"themes/next/docs/LICENSE.txt","hash":"368bf2c29d70f27d8726dd914f1b3211cae4bbab","modified":1563878031934},{"_id":"themes/next/docs/LEANCLOUD-COUNTER-SECURITY.md","hash":"b8fa118856f6992f7416697c4b96531b7c9816a0","modified":1563878031934},{"_id":"themes/next/docs/INSTALLATION.md","hash":"2bbdd6c1751b2b42ce9b9335da420c6026a483e9","modified":1563878031934},{"_id":"themes/next/docs/MATH.md","hash":"026d2cff73c22a30ea39c50783557ff4913aceac","modified":1563878031934},{"_id":"themes/next/scripts/injects-point.js","hash":"e6ef2f179c4d52d3175e655f9725d6195b5be51b","modified":1563878031937},{"_id":"themes/next/scripts/injects.js","hash":"f11bf387782cc0fcc8e64a374abbcad5b9e080c8","modified":1563878031937},{"_id":"themes/next/scripts/merge-configs.js","hash":"54323fa067de90fda60de982f149299f1248d801","modified":1563878031937},{"_id":"themes/next/.github/support.yml","hash":"d75db6ffa7b4ca3b865a925f9de9aef3fc51925c","modified":1563878031931},{"_id":"themes/next/docs/UPDATE-FROM-5.1.X.md","hash":"a07ca23c38f6e4dddd4b74016b30e88cd3796f75","modified":1563878031934},{"_id":"themes/next/languages/de.yml","hash":"88dcfa3e53cef1b7f858f98ca9f980179169ae4c","modified":1563878031934},{"_id":"themes/next/docs/AUTHORS.md","hash":"826a0fbd3789afbfb2d713acd155a572665cf540","modified":1563878031934},{"_id":"themes/next/languages/default.yml","hash":"c540c3a0d7db2d4239293c8783881962640b6c34","modified":1563878031934},{"_id":"themes/next/languages/en.yml","hash":"c540c3a0d7db2d4239293c8783881962640b6c34","modified":1563878031934},{"_id":"themes/next/languages/es.yml","hash":"a5203c7bbae70bc40f2ee526f9e8105ca9be851e","modified":1563878031934},{"_id":"themes/next/languages/id.yml","hash":"3a9f4485e6801e0e6fae749133a52e3797760795","modified":1563878031934},{"_id":"themes/next/languages/fa.yml","hash":"cc1f3a13e020e2cc666ddc57aaebc4c1ebd669d0","modified":1563878031934},{"_id":"themes/next/languages/fr.yml","hash":"c1e2e892c678920854e1f3df409118398523849e","modified":1563878031934},{"_id":"themes/next/languages/it.yml","hash":"28ff9197a3d21e838e33bb026d8adb544320cb1a","modified":1563878031934},{"_id":"themes/next/languages/ja.yml","hash":"8f85a6500716191159f16c7f484ba61ddd16eeb6","modified":1563878031934},{"_id":"themes/next/languages/ko.yml","hash":"1df31bf037bcb6868a4bd60c49ff55eec5b8167f","modified":1563878031934},{"_id":"themes/next/languages/hu.yml","hash":"3b4c10c86a228da70dc4b1a1784a6f942e186032","modified":1563878031934},{"_id":"themes/next/languages/nl.yml","hash":"6f4a339ecc67a140f3f9c7bec369cbda6b45afd7","modified":1563878031934},{"_id":"themes/next/languages/ru.yml","hash":"93872ac01074159566ee3e1738eea6e9216bab8e","modified":1563878031934},{"_id":"themes/next/languages/pt.yml","hash":"6d87701443e33a13574049e613f064f1eb250c95","modified":1563878031934},{"_id":"themes/next/languages/pt-BR.yml","hash":"301a0535df5de7b585c7c9752053c41c6ef26f9b","modified":1563878031934},{"_id":"themes/next/languages/tr.yml","hash":"5489606e6c40c0b226a3414c8e5037aac965211d","modified":1563878031934},{"_id":"themes/next/languages/uk.yml","hash":"765ba405778f07d7ec3713606568852b04e1a862","modified":1563878031934},{"_id":"themes/next/languages/vi.yml","hash":"6a812db8606498980cd64f001e9ef2f50e124809","modified":1563878031934},{"_id":"themes/next/languages/zh-CN.yml","hash":"f311ad2cc2edba144764c36c0035b6ed0d356a53","modified":1563878031934},{"_id":"themes/next/languages/zh-TW.yml","hash":"3f3674cac8f47a9a509a7557ea1557bbfbd027e8","modified":1563878031934},{"_id":"themes/next/languages/zh-HK.yml","hash":"7a5e47f561d4b6e132f7f3b09676afbf8520264e","modified":1563878031934},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1563878031951},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1563878031951},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1563878031951},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1563878031941},{"_id":"themes/next/.git/logs/HEAD","hash":"9eba22cfe6f09c1a2fbd9cedf68447b925769a22","modified":1564017525050},{"_id":"themes/next/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1563877954734},{"_id":"themes/next/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1563877954734},{"_id":"themes/next/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1563877954734},{"_id":"themes/next/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1563877954734},{"_id":"themes/next/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1563877954734},{"_id":"themes/next/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1563877954734},{"_id":"themes/next/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1563877954734},{"_id":"themes/next/.git/hooks/pre-commit.sample","hash":"33729ad4ce51acda35094e581e4088f3167a0af8","modified":1563877954734},{"_id":"themes/next/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1563877954734},{"_id":"themes/next/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1563877954734},{"_id":"themes/next/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1563877954734},{"_id":"themes/next/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1563877954734},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"89b0a0e64637bf5b0cfea0a23642df3d95eedfa4","modified":1563878031934},{"_id":"themes/next/layout/_macro/post.swig","hash":"f6931e1f95778ea84772bcd5d1560d9e601cb141","modified":1563878031934},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"381a52b658bb8d7721e6a3852568ce88a2580f1d","modified":1563878031934},{"_id":"themes/next/layout/_partials/comments.swig","hash":"784356dd77fe96ea1bc4cb0008e2b40de71bf2f0","modified":1563878031934},{"_id":"themes/next/layout/_partials/footer.swig","hash":"97953309b3ab354b8b7cf011850df42bc14b595d","modified":1563878031934},{"_id":"themes/next/layout/_partials/github-banner.swig","hash":"6357537ac0bb114aed4d61bafb39e6690a413697","modified":1563878031934},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"dbe321bcf3cf45917cc11a3e3f50d8572bac2c70","modified":1563878031937},{"_id":"themes/next/layout/_partials/post-edit.swig","hash":"06dac109504812b63766a80ede9ddacbd42d227d","modified":1563878031937},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"5db3bf74183de45bb4d6e4632a91f1a561467f17","modified":1563878031937},{"_id":"themes/next/layout/_scripts/next-boot.swig","hash":"283e78eb795f52236026434dab6a0667f14d3c08","modified":1563878031937},{"_id":"themes/next/layout/_scripts/noscript.swig","hash":"edaff4766e0c05fd5c889d9dd32884d376bef9d9","modified":1563878031937},{"_id":"themes/next/layout/_scripts/exturl.swig","hash":"61ae10d41f67ece004a025077fdb28724af05090","modified":1563878031937},{"_id":"themes/next/layout/_scripts/scroll-cookie.swig","hash":"ccd13d73429ef91ef5e8b7d9fa43c8188facdf41","modified":1563878031937},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"332267fb78c8a6bcf8964d9cfde9e981d7e4f75c","modified":1563878031937},{"_id":"themes/next/layout/_scripts/three.swig","hash":"cf1819fc0a075d2389ca491740c98eba54ba72a6","modified":1563878031937},{"_id":"themes/next/layout/_third-party/baidu-push.swig","hash":"4ccf2abbfd070874265b0436a3eff21f7c998dfb","modified":1563878031937},{"_id":"themes/next/layout/_third-party/bookmark.swig","hash":"10b61a8bac671e375916a4d234c120117098a78f","modified":1563878031937},{"_id":"themes/next/layout/_third-party/index.swig","hash":"5a05c7833c8d5727ed902a5bddc04b16d8e9e033","modified":1563878031937},{"_id":"themes/next/layout/_third-party/quicklink.swig","hash":"7757bd285732e857996b99af9d917953589fac5e","modified":1563878031937},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"cbe40cb67dad15ade967b0f396c1a95b6871f76a","modified":1563878031937},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"5cf1d7d6b2b5d5ac72a0ab9416e29ef1cce7833d","modified":1563878031937},{"_id":"themes/next/.github/ISSUE_TEMPLATE/bug-report.md","hash":"c37a60580c901c79ccb22564b228a46e06207445","modified":1563878031931},{"_id":"themes/next/.github/ISSUE_TEMPLATE/custom-issue-template.md","hash":"57e1e06e845193e80c7df4a4454af28352526f7a","modified":1563878031931},{"_id":"themes/next/.github/ISSUE_TEMPLATE/feature-request.md","hash":"07c423cce4157b8e2dbf60907ccbf3f18c4cf98a","modified":1563878031931},{"_id":"themes/next/scripts/helpers/engine.js","hash":"60eb1554456d9d0e5afc4a2d16f1580a0aa02da8","modified":1563878031937},{"_id":"themes/next/.github/ISSUE_TEMPLATE/non-english.md","hash":"0b0727ff4d5180ae67f930fb4f8e9488e33eda9f","modified":1563878031931},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"799a042bbf497a4c7a2981aa2014ff28fa1bb382","modified":1563878031937},{"_id":"themes/next/scripts/filters/exturl.js","hash":"79ad823ca803cb00e0bfc648aa6c9d59711e0519","modified":1563878031937},{"_id":"themes/next/scripts/filters/default-injects.js","hash":"ed8b2871c10d7d1128bda48582997a4b926290de","modified":1563878031937},{"_id":"themes/next/scripts/tags/button.js","hash":"f3b4f7ae7e58072bbf410d950a99a0b53cbc866d","modified":1563878031937},{"_id":"themes/next/scripts/filters/lazyload.js","hash":"3d424ad75b1431f57f8d1d0218b2a06ecc0a6e70","modified":1563878031937},{"_id":"themes/next/scripts/tags/full-image.js","hash":"149de45ff83403e97f6affa280072392dca42e4f","modified":1563878031937},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"f13430d9d1c9773b390787c2f046bb1f12a79878","modified":1563878031937},{"_id":"themes/next/scripts/tags/caniuse.js","hash":"c3554972bfb081f8b23046bc3198c0bd31b4c443","modified":1563878031937},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"8fc05f22b88553bc1d96e0c925799cd97920fc6a","modified":1563878031937},{"_id":"themes/next/scripts/tags/include-raw.js","hash":"5db59d56f4f4082382bf1c16722e6c383892b0c5","modified":1563878031937},{"_id":"themes/next/scripts/tags/label.js","hash":"fc5b267d903facb7a35001792db28b801cccb1f8","modified":1563878031937},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"983c6c4adea86160ecc0ba2204bc312aa338121d","modified":1563878031937},{"_id":"themes/next/scripts/tags/pdf.js","hash":"f780cc72bff91d2720626e7af69eed25e9c12a29","modified":1563878031937},{"_id":"themes/next/scripts/tags/note.js","hash":"0a02bb4c15aec41f6d5f1271cdb5c65889e265d9","modified":1563878031937},{"_id":"themes/next/scripts/tags/tabs.js","hash":"00ca6340d4fe0ccdae7525373e4729117775bbfa","modified":1563878031937},{"_id":"themes/next/scripts/tags/video.js","hash":"e5ff4c44faee604dd3ea9db6b222828c4750c227","modified":1563878031937},{"_id":"themes/next/docs/zh-CN/ALGOLIA-SEARCH.md","hash":"caa624092175d44e3d3a8c6ca23922718da2354c","modified":1563878031934},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"0dfb458370a0ffbbe37c00f53c15e3aa3e79b125","modified":1563878031934},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"93e45568d6225396efe5168606e856b3c4fd8ad4","modified":1563878031934},{"_id":"themes/next/docs/zh-CN/INSTALLATION.md","hash":"b19a6e0ae96eb7c756fb5b1ba03934c7f9cbb3c3","modified":1563878031934},{"_id":"themes/next/docs/zh-CN/LEANCLOUD-COUNTER-SECURITY.md","hash":"2b1d61e216a65210718697d75bbdd84cda671ea4","modified":1563878031934},{"_id":"themes/next/docs/zh-CN/MATH.md","hash":"83feca62190abcca0332915ffe0eefe582573085","modified":1563878031934},{"_id":"themes/next/docs/zh-CN/DATA-FILES.md","hash":"f3eec572a7d83542e2710a7404082014aaa1a5e7","modified":1563878031934},{"_id":"themes/next/docs/zh-CN/UPDATE-FROM-5.1.X.md","hash":"ae9f012ce9216f384777fb56dc35e6e5ca13b901","modified":1563878031934},{"_id":"themes/next/docs/zh-CN/README.md","hash":"79a73361b24e7fb7022992702961faacd6a2f9fe","modified":1563878031934},{"_id":"themes/next/docs/ru/DATA-FILES.md","hash":"d6d20f60f77a76c77f8e65d0c9adbd79d0274557","modified":1563878031934},{"_id":"themes/next/docs/ru/README.md","hash":"932d3965d8b1a1ff653c07a0cafcdbf5892d6945","modified":1563878031934},{"_id":"themes/next/docs/ru/INSTALLATION.md","hash":"6c5d69e94961c793da156217ecf1179e868d7ba1","modified":1563878031934},{"_id":"themes/next/docs/ru/UPDATE-FROM-5.1.X.md","hash":"b1dd18d9b890b21718883ea1832e7e02a773104a","modified":1563878031934},{"_id":"themes/next/source/js/affix.js","hash":"a2aab233d99297435a5274bf512c3c753fe08e80","modified":1563878031944},{"_id":"themes/next/source/js/js.cookie.js","hash":"e0afce539f1fb81d59e3c6f0a68d736e2fb45d93","modified":1563878031944},{"_id":"themes/next/source/js/algolia-search.js","hash":"1f7f10c579e7703d0f6acb8b73f3d78a07d0c623","modified":1563878031944},{"_id":"themes/next/source/js/exturl.js","hash":"54825acc8de4793feac415be227b965428f4e97d","modified":1563878031944},{"_id":"themes/next/source/js/motion.js","hash":"ca2965da47ba9fc5b0dde0a825c29e0817b965b9","modified":1563878031944},{"_id":"themes/next/source/js/scrollspy.js","hash":"fa3c92968bcdbcb8d95a1729f7659d9753cbd077","modified":1563878031944},{"_id":"themes/next/source/js/next-boot.js","hash":"262b6dae7d0585dd5bb2089df45bbe839a56d3b2","modified":1563878031944},{"_id":"themes/next/source/js/post-details.js","hash":"a614a3830f7dfcd4df303c1255d558a135b3854e","modified":1563878031944},{"_id":"themes/next/source/js/scroll-cookie.js","hash":"d07b3776708d4ae79ed2037c4c7391d5c9b06b19","modified":1563878031944},{"_id":"themes/next/source/css/main.styl","hash":"7b5a1b48e95fb0d6a75be2ef7318a9a1fe71d09c","modified":1563878031941},{"_id":"themes/next/source/js/utils.js","hash":"a8a526901495a8ce0d38f783c1b065400a88d148","modified":1563878031944},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1563878031941},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1563878031941},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1563878031941},{"_id":"themes/next/source/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1563878031941},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1563878031941},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1563878031941},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1563878031941},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1563878031941},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1563878031941},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1563878031944},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1563878031944},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1563878031944},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1563878031944},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1563878031944},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1563878031944},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1563878031941},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1563878031941},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1563878031941},{"_id":"themes/next/.git/objects/5f/6cc04ddd46cfce60165d7e9bbe9b7ec4b6abaa","hash":"69dbe261ed1a0cb7645a6f6dd44cf15cae567bac","modified":1563933456296},{"_id":"themes/next/.git/objects/e4/496ff3748ebeeb8730e36e158495d0283b4fdf","hash":"756c7f1fe92c5c56d64b3959c1d5bf65219017ed","modified":1563933456300},{"_id":"themes/next/.git/objects/6a/92406be5347a10ff6a74db87171384ffa7dbe0","hash":"8df1bcbb0db39863aae7ddb6e79fb7c51051351b","modified":1564017525046},{"_id":"themes/next/.git/objects/fb/2f4393b2d7844450c5e07cfa0ee7d8c4fdf174","hash":"51b490046cad56d5a3f6261f67ba316d48daa7c2","modified":1564017525050},{"_id":"themes/next/.git/objects/77/7282640b504a4f8e9bc16c1ffe4932b81f051c","hash":"82efd6039ab14a6d8d2db785b85009880b841b40","modified":1563933456290},{"_id":"themes/next/.git/refs/heads/master","hash":"d25a1b270a3ffad9949775eeb2384e7d4b321638","modified":1564017525050},{"_id":"themes/next/.git/objects/f0/4476249a6a8249ab6f8b25c25b40a7e097b1e8","hash":"567b8f4bc437a97e20e2c4b23ade45cbece5cfaa","modified":1564017525050},{"_id":"themes/next/layout/_macro/menu/menu-badge.swig","hash":"65c5e585982dae7ae1542cada71858b4ea1f73d6","modified":1563878031934},{"_id":"themes/next/layout/_macro/menu/menu-item.swig","hash":"9257da95bd032bb3bd1da670e302fd2c7d5610b6","modified":1563878031934},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"fc6bafc8c633afadc538c5afa5620ea2a1cdcb84","modified":1563878031934},{"_id":"themes/next/layout/_partials/head/head-unique.swig","hash":"02bb5748e8540b024e7f4008a9e640890b45280f","modified":1563878031934},{"_id":"themes/next/layout/_partials/head/head.swig","hash":"0e8c34f70ca748c744fc175a6edaa50da72fbb5e","modified":1563878031934},{"_id":"themes/next/layout/_partials/header/brand.swig","hash":"dec2d88ba95a69ce2796015eb712f24ef34ad82a","modified":1563878031937},{"_id":"themes/next/layout/_partials/header/menu.swig","hash":"71af31fea5913fd30c233e555ef13cf2c9768f72","modified":1563878031937},{"_id":"themes/next/layout/_partials/header/index.swig","hash":"7e3d5b40a8e13ce3bb5f28cb23f62c10c2bf14dd","modified":1563878031937},{"_id":"themes/next/layout/_partials/header/sub-menu.swig","hash":"5adc60100e129c1d0307bdcaa0c7b8e8375a6ea4","modified":1563878031937},{"_id":"themes/next/layout/_partials/page/breadcrumb.swig","hash":"0fa4fadb39467b01cede49f21b22e86b1a2da805","modified":1563878031937},{"_id":"themes/next/layout/_partials/post/post-copyright.swig","hash":"3615db591dd910fb9fa96542734c7ec0ef05019c","modified":1563878031937},{"_id":"themes/next/layout/_partials/post/reward.swig","hash":"d44f025eb93c99ddf90202d8293ccf80689a00c7","modified":1563878031937},{"_id":"themes/next/layout/_partials/post/wechat-subscriber.swig","hash":"ef11b5be5bfb2f0affe82cf521c002b37fef9819","modified":1563878031937},{"_id":"themes/next/layout/_partials/page/page-header.swig","hash":"2940df694fff28e8bf71b6546b4162f1e38227db","modified":1563878031937},{"_id":"themes/next/layout/_partials/post/post-related.swig","hash":"eea95b785c9c36d28e1839619793f66e89773bee","modified":1563878031937},{"_id":"themes/next/layout/_partials/search/algolia-search.swig","hash":"d9fe715fee716f78c7976c4e8838da71439ee0e0","modified":1563878031937},{"_id":"themes/next/layout/_partials/search/index.swig","hash":"7d1693416a5dc098f4723a53da2e2d1fc2d6e075","modified":1563878031937},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1563878031937},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"1a8cd1c9314144ec8f41dbec13c2f08d0d6caef7","modified":1563878031937},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"a5587bd1f60d35e58618576cec45e662aa44ea1f","modified":1563878031937},{"_id":"themes/next/layout/_partials/share/likely.swig","hash":"06cafe19f0e307ef7ad54038ae76b8db6bb5b4f9","modified":1563878031937},{"_id":"themes/next/layout/_partials/share/needsharebutton.swig","hash":"2c4a66be4677d3e4dec3f169ac8a769098dad1fe","modified":1563878031937},{"_id":"themes/next/layout/_partials/sidebar/site-overview.swig","hash":"4992f1572e560a418b70c10764a95ec827a1a7b3","modified":1563878031937},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"5b05f165547391bf231e52f56f3d925efc09bc44","modified":1563878031937},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"0097e45e7b671f8006b8b2d3c4f95cacc76a983c","modified":1563878031937},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"ffc8e8836714ea79abeb77b75859634615652877","modified":1563878031937},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"e42604fbb17648484e5f12afe230d826de089388","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-jquery.swig","hash":"b485797073495e24bf2f0b85880d513257bfed72","modified":1563878031937},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"108b157fbd1ac3baaf19ae87234fa8728ab79556","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"591b2ccd9713ccb922b9fcf5e278b6de9c5ec30b","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"a5723950c343d220270bfd27bd30050eda6c3fb3","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"3d01fa6edc0ad73f81813613f2e8a610777f1852","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"8eadb929c9e50e58502ccad2dc2657746f8c592a","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"798d67e4a736613ab899eabe6529091bbcda7850","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"08cd47ef8572121b7811342d3c9a84a338a18191","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"fae69a0e1a1d42f7bb44e594a29857d94594698b","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"9fa1ca7059243197d8fbbd35108c36629a254570","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/growingio.swig","hash":"4a966b7ffe2d80ff1b3dd0fd14b355766dc5c70f","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"438c6f5e6665d72f4ea7ee206011d669246f6102","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"a09d2af2a8470555eeb265b0eb14dc678079e870","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"f240a50cd9b627620d9a374a29cf95f0c5e99d7c","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"0dd5b315d1da55dbfc10f51a1f8952f72eba2720","modified":1563878031937},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"92e04a2b9e0c3df594bc22235d1894e5ad458dfc","modified":1563878031937},{"_id":"themes/next/layout/_third-party/chat/chatra.swig","hash":"c59b04402ea02e52ea3dedc34217be0f0d1ad0ac","modified":1563878031937},{"_id":"themes/next/layout/_third-party/chat/index.swig","hash":"5ab4a8b4306c837d2f8c211a9d7fdaed76fa254d","modified":1563878031937},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"1a00b1b78c429721d6477c2d8f6f68f005285cc8","modified":1563878031937},{"_id":"themes/next/layout/_third-party/chat/tidio.swig","hash":"912368c41de675f458b267a49a99ae3e7e420ebb","modified":1563878031937},{"_id":"themes/next/layout/_third-party/comments/disqusjs.swig","hash":"074a995cd630f56fc4a3135173515c86f2cb34b6","modified":1563878031937},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"3533167c4295637b91d90f3bae7c651cd128bb6e","modified":1563878031937},{"_id":"themes/next/layout/_third-party/comments/gitalk.swig","hash":"e8f91c571ceb4b80aafebc4d36b89fb41b1ae040","modified":1563878031937},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"15a4d60d3ecc59db2f23629477f8e7b8324981ed","modified":1563878031937},{"_id":"themes/next/layout/_third-party/math/index.swig","hash":"a7e304b05a44279d3e4f611908d7faef9dc14d7c","modified":1563878031937},{"_id":"themes/next/layout/_third-party/math/mathjax.swig","hash":"601774d8672577aefbcefac82c94b01f0338da31","modified":1563878031937},{"_id":"themes/next/layout/_third-party/math/katex.swig","hash":"c2cb2f384bc30d31cdccf9794a729c03e687b45c","modified":1563878031937},{"_id":"themes/next/layout/_third-party/search/algolia-search.swig","hash":"0a13dfd2de52a96901039098c6fc7b515edfc50b","modified":1563878031937},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"40bab84a4a7a368fa31f0f8ce49af6ec3e5983c9","modified":1563878031937},{"_id":"themes/next/layout/_third-party/tags/caniuse.swig","hash":"8fc1ac1a65b9e5c0a9081ec0f740d12543336575","modified":1563878031937},{"_id":"themes/next/layout/_third-party/tags/index.swig","hash":"d997d1df9c677ceaa4f719cdb6ac3ad32be020e5","modified":1563878031937},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"b3eaab6a269aa3fcbafe24fd06f0c9206dc12716","modified":1563878031937},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"ea94aa85034c6d1b6bb865aecea55c73f8a14501","modified":1563878031937},{"_id":"themes/next/layout/_third-party/tags/mermaid.swig","hash":"d6e6ddda836bd9e2e8d9767a910c7d3280080e81","modified":1563878031937},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"53a59cba82cad49f15a90e1a18007aaac525bddd","modified":1563878031937},{"_id":"themes/next/layout/_third-party/tags/pdf.swig","hash":"810a9b2a6059f46c4a2ddb178f1eaa4c5e23750b","modified":1563878031937},{"_id":"themes/next/source/js/schemes/muse.js","hash":"d6e4d1c937387d0d7891a41305ecdfe5597d6136","modified":1563878031944},{"_id":"themes/next/source/js/schemes/pisces.js","hash":"9eb63cba0327d3d11b6cbfcbe40b88e97a8378a3","modified":1563878031944},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1563878031941},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"2e8fb29aa92325df39054b5450757858c6cebc41","modified":1563878031941},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"4056cf687cf435697afe569caf3954b04ae277c9","modified":1563878031941},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"a8aa41625b94cf17a7f473ed10dcbe683b1db705","modified":1563878031941},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1563878031941},{"_id":"themes/next/source/css/_variables/base.styl","hash":"640f25a63770af5566ccc9cec79c40a4f1c0b29e","modified":1563878031941},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"fc15e277d1504532a09b7b1bd31f900ad95ec4b8","modified":1563878031941},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1563878031944},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1563878031944},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1563878031944},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1563878031944},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1563878031944},{"_id":"themes/next/source/lib/needsharebutton/README.md","hash":"46bb223bdf714a47a1449666f4f70556447786d1","modified":1564015753280},{"_id":"themes/next/source/lib/needsharebutton/LICENSE","hash":"b29db4c99aa5b8d574026f68804051ff4b75466e","modified":1564015753280},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","hash":"f151bb5ba4a2cd334061bac27a1a155969b62cdb","modified":1564015753283},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","hash":"75dee2bb4796ca66693831d769d9a105eed8c290","modified":1564015753283},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1563878031951},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1563878031951},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1563878031951},{"_id":"themes/next/source/lib/jquery/index.js","hash":"88523924351bac0b5d560fe0c5781e2556e7693d","modified":1563878031951},{"_id":"themes/next/.git/logs/refs/heads/master","hash":"9eba22cfe6f09c1a2fbd9cedf68447b925769a22","modified":1564017525050},{"_id":"themes/next/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1563878031927},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"6d900b4159eeb869196a619602578bf4d83a117b","modified":1563878031941},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"7ffde343bdf10add1f052f3c4308a15180eb4404","modified":1563878031941},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"8e0740a9ad349ce5555122325da872923135a698","modified":1563878031941},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"773f6d791f938ff037783004369092991d7bcd31","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"fe5ff961b86004a306778c7d33a85b32e5e00e48","modified":1563878031937},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1563878031941},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"33456264a74d1bba38264d14713544d67d003733","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"c8b3225396cb444d8baeb94bac78e5216b992a81","modified":1563878031937},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"b98c65006e2546fbf3870c16fbbcbc009dbaab15","modified":1563878031937},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"9d71f34fa13a41b8c8cd2fbdf3fdea608385277c","modified":1563878031937},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1563878031937},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"ce826aedf42b9eca424a044452f5d193866726a6","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/rainbow.styl","hash":"4741d642f9ed2eec9be23112f7a51645e77e41f3","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/scrollbar.styl","hash":"d7b8bcf2a6031296c84bb4f4ecfb037af01d2d82","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"1489ff40ce5f9fee81a7b4aa5ef56a864a481a63","modified":1563878031941},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"7e51ea64611ab5d678c112b4688d4db4fd2737e2","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"24230e46fc9fb7b8551f97bb36e9bc1f7423098e","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"0bef9f0dc134215bc4d0984ba3a16a1a0b6f87ec","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"213f2178dc260a28cba4fef723827a6e707f91a3","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"75d2d92af070eb10273558b2436972d3f12b361c","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"7359880e8d85312861fe0871f58b662e627dae0c","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"6565b4a309325596768d0d32e022c80ef23066cb","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"3948894201e6229a66bcf490e451f2481c8a99cb","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"fc160583f742c94316a0fee05c18468033173534","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"dfd7a9cf39a2135de4cf2f8651cac3fb333d028f","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"7359880e8d85312861fe0871f58b662e627dae0c","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"1edf4e69d0ec0dc9cefed6c35d3e803e0da4093d","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"57044a6d19eb418c1c3d28787e82c69efa9e0ca6","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"75737591682a2bafa71db4c03fb79e970ac0e7aa","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"2f782305b1e1d19197a90f1e5e9167fd77749a8e","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"232aedbd44243b3b80c4503c947060d3269c1afc","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"44d834c231e2bb57851954d73e70f6995b5929e7","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"6f427a43550f7b03c503106767fbcce1f18a4f78","modified":1563878031941},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1563878031944},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1563878031944},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1563878031944},{"_id":"themes/next/source/lib/needsharebutton/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1564015753273},{"_id":"themes/next/source/lib/needsharebutton/.git/config","hash":"c1a9d7abd57464a244b5b22bd6863d5e9e29b3bd","modified":1564015753273},{"_id":"themes/next/source/lib/needsharebutton/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1564015750363},{"_id":"themes/next/source/lib/needsharebutton/.git/index","hash":"cca218d0ad22a4a814baedd07190005a27b6c1a9","modified":1564015753283},{"_id":"themes/next/source/lib/needsharebutton/.git/packed-refs","hash":"018b03f9d6b9a0c7174e34007d73f0e086898663","modified":1564015753273},{"_id":"themes/next/.git/objects/pack/pack-54bf6479c684281f1c157497f7b461c8a0a7215d.idx","hash":"ef7e5bdc31042be94f6688d48f1b844cbec4c072","modified":1563878031907},{"_id":"themes/next/source/lib/needsharebutton/.github/stale.yml","hash":"fd0856f6745db8bd0228079ccb92a662830cc4fb","modified":1564015753280},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1563878031951},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1563878031951},{"_id":"themes/next/.git/logs/refs/remotes/origin/HEAD","hash":"c94f3ba89ee7565d1b455855d2b455ee89b3841c","modified":1563878031927},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"4cfeec9434a72d5efc6ca225d3445d084d4590f7","modified":1563878031937},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1563878031937},{"_id":"themes/next/source/css/_common/components/header/github-banner.styl","hash":"ca97f0b6990eef947039faede80c56d9c4381ee1","modified":1563878031937},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"6c4990d375b640ee4551e62c48c1cbe4c3d62212","modified":1563878031937},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"c0d9e18a9210fdcaf33e488518b3b288eb58c0a1","modified":1563878031937},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"a410ed529afd46ddf4a96ecf0de6599488716887","modified":1563878031937},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"cc6ee18f47f2e1e06df6fa0eadb37079e580fd11","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/highlight/copy-code.styl","hash":"24d366f13f4af294ee929819713146e0a885706e","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"4114f1aa7546bbdf8253e261061c9d9bb0ca6c39","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"a690d4aba571b08c029a168e12cef2bbfd27a1ae","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"ba17bf993d3e6a4aed02e740e3a4b913d9e7409d","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"8bffc9f7f4b20860a56160f0d1ba77062106f990","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"c961d37190d9bec58a36306c7e716c4e72c4582f","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"2356226157e8068b0e9bbe2f7d0f74e1ab49199b","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"df3c19fd447da6d4a807683345007a41338f9a04","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"0bf899fab331add63f0c8ead31ca3a3db2ad74d9","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"67165cd8836e03c289162b96ef06f8b024afe9af","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"496f931e3a7e313ba8088fb91bb20789cace72c9","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-reading_progress.styl","hash":"3f33bb862c2aa993f54987fbb345da067b79b112","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"5440013a081201ca791582db98159dce93ea9e75","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"8e058c99dd7d41f0bd34c7c28b6ac9fbb17dcb5e","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"d5c8ffed7f2c701052b7a53abaf5ef437374ea72","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"9c60fd1c4d221b968a5b1129f41e6d62adac1730","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"a6c24393dffbdd94dd5c01cdbec5e180b0bfbbbd","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"e3124da5350d6c01f32ccd04134a686baa4fb30a","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"6904fd7ea6455e008d9884558b68254608af9a3c","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"f2469ecf57eeb32f5ad0a26c7358e521383ac935","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"f1d52954b9a5d1ca8e224382349f525e598dd923","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"61ca40856e5cacd48e0fa9728fde4605c7dd4c94","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"9df791fa842b16ae72ad2998ffc2f87fdf0b6a88","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"3d55c8641a69449de7caf1ea2cf731973481daf5","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"965a4896925f4c2bfdb492e1923288c91b854f2d","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"cc83816614f21c7e1d8d3f867d547ff7c658cec4","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"987f1cdd57dd9f6f81c133c280c20d7168c37d7f","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-button.styl","hash":"517d541a80d59ad99a3f648be74891e0c7bc72a8","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"9a3bfc878ca797946815bed23cd6f92b24a16358","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"4a655ce8217e038b4b9df2265555feae9ccd6242","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"8a24b56524a388fbabd408ffc8ba9b56eb9e01ce","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"38314eec8f4a2d1667e1061d7a3deb1c16f17da9","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"967fb3a3c6c851b34ec5df2d945dc266ed63d146","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"58ec00eebe68d0eebd2eea435c710063877447df","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"6ec8ea7b11a146777b6b8da0f71f0cc1dbd129df","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"c85df3ecc0b37095cac14114c308e5829c66b5a3","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"d7501ae01fc45fa15b00d1bc5233b9fffa20a3c9","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"ca7cd57bc346a3fda8097b2b49e6d943600912d2","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/tags/pdf.styl","hash":"da8d34729fb6eb0fcb8ee81e67d2be3c02bc1bc4","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"4b62818333d2463fe416fb3156ced12e7d60aafa","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fc58498d4f5081fcf6218e9e18c5bf2328275bef","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"cbc0be5a3285b469858ec9ead48e2ea90bd47ae1","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"dfdbaf50e4217d538c218fe979fef9539244cab4","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"1156b11ac74d2d21b1b5047767b2a9edafc9182d","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"9fac89c8146eb2675721a26f528d7d0f8be7debe","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"3ae3f3c276d444862033fd3434c632ad0d2f84e6","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"9738e754be24c1c9f2e60bc052f6f7b1bae0322f","modified":1563878031941},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"ef66c0a08e4243a25e41408d70ca66682b8dcea1","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1563878031941},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/_sidebar.styl","hash":"487dbb5b389620e7be2ce666531a7baa249d50a0","modified":1563878031941},{"_id":"themes/next/source/lib/needsharebutton/.git/logs/HEAD","hash":"ba853fd0362a49c2bdb216abf82d953a369e5927","modified":1564015753273},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1563878031941},{"_id":"themes/next/source/lib/needsharebutton/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1564015750363},{"_id":"themes/next/source/lib/needsharebutton/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1564015750363},{"_id":"themes/next/source/lib/needsharebutton/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1564015750363},{"_id":"themes/next/source/lib/needsharebutton/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1564015750363},{"_id":"themes/next/source/lib/needsharebutton/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1564015750363},{"_id":"themes/next/source/lib/needsharebutton/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1564015750363},{"_id":"themes/next/source/lib/needsharebutton/.git/hooks/pre-commit.sample","hash":"33729ad4ce51acda35094e581e4088f3167a0af8","modified":1564015750363},{"_id":"themes/next/source/lib/needsharebutton/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1564015750363},{"_id":"themes/next/source/lib/needsharebutton/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1564015750363},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1563878031951},{"_id":"themes/next/source/lib/needsharebutton/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1564015750363},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1563878031951},{"_id":"themes/next/source/lib/needsharebutton/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1564015750363},{"_id":"themes/next/source/lib/needsharebutton/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1564015750363},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/10/7997cd9f09e787407d6a579bb0ead61ba0c44e","hash":"a7bb772e0f541b9f0c5e4682f88881faef7d2b87","modified":1564015752956},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/34/73a532c76c2ec7eaafc9bba9bc37851cb5a349","hash":"991d675a7982030fef4e8103ecdf717e2e153143","modified":1564015753216},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/35/b5765a89abcc57439ad0e7b60dc67225e76570","hash":"b020fa3885506f64651a4a63d42b32c7874a072a","modified":1564015753213},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/1f/9bfac8ac3b22f100c85bb82877c7af973f011a","hash":"74f0088767a48b5b8874bb5e8953604058233105","modified":1564015753190},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/3c/673c6e10073f4cf715526c3ab99edf7461b267","hash":"9362453f89eefcc6988cd3a39548c90402f616a8","modified":1564015752960},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/37/e84bbc9c853d9abc39b18361a67d09402a9fec","hash":"330ba4772d5feaf23bd85aa38be94a1b254cac8a","modified":1564015752956},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/40/a8a2ab6075fb13a489aa2585f55518e03440cc","hash":"40a879b454bae72ba30ab918e7cbb3dee04c45c4","modified":1564015753206},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/46/66508d485306f48ac866f4a0eded896b01adb0","hash":"a37ee79e50b83b3a5a7f736cfc6b8eafc210ebca","modified":1564015753256},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/0c/97d452adf1f9aa29468c10dc5aca581c40d35d","hash":"8247b73544627904f1c49b2d48e8a5ca24c49d94","modified":1564015753216},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/41/f2acffe002ce9fa94904bdbb105c62697c08bf","hash":"6aca807e726bf9bbffdab1b97cae1132dd3570c8","modified":1564015752956},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/49/e08108a89c7bf4f1e03fdf9d23fa1841ddc40a","hash":"3a32bfdf83debfa739a05a12c77c9c8c9fad6baf","modified":1564015752956},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/51/e4a626dc726971ce48b9d29531ec4fa11ab93c","hash":"8bc98d2bd4f224fbba56e0339ba9e1abfbd0e676","modified":1564015752956},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/2f/9eba51ec174b1e0c719d12cafa7c3c07140471","hash":"fc994d9d8b3b21ec7c941eea7e3862970e297e9b","modified":1564015752960},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/0c/dada082d621dbfdd00f7020c33dc751129167f","hash":"b490c11cdefde6b331a7d4ddb055e34ad08459d8","modified":1564015752960},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/63/ce5669cda10d9c600a65df1c509155a9dce354","hash":"e7eefb05c18a77c99c1044dc53cc0b33bc4bc723","modified":1564015752956},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/69/a20d65d83035fdb01734a8eabe3340f740a4cb","hash":"9e95b02d8e43ec92e06bee3f60dffb74e8e7b9fa","modified":1564015752960},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/8a/e95435136e887fc30227f9fdab68ff72689315","hash":"f1225345f08eb5abbf849a40efdec16839268c9b","modified":1564015752960},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/72/38adfc9f0b65e7dd8e7eb39b53fd8dbd05728d","hash":"67f5fb35cbbb4625e049368c8ef7fef03e21315d","modified":1564015753260},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/80/8d63b637e30043e74f5150047c232028ffa3bf","hash":"c7cd9201316a2cf66b63cd0f520dc827912d8be8","modified":1564015752960},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/91/85a82ce05e0c4c6287e3ce6c31d79049a6c5de","hash":"d40af8a4f325b8b2d6eeb1f51497d2313aade46d","modified":1564015753213},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/77/b1d62571d3374de0902fdf14c3fd925263c295","hash":"f0d087a62296e14072d250d0db5bfeb01e3e0f4c","modified":1564015752960},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/96/b1227c70e63f95b099993321043a2e05abdbea","hash":"d1f0885e3a68fdfc87e68e5ba6b60de116c3c7a5","modified":1564015753253},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/9a/563a770314159840897f1852b05f183911ae71","hash":"0949c3c36849e955c84cc66f544fbeeca266ae19","modified":1564015753256},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/99/ac01b3cae78a765c45566d5540596f71f0f9ed","hash":"394e54788569a0aef47f5c1867b7a617d314b677","modified":1564015752956},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/9c/850e429959950cfd82a30843ad130dfd24331a","hash":"001c3423e8a4bf2ccd3e0ad3080d5cace613d42c","modified":1564015753210},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/9f/e80d3fee719ad9953c0e8e8dec472bb727d17d","hash":"09516f8a3f62a9e286f3ac1985969d0913d53271","modified":1564015753196},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/a7/df932fbaa27cde88a4e1b6b222e445d24d88a9","hash":"65ed1fff3d6ea0eed90011b6c9c892381c0b4837","modified":1564015753196},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/49/c5d2b0c8ded3a5465f659504d5654759b45ce9","hash":"133f2916c8dd706d9ea44203f671d42abed6d183","modified":1564015753210},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/b2/8efd888e853a00d7c8ba8fc827ddb0edb6668b","hash":"8c17e115b7c8a860650191fc1b74e7861ab0f7b9","modified":1564015753213},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/aa/f4e31e1d4ea073ad9f6926e146fea3c6d8b423","hash":"7c412d2a2243907dff0a1940f13a539675d76428","modified":1564015753256},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/bf/839b1a2dfd79af314506907196f817d1d540b0","hash":"196a52782c02c03b787cca10ca172a6be6ddb8e0","modified":1564015753260},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/b4/8a9ad41dbacf220607a3854e23f2136ced96fb","hash":"81ee83b48edb7df4f08573cdd14200be5f62128a","modified":1564015752956},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/da/3a5548a43813122821bf626fdd51a15f89afe3","hash":"1d8c39585806e5c7b051eb58d566a399b0e77006","modified":1564015752956},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/a1/5c0ab3f7ca37d06a7a3dc28f6375ac8fcaffe1","hash":"3aa24fa2254a71f9b408a01ad7154cc1cbf7cde6","modified":1564015752956},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/e3/096992403adfd6ad955585273915bdeae3dc32","hash":"356ee4003511e7f9c9c4badd52af674adceec2d9","modified":1564015752956},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/eb/83c3470835cc056d65fbaec5ba59fc01a341c6","hash":"a48447a56db4dce3b2ce99fcfd4cbb5d5902877f","modified":1564015753216},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/77/ad104add4d67baba615eccfcc7876bdf60256f","hash":"787497f0b2a074be846ae940ba58475a830690d4","modified":1564015753260},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/e7/169e14c00f267f49acb69c1ba41dc9a3229d36","hash":"2b79081ef52aec5ca3896894e25e330aed84ac6f","modified":1564015753206},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/f5/a400ecc881307dc0faa24170ae0a9bcbba861c","hash":"4b82935622bd12041cf7665503ae8e060705e7fd","modified":1564015752956},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/f5/fc2c417f7156d25437bbe069fa10645b4c3a63","hash":"377e0fce80cab14d6966371260926ee78da12b09","modified":1564015752960},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/ec/efb0da782cd6bdfbd7aec14e8e186c2010beb3","hash":"002214074d8349ca4765414ee39cbeb0a3a443d6","modified":1564015753200},{"_id":"themes/next/source/lib/needsharebutton/.git/refs/heads/master","hash":"414a643b841a756253dc0c2472b2f7a6e9b14778","modified":1564015753273},{"_id":"themes/next/source/lib/needsharebutton/.git/objects/ec/fd49187c43c81ad64c250eac1d63893c073e38","hash":"0e6f432ab1ec9a413655267ad3f62205e2e71f99","modified":1564015753216},{"_id":"themes/next/source/lib/needsharebutton/.git/logs/refs/heads/master","hash":"ba853fd0362a49c2bdb216abf82d953a369e5927","modified":1564015753273},{"_id":"themes/next/source/lib/needsharebutton/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1564015753273},{"_id":"themes/next/source/lib/needsharebutton/.git/logs/refs/remotes/origin/HEAD","hash":"ba853fd0362a49c2bdb216abf82d953a369e5927","modified":1564015753273},{"_id":"themes/next/.git/objects/pack/pack-54bf6479c684281f1c157497f7b461c8a0a7215d.pack","hash":"3ce2329796b4afb56ddd8b7071b5527d0b5b5171","modified":1563878031904},{"_id":"public/atom.xml","hash":"ebb21fb0e9a864d1123e7759e0f5c51b322a3e43","modified":1564744181453},{"_id":"public/content.json","hash":"a18a7d38b4aaca9ccf3ebb68d8c6acde68713bbd","modified":1564744181454},{"_id":"public/search.xml","hash":"307215d08604d311790eb628040520aa9fe09396","modified":1564744181490},{"_id":"public/adadd/index.html","hash":"95904e5e3d3403a7e6af30e23a485bd47d8677ac","modified":1564744181500},{"_id":"public/sample-page/index.html","hash":"1866dc880e3b26e7a8c62569907386268167645a","modified":1564744181500},{"_id":"public/2019/08/02/django环境部署/index.html","hash":"6624b345e29f99a036984cc282cc983bde8a6993","modified":1564744181500},{"_id":"public/2019/07/26/node入门基础/index.html","hash":"505bf77ed061b5cb5e1112bcf37a56573d131861","modified":1564744181500},{"_id":"public/2019/07/26/linux守护进程/index.html","hash":"a33943f97ee7590a1d54eb8b2b0dd2419b9b2c2a","modified":1564744181500},{"_id":"public/2019/07/24/minicat-manjaro-18-0-4-dev/index.html","hash":"1244790476dddd286effbe1991ea5132418da899","modified":1564744181500},{"_id":"public/2019/07/24/c开发gtk+-入门基础/index.html","hash":"4d6b567748f48fca655d8f8aee3ea0972137d4d4","modified":1564744181500},{"_id":"public/2019/07/24/ffmpeg录制基础/index.html","hash":"0ada668782ffbeaf4b1c29a3ecee2e62d831db2b","modified":1564744181501},{"_id":"public/2019/07/24/ffmpeg封装与解封装基础/index.html","hash":"5da15188c5acf2133b1472e71799fb7e7d29c4ee","modified":1564744181501},{"_id":"public/2019/07/24/ffmpeg直播基础/index.html","hash":"08e083f67c2f00412e405fdc0ea85c1b3bf8edf1","modified":1564744181501},{"_id":"public/2019/07/24/ffmpeg滤镜基础/index.html","hash":"aa3320575f5c799e2d40a7e5fb21aada71776233","modified":1564744181501},{"_id":"public/2019/07/24/ffmpeg命令基础/index.html","hash":"13dad39fa852b8e5029cf77da08fc55606a255f8","modified":1564744181501},{"_id":"public/2019/07/24/ffmpeg视频基础/index.html","hash":"dc50071620782717faab0958749999a238c197da","modified":1564744181501},{"_id":"public/2019/07/24/ffmpeg音频基础/index.html","hash":"65fb8291ae00f5f1ce33423546f179e406eb6af0","modified":1564744181501},{"_id":"public/2018/11/16/zabbix入门基础/index.html","hash":"6af26f9b5da61d5eb6797b3e7169c8aca6e92bad","modified":1564744181501},{"_id":"public/2018/11/14/centos7.2安装使用openResty/index.html","hash":"414d8f0e16c2bfc8f5aa6a4ae5e95b6b0ed638cc","modified":1564744181501},{"_id":"public/2018/11/10/linux环境nginx-php-fpm权限问题/index.html","hash":"9ba198fe5d8ff629d186719ea2a475e5712b6f57","modified":1564744181501},{"_id":"public/2018/10/09/ubuntu16.04安装及使用SVN/index.html","hash":"bf0250e582436675a918591bae5da0840821c59b","modified":1564744181501},{"_id":"public/2018/09/26/vuejs/index.html","hash":"8020f273cd768af8689e9a5b7e3e4a91c154699f","modified":1564744181501},{"_id":"public/2018/09/08/centos7.2安装及使用docker/index.html","hash":"c971eb7ad360cfb516652ee9e9783dc27e74291b","modified":1564744181501},{"_id":"public/2018/09/08/centos7.2安装使用sentry/index.html","hash":"5a160eb8eb1423125e94403434037659389057b8","modified":1564744181501},{"_id":"public/2018/09/08/centos7.2使用rabbitMQ/index.html","hash":"7cf003c482a33bd6e0da3e003a539bfbdef161f6","modified":1564744181501},{"_id":"public/2018/08/07/postgresql入门基础/index.html","hash":"f3103cb71ccdd9061fe4804c10563577a6e8725a","modified":1564744181501},{"_id":"public/2018/01/31/java入门基础/index.html","hash":"abda57b5e825f7ca769566ba4c9d4081812a4d6f","modified":1564744181501},{"_id":"public/2018/01/29/微信本地开发及线上环境搭建/index.html","hash":"9f71fd0685cc229ef374e8aa8567a348c1eb83a4","modified":1564744181502},{"_id":"public/2018/01/11/redis基础/index.html","hash":"84d3e72f8c3546adc11cbd311807994b533e8426","modified":1564744181502},{"_id":"public/2018/01/10/python爬虫scrapy框架入门基础/index.html","hash":"74b716a90152fbdc159c1f09e935b412a6e37d28","modified":1564744181502},{"_id":"public/2017/11/22/最新在linux-ubuntu中安装qq的办法/index.html","hash":"722a0b32ced3bb24fc80549bef21dee30830e69c","modified":1564744181502},{"_id":"public/2017/11/20/ubuntu16.04安装及使用docker(一)/index.html","hash":"487a5d2525b1d3f04b0889e186c9bec02efe250e","modified":1564744181502},{"_id":"public/2017/11/08/linux命令记录/index.html","hash":"b3ec6da9e6d9c1350f31c8f8630c28363744d602","modified":1564744181502},{"_id":"public/2017/11/07/ubuntu本地配置SSL/index.html","hash":"eee499490a93a3aca47c698b1859b4c42be90860","modified":1564744181503},{"_id":"public/2017/06/19/ubuntu配置Gitlab服务/index.html","hash":"135b0a1fc09130cdeca79fb46a9c8d09983523b5","modified":1564744181503},{"_id":"public/2017/04/20/centos7创建nagios监控集群服务/index.html","hash":"3f15c27f75c10386890f5537b47b4a3e528ed117","modified":1564744181503},{"_id":"public/2017/04/19/centos7配置keepalived实现高可用集群/index.html","hash":"c7531f969ee72f4e7d5160f58024e361b7e76c6a","modified":1564744181503},{"_id":"public/2016/11/30/unittest单元测试/index.html","hash":"fc66f426b84c6f001aa6546af01a79f3483d9a5d","modified":1564744181503},{"_id":"public/2016/11/30/selenium入门基础/index.html","hash":"eac6e5216da2da27469b370f54fcefe929ab1c31","modified":1564744181503},{"_id":"public/2016/11/10/wordpress插件开发基础入门/index.html","hash":"68deb8cbde241bce144e1536a0357a89aac30afe","modified":1564744181503},{"_id":"public/2016/11/10/pythontkinter入门基础/index.html","hash":"208b01c159825c7ca876d7f06da9aeb78c2e93e5","modified":1564744181503},{"_id":"public/2016/11/10/ubuntu14.04服务器基础配置/index.html","hash":"4d77580f6727c7b40c92ee4e630b0a3b45226399","modified":1564744181503},{"_id":"public/2016/11/10/centos7服务器基础配置/index.html","hash":"9fdf05ca349871109b253a1e3e02e43e1ada6516","modified":1564744181503},{"_id":"public/2016/11/10/javascript入门基础/index.html","hash":"d22e14636cdea7f74975beacc5f7ce59b53e087d","modified":1564744181503},{"_id":"public/2016/11/10/css兼容性汇总/index.html","hash":"2f949ecb30aad09b3a701b6b4f99bb39e32b8399","modified":1564744181503},{"_id":"public/2016/11/09/windowsserver服务器基础设置/index.html","hash":"ca63f3d3f3f05bce8ced527c1f0e9b74905ed113","modified":1564744181503},{"_id":"public/2016/11/09/thinkphp入门基础/index.html","hash":"dd686708d256a183a5ff0db5bf8ff0a174304577","modified":1564744181504},{"_id":"public/2016/11/09/windows软件运行时错误429,ACTIVEX部件不能创建对象的解决方法/index.html","hash":"013477b241a908bdf1507f7607edacf08dcfa0d6","modified":1564744181504},{"_id":"public/2016/11/09/sublime入门基础/index.html","hash":"70da49c64e9ff51ffae354db22ec1d2a60569f58","modified":1564744181504},{"_id":"public/2016/11/09/git入门基础/index.html","hash":"808e0efa7df998f1293abdc1ade86184cbadf1c4","modified":1564744181504},{"_id":"public/2016/11/09/excel入门基础/index.html","hash":"642148ca78fae63db839ccde233e8b5d441854df","modified":1564744181504},{"_id":"public/2016/11/09/wireshark抓包基础/index.html","hash":"53a2fa23d297d4976fd33f8a194f1d1f553b7be7","modified":1564744181504},{"_id":"public/2016/11/09/jetbrains使用配置/index.html","hash":"95768ca10f29928ad52b60818dd0681aa96ef41a","modified":1564744181504},{"_id":"public/2016/11/09/apache入门基础/index.html","hash":"efad4a1a42765348c3e068854b1d7b0eb0b5899f","modified":1564744181504},{"_id":"public/2016/11/09/django入门基础/index.html","hash":"54bc29702ad459d981e0383bddd79d0cfb7343f4","modified":1564744181504},{"_id":"public/2016/11/09/mysql主从复制/index.html","hash":"5029d835011b8b2f24f16a71b8ccbb4c6891a845","modified":1564744181504},{"_id":"public/2016/11/09/mysql入门基础/index.html","hash":"f4471b605c3b43a8b17ed388a271197ecbc6822d","modified":1564744181504},{"_id":"public/2016/11/09/rsync同步web服务器/index.html","hash":"364cc839681ef96bc5511c5ed749de0e202a0f96","modified":1564744181504},{"_id":"public/2016/11/09/linux开发环境常用软件/index.html","hash":"3b7143a03039b349be83557f4e7317fb44aefd3c","modified":1564744181504},{"_id":"public/2016/11/09/python入门基础/index.html","hash":"acd17c18e4fe3e18210791f4a7671b212a58f21f","modified":1564744181504},{"_id":"public/2016/11/09/centos安装s_h_a_d_o_w_s_o_c_k_s服务/index.html","hash":"5d077648c5cdb5b5711868256730b28cf5b859b3","modified":1564744181504},{"_id":"public/2016/11/09/python将office word 转为html 并提取相关图片信息/index.html","hash":"31a2b0566bb13763715f7b8808511515b460a478","modified":1564744181504},{"_id":"public/2016/11/09/python从excel导出数据并批量替换word文档内容/index.html","hash":"45f6aa4c3659aead2f4f90a1d7dc6960b0e9e6d1","modified":1564744181504},{"_id":"public/2016/11/09/局域网部分电脑不能连接网络,局域网共享文件夹,打印机等情况/index.html","hash":"78c929ca789f62f6958e13fe09b0aef3c24506b0","modified":1564744181505},{"_id":"public/2016/11/08/window常用软件/index.html","hash":"122fcbd486db3797dc4ea417bd8d67fb26254ef8","modified":1564744181505},{"_id":"public/2016/11/08/硬链接软链接方式/index.html","hash":"7d64c52a03564e28de4bd7b81516a35eb41d28c1","modified":1564744181505},{"_id":"public/2016/11/08/php将pdf转为jpg，png图片/index.html","hash":"4ff323b45346e9e1835d57da8e8b353928346527","modified":1564744181505},{"_id":"public/2016/11/08/oracle virtualbox入门基础/index.html","hash":"3d359d09ff48b345d7261f9fb02465feb4495609","modified":1564744181505},{"_id":"public/archives/page/2/index.html","hash":"5c49403be634728a5da43c06bee5a2ce5b8b7920","modified":1564744181505},{"_id":"public/archives/index.html","hash":"b86b2da53bb74d71302f9bca2adcedfc1c8585a9","modified":1564744181505},{"_id":"public/archives/page/3/index.html","hash":"81f211e9542190549465d7b1343107e637d692db","modified":1564744181505},{"_id":"public/archives/page/5/index.html","hash":"ef8be225d05eefa2034d94193e1c02adfa13f2e1","modified":1564744181505},{"_id":"public/archives/page/4/index.html","hash":"0e1f3a951905771fb4763b6e2dca756747940ca7","modified":1564744181505},{"_id":"public/archives/page/6/index.html","hash":"425348256fedcda4752d3dfda034a17c26fa471c","modified":1564744181505},{"_id":"public/archives/page/7/index.html","hash":"a477dab9a07f9ebd66e1ff75ca49b907d0a9c37f","modified":1564744181505},{"_id":"public/archives/2016/index.html","hash":"c8dc60a21f916871463b88f36af7ca572bacfe77","modified":1564744181505},{"_id":"public/archives/2016/page/2/index.html","hash":"8742a70c4d22ef017afc8df312296c616ff9e2a3","modified":1564744181505},{"_id":"public/archives/2016/page/3/index.html","hash":"d2a337dadd8af029369d3b187bf362596ad4db6f","modified":1564744181506},{"_id":"public/archives/2016/page/4/index.html","hash":"9977d9aeb07b07bd65afc2c001b2db8610c9aa1b","modified":1564744181506},{"_id":"public/archives/2016/11/index.html","hash":"b36ad35c22042499c3b1205c624f217527e59fc8","modified":1564744181506},{"_id":"public/archives/2016/11/page/2/index.html","hash":"c7fc018739883e23d697f351f8065d6bb1109e0c","modified":1564744181506},{"_id":"public/archives/2016/11/page/3/index.html","hash":"9480c587c79b047a1b151f18e78af7f17daa82f1","modified":1564744181506},{"_id":"public/archives/2016/11/page/4/index.html","hash":"7338375c6e5d28f42a1eef03527fa76cee0ff585","modified":1564744181506},{"_id":"public/archives/2017/index.html","hash":"ac02fc6f3c1a0eeb991c986a53ff2bc68868db79","modified":1564744181506},{"_id":"public/archives/2017/04/index.html","hash":"0866b7890a9a8e6a2330cd9b9b02b85f32390196","modified":1564744181506},{"_id":"public/archives/2017/06/index.html","hash":"37bcab838dfc877876724a984810cace72762f4c","modified":1564744181506},{"_id":"public/archives/2017/11/index.html","hash":"55bbd58e385068808411e4937bd1ba75fda3d83d","modified":1564744181506},{"_id":"public/archives/2018/index.html","hash":"b08475da2b26902976f497f5864d8ab1d01e0c83","modified":1564744181506},{"_id":"public/archives/2018/page/2/index.html","hash":"9c616d80c3efe753a5b94db56adfe7dc4fd2d2d9","modified":1564744181506},{"_id":"public/archives/2018/01/index.html","hash":"34fd4020f887cce6188bf85417f60d08b91b7f1e","modified":1564744181506},{"_id":"public/archives/2018/08/index.html","hash":"079f769438a76f2a3d4ed989c8982af980c9388e","modified":1564744181506},{"_id":"public/archives/2018/09/index.html","hash":"3c769731819cc9e81f974c6414e4acc4407101a9","modified":1564744181506},{"_id":"public/archives/2018/10/index.html","hash":"a31eeed6e13e19849eea7be1c9a9f0d83da961e8","modified":1564744181506},{"_id":"public/archives/2018/11/index.html","hash":"c29d2e4a8049a20c3e6b4c3fc1717c5276cdd5ea","modified":1564744181506},{"_id":"public/archives/2019/index.html","hash":"9c0f4743ad301eea18978caf28adf0d413e04382","modified":1564744181506},{"_id":"public/archives/2019/page/2/index.html","hash":"303a737dc3278838be8f28ced0dad3b143f30f94","modified":1564744181506},{"_id":"public/archives/2019/07/index.html","hash":"1b65b322bcb63dac2f76de9cf0ba614b1c39866d","modified":1564744181507},{"_id":"public/archives/2019/07/page/2/index.html","hash":"b800bab63a5759e64fb466c0c1f4a9391838a96e","modified":1564744181507},{"_id":"public/archives/2019/08/index.html","hash":"95215cb952122eacda9ba7f0d0733bf27b344894","modified":1564744181507},{"_id":"public/index.html","hash":"c261265b98cc989663473127d1dca1fd62c74c9d","modified":1564744181507},{"_id":"public/page/2/index.html","hash":"3af9dfff4b0929cc4f16d0ca862ef505ee994f15","modified":1564744181507},{"_id":"public/page/3/index.html","hash":"ba3855e4a064a47b64bf07274ccdd4e716a93a64","modified":1564744181508},{"_id":"public/page/4/index.html","hash":"bbba1473f7aac7d81640515c1f800042878c0bcb","modified":1564744181508},{"_id":"public/page/5/index.html","hash":"fe78c95d40a50e4e91842e502d9c7d91b207043d","modified":1564744181508},{"_id":"public/page/6/index.html","hash":"d8b9cddd30a7c3d8044ace8f2be59b64fb78fc1d","modified":1564744181508},{"_id":"public/page/7/index.html","hash":"4784cfb6d300ba3fd25724bedad1d2bfbf2c7229","modified":1564744181508},{"_id":"public/tags/linux/index.html","hash":"e1d434eb7f8f8e94e34614f9c679c05d38154797","modified":1564744181508},{"_id":"public/tags/ffmpeg/index.html","hash":"cf6c16de58e06a4c06f64b075a5f85b04e8be742","modified":1564744181508},{"_id":"public/tags/django/index.html","hash":"6273e767f0488a76a2d8774d8ed2653658b4b732","modified":1564744181508},{"_id":"public/tags/python/index.html","hash":"a156dddc6c1f3015c6ccccb9746a24421fe93f4c","modified":1564744181508},{"_id":"public/tags/IDE/index.html","hash":"06996d4fa4a4669af7ea35afd688d57c7b19404d","modified":1564744181508},{"_id":"public/tags/mysql/index.html","hash":"63d6798547666f8ac59747784dababe91254650f","modified":1564744181508},{"_id":"public/tags/php/index.html","hash":"4dd4a3e2952afcfee30bdddef73274284e4cfac0","modified":1564744181509},{"_id":"public/tags/manjaro/index.html","hash":"583b08aa5da5fff8e80e749c82567518780aa62d","modified":1564744181509},{"_id":"public/tags/redis/index.html","hash":"001f08dbe5c503540604ad0646b41af6dda6a117","modified":1564744181509},{"_id":"public/tags/数据库/index.html","hash":"ee42f914f2ebc65d15139f5501e8168618c14f39","modified":1564744181509},{"_id":"public/tags/windows/index.html","hash":"a3b3bd8a2c093a862922e15b72f13896265fbfa8","modified":1564744181509},{"_id":"public/tags/微信/index.html","hash":"220d81e9da75d3aca68aec998c7a77fa846ff8c7","modified":1564744181509},{"_id":"public/tags/运维/index.html","hash":"575f7f1a7564d59faf025291ea15f75da605d396","modified":1564744181509},{"_id":"public/tags/ubuntu/index.html","hash":"2ddaa7ea05c4f0c210c0d3ef417595dabde109b3","modified":1564744181510},{"_id":"public/tags/javascript/index.html","hash":"60988ff491c0d7f297490e6221d33312a6296d79","modified":1564744181510},{"_id":"public/categories/运维/index.html","hash":"23b7a107fd1e7b99751906cb4b2194a33668440d","modified":1564744181510},{"_id":"public/categories/运维/page/2/index.html","hash":"c4848e34ac73971672c9de35df443cc5d09868e4","modified":1564744181510},{"_id":"public/categories/运维/page/3/index.html","hash":"8fadbcdc1c31d3b9e79c7b86f886cd02bc78bb47","modified":1564744181510},{"_id":"public/categories/前端/index.html","hash":"e305d842c51ede79fbe25cdabe9e88209c25ae60","modified":1564744181510},{"_id":"public/categories/后端/index.html","hash":"d7131ad268a9b1bb48ab1292196b2e5383ade92f","modified":1564744181510},{"_id":"public/categories/后端/page/2/index.html","hash":"d422e8a19c4948da7675f556a414da19330025c4","modified":1564744181510},{"_id":"public/categories/后端/运维/index.html","hash":"a8dff80e0003ce0bb92730d5276df78d1cc424c2","modified":1564744181510},{"_id":"public/categories/办公/index.html","hash":"64a71c507500b4ecabd40186956b9fb30ee4405b","modified":1564744181510},{"_id":"public/categories/办公/运维/index.html","hash":"57c83bae77a2d641144758c91092cf3d449cf74b","modified":1564744181510},{"_id":"public/categories/办公/后端/index.html","hash":"5ed98f8cab78f76caf5a76fb9a959fe2709d5d9d","modified":1564744181510},{"_id":"public/categories/办公/后端/运维/index.html","hash":"05b112cdf03cc9a5c1c1c80d2125fade0f9d07d3","modified":1564744181510},{"_id":"public/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1564744181515},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1564744181515},{"_id":"public/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1564744181515},{"_id":"public/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1564744181515},{"_id":"public/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1564744181515},{"_id":"public/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1564744181515},{"_id":"public/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1564744181515},{"_id":"public/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1564744181515},{"_id":"public/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1564744181515},{"_id":"public/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1564744181515},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1564744181516},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1564744181516},{"_id":"public/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1564744181516},{"_id":"public/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1564744181516},{"_id":"public/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1564744181516},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1564744181517},{"_id":"public/lib/needsharebutton/LICENSE","hash":"b29db4c99aa5b8d574026f68804051ff4b75466e","modified":1564744181517},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1564744181517},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1564744181833},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1564744181905},{"_id":"public/js/affix.js","hash":"a2aab233d99297435a5274bf512c3c753fe08e80","modified":1564744181916},{"_id":"public/js/algolia-search.js","hash":"1f7f10c579e7703d0f6acb8b73f3d78a07d0c623","modified":1564744181917},{"_id":"public/js/js.cookie.js","hash":"e0afce539f1fb81d59e3c6f0a68d736e2fb45d93","modified":1564744181917},{"_id":"public/js/exturl.js","hash":"54825acc8de4793feac415be227b965428f4e97d","modified":1564744181917},{"_id":"public/js/scrollspy.js","hash":"fa3c92968bcdbcb8d95a1729f7659d9753cbd077","modified":1564744181917},{"_id":"public/js/next-boot.js","hash":"262b6dae7d0585dd5bb2089df45bbe839a56d3b2","modified":1564744181917},{"_id":"public/js/post-details.js","hash":"a614a3830f7dfcd4df303c1255d558a135b3854e","modified":1564744181917},{"_id":"public/js/motion.js","hash":"ca2965da47ba9fc5b0dde0a825c29e0817b965b9","modified":1564744181917},{"_id":"public/js/scroll-cookie.js","hash":"d07b3776708d4ae79ed2037c4c7391d5c9b06b19","modified":1564744181917},{"_id":"public/js/schemes/muse.js","hash":"d6e4d1c937387d0d7891a41305ecdfe5597d6136","modified":1564744181917},{"_id":"public/js/schemes/pisces.js","hash":"9eb63cba0327d3d11b6cbfcbe40b88e97a8378a3","modified":1564744181917},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1564744181917},{"_id":"public/lib/needsharebutton/README.html","hash":"599c1ab725275700dcf9e21c0cee2f199ab2465f","modified":1564744181917},{"_id":"public/css/main.css","hash":"21943b5b41ac7aed8831fafae33ac15c9e54ccb8","modified":1564744181917},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1564744181917},{"_id":"public/js/utils.js","hash":"a8a526901495a8ce0d38f783c1b065400a88d148","modified":1564744181921},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1564744181921},{"_id":"public/lib/needsharebutton/needsharebutton.js","hash":"75dee2bb4796ca66693831d769d9a105eed8c290","modified":1564744181924},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"785df7889e1d82fe85ea67fd4cefce7af0f71bb5","modified":1564744181961},{"_id":"public/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1564744181984},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1564744181984},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"37ebf1c1567bdb92ba8e8595ab253f08efd6b9b9","modified":1564744181984},{"_id":"public/lib/needsharebutton/needsharebutton.css","hash":"ee5758b461f8475edf01fe5c8824e9fc9283ecee","modified":1564744181993},{"_id":"public/lib/jquery/index.js","hash":"88523924351bac0b5d560fe0c5781e2556e7693d","modified":1564744181998},{"_id":"public/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1564744182000}],"Category":[{"name":"运维","_id":"cjyu0a5kf00029ka47jhjkat6"},{"name":"前端","_id":"cjyu0a5ni00079ka4u6dmcnzc"},{"name":"后端","_id":"cjyu0a5nl000b9ka4hsx99jmk"},{"name":"运维","parent":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5nr000l9ka4stwlki2q"},{"name":"办公","_id":"cjyu0a5nt000r9ka4xc4zkk00"},{"name":"运维","parent":"cjyu0a5nt000r9ka4xc4zkk00","_id":"cjyu0a5og002u9ka4yh6avggh"},{"name":"后端","parent":"cjyu0a5nt000r9ka4xc4zkk00","_id":"cjyu0a5oi00319ka4m7ahchpb"},{"name":"运维","parent":"cjyu0a5oi00319ka4m7ahchpb","_id":"cjyu0a5ol003c9ka4jx12709b"}],"Data":[],"Page":[{"title":"adadd","url":"190.html","id":190,"comments":0,"date":"2017-10-04T13:04:56.000Z","_content":"","source":"adadd/index.md","raw":"---\ntitle: adadd\nurl: 190.html\nid: 190\ncomments: false\ndate: 2017-10-04 21:04:56\n---\n","updated":"2019-07-23T05:51:43.850Z","path":"adadd/index.html","layout":"page","_id":"cjyu0a5ke00019ka4eceo0uy6","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"示例页面","url":"2.html","id":2,"comments":0,"date":"2016-11-07T09:02:18.000Z","_content":"\n这是一个范例页面。它和博客文章不同，因为它的页面位置是固定的，同时会显示于您的博客导航栏（大多数主题中）。大多数人会新增一个“关于”页面向访客介绍自己。它可能类似下面这样：\n\n> 我是一个很有趣的人，我创建了工厂和庄园。并且，顺便提一下，我的妻子也很好。\n\n……或下面这样：\n\n> XYZ装置公司成立于1971年，公司成立以来，我们一直向市民提供高品质的装置。我们位于北京市，有超过2,000名员工，对北京市有着相当大的贡献。\n\n作为一个新的WordPress用户，您可以前往[您的仪表盘](http://www.zhuohc.com/wp-admin/)删除这个页面，并建立属于您的全新内容。祝您使用愉快！","source":"sample-page/index.md","raw":"---\ntitle: 示例页面\nurl: 2.html\nid: 2\ncomments: false\ndate: 2016-11-07 17:02:18\n---\n\n这是一个范例页面。它和博客文章不同，因为它的页面位置是固定的，同时会显示于您的博客导航栏（大多数主题中）。大多数人会新增一个“关于”页面向访客介绍自己。它可能类似下面这样：\n\n> 我是一个很有趣的人，我创建了工厂和庄园。并且，顺便提一下，我的妻子也很好。\n\n……或下面这样：\n\n> XYZ装置公司成立于1971年，公司成立以来，我们一直向市民提供高品质的装置。我们位于北京市，有超过2,000名员工，对北京市有着相当大的贡献。\n\n作为一个新的WordPress用户，您可以前往[您的仪表盘](http://www.zhuohc.com/wp-admin/)删除这个页面，并建立属于您的全新内容。祝您使用愉快！","updated":"2019-07-23T05:51:43.850Z","path":"sample-page/index.html","layout":"page","_id":"cjyu0a5ng00059ka497qczefr","content":"<p>这是一个范例页面。它和博客文章不同，因为它的页面位置是固定的，同时会显示于您的博客导航栏（大多数主题中）。大多数人会新增一个“关于”页面向访客介绍自己。它可能类似下面这样：</p>\n<blockquote>\n<p>我是一个很有趣的人，我创建了工厂和庄园。并且，顺便提一下，我的妻子也很好。</p>\n</blockquote>\n<p>……或下面这样：</p>\n<blockquote>\n<p>XYZ装置公司成立于1971年，公司成立以来，我们一直向市民提供高品质的装置。我们位于北京市，有超过2,000名员工，对北京市有着相当大的贡献。</p>\n</blockquote>\n<p>作为一个新的WordPress用户，您可以前往<a href=\"http://www.zhuohc.com/wp-admin/\">您的仪表盘</a>删除这个页面，并建立属于您的全新内容。祝您使用愉快！</p>\n","site":{"data":{}},"excerpt":"","more":"<p>这是一个范例页面。它和博客文章不同，因为它的页面位置是固定的，同时会显示于您的博客导航栏（大多数主题中）。大多数人会新增一个“关于”页面向访客介绍自己。它可能类似下面这样：</p>\n<blockquote>\n<p>我是一个很有趣的人，我创建了工厂和庄园。并且，顺便提一下，我的妻子也很好。</p>\n</blockquote>\n<p>……或下面这样：</p>\n<blockquote>\n<p>XYZ装置公司成立于1971年，公司成立以来，我们一直向市民提供高品质的装置。我们位于北京市，有超过2,000名员工，对北京市有着相当大的贡献。</p>\n</blockquote>\n<p>作为一个新的WordPress用户，您可以前往<a href=\"http://www.zhuohc.com/wp-admin/\">您的仪表盘</a>删除这个页面，并建立属于您的全新内容。祝您使用愉快！</p>\n"}],"Post":[{"title":"Apache入门基础","url":"50.html","id":"50","comments":0,"date":"2016-11-09T06:46:39.000Z","_content":"\n### 查看apache加载的模块\n\n    apachectl -t -D DUMP_MODULES  \n    \n\n### 禁用和启用模块\n\n    sudo a2dismod python\n    sudo a2enmod python\n    \n\n### 查看版本号\n\n    apachectl -v\n    \n\n### 赋予权限\n\n2.2.x以下版本\n\n    Order deny,allow\n    Allow from all\n    \n\n2.4.x以上版本\n\n    Require all granted","source":"_posts/apache入门基础.md","raw":"---\ntitle: Apache入门基础\nurl: 50.html\nid: 50\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-09 14:46:39\ntags:\n---\n\n### 查看apache加载的模块\n\n    apachectl -t -D DUMP_MODULES  \n    \n\n### 禁用和启用模块\n\n    sudo a2dismod python\n    sudo a2enmod python\n    \n\n### 查看版本号\n\n    apachectl -v\n    \n\n### 赋予权限\n\n2.2.x以下版本\n\n    Order deny,allow\n    Allow from all\n    \n\n2.4.x以上版本\n\n    Require all granted","slug":"apache入门基础","published":1,"updated":"2019-07-24T01:24:09.746Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5ka00009ka464ljlves","content":"<h3 id=\"查看apache加载的模块\"><a href=\"#查看apache加载的模块\" class=\"headerlink\" title=\"查看apache加载的模块\"></a>查看apache加载的模块</h3><pre><code>apachectl -t -D DUMP_MODULES  </code></pre><h3 id=\"禁用和启用模块\"><a href=\"#禁用和启用模块\" class=\"headerlink\" title=\"禁用和启用模块\"></a>禁用和启用模块</h3><pre><code>sudo a2dismod python\nsudo a2enmod python</code></pre><h3 id=\"查看版本号\"><a href=\"#查看版本号\" class=\"headerlink\" title=\"查看版本号\"></a>查看版本号</h3><pre><code>apachectl -v</code></pre><h3 id=\"赋予权限\"><a href=\"#赋予权限\" class=\"headerlink\" title=\"赋予权限\"></a>赋予权限</h3><p>2.2.x以下版本</p>\n<pre><code>Order deny,allow\nAllow from all</code></pre><p>2.4.x以上版本</p>\n<pre><code>Require all granted</code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"查看apache加载的模块\"><a href=\"#查看apache加载的模块\" class=\"headerlink\" title=\"查看apache加载的模块\"></a>查看apache加载的模块</h3><pre><code>apachectl -t -D DUMP_MODULES  </code></pre><h3 id=\"禁用和启用模块\"><a href=\"#禁用和启用模块\" class=\"headerlink\" title=\"禁用和启用模块\"></a>禁用和启用模块</h3><pre><code>sudo a2dismod python\nsudo a2enmod python</code></pre><h3 id=\"查看版本号\"><a href=\"#查看版本号\" class=\"headerlink\" title=\"查看版本号\"></a>查看版本号</h3><pre><code>apachectl -v</code></pre><h3 id=\"赋予权限\"><a href=\"#赋予权限\" class=\"headerlink\" title=\"赋予权限\"></a>赋予权限</h3><p>2.2.x以下版本</p>\n<pre><code>Order deny,allow\nAllow from all</code></pre><p>2.4.x以上版本</p>\n<pre><code>Require all granted</code></pre>"},{"title":"Window常用软件，网站及其使用方法","url":"20.html","id":"20","comments":0,"_content":"","source":"_drafts/Window常用软件，网站及其使用方法.md","raw":"---\ntitle: Window常用软件，网站及其使用方法\nurl: 20.html\nid: 20\ncomments: false\ncategories:\n  - 前端\ntags:\n---\n","slug":"Window常用软件，网站及其使用方法","published":0,"date":"2019-07-23T05:51:43.850Z","updated":"2019-07-23T05:51:43.850Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5ng00049ka46t65trof","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"centos7.2使用rabbitMQ","url":"549.html","id":"549","comments":0,"date":"2018-09-08T06:45:54.000Z","_content":"\n    # 安装 Erlang\n    yum -y install epel-release\n    yum -y update\n    yum -y install erlang socat\n    \n\n    # 查看是否安装成功\n    erl -version\n    \n\n    # 安装rabbitMQ\n    wget https://www.rabbitmq.com/releases/rabbitmq-server/v3.6.10/rabbitmq-server-3.6.10-1.el7.noarch.rpm\n    rpm --import https://www.rabbitmq.com/rabbitmq-release-signing-key.asc\n    rpm -Uvh rabbitmq-server-3.6.10-1.el7.noarch.rpm\n    \n\n    # 启用,开机启动,状态\n    systemctl start rabbitmq-server\n    systemctl enable rabbitmq-server\n    systemctl status rabbitmq-server\n    \n\n    # 启动图形界面管理\n    rabbitmq-plugins enable rabbitmq_management\n    chown -R rabbitmq:rabbitmq /var/lib/rabbitmq/\n    rabbitmqctl add_user admin StrongPassword  # 踩坑:密码不要以';'结尾\n    rabbitmqctl set_user_tags admin administrator\n    rabbitmqctl set_permissions -p / admin \".*\" \".*\" \".*\"\n    \n\n    # 自定义配置文件\n    cd /etc/rabbitmq\n    touch rabbitmq.conf\n    \n\n    # 访问图形界面\n    http://Your_Server_IP:15672/\n    \n\n    # api文档\n    http://Your_Server_IP:15672/api","source":"_posts/centos7.2使用rabbitMQ.md","raw":"---\ntitle: centos7.2使用rabbitMQ\nurl: 549.html\nid: 549\ncomments: false\ncategories:\n  - 后端\n  - 运维\ndate: 2018-09-08 14:45:54\ntags:\n---\n\n    # 安装 Erlang\n    yum -y install epel-release\n    yum -y update\n    yum -y install erlang socat\n    \n\n    # 查看是否安装成功\n    erl -version\n    \n\n    # 安装rabbitMQ\n    wget https://www.rabbitmq.com/releases/rabbitmq-server/v3.6.10/rabbitmq-server-3.6.10-1.el7.noarch.rpm\n    rpm --import https://www.rabbitmq.com/rabbitmq-release-signing-key.asc\n    rpm -Uvh rabbitmq-server-3.6.10-1.el7.noarch.rpm\n    \n\n    # 启用,开机启动,状态\n    systemctl start rabbitmq-server\n    systemctl enable rabbitmq-server\n    systemctl status rabbitmq-server\n    \n\n    # 启动图形界面管理\n    rabbitmq-plugins enable rabbitmq_management\n    chown -R rabbitmq:rabbitmq /var/lib/rabbitmq/\n    rabbitmqctl add_user admin StrongPassword  # 踩坑:密码不要以';'结尾\n    rabbitmqctl set_user_tags admin administrator\n    rabbitmqctl set_permissions -p / admin \".*\" \".*\" \".*\"\n    \n\n    # 自定义配置文件\n    cd /etc/rabbitmq\n    touch rabbitmq.conf\n    \n\n    # 访问图形界面\n    http://Your_Server_IP:15672/\n    \n\n    # api文档\n    http://Your_Server_IP:15672/api","slug":"centos7.2使用rabbitMQ","published":1,"updated":"2019-07-23T05:51:43.850Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5nh00069ka4f1xbg3w4","content":"<pre><code># 安装 Erlang\nyum -y install epel-release\nyum -y update\nyum -y install erlang socat\n\n\n# 查看是否安装成功\nerl -version\n\n\n# 安装rabbitMQ\nwget https://www.rabbitmq.com/releases/rabbitmq-server/v3.6.10/rabbitmq-server-3.6.10-1.el7.noarch.rpm\nrpm --import https://www.rabbitmq.com/rabbitmq-release-signing-key.asc\nrpm -Uvh rabbitmq-server-3.6.10-1.el7.noarch.rpm\n\n\n# 启用,开机启动,状态\nsystemctl start rabbitmq-server\nsystemctl enable rabbitmq-server\nsystemctl status rabbitmq-server\n\n\n# 启动图形界面管理\nrabbitmq-plugins enable rabbitmq_management\nchown -R rabbitmq:rabbitmq /var/lib/rabbitmq/\nrabbitmqctl add_user admin StrongPassword  # 踩坑:密码不要以&apos;;&apos;结尾\nrabbitmqctl set_user_tags admin administrator\nrabbitmqctl set_permissions -p / admin &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;\n\n\n# 自定义配置文件\ncd /etc/rabbitmq\ntouch rabbitmq.conf\n\n\n# 访问图形界面\nhttp://Your_Server_IP:15672/\n\n\n# api文档\nhttp://Your_Server_IP:15672/api</code></pre>","site":{"data":{}},"excerpt":"","more":"<pre><code># 安装 Erlang\nyum -y install epel-release\nyum -y update\nyum -y install erlang socat\n\n\n# 查看是否安装成功\nerl -version\n\n\n# 安装rabbitMQ\nwget https://www.rabbitmq.com/releases/rabbitmq-server/v3.6.10/rabbitmq-server-3.6.10-1.el7.noarch.rpm\nrpm --import https://www.rabbitmq.com/rabbitmq-release-signing-key.asc\nrpm -Uvh rabbitmq-server-3.6.10-1.el7.noarch.rpm\n\n\n# 启用,开机启动,状态\nsystemctl start rabbitmq-server\nsystemctl enable rabbitmq-server\nsystemctl status rabbitmq-server\n\n\n# 启动图形界面管理\nrabbitmq-plugins enable rabbitmq_management\nchown -R rabbitmq:rabbitmq /var/lib/rabbitmq/\nrabbitmqctl add_user admin StrongPassword  # 踩坑:密码不要以&apos;;&apos;结尾\nrabbitmqctl set_user_tags admin administrator\nrabbitmqctl set_permissions -p / admin &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;\n\n\n# 自定义配置文件\ncd /etc/rabbitmq\ntouch rabbitmq.conf\n\n\n# 访问图形界面\nhttp://Your_Server_IP:15672/\n\n\n# api文档\nhttp://Your_Server_IP:15672/api</code></pre>"},{"title":"centos7.2安装及使用docker","url":"557.html","id":"557","comments":0,"date":"2018-09-08T06:52:53.000Z","_content":"\n    # https://docs.docker.com/install/linux/docker-ce/centos/#install-docker-ce\n    # 卸载旧版本\n    $ sudo yum remove docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-selinux docker-engine-selinux docker-engine\n    # 安装依赖包\n    $ sudo yum install -y yum-utils device-mapper-persistent-data lvm2\n    # 安装源\n    $ sudo yum-config-manager  --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n    # 安装\n    $ sudo yum install docker-ce\n    # 启动\n    $ sudo systemctl start docker\n    $ sudo systemctl enable docker\n    # 测试\n    $ sudo docker run hello-world\n    # 加入用户组(记得退出重新登录) https://docs.docker.com/install/linux/linux-postinstall/#manage-docker-as-a-non-root-user\n    # 安装docker-compose\n    $ sudo yum install epel-release\n    $ sudo yum install python-pip\n    $ sudo pip install docker-compose\n    # 换源https://lug.ustc.edu.cn/wiki/mirrors/help/docker","source":"_posts/centos7.2安装及使用docker.md","raw":"---\ntitle: centos7.2安装及使用docker\nurl: 557.html\nid: 557\ncomments: false\ncategories:\n  - 后端\n  - 运维\ndate: 2018-09-08 14:52:53\ntags:\n---\n\n    # https://docs.docker.com/install/linux/docker-ce/centos/#install-docker-ce\n    # 卸载旧版本\n    $ sudo yum remove docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-selinux docker-engine-selinux docker-engine\n    # 安装依赖包\n    $ sudo yum install -y yum-utils device-mapper-persistent-data lvm2\n    # 安装源\n    $ sudo yum-config-manager  --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n    # 安装\n    $ sudo yum install docker-ce\n    # 启动\n    $ sudo systemctl start docker\n    $ sudo systemctl enable docker\n    # 测试\n    $ sudo docker run hello-world\n    # 加入用户组(记得退出重新登录) https://docs.docker.com/install/linux/linux-postinstall/#manage-docker-as-a-non-root-user\n    # 安装docker-compose\n    $ sudo yum install epel-release\n    $ sudo yum install python-pip\n    $ sudo pip install docker-compose\n    # 换源https://lug.ustc.edu.cn/wiki/mirrors/help/docker","slug":"centos7.2安装及使用docker","published":1,"updated":"2019-07-23T05:51:43.850Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5ni00089ka47d7ujt7z","content":"<pre><code># https://docs.docker.com/install/linux/docker-ce/centos/#install-docker-ce\n# 卸载旧版本\n$ sudo yum remove docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-selinux docker-engine-selinux docker-engine\n# 安装依赖包\n$ sudo yum install -y yum-utils device-mapper-persistent-data lvm2\n# 安装源\n$ sudo yum-config-manager  --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n# 安装\n$ sudo yum install docker-ce\n# 启动\n$ sudo systemctl start docker\n$ sudo systemctl enable docker\n# 测试\n$ sudo docker run hello-world\n# 加入用户组(记得退出重新登录) https://docs.docker.com/install/linux/linux-postinstall/#manage-docker-as-a-non-root-user\n# 安装docker-compose\n$ sudo yum install epel-release\n$ sudo yum install python-pip\n$ sudo pip install docker-compose\n# 换源https://lug.ustc.edu.cn/wiki/mirrors/help/docker</code></pre>","site":{"data":{}},"excerpt":"","more":"<pre><code># https://docs.docker.com/install/linux/docker-ce/centos/#install-docker-ce\n# 卸载旧版本\n$ sudo yum remove docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-selinux docker-engine-selinux docker-engine\n# 安装依赖包\n$ sudo yum install -y yum-utils device-mapper-persistent-data lvm2\n# 安装源\n$ sudo yum-config-manager  --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n# 安装\n$ sudo yum install docker-ce\n# 启动\n$ sudo systemctl start docker\n$ sudo systemctl enable docker\n# 测试\n$ sudo docker run hello-world\n# 加入用户组(记得退出重新登录) https://docs.docker.com/install/linux/linux-postinstall/#manage-docker-as-a-non-root-user\n# 安装docker-compose\n$ sudo yum install epel-release\n$ sudo yum install python-pip\n$ sudo pip install docker-compose\n# 换源https://lug.ustc.edu.cn/wiki/mirrors/help/docker</code></pre>"},{"title":"centos7.2安装使用sentry","url":"553.html","id":"553","comments":0,"date":"2018-09-08T06:48:41.000Z","_content":"\n    # 先安装docker  https://docs.docker.com/install/linux/docker-ce/centos/#install-docker-ce\n    # 后安装sentry   https://github.com/getsentry/onpremise\n    $ mkdir sentry\n    $ cd sentry\n    $ mkdir -p data/{sentry,postgres}\n    $ git clone https://github.com/getsentry/onpremise\n    $ cd onpremise\n    $ docker-compose run --rm web config generate-secret-key # 创建一个secret key并配置到docker-compose.yml中的SENTRY_SECRET_KEY.\n    $ docker-compose run --rm web upgrade # 创建数据库\n    $ docker-compose up -d  # 后台执行","source":"_posts/centos7.2安装使用sentry.md","raw":"---\ntitle: centos7.2安装使用sentry\nurl: 553.html\nid: 553\ncomments: false\ncategories:\n  - 运维\ndate: 2018-09-08 14:48:41\ntags:\n---\n\n    # 先安装docker  https://docs.docker.com/install/linux/docker-ce/centos/#install-docker-ce\n    # 后安装sentry   https://github.com/getsentry/onpremise\n    $ mkdir sentry\n    $ cd sentry\n    $ mkdir -p data/{sentry,postgres}\n    $ git clone https://github.com/getsentry/onpremise\n    $ cd onpremise\n    $ docker-compose run --rm web config generate-secret-key # 创建一个secret key并配置到docker-compose.yml中的SENTRY_SECRET_KEY.\n    $ docker-compose run --rm web upgrade # 创建数据库\n    $ docker-compose up -d  # 后台执行","slug":"centos7.2安装使用sentry","published":1,"updated":"2019-07-23T05:51:43.850Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5nj00099ka4bp8qf9ch","content":"<pre><code># 先安装docker  https://docs.docker.com/install/linux/docker-ce/centos/#install-docker-ce\n# 后安装sentry   https://github.com/getsentry/onpremise\n$ mkdir sentry\n$ cd sentry\n$ mkdir -p data/{sentry,postgres}\n$ git clone https://github.com/getsentry/onpremise\n$ cd onpremise\n$ docker-compose run --rm web config generate-secret-key # 创建一个secret key并配置到docker-compose.yml中的SENTRY_SECRET_KEY.\n$ docker-compose run --rm web upgrade # 创建数据库\n$ docker-compose up -d  # 后台执行</code></pre>","site":{"data":{}},"excerpt":"","more":"<pre><code># 先安装docker  https://docs.docker.com/install/linux/docker-ce/centos/#install-docker-ce\n# 后安装sentry   https://github.com/getsentry/onpremise\n$ mkdir sentry\n$ cd sentry\n$ mkdir -p data/{sentry,postgres}\n$ git clone https://github.com/getsentry/onpremise\n$ cd onpremise\n$ docker-compose run --rm web config generate-secret-key # 创建一个secret key并配置到docker-compose.yml中的SENTRY_SECRET_KEY.\n$ docker-compose run --rm web upgrade # 创建数据库\n$ docker-compose up -d  # 后台执行</code></pre>"},{"title":"centos安装s_h_a_d_o_w_s_o_c_k_s服务","url":"31.html","id":"31","comments":0,"date":"2016-11-09T02:22:52.000Z","_content":"\n### Python版本\n\n    python –version\n    \n\nCentOS6.5默认安装的Python版本是2.6.6，返回值为：Python 2.6.6\n\n### 安装setuptools\n\n    yum install -y python-setuptools\n    \n\n安装完毕后，easy_install命令就可以使用了。\n\n### 安装pip\n\neasy\\_install pip 通过easy\\_install安装pip是最为简单的方法。pip默认安装到/usr/bin目录下。\n\n### 安装s\\_h\\_a\\_d\\_o\\_w\\_s\\_o\\_c\\_k\\_s\n\n    pip install shadowsocks\n    \n\n### s\\_h\\_a\\_d\\_o\\_w\\_s\\_o\\_c\\_k\\_s的配置和使用\n\n至于s\\_h\\_a\\_d\\_o\\_w\\_s\\_o\\_c\\_k\\_s可以拿来做什么，这里就毋须赘述了。直接开始吧。\n\n### 创建s\\_h\\_a\\_d\\_o\\_w\\_s\\_o\\_c\\_k\\_ss的配置文件：\n\nCentOS下通过vim创建该配置，运行命令： vi /etc/shadowsocks.json\n\n    {\n    \"server\":\"your_server_ip\",\n    \"server_port\":8989,\n    \"local_address\": \"127.0.0.1\",\n    \"local_port\":1080,\n    \"password\":\"yourpassword\",\n    \"timeout\":600,\n    \"method\":\"aes-256-cfb\",\n    \"fast_open\": false,\n    \"workers\": 1\n    }\n    \n\n各字段的含义： server：服务器 IP (IPv4/IPv6)，注意这也将是服务端监听的 IP 地址  \nserver_port：监听的服务器端口  \nlocal_address：本地监听的 IP 地址  \nlocal_port：本地端端口  \npassword：用来加密的密码  \ntimeout：超时时间（秒）  \nmethod：加密方法，可选择 “bf-cfb”, “aes-256-cfb”, “des-cfb”, “rc4″, 等等。默认是一种不安全的加密，推荐用 “aes-256-cfb” fast\\_open：true 或 false。如果你的服务器 Linux 内核在3.7+，可以开启 fast\\_open 以降低延迟。开启方法： echo 3 > /proc/sys/net/ipv4/tcp_fastopen  \n开启之后，将 fast_open 的配置设置为 true 即可。  \nworks：works数量，默认为 1\n\n### 安装M2Crypto\n\n默认加密方法 table 速度很快，但很不安全。推荐使用 “aes-256-cfb” 或者 “bf-cfb”。请不要使用 “rc4″，它不安全。如果选择 “table” 之外的加密，需要安装 M2Crypto。 先安装依赖包：\n\n    yum install -y openssl-devel gcc swig python-devel autoconf libtool\n    \n\n### 安装setuptools\n\n    wget --no-check-certificate https://bitbucket.org/pypa/setuptools/raw/bootstrap/ez_setup.py\n    python ez_setup.py install\n    \n\n再通过pip安装M2Crypto：\n\n    pip install M2Crypto\n    \n\n### 安装 gevent\n\n安装 gevent可以提高 Shadowsocks 的性能。CentOS下安装gevent依赖libevent和greenlet。\n\n### 安装libevent\n\n    yum install -y libevent\n    \n\n### greenlet：\n\n    pip install greenlet\n    \n\n###安装gevent：\n\n    pip install gevent\n    \n\n### 命令行参数（服务器端启动命令）\n\n    ssserver -c /etc/shadowsocks.json\n    \n\n如果想在后台一直运行Shadowsocks，启动命令如下：\n\n    nohup ssserver -c /etc/shadowsocks.json > /dev/null 2>&1 &\n    \n\n备注：关于nohup，是可以让程序在后台运行的命令。 同时可以用命令行参数覆盖 /etc/shadowsocks.json 里的设置：\n\n    sslocal -s 服务器地址 -p 服务器端口 -l 本地端端口 -k 密码 -m 加密方法\n    ssserver -p 服务器端口 -k 密码 -m 加密方法\n    \n\n备注：sslocal是客户端程序；ssserver是服务端程序。\n\n### 防火墙设置（如有）\n\n编辑防火墙配置文件/etc/sysconfig/iptables，将服务器端口（server_port）放行。  \n新增一条防火墙规则：\n\n    iptables -A INPUT -m state --state NEW -m tcp -p tcp --dport 8989 -j ACCEPT\n    \n\n先要保存下:\n\n    service iptables save\n    \n\n重启防火墙iptables：\n\n    service iptables restart\n    \n\n至此，服务器端的 Shadowsocks 安装和配置完毕。 配置多个用户\n\n    {\n    \"timeout\": 600,\n    \"method\": \"aes-256-cfb\",\n    \"port_password\":\n    {\n    \"40001\": \"password1\",\n    \"40002\": \"password2\",\n    \"40003\": \"password3\"\n    },\n    \"_comment\":\n    {\n    \"40001\": \"xiaoming\",\n    \"40002\": \"lilei\",\n    \"40003\": \"mike\"\n    }\n    }","source":"_posts/centos安装s_h_a_d_o_w_s_o_c_k_s服务.md","raw":"---\ntitle: centos安装s_h_a_d_o_w_s_o_c_k_s服务\ntags:\n  - linux\nurl: 31.html\nid: 31\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-09 10:22:52\n---\n\n### Python版本\n\n    python –version\n    \n\nCentOS6.5默认安装的Python版本是2.6.6，返回值为：Python 2.6.6\n\n### 安装setuptools\n\n    yum install -y python-setuptools\n    \n\n安装完毕后，easy_install命令就可以使用了。\n\n### 安装pip\n\neasy\\_install pip 通过easy\\_install安装pip是最为简单的方法。pip默认安装到/usr/bin目录下。\n\n### 安装s\\_h\\_a\\_d\\_o\\_w\\_s\\_o\\_c\\_k\\_s\n\n    pip install shadowsocks\n    \n\n### s\\_h\\_a\\_d\\_o\\_w\\_s\\_o\\_c\\_k\\_s的配置和使用\n\n至于s\\_h\\_a\\_d\\_o\\_w\\_s\\_o\\_c\\_k\\_s可以拿来做什么，这里就毋须赘述了。直接开始吧。\n\n### 创建s\\_h\\_a\\_d\\_o\\_w\\_s\\_o\\_c\\_k\\_ss的配置文件：\n\nCentOS下通过vim创建该配置，运行命令： vi /etc/shadowsocks.json\n\n    {\n    \"server\":\"your_server_ip\",\n    \"server_port\":8989,\n    \"local_address\": \"127.0.0.1\",\n    \"local_port\":1080,\n    \"password\":\"yourpassword\",\n    \"timeout\":600,\n    \"method\":\"aes-256-cfb\",\n    \"fast_open\": false,\n    \"workers\": 1\n    }\n    \n\n各字段的含义： server：服务器 IP (IPv4/IPv6)，注意这也将是服务端监听的 IP 地址  \nserver_port：监听的服务器端口  \nlocal_address：本地监听的 IP 地址  \nlocal_port：本地端端口  \npassword：用来加密的密码  \ntimeout：超时时间（秒）  \nmethod：加密方法，可选择 “bf-cfb”, “aes-256-cfb”, “des-cfb”, “rc4″, 等等。默认是一种不安全的加密，推荐用 “aes-256-cfb” fast\\_open：true 或 false。如果你的服务器 Linux 内核在3.7+，可以开启 fast\\_open 以降低延迟。开启方法： echo 3 > /proc/sys/net/ipv4/tcp_fastopen  \n开启之后，将 fast_open 的配置设置为 true 即可。  \nworks：works数量，默认为 1\n\n### 安装M2Crypto\n\n默认加密方法 table 速度很快，但很不安全。推荐使用 “aes-256-cfb” 或者 “bf-cfb”。请不要使用 “rc4″，它不安全。如果选择 “table” 之外的加密，需要安装 M2Crypto。 先安装依赖包：\n\n    yum install -y openssl-devel gcc swig python-devel autoconf libtool\n    \n\n### 安装setuptools\n\n    wget --no-check-certificate https://bitbucket.org/pypa/setuptools/raw/bootstrap/ez_setup.py\n    python ez_setup.py install\n    \n\n再通过pip安装M2Crypto：\n\n    pip install M2Crypto\n    \n\n### 安装 gevent\n\n安装 gevent可以提高 Shadowsocks 的性能。CentOS下安装gevent依赖libevent和greenlet。\n\n### 安装libevent\n\n    yum install -y libevent\n    \n\n### greenlet：\n\n    pip install greenlet\n    \n\n###安装gevent：\n\n    pip install gevent\n    \n\n### 命令行参数（服务器端启动命令）\n\n    ssserver -c /etc/shadowsocks.json\n    \n\n如果想在后台一直运行Shadowsocks，启动命令如下：\n\n    nohup ssserver -c /etc/shadowsocks.json > /dev/null 2>&1 &\n    \n\n备注：关于nohup，是可以让程序在后台运行的命令。 同时可以用命令行参数覆盖 /etc/shadowsocks.json 里的设置：\n\n    sslocal -s 服务器地址 -p 服务器端口 -l 本地端端口 -k 密码 -m 加密方法\n    ssserver -p 服务器端口 -k 密码 -m 加密方法\n    \n\n备注：sslocal是客户端程序；ssserver是服务端程序。\n\n### 防火墙设置（如有）\n\n编辑防火墙配置文件/etc/sysconfig/iptables，将服务器端口（server_port）放行。  \n新增一条防火墙规则：\n\n    iptables -A INPUT -m state --state NEW -m tcp -p tcp --dport 8989 -j ACCEPT\n    \n\n先要保存下:\n\n    service iptables save\n    \n\n重启防火墙iptables：\n\n    service iptables restart\n    \n\n至此，服务器端的 Shadowsocks 安装和配置完毕。 配置多个用户\n\n    {\n    \"timeout\": 600,\n    \"method\": \"aes-256-cfb\",\n    \"port_password\":\n    {\n    \"40001\": \"password1\",\n    \"40002\": \"password2\",\n    \"40003\": \"password3\"\n    },\n    \"_comment\":\n    {\n    \"40001\": \"xiaoming\",\n    \"40002\": \"lilei\",\n    \"40003\": \"mike\"\n    }\n    }","slug":"centos安装s_h_a_d_o_w_s_o_c_k_s服务","published":1,"updated":"2019-07-24T01:24:32.490Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5nk000a9ka4f622z4yq","content":"<h3 id=\"Python版本\"><a href=\"#Python版本\" class=\"headerlink\" title=\"Python版本\"></a>Python版本</h3><pre><code>python –version</code></pre><p>CentOS6.5默认安装的Python版本是2.6.6，返回值为：Python 2.6.6</p>\n<h3 id=\"安装setuptools\"><a href=\"#安装setuptools\" class=\"headerlink\" title=\"安装setuptools\"></a>安装setuptools</h3><pre><code>yum install -y python-setuptools</code></pre><p>安装完毕后，easy_install命令就可以使用了。</p>\n<h3 id=\"安装pip\"><a href=\"#安装pip\" class=\"headerlink\" title=\"安装pip\"></a>安装pip</h3><p>easy_install pip 通过easy_install安装pip是最为简单的方法。pip默认安装到/usr/bin目录下。</p>\n<h3 id=\"安装s-h-a-d-o-w-s-o-c-k-s\"><a href=\"#安装s-h-a-d-o-w-s-o-c-k-s\" class=\"headerlink\" title=\"安装s_h_a_d_o_w_s_o_c_k_s\"></a>安装s_h_a_d_o_w_s_o_c_k_s</h3><pre><code>pip install shadowsocks</code></pre><h3 id=\"s-h-a-d-o-w-s-o-c-k-s的配置和使用\"><a href=\"#s-h-a-d-o-w-s-o-c-k-s的配置和使用\" class=\"headerlink\" title=\"s_h_a_d_o_w_s_o_c_k_s的配置和使用\"></a>s_h_a_d_o_w_s_o_c_k_s的配置和使用</h3><p>至于s_h_a_d_o_w_s_o_c_k_s可以拿来做什么，这里就毋须赘述了。直接开始吧。</p>\n<h3 id=\"创建s-h-a-d-o-w-s-o-c-k-ss的配置文件：\"><a href=\"#创建s-h-a-d-o-w-s-o-c-k-ss的配置文件：\" class=\"headerlink\" title=\"创建s_h_a_d_o_w_s_o_c_k_ss的配置文件：\"></a>创建s_h_a_d_o_w_s_o_c_k_ss的配置文件：</h3><p>CentOS下通过vim创建该配置，运行命令： vi /etc/shadowsocks.json</p>\n<pre><code>{\n&quot;server&quot;:&quot;your_server_ip&quot;,\n&quot;server_port&quot;:8989,\n&quot;local_address&quot;: &quot;127.0.0.1&quot;,\n&quot;local_port&quot;:1080,\n&quot;password&quot;:&quot;yourpassword&quot;,\n&quot;timeout&quot;:600,\n&quot;method&quot;:&quot;aes-256-cfb&quot;,\n&quot;fast_open&quot;: false,\n&quot;workers&quot;: 1\n}</code></pre><p>各字段的含义： server：服务器 IP (IPv4/IPv6)，注意这也将是服务端监听的 IP 地址<br>server_port：监听的服务器端口<br>local_address：本地监听的 IP 地址<br>local_port：本地端端口<br>password：用来加密的密码<br>timeout：超时时间（秒）<br>method：加密方法，可选择 “bf-cfb”, “aes-256-cfb”, “des-cfb”, “rc4″, 等等。默认是一种不安全的加密，推荐用 “aes-256-cfb” fast_open：true 或 false。如果你的服务器 Linux 内核在3.7+，可以开启 fast_open 以降低延迟。开启方法： echo 3 &gt; /proc/sys/net/ipv4/tcp_fastopen<br>开启之后，将 fast_open 的配置设置为 true 即可。<br>works：works数量，默认为 1</p>\n<h3 id=\"安装M2Crypto\"><a href=\"#安装M2Crypto\" class=\"headerlink\" title=\"安装M2Crypto\"></a>安装M2Crypto</h3><p>默认加密方法 table 速度很快，但很不安全。推荐使用 “aes-256-cfb” 或者 “bf-cfb”。请不要使用 “rc4″，它不安全。如果选择 “table” 之外的加密，需要安装 M2Crypto。 先安装依赖包：</p>\n<pre><code>yum install -y openssl-devel gcc swig python-devel autoconf libtool</code></pre><h3 id=\"安装setuptools-1\"><a href=\"#安装setuptools-1\" class=\"headerlink\" title=\"安装setuptools\"></a>安装setuptools</h3><pre><code>wget --no-check-certificate https://bitbucket.org/pypa/setuptools/raw/bootstrap/ez_setup.py\npython ez_setup.py install</code></pre><p>再通过pip安装M2Crypto：</p>\n<pre><code>pip install M2Crypto</code></pre><h3 id=\"安装-gevent\"><a href=\"#安装-gevent\" class=\"headerlink\" title=\"安装 gevent\"></a>安装 gevent</h3><p>安装 gevent可以提高 Shadowsocks 的性能。CentOS下安装gevent依赖libevent和greenlet。</p>\n<h3 id=\"安装libevent\"><a href=\"#安装libevent\" class=\"headerlink\" title=\"安装libevent\"></a>安装libevent</h3><pre><code>yum install -y libevent</code></pre><h3 id=\"greenlet：\"><a href=\"#greenlet：\" class=\"headerlink\" title=\"greenlet：\"></a>greenlet：</h3><pre><code>pip install greenlet</code></pre><p>###安装gevent：</p>\n<pre><code>pip install gevent</code></pre><h3 id=\"命令行参数（服务器端启动命令）\"><a href=\"#命令行参数（服务器端启动命令）\" class=\"headerlink\" title=\"命令行参数（服务器端启动命令）\"></a>命令行参数（服务器端启动命令）</h3><pre><code>ssserver -c /etc/shadowsocks.json</code></pre><p>如果想在后台一直运行Shadowsocks，启动命令如下：</p>\n<pre><code>nohup ssserver -c /etc/shadowsocks.json &gt; /dev/null 2&gt;&amp;1 &amp;</code></pre><p>备注：关于nohup，是可以让程序在后台运行的命令。 同时可以用命令行参数覆盖 /etc/shadowsocks.json 里的设置：</p>\n<pre><code>sslocal -s 服务器地址 -p 服务器端口 -l 本地端端口 -k 密码 -m 加密方法\nssserver -p 服务器端口 -k 密码 -m 加密方法</code></pre><p>备注：sslocal是客户端程序；ssserver是服务端程序。</p>\n<h3 id=\"防火墙设置（如有）\"><a href=\"#防火墙设置（如有）\" class=\"headerlink\" title=\"防火墙设置（如有）\"></a>防火墙设置（如有）</h3><p>编辑防火墙配置文件/etc/sysconfig/iptables，将服务器端口（server_port）放行。<br>新增一条防火墙规则：</p>\n<pre><code>iptables -A INPUT -m state --state NEW -m tcp -p tcp --dport 8989 -j ACCEPT</code></pre><p>先要保存下:</p>\n<pre><code>service iptables save</code></pre><p>重启防火墙iptables：</p>\n<pre><code>service iptables restart</code></pre><p>至此，服务器端的 Shadowsocks 安装和配置完毕。 配置多个用户</p>\n<pre><code>{\n&quot;timeout&quot;: 600,\n&quot;method&quot;: &quot;aes-256-cfb&quot;,\n&quot;port_password&quot;:\n{\n&quot;40001&quot;: &quot;password1&quot;,\n&quot;40002&quot;: &quot;password2&quot;,\n&quot;40003&quot;: &quot;password3&quot;\n},\n&quot;_comment&quot;:\n{\n&quot;40001&quot;: &quot;xiaoming&quot;,\n&quot;40002&quot;: &quot;lilei&quot;,\n&quot;40003&quot;: &quot;mike&quot;\n}\n}</code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Python版本\"><a href=\"#Python版本\" class=\"headerlink\" title=\"Python版本\"></a>Python版本</h3><pre><code>python –version</code></pre><p>CentOS6.5默认安装的Python版本是2.6.6，返回值为：Python 2.6.6</p>\n<h3 id=\"安装setuptools\"><a href=\"#安装setuptools\" class=\"headerlink\" title=\"安装setuptools\"></a>安装setuptools</h3><pre><code>yum install -y python-setuptools</code></pre><p>安装完毕后，easy_install命令就可以使用了。</p>\n<h3 id=\"安装pip\"><a href=\"#安装pip\" class=\"headerlink\" title=\"安装pip\"></a>安装pip</h3><p>easy_install pip 通过easy_install安装pip是最为简单的方法。pip默认安装到/usr/bin目录下。</p>\n<h3 id=\"安装s-h-a-d-o-w-s-o-c-k-s\"><a href=\"#安装s-h-a-d-o-w-s-o-c-k-s\" class=\"headerlink\" title=\"安装s_h_a_d_o_w_s_o_c_k_s\"></a>安装s_h_a_d_o_w_s_o_c_k_s</h3><pre><code>pip install shadowsocks</code></pre><h3 id=\"s-h-a-d-o-w-s-o-c-k-s的配置和使用\"><a href=\"#s-h-a-d-o-w-s-o-c-k-s的配置和使用\" class=\"headerlink\" title=\"s_h_a_d_o_w_s_o_c_k_s的配置和使用\"></a>s_h_a_d_o_w_s_o_c_k_s的配置和使用</h3><p>至于s_h_a_d_o_w_s_o_c_k_s可以拿来做什么，这里就毋须赘述了。直接开始吧。</p>\n<h3 id=\"创建s-h-a-d-o-w-s-o-c-k-ss的配置文件：\"><a href=\"#创建s-h-a-d-o-w-s-o-c-k-ss的配置文件：\" class=\"headerlink\" title=\"创建s_h_a_d_o_w_s_o_c_k_ss的配置文件：\"></a>创建s_h_a_d_o_w_s_o_c_k_ss的配置文件：</h3><p>CentOS下通过vim创建该配置，运行命令： vi /etc/shadowsocks.json</p>\n<pre><code>{\n&quot;server&quot;:&quot;your_server_ip&quot;,\n&quot;server_port&quot;:8989,\n&quot;local_address&quot;: &quot;127.0.0.1&quot;,\n&quot;local_port&quot;:1080,\n&quot;password&quot;:&quot;yourpassword&quot;,\n&quot;timeout&quot;:600,\n&quot;method&quot;:&quot;aes-256-cfb&quot;,\n&quot;fast_open&quot;: false,\n&quot;workers&quot;: 1\n}</code></pre><p>各字段的含义： server：服务器 IP (IPv4/IPv6)，注意这也将是服务端监听的 IP 地址<br>server_port：监听的服务器端口<br>local_address：本地监听的 IP 地址<br>local_port：本地端端口<br>password：用来加密的密码<br>timeout：超时时间（秒）<br>method：加密方法，可选择 “bf-cfb”, “aes-256-cfb”, “des-cfb”, “rc4″, 等等。默认是一种不安全的加密，推荐用 “aes-256-cfb” fast_open：true 或 false。如果你的服务器 Linux 内核在3.7+，可以开启 fast_open 以降低延迟。开启方法： echo 3 &gt; /proc/sys/net/ipv4/tcp_fastopen<br>开启之后，将 fast_open 的配置设置为 true 即可。<br>works：works数量，默认为 1</p>\n<h3 id=\"安装M2Crypto\"><a href=\"#安装M2Crypto\" class=\"headerlink\" title=\"安装M2Crypto\"></a>安装M2Crypto</h3><p>默认加密方法 table 速度很快，但很不安全。推荐使用 “aes-256-cfb” 或者 “bf-cfb”。请不要使用 “rc4″，它不安全。如果选择 “table” 之外的加密，需要安装 M2Crypto。 先安装依赖包：</p>\n<pre><code>yum install -y openssl-devel gcc swig python-devel autoconf libtool</code></pre><h3 id=\"安装setuptools-1\"><a href=\"#安装setuptools-1\" class=\"headerlink\" title=\"安装setuptools\"></a>安装setuptools</h3><pre><code>wget --no-check-certificate https://bitbucket.org/pypa/setuptools/raw/bootstrap/ez_setup.py\npython ez_setup.py install</code></pre><p>再通过pip安装M2Crypto：</p>\n<pre><code>pip install M2Crypto</code></pre><h3 id=\"安装-gevent\"><a href=\"#安装-gevent\" class=\"headerlink\" title=\"安装 gevent\"></a>安装 gevent</h3><p>安装 gevent可以提高 Shadowsocks 的性能。CentOS下安装gevent依赖libevent和greenlet。</p>\n<h3 id=\"安装libevent\"><a href=\"#安装libevent\" class=\"headerlink\" title=\"安装libevent\"></a>安装libevent</h3><pre><code>yum install -y libevent</code></pre><h3 id=\"greenlet：\"><a href=\"#greenlet：\" class=\"headerlink\" title=\"greenlet：\"></a>greenlet：</h3><pre><code>pip install greenlet</code></pre><p>###安装gevent：</p>\n<pre><code>pip install gevent</code></pre><h3 id=\"命令行参数（服务器端启动命令）\"><a href=\"#命令行参数（服务器端启动命令）\" class=\"headerlink\" title=\"命令行参数（服务器端启动命令）\"></a>命令行参数（服务器端启动命令）</h3><pre><code>ssserver -c /etc/shadowsocks.json</code></pre><p>如果想在后台一直运行Shadowsocks，启动命令如下：</p>\n<pre><code>nohup ssserver -c /etc/shadowsocks.json &gt; /dev/null 2&gt;&amp;1 &amp;</code></pre><p>备注：关于nohup，是可以让程序在后台运行的命令。 同时可以用命令行参数覆盖 /etc/shadowsocks.json 里的设置：</p>\n<pre><code>sslocal -s 服务器地址 -p 服务器端口 -l 本地端端口 -k 密码 -m 加密方法\nssserver -p 服务器端口 -k 密码 -m 加密方法</code></pre><p>备注：sslocal是客户端程序；ssserver是服务端程序。</p>\n<h3 id=\"防火墙设置（如有）\"><a href=\"#防火墙设置（如有）\" class=\"headerlink\" title=\"防火墙设置（如有）\"></a>防火墙设置（如有）</h3><p>编辑防火墙配置文件/etc/sysconfig/iptables，将服务器端口（server_port）放行。<br>新增一条防火墙规则：</p>\n<pre><code>iptables -A INPUT -m state --state NEW -m tcp -p tcp --dport 8989 -j ACCEPT</code></pre><p>先要保存下:</p>\n<pre><code>service iptables save</code></pre><p>重启防火墙iptables：</p>\n<pre><code>service iptables restart</code></pre><p>至此，服务器端的 Shadowsocks 安装和配置完毕。 配置多个用户</p>\n<pre><code>{\n&quot;timeout&quot;: 600,\n&quot;method&quot;: &quot;aes-256-cfb&quot;,\n&quot;port_password&quot;:\n{\n&quot;40001&quot;: &quot;password1&quot;,\n&quot;40002&quot;: &quot;password2&quot;,\n&quot;40003&quot;: &quot;password3&quot;\n},\n&quot;_comment&quot;:\n{\n&quot;40001&quot;: &quot;xiaoming&quot;,\n&quot;40002&quot;: &quot;lilei&quot;,\n&quot;40003&quot;: &quot;mike&quot;\n}\n}</code></pre>"},{"title":"css兼容性汇总","url":"82.html","id":"82","comments":0,"date":"2016-11-10T02:07:27.000Z","_content":"\n### ie6,ie7中overflow:hidden失效问题\n\n在父元素中使用position:relative;可以hack iframe自适应高度\n\n### 不建议使用iframe\n\n首先在css里面设置一个min-height\n\n    min-height: 100px;\n    \n\n主页面嵌入如下js代码\n\n    <script>\n        function setIframeHeight(iframe) {\n            if (iframe) {\n                var iframeWin = iframe.contentWindow || iframe.contentDocument.parentWindow;\n                if (iframeWin.document.body) {\n                    iframe.height = iframeWin.document.documentElement.scrollHeight || iframeWin.document.body.scrollHeight;\n                }\n            }\n        };\n        window.onload = function () {\n            setIframeHeight(document.getElementById('external-frame'));\n        };\n    </script>\n    \n\niframe标签里\n\n    <iframe src=\"backtop.html\" frameborder=\"0\" scrolling=\"no\" id=\"external-frame\" onload=\"setIframeHeight(this)\"></iframe>\n    \n\ncss代码\n\n      ul {\n        display: block;\n        width: 100%;\n        height: 100%;\n        text-indent: 0;\n        padding: 0;\n        position: absolute;\n        top: -100%;\n        left: 0;  \n        }\n    \n\njs代码\n\n    var defaultTopPosition = $('#indexCellcate').css('top');\n    \n\n浏览器差异\n\n    ie7，ie8 返回-205.422px  \n    现代chrome，firefox -205.422px  \n    但是ie9及以上会返回0px \n    \n\n如果将css中的top设置为-205.422px，则无差异。  \n但响应式布局要求百分百设置,我的解决思路:  \n获取对应元素的高度来替代top值\n\n    var defaultTopPosition = cellcate.children('li').height();\n    defaultTopPosition = -parseInt(defaultTopPosition);","source":"_posts/css兼容性汇总.md","raw":"---\ntitle: css兼容性汇总\nurl: 82.html\nid: 82\ncomments: false\ncategories:\n  - 前端\ndate: 2016-11-10 10:07:27\ntags:\n---\n\n### ie6,ie7中overflow:hidden失效问题\n\n在父元素中使用position:relative;可以hack iframe自适应高度\n\n### 不建议使用iframe\n\n首先在css里面设置一个min-height\n\n    min-height: 100px;\n    \n\n主页面嵌入如下js代码\n\n    <script>\n        function setIframeHeight(iframe) {\n            if (iframe) {\n                var iframeWin = iframe.contentWindow || iframe.contentDocument.parentWindow;\n                if (iframeWin.document.body) {\n                    iframe.height = iframeWin.document.documentElement.scrollHeight || iframeWin.document.body.scrollHeight;\n                }\n            }\n        };\n        window.onload = function () {\n            setIframeHeight(document.getElementById('external-frame'));\n        };\n    </script>\n    \n\niframe标签里\n\n    <iframe src=\"backtop.html\" frameborder=\"0\" scrolling=\"no\" id=\"external-frame\" onload=\"setIframeHeight(this)\"></iframe>\n    \n\ncss代码\n\n      ul {\n        display: block;\n        width: 100%;\n        height: 100%;\n        text-indent: 0;\n        padding: 0;\n        position: absolute;\n        top: -100%;\n        left: 0;  \n        }\n    \n\njs代码\n\n    var defaultTopPosition = $('#indexCellcate').css('top');\n    \n\n浏览器差异\n\n    ie7，ie8 返回-205.422px  \n    现代chrome，firefox -205.422px  \n    但是ie9及以上会返回0px \n    \n\n如果将css中的top设置为-205.422px，则无差异。  \n但响应式布局要求百分百设置,我的解决思路:  \n获取对应元素的高度来替代top值\n\n    var defaultTopPosition = cellcate.children('li').height();\n    defaultTopPosition = -parseInt(defaultTopPosition);","slug":"css兼容性汇总","published":1,"updated":"2019-07-24T01:24:32.476Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5nl000c9ka4abm2fh7s","content":"<h3 id=\"ie6-ie7中overflow-hidden失效问题\"><a href=\"#ie6-ie7中overflow-hidden失效问题\" class=\"headerlink\" title=\"ie6,ie7中overflow:hidden失效问题\"></a>ie6,ie7中overflow:hidden失效问题</h3><p>在父元素中使用position:relative;可以hack iframe自适应高度</p>\n<h3 id=\"不建议使用iframe\"><a href=\"#不建议使用iframe\" class=\"headerlink\" title=\"不建议使用iframe\"></a>不建议使用iframe</h3><p>首先在css里面设置一个min-height</p>\n<pre><code>min-height: 100px;</code></pre><p>主页面嵌入如下js代码</p>\n<pre><code>&lt;script&gt;\n    function setIframeHeight(iframe) {\n        if (iframe) {\n            var iframeWin = iframe.contentWindow || iframe.contentDocument.parentWindow;\n            if (iframeWin.document.body) {\n                iframe.height = iframeWin.document.documentElement.scrollHeight || iframeWin.document.body.scrollHeight;\n            }\n        }\n    };\n    window.onload = function () {\n        setIframeHeight(document.getElementById(&apos;external-frame&apos;));\n    };\n&lt;/script&gt;</code></pre><p>iframe标签里</p>\n<pre><code>&lt;iframe src=&quot;backtop.html&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot; id=&quot;external-frame&quot; onload=&quot;setIframeHeight(this)&quot;&gt;&lt;/iframe&gt;</code></pre><p>css代码</p>\n<pre><code>ul {\n  display: block;\n  width: 100%;\n  height: 100%;\n  text-indent: 0;\n  padding: 0;\n  position: absolute;\n  top: -100%;\n  left: 0;  \n  }</code></pre><p>js代码</p>\n<pre><code>var defaultTopPosition = $(&apos;#indexCellcate&apos;).css(&apos;top&apos;);</code></pre><p>浏览器差异</p>\n<pre><code>ie7，ie8 返回-205.422px  \n现代chrome，firefox -205.422px  \n但是ie9及以上会返回0px </code></pre><p>如果将css中的top设置为-205.422px，则无差异。<br>但响应式布局要求百分百设置,我的解决思路:<br>获取对应元素的高度来替代top值</p>\n<pre><code>var defaultTopPosition = cellcate.children(&apos;li&apos;).height();\ndefaultTopPosition = -parseInt(defaultTopPosition);</code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"ie6-ie7中overflow-hidden失效问题\"><a href=\"#ie6-ie7中overflow-hidden失效问题\" class=\"headerlink\" title=\"ie6,ie7中overflow:hidden失效问题\"></a>ie6,ie7中overflow:hidden失效问题</h3><p>在父元素中使用position:relative;可以hack iframe自适应高度</p>\n<h3 id=\"不建议使用iframe\"><a href=\"#不建议使用iframe\" class=\"headerlink\" title=\"不建议使用iframe\"></a>不建议使用iframe</h3><p>首先在css里面设置一个min-height</p>\n<pre><code>min-height: 100px;</code></pre><p>主页面嵌入如下js代码</p>\n<pre><code>&lt;script&gt;\n    function setIframeHeight(iframe) {\n        if (iframe) {\n            var iframeWin = iframe.contentWindow || iframe.contentDocument.parentWindow;\n            if (iframeWin.document.body) {\n                iframe.height = iframeWin.document.documentElement.scrollHeight || iframeWin.document.body.scrollHeight;\n            }\n        }\n    };\n    window.onload = function () {\n        setIframeHeight(document.getElementById(&apos;external-frame&apos;));\n    };\n&lt;/script&gt;</code></pre><p>iframe标签里</p>\n<pre><code>&lt;iframe src=&quot;backtop.html&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot; id=&quot;external-frame&quot; onload=&quot;setIframeHeight(this)&quot;&gt;&lt;/iframe&gt;</code></pre><p>css代码</p>\n<pre><code>ul {\n  display: block;\n  width: 100%;\n  height: 100%;\n  text-indent: 0;\n  padding: 0;\n  position: absolute;\n  top: -100%;\n  left: 0;  \n  }</code></pre><p>js代码</p>\n<pre><code>var defaultTopPosition = $(&apos;#indexCellcate&apos;).css(&apos;top&apos;);</code></pre><p>浏览器差异</p>\n<pre><code>ie7，ie8 返回-205.422px  \n现代chrome，firefox -205.422px  \n但是ie9及以上会返回0px </code></pre><p>如果将css中的top设置为-205.422px，则无差异。<br>但响应式布局要求百分百设置,我的解决思路:<br>获取对应元素的高度来替代top值</p>\n<pre><code>var defaultTopPosition = cellcate.children(&apos;li&apos;).height();\ndefaultTopPosition = -parseInt(defaultTopPosition);</code></pre>"},{"title":"Excel入门基础","url":"61.html","id":"61","comments":0,"date":"2016-11-09T07:14:08.000Z","_content":"\n### 返回最后一个值、倒数第二个值\n\n    =LOOKUP(1,0/(A2:J2<>\"\"),A2:J2)\n    =LOOKUP(1,0/(B2:J2<>\"\"),A2:J2)\n    \n\n### 返回时间差\n\n    =DATEDIF(--TEXT(F2,\"00-00-00\"),TODAY(),\"D\")\n    \n\n### VLOOKUP 逆向检索\n\n> http://zhidao.baidu.com/link?url=-1b12Kx36WQ4vf05DIDhZmxCOtvC6Zdhc62kve1QRoF-hV_Hbl3cZDuBZOYgGRjEo513fDk9-UL6gfUnMI9Jna\n\n    =VLOOKUP(C2,IF({1,0},Sheet2!$D$2:$D$5,Sheet2!$A$2:$A$5),2,FALSE)\n    =INDEX(Sheet2!A:A,MATCH(Sheet1!C2,Sheet2!D:D,0))\n    \n\n### 多条件统计求和 COUNTIFS\n\n统计每个部门人数\n\n    {=SUM(IFERROR(1/(COUNTIFS(Sheet2!L$2:Sheet2!L$250,B5,Sheet2!N$2:Sheet2!N$250,Sheet2!N$2:Sheet2!N$250)*(Sheet2!L$2:Sheet2!L$250=B5)),))}\n    \n\n![](http://7xq3ry.com1.z0.glb.clouddn.com/20160304142206.png)","source":"_posts/excel入门基础.md","raw":"---\ntitle: Excel入门基础\nurl: 61.html\nid: 61\ncomments: false\ncategories:\n  - 办公\ndate: 2016-11-09 15:14:08\ntags:\n---\n\n### 返回最后一个值、倒数第二个值\n\n    =LOOKUP(1,0/(A2:J2<>\"\"),A2:J2)\n    =LOOKUP(1,0/(B2:J2<>\"\"),A2:J2)\n    \n\n### 返回时间差\n\n    =DATEDIF(--TEXT(F2,\"00-00-00\"),TODAY(),\"D\")\n    \n\n### VLOOKUP 逆向检索\n\n> http://zhidao.baidu.com/link?url=-1b12Kx36WQ4vf05DIDhZmxCOtvC6Zdhc62kve1QRoF-hV_Hbl3cZDuBZOYgGRjEo513fDk9-UL6gfUnMI9Jna\n\n    =VLOOKUP(C2,IF({1,0},Sheet2!$D$2:$D$5,Sheet2!$A$2:$A$5),2,FALSE)\n    =INDEX(Sheet2!A:A,MATCH(Sheet1!C2,Sheet2!D:D,0))\n    \n\n### 多条件统计求和 COUNTIFS\n\n统计每个部门人数\n\n    {=SUM(IFERROR(1/(COUNTIFS(Sheet2!L$2:Sheet2!L$250,B5,Sheet2!N$2:Sheet2!N$250,Sheet2!N$2:Sheet2!N$250)*(Sheet2!L$2:Sheet2!L$250=B5)),))}\n    \n\n![](http://7xq3ry.com1.z0.glb.clouddn.com/20160304142206.png)","slug":"excel入门基础","published":1,"updated":"2019-07-24T01:25:47.833Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5nn000e9ka4gejrwyys","content":"<h3 id=\"返回最后一个值、倒数第二个值\"><a href=\"#返回最后一个值、倒数第二个值\" class=\"headerlink\" title=\"返回最后一个值、倒数第二个值\"></a>返回最后一个值、倒数第二个值</h3><pre><code>=LOOKUP(1,0/(A2:J2&lt;&gt;&quot;&quot;),A2:J2)\n=LOOKUP(1,0/(B2:J2&lt;&gt;&quot;&quot;),A2:J2)</code></pre><h3 id=\"返回时间差\"><a href=\"#返回时间差\" class=\"headerlink\" title=\"返回时间差\"></a>返回时间差</h3><pre><code>=DATEDIF(--TEXT(F2,&quot;00-00-00&quot;),TODAY(),&quot;D&quot;)</code></pre><h3 id=\"VLOOKUP-逆向检索\"><a href=\"#VLOOKUP-逆向检索\" class=\"headerlink\" title=\"VLOOKUP 逆向检索\"></a>VLOOKUP 逆向检索</h3><blockquote>\n<p><a href=\"http://zhidao.baidu.com/link?url=-1b12Kx36WQ4vf05DIDhZmxCOtvC6Zdhc62kve1QRoF-hV_Hbl3cZDuBZOYgGRjEo513fDk9-UL6gfUnMI9Jna\" target=\"_blank\" rel=\"noopener\">http://zhidao.baidu.com/link?url=-1b12Kx36WQ4vf05DIDhZmxCOtvC6Zdhc62kve1QRoF-hV_Hbl3cZDuBZOYgGRjEo513fDk9-UL6gfUnMI9Jna</a></p>\n</blockquote>\n<pre><code>=VLOOKUP(C2,IF({1,0},Sheet2!$D$2:$D$5,Sheet2!$A$2:$A$5),2,FALSE)\n=INDEX(Sheet2!A:A,MATCH(Sheet1!C2,Sheet2!D:D,0))</code></pre><h3 id=\"多条件统计求和-COUNTIFS\"><a href=\"#多条件统计求和-COUNTIFS\" class=\"headerlink\" title=\"多条件统计求和 COUNTIFS\"></a>多条件统计求和 COUNTIFS</h3><p>统计每个部门人数</p>\n<pre><code>{=SUM(IFERROR(1/(COUNTIFS(Sheet2!L$2:Sheet2!L$250,B5,Sheet2!N$2:Sheet2!N$250,Sheet2!N$2:Sheet2!N$250)*(Sheet2!L$2:Sheet2!L$250=B5)),))}</code></pre><p><img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160304142206.png\" alt></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"返回最后一个值、倒数第二个值\"><a href=\"#返回最后一个值、倒数第二个值\" class=\"headerlink\" title=\"返回最后一个值、倒数第二个值\"></a>返回最后一个值、倒数第二个值</h3><pre><code>=LOOKUP(1,0/(A2:J2&lt;&gt;&quot;&quot;),A2:J2)\n=LOOKUP(1,0/(B2:J2&lt;&gt;&quot;&quot;),A2:J2)</code></pre><h3 id=\"返回时间差\"><a href=\"#返回时间差\" class=\"headerlink\" title=\"返回时间差\"></a>返回时间差</h3><pre><code>=DATEDIF(--TEXT(F2,&quot;00-00-00&quot;),TODAY(),&quot;D&quot;)</code></pre><h3 id=\"VLOOKUP-逆向检索\"><a href=\"#VLOOKUP-逆向检索\" class=\"headerlink\" title=\"VLOOKUP 逆向检索\"></a>VLOOKUP 逆向检索</h3><blockquote>\n<p><a href=\"http://zhidao.baidu.com/link?url=-1b12Kx36WQ4vf05DIDhZmxCOtvC6Zdhc62kve1QRoF-hV_Hbl3cZDuBZOYgGRjEo513fDk9-UL6gfUnMI9Jna\" target=\"_blank\" rel=\"noopener\">http://zhidao.baidu.com/link?url=-1b12Kx36WQ4vf05DIDhZmxCOtvC6Zdhc62kve1QRoF-hV_Hbl3cZDuBZOYgGRjEo513fDk9-UL6gfUnMI9Jna</a></p>\n</blockquote>\n<pre><code>=VLOOKUP(C2,IF({1,0},Sheet2!$D$2:$D$5,Sheet2!$A$2:$A$5),2,FALSE)\n=INDEX(Sheet2!A:A,MATCH(Sheet1!C2,Sheet2!D:D,0))</code></pre><h3 id=\"多条件统计求和-COUNTIFS\"><a href=\"#多条件统计求和-COUNTIFS\" class=\"headerlink\" title=\"多条件统计求和 COUNTIFS\"></a>多条件统计求和 COUNTIFS</h3><p>统计每个部门人数</p>\n<pre><code>{=SUM(IFERROR(1/(COUNTIFS(Sheet2!L$2:Sheet2!L$250,B5,Sheet2!N$2:Sheet2!N$250,Sheet2!N$2:Sheet2!N$250)*(Sheet2!L$2:Sheet2!L$250=B5)),))}</code></pre><p><img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160304142206.png\" alt></p>\n"},{"title":"centos7.2安装使用openResty","url":"579.html","id":"579","comments":0,"date":"2018-11-14T10:35:08.000Z","_content":"\n    # 安装\n    sudo yum install pcre-devel openssl-devel gcc curl\n    wget https://openresty.org/download/openresty-1.13.6.2.tar.gz\n    tar -xzvf openresty-1.13.6.2.tar.gz\n    cd openresty-1.13.6.2\n    # 默认安装到/usr/local/openresty, 可以指定./configure --prefix=/your/path/openresty设置\n    # 默认安装的组件https://openresty.org/cn/components.html\n    ./configure --with-luajit \\\n                --without-http_redis2_module \\\n                --with-http_iconv_module \\\n                --with-http_postgres_module\n    make && sudo make install\n    # 创建软链接\n    ln -s /usr/local/openresty/nginx/sbin/nginx /usr/local/nginx\n    # 启动/重启/停止\n    nginx \n    nginx -s reload\n    nginx -s stop\n    \n\n#### 配置\n\n*   openResty的nginx和普通nginx配置一致","source":"_posts/centos7.2安装使用openResty.md","raw":"---\ntitle: centos7.2安装使用openResty\nurl: 579.html\nid: 579\ncomments: false\ncategories:\n  - 运维\ndate: 2018-11-14 18:35:08\ntags:\n---\n\n    # 安装\n    sudo yum install pcre-devel openssl-devel gcc curl\n    wget https://openresty.org/download/openresty-1.13.6.2.tar.gz\n    tar -xzvf openresty-1.13.6.2.tar.gz\n    cd openresty-1.13.6.2\n    # 默认安装到/usr/local/openresty, 可以指定./configure --prefix=/your/path/openresty设置\n    # 默认安装的组件https://openresty.org/cn/components.html\n    ./configure --with-luajit \\\n                --without-http_redis2_module \\\n                --with-http_iconv_module \\\n                --with-http_postgres_module\n    make && sudo make install\n    # 创建软链接\n    ln -s /usr/local/openresty/nginx/sbin/nginx /usr/local/nginx\n    # 启动/重启/停止\n    nginx \n    nginx -s reload\n    nginx -s stop\n    \n\n#### 配置\n\n*   openResty的nginx和普通nginx配置一致","slug":"centos7.2安装使用openResty","published":1,"updated":"2019-07-23T05:51:43.850Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5np000h9ka43sxldmwd","content":"<pre><code># 安装\nsudo yum install pcre-devel openssl-devel gcc curl\nwget https://openresty.org/download/openresty-1.13.6.2.tar.gz\ntar -xzvf openresty-1.13.6.2.tar.gz\ncd openresty-1.13.6.2\n# 默认安装到/usr/local/openresty, 可以指定./configure --prefix=/your/path/openresty设置\n# 默认安装的组件https://openresty.org/cn/components.html\n./configure --with-luajit \\\n            --without-http_redis2_module \\\n            --with-http_iconv_module \\\n            --with-http_postgres_module\nmake &amp;&amp; sudo make install\n# 创建软链接\nln -s /usr/local/openresty/nginx/sbin/nginx /usr/local/nginx\n# 启动/重启/停止\nnginx \nnginx -s reload\nnginx -s stop</code></pre><h4 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h4><ul>\n<li>openResty的nginx和普通nginx配置一致</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<pre><code># 安装\nsudo yum install pcre-devel openssl-devel gcc curl\nwget https://openresty.org/download/openresty-1.13.6.2.tar.gz\ntar -xzvf openresty-1.13.6.2.tar.gz\ncd openresty-1.13.6.2\n# 默认安装到/usr/local/openresty, 可以指定./configure --prefix=/your/path/openresty设置\n# 默认安装的组件https://openresty.org/cn/components.html\n./configure --with-luajit \\\n            --without-http_redis2_module \\\n            --with-http_iconv_module \\\n            --with-http_postgres_module\nmake &amp;&amp; sudo make install\n# 创建软链接\nln -s /usr/local/openresty/nginx/sbin/nginx /usr/local/nginx\n# 启动/重启/停止\nnginx \nnginx -s reload\nnginx -s stop</code></pre><h4 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h4><ul>\n<li>openResty的nginx和普通nginx配置一致</li>\n</ul>\n"},{"title":"django环境部署","date":"2019-08-02T11:03:28.000Z","_content":"\n#### 安装supervisor服务\n[地址](http://supervisord.org/)\n\n#### 待续\n```shell\n$ pip3 install service_identity\n$ pip3 install channels\n$ pip3 install channels_redis\n```\n","source":"_posts/django环境部署.md","raw":"---\ntitle: django环境部署\ndate: 2019-08-02 19:03:28\ntags:\n---\n\n#### 安装supervisor服务\n[地址](http://supervisord.org/)\n\n#### 待续\n```shell\n$ pip3 install service_identity\n$ pip3 install channels\n$ pip3 install channels_redis\n```\n","slug":"django环境部署","published":1,"updated":"2019-08-02T11:09:17.542Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjyu0a5nq000j9ka4v1ohp4cz","content":"<h4 id=\"安装supervisor服务\"><a href=\"#安装supervisor服务\" class=\"headerlink\" title=\"安装supervisor服务\"></a>安装supervisor服务</h4><p><a href=\"http://supervisord.org/\" target=\"_blank\" rel=\"noopener\">地址</a></p>\n<h4 id=\"待续\"><a href=\"#待续\" class=\"headerlink\" title=\"待续\"></a>待续</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> pip3 install service_identity</span><br><span class=\"line\"><span class=\"meta\">$</span> pip3 install channels</span><br><span class=\"line\"><span class=\"meta\">$</span> pip3 install channels_redis</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"安装supervisor服务\"><a href=\"#安装supervisor服务\" class=\"headerlink\" title=\"安装supervisor服务\"></a>安装supervisor服务</h4><p><a href=\"http://supervisord.org/\" target=\"_blank\" rel=\"noopener\">地址</a></p>\n<h4 id=\"待续\"><a href=\"#待续\" class=\"headerlink\" title=\"待续\"></a>待续</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> pip3 install service_identity</span><br><span class=\"line\"><span class=\"meta\">$</span> pip3 install channels</span><br><span class=\"line\"><span class=\"meta\">$</span> pip3 install channels_redis</span><br></pre></td></tr></table></figure>\n\n"},{"title":"ffmpeg命令基础","date":"2019-07-24T01:16:46.000Z","_content":"#### ffmpeg基本流程\n\n```sequence\n文件->音视频流: demuxer解封装\n音视频流->数据包: decoder解码\n数据包->音视频流: encoder编码\n音视频流->文件: muxer封装\n```\n\n#### ffmpeg基本定义\n\n1. 文件：也叫容器Container，比如mp4文件、flv文件等，容器的类型决定了信息被存放在文件中的位置。\n2. 音视频流： \n","source":"_posts/ffmpeg命令基础.md","raw":"---\ntitle: ffmpeg命令基础\ndate: 2019-07-24 09:16:46\ntags:\n  - ffmpeg\n---\n#### ffmpeg基本流程\n\n```sequence\n文件->音视频流: demuxer解封装\n音视频流->数据包: decoder解码\n数据包->音视频流: encoder编码\n音视频流->文件: muxer封装\n```\n\n#### ffmpeg基本定义\n\n1. 文件：也叫容器Container，比如mp4文件、flv文件等，容器的类型决定了信息被存放在文件中的位置。\n2. 音视频流： \n","slug":"ffmpeg命令基础","published":1,"updated":"2019-07-24T01:19:04.256Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjyu0a5nr000n9ka4onnuduk5","content":"<h4 id=\"ffmpeg基本流程\"><a href=\"#ffmpeg基本流程\" class=\"headerlink\" title=\"ffmpeg基本流程\"></a>ffmpeg基本流程</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">文件-&gt;音视频流: demuxer解封装</span><br><span class=\"line\">音视频流-&gt;数据包: decoder解码</span><br><span class=\"line\">数据包-&gt;音视频流: encoder编码</span><br><span class=\"line\">音视频流-&gt;文件: muxer封装</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ffmpeg基本定义\"><a href=\"#ffmpeg基本定义\" class=\"headerlink\" title=\"ffmpeg基本定义\"></a>ffmpeg基本定义</h4><ol>\n<li>文件：也叫容器Container，比如mp4文件、flv文件等，容器的类型决定了信息被存放在文件中的位置。</li>\n<li>音视频流： </li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"ffmpeg基本流程\"><a href=\"#ffmpeg基本流程\" class=\"headerlink\" title=\"ffmpeg基本流程\"></a>ffmpeg基本流程</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">文件-&gt;音视频流: demuxer解封装</span><br><span class=\"line\">音视频流-&gt;数据包: decoder解码</span><br><span class=\"line\">数据包-&gt;音视频流: encoder编码</span><br><span class=\"line\">音视频流-&gt;文件: muxer封装</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ffmpeg基本定义\"><a href=\"#ffmpeg基本定义\" class=\"headerlink\" title=\"ffmpeg基本定义\"></a>ffmpeg基本定义</h4><ol>\n<li>文件：也叫容器Container，比如mp4文件、flv文件等，容器的类型决定了信息被存放在文件中的位置。</li>\n<li>音视频流： </li>\n</ol>\n"},{"title":"ffmpeg封装与解封装基础","date":"2019-07-24T01:20:23.000Z","_content":"#### ffmpeg封装与解封装\n\n```\n$ ffmpeg -i input.mkv -vcodec copy -acodec copy output.mp4\n```\n\n> -i 输入文件\n>\n> -vcodec copy 视频编码处理方式\n>\n> -acodec copy 音频编码处理方式\n\n```\n$ ffmpeg -i input.mp4 -vn -acodec copy output.aac  # 抽出音频\n$ ffmpeg -i input.mp4 -vcodec copy -an output.h264  # 抽出视频\n```\n\n##### 提取YUV数据\n\n```\n$ffmpeg -i input.mp4 -an -c:v rawvideo -pix_fmt yuv420p out.yuv\n```\n\n> -i 输入设备\n>\n> -an 不需要音频\n>\n> -c:v 使用rawvideo对视频进行编码\n>\n> -pix_fmt 像素格式\n\n播放源文件\n\n```\nffplay -video_size 1366x768 out.yuv\n```\n\n> -video_size 指定像素\n\n##### 提取PCM数据\n\n```\n$ ffmpeg -i input.mp4 -vn -ar 44100 -ac 2 -f s16le out.pcm\n```\n\n> -i 输入设备\n>\n> -vn 不需要视频\n>\n> -ar 44100 -a 音频 read 音频采样率44.1k\n>\n> -ac 2 -a 音频 c2 channel 2 双声道\n>\n> -f 数据存储格式 s16le   s: 有符号的 \n\n播放源文件\n\n```\n$ ffplay -ar 44100 -ac 2 -f s16le out.pcm\n```\n\n","source":"_posts/ffmpeg封装与解封装基础.md","raw":"---\ntitle: ffmpeg封装与解封装基础\ndate: 2019-07-24 09:20:23\ntags:\n  - ffmpeg\n---\n#### ffmpeg封装与解封装\n\n```\n$ ffmpeg -i input.mkv -vcodec copy -acodec copy output.mp4\n```\n\n> -i 输入文件\n>\n> -vcodec copy 视频编码处理方式\n>\n> -acodec copy 音频编码处理方式\n\n```\n$ ffmpeg -i input.mp4 -vn -acodec copy output.aac  # 抽出音频\n$ ffmpeg -i input.mp4 -vcodec copy -an output.h264  # 抽出视频\n```\n\n##### 提取YUV数据\n\n```\n$ffmpeg -i input.mp4 -an -c:v rawvideo -pix_fmt yuv420p out.yuv\n```\n\n> -i 输入设备\n>\n> -an 不需要音频\n>\n> -c:v 使用rawvideo对视频进行编码\n>\n> -pix_fmt 像素格式\n\n播放源文件\n\n```\nffplay -video_size 1366x768 out.yuv\n```\n\n> -video_size 指定像素\n\n##### 提取PCM数据\n\n```\n$ ffmpeg -i input.mp4 -vn -ar 44100 -ac 2 -f s16le out.pcm\n```\n\n> -i 输入设备\n>\n> -vn 不需要视频\n>\n> -ar 44100 -a 音频 read 音频采样率44.1k\n>\n> -ac 2 -a 音频 c2 channel 2 双声道\n>\n> -f 数据存储格式 s16le   s: 有符号的 \n\n播放源文件\n\n```\n$ ffplay -ar 44100 -ac 2 -f s16le out.pcm\n```\n\n","slug":"ffmpeg封装与解封装基础","published":1,"updated":"2019-07-24T01:20:47.723Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjyu0a5ns000p9ka4khr05zgg","content":"<h4 id=\"ffmpeg封装与解封装\"><a href=\"#ffmpeg封装与解封装\" class=\"headerlink\" title=\"ffmpeg封装与解封装\"></a>ffmpeg封装与解封装</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i input.mkv -vcodec copy -acodec copy output.mp4</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-i 输入文件</p>\n<p>-vcodec copy 视频编码处理方式</p>\n<p>-acodec copy 音频编码处理方式</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i input.mp4 -vn -acodec copy output.aac  # 抽出音频</span><br><span class=\"line\">$ ffmpeg -i input.mp4 -vcodec copy -an output.h264  # 抽出视频</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"提取YUV数据\"><a href=\"#提取YUV数据\" class=\"headerlink\" title=\"提取YUV数据\"></a>提取YUV数据</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ffmpeg -i input.mp4 -an -c:v rawvideo -pix_fmt yuv420p out.yuv</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-i 输入设备</p>\n<p>-an 不需要音频</p>\n<p>-c:v 使用rawvideo对视频进行编码</p>\n<p>-pix_fmt 像素格式</p>\n</blockquote>\n<p>播放源文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ffplay -video_size 1366x768 out.yuv</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-video_size 指定像素</p>\n</blockquote>\n<h5 id=\"提取PCM数据\"><a href=\"#提取PCM数据\" class=\"headerlink\" title=\"提取PCM数据\"></a>提取PCM数据</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i input.mp4 -vn -ar 44100 -ac 2 -f s16le out.pcm</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-i 输入设备</p>\n<p>-vn 不需要视频</p>\n<p>-ar 44100 -a 音频 read 音频采样率44.1k</p>\n<p>-ac 2 -a 音频 c2 channel 2 双声道</p>\n<p>-f 数据存储格式 s16le   s: 有符号的 </p>\n</blockquote>\n<p>播放源文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffplay -ar 44100 -ac 2 -f s16le out.pcm</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"ffmpeg封装与解封装\"><a href=\"#ffmpeg封装与解封装\" class=\"headerlink\" title=\"ffmpeg封装与解封装\"></a>ffmpeg封装与解封装</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i input.mkv -vcodec copy -acodec copy output.mp4</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-i 输入文件</p>\n<p>-vcodec copy 视频编码处理方式</p>\n<p>-acodec copy 音频编码处理方式</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i input.mp4 -vn -acodec copy output.aac  # 抽出音频</span><br><span class=\"line\">$ ffmpeg -i input.mp4 -vcodec copy -an output.h264  # 抽出视频</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"提取YUV数据\"><a href=\"#提取YUV数据\" class=\"headerlink\" title=\"提取YUV数据\"></a>提取YUV数据</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ffmpeg -i input.mp4 -an -c:v rawvideo -pix_fmt yuv420p out.yuv</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-i 输入设备</p>\n<p>-an 不需要音频</p>\n<p>-c:v 使用rawvideo对视频进行编码</p>\n<p>-pix_fmt 像素格式</p>\n</blockquote>\n<p>播放源文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ffplay -video_size 1366x768 out.yuv</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-video_size 指定像素</p>\n</blockquote>\n<h5 id=\"提取PCM数据\"><a href=\"#提取PCM数据\" class=\"headerlink\" title=\"提取PCM数据\"></a>提取PCM数据</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i input.mp4 -vn -ar 44100 -ac 2 -f s16le out.pcm</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-i 输入设备</p>\n<p>-vn 不需要视频</p>\n<p>-ar 44100 -a 音频 read 音频采样率44.1k</p>\n<p>-ac 2 -a 音频 c2 channel 2 双声道</p>\n<p>-f 数据存储格式 s16le   s: 有符号的 </p>\n</blockquote>\n<p>播放源文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffplay -ar 44100 -ac 2 -f s16le out.pcm</span><br></pre></td></tr></table></figure>\n\n"},{"title":"django入门基础","url":"47.html","id":"47","comments":0,"date":"2016-11-09T06:41:04.000Z","_content":"\n### 2017.11.10号重新更新基本安装和线上部署\n\n环境：python3.5 django1.11\n\n    # 安装环境\n    $ sudo apt-get update\n    $ sudo apt-get install python3-pip apache2 libapache2-mod-wsgi-py3\n    $ sudo pip3 install virtualenv\n    \n\n    # 安装项目目录\n    $ cd ~/www/html/\n    $ virtualenv --no-site-packages -p /usr/bin/python3.5 CCO\n    $ cd CCO\n    $ source ./bin/activate\n    (CCO) $ pip3 install ipython\n    (CCO) $ pip3 install Django==1.11.7\n    # 查看django是否安装成功\n    (CCO) $  ipython\n     > import django\n     > django.VERSION # 打印出django版本表示成功\n    # 开始创建项目\n    (CCO) $ django-admin.py startproject CCO_WEB\n    # 创建应用\n    (CCO) $ cd CCO_WEB\n    (CCO) $ django-admin.py startapp polls\n    \n\n    # 修改文件内容\n    (CCO) $ vim CCO_WEB/CCO_WEB/setting.py\n    ALLOWED_HOSTS = ['127.0.0.1', 'localhost']  # 修改\n    STATIC_URL = '/static/' # 原始\n    STATIC_ROOT = os.path.join(BASE_DIR, 'static/') # 添加\n    \n\n    # 创建数据库和超级管理员\n    (CCO) $ ./manage.py makemigrations\n    (CCO) $ ./manage.py migrate\n    (CCO) $ ./manage.py createsuperuser # 创建超级管理员\n    (CCO) $ ./manage.py collectstatic # 收集静态文件\n    \n\n    ### 用django自带服务器运行\n    (CCO) $ sudo ufw allow 8000 # 关闭防火墙\n    (CCO) $ ./manage.py runserver 0.0.0.0:8000 # 成功表示django开发环境配置完成\n    \n\n    ### 线上部署\n    apache虚拟主机配置\n    $ sudo vim /etc/apache2/sites-available/www.cco.com.conf\n    <VirtualHost *:80>\n            ServerName www.example.com\n            ServerAdmin webmaster@localhost\n             # 这里指明静态文件存放的地方\n        Alias /static  /home/hanchang/www/html/CCO/CCO_WEB/static\n        # 给文件夹分配权限\n        <Directory /home/hanchang/www/html/CCO/CCO_WEB/static>\n                Require all granted\n        </Directory>\n        #接下来，我们将授予访问存储Django代码的二级项目目录中的wsgi.py文件的权限。\n        <Directory /home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB>\n        <Files wsgi.py>\n                Require all granted\n        </Files>\n        </Directory>\n            WSGIDaemonProcess CCO_WEB python-home=/home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB python-path=/home/hanchang/www/html/CCO\n        WSGIProcessGroup CCO_WEB\n        WSGIScriptAlias / /home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB/wsgi.py\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n    </VirtualHost>\n    \n\n    ### 线上\n    sudo a2ensite www.cco.com\n    sudo service apache2 restart\n    http://127.0.0.1 查看\n    原文查看　https://www.digitalocean.com/community/tutorials/how-to-serve-django-applications-with-apache-and-mod_wsgi-on-ubuntu-16-04\n    \n\n### 数据库安装\n\n    $ sudo apt-get install python-setuptools\n    $ sudo apt-get install libmysqld-dev\n    $ sudo apt-get install libmysqlclient-dev\n    $ sudo apt-get install python-dev\n    $ sudo easy_install mysql-python\n    $ pip3 install mysqlclient\n    \n\n### 安装\n\n    # 需要先安装虚拟环境\n    (Novel) pip isntall django==1.8.2 # 不能加sudo\n    \n\n### 查看是否安装成功及版本号\n\n    python\n    import django\n    django.VERSION\n    \n\n### 安装MysqlDb\n\nubuntu\n\n    # ubuntu安装步骤：\n    sudo apt-get install python-setuptools\n    sudo apt-get install libmysqld-dev\n    sudo apt-get install libmysqlclient-dev\n    sudo apt-get install python-dev\n    sudo easy_install mysql-python\n    \n\nwindows下https://pypi.python.org/pypi/MySQL-python/1.2.5 下载.exe一键安装\n\n### 创建项目\n\n    django-admin.py startproject Novel\n    \n\n### 创建APP\n\n    python manage.py startapp Heros\n    \n\n/Novel/settings.py\n\n    INSTALLED_APPS = (\n        ...\n        'Heroes',  #这里填写的是app的名称\n    )\n    \n\n### 命令行调试模式\n\n    python manage.py shell\n    \n\n### 运行开发服务器\n\n    cd mysite\n    python manage.py runserver 或者\n    python manage.py runserver 0.0.0.0:8000\n    \n\n### 运行shell脚本方式\n\n    python manager.py shell # 启动脚本环境\n    from testapp.models import *  # 导入数据库\n    \n\n### 部署线上环境\n\n安装apache模块\n\n    # Python 2\n    sudo apt-get install libapache2-mod-wsgi\n    \n    # Python 3\n    sudo apt-get install libapache2-mod-wsgi-py3\n    \n\nNovel/Novel/wsgi.py\n\n    import os\n    import sys\n    sys.path.append('/var/www/html/Novel/')\n    sys.path.append('/var/www/html/Novel/Novel/')\n    sys.path.append('/var/www/html/Novel/lib/python2.7/site-packages') # 虚拟环境需要添加\n    from django.core.wsgi import get_wsgi_application\n    \n    \n    os.environ.setdefault(\"DJANGO_SETTINGS_MODULE\", \"Novel.settings\")\n    application = get_wsgi_application()\n    \n\n/etc/apache2/sites-enable/novel.conf\n\n    <VirtualHost *:1200>\n        ServerAdmin webmaster@localhost\n        DocumentRoot /var/www/html/Novel/Novel/Novel\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n    \n        # 静态文件设置\n        Alias /static/ /var/www/html/Novel/Novel/Novel/static/\n        <Directory /var/www/html/Novel/Novel/Novel/static/>\n            Require all granted\n        </Directory>\n    \n        WSGIScriptAlias / /var/www/html/Novel/Novel/Novel/wsgi.py\n        <Directory /var/www/html/Novel/Novel/Novel/>\n            Require all granted\n            <Files wsgi.py>\n                Require all granted\n            </Files>\n        </Directory>\n    \n    </VirtualHost>\n    \n\n### 视图与路由绑定\n\n/Heroes/views.py\n\n    from django.http import HttpResponse, Http404\n    # Create your views here.\n    \n    \n    def hello(request):\n        return HttpResponse(\"Hello World\")\n    \n\n/Novel/urls.py\n\n    from django.conf.urls import include, url\n    from Heroes.views import *\n    \n    urlpatterns = [\n        url(r'^hello/$', hello),\n        url(r'^time/plus/(\\d{1,2})/$', hours_ahead)\n    ]\n    \n    \n\n### 视图与模板\n\n/Novel/settings.py设置模板路径\n\n    TEMPLATES = [\n        {\n            # .....\n            'DIRS': [\n                os.path.join(os.path.dirname(__file__), 'templates').replace('\\\\','/'),\n            ],\n            # ....\n        },\n    ]\n    \n\n/Novel/Heroes/views.py修改视图\n\n    from django.shortcuts import render_to_response\n    from django.http import HttpResponse, Http404\n    import datetime\n    # Create your views here.\n    \n    \n    \n    def current_datetime(request):\n        now = datetime.datetime.now()\n        # html = '<html><body>It is %s.</body></html>' % now\n        return render_to_response('Heroes/current_datetime.html', {'current_time': now})\n    \n\n/Novel目录下创建templates/Heroes/current_datetime.html\n\n    <!doctype html>\n    <html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <title>Document</title>\n    </head>\n    <body>\n        <h1>{ { current_time }}</h1>\n    </body>\n    </html>\n    \n\n### 数据库配置\n\n/Novel/settings.py\n\n    DATABASES = {\n        'default': {\n            'ENGINE': 'django.db.backends.mysql',\n            'NAME': 'Novel',\n            'USER': 'root',\n            'PASSWORD': 'password',\n            'HOST': '127.0.0.1',\n            'PORT': '3306'\n        }\n    }\n    \n\n测试是否成功\n\n    python manage.py shell\n    >>> from django.db import connection\n    >>> cursor = connection.cursor()\n    \n\n### 视图返回json数据格式\n\nviews.py\n\n    from django.http import HttpResponse, Http404\n    from json import dumps\n    \n    def login_handle(request):\n        if request.method != 'POST':\n            raise Http404()\n        inputs = request.POST\n        json_str = dumps(inputs)\n        return HttpResponse(json_str, content_type='application/json')\n    \n\n\\### 静态文件 settings.py ``` # 线上模式静态地址 STATIC_URL = os.path.join(os.path.dirname(**file**), '/static/').replace('\\\\','/')\n\n开发模式静态地址\n========\n\nSTATICFILES_DIRS = (os.path.join(os.path.dirname(**file**), 'static').replace('\\\\','/'),) ```","source":"_posts/django入门基础.md","raw":"---\ntitle: django入门基础\ntags:\n  - django\n  - python\nurl: 47.html\nid: 47\ncomments: false\ncategories:\n  - 后端\ndate: 2016-11-09 14:41:04\n---\n\n### 2017.11.10号重新更新基本安装和线上部署\n\n环境：python3.5 django1.11\n\n    # 安装环境\n    $ sudo apt-get update\n    $ sudo apt-get install python3-pip apache2 libapache2-mod-wsgi-py3\n    $ sudo pip3 install virtualenv\n    \n\n    # 安装项目目录\n    $ cd ~/www/html/\n    $ virtualenv --no-site-packages -p /usr/bin/python3.5 CCO\n    $ cd CCO\n    $ source ./bin/activate\n    (CCO) $ pip3 install ipython\n    (CCO) $ pip3 install Django==1.11.7\n    # 查看django是否安装成功\n    (CCO) $  ipython\n     > import django\n     > django.VERSION # 打印出django版本表示成功\n    # 开始创建项目\n    (CCO) $ django-admin.py startproject CCO_WEB\n    # 创建应用\n    (CCO) $ cd CCO_WEB\n    (CCO) $ django-admin.py startapp polls\n    \n\n    # 修改文件内容\n    (CCO) $ vim CCO_WEB/CCO_WEB/setting.py\n    ALLOWED_HOSTS = ['127.0.0.1', 'localhost']  # 修改\n    STATIC_URL = '/static/' # 原始\n    STATIC_ROOT = os.path.join(BASE_DIR, 'static/') # 添加\n    \n\n    # 创建数据库和超级管理员\n    (CCO) $ ./manage.py makemigrations\n    (CCO) $ ./manage.py migrate\n    (CCO) $ ./manage.py createsuperuser # 创建超级管理员\n    (CCO) $ ./manage.py collectstatic # 收集静态文件\n    \n\n    ### 用django自带服务器运行\n    (CCO) $ sudo ufw allow 8000 # 关闭防火墙\n    (CCO) $ ./manage.py runserver 0.0.0.0:8000 # 成功表示django开发环境配置完成\n    \n\n    ### 线上部署\n    apache虚拟主机配置\n    $ sudo vim /etc/apache2/sites-available/www.cco.com.conf\n    <VirtualHost *:80>\n            ServerName www.example.com\n            ServerAdmin webmaster@localhost\n             # 这里指明静态文件存放的地方\n        Alias /static  /home/hanchang/www/html/CCO/CCO_WEB/static\n        # 给文件夹分配权限\n        <Directory /home/hanchang/www/html/CCO/CCO_WEB/static>\n                Require all granted\n        </Directory>\n        #接下来，我们将授予访问存储Django代码的二级项目目录中的wsgi.py文件的权限。\n        <Directory /home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB>\n        <Files wsgi.py>\n                Require all granted\n        </Files>\n        </Directory>\n            WSGIDaemonProcess CCO_WEB python-home=/home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB python-path=/home/hanchang/www/html/CCO\n        WSGIProcessGroup CCO_WEB\n        WSGIScriptAlias / /home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB/wsgi.py\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n    </VirtualHost>\n    \n\n    ### 线上\n    sudo a2ensite www.cco.com\n    sudo service apache2 restart\n    http://127.0.0.1 查看\n    原文查看　https://www.digitalocean.com/community/tutorials/how-to-serve-django-applications-with-apache-and-mod_wsgi-on-ubuntu-16-04\n    \n\n### 数据库安装\n\n    $ sudo apt-get install python-setuptools\n    $ sudo apt-get install libmysqld-dev\n    $ sudo apt-get install libmysqlclient-dev\n    $ sudo apt-get install python-dev\n    $ sudo easy_install mysql-python\n    $ pip3 install mysqlclient\n    \n\n### 安装\n\n    # 需要先安装虚拟环境\n    (Novel) pip isntall django==1.8.2 # 不能加sudo\n    \n\n### 查看是否安装成功及版本号\n\n    python\n    import django\n    django.VERSION\n    \n\n### 安装MysqlDb\n\nubuntu\n\n    # ubuntu安装步骤：\n    sudo apt-get install python-setuptools\n    sudo apt-get install libmysqld-dev\n    sudo apt-get install libmysqlclient-dev\n    sudo apt-get install python-dev\n    sudo easy_install mysql-python\n    \n\nwindows下https://pypi.python.org/pypi/MySQL-python/1.2.5 下载.exe一键安装\n\n### 创建项目\n\n    django-admin.py startproject Novel\n    \n\n### 创建APP\n\n    python manage.py startapp Heros\n    \n\n/Novel/settings.py\n\n    INSTALLED_APPS = (\n        ...\n        'Heroes',  #这里填写的是app的名称\n    )\n    \n\n### 命令行调试模式\n\n    python manage.py shell\n    \n\n### 运行开发服务器\n\n    cd mysite\n    python manage.py runserver 或者\n    python manage.py runserver 0.0.0.0:8000\n    \n\n### 运行shell脚本方式\n\n    python manager.py shell # 启动脚本环境\n    from testapp.models import *  # 导入数据库\n    \n\n### 部署线上环境\n\n安装apache模块\n\n    # Python 2\n    sudo apt-get install libapache2-mod-wsgi\n    \n    # Python 3\n    sudo apt-get install libapache2-mod-wsgi-py3\n    \n\nNovel/Novel/wsgi.py\n\n    import os\n    import sys\n    sys.path.append('/var/www/html/Novel/')\n    sys.path.append('/var/www/html/Novel/Novel/')\n    sys.path.append('/var/www/html/Novel/lib/python2.7/site-packages') # 虚拟环境需要添加\n    from django.core.wsgi import get_wsgi_application\n    \n    \n    os.environ.setdefault(\"DJANGO_SETTINGS_MODULE\", \"Novel.settings\")\n    application = get_wsgi_application()\n    \n\n/etc/apache2/sites-enable/novel.conf\n\n    <VirtualHost *:1200>\n        ServerAdmin webmaster@localhost\n        DocumentRoot /var/www/html/Novel/Novel/Novel\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n    \n        # 静态文件设置\n        Alias /static/ /var/www/html/Novel/Novel/Novel/static/\n        <Directory /var/www/html/Novel/Novel/Novel/static/>\n            Require all granted\n        </Directory>\n    \n        WSGIScriptAlias / /var/www/html/Novel/Novel/Novel/wsgi.py\n        <Directory /var/www/html/Novel/Novel/Novel/>\n            Require all granted\n            <Files wsgi.py>\n                Require all granted\n            </Files>\n        </Directory>\n    \n    </VirtualHost>\n    \n\n### 视图与路由绑定\n\n/Heroes/views.py\n\n    from django.http import HttpResponse, Http404\n    # Create your views here.\n    \n    \n    def hello(request):\n        return HttpResponse(\"Hello World\")\n    \n\n/Novel/urls.py\n\n    from django.conf.urls import include, url\n    from Heroes.views import *\n    \n    urlpatterns = [\n        url(r'^hello/$', hello),\n        url(r'^time/plus/(\\d{1,2})/$', hours_ahead)\n    ]\n    \n    \n\n### 视图与模板\n\n/Novel/settings.py设置模板路径\n\n    TEMPLATES = [\n        {\n            # .....\n            'DIRS': [\n                os.path.join(os.path.dirname(__file__), 'templates').replace('\\\\','/'),\n            ],\n            # ....\n        },\n    ]\n    \n\n/Novel/Heroes/views.py修改视图\n\n    from django.shortcuts import render_to_response\n    from django.http import HttpResponse, Http404\n    import datetime\n    # Create your views here.\n    \n    \n    \n    def current_datetime(request):\n        now = datetime.datetime.now()\n        # html = '<html><body>It is %s.</body></html>' % now\n        return render_to_response('Heroes/current_datetime.html', {'current_time': now})\n    \n\n/Novel目录下创建templates/Heroes/current_datetime.html\n\n    <!doctype html>\n    <html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <title>Document</title>\n    </head>\n    <body>\n        <h1>{ { current_time }}</h1>\n    </body>\n    </html>\n    \n\n### 数据库配置\n\n/Novel/settings.py\n\n    DATABASES = {\n        'default': {\n            'ENGINE': 'django.db.backends.mysql',\n            'NAME': 'Novel',\n            'USER': 'root',\n            'PASSWORD': 'password',\n            'HOST': '127.0.0.1',\n            'PORT': '3306'\n        }\n    }\n    \n\n测试是否成功\n\n    python manage.py shell\n    >>> from django.db import connection\n    >>> cursor = connection.cursor()\n    \n\n### 视图返回json数据格式\n\nviews.py\n\n    from django.http import HttpResponse, Http404\n    from json import dumps\n    \n    def login_handle(request):\n        if request.method != 'POST':\n            raise Http404()\n        inputs = request.POST\n        json_str = dumps(inputs)\n        return HttpResponse(json_str, content_type='application/json')\n    \n\n\\### 静态文件 settings.py ``` # 线上模式静态地址 STATIC_URL = os.path.join(os.path.dirname(**file**), '/static/').replace('\\\\','/')\n\n开发模式静态地址\n========\n\nSTATICFILES_DIRS = (os.path.join(os.path.dirname(**file**), 'static').replace('\\\\','/'),) ```","slug":"django入门基础","published":1,"updated":"2019-07-24T01:25:47.823Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5nt000t9ka46swqv94t","content":"<h3 id=\"2017-11-10号重新更新基本安装和线上部署\"><a href=\"#2017-11-10号重新更新基本安装和线上部署\" class=\"headerlink\" title=\"2017.11.10号重新更新基本安装和线上部署\"></a>2017.11.10号重新更新基本安装和线上部署</h3><p>环境：python3.5 django1.11</p>\n<pre><code># 安装环境\n$ sudo apt-get update\n$ sudo apt-get install python3-pip apache2 libapache2-mod-wsgi-py3\n$ sudo pip3 install virtualenv\n\n\n# 安装项目目录\n$ cd ~/www/html/\n$ virtualenv --no-site-packages -p /usr/bin/python3.5 CCO\n$ cd CCO\n$ source ./bin/activate\n(CCO) $ pip3 install ipython\n(CCO) $ pip3 install Django==1.11.7\n# 查看django是否安装成功\n(CCO) $  ipython\n &gt; import django\n &gt; django.VERSION # 打印出django版本表示成功\n# 开始创建项目\n(CCO) $ django-admin.py startproject CCO_WEB\n# 创建应用\n(CCO) $ cd CCO_WEB\n(CCO) $ django-admin.py startapp polls\n\n\n# 修改文件内容\n(CCO) $ vim CCO_WEB/CCO_WEB/setting.py\nALLOWED_HOSTS = [&apos;127.0.0.1&apos;, &apos;localhost&apos;]  # 修改\nSTATIC_URL = &apos;/static/&apos; # 原始\nSTATIC_ROOT = os.path.join(BASE_DIR, &apos;static/&apos;) # 添加\n\n\n# 创建数据库和超级管理员\n(CCO) $ ./manage.py makemigrations\n(CCO) $ ./manage.py migrate\n(CCO) $ ./manage.py createsuperuser # 创建超级管理员\n(CCO) $ ./manage.py collectstatic # 收集静态文件\n\n\n### 用django自带服务器运行\n(CCO) $ sudo ufw allow 8000 # 关闭防火墙\n(CCO) $ ./manage.py runserver 0.0.0.0:8000 # 成功表示django开发环境配置完成\n\n\n### 线上部署\napache虚拟主机配置\n$ sudo vim /etc/apache2/sites-available/www.cco.com.conf\n&lt;VirtualHost *:80&gt;\n        ServerName www.example.com\n        ServerAdmin webmaster@localhost\n         # 这里指明静态文件存放的地方\n    Alias /static  /home/hanchang/www/html/CCO/CCO_WEB/static\n    # 给文件夹分配权限\n    &lt;Directory /home/hanchang/www/html/CCO/CCO_WEB/static&gt;\n            Require all granted\n    &lt;/Directory&gt;\n    #接下来，我们将授予访问存储Django代码的二级项目目录中的wsgi.py文件的权限。\n    &lt;Directory /home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB&gt;\n    &lt;Files wsgi.py&gt;\n            Require all granted\n    &lt;/Files&gt;\n    &lt;/Directory&gt;\n        WSGIDaemonProcess CCO_WEB python-home=/home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB python-path=/home/hanchang/www/html/CCO\n    WSGIProcessGroup CCO_WEB\n    WSGIScriptAlias / /home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB/wsgi.py\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n&lt;/VirtualHost&gt;\n\n\n### 线上\nsudo a2ensite www.cco.com\nsudo service apache2 restart\nhttp://127.0.0.1 查看\n原文查看　https://www.digitalocean.com/community/tutorials/how-to-serve-django-applications-with-apache-and-mod_wsgi-on-ubuntu-16-04</code></pre><h3 id=\"数据库安装\"><a href=\"#数据库安装\" class=\"headerlink\" title=\"数据库安装\"></a>数据库安装</h3><pre><code>$ sudo apt-get install python-setuptools\n$ sudo apt-get install libmysqld-dev\n$ sudo apt-get install libmysqlclient-dev\n$ sudo apt-get install python-dev\n$ sudo easy_install mysql-python\n$ pip3 install mysqlclient</code></pre><h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><pre><code># 需要先安装虚拟环境\n(Novel) pip isntall django==1.8.2 # 不能加sudo</code></pre><h3 id=\"查看是否安装成功及版本号\"><a href=\"#查看是否安装成功及版本号\" class=\"headerlink\" title=\"查看是否安装成功及版本号\"></a>查看是否安装成功及版本号</h3><pre><code>python\nimport django\ndjango.VERSION</code></pre><h3 id=\"安装MysqlDb\"><a href=\"#安装MysqlDb\" class=\"headerlink\" title=\"安装MysqlDb\"></a>安装MysqlDb</h3><p>ubuntu</p>\n<pre><code># ubuntu安装步骤：\nsudo apt-get install python-setuptools\nsudo apt-get install libmysqld-dev\nsudo apt-get install libmysqlclient-dev\nsudo apt-get install python-dev\nsudo easy_install mysql-python</code></pre><p>windows下<a href=\"https://pypi.python.org/pypi/MySQL-python/1.2.5\" target=\"_blank\" rel=\"noopener\">https://pypi.python.org/pypi/MySQL-python/1.2.5</a> 下载.exe一键安装</p>\n<h3 id=\"创建项目\"><a href=\"#创建项目\" class=\"headerlink\" title=\"创建项目\"></a>创建项目</h3><pre><code>django-admin.py startproject Novel</code></pre><h3 id=\"创建APP\"><a href=\"#创建APP\" class=\"headerlink\" title=\"创建APP\"></a>创建APP</h3><pre><code>python manage.py startapp Heros</code></pre><p>/Novel/settings.py</p>\n<pre><code>INSTALLED_APPS = (\n    ...\n    &apos;Heroes&apos;,  #这里填写的是app的名称\n)</code></pre><h3 id=\"命令行调试模式\"><a href=\"#命令行调试模式\" class=\"headerlink\" title=\"命令行调试模式\"></a>命令行调试模式</h3><pre><code>python manage.py shell</code></pre><h3 id=\"运行开发服务器\"><a href=\"#运行开发服务器\" class=\"headerlink\" title=\"运行开发服务器\"></a>运行开发服务器</h3><pre><code>cd mysite\npython manage.py runserver 或者\npython manage.py runserver 0.0.0.0:8000</code></pre><h3 id=\"运行shell脚本方式\"><a href=\"#运行shell脚本方式\" class=\"headerlink\" title=\"运行shell脚本方式\"></a>运行shell脚本方式</h3><pre><code>python manager.py shell # 启动脚本环境\nfrom testapp.models import *  # 导入数据库</code></pre><h3 id=\"部署线上环境\"><a href=\"#部署线上环境\" class=\"headerlink\" title=\"部署线上环境\"></a>部署线上环境</h3><p>安装apache模块</p>\n<pre><code># Python 2\nsudo apt-get install libapache2-mod-wsgi\n\n# Python 3\nsudo apt-get install libapache2-mod-wsgi-py3</code></pre><p>Novel/Novel/wsgi.py</p>\n<pre><code>import os\nimport sys\nsys.path.append(&apos;/var/www/html/Novel/&apos;)\nsys.path.append(&apos;/var/www/html/Novel/Novel/&apos;)\nsys.path.append(&apos;/var/www/html/Novel/lib/python2.7/site-packages&apos;) # 虚拟环境需要添加\nfrom django.core.wsgi import get_wsgi_application\n\n\nos.environ.setdefault(&quot;DJANGO_SETTINGS_MODULE&quot;, &quot;Novel.settings&quot;)\napplication = get_wsgi_application()</code></pre><p>/etc/apache2/sites-enable/novel.conf</p>\n<pre><code>&lt;VirtualHost *:1200&gt;\n    ServerAdmin webmaster@localhost\n    DocumentRoot /var/www/html/Novel/Novel/Novel\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n    # 静态文件设置\n    Alias /static/ /var/www/html/Novel/Novel/Novel/static/\n    &lt;Directory /var/www/html/Novel/Novel/Novel/static/&gt;\n        Require all granted\n    &lt;/Directory&gt;\n\n    WSGIScriptAlias / /var/www/html/Novel/Novel/Novel/wsgi.py\n    &lt;Directory /var/www/html/Novel/Novel/Novel/&gt;\n        Require all granted\n        &lt;Files wsgi.py&gt;\n            Require all granted\n        &lt;/Files&gt;\n    &lt;/Directory&gt;\n\n&lt;/VirtualHost&gt;</code></pre><h3 id=\"视图与路由绑定\"><a href=\"#视图与路由绑定\" class=\"headerlink\" title=\"视图与路由绑定\"></a>视图与路由绑定</h3><p>/Heroes/views.py</p>\n<pre><code>from django.http import HttpResponse, Http404\n# Create your views here.\n\n\ndef hello(request):\n    return HttpResponse(&quot;Hello World&quot;)</code></pre><p>/Novel/urls.py</p>\n<pre><code>from django.conf.urls import include, url\nfrom Heroes.views import *\n\nurlpatterns = [\n    url(r&apos;^hello/$&apos;, hello),\n    url(r&apos;^time/plus/(\\d{1,2})/$&apos;, hours_ahead)\n]</code></pre><h3 id=\"视图与模板\"><a href=\"#视图与模板\" class=\"headerlink\" title=\"视图与模板\"></a>视图与模板</h3><p>/Novel/settings.py设置模板路径</p>\n<pre><code>TEMPLATES = [\n    {\n        # .....\n        &apos;DIRS&apos;: [\n            os.path.join(os.path.dirname(__file__), &apos;templates&apos;).replace(&apos;\\\\&apos;,&apos;/&apos;),\n        ],\n        # ....\n    },\n]</code></pre><p>/Novel/Heroes/views.py修改视图</p>\n<pre><code>from django.shortcuts import render_to_response\nfrom django.http import HttpResponse, Http404\nimport datetime\n# Create your views here.\n\n\n\ndef current_datetime(request):\n    now = datetime.datetime.now()\n    # html = &apos;&lt;html&gt;&lt;body&gt;It is %s.&lt;/body&gt;&lt;/html&gt;&apos; % now\n    return render_to_response(&apos;Heroes/current_datetime.html&apos;, {&apos;current_time&apos;: now})</code></pre><p>/Novel目录下创建templates/Heroes/current_datetime.html</p>\n<pre><code>&lt;!doctype html&gt;\n&lt;html lang=&quot;en&quot;&gt;\n&lt;head&gt;\n    &lt;meta charset=&quot;UTF-8&quot;&gt;\n    &lt;title&gt;Document&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;{ { current_time }}&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;</code></pre><h3 id=\"数据库配置\"><a href=\"#数据库配置\" class=\"headerlink\" title=\"数据库配置\"></a>数据库配置</h3><p>/Novel/settings.py</p>\n<pre><code>DATABASES = {\n    &apos;default&apos;: {\n        &apos;ENGINE&apos;: &apos;django.db.backends.mysql&apos;,\n        &apos;NAME&apos;: &apos;Novel&apos;,\n        &apos;USER&apos;: &apos;root&apos;,\n        &apos;PASSWORD&apos;: &apos;password&apos;,\n        &apos;HOST&apos;: &apos;127.0.0.1&apos;,\n        &apos;PORT&apos;: &apos;3306&apos;\n    }\n}</code></pre><p>测试是否成功</p>\n<pre><code>python manage.py shell\n&gt;&gt;&gt; from django.db import connection\n&gt;&gt;&gt; cursor = connection.cursor()</code></pre><h3 id=\"视图返回json数据格式\"><a href=\"#视图返回json数据格式\" class=\"headerlink\" title=\"视图返回json数据格式\"></a>视图返回json数据格式</h3><p>views.py</p>\n<pre><code>from django.http import HttpResponse, Http404\nfrom json import dumps\n\ndef login_handle(request):\n    if request.method != &apos;POST&apos;:\n        raise Http404()\n    inputs = request.POST\n    json_str = dumps(inputs)\n    return HttpResponse(json_str, content_type=&apos;application/json&apos;)</code></pre><p>### 静态文件 settings.py <figure class=\"highlight plain\"><figcaption><span>线上模式静态地址 STATIC_URL </span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">开发模式静态地址</span><br><span class=\"line\">========</span><br><span class=\"line\"></span><br><span class=\"line\">STATICFILES_DIRS = (os.path.join(os.path.dirname(**file**), &apos;static&apos;).replace(&apos;\\\\&apos;,&apos;/&apos;),)</span><br></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"2017-11-10号重新更新基本安装和线上部署\"><a href=\"#2017-11-10号重新更新基本安装和线上部署\" class=\"headerlink\" title=\"2017.11.10号重新更新基本安装和线上部署\"></a>2017.11.10号重新更新基本安装和线上部署</h3><p>环境：python3.5 django1.11</p>\n<pre><code># 安装环境\n$ sudo apt-get update\n$ sudo apt-get install python3-pip apache2 libapache2-mod-wsgi-py3\n$ sudo pip3 install virtualenv\n\n\n# 安装项目目录\n$ cd ~/www/html/\n$ virtualenv --no-site-packages -p /usr/bin/python3.5 CCO\n$ cd CCO\n$ source ./bin/activate\n(CCO) $ pip3 install ipython\n(CCO) $ pip3 install Django==1.11.7\n# 查看django是否安装成功\n(CCO) $  ipython\n &gt; import django\n &gt; django.VERSION # 打印出django版本表示成功\n# 开始创建项目\n(CCO) $ django-admin.py startproject CCO_WEB\n# 创建应用\n(CCO) $ cd CCO_WEB\n(CCO) $ django-admin.py startapp polls\n\n\n# 修改文件内容\n(CCO) $ vim CCO_WEB/CCO_WEB/setting.py\nALLOWED_HOSTS = [&apos;127.0.0.1&apos;, &apos;localhost&apos;]  # 修改\nSTATIC_URL = &apos;/static/&apos; # 原始\nSTATIC_ROOT = os.path.join(BASE_DIR, &apos;static/&apos;) # 添加\n\n\n# 创建数据库和超级管理员\n(CCO) $ ./manage.py makemigrations\n(CCO) $ ./manage.py migrate\n(CCO) $ ./manage.py createsuperuser # 创建超级管理员\n(CCO) $ ./manage.py collectstatic # 收集静态文件\n\n\n### 用django自带服务器运行\n(CCO) $ sudo ufw allow 8000 # 关闭防火墙\n(CCO) $ ./manage.py runserver 0.0.0.0:8000 # 成功表示django开发环境配置完成\n\n\n### 线上部署\napache虚拟主机配置\n$ sudo vim /etc/apache2/sites-available/www.cco.com.conf\n&lt;VirtualHost *:80&gt;\n        ServerName www.example.com\n        ServerAdmin webmaster@localhost\n         # 这里指明静态文件存放的地方\n    Alias /static  /home/hanchang/www/html/CCO/CCO_WEB/static\n    # 给文件夹分配权限\n    &lt;Directory /home/hanchang/www/html/CCO/CCO_WEB/static&gt;\n            Require all granted\n    &lt;/Directory&gt;\n    #接下来，我们将授予访问存储Django代码的二级项目目录中的wsgi.py文件的权限。\n    &lt;Directory /home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB&gt;\n    &lt;Files wsgi.py&gt;\n            Require all granted\n    &lt;/Files&gt;\n    &lt;/Directory&gt;\n        WSGIDaemonProcess CCO_WEB python-home=/home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB python-path=/home/hanchang/www/html/CCO\n    WSGIProcessGroup CCO_WEB\n    WSGIScriptAlias / /home/hanchang/www/html/CCO/CCO_WEB/CCO_WEB/wsgi.py\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n&lt;/VirtualHost&gt;\n\n\n### 线上\nsudo a2ensite www.cco.com\nsudo service apache2 restart\nhttp://127.0.0.1 查看\n原文查看　https://www.digitalocean.com/community/tutorials/how-to-serve-django-applications-with-apache-and-mod_wsgi-on-ubuntu-16-04</code></pre><h3 id=\"数据库安装\"><a href=\"#数据库安装\" class=\"headerlink\" title=\"数据库安装\"></a>数据库安装</h3><pre><code>$ sudo apt-get install python-setuptools\n$ sudo apt-get install libmysqld-dev\n$ sudo apt-get install libmysqlclient-dev\n$ sudo apt-get install python-dev\n$ sudo easy_install mysql-python\n$ pip3 install mysqlclient</code></pre><h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><pre><code># 需要先安装虚拟环境\n(Novel) pip isntall django==1.8.2 # 不能加sudo</code></pre><h3 id=\"查看是否安装成功及版本号\"><a href=\"#查看是否安装成功及版本号\" class=\"headerlink\" title=\"查看是否安装成功及版本号\"></a>查看是否安装成功及版本号</h3><pre><code>python\nimport django\ndjango.VERSION</code></pre><h3 id=\"安装MysqlDb\"><a href=\"#安装MysqlDb\" class=\"headerlink\" title=\"安装MysqlDb\"></a>安装MysqlDb</h3><p>ubuntu</p>\n<pre><code># ubuntu安装步骤：\nsudo apt-get install python-setuptools\nsudo apt-get install libmysqld-dev\nsudo apt-get install libmysqlclient-dev\nsudo apt-get install python-dev\nsudo easy_install mysql-python</code></pre><p>windows下<a href=\"https://pypi.python.org/pypi/MySQL-python/1.2.5\" target=\"_blank\" rel=\"noopener\">https://pypi.python.org/pypi/MySQL-python/1.2.5</a> 下载.exe一键安装</p>\n<h3 id=\"创建项目\"><a href=\"#创建项目\" class=\"headerlink\" title=\"创建项目\"></a>创建项目</h3><pre><code>django-admin.py startproject Novel</code></pre><h3 id=\"创建APP\"><a href=\"#创建APP\" class=\"headerlink\" title=\"创建APP\"></a>创建APP</h3><pre><code>python manage.py startapp Heros</code></pre><p>/Novel/settings.py</p>\n<pre><code>INSTALLED_APPS = (\n    ...\n    &apos;Heroes&apos;,  #这里填写的是app的名称\n)</code></pre><h3 id=\"命令行调试模式\"><a href=\"#命令行调试模式\" class=\"headerlink\" title=\"命令行调试模式\"></a>命令行调试模式</h3><pre><code>python manage.py shell</code></pre><h3 id=\"运行开发服务器\"><a href=\"#运行开发服务器\" class=\"headerlink\" title=\"运行开发服务器\"></a>运行开发服务器</h3><pre><code>cd mysite\npython manage.py runserver 或者\npython manage.py runserver 0.0.0.0:8000</code></pre><h3 id=\"运行shell脚本方式\"><a href=\"#运行shell脚本方式\" class=\"headerlink\" title=\"运行shell脚本方式\"></a>运行shell脚本方式</h3><pre><code>python manager.py shell # 启动脚本环境\nfrom testapp.models import *  # 导入数据库</code></pre><h3 id=\"部署线上环境\"><a href=\"#部署线上环境\" class=\"headerlink\" title=\"部署线上环境\"></a>部署线上环境</h3><p>安装apache模块</p>\n<pre><code># Python 2\nsudo apt-get install libapache2-mod-wsgi\n\n# Python 3\nsudo apt-get install libapache2-mod-wsgi-py3</code></pre><p>Novel/Novel/wsgi.py</p>\n<pre><code>import os\nimport sys\nsys.path.append(&apos;/var/www/html/Novel/&apos;)\nsys.path.append(&apos;/var/www/html/Novel/Novel/&apos;)\nsys.path.append(&apos;/var/www/html/Novel/lib/python2.7/site-packages&apos;) # 虚拟环境需要添加\nfrom django.core.wsgi import get_wsgi_application\n\n\nos.environ.setdefault(&quot;DJANGO_SETTINGS_MODULE&quot;, &quot;Novel.settings&quot;)\napplication = get_wsgi_application()</code></pre><p>/etc/apache2/sites-enable/novel.conf</p>\n<pre><code>&lt;VirtualHost *:1200&gt;\n    ServerAdmin webmaster@localhost\n    DocumentRoot /var/www/html/Novel/Novel/Novel\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n    # 静态文件设置\n    Alias /static/ /var/www/html/Novel/Novel/Novel/static/\n    &lt;Directory /var/www/html/Novel/Novel/Novel/static/&gt;\n        Require all granted\n    &lt;/Directory&gt;\n\n    WSGIScriptAlias / /var/www/html/Novel/Novel/Novel/wsgi.py\n    &lt;Directory /var/www/html/Novel/Novel/Novel/&gt;\n        Require all granted\n        &lt;Files wsgi.py&gt;\n            Require all granted\n        &lt;/Files&gt;\n    &lt;/Directory&gt;\n\n&lt;/VirtualHost&gt;</code></pre><h3 id=\"视图与路由绑定\"><a href=\"#视图与路由绑定\" class=\"headerlink\" title=\"视图与路由绑定\"></a>视图与路由绑定</h3><p>/Heroes/views.py</p>\n<pre><code>from django.http import HttpResponse, Http404\n# Create your views here.\n\n\ndef hello(request):\n    return HttpResponse(&quot;Hello World&quot;)</code></pre><p>/Novel/urls.py</p>\n<pre><code>from django.conf.urls import include, url\nfrom Heroes.views import *\n\nurlpatterns = [\n    url(r&apos;^hello/$&apos;, hello),\n    url(r&apos;^time/plus/(\\d{1,2})/$&apos;, hours_ahead)\n]</code></pre><h3 id=\"视图与模板\"><a href=\"#视图与模板\" class=\"headerlink\" title=\"视图与模板\"></a>视图与模板</h3><p>/Novel/settings.py设置模板路径</p>\n<pre><code>TEMPLATES = [\n    {\n        # .....\n        &apos;DIRS&apos;: [\n            os.path.join(os.path.dirname(__file__), &apos;templates&apos;).replace(&apos;\\\\&apos;,&apos;/&apos;),\n        ],\n        # ....\n    },\n]</code></pre><p>/Novel/Heroes/views.py修改视图</p>\n<pre><code>from django.shortcuts import render_to_response\nfrom django.http import HttpResponse, Http404\nimport datetime\n# Create your views here.\n\n\n\ndef current_datetime(request):\n    now = datetime.datetime.now()\n    # html = &apos;&lt;html&gt;&lt;body&gt;It is %s.&lt;/body&gt;&lt;/html&gt;&apos; % now\n    return render_to_response(&apos;Heroes/current_datetime.html&apos;, {&apos;current_time&apos;: now})</code></pre><p>/Novel目录下创建templates/Heroes/current_datetime.html</p>\n<pre><code>&lt;!doctype html&gt;\n&lt;html lang=&quot;en&quot;&gt;\n&lt;head&gt;\n    &lt;meta charset=&quot;UTF-8&quot;&gt;\n    &lt;title&gt;Document&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;{ { current_time }}&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;</code></pre><h3 id=\"数据库配置\"><a href=\"#数据库配置\" class=\"headerlink\" title=\"数据库配置\"></a>数据库配置</h3><p>/Novel/settings.py</p>\n<pre><code>DATABASES = {\n    &apos;default&apos;: {\n        &apos;ENGINE&apos;: &apos;django.db.backends.mysql&apos;,\n        &apos;NAME&apos;: &apos;Novel&apos;,\n        &apos;USER&apos;: &apos;root&apos;,\n        &apos;PASSWORD&apos;: &apos;password&apos;,\n        &apos;HOST&apos;: &apos;127.0.0.1&apos;,\n        &apos;PORT&apos;: &apos;3306&apos;\n    }\n}</code></pre><p>测试是否成功</p>\n<pre><code>python manage.py shell\n&gt;&gt;&gt; from django.db import connection\n&gt;&gt;&gt; cursor = connection.cursor()</code></pre><h3 id=\"视图返回json数据格式\"><a href=\"#视图返回json数据格式\" class=\"headerlink\" title=\"视图返回json数据格式\"></a>视图返回json数据格式</h3><p>views.py</p>\n<pre><code>from django.http import HttpResponse, Http404\nfrom json import dumps\n\ndef login_handle(request):\n    if request.method != &apos;POST&apos;:\n        raise Http404()\n    inputs = request.POST\n    json_str = dumps(inputs)\n    return HttpResponse(json_str, content_type=&apos;application/json&apos;)</code></pre><p>### 静态文件 settings.py <figure class=\"highlight plain\"><figcaption><span>线上模式静态地址 STATIC_URL </span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">开发模式静态地址</span><br><span class=\"line\">========</span><br><span class=\"line\"></span><br><span class=\"line\">STATICFILES_DIRS = (os.path.join(os.path.dirname(**file**), &apos;static&apos;).replace(&apos;\\\\&apos;,&apos;/&apos;),)</span><br></pre></td></tr></table></figure></p>\n"},{"title":"ffmpeg滤镜基础","date":"2019-07-24T01:18:29.000Z","_content":"\n##### 裁剪滤镜\n\n```\n$ ffmpeg -i output.mkv -vf crop=in_w-400:in_h-200 -c:v libx264 -c:a copy output.mp4\n```\n\n> -i 输入\n>\n> -vf -v 视频 f 滤镜 crop 裁剪滤镜\n>\n> -c:v\n>\n> -c:a copy 音频直接复制\n\n##### 视频裁剪\n\n```\n$ ffmpeg -i output.mkv -ss 00:00:00 -t 10 output.mp4\n```\n\n> -ss 开始时间(时:分:秒)\n>\n> -t 时常(秒)\n\n##### 视频合并\n\n```\n$ ffmpeg -f concat -i inputs.txt output.mp4\n```\n\n> -f  concat 拼接\n>\n> -i 输入文件 inputs.txt 记录全部等待拼接的文件\n>\n> inputs.txt每一行为“file filename”\n>\n> \t> file 'out1.mp4'\n> \t>\n> \t> file 'out2.mp4'\n>\n> output.mp4 输出文件\n\n##### 视频转图片\n\n```\n$ ffmpeg -i output.mp4 -r 1 -f image2 image-%3d.jpeg\n```\n\n> -i 输入文件\n>\n> -r 1, r 帧率， 1 每秒一张图片\n>\n> -f image2, 转成image2格式\n>\n> image-%3d.jpeg 输出文件\n\n##### 图片转视频\n\n```\n$ ffmpeg -i image-%3d.jpeg output.mp4\n```\n\n","source":"_posts/ffmpeg滤镜基础.md","raw":"---\ntitle: ffmpeg滤镜基础\ndate: 2019-07-24 09:18:29\ntags:\n---\n\n##### 裁剪滤镜\n\n```\n$ ffmpeg -i output.mkv -vf crop=in_w-400:in_h-200 -c:v libx264 -c:a copy output.mp4\n```\n\n> -i 输入\n>\n> -vf -v 视频 f 滤镜 crop 裁剪滤镜\n>\n> -c:v\n>\n> -c:a copy 音频直接复制\n\n##### 视频裁剪\n\n```\n$ ffmpeg -i output.mkv -ss 00:00:00 -t 10 output.mp4\n```\n\n> -ss 开始时间(时:分:秒)\n>\n> -t 时常(秒)\n\n##### 视频合并\n\n```\n$ ffmpeg -f concat -i inputs.txt output.mp4\n```\n\n> -f  concat 拼接\n>\n> -i 输入文件 inputs.txt 记录全部等待拼接的文件\n>\n> inputs.txt每一行为“file filename”\n>\n> \t> file 'out1.mp4'\n> \t>\n> \t> file 'out2.mp4'\n>\n> output.mp4 输出文件\n\n##### 视频转图片\n\n```\n$ ffmpeg -i output.mp4 -r 1 -f image2 image-%3d.jpeg\n```\n\n> -i 输入文件\n>\n> -r 1, r 帧率， 1 每秒一张图片\n>\n> -f image2, 转成image2格式\n>\n> image-%3d.jpeg 输出文件\n\n##### 图片转视频\n\n```\n$ ffmpeg -i image-%3d.jpeg output.mp4\n```\n\n","slug":"ffmpeg滤镜基础","published":1,"updated":"2019-07-24T01:19:04.270Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjyu0a5nu000u9ka44zwbv16q","content":"<h5 id=\"裁剪滤镜\"><a href=\"#裁剪滤镜\" class=\"headerlink\" title=\"裁剪滤镜\"></a>裁剪滤镜</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i output.mkv -vf crop=in_w-400:in_h-200 -c:v libx264 -c:a copy output.mp4</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-i 输入</p>\n<p>-vf -v 视频 f 滤镜 crop 裁剪滤镜</p>\n<p>-c:v</p>\n<p>-c:a copy 音频直接复制</p>\n</blockquote>\n<h5 id=\"视频裁剪\"><a href=\"#视频裁剪\" class=\"headerlink\" title=\"视频裁剪\"></a>视频裁剪</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i output.mkv -ss 00:00:00 -t 10 output.mp4</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-ss 开始时间(时:分:秒)</p>\n<p>-t 时常(秒)</p>\n</blockquote>\n<h5 id=\"视频合并\"><a href=\"#视频合并\" class=\"headerlink\" title=\"视频合并\"></a>视频合并</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -f concat -i inputs.txt output.mp4</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-f  concat 拼接</p>\n<p>-i 输入文件 inputs.txt 记录全部等待拼接的文件</p>\n<p>inputs.txt每一行为“file filename”</p>\n<pre><code>&gt; file &apos;out1.mp4&apos;\n&gt;\n&gt; file &apos;out2.mp4&apos;</code></pre><p>output.mp4 输出文件</p>\n</blockquote>\n<h5 id=\"视频转图片\"><a href=\"#视频转图片\" class=\"headerlink\" title=\"视频转图片\"></a>视频转图片</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i output.mp4 -r 1 -f image2 image-%3d.jpeg</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-i 输入文件</p>\n<p>-r 1, r 帧率， 1 每秒一张图片</p>\n<p>-f image2, 转成image2格式</p>\n<p>image-%3d.jpeg 输出文件</p>\n</blockquote>\n<h5 id=\"图片转视频\"><a href=\"#图片转视频\" class=\"headerlink\" title=\"图片转视频\"></a>图片转视频</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i image-%3d.jpeg output.mp4</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h5 id=\"裁剪滤镜\"><a href=\"#裁剪滤镜\" class=\"headerlink\" title=\"裁剪滤镜\"></a>裁剪滤镜</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i output.mkv -vf crop=in_w-400:in_h-200 -c:v libx264 -c:a copy output.mp4</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-i 输入</p>\n<p>-vf -v 视频 f 滤镜 crop 裁剪滤镜</p>\n<p>-c:v</p>\n<p>-c:a copy 音频直接复制</p>\n</blockquote>\n<h5 id=\"视频裁剪\"><a href=\"#视频裁剪\" class=\"headerlink\" title=\"视频裁剪\"></a>视频裁剪</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i output.mkv -ss 00:00:00 -t 10 output.mp4</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-ss 开始时间(时:分:秒)</p>\n<p>-t 时常(秒)</p>\n</blockquote>\n<h5 id=\"视频合并\"><a href=\"#视频合并\" class=\"headerlink\" title=\"视频合并\"></a>视频合并</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -f concat -i inputs.txt output.mp4</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-f  concat 拼接</p>\n<p>-i 输入文件 inputs.txt 记录全部等待拼接的文件</p>\n<p>inputs.txt每一行为“file filename”</p>\n<pre><code>&gt; file &apos;out1.mp4&apos;\n&gt;\n&gt; file &apos;out2.mp4&apos;</code></pre><p>output.mp4 输出文件</p>\n</blockquote>\n<h5 id=\"视频转图片\"><a href=\"#视频转图片\" class=\"headerlink\" title=\"视频转图片\"></a>视频转图片</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i output.mp4 -r 1 -f image2 image-%3d.jpeg</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-i 输入文件</p>\n<p>-r 1, r 帧率， 1 每秒一张图片</p>\n<p>-f image2, 转成image2格式</p>\n<p>image-%3d.jpeg 输出文件</p>\n</blockquote>\n<h5 id=\"图片转视频\"><a href=\"#图片转视频\" class=\"headerlink\" title=\"图片转视频\"></a>图片转视频</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i image-%3d.jpeg output.mp4</span><br></pre></td></tr></table></figure>\n\n"},{"title":"ffmpeg直播基础","date":"2019-07-24T01:19:22.000Z","_content":"\n##### 直播推流\n\n```\n$ ffmpeg -re -i out.mp4 -c copy -f flv rtmp://server/live/streamName\n```\n\n> -re 保持本地视频和流媒体服务器帧率一致\n>\n> -c 不做操作，直接复制\n>\n> -f 格式\n\n##### 直播拉流\n\n```\n$ ffmpeg -i rmtp://server/live/streamName -c copy dump.flv\n```\n\n","source":"_posts/ffmpeg直播基础.md","raw":"---\ntitle: ffmpeg直播基础\ndate: 2019-07-24 09:19:22\ntags:\n  - ffmpeg\n---\n\n##### 直播推流\n\n```\n$ ffmpeg -re -i out.mp4 -c copy -f flv rtmp://server/live/streamName\n```\n\n> -re 保持本地视频和流媒体服务器帧率一致\n>\n> -c 不做操作，直接复制\n>\n> -f 格式\n\n##### 直播拉流\n\n```\n$ ffmpeg -i rmtp://server/live/streamName -c copy dump.flv\n```\n\n","slug":"ffmpeg直播基础","published":1,"updated":"2019-07-24T01:19:56.380Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjyu0a5nu000x9ka4zt2u7xxo","content":"<h5 id=\"直播推流\"><a href=\"#直播推流\" class=\"headerlink\" title=\"直播推流\"></a>直播推流</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -re -i out.mp4 -c copy -f flv rtmp://server/live/streamName</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-re 保持本地视频和流媒体服务器帧率一致</p>\n<p>-c 不做操作，直接复制</p>\n<p>-f 格式</p>\n</blockquote>\n<h5 id=\"直播拉流\"><a href=\"#直播拉流\" class=\"headerlink\" title=\"直播拉流\"></a>直播拉流</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i rmtp://server/live/streamName -c copy dump.flv</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h5 id=\"直播推流\"><a href=\"#直播推流\" class=\"headerlink\" title=\"直播推流\"></a>直播推流</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -re -i out.mp4 -c copy -f flv rtmp://server/live/streamName</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>-re 保持本地视频和流媒体服务器帧率一致</p>\n<p>-c 不做操作，直接复制</p>\n<p>-f 格式</p>\n</blockquote>\n<h5 id=\"直播拉流\"><a href=\"#直播拉流\" class=\"headerlink\" title=\"直播拉流\"></a>直播拉流</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ffmpeg -i rmtp://server/live/streamName -c copy dump.flv</span><br></pre></td></tr></table></figure>\n\n"},{"title":"ffmpeg视频基础","date":"2019-07-24T01:15:39.000Z","_content":"\n#### 基本概念\n\nH264基本概念\n\n> I帧： 关键帧、采用帧内压缩技术\n> P帧：向前参考帧，采用帧内压缩技术\n> B帧：双向参考帧，采用帧内压缩技术\n\nGOF:\n> 一组帧group of frame\n\nSPS:\n> Sequence parameter set: 序列参数集：存放一组帧的存放帧数，参考帧数目，解码图像尺寸等\n\nPPS：\n> picture parameter set: 图像参数集：存放熵编码模式选择标识、片组数目等\n\n\n\n#### 视频编解码器\n\n> x264：最流行的\n> x265：耗性能\n> openH264：支持svc视频技术\n> vp8: x264\n> vp9: x265\n\n\n\n#### H264压缩技术\n\n> 帧内压缩：解决空域数据冗余技术\n>\n> 帧间压缩：解决时域数据冗余技术\n>\n> 整数离散余弦变换(DCT)：将空间上的相关性变为频域上无关的数据然后进行量化\n>\n> CABAC压缩\n\n![H264结构图](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/H264%E7%BB%93%E6%9E%84%E5%9B%BE.png)\n\n#### H264编码分层\n> NAL层：network abstraction layer 视频数据网络抽象层\n> VCL层：video coding layer 视频数据编码层\n\n#### 码流\nSODB\n> string of data bits 原始数据比特流，它是由vcl层产生的\n\nRBSP\n> 在SODB最后一位补1，不按字节对其则补0\n\nEBSP\n\n> \n\nNALU\n\n> NAL HEADER + EBSP\n\n","source":"_posts/ffmpeg视频基础.md","raw":"---\ntitle: ffmpeg视频基础\ndate: 2019-07-24 09:15:39\ntags:\n  - ffmpeg\n---\n\n#### 基本概念\n\nH264基本概念\n\n> I帧： 关键帧、采用帧内压缩技术\n> P帧：向前参考帧，采用帧内压缩技术\n> B帧：双向参考帧，采用帧内压缩技术\n\nGOF:\n> 一组帧group of frame\n\nSPS:\n> Sequence parameter set: 序列参数集：存放一组帧的存放帧数，参考帧数目，解码图像尺寸等\n\nPPS：\n> picture parameter set: 图像参数集：存放熵编码模式选择标识、片组数目等\n\n\n\n#### 视频编解码器\n\n> x264：最流行的\n> x265：耗性能\n> openH264：支持svc视频技术\n> vp8: x264\n> vp9: x265\n\n\n\n#### H264压缩技术\n\n> 帧内压缩：解决空域数据冗余技术\n>\n> 帧间压缩：解决时域数据冗余技术\n>\n> 整数离散余弦变换(DCT)：将空间上的相关性变为频域上无关的数据然后进行量化\n>\n> CABAC压缩\n\n![H264结构图](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/H264%E7%BB%93%E6%9E%84%E5%9B%BE.png)\n\n#### H264编码分层\n> NAL层：network abstraction layer 视频数据网络抽象层\n> VCL层：video coding layer 视频数据编码层\n\n#### 码流\nSODB\n> string of data bits 原始数据比特流，它是由vcl层产生的\n\nRBSP\n> 在SODB最后一位补1，不按字节对其则补0\n\nEBSP\n\n> \n\nNALU\n\n> NAL HEADER + EBSP\n\n","slug":"ffmpeg视频基础","published":1,"updated":"2019-07-24T01:16:41.880Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjyu0a5nw00119ka49hazqune","content":"<h4 id=\"基本概念\"><a href=\"#基本概念\" class=\"headerlink\" title=\"基本概念\"></a>基本概念</h4><p>H264基本概念</p>\n<blockquote>\n<p>I帧： 关键帧、采用帧内压缩技术<br>P帧：向前参考帧，采用帧内压缩技术<br>B帧：双向参考帧，采用帧内压缩技术</p>\n</blockquote>\n<p>GOF:</p>\n<blockquote>\n<p>一组帧group of frame</p>\n</blockquote>\n<p>SPS:</p>\n<blockquote>\n<p>Sequence parameter set: 序列参数集：存放一组帧的存放帧数，参考帧数目，解码图像尺寸等</p>\n</blockquote>\n<p>PPS：</p>\n<blockquote>\n<p>picture parameter set: 图像参数集：存放熵编码模式选择标识、片组数目等</p>\n</blockquote>\n<h4 id=\"视频编解码器\"><a href=\"#视频编解码器\" class=\"headerlink\" title=\"视频编解码器\"></a>视频编解码器</h4><blockquote>\n<p>x264：最流行的<br>x265：耗性能<br>openH264：支持svc视频技术<br>vp8: x264<br>vp9: x265</p>\n</blockquote>\n<h4 id=\"H264压缩技术\"><a href=\"#H264压缩技术\" class=\"headerlink\" title=\"H264压缩技术\"></a>H264压缩技术</h4><blockquote>\n<p>帧内压缩：解决空域数据冗余技术</p>\n<p>帧间压缩：解决时域数据冗余技术</p>\n<p>整数离散余弦变换(DCT)：将空间上的相关性变为频域上无关的数据然后进行量化</p>\n<p>CABAC压缩</p>\n</blockquote>\n<p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/H264%E7%BB%93%E6%9E%84%E5%9B%BE.png\" alt=\"H264结构图\"></p>\n<h4 id=\"H264编码分层\"><a href=\"#H264编码分层\" class=\"headerlink\" title=\"H264编码分层\"></a>H264编码分层</h4><blockquote>\n<p>NAL层：network abstraction layer 视频数据网络抽象层<br>VCL层：video coding layer 视频数据编码层</p>\n</blockquote>\n<h4 id=\"码流\"><a href=\"#码流\" class=\"headerlink\" title=\"码流\"></a>码流</h4><p>SODB</p>\n<blockquote>\n<p>string of data bits 原始数据比特流，它是由vcl层产生的</p>\n</blockquote>\n<p>RBSP</p>\n<blockquote>\n<p>在SODB最后一位补1，不按字节对其则补0</p>\n</blockquote>\n<p>EBSP</p>\n<blockquote>\n</blockquote>\n<p>NALU</p>\n<blockquote>\n<p>NAL HEADER + EBSP</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"基本概念\"><a href=\"#基本概念\" class=\"headerlink\" title=\"基本概念\"></a>基本概念</h4><p>H264基本概念</p>\n<blockquote>\n<p>I帧： 关键帧、采用帧内压缩技术<br>P帧：向前参考帧，采用帧内压缩技术<br>B帧：双向参考帧，采用帧内压缩技术</p>\n</blockquote>\n<p>GOF:</p>\n<blockquote>\n<p>一组帧group of frame</p>\n</blockquote>\n<p>SPS:</p>\n<blockquote>\n<p>Sequence parameter set: 序列参数集：存放一组帧的存放帧数，参考帧数目，解码图像尺寸等</p>\n</blockquote>\n<p>PPS：</p>\n<blockquote>\n<p>picture parameter set: 图像参数集：存放熵编码模式选择标识、片组数目等</p>\n</blockquote>\n<h4 id=\"视频编解码器\"><a href=\"#视频编解码器\" class=\"headerlink\" title=\"视频编解码器\"></a>视频编解码器</h4><blockquote>\n<p>x264：最流行的<br>x265：耗性能<br>openH264：支持svc视频技术<br>vp8: x264<br>vp9: x265</p>\n</blockquote>\n<h4 id=\"H264压缩技术\"><a href=\"#H264压缩技术\" class=\"headerlink\" title=\"H264压缩技术\"></a>H264压缩技术</h4><blockquote>\n<p>帧内压缩：解决空域数据冗余技术</p>\n<p>帧间压缩：解决时域数据冗余技术</p>\n<p>整数离散余弦变换(DCT)：将空间上的相关性变为频域上无关的数据然后进行量化</p>\n<p>CABAC压缩</p>\n</blockquote>\n<p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/H264%E7%BB%93%E6%9E%84%E5%9B%BE.png\" alt=\"H264结构图\"></p>\n<h4 id=\"H264编码分层\"><a href=\"#H264编码分层\" class=\"headerlink\" title=\"H264编码分层\"></a>H264编码分层</h4><blockquote>\n<p>NAL层：network abstraction layer 视频数据网络抽象层<br>VCL层：video coding layer 视频数据编码层</p>\n</blockquote>\n<h4 id=\"码流\"><a href=\"#码流\" class=\"headerlink\" title=\"码流\"></a>码流</h4><p>SODB</p>\n<blockquote>\n<p>string of data bits 原始数据比特流，它是由vcl层产生的</p>\n</blockquote>\n<p>RBSP</p>\n<blockquote>\n<p>在SODB最后一位补1，不按字节对其则补0</p>\n</blockquote>\n<p>EBSP</p>\n<blockquote>\n</blockquote>\n<p>NALU</p>\n<blockquote>\n<p>NAL HEADER + EBSP</p>\n</blockquote>\n"},{"title":"ffmpeg录制基础","date":"2019-07-24T01:21:02.000Z","_content":"#### ffmpeg录制功能\n\n> ffmpeg第一步：录制音视频\n\n#### 录制设备查询\n\n```shell\n➜  $ ffmpeg -hide_banner -devices\nDevices:\n D. = Demuxing supported\n .E = Muxing supported\n --\n DE alsa            ALSA audio output\n DE fbdev           Linux framebuffer\n D  iec61883        libiec61883 (new DV1394) A/V input device\n D  jack            JACK Audio Connection Kit\n D  kmsgrab         KMS screen capture\n D  lavfi           Libavfilter virtual input device\n DE oss             OSS (Open Sound System) playback\n DE pulse           Pulse audio output\n  E sdl,sdl2        SDL2 output device\n DE video4linux2,v4l2 Video4Linux2 output device\n D  x11grab         X11 screen capture, using XCB\n  E xv              XV (XVideo) output device\n```\n\nD：输入设备\n\nE：输出设备 \n\n[ffmpeg输入设备列表](<https://ffmpeg.org/ffmpeg-devices.html#Input-Devices>)\n\n> alsa\n>\n> > 音频\n> >\n> > ALSA是Advanced Linux Sound Architecture的缩写，高级Linux声音架构的简称,它在Linux操作系统上提供了音频和MIDI（Musical Instrument Digital Interface，音乐设备数字化接口）的支持，需要安装libasound库\n>\n> android_camera\n>\n> > 音视频\n> >\n> > Android相机输入设备。 此输入设备使用Android Camera2 NDK API，该API可在API级别为24+的设备上使用。在配置期间自动检测android_camera的可用性。 该设备允许从Android设备上的所有摄像头进行捕获，这些摄像头集成在Camera2 NDK API中。 可用的摄像机在内部枚举，可以使用camera_index参数进行选择。输入文件字符串被丢弃。 通常，后置摄像头的索引为0，而前置摄像头的索引为1。\n>\n> avfoundation\n>\n> > 音视频\n> >\n> > 苹果设备\n>\n> bktr\n>\n> > BSD 视频输入设备\n>\n> decklink\n>\n> > BlackMagic Decklink是一款影像采集编辑产品，接口类型PCI-33/66、PCI-X 133&100MHz 。\n>\n> dshow\n>\n> > Windows DirectShow input device.\n>\n> fbdev\n>\n> > Linux framebuffer（Linux帧缓冲）输入设备，只能录制终端的视频\n> >\n> > Linux framebuffer是一种独立于硬件的图像抽象层，它用于在计算机屏幕上显示图像,通常是在控制台（环境）。它可以通过一个文件设备节点访问，通常为：`/dev/fb0`\n>\n> gdigrab\n>\n> > Win32 GDI 屏幕截取设备\n> >\n> > 这个设备允许你截取显示在Windows（系统）上的屏幕区域。\n>\n> iec61883\n>\n> > 使用`iec61883`的FireWire（火线） DV/HDV输入设备。\n> >\n> > 要允许这个输入设备，需要`libiec61883`, `libraw1394` 和 `libavc1394`被安装到系统中。此外还要在编译时配置`--enable-libiec61883`以支持。\n>\n> jack\n>\n> > JACK输入设备。\n> >\n> > 为了能使用JACK设备，需要系统上存在`libjack`\n>\n> kmsgrab\n>\n> lavfi\n>\n> > `Libavfilter`输入虚拟设备\n> >\n> > 这个输入设备可以从`libavfilter`滤镜链图的一个开放输出端口读取数据。\n> >\n> > 对于每个滤镜链图开放输出端口，这个输入设备将创建一个对应的流映射到这个端口进行输出。当前只支持视频数据。滤镜链图是通过选项`graph`描述的。\n>\n> libcdio\n>\n> > 基于`libcdio`的音乐CD输入设备。\n> >\n> > 需要系统中有`libcdio`才能启用，且编译时需要用`--enable-libcdio`配置选项允许。\n>\n> libdc1394\n>\n> > IIDC1394输入设备，其基于`libdc1394`和`libraw1394`\n> >\n> > 编译允许需要配置`--enable-libdc1394`\n>\n> openal\n>\n> > 这个OpenAL输入设备支持在所有实现了`OpenAL 1.1`的系统上进行音频捕获。\n> >\n> > 要编译使用它需要系统包含`OpenAL`头和`libraries`库，并且设置编译选项`--enable-openal`\n>\n> oss\n>\n> pulse\n>\n> > PulseAudio（脉冲音频）输入设备\n> >\n> > 要使用须编译配置设置`--enable-libpulse`\n>\n> sndio\n>\n> > sndio输入设备。\n> >\n> > 要使用它需要系统安装并配置有`libsndio`库\n>\n> video4linux2, v4l2\n>\n> > Video4Linux2 输入视频设备\n> >\n> > \"v4l2\"是\"video4linux2\"的别名\n> >\n> > 编译需要`v4l-utiles`支持（`--enable-libv4l2`编译选项被配置），也可用于`-use_libv4l2`输入设备选项。\n> >\n> > 捕获的设备名是一个文件设备节点，通常Linux系统在设备（例如USB摄像头）插入到系统时自动创建这样的节点，会被命名为`/dev/videoN`，`N`是设备索引序号\n> >\n> > Video4Linux设备通常只支持有限的分辨率（`width x height`）和帧率,通过`-list_formats all`选项来获取支持情况。一些设备，例如电视卡可以支持1个或者多个标准，它支持的标准可以通过`-list_standards all`来了解。\n> >\n> > 时间戳时基单位为1microsecond。根据内核版本和配置，时间戳可以基于实时间（real time clock——绝对时间，一种起源于Unix的表示方式）或者单调时钟（monotonic clock——通常源自启动时间，不受NTP或者手动改变）。`-timestamps abs`或者`-ts abs`选择启用实时间。\n>\n> vfwcap\n>\n> > vfw（Video for Windows）捕获输入端\n> >\n> > 文件名必须是捕获设备索引，范围0-9可以用`list`作为文件名，将输出一个设备列表。任何数字外其它文件名被视作设备索引0。\n>\n> x11grab\n>\n> > X11 视频输入设备\n> >\n> > 使用需要`libxcb`库，它会在编译时自动检测。\n\n\n\n##### fbdev： linux终端录制设备\n\n查看使用指定采集设备参数\n\n```shell\n$ ffmpeg -hide_banner -h demuxer=fbdev\nDemuxer fbdev [Linux framebuffer]:\nfbdev indev AVOptions:\n  -framerate         <video_rate> .D.......  (default \"25\")\n# framerate 帧数 默认25帧\n```\n```shell\n$ sudo ffmpeg -framerate 30  -f fbdev -i /dev/fb0 output.mp4\n```\n\n\n##### v412：linux摄像头录制设备\n\n```shell\n$ ffmpeg -hide_banner -h demuxer=Video4Linux2\n```\n\n| 参数            | 类型     | 说明                         |\n| --------------- | -------- | ---------------------------- |\n| -standard       | 字符串   | 设置tv标准                   |\n| -channel        | 整数     | 设置tv通道                   |\n| -video_size     | 图像大小 | 设置采集视频频帧大小         |\n| -pixel_format   | 字符串   | 设置采集视频的分辨率         |\n| -input_format   | 字符串   | 设置采集视频的分辨率         |\n| -framerate      | 字符串   | 设置采集视频帧率             |\n| -list_formats   | 整数     | 列举输入视频信号的信息       |\n| -list_standards | 整数     | 列举标准信息                 |\n| -timestamps     | 整数     | 设置时间戳                   |\n| -ts             | 整数     | 设置模拟器分析帧使用的时间戳 |\n| -use_libv4l2    | 布尔     | 使用第三方库libv412选项      |\n\n```shell\n$ ffmpeg -hide_banner -f Video4Linux2 -list_formats all -i /dev/video0\n# /dev/video0根据自己的摄像头来设置\n```\n\n\n\n##### x11grab：linux桌面录制设备\n\n[桌面录制方法](<https://trac.ffmpeg.org/wiki/Capture/Desktop>)\n\nlinux环境下如果此方法报错\n\n```shell\nCannot open display :0.0, error 1.\n:0.0: Input/output error\n```\n\n则需要查看$DISPLAY， 在Linux/Unix类操作系统上, DISPLAY用来设置将图形显示到何处. 直接登陆图形界面或者登陆命令行界面后使用startx启动图形, DISPLAY环境变量将自动设置为:0:0\n\n```shell\n$ echo $DISPLAY\n:1\n```\n```shell\n$ ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :1+100,200 output.mp4\n```\n> video_size 字符串 输入采集视频的分辨率\n>\n> framerate 字符串 输入采集的视频帧率\n>\n> -f 指定输入设备\n>\n> -i 指定输入内容（此处为显示器）+100, 200 代表从100, 200处位移\n使用pulse录制音频\n\n```shell\n$ pactl list sources  # 查看全部输入设备\n```\n\n```shell\n$ ffmpeg -f pulse -i default pulse.wav\n```\n\n同时录制视频和音频\n\n```shell\n$ ffmpeg -video_size 1366x768 -framerate 25 -f x11grab -i :1 -f pulse -ac 2 -i 1 output.mkv\n```\n\n```shell\n$ ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :1+100,200 -f alsa -ac 2 -i hw:0 output.mkv\n```\n\n","source":"_posts/ffmpeg录制基础.md","raw":"---\ntitle: ffmpeg录制基础\ndate: 2019-07-24 09:21:02\ntags:\n  - ffmpeg\n---\n#### ffmpeg录制功能\n\n> ffmpeg第一步：录制音视频\n\n#### 录制设备查询\n\n```shell\n➜  $ ffmpeg -hide_banner -devices\nDevices:\n D. = Demuxing supported\n .E = Muxing supported\n --\n DE alsa            ALSA audio output\n DE fbdev           Linux framebuffer\n D  iec61883        libiec61883 (new DV1394) A/V input device\n D  jack            JACK Audio Connection Kit\n D  kmsgrab         KMS screen capture\n D  lavfi           Libavfilter virtual input device\n DE oss             OSS (Open Sound System) playback\n DE pulse           Pulse audio output\n  E sdl,sdl2        SDL2 output device\n DE video4linux2,v4l2 Video4Linux2 output device\n D  x11grab         X11 screen capture, using XCB\n  E xv              XV (XVideo) output device\n```\n\nD：输入设备\n\nE：输出设备 \n\n[ffmpeg输入设备列表](<https://ffmpeg.org/ffmpeg-devices.html#Input-Devices>)\n\n> alsa\n>\n> > 音频\n> >\n> > ALSA是Advanced Linux Sound Architecture的缩写，高级Linux声音架构的简称,它在Linux操作系统上提供了音频和MIDI（Musical Instrument Digital Interface，音乐设备数字化接口）的支持，需要安装libasound库\n>\n> android_camera\n>\n> > 音视频\n> >\n> > Android相机输入设备。 此输入设备使用Android Camera2 NDK API，该API可在API级别为24+的设备上使用。在配置期间自动检测android_camera的可用性。 该设备允许从Android设备上的所有摄像头进行捕获，这些摄像头集成在Camera2 NDK API中。 可用的摄像机在内部枚举，可以使用camera_index参数进行选择。输入文件字符串被丢弃。 通常，后置摄像头的索引为0，而前置摄像头的索引为1。\n>\n> avfoundation\n>\n> > 音视频\n> >\n> > 苹果设备\n>\n> bktr\n>\n> > BSD 视频输入设备\n>\n> decklink\n>\n> > BlackMagic Decklink是一款影像采集编辑产品，接口类型PCI-33/66、PCI-X 133&100MHz 。\n>\n> dshow\n>\n> > Windows DirectShow input device.\n>\n> fbdev\n>\n> > Linux framebuffer（Linux帧缓冲）输入设备，只能录制终端的视频\n> >\n> > Linux framebuffer是一种独立于硬件的图像抽象层，它用于在计算机屏幕上显示图像,通常是在控制台（环境）。它可以通过一个文件设备节点访问，通常为：`/dev/fb0`\n>\n> gdigrab\n>\n> > Win32 GDI 屏幕截取设备\n> >\n> > 这个设备允许你截取显示在Windows（系统）上的屏幕区域。\n>\n> iec61883\n>\n> > 使用`iec61883`的FireWire（火线） DV/HDV输入设备。\n> >\n> > 要允许这个输入设备，需要`libiec61883`, `libraw1394` 和 `libavc1394`被安装到系统中。此外还要在编译时配置`--enable-libiec61883`以支持。\n>\n> jack\n>\n> > JACK输入设备。\n> >\n> > 为了能使用JACK设备，需要系统上存在`libjack`\n>\n> kmsgrab\n>\n> lavfi\n>\n> > `Libavfilter`输入虚拟设备\n> >\n> > 这个输入设备可以从`libavfilter`滤镜链图的一个开放输出端口读取数据。\n> >\n> > 对于每个滤镜链图开放输出端口，这个输入设备将创建一个对应的流映射到这个端口进行输出。当前只支持视频数据。滤镜链图是通过选项`graph`描述的。\n>\n> libcdio\n>\n> > 基于`libcdio`的音乐CD输入设备。\n> >\n> > 需要系统中有`libcdio`才能启用，且编译时需要用`--enable-libcdio`配置选项允许。\n>\n> libdc1394\n>\n> > IIDC1394输入设备，其基于`libdc1394`和`libraw1394`\n> >\n> > 编译允许需要配置`--enable-libdc1394`\n>\n> openal\n>\n> > 这个OpenAL输入设备支持在所有实现了`OpenAL 1.1`的系统上进行音频捕获。\n> >\n> > 要编译使用它需要系统包含`OpenAL`头和`libraries`库，并且设置编译选项`--enable-openal`\n>\n> oss\n>\n> pulse\n>\n> > PulseAudio（脉冲音频）输入设备\n> >\n> > 要使用须编译配置设置`--enable-libpulse`\n>\n> sndio\n>\n> > sndio输入设备。\n> >\n> > 要使用它需要系统安装并配置有`libsndio`库\n>\n> video4linux2, v4l2\n>\n> > Video4Linux2 输入视频设备\n> >\n> > \"v4l2\"是\"video4linux2\"的别名\n> >\n> > 编译需要`v4l-utiles`支持（`--enable-libv4l2`编译选项被配置），也可用于`-use_libv4l2`输入设备选项。\n> >\n> > 捕获的设备名是一个文件设备节点，通常Linux系统在设备（例如USB摄像头）插入到系统时自动创建这样的节点，会被命名为`/dev/videoN`，`N`是设备索引序号\n> >\n> > Video4Linux设备通常只支持有限的分辨率（`width x height`）和帧率,通过`-list_formats all`选项来获取支持情况。一些设备，例如电视卡可以支持1个或者多个标准，它支持的标准可以通过`-list_standards all`来了解。\n> >\n> > 时间戳时基单位为1microsecond。根据内核版本和配置，时间戳可以基于实时间（real time clock——绝对时间，一种起源于Unix的表示方式）或者单调时钟（monotonic clock——通常源自启动时间，不受NTP或者手动改变）。`-timestamps abs`或者`-ts abs`选择启用实时间。\n>\n> vfwcap\n>\n> > vfw（Video for Windows）捕获输入端\n> >\n> > 文件名必须是捕获设备索引，范围0-9可以用`list`作为文件名，将输出一个设备列表。任何数字外其它文件名被视作设备索引0。\n>\n> x11grab\n>\n> > X11 视频输入设备\n> >\n> > 使用需要`libxcb`库，它会在编译时自动检测。\n\n\n\n##### fbdev： linux终端录制设备\n\n查看使用指定采集设备参数\n\n```shell\n$ ffmpeg -hide_banner -h demuxer=fbdev\nDemuxer fbdev [Linux framebuffer]:\nfbdev indev AVOptions:\n  -framerate         <video_rate> .D.......  (default \"25\")\n# framerate 帧数 默认25帧\n```\n```shell\n$ sudo ffmpeg -framerate 30  -f fbdev -i /dev/fb0 output.mp4\n```\n\n\n##### v412：linux摄像头录制设备\n\n```shell\n$ ffmpeg -hide_banner -h demuxer=Video4Linux2\n```\n\n| 参数            | 类型     | 说明                         |\n| --------------- | -------- | ---------------------------- |\n| -standard       | 字符串   | 设置tv标准                   |\n| -channel        | 整数     | 设置tv通道                   |\n| -video_size     | 图像大小 | 设置采集视频频帧大小         |\n| -pixel_format   | 字符串   | 设置采集视频的分辨率         |\n| -input_format   | 字符串   | 设置采集视频的分辨率         |\n| -framerate      | 字符串   | 设置采集视频帧率             |\n| -list_formats   | 整数     | 列举输入视频信号的信息       |\n| -list_standards | 整数     | 列举标准信息                 |\n| -timestamps     | 整数     | 设置时间戳                   |\n| -ts             | 整数     | 设置模拟器分析帧使用的时间戳 |\n| -use_libv4l2    | 布尔     | 使用第三方库libv412选项      |\n\n```shell\n$ ffmpeg -hide_banner -f Video4Linux2 -list_formats all -i /dev/video0\n# /dev/video0根据自己的摄像头来设置\n```\n\n\n\n##### x11grab：linux桌面录制设备\n\n[桌面录制方法](<https://trac.ffmpeg.org/wiki/Capture/Desktop>)\n\nlinux环境下如果此方法报错\n\n```shell\nCannot open display :0.0, error 1.\n:0.0: Input/output error\n```\n\n则需要查看$DISPLAY， 在Linux/Unix类操作系统上, DISPLAY用来设置将图形显示到何处. 直接登陆图形界面或者登陆命令行界面后使用startx启动图形, DISPLAY环境变量将自动设置为:0:0\n\n```shell\n$ echo $DISPLAY\n:1\n```\n```shell\n$ ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :1+100,200 output.mp4\n```\n> video_size 字符串 输入采集视频的分辨率\n>\n> framerate 字符串 输入采集的视频帧率\n>\n> -f 指定输入设备\n>\n> -i 指定输入内容（此处为显示器）+100, 200 代表从100, 200处位移\n使用pulse录制音频\n\n```shell\n$ pactl list sources  # 查看全部输入设备\n```\n\n```shell\n$ ffmpeg -f pulse -i default pulse.wav\n```\n\n同时录制视频和音频\n\n```shell\n$ ffmpeg -video_size 1366x768 -framerate 25 -f x11grab -i :1 -f pulse -ac 2 -i 1 output.mkv\n```\n\n```shell\n$ ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :1+100,200 -f alsa -ac 2 -i hw:0 output.mkv\n```\n\n","slug":"ffmpeg录制基础","published":1,"updated":"2019-07-24T01:55:00.296Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjyu0a5nx00149ka4g5i8hyvx","content":"<h4 id=\"ffmpeg录制功能\"><a href=\"#ffmpeg录制功能\" class=\"headerlink\" title=\"ffmpeg录制功能\"></a>ffmpeg录制功能</h4><blockquote>\n<p>ffmpeg第一步：录制音视频</p>\n</blockquote>\n<h4 id=\"录制设备查询\"><a href=\"#录制设备查询\" class=\"headerlink\" title=\"录制设备查询\"></a>录制设备查询</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  $ ffmpeg -hide_banner -devices</span><br><span class=\"line\">Devices:</span><br><span class=\"line\"> D. = Demuxing supported</span><br><span class=\"line\"> .E = Muxing supported</span><br><span class=\"line\"> --</span><br><span class=\"line\"> DE alsa            ALSA audio output</span><br><span class=\"line\"> DE fbdev           Linux framebuffer</span><br><span class=\"line\"> D  iec61883        libiec61883 (new DV1394) A/V input device</span><br><span class=\"line\"> D  jack            JACK Audio Connection Kit</span><br><span class=\"line\"> D  kmsgrab         KMS screen capture</span><br><span class=\"line\"> D  lavfi           Libavfilter virtual input device</span><br><span class=\"line\"> DE oss             OSS (Open Sound System) playback</span><br><span class=\"line\"> DE pulse           Pulse audio output</span><br><span class=\"line\">  E sdl,sdl2        SDL2 output device</span><br><span class=\"line\"> DE video4linux2,v4l2 Video4Linux2 output device</span><br><span class=\"line\"> D  x11grab         X11 screen capture, using XCB</span><br><span class=\"line\">  E xv              XV (XVideo) output device</span><br></pre></td></tr></table></figure>\n\n<p>D：输入设备</p>\n<p>E：输出设备 </p>\n<p><a href=\"https://ffmpeg.org/ffmpeg-devices.html#Input-Devices\" target=\"_blank\" rel=\"noopener\">ffmpeg输入设备列表</a></p>\n<blockquote>\n<p>alsa</p>\n<blockquote>\n<p>音频</p>\n<p>ALSA是Advanced Linux Sound Architecture的缩写，高级Linux声音架构的简称,它在Linux操作系统上提供了音频和MIDI（Musical Instrument Digital Interface，音乐设备数字化接口）的支持，需要安装libasound库</p>\n</blockquote>\n<p>android_camera</p>\n<blockquote>\n<p>音视频</p>\n<p>Android相机输入设备。 此输入设备使用Android Camera2 NDK API，该API可在API级别为24+的设备上使用。在配置期间自动检测android_camera的可用性。 该设备允许从Android设备上的所有摄像头进行捕获，这些摄像头集成在Camera2 NDK API中。 可用的摄像机在内部枚举，可以使用camera_index参数进行选择。输入文件字符串被丢弃。 通常，后置摄像头的索引为0，而前置摄像头的索引为1。</p>\n</blockquote>\n<p>avfoundation</p>\n<blockquote>\n<p>音视频</p>\n<p>苹果设备</p>\n</blockquote>\n<p>bktr</p>\n<blockquote>\n<p>BSD 视频输入设备</p>\n</blockquote>\n<p>decklink</p>\n<blockquote>\n<p>BlackMagic Decklink是一款影像采集编辑产品，接口类型PCI-33/66、PCI-X 133&amp;100MHz 。</p>\n</blockquote>\n<p>dshow</p>\n<blockquote>\n<p>Windows DirectShow input device.</p>\n</blockquote>\n<p>fbdev</p>\n<blockquote>\n<p>Linux framebuffer（Linux帧缓冲）输入设备，只能录制终端的视频</p>\n<p>Linux framebuffer是一种独立于硬件的图像抽象层，它用于在计算机屏幕上显示图像,通常是在控制台（环境）。它可以通过一个文件设备节点访问，通常为：<code>/dev/fb0</code></p>\n</blockquote>\n<p>gdigrab</p>\n<blockquote>\n<p>Win32 GDI 屏幕截取设备</p>\n<p>这个设备允许你截取显示在Windows（系统）上的屏幕区域。</p>\n</blockquote>\n<p>iec61883</p>\n<blockquote>\n<p>使用<code>iec61883</code>的FireWire（火线） DV/HDV输入设备。</p>\n<p>要允许这个输入设备，需要<code>libiec61883</code>, <code>libraw1394</code> 和 <code>libavc1394</code>被安装到系统中。此外还要在编译时配置<code>--enable-libiec61883</code>以支持。</p>\n</blockquote>\n<p>jack</p>\n<blockquote>\n<p>JACK输入设备。</p>\n<p>为了能使用JACK设备，需要系统上存在<code>libjack</code></p>\n</blockquote>\n<p>kmsgrab</p>\n<p>lavfi</p>\n<blockquote>\n<p><code>Libavfilter</code>输入虚拟设备</p>\n<p>这个输入设备可以从<code>libavfilter</code>滤镜链图的一个开放输出端口读取数据。</p>\n<p>对于每个滤镜链图开放输出端口，这个输入设备将创建一个对应的流映射到这个端口进行输出。当前只支持视频数据。滤镜链图是通过选项<code>graph</code>描述的。</p>\n</blockquote>\n<p>libcdio</p>\n<blockquote>\n<p>基于<code>libcdio</code>的音乐CD输入设备。</p>\n<p>需要系统中有<code>libcdio</code>才能启用，且编译时需要用<code>--enable-libcdio</code>配置选项允许。</p>\n</blockquote>\n<p>libdc1394</p>\n<blockquote>\n<p>IIDC1394输入设备，其基于<code>libdc1394</code>和<code>libraw1394</code></p>\n<p>编译允许需要配置<code>--enable-libdc1394</code></p>\n</blockquote>\n<p>openal</p>\n<blockquote>\n<p>这个OpenAL输入设备支持在所有实现了<code>OpenAL 1.1</code>的系统上进行音频捕获。</p>\n<p>要编译使用它需要系统包含<code>OpenAL</code>头和<code>libraries</code>库，并且设置编译选项<code>--enable-openal</code></p>\n</blockquote>\n<p>oss</p>\n<p>pulse</p>\n<blockquote>\n<p>PulseAudio（脉冲音频）输入设备</p>\n<p>要使用须编译配置设置<code>--enable-libpulse</code></p>\n</blockquote>\n<p>sndio</p>\n<blockquote>\n<p>sndio输入设备。</p>\n<p>要使用它需要系统安装并配置有<code>libsndio</code>库</p>\n</blockquote>\n<p>video4linux2, v4l2</p>\n<blockquote>\n<p>Video4Linux2 输入视频设备</p>\n<p>“v4l2”是”video4linux2”的别名</p>\n<p>编译需要<code>v4l-utiles</code>支持（<code>--enable-libv4l2</code>编译选项被配置），也可用于<code>-use_libv4l2</code>输入设备选项。</p>\n<p>捕获的设备名是一个文件设备节点，通常Linux系统在设备（例如USB摄像头）插入到系统时自动创建这样的节点，会被命名为<code>/dev/videoN</code>，<code>N</code>是设备索引序号</p>\n<p>Video4Linux设备通常只支持有限的分辨率（<code>width x height</code>）和帧率,通过<code>-list_formats all</code>选项来获取支持情况。一些设备，例如电视卡可以支持1个或者多个标准，它支持的标准可以通过<code>-list_standards all</code>来了解。</p>\n<p>时间戳时基单位为1microsecond。根据内核版本和配置，时间戳可以基于实时间（real time clock——绝对时间，一种起源于Unix的表示方式）或者单调时钟（monotonic clock——通常源自启动时间，不受NTP或者手动改变）。<code>-timestamps abs</code>或者<code>-ts abs</code>选择启用实时间。</p>\n</blockquote>\n<p>vfwcap</p>\n<blockquote>\n<p>vfw（Video for Windows）捕获输入端</p>\n<p>文件名必须是捕获设备索引，范围0-9可以用<code>list</code>作为文件名，将输出一个设备列表。任何数字外其它文件名被视作设备索引0。</p>\n</blockquote>\n<p>x11grab</p>\n<blockquote>\n<p>X11 视频输入设备</p>\n<p>使用需要<code>libxcb</code>库，它会在编译时自动检测。</p>\n</blockquote>\n</blockquote>\n<h5 id=\"fbdev：-linux终端录制设备\"><a href=\"#fbdev：-linux终端录制设备\" class=\"headerlink\" title=\"fbdev： linux终端录制设备\"></a>fbdev： linux终端录制设备</h5><p>查看使用指定采集设备参数</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -hide_banner -h demuxer=fbdev</span><br><span class=\"line\">Demuxer fbdev [Linux framebuffer]:</span><br><span class=\"line\">fbdev indev AVOptions:</span><br><span class=\"line\">  -framerate         &lt;video_rate&gt; .D.......  (default \"25\")</span><br><span class=\"line\"><span class=\"meta\">#</span> framerate 帧数 默认25帧</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo ffmpeg -framerate 30  -f fbdev -i /dev/fb0 output.mp4</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"v412：linux摄像头录制设备\"><a href=\"#v412：linux摄像头录制设备\" class=\"headerlink\" title=\"v412：linux摄像头录制设备\"></a>v412：linux摄像头录制设备</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -hide_banner -h demuxer=Video4Linux2</span><br></pre></td></tr></table></figure>\n\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>类型</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-standard</td>\n<td>字符串</td>\n<td>设置tv标准</td>\n</tr>\n<tr>\n<td>-channel</td>\n<td>整数</td>\n<td>设置tv通道</td>\n</tr>\n<tr>\n<td>-video_size</td>\n<td>图像大小</td>\n<td>设置采集视频频帧大小</td>\n</tr>\n<tr>\n<td>-pixel_format</td>\n<td>字符串</td>\n<td>设置采集视频的分辨率</td>\n</tr>\n<tr>\n<td>-input_format</td>\n<td>字符串</td>\n<td>设置采集视频的分辨率</td>\n</tr>\n<tr>\n<td>-framerate</td>\n<td>字符串</td>\n<td>设置采集视频帧率</td>\n</tr>\n<tr>\n<td>-list_formats</td>\n<td>整数</td>\n<td>列举输入视频信号的信息</td>\n</tr>\n<tr>\n<td>-list_standards</td>\n<td>整数</td>\n<td>列举标准信息</td>\n</tr>\n<tr>\n<td>-timestamps</td>\n<td>整数</td>\n<td>设置时间戳</td>\n</tr>\n<tr>\n<td>-ts</td>\n<td>整数</td>\n<td>设置模拟器分析帧使用的时间戳</td>\n</tr>\n<tr>\n<td>-use_libv4l2</td>\n<td>布尔</td>\n<td>使用第三方库libv412选项</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -hide_banner -f Video4Linux2 -list_formats all -i /dev/video0</span><br><span class=\"line\"><span class=\"meta\">#</span> /dev/video0根据自己的摄像头来设置</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"x11grab：linux桌面录制设备\"><a href=\"#x11grab：linux桌面录制设备\" class=\"headerlink\" title=\"x11grab：linux桌面录制设备\"></a>x11grab：linux桌面录制设备</h5><p><a href=\"https://trac.ffmpeg.org/wiki/Capture/Desktop\" target=\"_blank\" rel=\"noopener\">桌面录制方法</a></p>\n<p>linux环境下如果此方法报错</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cannot open display :0.0, error 1.</span><br><span class=\"line\">:0.0: Input/output error</span><br></pre></td></tr></table></figure>\n\n<p>则需要查看$DISPLAY， 在Linux/Unix类操作系统上, DISPLAY用来设置将图形显示到何处. 直接登陆图形界面或者登陆命令行界面后使用startx启动图形, DISPLAY环境变量将自动设置为:0:0</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> echo $DISPLAY</span><br><span class=\"line\">:1</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :1+100,200 output.mp4</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>video_size 字符串 输入采集视频的分辨率</p>\n<p>framerate 字符串 输入采集的视频帧率</p>\n<p>-f 指定输入设备</p>\n<p>-i 指定输入内容（此处为显示器）+100, 200 代表从100, 200处位移<br>使用pulse录制音频</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> pactl list sources  # 查看全部输入设备</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -f pulse -i default pulse.wav</span><br></pre></td></tr></table></figure>\n\n<p>同时录制视频和音频</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -video_size 1366x768 -framerate 25 -f x11grab -i :1 -f pulse -ac 2 -i 1 output.mkv</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :1+100,200 -f alsa -ac 2 -i hw:0 output.mkv</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"ffmpeg录制功能\"><a href=\"#ffmpeg录制功能\" class=\"headerlink\" title=\"ffmpeg录制功能\"></a>ffmpeg录制功能</h4><blockquote>\n<p>ffmpeg第一步：录制音视频</p>\n</blockquote>\n<h4 id=\"录制设备查询\"><a href=\"#录制设备查询\" class=\"headerlink\" title=\"录制设备查询\"></a>录制设备查询</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  $ ffmpeg -hide_banner -devices</span><br><span class=\"line\">Devices:</span><br><span class=\"line\"> D. = Demuxing supported</span><br><span class=\"line\"> .E = Muxing supported</span><br><span class=\"line\"> --</span><br><span class=\"line\"> DE alsa            ALSA audio output</span><br><span class=\"line\"> DE fbdev           Linux framebuffer</span><br><span class=\"line\"> D  iec61883        libiec61883 (new DV1394) A/V input device</span><br><span class=\"line\"> D  jack            JACK Audio Connection Kit</span><br><span class=\"line\"> D  kmsgrab         KMS screen capture</span><br><span class=\"line\"> D  lavfi           Libavfilter virtual input device</span><br><span class=\"line\"> DE oss             OSS (Open Sound System) playback</span><br><span class=\"line\"> DE pulse           Pulse audio output</span><br><span class=\"line\">  E sdl,sdl2        SDL2 output device</span><br><span class=\"line\"> DE video4linux2,v4l2 Video4Linux2 output device</span><br><span class=\"line\"> D  x11grab         X11 screen capture, using XCB</span><br><span class=\"line\">  E xv              XV (XVideo) output device</span><br></pre></td></tr></table></figure>\n\n<p>D：输入设备</p>\n<p>E：输出设备 </p>\n<p><a href=\"https://ffmpeg.org/ffmpeg-devices.html#Input-Devices\" target=\"_blank\" rel=\"noopener\">ffmpeg输入设备列表</a></p>\n<blockquote>\n<p>alsa</p>\n<blockquote>\n<p>音频</p>\n<p>ALSA是Advanced Linux Sound Architecture的缩写，高级Linux声音架构的简称,它在Linux操作系统上提供了音频和MIDI（Musical Instrument Digital Interface，音乐设备数字化接口）的支持，需要安装libasound库</p>\n</blockquote>\n<p>android_camera</p>\n<blockquote>\n<p>音视频</p>\n<p>Android相机输入设备。 此输入设备使用Android Camera2 NDK API，该API可在API级别为24+的设备上使用。在配置期间自动检测android_camera的可用性。 该设备允许从Android设备上的所有摄像头进行捕获，这些摄像头集成在Camera2 NDK API中。 可用的摄像机在内部枚举，可以使用camera_index参数进行选择。输入文件字符串被丢弃。 通常，后置摄像头的索引为0，而前置摄像头的索引为1。</p>\n</blockquote>\n<p>avfoundation</p>\n<blockquote>\n<p>音视频</p>\n<p>苹果设备</p>\n</blockquote>\n<p>bktr</p>\n<blockquote>\n<p>BSD 视频输入设备</p>\n</blockquote>\n<p>decklink</p>\n<blockquote>\n<p>BlackMagic Decklink是一款影像采集编辑产品，接口类型PCI-33/66、PCI-X 133&amp;100MHz 。</p>\n</blockquote>\n<p>dshow</p>\n<blockquote>\n<p>Windows DirectShow input device.</p>\n</blockquote>\n<p>fbdev</p>\n<blockquote>\n<p>Linux framebuffer（Linux帧缓冲）输入设备，只能录制终端的视频</p>\n<p>Linux framebuffer是一种独立于硬件的图像抽象层，它用于在计算机屏幕上显示图像,通常是在控制台（环境）。它可以通过一个文件设备节点访问，通常为：<code>/dev/fb0</code></p>\n</blockquote>\n<p>gdigrab</p>\n<blockquote>\n<p>Win32 GDI 屏幕截取设备</p>\n<p>这个设备允许你截取显示在Windows（系统）上的屏幕区域。</p>\n</blockquote>\n<p>iec61883</p>\n<blockquote>\n<p>使用<code>iec61883</code>的FireWire（火线） DV/HDV输入设备。</p>\n<p>要允许这个输入设备，需要<code>libiec61883</code>, <code>libraw1394</code> 和 <code>libavc1394</code>被安装到系统中。此外还要在编译时配置<code>--enable-libiec61883</code>以支持。</p>\n</blockquote>\n<p>jack</p>\n<blockquote>\n<p>JACK输入设备。</p>\n<p>为了能使用JACK设备，需要系统上存在<code>libjack</code></p>\n</blockquote>\n<p>kmsgrab</p>\n<p>lavfi</p>\n<blockquote>\n<p><code>Libavfilter</code>输入虚拟设备</p>\n<p>这个输入设备可以从<code>libavfilter</code>滤镜链图的一个开放输出端口读取数据。</p>\n<p>对于每个滤镜链图开放输出端口，这个输入设备将创建一个对应的流映射到这个端口进行输出。当前只支持视频数据。滤镜链图是通过选项<code>graph</code>描述的。</p>\n</blockquote>\n<p>libcdio</p>\n<blockquote>\n<p>基于<code>libcdio</code>的音乐CD输入设备。</p>\n<p>需要系统中有<code>libcdio</code>才能启用，且编译时需要用<code>--enable-libcdio</code>配置选项允许。</p>\n</blockquote>\n<p>libdc1394</p>\n<blockquote>\n<p>IIDC1394输入设备，其基于<code>libdc1394</code>和<code>libraw1394</code></p>\n<p>编译允许需要配置<code>--enable-libdc1394</code></p>\n</blockquote>\n<p>openal</p>\n<blockquote>\n<p>这个OpenAL输入设备支持在所有实现了<code>OpenAL 1.1</code>的系统上进行音频捕获。</p>\n<p>要编译使用它需要系统包含<code>OpenAL</code>头和<code>libraries</code>库，并且设置编译选项<code>--enable-openal</code></p>\n</blockquote>\n<p>oss</p>\n<p>pulse</p>\n<blockquote>\n<p>PulseAudio（脉冲音频）输入设备</p>\n<p>要使用须编译配置设置<code>--enable-libpulse</code></p>\n</blockquote>\n<p>sndio</p>\n<blockquote>\n<p>sndio输入设备。</p>\n<p>要使用它需要系统安装并配置有<code>libsndio</code>库</p>\n</blockquote>\n<p>video4linux2, v4l2</p>\n<blockquote>\n<p>Video4Linux2 输入视频设备</p>\n<p>“v4l2”是”video4linux2”的别名</p>\n<p>编译需要<code>v4l-utiles</code>支持（<code>--enable-libv4l2</code>编译选项被配置），也可用于<code>-use_libv4l2</code>输入设备选项。</p>\n<p>捕获的设备名是一个文件设备节点，通常Linux系统在设备（例如USB摄像头）插入到系统时自动创建这样的节点，会被命名为<code>/dev/videoN</code>，<code>N</code>是设备索引序号</p>\n<p>Video4Linux设备通常只支持有限的分辨率（<code>width x height</code>）和帧率,通过<code>-list_formats all</code>选项来获取支持情况。一些设备，例如电视卡可以支持1个或者多个标准，它支持的标准可以通过<code>-list_standards all</code>来了解。</p>\n<p>时间戳时基单位为1microsecond。根据内核版本和配置，时间戳可以基于实时间（real time clock——绝对时间，一种起源于Unix的表示方式）或者单调时钟（monotonic clock——通常源自启动时间，不受NTP或者手动改变）。<code>-timestamps abs</code>或者<code>-ts abs</code>选择启用实时间。</p>\n</blockquote>\n<p>vfwcap</p>\n<blockquote>\n<p>vfw（Video for Windows）捕获输入端</p>\n<p>文件名必须是捕获设备索引，范围0-9可以用<code>list</code>作为文件名，将输出一个设备列表。任何数字外其它文件名被视作设备索引0。</p>\n</blockquote>\n<p>x11grab</p>\n<blockquote>\n<p>X11 视频输入设备</p>\n<p>使用需要<code>libxcb</code>库，它会在编译时自动检测。</p>\n</blockquote>\n</blockquote>\n<h5 id=\"fbdev：-linux终端录制设备\"><a href=\"#fbdev：-linux终端录制设备\" class=\"headerlink\" title=\"fbdev： linux终端录制设备\"></a>fbdev： linux终端录制设备</h5><p>查看使用指定采集设备参数</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -hide_banner -h demuxer=fbdev</span><br><span class=\"line\">Demuxer fbdev [Linux framebuffer]:</span><br><span class=\"line\">fbdev indev AVOptions:</span><br><span class=\"line\">  -framerate         &lt;video_rate&gt; .D.......  (default \"25\")</span><br><span class=\"line\"><span class=\"meta\">#</span> framerate 帧数 默认25帧</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo ffmpeg -framerate 30  -f fbdev -i /dev/fb0 output.mp4</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"v412：linux摄像头录制设备\"><a href=\"#v412：linux摄像头录制设备\" class=\"headerlink\" title=\"v412：linux摄像头录制设备\"></a>v412：linux摄像头录制设备</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -hide_banner -h demuxer=Video4Linux2</span><br></pre></td></tr></table></figure>\n\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>类型</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-standard</td>\n<td>字符串</td>\n<td>设置tv标准</td>\n</tr>\n<tr>\n<td>-channel</td>\n<td>整数</td>\n<td>设置tv通道</td>\n</tr>\n<tr>\n<td>-video_size</td>\n<td>图像大小</td>\n<td>设置采集视频频帧大小</td>\n</tr>\n<tr>\n<td>-pixel_format</td>\n<td>字符串</td>\n<td>设置采集视频的分辨率</td>\n</tr>\n<tr>\n<td>-input_format</td>\n<td>字符串</td>\n<td>设置采集视频的分辨率</td>\n</tr>\n<tr>\n<td>-framerate</td>\n<td>字符串</td>\n<td>设置采集视频帧率</td>\n</tr>\n<tr>\n<td>-list_formats</td>\n<td>整数</td>\n<td>列举输入视频信号的信息</td>\n</tr>\n<tr>\n<td>-list_standards</td>\n<td>整数</td>\n<td>列举标准信息</td>\n</tr>\n<tr>\n<td>-timestamps</td>\n<td>整数</td>\n<td>设置时间戳</td>\n</tr>\n<tr>\n<td>-ts</td>\n<td>整数</td>\n<td>设置模拟器分析帧使用的时间戳</td>\n</tr>\n<tr>\n<td>-use_libv4l2</td>\n<td>布尔</td>\n<td>使用第三方库libv412选项</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -hide_banner -f Video4Linux2 -list_formats all -i /dev/video0</span><br><span class=\"line\"><span class=\"meta\">#</span> /dev/video0根据自己的摄像头来设置</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"x11grab：linux桌面录制设备\"><a href=\"#x11grab：linux桌面录制设备\" class=\"headerlink\" title=\"x11grab：linux桌面录制设备\"></a>x11grab：linux桌面录制设备</h5><p><a href=\"https://trac.ffmpeg.org/wiki/Capture/Desktop\" target=\"_blank\" rel=\"noopener\">桌面录制方法</a></p>\n<p>linux环境下如果此方法报错</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cannot open display :0.0, error 1.</span><br><span class=\"line\">:0.0: Input/output error</span><br></pre></td></tr></table></figure>\n\n<p>则需要查看$DISPLAY， 在Linux/Unix类操作系统上, DISPLAY用来设置将图形显示到何处. 直接登陆图形界面或者登陆命令行界面后使用startx启动图形, DISPLAY环境变量将自动设置为:0:0</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> echo $DISPLAY</span><br><span class=\"line\">:1</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :1+100,200 output.mp4</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>video_size 字符串 输入采集视频的分辨率</p>\n<p>framerate 字符串 输入采集的视频帧率</p>\n<p>-f 指定输入设备</p>\n<p>-i 指定输入内容（此处为显示器）+100, 200 代表从100, 200处位移<br>使用pulse录制音频</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> pactl list sources  # 查看全部输入设备</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -f pulse -i default pulse.wav</span><br></pre></td></tr></table></figure>\n\n<p>同时录制视频和音频</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -video_size 1366x768 -framerate 25 -f x11grab -i :1 -f pulse -ac 2 -i 1 output.mkv</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ffmpeg -video_size 1024x768 -framerate 25 -f x11grab -i :1+100,200 -f alsa -ac 2 -i hw:0 output.mkv</span><br></pre></td></tr></table></figure>\n\n"},{"title":"ffmpeg音频基础","date":"2019-07-24T01:11:21.000Z","_content":"\n2# 音频知识（未完工）\n\n#### 声音的本质\n\n> 声音其实是一种能量波，因此也有频率和振幅的特征，频率对应于时间轴线，振幅对应于电平轴线。波是无限光滑的，弦线可以看成由无数点组成，由于存储空间是相对有限的，数字编码过程中，必须对弦线的点进行采样。\n\n#### [声音三要素](https://baike.baidu.com/item/%E5%A3%B0%E9%9F%B3%E5%90%AC%E8%A7%89)\n\n1. 音高/音调/音频： 客观上音高大小主要取决于声波基频的高低，频率高则音调高，反之则低，单位用赫兹(Hz）表示。儿童(高音区)->女生(高音区)->男生（低音区）\n\n2. 音量/响度/声强：常说的声音大小，主要取决于声波振幅的大小。\n3. 音色/音品：和材质相关（比如钢琴等），本质是谐波。\n\n![音量和声调](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/%E9%9F%B3%E9%87%8F%E5%92%8C%E5%A3%B0%E8%B0%83.png)\n\n心理声学\n\n> 人类的听觉范围：20Hz-20kHz\n\n#### 音频量化过程\n\n![音频量化过程](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/%E9%9F%B3%E9%A2%91%E9%87%8F%E5%8C%96%E8%BF%87%E7%A8%8B.png)\n\n1. 按横轴时间进行切割\n2. 按纵轴振幅(决定音量)进行切割\n3. 编码转成数字信号\n\n> 采样大小：一个采样用多个bit存放，常用16位(2<sup>16</sup>=65535)，振幅\n> 采样率：采样频率8k、16k、32k、44.1k、48k等 [采样率概念](https://baike.baidu.com/item/音频采样率)\n> 声道数：单声道、双声道、多声道\n\n\n\n码率计算\n> 音频流的码率=采样率×采样大小×声道数\n> 例如：采样率44.1kHz、采样大小为16bit、双声道的pcm编码wav文件，码率=44.1k×16×2=1411.2kb/s\n\n\n\n#### 音频压缩技术\n\n1. 消除音频冗余数据\n\n> 删除人耳听觉范围外的音频信号：\n>\n> > 20Hz-20kHz\n>\n> 被掩避掉的音频信号： \n>\n> > 频域遮蔽：\n> >\n> > 时域遮蔽：\n>\n> \n\n2. 哈夫曼无损编码\n\n#### 音频编解码器\n\n常见的编解码器\n\n> OPUS： 开源、rmtp协议不支持\n> AAC：收费、适合实时互动项目。\n> Vorbis：开源\n> Speex：开源、优势：还支持一些回音消除、降噪等处理办法\n> iLBC\n> AMR\n> G.711：与固定电话就行融合\n\n性能对比：\n\n> OPUS > AAC(常用) > Vorbis\n> AAC： advanced audio coding\n> 常见规格： AAC LC（低复杂度，码流128k）、AAC HE V1（）、 AAC HE V2\n> AAC LC + SBR = AAC HE V1\n> AAC HE V1 + PS = AAC HE V2\n\n![aac规格](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/aac%E8%A7%84%E6%A0%BC.png)\n\nAAC格式：\n> ADIF\n> ADTS\n\nAAC编码库：\n\n> libfdk_aac(常用) > ffmpeg aac > libfaac > libvo_aacenc","source":"_posts/ffmpeg音频基础.md","raw":"---\ntitle: ffmpeg音频基础\ndate: 2019-07-24 09:11:21\ntags:\n  - ffmpeg\ncategories:\n---\n\n2# 音频知识（未完工）\n\n#### 声音的本质\n\n> 声音其实是一种能量波，因此也有频率和振幅的特征，频率对应于时间轴线，振幅对应于电平轴线。波是无限光滑的，弦线可以看成由无数点组成，由于存储空间是相对有限的，数字编码过程中，必须对弦线的点进行采样。\n\n#### [声音三要素](https://baike.baidu.com/item/%E5%A3%B0%E9%9F%B3%E5%90%AC%E8%A7%89)\n\n1. 音高/音调/音频： 客观上音高大小主要取决于声波基频的高低，频率高则音调高，反之则低，单位用赫兹(Hz）表示。儿童(高音区)->女生(高音区)->男生（低音区）\n\n2. 音量/响度/声强：常说的声音大小，主要取决于声波振幅的大小。\n3. 音色/音品：和材质相关（比如钢琴等），本质是谐波。\n\n![音量和声调](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/%E9%9F%B3%E9%87%8F%E5%92%8C%E5%A3%B0%E8%B0%83.png)\n\n心理声学\n\n> 人类的听觉范围：20Hz-20kHz\n\n#### 音频量化过程\n\n![音频量化过程](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/%E9%9F%B3%E9%A2%91%E9%87%8F%E5%8C%96%E8%BF%87%E7%A8%8B.png)\n\n1. 按横轴时间进行切割\n2. 按纵轴振幅(决定音量)进行切割\n3. 编码转成数字信号\n\n> 采样大小：一个采样用多个bit存放，常用16位(2<sup>16</sup>=65535)，振幅\n> 采样率：采样频率8k、16k、32k、44.1k、48k等 [采样率概念](https://baike.baidu.com/item/音频采样率)\n> 声道数：单声道、双声道、多声道\n\n\n\n码率计算\n> 音频流的码率=采样率×采样大小×声道数\n> 例如：采样率44.1kHz、采样大小为16bit、双声道的pcm编码wav文件，码率=44.1k×16×2=1411.2kb/s\n\n\n\n#### 音频压缩技术\n\n1. 消除音频冗余数据\n\n> 删除人耳听觉范围外的音频信号：\n>\n> > 20Hz-20kHz\n>\n> 被掩避掉的音频信号： \n>\n> > 频域遮蔽：\n> >\n> > 时域遮蔽：\n>\n> \n\n2. 哈夫曼无损编码\n\n#### 音频编解码器\n\n常见的编解码器\n\n> OPUS： 开源、rmtp协议不支持\n> AAC：收费、适合实时互动项目。\n> Vorbis：开源\n> Speex：开源、优势：还支持一些回音消除、降噪等处理办法\n> iLBC\n> AMR\n> G.711：与固定电话就行融合\n\n性能对比：\n\n> OPUS > AAC(常用) > Vorbis\n> AAC： advanced audio coding\n> 常见规格： AAC LC（低复杂度，码流128k）、AAC HE V1（）、 AAC HE V2\n> AAC LC + SBR = AAC HE V1\n> AAC HE V1 + PS = AAC HE V2\n\n![aac规格](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/aac%E8%A7%84%E6%A0%BC.png)\n\nAAC格式：\n> ADIF\n> ADTS\n\nAAC编码库：\n\n> libfdk_aac(常用) > ffmpeg aac > libfaac > libvo_aacenc","slug":"ffmpeg音频基础","published":1,"updated":"2019-07-24T01:15:09.376Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjyu0a5ny00189ka495a63ohv","content":"<p>2# 音频知识（未完工）</p>\n<h4 id=\"声音的本质\"><a href=\"#声音的本质\" class=\"headerlink\" title=\"声音的本质\"></a>声音的本质</h4><blockquote>\n<p>声音其实是一种能量波，因此也有频率和振幅的特征，频率对应于时间轴线，振幅对应于电平轴线。波是无限光滑的，弦线可以看成由无数点组成，由于存储空间是相对有限的，数字编码过程中，必须对弦线的点进行采样。</p>\n</blockquote>\n<h4 id=\"声音三要素\"><a href=\"#声音三要素\" class=\"headerlink\" title=\"声音三要素\"></a><a href=\"https://baike.baidu.com/item/%E5%A3%B0%E9%9F%B3%E5%90%AC%E8%A7%89\" target=\"_blank\" rel=\"noopener\">声音三要素</a></h4><ol>\n<li><p>音高/音调/音频： 客观上音高大小主要取决于声波基频的高低，频率高则音调高，反之则低，单位用赫兹(Hz）表示。儿童(高音区)-&gt;女生(高音区)-&gt;男生（低音区）</p>\n</li>\n<li><p>音量/响度/声强：常说的声音大小，主要取决于声波振幅的大小。</p>\n</li>\n<li><p>音色/音品：和材质相关（比如钢琴等），本质是谐波。</p>\n</li>\n</ol>\n<p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/%E9%9F%B3%E9%87%8F%E5%92%8C%E5%A3%B0%E8%B0%83.png\" alt=\"音量和声调\"></p>\n<p>心理声学</p>\n<blockquote>\n<p>人类的听觉范围：20Hz-20kHz</p>\n</blockquote>\n<h4 id=\"音频量化过程\"><a href=\"#音频量化过程\" class=\"headerlink\" title=\"音频量化过程\"></a>音频量化过程</h4><p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/%E9%9F%B3%E9%A2%91%E9%87%8F%E5%8C%96%E8%BF%87%E7%A8%8B.png\" alt=\"音频量化过程\"></p>\n<ol>\n<li>按横轴时间进行切割</li>\n<li>按纵轴振幅(决定音量)进行切割</li>\n<li>编码转成数字信号</li>\n</ol>\n<blockquote>\n<p>采样大小：一个采样用多个bit存放，常用16位(2<sup>16</sup>=65535)，振幅<br>采样率：采样频率8k、16k、32k、44.1k、48k等 <a href=\"https://baike.baidu.com/item/音频采样率\" target=\"_blank\" rel=\"noopener\">采样率概念</a><br>声道数：单声道、双声道、多声道</p>\n</blockquote>\n<p>码率计算</p>\n<blockquote>\n<p>音频流的码率=采样率×采样大小×声道数<br>例如：采样率44.1kHz、采样大小为16bit、双声道的pcm编码wav文件，码率=44.1k×16×2=1411.2kb/s</p>\n</blockquote>\n<h4 id=\"音频压缩技术\"><a href=\"#音频压缩技术\" class=\"headerlink\" title=\"音频压缩技术\"></a>音频压缩技术</h4><ol>\n<li>消除音频冗余数据</li>\n</ol>\n<blockquote>\n<p>删除人耳听觉范围外的音频信号：</p>\n<blockquote>\n<p>20Hz-20kHz</p>\n</blockquote>\n<p>被掩避掉的音频信号： </p>\n<blockquote>\n<p>频域遮蔽：</p>\n<p>时域遮蔽：</p>\n</blockquote>\n</blockquote>\n<ol start=\"2\">\n<li>哈夫曼无损编码</li>\n</ol>\n<h4 id=\"音频编解码器\"><a href=\"#音频编解码器\" class=\"headerlink\" title=\"音频编解码器\"></a>音频编解码器</h4><p>常见的编解码器</p>\n<blockquote>\n<p>OPUS： 开源、rmtp协议不支持<br>AAC：收费、适合实时互动项目。<br>Vorbis：开源<br>Speex：开源、优势：还支持一些回音消除、降噪等处理办法<br>iLBC<br>AMR<br>G.711：与固定电话就行融合</p>\n</blockquote>\n<p>性能对比：</p>\n<blockquote>\n<p>OPUS &gt; AAC(常用) &gt; Vorbis<br>AAC： advanced audio coding<br>常见规格： AAC LC（低复杂度，码流128k）、AAC HE V1（）、 AAC HE V2<br>AAC LC + SBR = AAC HE V1<br>AAC HE V1 + PS = AAC HE V2</p>\n</blockquote>\n<p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/aac%E8%A7%84%E6%A0%BC.png\" alt=\"aac规格\"></p>\n<p>AAC格式：</p>\n<blockquote>\n<p>ADIF<br>ADTS</p>\n</blockquote>\n<p>AAC编码库：</p>\n<blockquote>\n<p>libfdk_aac(常用) &gt; ffmpeg aac &gt; libfaac &gt; libvo_aacenc</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p>2# 音频知识（未完工）</p>\n<h4 id=\"声音的本质\"><a href=\"#声音的本质\" class=\"headerlink\" title=\"声音的本质\"></a>声音的本质</h4><blockquote>\n<p>声音其实是一种能量波，因此也有频率和振幅的特征，频率对应于时间轴线，振幅对应于电平轴线。波是无限光滑的，弦线可以看成由无数点组成，由于存储空间是相对有限的，数字编码过程中，必须对弦线的点进行采样。</p>\n</blockquote>\n<h4 id=\"声音三要素\"><a href=\"#声音三要素\" class=\"headerlink\" title=\"声音三要素\"></a><a href=\"https://baike.baidu.com/item/%E5%A3%B0%E9%9F%B3%E5%90%AC%E8%A7%89\" target=\"_blank\" rel=\"noopener\">声音三要素</a></h4><ol>\n<li><p>音高/音调/音频： 客观上音高大小主要取决于声波基频的高低，频率高则音调高，反之则低，单位用赫兹(Hz）表示。儿童(高音区)-&gt;女生(高音区)-&gt;男生（低音区）</p>\n</li>\n<li><p>音量/响度/声强：常说的声音大小，主要取决于声波振幅的大小。</p>\n</li>\n<li><p>音色/音品：和材质相关（比如钢琴等），本质是谐波。</p>\n</li>\n</ol>\n<p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/%E9%9F%B3%E9%87%8F%E5%92%8C%E5%A3%B0%E8%B0%83.png\" alt=\"音量和声调\"></p>\n<p>心理声学</p>\n<blockquote>\n<p>人类的听觉范围：20Hz-20kHz</p>\n</blockquote>\n<h4 id=\"音频量化过程\"><a href=\"#音频量化过程\" class=\"headerlink\" title=\"音频量化过程\"></a>音频量化过程</h4><p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/%E9%9F%B3%E9%A2%91%E9%87%8F%E5%8C%96%E8%BF%87%E7%A8%8B.png\" alt=\"音频量化过程\"></p>\n<ol>\n<li>按横轴时间进行切割</li>\n<li>按纵轴振幅(决定音量)进行切割</li>\n<li>编码转成数字信号</li>\n</ol>\n<blockquote>\n<p>采样大小：一个采样用多个bit存放，常用16位(2<sup>16</sup>=65535)，振幅<br>采样率：采样频率8k、16k、32k、44.1k、48k等 <a href=\"https://baike.baidu.com/item/音频采样率\" target=\"_blank\" rel=\"noopener\">采样率概念</a><br>声道数：单声道、双声道、多声道</p>\n</blockquote>\n<p>码率计算</p>\n<blockquote>\n<p>音频流的码率=采样率×采样大小×声道数<br>例如：采样率44.1kHz、采样大小为16bit、双声道的pcm编码wav文件，码率=44.1k×16×2=1411.2kb/s</p>\n</blockquote>\n<h4 id=\"音频压缩技术\"><a href=\"#音频压缩技术\" class=\"headerlink\" title=\"音频压缩技术\"></a>音频压缩技术</h4><ol>\n<li>消除音频冗余数据</li>\n</ol>\n<blockquote>\n<p>删除人耳听觉范围外的音频信号：</p>\n<blockquote>\n<p>20Hz-20kHz</p>\n</blockquote>\n<p>被掩避掉的音频信号： </p>\n<blockquote>\n<p>频域遮蔽：</p>\n<p>时域遮蔽：</p>\n</blockquote>\n</blockquote>\n<ol start=\"2\">\n<li>哈夫曼无损编码</li>\n</ol>\n<h4 id=\"音频编解码器\"><a href=\"#音频编解码器\" class=\"headerlink\" title=\"音频编解码器\"></a>音频编解码器</h4><p>常见的编解码器</p>\n<blockquote>\n<p>OPUS： 开源、rmtp协议不支持<br>AAC：收费、适合实时互动项目。<br>Vorbis：开源<br>Speex：开源、优势：还支持一些回音消除、降噪等处理办法<br>iLBC<br>AMR<br>G.711：与固定电话就行融合</p>\n</blockquote>\n<p>性能对比：</p>\n<blockquote>\n<p>OPUS &gt; AAC(常用) &gt; Vorbis<br>AAC： advanced audio coding<br>常见规格： AAC LC（低复杂度，码流128k）、AAC HE V1（）、 AAC HE V2<br>AAC LC + SBR = AAC HE V1<br>AAC HE V1 + PS = AAC HE V2</p>\n</blockquote>\n<p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/aac%E8%A7%84%E6%A0%BC.png\" alt=\"aac规格\"></p>\n<p>AAC格式：</p>\n<blockquote>\n<p>ADIF<br>ADTS</p>\n</blockquote>\n<p>AAC编码库：</p>\n<blockquote>\n<p>libfdk_aac(常用) &gt; ffmpeg aac &gt; libfaac &gt; libvo_aacenc</p>\n</blockquote>\n"},{"title":"git入门基础","url":"64.html","id":"64","comments":0,"date":"2016-11-09T07:19:56.000Z","_content":"\n### 创建项目\n\n    git init\n    \n\n### 查看分支\n\n    E:\\HKMAIN (master)\n    λ git branch\n    * master\n      v1.1\n      v1.2\n    λ git branch -v\n    * master bf0d2bf 蛋白模板修改USAGE:Reconstitute in sterile ddH2O.\n      v1.1   b48a782 试剂盒现货列表添加样本信息一栏\n      v1.2   acbf4f1 c1.2\n    \n\n### 删除分支\n\n查看未合并的分支\n\n    λ git branch --no-merged\n    \n\n删除分支\n\n    git branch -d v1.1\n    \n\n如果是未合并的分支，使用大写的-D\n\n    E:\\HKMAIN (master)\n    λ git branch -d v1.1\n    Deleted branch v1.1 (was b48a782).\n    \n    E:\\HKMAIN (master)\n    λ git branch -v\n    * master bf0d2bf 蛋白模板修改USAGE:Reconstitute in sterile ddH2O.\n      v1.2   acbf4f1 c1.2\n    \n\n### 创建分支\n\n    git branch v2.0\n    \n\n    E:\\HKMAIN (master)\n    λ git branch Vmysql\n    \n    E:\\HKMAIN (master)\n    λ git branch\n      Vmysql\n    * master\n      v1.2\n    \n    E:\\HKMAIN (master)\n    λ git checkout Vmysql\n    Switched to branch 'Vmysql'\n    \n    E:\\HKMAIN (Vmysql)\n    λ\n    \n\n或者直接使用git checkout -b v3.0\n\n    E:\\HKMAIN (Vmysql)\n    λ git checkout -b Vsqlserver\n    Switched to a new branch 'Vsqlserver'\n    \n    E:\\HKMAIN (Vsqlserver)\n    λ git branch\n      Vmysql\n    * Vsqlserver\n      master\n      v1.2\n    \n\n### git查看远程仓库\n\n    # git查看远程仓库\n    git remote -v\n    # git添加远程仓库\n    git remote add xxx git@gitlab.xxx.com:xxx/xxx\n    # 删除远程分值\n    git remote rm xxx\n    \n\n### git stash\n\n使用git stash命令先把当前进度保存起来，然后切换到另一个分支去修改bug，修改完提交后，再切回dev分支，使用git stash pop来恢复之前的进度继续开发新功能。\n\n    # 保存当前进度\n    git stash\n    # 查看现有的存储\n    git stash list\n    # 恢复最新的进度到工作区\n    git stash pop\n    git stash save your-file-name","source":"_posts/git入门基础.md","raw":"---\ntitle: git入门基础\nurl: 64.html\nid: 64\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-09 15:19:56\ntags:\n---\n\n### 创建项目\n\n    git init\n    \n\n### 查看分支\n\n    E:\\HKMAIN (master)\n    λ git branch\n    * master\n      v1.1\n      v1.2\n    λ git branch -v\n    * master bf0d2bf 蛋白模板修改USAGE:Reconstitute in sterile ddH2O.\n      v1.1   b48a782 试剂盒现货列表添加样本信息一栏\n      v1.2   acbf4f1 c1.2\n    \n\n### 删除分支\n\n查看未合并的分支\n\n    λ git branch --no-merged\n    \n\n删除分支\n\n    git branch -d v1.1\n    \n\n如果是未合并的分支，使用大写的-D\n\n    E:\\HKMAIN (master)\n    λ git branch -d v1.1\n    Deleted branch v1.1 (was b48a782).\n    \n    E:\\HKMAIN (master)\n    λ git branch -v\n    * master bf0d2bf 蛋白模板修改USAGE:Reconstitute in sterile ddH2O.\n      v1.2   acbf4f1 c1.2\n    \n\n### 创建分支\n\n    git branch v2.0\n    \n\n    E:\\HKMAIN (master)\n    λ git branch Vmysql\n    \n    E:\\HKMAIN (master)\n    λ git branch\n      Vmysql\n    * master\n      v1.2\n    \n    E:\\HKMAIN (master)\n    λ git checkout Vmysql\n    Switched to branch 'Vmysql'\n    \n    E:\\HKMAIN (Vmysql)\n    λ\n    \n\n或者直接使用git checkout -b v3.0\n\n    E:\\HKMAIN (Vmysql)\n    λ git checkout -b Vsqlserver\n    Switched to a new branch 'Vsqlserver'\n    \n    E:\\HKMAIN (Vsqlserver)\n    λ git branch\n      Vmysql\n    * Vsqlserver\n      master\n      v1.2\n    \n\n### git查看远程仓库\n\n    # git查看远程仓库\n    git remote -v\n    # git添加远程仓库\n    git remote add xxx git@gitlab.xxx.com:xxx/xxx\n    # 删除远程分值\n    git remote rm xxx\n    \n\n### git stash\n\n使用git stash命令先把当前进度保存起来，然后切换到另一个分支去修改bug，修改完提交后，再切回dev分支，使用git stash pop来恢复之前的进度继续开发新功能。\n\n    # 保存当前进度\n    git stash\n    # 查看现有的存储\n    git stash list\n    # 恢复最新的进度到工作区\n    git stash pop\n    git stash save your-file-name","slug":"git入门基础","published":1,"updated":"2019-07-24T01:26:06.416Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5nz001b9ka4h5wc20x8","content":"<h3 id=\"创建项目\"><a href=\"#创建项目\" class=\"headerlink\" title=\"创建项目\"></a>创建项目</h3><pre><code>git init</code></pre><h3 id=\"查看分支\"><a href=\"#查看分支\" class=\"headerlink\" title=\"查看分支\"></a>查看分支</h3><pre><code>E:\\HKMAIN (master)\nλ git branch\n* master\n  v1.1\n  v1.2\nλ git branch -v\n* master bf0d2bf 蛋白模板修改USAGE:Reconstitute in sterile ddH2O.\n  v1.1   b48a782 试剂盒现货列表添加样本信息一栏\n  v1.2   acbf4f1 c1.2</code></pre><h3 id=\"删除分支\"><a href=\"#删除分支\" class=\"headerlink\" title=\"删除分支\"></a>删除分支</h3><p>查看未合并的分支</p>\n<pre><code>λ git branch --no-merged</code></pre><p>删除分支</p>\n<pre><code>git branch -d v1.1</code></pre><p>如果是未合并的分支，使用大写的-D</p>\n<pre><code>E:\\HKMAIN (master)\nλ git branch -d v1.1\nDeleted branch v1.1 (was b48a782).\n\nE:\\HKMAIN (master)\nλ git branch -v\n* master bf0d2bf 蛋白模板修改USAGE:Reconstitute in sterile ddH2O.\n  v1.2   acbf4f1 c1.2</code></pre><h3 id=\"创建分支\"><a href=\"#创建分支\" class=\"headerlink\" title=\"创建分支\"></a>创建分支</h3><pre><code>git branch v2.0\n\n\nE:\\HKMAIN (master)\nλ git branch Vmysql\n\nE:\\HKMAIN (master)\nλ git branch\n  Vmysql\n* master\n  v1.2\n\nE:\\HKMAIN (master)\nλ git checkout Vmysql\nSwitched to branch &apos;Vmysql&apos;\n\nE:\\HKMAIN (Vmysql)\nλ</code></pre><p>或者直接使用git checkout -b v3.0</p>\n<pre><code>E:\\HKMAIN (Vmysql)\nλ git checkout -b Vsqlserver\nSwitched to a new branch &apos;Vsqlserver&apos;\n\nE:\\HKMAIN (Vsqlserver)\nλ git branch\n  Vmysql\n* Vsqlserver\n  master\n  v1.2</code></pre><h3 id=\"git查看远程仓库\"><a href=\"#git查看远程仓库\" class=\"headerlink\" title=\"git查看远程仓库\"></a>git查看远程仓库</h3><pre><code># git查看远程仓库\ngit remote -v\n# git添加远程仓库\ngit remote add xxx git@gitlab.xxx.com:xxx/xxx\n# 删除远程分值\ngit remote rm xxx</code></pre><h3 id=\"git-stash\"><a href=\"#git-stash\" class=\"headerlink\" title=\"git stash\"></a>git stash</h3><p>使用git stash命令先把当前进度保存起来，然后切换到另一个分支去修改bug，修改完提交后，再切回dev分支，使用git stash pop来恢复之前的进度继续开发新功能。</p>\n<pre><code># 保存当前进度\ngit stash\n# 查看现有的存储\ngit stash list\n# 恢复最新的进度到工作区\ngit stash pop\ngit stash save your-file-name</code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"创建项目\"><a href=\"#创建项目\" class=\"headerlink\" title=\"创建项目\"></a>创建项目</h3><pre><code>git init</code></pre><h3 id=\"查看分支\"><a href=\"#查看分支\" class=\"headerlink\" title=\"查看分支\"></a>查看分支</h3><pre><code>E:\\HKMAIN (master)\nλ git branch\n* master\n  v1.1\n  v1.2\nλ git branch -v\n* master bf0d2bf 蛋白模板修改USAGE:Reconstitute in sterile ddH2O.\n  v1.1   b48a782 试剂盒现货列表添加样本信息一栏\n  v1.2   acbf4f1 c1.2</code></pre><h3 id=\"删除分支\"><a href=\"#删除分支\" class=\"headerlink\" title=\"删除分支\"></a>删除分支</h3><p>查看未合并的分支</p>\n<pre><code>λ git branch --no-merged</code></pre><p>删除分支</p>\n<pre><code>git branch -d v1.1</code></pre><p>如果是未合并的分支，使用大写的-D</p>\n<pre><code>E:\\HKMAIN (master)\nλ git branch -d v1.1\nDeleted branch v1.1 (was b48a782).\n\nE:\\HKMAIN (master)\nλ git branch -v\n* master bf0d2bf 蛋白模板修改USAGE:Reconstitute in sterile ddH2O.\n  v1.2   acbf4f1 c1.2</code></pre><h3 id=\"创建分支\"><a href=\"#创建分支\" class=\"headerlink\" title=\"创建分支\"></a>创建分支</h3><pre><code>git branch v2.0\n\n\nE:\\HKMAIN (master)\nλ git branch Vmysql\n\nE:\\HKMAIN (master)\nλ git branch\n  Vmysql\n* master\n  v1.2\n\nE:\\HKMAIN (master)\nλ git checkout Vmysql\nSwitched to branch &apos;Vmysql&apos;\n\nE:\\HKMAIN (Vmysql)\nλ</code></pre><p>或者直接使用git checkout -b v3.0</p>\n<pre><code>E:\\HKMAIN (Vmysql)\nλ git checkout -b Vsqlserver\nSwitched to a new branch &apos;Vsqlserver&apos;\n\nE:\\HKMAIN (Vsqlserver)\nλ git branch\n  Vmysql\n* Vsqlserver\n  master\n  v1.2</code></pre><h3 id=\"git查看远程仓库\"><a href=\"#git查看远程仓库\" class=\"headerlink\" title=\"git查看远程仓库\"></a>git查看远程仓库</h3><pre><code># git查看远程仓库\ngit remote -v\n# git添加远程仓库\ngit remote add xxx git@gitlab.xxx.com:xxx/xxx\n# 删除远程分值\ngit remote rm xxx</code></pre><h3 id=\"git-stash\"><a href=\"#git-stash\" class=\"headerlink\" title=\"git stash\"></a>git stash</h3><p>使用git stash命令先把当前进度保存起来，然后切换到另一个分支去修改bug，修改完提交后，再切回dev分支，使用git stash pop来恢复之前的进度继续开发新功能。</p>\n<pre><code># 保存当前进度\ngit stash\n# 查看现有的存储\ngit stash list\n# 恢复最新的进度到工作区\ngit stash pop\ngit stash save your-file-name</code></pre>"},{"title":"java入门基础","url":"499.html","id":"499","comments":0,"date":"2018-01-31T01:44:05.000Z","_content":"\n### linux安装java开发环境\n\n    [root@localhost ~]# mkdir /usr/java\n    [root@localhost ~]# cd /usr/java\n    # 从官方网站下载javaLTS版本源码并复制到当前目录\n    # 下载地址: https://www.oracle.com/technetwork/java/javase/downloads/index.html\n    [root@localhost ~]# tar -zxvf jdk-11.0.3_linux-x64_bin.tar.gz && rm  jdk-11.0.3_linux-x64_bin.tar.gz\n    \n\n    # 设置环境变量\n    vi /etc/profile\n    #set java environment\n    JAVA_HOME=/usr/java/jdk-11.0.3\n    JRE_HOME=/usr/java/jdk-11.0.3/jre\n    CLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib\n    PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin\n    export JAVA_HOME JRE_HOME CLASS_PATH PATH\n    \n\n    # 验证\n    [root@localhost ~]# which java\n    /usr/java/jdk-11.0.3/bin/java\n    [root@localhost ~]# java -version\n    java version \"11.0.3\" 2019-04-16 LTS\n    Java(TM) SE Runtime Environment 18.9 (build 11.0.3+12-LTS)                                           \n    Java HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.3+12-LTS, mixed mode)","source":"_posts/java入门基础.md","raw":"---\ntitle: java入门基础\nurl: 499.html\nid: 499\ncomments: false\ncategories:\n  - 前端\ndate: 2018-01-31 09:44:05\ntags:\n---\n\n### linux安装java开发环境\n\n    [root@localhost ~]# mkdir /usr/java\n    [root@localhost ~]# cd /usr/java\n    # 从官方网站下载javaLTS版本源码并复制到当前目录\n    # 下载地址: https://www.oracle.com/technetwork/java/javase/downloads/index.html\n    [root@localhost ~]# tar -zxvf jdk-11.0.3_linux-x64_bin.tar.gz && rm  jdk-11.0.3_linux-x64_bin.tar.gz\n    \n\n    # 设置环境变量\n    vi /etc/profile\n    #set java environment\n    JAVA_HOME=/usr/java/jdk-11.0.3\n    JRE_HOME=/usr/java/jdk-11.0.3/jre\n    CLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib\n    PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin\n    export JAVA_HOME JRE_HOME CLASS_PATH PATH\n    \n\n    # 验证\n    [root@localhost ~]# which java\n    /usr/java/jdk-11.0.3/bin/java\n    [root@localhost ~]# java -version\n    java version \"11.0.3\" 2019-04-16 LTS\n    Java(TM) SE Runtime Environment 18.9 (build 11.0.3+12-LTS)                                           \n    Java HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.3+12-LTS, mixed mode)","slug":"java入门基础","published":1,"updated":"2019-07-24T01:26:48.603Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5nz001f9ka4164hzrlu","content":"<h3 id=\"linux安装java开发环境\"><a href=\"#linux安装java开发环境\" class=\"headerlink\" title=\"linux安装java开发环境\"></a>linux安装java开发环境</h3><pre><code>[root@localhost ~]# mkdir /usr/java\n[root@localhost ~]# cd /usr/java\n# 从官方网站下载javaLTS版本源码并复制到当前目录\n# 下载地址: https://www.oracle.com/technetwork/java/javase/downloads/index.html\n[root@localhost ~]# tar -zxvf jdk-11.0.3_linux-x64_bin.tar.gz &amp;&amp; rm  jdk-11.0.3_linux-x64_bin.tar.gz\n\n\n# 设置环境变量\nvi /etc/profile\n#set java environment\nJAVA_HOME=/usr/java/jdk-11.0.3\nJRE_HOME=/usr/java/jdk-11.0.3/jre\nCLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib\nPATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin\nexport JAVA_HOME JRE_HOME CLASS_PATH PATH\n\n\n# 验证\n[root@localhost ~]# which java\n/usr/java/jdk-11.0.3/bin/java\n[root@localhost ~]# java -version\njava version &quot;11.0.3&quot; 2019-04-16 LTS\nJava(TM) SE Runtime Environment 18.9 (build 11.0.3+12-LTS)                                           \nJava HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.3+12-LTS, mixed mode)</code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"linux安装java开发环境\"><a href=\"#linux安装java开发环境\" class=\"headerlink\" title=\"linux安装java开发环境\"></a>linux安装java开发环境</h3><pre><code>[root@localhost ~]# mkdir /usr/java\n[root@localhost ~]# cd /usr/java\n# 从官方网站下载javaLTS版本源码并复制到当前目录\n# 下载地址: https://www.oracle.com/technetwork/java/javase/downloads/index.html\n[root@localhost ~]# tar -zxvf jdk-11.0.3_linux-x64_bin.tar.gz &amp;&amp; rm  jdk-11.0.3_linux-x64_bin.tar.gz\n\n\n# 设置环境变量\nvi /etc/profile\n#set java environment\nJAVA_HOME=/usr/java/jdk-11.0.3\nJRE_HOME=/usr/java/jdk-11.0.3/jre\nCLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib\nPATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin\nexport JAVA_HOME JRE_HOME CLASS_PATH PATH\n\n\n# 验证\n[root@localhost ~]# which java\n/usr/java/jdk-11.0.3/bin/java\n[root@localhost ~]# java -version\njava version &quot;11.0.3&quot; 2019-04-16 LTS\nJava(TM) SE Runtime Environment 18.9 (build 11.0.3+12-LTS)                                           \nJava HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.3+12-LTS, mixed mode)</code></pre>"},{"title":"jetbrains使用配置","url":"53.html","id":"53","comments":0,"date":"2016-11-09T06:57:21.000Z","_content":"\n### 需要新的license\n\n选择server license  \n添加 http://idea.lanyus.com/  \n点击 \"ok\"  \n成功添加  \nphpstorm10.03开始使用http://idea.qinxi1992.cn/  \npycharm\n\n    43B4A73YYJ-eyJsaWNlbnNlSWQiOiI0M0I0QTczWVlKIiwibGljZW5zZWVOYW1lIjoibGFuIHl1IiwiYXNzaWduZWVOYW1lIjoiIiwiYXNzaWduZWVFbWFpbCI6IiIsImxpY2Vuc2VSZXN0cmljdGlvbiI6IkZvciBlZHVjYXRpb25hbCB1c2Ugb25seSIsImNoZWNrQ29uY3VycmVudFVzZSI6ZmFsc2UsInByb2R1Y3RzIjpbeyJjb2RlIjoiSUkiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJBQyIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IkRQTiIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlBTIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiRE0iLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJDTCIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlJTMCIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlJDIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiUEMiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJSTSIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IldTIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiREIiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJEQyIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9XSwiaGFzaCI6IjMzOTgyOTkvMCIsImdyYWNlUGVyaW9kRGF5cyI6MCwiYXV0b1Byb2xvbmdhdGVkIjpmYWxzZSwiaXNBdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlfQ==-keaxIkRgXPKE4BR/ZTs7s7UkP92LBxRe57HvWamu1EHVXTcV1B4f/KNQIrpOpN6dgpjig5eMVMPmo7yMPl+bmwQ8pTZaCGFuLqCHD1ngo6ywHKIQy0nR249sAUVaCl2wGJwaO4JeOh1opUx8chzSBVRZBMz0/MGyygi7duYAff9JQqfH3p/BhDTNM8eKl6z5tnneZ8ZG5bG1XvqFTqWk4FhGsEWdK7B+He44hPjBxKQl2gmZAodb6g9YxfTHhVRKQY5hQ7KPXNvh3ikerHkoaL5apgsVBZJOTDE2KdYTnGLmqxghFx6L0ofqKI6hMr48ergMyflDk6wLNGWJvYHLWw==-MIIEPjCCAiagAwIBAgIBBTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTE1MTEwMjA4MjE0OFoXDTE4MTEwMTA4MjE0OFowETEPMA0GA1UEAwwGcHJvZDN5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxcQkq+zdxlR2mmRYBPzGbUNdMN6OaXiXzxIWtMEkrJMO/5oUfQJbLLuMSMK0QHFmaI37WShyxZcfRCidwXjot4zmNBKnlyHodDij/78TmVqFl8nOeD5+07B8VEaIu7c3E1N+e1doC6wht4I4+IEmtsPAdoaj5WCQVQbrI8KeT8M9VcBIWX7fD0fhexfg3ZRt0xqwMcXGNp3DdJHiO0rCdU+Itv7EmtnSVq9jBG1usMSFvMowR25mju2JcPFp1+I4ZI+FqgR8gyG8oiNDyNEoAbsR3lOpI7grUYSvkB/xVy/VoklPCK2h0f0GJxFjnye8NT1PAywoyl7RmiAVRE/EKwIDAQABo4GZMIGWMAkGA1UdEwQCMAAwHQYDVR0OBBYEFGEpG9oZGcfLMGNBkY7SgHiMGgTcMEgGA1UdIwRBMD+AFKOetkhnQhI2Qb1t4Lm0oFKLl/GzoRykGjAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBggkA0myxg7KDeeEwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgWgMA0GCSqGSIb3DQEBCwUAA4ICAQC9WZuYgQedSuOc5TOUSrRigMw4/+wuC5EtZBfvdl4HT/8vzMW/oUlIP4YCvA0XKyBaCJ2iX+ZCDKoPfiYXiaSiH+HxAPV6J79vvouxKrWg2XV6ShFtPLP+0gPdGq3x9R3+kJbmAm8w+FOdlWqAfJrLvpzMGNeDU14YGXiZ9bVzmIQbwrBA+c/F4tlK/DV07dsNExihqFoibnqDiVNTGombaU2dDup2gwKdL81ua8EIcGNExHe82kjF4zwfadHk3bQVvbfdAwxcDy4xBjs3L4raPLU3yenSzr/OEur1+jfOxnQSmEcMXKXgrAQ9U55gwjcOFKrgOxEdek/Sk1VfOjvS+nuM4eyEruFMfaZHzoQiuw4IqgGc45ohFH0UUyjYcuFxxDSU9lMCv8qdHKm+wnPRb0l9l5vXsCBDuhAGYD6ss+Ga+aDY6f/qXZuUCEUOH3QUNbbCUlviSz6+GiRnt1kA9N2Qachl+2yBfaqUqr8h7Z2gsx5LcIf5kYNsqJ0GavXTVyWh7PYiKX4bs354ZQLUwwa/cG++2+wNWP+HtBhVxMRNTdVhSm38AknZlD+PTAsWGu9GyLmhti2EnVwGybSD2Dxmhxk3IPCkhKAK+pl0eWYGZWG3tJ9mZ7SowcXLWDFAk0lRJnKGFMTggrWjV8GYpw5bq23VmIqqDLgkNzuoog==\n    \n\n### 输入法问题\n\n升级到ubuntu16.04后，输入无法使用  \n去安装目录bin文件夹下找到启动idea.sh,用编辑器打开，添加\n\n    XMODIFIERS=\"@im=fcitx\"\n    export XMODIFIERS\n    \n\n在\n\n    # ---------------------------------------------------------------------\n    # Run the IDE.\n    # ---------------------------------------------------------------------\n    \n\n上面即可！\n\n### ubuntu安装\n\n下载并压缩到/opt/目录下,并在/usr/share/appliactions/下创建快捷方式的文件，命名为phpstorm.desktop,编辑如下代码，保存\n\n    [Desktop Entry]\n    Categories=Development;\n    Comment[zh_CN]=\n    Comment=\n    Exec=/opt/phpstorm/bin/phpstorm.sh\n    GenericName[zh_CN]=IDE\n    GenericName=IDE\n    Icon=/opt/phpstorm/bin/webide.png\n    Name[zh_CN]=phpStorm\n    Name=phpStorm　　　　　　　\n    Path=\n    StartupNotify=true\n    Terminal=false\n    Type=Application\n    X-DBUS-ServiceName=\n    X-DBUS-StartupType=\n    X-KDE-SubstituteUID=false\n    X-KDE-Username=Learn Programming\n    \n\n### 界面样式\n\n[theme](https://github.com/jkaving/intellij-colors-solarized)  \n[背景修改，含theme](https://github.com/ChrisRM/material-theme-jetbrains)\n\n### 界面配置\n\n显示行号  \nEditor->General->Appearance->Show line number  \n关闭自动保存  \nAppearance&Behavior->System settings->save files on frame deactivation 关闭  \nEditor->General->Editor tabs->Mark modified tabs with asterisk 勾选\n\n### theme安装\n\n安装模板下载http://phpstorm-themes.com/  \nubuntu安装地址~/.pycharm/config/colors/ ###快捷键 Ctrl+/ 或 Ctrl+Shift+/ 注释（// 或者/_…_/ ）  \nShift+F6 重构-重命名  \nCtrl+X 删除行  \nCtrl+D 复制行  \nCtrl+G 查找行  \nCtrl+Shift+Up/Down 代码向上/下移动。  \nF2 或Shift+F2 高亮错误或警告快速定位  \n写代码，按Tab 生成代码  \n选中文本，按Ctrl+Shift+F7 高亮显示所有该文本，按Esc高亮消失。(因为这个功能我就可以发放心的放弃sublime了)  \nCtrl+B或Ctrl+鼠标左键单击 快速打开光标处的类或方法，（NB的功能）  \nCtrl + Alt + B Go to implementation(s) 跳转方法实现处  \nCtrl + Shift + I Open quick definition lookup 打开定义快速查找  \nAlt + Up/Down Go to previous/next method 跳转到上一个/下一个方法  \nCtrl+E 最近打开的文件  \nAlt+F1 查找代码所在位置  \nCtrl+Alt+L 格式化代码  \nCtrl+R 替换文本  \nCtrl+F 查找文本  \nCtrl+P 方法参数提示  \nF3 查找下一个  \nShift+F3 查找上一个  \nalt+Shift+F 将当前文件加入收藏夹  \nctrl+alt+s 打开配置窗口  \nctrl+Shift+N 通过文件名快速查找工程内的文件（必记）  \nctrl+Shift+alt+N 通过一个字符快速查找位置（必记）  \nShift+enter 重新开始一行（无论光标在哪个位置）  \nCtrl + Alt + T with…（if, else, try, catch, for, etc）用 * 来围绕选中的代码行，（ * 包括 if 、 while 、 try catch 等）  \nCtrl + Shift + U Toggle case for word at caret or selected block 光标所在位置大小写  \nCtrl + Delete Delete to word end 删除文字结束  \nCtrl + Backspace Delete to word start 删除文字开始  \nCtrl + E Recent files popup 弹出最近打开的文件  \nF11 Toggle bookmark 切换标记，我觉得叫书签更好，就是sublime text 的F2  \nCtrl + Shift + F12 Toggle maximizing editor 切换最大化编辑器  \nAlt + Shift + F Add to Favorites 添至收藏夹","source":"_posts/jetbrains使用配置.md","raw":"---\ntitle: jetbrains使用配置\ntags:\n  - IDE\nurl: 53.html\nid: 53\ncomments: false\ncategories:\n  - 办公\ndate: 2016-11-09 14:57:21\n---\n\n### 需要新的license\n\n选择server license  \n添加 http://idea.lanyus.com/  \n点击 \"ok\"  \n成功添加  \nphpstorm10.03开始使用http://idea.qinxi1992.cn/  \npycharm\n\n    43B4A73YYJ-eyJsaWNlbnNlSWQiOiI0M0I0QTczWVlKIiwibGljZW5zZWVOYW1lIjoibGFuIHl1IiwiYXNzaWduZWVOYW1lIjoiIiwiYXNzaWduZWVFbWFpbCI6IiIsImxpY2Vuc2VSZXN0cmljdGlvbiI6IkZvciBlZHVjYXRpb25hbCB1c2Ugb25seSIsImNoZWNrQ29uY3VycmVudFVzZSI6ZmFsc2UsInByb2R1Y3RzIjpbeyJjb2RlIjoiSUkiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJBQyIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IkRQTiIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlBTIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiRE0iLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJDTCIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlJTMCIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlJDIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiUEMiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJSTSIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IldTIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiREIiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJEQyIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9XSwiaGFzaCI6IjMzOTgyOTkvMCIsImdyYWNlUGVyaW9kRGF5cyI6MCwiYXV0b1Byb2xvbmdhdGVkIjpmYWxzZSwiaXNBdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlfQ==-keaxIkRgXPKE4BR/ZTs7s7UkP92LBxRe57HvWamu1EHVXTcV1B4f/KNQIrpOpN6dgpjig5eMVMPmo7yMPl+bmwQ8pTZaCGFuLqCHD1ngo6ywHKIQy0nR249sAUVaCl2wGJwaO4JeOh1opUx8chzSBVRZBMz0/MGyygi7duYAff9JQqfH3p/BhDTNM8eKl6z5tnneZ8ZG5bG1XvqFTqWk4FhGsEWdK7B+He44hPjBxKQl2gmZAodb6g9YxfTHhVRKQY5hQ7KPXNvh3ikerHkoaL5apgsVBZJOTDE2KdYTnGLmqxghFx6L0ofqKI6hMr48ergMyflDk6wLNGWJvYHLWw==-MIIEPjCCAiagAwIBAgIBBTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTE1MTEwMjA4MjE0OFoXDTE4MTEwMTA4MjE0OFowETEPMA0GA1UEAwwGcHJvZDN5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxcQkq+zdxlR2mmRYBPzGbUNdMN6OaXiXzxIWtMEkrJMO/5oUfQJbLLuMSMK0QHFmaI37WShyxZcfRCidwXjot4zmNBKnlyHodDij/78TmVqFl8nOeD5+07B8VEaIu7c3E1N+e1doC6wht4I4+IEmtsPAdoaj5WCQVQbrI8KeT8M9VcBIWX7fD0fhexfg3ZRt0xqwMcXGNp3DdJHiO0rCdU+Itv7EmtnSVq9jBG1usMSFvMowR25mju2JcPFp1+I4ZI+FqgR8gyG8oiNDyNEoAbsR3lOpI7grUYSvkB/xVy/VoklPCK2h0f0GJxFjnye8NT1PAywoyl7RmiAVRE/EKwIDAQABo4GZMIGWMAkGA1UdEwQCMAAwHQYDVR0OBBYEFGEpG9oZGcfLMGNBkY7SgHiMGgTcMEgGA1UdIwRBMD+AFKOetkhnQhI2Qb1t4Lm0oFKLl/GzoRykGjAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBggkA0myxg7KDeeEwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgWgMA0GCSqGSIb3DQEBCwUAA4ICAQC9WZuYgQedSuOc5TOUSrRigMw4/+wuC5EtZBfvdl4HT/8vzMW/oUlIP4YCvA0XKyBaCJ2iX+ZCDKoPfiYXiaSiH+HxAPV6J79vvouxKrWg2XV6ShFtPLP+0gPdGq3x9R3+kJbmAm8w+FOdlWqAfJrLvpzMGNeDU14YGXiZ9bVzmIQbwrBA+c/F4tlK/DV07dsNExihqFoibnqDiVNTGombaU2dDup2gwKdL81ua8EIcGNExHe82kjF4zwfadHk3bQVvbfdAwxcDy4xBjs3L4raPLU3yenSzr/OEur1+jfOxnQSmEcMXKXgrAQ9U55gwjcOFKrgOxEdek/Sk1VfOjvS+nuM4eyEruFMfaZHzoQiuw4IqgGc45ohFH0UUyjYcuFxxDSU9lMCv8qdHKm+wnPRb0l9l5vXsCBDuhAGYD6ss+Ga+aDY6f/qXZuUCEUOH3QUNbbCUlviSz6+GiRnt1kA9N2Qachl+2yBfaqUqr8h7Z2gsx5LcIf5kYNsqJ0GavXTVyWh7PYiKX4bs354ZQLUwwa/cG++2+wNWP+HtBhVxMRNTdVhSm38AknZlD+PTAsWGu9GyLmhti2EnVwGybSD2Dxmhxk3IPCkhKAK+pl0eWYGZWG3tJ9mZ7SowcXLWDFAk0lRJnKGFMTggrWjV8GYpw5bq23VmIqqDLgkNzuoog==\n    \n\n### 输入法问题\n\n升级到ubuntu16.04后，输入无法使用  \n去安装目录bin文件夹下找到启动idea.sh,用编辑器打开，添加\n\n    XMODIFIERS=\"@im=fcitx\"\n    export XMODIFIERS\n    \n\n在\n\n    # ---------------------------------------------------------------------\n    # Run the IDE.\n    # ---------------------------------------------------------------------\n    \n\n上面即可！\n\n### ubuntu安装\n\n下载并压缩到/opt/目录下,并在/usr/share/appliactions/下创建快捷方式的文件，命名为phpstorm.desktop,编辑如下代码，保存\n\n    [Desktop Entry]\n    Categories=Development;\n    Comment[zh_CN]=\n    Comment=\n    Exec=/opt/phpstorm/bin/phpstorm.sh\n    GenericName[zh_CN]=IDE\n    GenericName=IDE\n    Icon=/opt/phpstorm/bin/webide.png\n    Name[zh_CN]=phpStorm\n    Name=phpStorm　　　　　　　\n    Path=\n    StartupNotify=true\n    Terminal=false\n    Type=Application\n    X-DBUS-ServiceName=\n    X-DBUS-StartupType=\n    X-KDE-SubstituteUID=false\n    X-KDE-Username=Learn Programming\n    \n\n### 界面样式\n\n[theme](https://github.com/jkaving/intellij-colors-solarized)  \n[背景修改，含theme](https://github.com/ChrisRM/material-theme-jetbrains)\n\n### 界面配置\n\n显示行号  \nEditor->General->Appearance->Show line number  \n关闭自动保存  \nAppearance&Behavior->System settings->save files on frame deactivation 关闭  \nEditor->General->Editor tabs->Mark modified tabs with asterisk 勾选\n\n### theme安装\n\n安装模板下载http://phpstorm-themes.com/  \nubuntu安装地址~/.pycharm/config/colors/ ###快捷键 Ctrl+/ 或 Ctrl+Shift+/ 注释（// 或者/_…_/ ）  \nShift+F6 重构-重命名  \nCtrl+X 删除行  \nCtrl+D 复制行  \nCtrl+G 查找行  \nCtrl+Shift+Up/Down 代码向上/下移动。  \nF2 或Shift+F2 高亮错误或警告快速定位  \n写代码，按Tab 生成代码  \n选中文本，按Ctrl+Shift+F7 高亮显示所有该文本，按Esc高亮消失。(因为这个功能我就可以发放心的放弃sublime了)  \nCtrl+B或Ctrl+鼠标左键单击 快速打开光标处的类或方法，（NB的功能）  \nCtrl + Alt + B Go to implementation(s) 跳转方法实现处  \nCtrl + Shift + I Open quick definition lookup 打开定义快速查找  \nAlt + Up/Down Go to previous/next method 跳转到上一个/下一个方法  \nCtrl+E 最近打开的文件  \nAlt+F1 查找代码所在位置  \nCtrl+Alt+L 格式化代码  \nCtrl+R 替换文本  \nCtrl+F 查找文本  \nCtrl+P 方法参数提示  \nF3 查找下一个  \nShift+F3 查找上一个  \nalt+Shift+F 将当前文件加入收藏夹  \nctrl+alt+s 打开配置窗口  \nctrl+Shift+N 通过文件名快速查找工程内的文件（必记）  \nctrl+Shift+alt+N 通过一个字符快速查找位置（必记）  \nShift+enter 重新开始一行（无论光标在哪个位置）  \nCtrl + Alt + T with…（if, else, try, catch, for, etc）用 * 来围绕选中的代码行，（ * 包括 if 、 while 、 try catch 等）  \nCtrl + Shift + U Toggle case for word at caret or selected block 光标所在位置大小写  \nCtrl + Delete Delete to word end 删除文字结束  \nCtrl + Backspace Delete to word start 删除文字开始  \nCtrl + E Recent files popup 弹出最近打开的文件  \nF11 Toggle bookmark 切换标记，我觉得叫书签更好，就是sublime text 的F2  \nCtrl + Shift + F12 Toggle maximizing editor 切换最大化编辑器  \nAlt + Shift + F Add to Favorites 添至收藏夹","slug":"jetbrains使用配置","published":1,"updated":"2019-07-24T01:26:56.666Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5o0001h9ka4kvfhq2zm","content":"<h3 id=\"需要新的license\"><a href=\"#需要新的license\" class=\"headerlink\" title=\"需要新的license\"></a>需要新的license</h3><p>选择server license<br>添加 <a href=\"http://idea.lanyus.com/\" target=\"_blank\" rel=\"noopener\">http://idea.lanyus.com/</a><br>点击 “ok”<br>成功添加<br>phpstorm10.03开始使用<a href=\"http://idea.qinxi1992.cn/\" target=\"_blank\" rel=\"noopener\">http://idea.qinxi1992.cn/</a><br>pycharm</p>\n<pre><code>43B4A73YYJ-eyJsaWNlbnNlSWQiOiI0M0I0QTczWVlKIiwibGljZW5zZWVOYW1lIjoibGFuIHl1IiwiYXNzaWduZWVOYW1lIjoiIiwiYXNzaWduZWVFbWFpbCI6IiIsImxpY2Vuc2VSZXN0cmljdGlvbiI6IkZvciBlZHVjYXRpb25hbCB1c2Ugb25seSIsImNoZWNrQ29uY3VycmVudFVzZSI6ZmFsc2UsInByb2R1Y3RzIjpbeyJjb2RlIjoiSUkiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJBQyIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IkRQTiIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlBTIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiRE0iLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJDTCIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlJTMCIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlJDIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiUEMiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJSTSIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IldTIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiREIiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJEQyIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9XSwiaGFzaCI6IjMzOTgyOTkvMCIsImdyYWNlUGVyaW9kRGF5cyI6MCwiYXV0b1Byb2xvbmdhdGVkIjpmYWxzZSwiaXNBdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlfQ==-keaxIkRgXPKE4BR/ZTs7s7UkP92LBxRe57HvWamu1EHVXTcV1B4f/KNQIrpOpN6dgpjig5eMVMPmo7yMPl+bmwQ8pTZaCGFuLqCHD1ngo6ywHKIQy0nR249sAUVaCl2wGJwaO4JeOh1opUx8chzSBVRZBMz0/MGyygi7duYAff9JQqfH3p/BhDTNM8eKl6z5tnneZ8ZG5bG1XvqFTqWk4FhGsEWdK7B+He44hPjBxKQl2gmZAodb6g9YxfTHhVRKQY5hQ7KPXNvh3ikerHkoaL5apgsVBZJOTDE2KdYTnGLmqxghFx6L0ofqKI6hMr48ergMyflDk6wLNGWJvYHLWw==-MIIEPjCCAiagAwIBAgIBBTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTE1MTEwMjA4MjE0OFoXDTE4MTEwMTA4MjE0OFowETEPMA0GA1UEAwwGcHJvZDN5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxcQkq+zdxlR2mmRYBPzGbUNdMN6OaXiXzxIWtMEkrJMO/5oUfQJbLLuMSMK0QHFmaI37WShyxZcfRCidwXjot4zmNBKnlyHodDij/78TmVqFl8nOeD5+07B8VEaIu7c3E1N+e1doC6wht4I4+IEmtsPAdoaj5WCQVQbrI8KeT8M9VcBIWX7fD0fhexfg3ZRt0xqwMcXGNp3DdJHiO0rCdU+Itv7EmtnSVq9jBG1usMSFvMowR25mju2JcPFp1+I4ZI+FqgR8gyG8oiNDyNEoAbsR3lOpI7grUYSvkB/xVy/VoklPCK2h0f0GJxFjnye8NT1PAywoyl7RmiAVRE/EKwIDAQABo4GZMIGWMAkGA1UdEwQCMAAwHQYDVR0OBBYEFGEpG9oZGcfLMGNBkY7SgHiMGgTcMEgGA1UdIwRBMD+AFKOetkhnQhI2Qb1t4Lm0oFKLl/GzoRykGjAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBggkA0myxg7KDeeEwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgWgMA0GCSqGSIb3DQEBCwUAA4ICAQC9WZuYgQedSuOc5TOUSrRigMw4/+wuC5EtZBfvdl4HT/8vzMW/oUlIP4YCvA0XKyBaCJ2iX+ZCDKoPfiYXiaSiH+HxAPV6J79vvouxKrWg2XV6ShFtPLP+0gPdGq3x9R3+kJbmAm8w+FOdlWqAfJrLvpzMGNeDU14YGXiZ9bVzmIQbwrBA+c/F4tlK/DV07dsNExihqFoibnqDiVNTGombaU2dDup2gwKdL81ua8EIcGNExHe82kjF4zwfadHk3bQVvbfdAwxcDy4xBjs3L4raPLU3yenSzr/OEur1+jfOxnQSmEcMXKXgrAQ9U55gwjcOFKrgOxEdek/Sk1VfOjvS+nuM4eyEruFMfaZHzoQiuw4IqgGc45ohFH0UUyjYcuFxxDSU9lMCv8qdHKm+wnPRb0l9l5vXsCBDuhAGYD6ss+Ga+aDY6f/qXZuUCEUOH3QUNbbCUlviSz6+GiRnt1kA9N2Qachl+2yBfaqUqr8h7Z2gsx5LcIf5kYNsqJ0GavXTVyWh7PYiKX4bs354ZQLUwwa/cG++2+wNWP+HtBhVxMRNTdVhSm38AknZlD+PTAsWGu9GyLmhti2EnVwGybSD2Dxmhxk3IPCkhKAK+pl0eWYGZWG3tJ9mZ7SowcXLWDFAk0lRJnKGFMTggrWjV8GYpw5bq23VmIqqDLgkNzuoog==</code></pre><h3 id=\"输入法问题\"><a href=\"#输入法问题\" class=\"headerlink\" title=\"输入法问题\"></a>输入法问题</h3><p>升级到ubuntu16.04后，输入无法使用<br>去安装目录bin文件夹下找到启动idea.sh,用编辑器打开，添加</p>\n<pre><code>XMODIFIERS=&quot;@im=fcitx&quot;\nexport XMODIFIERS</code></pre><p>在</p>\n<pre><code># ---------------------------------------------------------------------\n# Run the IDE.\n# ---------------------------------------------------------------------</code></pre><p>上面即可！</p>\n<h3 id=\"ubuntu安装\"><a href=\"#ubuntu安装\" class=\"headerlink\" title=\"ubuntu安装\"></a>ubuntu安装</h3><p>下载并压缩到/opt/目录下,并在/usr/share/appliactions/下创建快捷方式的文件，命名为phpstorm.desktop,编辑如下代码，保存</p>\n<pre><code>[Desktop Entry]\nCategories=Development;\nComment[zh_CN]=\nComment=\nExec=/opt/phpstorm/bin/phpstorm.sh\nGenericName[zh_CN]=IDE\nGenericName=IDE\nIcon=/opt/phpstorm/bin/webide.png\nName[zh_CN]=phpStorm\nName=phpStorm　　　　　　　\nPath=\nStartupNotify=true\nTerminal=false\nType=Application\nX-DBUS-ServiceName=\nX-DBUS-StartupType=\nX-KDE-SubstituteUID=false\nX-KDE-Username=Learn Programming</code></pre><h3 id=\"界面样式\"><a href=\"#界面样式\" class=\"headerlink\" title=\"界面样式\"></a>界面样式</h3><p><a href=\"https://github.com/jkaving/intellij-colors-solarized\" target=\"_blank\" rel=\"noopener\">theme</a><br><a href=\"https://github.com/ChrisRM/material-theme-jetbrains\" target=\"_blank\" rel=\"noopener\">背景修改，含theme</a></p>\n<h3 id=\"界面配置\"><a href=\"#界面配置\" class=\"headerlink\" title=\"界面配置\"></a>界面配置</h3><p>显示行号<br>Editor-&gt;General-&gt;Appearance-&gt;Show line number<br>关闭自动保存<br>Appearance&amp;Behavior-&gt;System settings-&gt;save files on frame deactivation 关闭<br>Editor-&gt;General-&gt;Editor tabs-&gt;Mark modified tabs with asterisk 勾选</p>\n<h3 id=\"theme安装\"><a href=\"#theme安装\" class=\"headerlink\" title=\"theme安装\"></a>theme安装</h3><p>安装模板下载<a href=\"http://phpstorm-themes.com/\" target=\"_blank\" rel=\"noopener\">http://phpstorm-themes.com/</a><br>ubuntu安装地址~/.pycharm/config/colors/ ###快捷键 Ctrl+/ 或 Ctrl+Shift+/ 注释（// 或者/<em>…</em>/ ）<br>Shift+F6 重构-重命名<br>Ctrl+X 删除行<br>Ctrl+D 复制行<br>Ctrl+G 查找行<br>Ctrl+Shift+Up/Down 代码向上/下移动。<br>F2 或Shift+F2 高亮错误或警告快速定位<br>写代码，按Tab 生成代码<br>选中文本，按Ctrl+Shift+F7 高亮显示所有该文本，按Esc高亮消失。(因为这个功能我就可以发放心的放弃sublime了)<br>Ctrl+B或Ctrl+鼠标左键单击 快速打开光标处的类或方法，（NB的功能）<br>Ctrl + Alt + B Go to implementation(s) 跳转方法实现处<br>Ctrl + Shift + I Open quick definition lookup 打开定义快速查找<br>Alt + Up/Down Go to previous/next method 跳转到上一个/下一个方法<br>Ctrl+E 最近打开的文件<br>Alt+F1 查找代码所在位置<br>Ctrl+Alt+L 格式化代码<br>Ctrl+R 替换文本<br>Ctrl+F 查找文本<br>Ctrl+P 方法参数提示<br>F3 查找下一个<br>Shift+F3 查找上一个<br>alt+Shift+F 将当前文件加入收藏夹<br>ctrl+alt+s 打开配置窗口<br>ctrl+Shift+N 通过文件名快速查找工程内的文件（必记）<br>ctrl+Shift+alt+N 通过一个字符快速查找位置（必记）<br>Shift+enter 重新开始一行（无论光标在哪个位置）<br>Ctrl + Alt + T with…（if, else, try, catch, for, etc）用 * 来围绕选中的代码行，（ * 包括 if 、 while 、 try catch 等）<br>Ctrl + Shift + U Toggle case for word at caret or selected block 光标所在位置大小写<br>Ctrl + Delete Delete to word end 删除文字结束<br>Ctrl + Backspace Delete to word start 删除文字开始<br>Ctrl + E Recent files popup 弹出最近打开的文件<br>F11 Toggle bookmark 切换标记，我觉得叫书签更好，就是sublime text 的F2<br>Ctrl + Shift + F12 Toggle maximizing editor 切换最大化编辑器<br>Alt + Shift + F Add to Favorites 添至收藏夹</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"需要新的license\"><a href=\"#需要新的license\" class=\"headerlink\" title=\"需要新的license\"></a>需要新的license</h3><p>选择server license<br>添加 <a href=\"http://idea.lanyus.com/\" target=\"_blank\" rel=\"noopener\">http://idea.lanyus.com/</a><br>点击 “ok”<br>成功添加<br>phpstorm10.03开始使用<a href=\"http://idea.qinxi1992.cn/\" target=\"_blank\" rel=\"noopener\">http://idea.qinxi1992.cn/</a><br>pycharm</p>\n<pre><code>43B4A73YYJ-eyJsaWNlbnNlSWQiOiI0M0I0QTczWVlKIiwibGljZW5zZWVOYW1lIjoibGFuIHl1IiwiYXNzaWduZWVOYW1lIjoiIiwiYXNzaWduZWVFbWFpbCI6IiIsImxpY2Vuc2VSZXN0cmljdGlvbiI6IkZvciBlZHVjYXRpb25hbCB1c2Ugb25seSIsImNoZWNrQ29uY3VycmVudFVzZSI6ZmFsc2UsInByb2R1Y3RzIjpbeyJjb2RlIjoiSUkiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJBQyIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IkRQTiIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlBTIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiRE0iLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJDTCIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlJTMCIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IlJDIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiUEMiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJSTSIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9LHsiY29kZSI6IldTIiwicGFpZFVwVG8iOiIyMDE3LTAyLTI1In0seyJjb2RlIjoiREIiLCJwYWlkVXBUbyI6IjIwMTctMDItMjUifSx7ImNvZGUiOiJEQyIsInBhaWRVcFRvIjoiMjAxNy0wMi0yNSJ9XSwiaGFzaCI6IjMzOTgyOTkvMCIsImdyYWNlUGVyaW9kRGF5cyI6MCwiYXV0b1Byb2xvbmdhdGVkIjpmYWxzZSwiaXNBdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlfQ==-keaxIkRgXPKE4BR/ZTs7s7UkP92LBxRe57HvWamu1EHVXTcV1B4f/KNQIrpOpN6dgpjig5eMVMPmo7yMPl+bmwQ8pTZaCGFuLqCHD1ngo6ywHKIQy0nR249sAUVaCl2wGJwaO4JeOh1opUx8chzSBVRZBMz0/MGyygi7duYAff9JQqfH3p/BhDTNM8eKl6z5tnneZ8ZG5bG1XvqFTqWk4FhGsEWdK7B+He44hPjBxKQl2gmZAodb6g9YxfTHhVRKQY5hQ7KPXNvh3ikerHkoaL5apgsVBZJOTDE2KdYTnGLmqxghFx6L0ofqKI6hMr48ergMyflDk6wLNGWJvYHLWw==-MIIEPjCCAiagAwIBAgIBBTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTE1MTEwMjA4MjE0OFoXDTE4MTEwMTA4MjE0OFowETEPMA0GA1UEAwwGcHJvZDN5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxcQkq+zdxlR2mmRYBPzGbUNdMN6OaXiXzxIWtMEkrJMO/5oUfQJbLLuMSMK0QHFmaI37WShyxZcfRCidwXjot4zmNBKnlyHodDij/78TmVqFl8nOeD5+07B8VEaIu7c3E1N+e1doC6wht4I4+IEmtsPAdoaj5WCQVQbrI8KeT8M9VcBIWX7fD0fhexfg3ZRt0xqwMcXGNp3DdJHiO0rCdU+Itv7EmtnSVq9jBG1usMSFvMowR25mju2JcPFp1+I4ZI+FqgR8gyG8oiNDyNEoAbsR3lOpI7grUYSvkB/xVy/VoklPCK2h0f0GJxFjnye8NT1PAywoyl7RmiAVRE/EKwIDAQABo4GZMIGWMAkGA1UdEwQCMAAwHQYDVR0OBBYEFGEpG9oZGcfLMGNBkY7SgHiMGgTcMEgGA1UdIwRBMD+AFKOetkhnQhI2Qb1t4Lm0oFKLl/GzoRykGjAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBggkA0myxg7KDeeEwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgWgMA0GCSqGSIb3DQEBCwUAA4ICAQC9WZuYgQedSuOc5TOUSrRigMw4/+wuC5EtZBfvdl4HT/8vzMW/oUlIP4YCvA0XKyBaCJ2iX+ZCDKoPfiYXiaSiH+HxAPV6J79vvouxKrWg2XV6ShFtPLP+0gPdGq3x9R3+kJbmAm8w+FOdlWqAfJrLvpzMGNeDU14YGXiZ9bVzmIQbwrBA+c/F4tlK/DV07dsNExihqFoibnqDiVNTGombaU2dDup2gwKdL81ua8EIcGNExHe82kjF4zwfadHk3bQVvbfdAwxcDy4xBjs3L4raPLU3yenSzr/OEur1+jfOxnQSmEcMXKXgrAQ9U55gwjcOFKrgOxEdek/Sk1VfOjvS+nuM4eyEruFMfaZHzoQiuw4IqgGc45ohFH0UUyjYcuFxxDSU9lMCv8qdHKm+wnPRb0l9l5vXsCBDuhAGYD6ss+Ga+aDY6f/qXZuUCEUOH3QUNbbCUlviSz6+GiRnt1kA9N2Qachl+2yBfaqUqr8h7Z2gsx5LcIf5kYNsqJ0GavXTVyWh7PYiKX4bs354ZQLUwwa/cG++2+wNWP+HtBhVxMRNTdVhSm38AknZlD+PTAsWGu9GyLmhti2EnVwGybSD2Dxmhxk3IPCkhKAK+pl0eWYGZWG3tJ9mZ7SowcXLWDFAk0lRJnKGFMTggrWjV8GYpw5bq23VmIqqDLgkNzuoog==</code></pre><h3 id=\"输入法问题\"><a href=\"#输入法问题\" class=\"headerlink\" title=\"输入法问题\"></a>输入法问题</h3><p>升级到ubuntu16.04后，输入无法使用<br>去安装目录bin文件夹下找到启动idea.sh,用编辑器打开，添加</p>\n<pre><code>XMODIFIERS=&quot;@im=fcitx&quot;\nexport XMODIFIERS</code></pre><p>在</p>\n<pre><code># ---------------------------------------------------------------------\n# Run the IDE.\n# ---------------------------------------------------------------------</code></pre><p>上面即可！</p>\n<h3 id=\"ubuntu安装\"><a href=\"#ubuntu安装\" class=\"headerlink\" title=\"ubuntu安装\"></a>ubuntu安装</h3><p>下载并压缩到/opt/目录下,并在/usr/share/appliactions/下创建快捷方式的文件，命名为phpstorm.desktop,编辑如下代码，保存</p>\n<pre><code>[Desktop Entry]\nCategories=Development;\nComment[zh_CN]=\nComment=\nExec=/opt/phpstorm/bin/phpstorm.sh\nGenericName[zh_CN]=IDE\nGenericName=IDE\nIcon=/opt/phpstorm/bin/webide.png\nName[zh_CN]=phpStorm\nName=phpStorm　　　　　　　\nPath=\nStartupNotify=true\nTerminal=false\nType=Application\nX-DBUS-ServiceName=\nX-DBUS-StartupType=\nX-KDE-SubstituteUID=false\nX-KDE-Username=Learn Programming</code></pre><h3 id=\"界面样式\"><a href=\"#界面样式\" class=\"headerlink\" title=\"界面样式\"></a>界面样式</h3><p><a href=\"https://github.com/jkaving/intellij-colors-solarized\" target=\"_blank\" rel=\"noopener\">theme</a><br><a href=\"https://github.com/ChrisRM/material-theme-jetbrains\" target=\"_blank\" rel=\"noopener\">背景修改，含theme</a></p>\n<h3 id=\"界面配置\"><a href=\"#界面配置\" class=\"headerlink\" title=\"界面配置\"></a>界面配置</h3><p>显示行号<br>Editor-&gt;General-&gt;Appearance-&gt;Show line number<br>关闭自动保存<br>Appearance&amp;Behavior-&gt;System settings-&gt;save files on frame deactivation 关闭<br>Editor-&gt;General-&gt;Editor tabs-&gt;Mark modified tabs with asterisk 勾选</p>\n<h3 id=\"theme安装\"><a href=\"#theme安装\" class=\"headerlink\" title=\"theme安装\"></a>theme安装</h3><p>安装模板下载<a href=\"http://phpstorm-themes.com/\" target=\"_blank\" rel=\"noopener\">http://phpstorm-themes.com/</a><br>ubuntu安装地址~/.pycharm/config/colors/ ###快捷键 Ctrl+/ 或 Ctrl+Shift+/ 注释（// 或者/<em>…</em>/ ）<br>Shift+F6 重构-重命名<br>Ctrl+X 删除行<br>Ctrl+D 复制行<br>Ctrl+G 查找行<br>Ctrl+Shift+Up/Down 代码向上/下移动。<br>F2 或Shift+F2 高亮错误或警告快速定位<br>写代码，按Tab 生成代码<br>选中文本，按Ctrl+Shift+F7 高亮显示所有该文本，按Esc高亮消失。(因为这个功能我就可以发放心的放弃sublime了)<br>Ctrl+B或Ctrl+鼠标左键单击 快速打开光标处的类或方法，（NB的功能）<br>Ctrl + Alt + B Go to implementation(s) 跳转方法实现处<br>Ctrl + Shift + I Open quick definition lookup 打开定义快速查找<br>Alt + Up/Down Go to previous/next method 跳转到上一个/下一个方法<br>Ctrl+E 最近打开的文件<br>Alt+F1 查找代码所在位置<br>Ctrl+Alt+L 格式化代码<br>Ctrl+R 替换文本<br>Ctrl+F 查找文本<br>Ctrl+P 方法参数提示<br>F3 查找下一个<br>Shift+F3 查找上一个<br>alt+Shift+F 将当前文件加入收藏夹<br>ctrl+alt+s 打开配置窗口<br>ctrl+Shift+N 通过文件名快速查找工程内的文件（必记）<br>ctrl+Shift+alt+N 通过一个字符快速查找位置（必记）<br>Shift+enter 重新开始一行（无论光标在哪个位置）<br>Ctrl + Alt + T with…（if, else, try, catch, for, etc）用 * 来围绕选中的代码行，（ * 包括 if 、 while 、 try catch 等）<br>Ctrl + Shift + U Toggle case for word at caret or selected block 光标所在位置大小写<br>Ctrl + Delete Delete to word end 删除文字结束<br>Ctrl + Backspace Delete to word start 删除文字开始<br>Ctrl + E Recent files popup 弹出最近打开的文件<br>F11 Toggle bookmark 切换标记，我觉得叫书签更好，就是sublime text 的F2<br>Ctrl + Shift + F12 Toggle maximizing editor 切换最大化编辑器<br>Alt + Shift + F Add to Favorites 添至收藏夹</p>\n"},{"title":"linux命令记录","url":"219.html","id":"219","comments":0,"date":"2017-11-08T06:41:40.000Z","_content":"\n#### 查看文件夹大小\n```shell\ndu -h your_path --max-depth=1\n```\n**参数：**\n> -a或-all 为每个指定文件显示磁盘使用情况，或者为目录中每个文件显示各自磁盘使用情况。 \n\n> -b或-bytes 显示目录或文件大小时，以byte为单位。 \n\n> -c或–total 除了显示目录或文件的大小外，同时也显示所有目录或文件的总和。 \n\n> -D或–dereference-args 显示指定符号连接的源文件大小。 \n\n> -h或–human-readable 以K，M，G为单位，提高信息的可读性。 \n\n> -H或–si 与-h参数相同，但是K，M，G是以1000为换算单位,而不是以1024为换算单位。 \n\n> -k或–kilobytes 以1024 bytes为单位。 \n\n> -l或–count-links 重复计算硬件连接的文件。 \n\n> -L<符号连接>或–dereference<符号连接> 显示选项中所指定符号连接的源文件大小。 \n\n> -m或–megabytes 以1MB为单位。 \n\n> -s或–summarize 仅显示总计，即当前目录的大小。 \n\n> -S或–separate-dirs 显示每个目录的大小时，并不含其子目录的大小。 \n\n> -x或–one-file-xystem 以一开始处理时的文件系统为准，若遇上其它不同的文件系统目录则略过。 \n\n> -X<文件>或–exclude-from=<文件> 在<文件>指定目录或文件。 \n\n> –exclude=<目录或文件> 略过指定的目录或文件。 \n\n> –max-depth=<目录层数> 超过指定层数的目录后，予以忽略。 \n\n> –help 显示帮助。 \n\n> –version 显示版本信息\n\n\n#### pkg-config\n**作用**\n> 检查库的版本号。如果所需要的库的版本不满足要求，它会打印出错误信息，避免链接错误版本的库文件。\n\n> 获得编译预处理参数，如宏定义，头文件的位置。\n\n> 获得链接参数，如库及依赖的其它库的位置，文件名及其它一些连接参数。\n\n> 自动加入所依赖的其它库的设置。\n\n**命令**\n```shell\n$ pkg-config --cflags --libs gdk-3.0\n-I/usr/include/gtk-3.0 -I/usr/include/pango-1.0 -I/usr/include/glib-2.0 -I/usr/lib/glib-2.0/include -I/usr/lib/libffi-3.2.1/include -I/usr/include/fribidi -I/usr/include/harfbuzz -I/usr/include/freetype2 -I/usr/include/libpng16 -I/usr/include/uuid -I/usr/include/cairo -I/usr/include/pixman-1 -I/usr/include/gdk-pixbuf-2.0 -I/usr/include/libmount -I/usr/include/blkid -I/usr/include/gio-unix-2.0 -pthread -I/usr/include/libdrm -lgdk-3 -lz -lpangocairo-1.0 -lpango-1.0 -lgdk_pixbuf-2.0 -lcairo-gobject -lcairo -lgobject-2.0 -lglib-2.0 \n```\n\n**PKG_CONFIG_PATH**\n环境变量PKG_CONFIG_PATH是用来设置.pc文件的搜索路径的，pkg-config按照设置路径的先后顺序进行搜索，直到找到指定的.pc 文件为止。这样，库的头文件的搜索路径的设置实际上就变成了对.pc文件搜索路径的设置。\n  \n在安装完一个需要使用的库后，比如Glib，一是将相应的.pc文件，如glib-2.0.pc拷贝到/usr/lib/pkgconfig目录下，二是通过设置环境变量PKG_CONFIG_PATH添加glib-2.0.pc文件的搜索路径。\n\n```shell\n# 添加环境变量PKG_CONFIG_PATH，在bash中应该进行如下设置：\n$ export PKG_CONFIG_PATH=/opt/gtk/lib/pkgconfig:$PKG_CONFIG_PATH\n```\n```shell\n# 可以执行下面的命令检查是否 /opt/gtk/lib/pkgconfig 路径已经设置在PKG_CONFIG_PATH环境变量中：\necho $PKG_CONFIG_PATH\n```\n\n**原理**\n正常情况下，库文件在编译通过后会生成prefix/lib/pkgconfig目录，目录下会包含.pc文件，例如：\n{% post_link c开发gtk+入门基础 安装gtk+ %}\n```shell\n$ ls -la /usr/include/gtk3.24/lib/pkgconfig\n总用量 40\ndrwxr-xr-x 2 root root 4096  7月 24 15:56 .\ndrwxr-xr-x 4 root root 4096  7月 24 15:56 ..\n-rw-r--r-- 1 root root  277  7月 24 15:56 gail-3.0.pc\n-rw-r--r-- 1 root root  608  7月 24 15:56 gdk-3.0.pc\n-rw-r--r-- 1 root root  608  7月 24 15:56 gdk-wayland-3.0.pc\n-rw-r--r-- 1 root root  608  7月 24 15:56 gdk-x11-3.0.pc\n-rw-r--r-- 1 root root  631  7月 24 15:56 gtk+-3.0.pc\n-rw-r--r-- 1 root root  405  7月 24 15:56 gtk+-unix-print-3.0.pc\n-rw-r--r-- 1 root root  631  7月 24 15:56 gtk+-wayland-3.0.pc\n-rw-r--r-- 1 root root  631  7月 24 15:56 gtk+-x11-3.0.pc\n```\n```shell\n$ vim gtk+-3.0\n\nprefix=/usr/include/gtk3.24\nexec_prefix=${prefix}\nlibdir=${exec_prefix}/lib\nincludedir=${prefix}/include\ntargets=x11 wayland\n \ngtk_binary_version=3.0.0\ngtk_host=x86_64-pc-linux-gnu\n \nName: GTK+\nDescription: GTK+ Graphical UI Library\nVersion: 3.24.10\nRequires: gdk-3.0 atk >= 2.15.1 cairo >= 1.14.0 cairo-gobject >= 1.14.0 gdk-pixbuf-2.0 >= 2.30.0 gio-2.0 >= 2.53.4                                                                                        \nRequires.private: atk atk-bridge-2.0 wayland-client >= 1.9.91 wayland-protocols >= 1.12 xkbcommon >= 0.2.0 wayland-cursor >= 1.9.91 wayland-egl  epoxy >= 1.4 fribidi >= 0.19.7 pangoft2 gio-unix-2.0 >= 2\nLibs: -L${libdir} -lgtk-3\nCflags: -I${includedir}/gtk-3.0\n```","source":"_posts/linux命令记录.md","raw":"---\ntitle: linux命令记录\nurl: 219.html\nid: 219\ncomments: false\ncategories:\n  - 运维\ndate: 2017-11-08 14:41:40\ntags:\n---\n\n#### 查看文件夹大小\n```shell\ndu -h your_path --max-depth=1\n```\n**参数：**\n> -a或-all 为每个指定文件显示磁盘使用情况，或者为目录中每个文件显示各自磁盘使用情况。 \n\n> -b或-bytes 显示目录或文件大小时，以byte为单位。 \n\n> -c或–total 除了显示目录或文件的大小外，同时也显示所有目录或文件的总和。 \n\n> -D或–dereference-args 显示指定符号连接的源文件大小。 \n\n> -h或–human-readable 以K，M，G为单位，提高信息的可读性。 \n\n> -H或–si 与-h参数相同，但是K，M，G是以1000为换算单位,而不是以1024为换算单位。 \n\n> -k或–kilobytes 以1024 bytes为单位。 \n\n> -l或–count-links 重复计算硬件连接的文件。 \n\n> -L<符号连接>或–dereference<符号连接> 显示选项中所指定符号连接的源文件大小。 \n\n> -m或–megabytes 以1MB为单位。 \n\n> -s或–summarize 仅显示总计，即当前目录的大小。 \n\n> -S或–separate-dirs 显示每个目录的大小时，并不含其子目录的大小。 \n\n> -x或–one-file-xystem 以一开始处理时的文件系统为准，若遇上其它不同的文件系统目录则略过。 \n\n> -X<文件>或–exclude-from=<文件> 在<文件>指定目录或文件。 \n\n> –exclude=<目录或文件> 略过指定的目录或文件。 \n\n> –max-depth=<目录层数> 超过指定层数的目录后，予以忽略。 \n\n> –help 显示帮助。 \n\n> –version 显示版本信息\n\n\n#### pkg-config\n**作用**\n> 检查库的版本号。如果所需要的库的版本不满足要求，它会打印出错误信息，避免链接错误版本的库文件。\n\n> 获得编译预处理参数，如宏定义，头文件的位置。\n\n> 获得链接参数，如库及依赖的其它库的位置，文件名及其它一些连接参数。\n\n> 自动加入所依赖的其它库的设置。\n\n**命令**\n```shell\n$ pkg-config --cflags --libs gdk-3.0\n-I/usr/include/gtk-3.0 -I/usr/include/pango-1.0 -I/usr/include/glib-2.0 -I/usr/lib/glib-2.0/include -I/usr/lib/libffi-3.2.1/include -I/usr/include/fribidi -I/usr/include/harfbuzz -I/usr/include/freetype2 -I/usr/include/libpng16 -I/usr/include/uuid -I/usr/include/cairo -I/usr/include/pixman-1 -I/usr/include/gdk-pixbuf-2.0 -I/usr/include/libmount -I/usr/include/blkid -I/usr/include/gio-unix-2.0 -pthread -I/usr/include/libdrm -lgdk-3 -lz -lpangocairo-1.0 -lpango-1.0 -lgdk_pixbuf-2.0 -lcairo-gobject -lcairo -lgobject-2.0 -lglib-2.0 \n```\n\n**PKG_CONFIG_PATH**\n环境变量PKG_CONFIG_PATH是用来设置.pc文件的搜索路径的，pkg-config按照设置路径的先后顺序进行搜索，直到找到指定的.pc 文件为止。这样，库的头文件的搜索路径的设置实际上就变成了对.pc文件搜索路径的设置。\n  \n在安装完一个需要使用的库后，比如Glib，一是将相应的.pc文件，如glib-2.0.pc拷贝到/usr/lib/pkgconfig目录下，二是通过设置环境变量PKG_CONFIG_PATH添加glib-2.0.pc文件的搜索路径。\n\n```shell\n# 添加环境变量PKG_CONFIG_PATH，在bash中应该进行如下设置：\n$ export PKG_CONFIG_PATH=/opt/gtk/lib/pkgconfig:$PKG_CONFIG_PATH\n```\n```shell\n# 可以执行下面的命令检查是否 /opt/gtk/lib/pkgconfig 路径已经设置在PKG_CONFIG_PATH环境变量中：\necho $PKG_CONFIG_PATH\n```\n\n**原理**\n正常情况下，库文件在编译通过后会生成prefix/lib/pkgconfig目录，目录下会包含.pc文件，例如：\n{% post_link c开发gtk+入门基础 安装gtk+ %}\n```shell\n$ ls -la /usr/include/gtk3.24/lib/pkgconfig\n总用量 40\ndrwxr-xr-x 2 root root 4096  7月 24 15:56 .\ndrwxr-xr-x 4 root root 4096  7月 24 15:56 ..\n-rw-r--r-- 1 root root  277  7月 24 15:56 gail-3.0.pc\n-rw-r--r-- 1 root root  608  7月 24 15:56 gdk-3.0.pc\n-rw-r--r-- 1 root root  608  7月 24 15:56 gdk-wayland-3.0.pc\n-rw-r--r-- 1 root root  608  7月 24 15:56 gdk-x11-3.0.pc\n-rw-r--r-- 1 root root  631  7月 24 15:56 gtk+-3.0.pc\n-rw-r--r-- 1 root root  405  7月 24 15:56 gtk+-unix-print-3.0.pc\n-rw-r--r-- 1 root root  631  7月 24 15:56 gtk+-wayland-3.0.pc\n-rw-r--r-- 1 root root  631  7月 24 15:56 gtk+-x11-3.0.pc\n```\n```shell\n$ vim gtk+-3.0\n\nprefix=/usr/include/gtk3.24\nexec_prefix=${prefix}\nlibdir=${exec_prefix}/lib\nincludedir=${prefix}/include\ntargets=x11 wayland\n \ngtk_binary_version=3.0.0\ngtk_host=x86_64-pc-linux-gnu\n \nName: GTK+\nDescription: GTK+ Graphical UI Library\nVersion: 3.24.10\nRequires: gdk-3.0 atk >= 2.15.1 cairo >= 1.14.0 cairo-gobject >= 1.14.0 gdk-pixbuf-2.0 >= 2.30.0 gio-2.0 >= 2.53.4                                                                                        \nRequires.private: atk atk-bridge-2.0 wayland-client >= 1.9.91 wayland-protocols >= 1.12 xkbcommon >= 0.2.0 wayland-cursor >= 1.9.91 wayland-egl  epoxy >= 1.4 fribidi >= 0.19.7 pangoft2 gio-unix-2.0 >= 2\nLibs: -L${libdir} -lgtk-3\nCflags: -I${includedir}/gtk-3.0\n```","slug":"linux命令记录","published":1,"updated":"2019-07-24T10:05:19.961Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5o1001i9ka43srn5zt6","content":"<h4 id=\"查看文件夹大小\"><a href=\"#查看文件夹大小\" class=\"headerlink\" title=\"查看文件夹大小\"></a>查看文件夹大小</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du -h your_path --max-depth=1</span><br></pre></td></tr></table></figure>\n\n<p><strong>参数：</strong></p>\n<blockquote>\n<p>-a或-all 为每个指定文件显示磁盘使用情况，或者为目录中每个文件显示各自磁盘使用情况。 </p>\n</blockquote>\n<blockquote>\n<p>-b或-bytes 显示目录或文件大小时，以byte为单位。 </p>\n</blockquote>\n<blockquote>\n<p>-c或–total 除了显示目录或文件的大小外，同时也显示所有目录或文件的总和。 </p>\n</blockquote>\n<blockquote>\n<p>-D或–dereference-args 显示指定符号连接的源文件大小。 </p>\n</blockquote>\n<blockquote>\n<p>-h或–human-readable 以K，M，G为单位，提高信息的可读性。 </p>\n</blockquote>\n<blockquote>\n<p>-H或–si 与-h参数相同，但是K，M，G是以1000为换算单位,而不是以1024为换算单位。 </p>\n</blockquote>\n<blockquote>\n<p>-k或–kilobytes 以1024 bytes为单位。 </p>\n</blockquote>\n<blockquote>\n<p>-l或–count-links 重复计算硬件连接的文件。 </p>\n</blockquote>\n<blockquote>\n<p>-L&lt;符号连接&gt;或–dereference&lt;符号连接&gt; 显示选项中所指定符号连接的源文件大小。 </p>\n</blockquote>\n<blockquote>\n<p>-m或–megabytes 以1MB为单位。 </p>\n</blockquote>\n<blockquote>\n<p>-s或–summarize 仅显示总计，即当前目录的大小。 </p>\n</blockquote>\n<blockquote>\n<p>-S或–separate-dirs 显示每个目录的大小时，并不含其子目录的大小。 </p>\n</blockquote>\n<blockquote>\n<p>-x或–one-file-xystem 以一开始处理时的文件系统为准，若遇上其它不同的文件系统目录则略过。 </p>\n</blockquote>\n<blockquote>\n<p>-X&lt;文件&gt;或–exclude-from=&lt;文件&gt; 在&lt;文件&gt;指定目录或文件。 </p>\n</blockquote>\n<blockquote>\n<p>–exclude=&lt;目录或文件&gt; 略过指定的目录或文件。 </p>\n</blockquote>\n<blockquote>\n<p>–max-depth=&lt;目录层数&gt; 超过指定层数的目录后，予以忽略。 </p>\n</blockquote>\n<blockquote>\n<p>–help 显示帮助。 </p>\n</blockquote>\n<blockquote>\n<p>–version 显示版本信息</p>\n</blockquote>\n<h4 id=\"pkg-config\"><a href=\"#pkg-config\" class=\"headerlink\" title=\"pkg-config\"></a>pkg-config</h4><p><strong>作用</strong></p>\n<blockquote>\n<p>检查库的版本号。如果所需要的库的版本不满足要求，它会打印出错误信息，避免链接错误版本的库文件。</p>\n</blockquote>\n<blockquote>\n<p>获得编译预处理参数，如宏定义，头文件的位置。</p>\n</blockquote>\n<blockquote>\n<p>获得链接参数，如库及依赖的其它库的位置，文件名及其它一些连接参数。</p>\n</blockquote>\n<blockquote>\n<p>自动加入所依赖的其它库的设置。</p>\n</blockquote>\n<p><strong>命令</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> pkg-config --cflags --libs gdk-3.0</span><br><span class=\"line\">-I/usr/include/gtk-3.0 -I/usr/include/pango-1.0 -I/usr/include/glib-2.0 -I/usr/lib/glib-2.0/include -I/usr/lib/libffi-3.2.1/include -I/usr/include/fribidi -I/usr/include/harfbuzz -I/usr/include/freetype2 -I/usr/include/libpng16 -I/usr/include/uuid -I/usr/include/cairo -I/usr/include/pixman-1 -I/usr/include/gdk-pixbuf-2.0 -I/usr/include/libmount -I/usr/include/blkid -I/usr/include/gio-unix-2.0 -pthread -I/usr/include/libdrm -lgdk-3 -lz -lpangocairo-1.0 -lpango-1.0 -lgdk_pixbuf-2.0 -lcairo-gobject -lcairo -lgobject-2.0 -lglib-2.0</span><br></pre></td></tr></table></figure>\n\n<p><strong>PKG_CONFIG_PATH</strong><br>环境变量PKG_CONFIG_PATH是用来设置.pc文件的搜索路径的，pkg-config按照设置路径的先后顺序进行搜索，直到找到指定的.pc 文件为止。这样，库的头文件的搜索路径的设置实际上就变成了对.pc文件搜索路径的设置。</p>\n<p>在安装完一个需要使用的库后，比如Glib，一是将相应的.pc文件，如glib-2.0.pc拷贝到/usr/lib/pkgconfig目录下，二是通过设置环境变量PKG_CONFIG_PATH添加glib-2.0.pc文件的搜索路径。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 添加环境变量PKG_CONFIG_PATH，在bash中应该进行如下设置：</span><br><span class=\"line\"><span class=\"meta\">$</span> export PKG_CONFIG_PATH=/opt/gtk/lib/pkgconfig:$PKG_CONFIG_PATH</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 可以执行下面的命令检查是否 /opt/gtk/lib/pkgconfig 路径已经设置在PKG_CONFIG_PATH环境变量中：</span><br><span class=\"line\">echo $PKG_CONFIG_PATH</span><br></pre></td></tr></table></figure>\n\n<p><strong>原理</strong><br>正常情况下，库文件在编译通过后会生成prefix/lib/pkgconfig目录，目录下会包含.pc文件，例如：</p>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ls -la /usr/include/gtk3.24/lib/pkgconfig</span><br><span class=\"line\">总用量 40</span><br><span class=\"line\">drwxr-xr-x 2 root root 4096  7月 24 15:56 .</span><br><span class=\"line\">drwxr-xr-x 4 root root 4096  7月 24 15:56 ..</span><br><span class=\"line\">-rw-r--r-- 1 root root  277  7月 24 15:56 gail-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  608  7月 24 15:56 gdk-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  608  7月 24 15:56 gdk-wayland-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  608  7月 24 15:56 gdk-x11-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  631  7月 24 15:56 gtk+-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  405  7月 24 15:56 gtk+-unix-print-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  631  7月 24 15:56 gtk+-wayland-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  631  7月 24 15:56 gtk+-x11-3.0.pc</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> vim gtk+-3.0</span><br><span class=\"line\"></span><br><span class=\"line\">prefix=/usr/include/gtk3.24</span><br><span class=\"line\">exec_prefix=$&#123;prefix&#125;</span><br><span class=\"line\">libdir=$&#123;exec_prefix&#125;/lib</span><br><span class=\"line\">includedir=$&#123;prefix&#125;/include</span><br><span class=\"line\">targets=x11 wayland</span><br><span class=\"line\"> </span><br><span class=\"line\">gtk_binary_version=3.0.0</span><br><span class=\"line\">gtk_host=x86_64-pc-linux-gnu</span><br><span class=\"line\"> </span><br><span class=\"line\">Name: GTK+</span><br><span class=\"line\">Description: GTK+ Graphical UI Library</span><br><span class=\"line\">Version: 3.24.10</span><br><span class=\"line\">Requires: gdk-3.0 atk &gt;= 2.15.1 cairo &gt;= 1.14.0 cairo-gobject &gt;= 1.14.0 gdk-pixbuf-2.0 &gt;= 2.30.0 gio-2.0 &gt;= 2.53.4                                                                                        </span><br><span class=\"line\">Requires.private: atk atk-bridge-2.0 wayland-client &gt;= 1.9.91 wayland-protocols &gt;= 1.12 xkbcommon &gt;= 0.2.0 wayland-cursor &gt;= 1.9.91 wayland-egl  epoxy &gt;= 1.4 fribidi &gt;= 0.19.7 pangoft2 gio-unix-2.0 &gt;= 2</span><br><span class=\"line\">Libs: -L$&#123;libdir&#125; -lgtk-3</span><br><span class=\"line\">Cflags: -I$&#123;includedir&#125;/gtk-3.0</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"查看文件夹大小\"><a href=\"#查看文件夹大小\" class=\"headerlink\" title=\"查看文件夹大小\"></a>查看文件夹大小</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">du -h your_path --max-depth=1</span><br></pre></td></tr></table></figure>\n\n<p><strong>参数：</strong></p>\n<blockquote>\n<p>-a或-all 为每个指定文件显示磁盘使用情况，或者为目录中每个文件显示各自磁盘使用情况。 </p>\n</blockquote>\n<blockquote>\n<p>-b或-bytes 显示目录或文件大小时，以byte为单位。 </p>\n</blockquote>\n<blockquote>\n<p>-c或–total 除了显示目录或文件的大小外，同时也显示所有目录或文件的总和。 </p>\n</blockquote>\n<blockquote>\n<p>-D或–dereference-args 显示指定符号连接的源文件大小。 </p>\n</blockquote>\n<blockquote>\n<p>-h或–human-readable 以K，M，G为单位，提高信息的可读性。 </p>\n</blockquote>\n<blockquote>\n<p>-H或–si 与-h参数相同，但是K，M，G是以1000为换算单位,而不是以1024为换算单位。 </p>\n</blockquote>\n<blockquote>\n<p>-k或–kilobytes 以1024 bytes为单位。 </p>\n</blockquote>\n<blockquote>\n<p>-l或–count-links 重复计算硬件连接的文件。 </p>\n</blockquote>\n<blockquote>\n<p>-L&lt;符号连接&gt;或–dereference&lt;符号连接&gt; 显示选项中所指定符号连接的源文件大小。 </p>\n</blockquote>\n<blockquote>\n<p>-m或–megabytes 以1MB为单位。 </p>\n</blockquote>\n<blockquote>\n<p>-s或–summarize 仅显示总计，即当前目录的大小。 </p>\n</blockquote>\n<blockquote>\n<p>-S或–separate-dirs 显示每个目录的大小时，并不含其子目录的大小。 </p>\n</blockquote>\n<blockquote>\n<p>-x或–one-file-xystem 以一开始处理时的文件系统为准，若遇上其它不同的文件系统目录则略过。 </p>\n</blockquote>\n<blockquote>\n<p>-X&lt;文件&gt;或–exclude-from=&lt;文件&gt; 在&lt;文件&gt;指定目录或文件。 </p>\n</blockquote>\n<blockquote>\n<p>–exclude=&lt;目录或文件&gt; 略过指定的目录或文件。 </p>\n</blockquote>\n<blockquote>\n<p>–max-depth=&lt;目录层数&gt; 超过指定层数的目录后，予以忽略。 </p>\n</blockquote>\n<blockquote>\n<p>–help 显示帮助。 </p>\n</blockquote>\n<blockquote>\n<p>–version 显示版本信息</p>\n</blockquote>\n<h4 id=\"pkg-config\"><a href=\"#pkg-config\" class=\"headerlink\" title=\"pkg-config\"></a>pkg-config</h4><p><strong>作用</strong></p>\n<blockquote>\n<p>检查库的版本号。如果所需要的库的版本不满足要求，它会打印出错误信息，避免链接错误版本的库文件。</p>\n</blockquote>\n<blockquote>\n<p>获得编译预处理参数，如宏定义，头文件的位置。</p>\n</blockquote>\n<blockquote>\n<p>获得链接参数，如库及依赖的其它库的位置，文件名及其它一些连接参数。</p>\n</blockquote>\n<blockquote>\n<p>自动加入所依赖的其它库的设置。</p>\n</blockquote>\n<p><strong>命令</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> pkg-config --cflags --libs gdk-3.0</span><br><span class=\"line\">-I/usr/include/gtk-3.0 -I/usr/include/pango-1.0 -I/usr/include/glib-2.0 -I/usr/lib/glib-2.0/include -I/usr/lib/libffi-3.2.1/include -I/usr/include/fribidi -I/usr/include/harfbuzz -I/usr/include/freetype2 -I/usr/include/libpng16 -I/usr/include/uuid -I/usr/include/cairo -I/usr/include/pixman-1 -I/usr/include/gdk-pixbuf-2.0 -I/usr/include/libmount -I/usr/include/blkid -I/usr/include/gio-unix-2.0 -pthread -I/usr/include/libdrm -lgdk-3 -lz -lpangocairo-1.0 -lpango-1.0 -lgdk_pixbuf-2.0 -lcairo-gobject -lcairo -lgobject-2.0 -lglib-2.0</span><br></pre></td></tr></table></figure>\n\n<p><strong>PKG_CONFIG_PATH</strong><br>环境变量PKG_CONFIG_PATH是用来设置.pc文件的搜索路径的，pkg-config按照设置路径的先后顺序进行搜索，直到找到指定的.pc 文件为止。这样，库的头文件的搜索路径的设置实际上就变成了对.pc文件搜索路径的设置。</p>\n<p>在安装完一个需要使用的库后，比如Glib，一是将相应的.pc文件，如glib-2.0.pc拷贝到/usr/lib/pkgconfig目录下，二是通过设置环境变量PKG_CONFIG_PATH添加glib-2.0.pc文件的搜索路径。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 添加环境变量PKG_CONFIG_PATH，在bash中应该进行如下设置：</span><br><span class=\"line\"><span class=\"meta\">$</span> export PKG_CONFIG_PATH=/opt/gtk/lib/pkgconfig:$PKG_CONFIG_PATH</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 可以执行下面的命令检查是否 /opt/gtk/lib/pkgconfig 路径已经设置在PKG_CONFIG_PATH环境变量中：</span><br><span class=\"line\">echo $PKG_CONFIG_PATH</span><br></pre></td></tr></table></figure>\n\n<p><strong>原理</strong><br>正常情况下，库文件在编译通过后会生成prefix/lib/pkgconfig目录，目录下会包含.pc文件，例如：</p>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> ls -la /usr/include/gtk3.24/lib/pkgconfig</span><br><span class=\"line\">总用量 40</span><br><span class=\"line\">drwxr-xr-x 2 root root 4096  7月 24 15:56 .</span><br><span class=\"line\">drwxr-xr-x 4 root root 4096  7月 24 15:56 ..</span><br><span class=\"line\">-rw-r--r-- 1 root root  277  7月 24 15:56 gail-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  608  7月 24 15:56 gdk-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  608  7月 24 15:56 gdk-wayland-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  608  7月 24 15:56 gdk-x11-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  631  7月 24 15:56 gtk+-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  405  7月 24 15:56 gtk+-unix-print-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  631  7月 24 15:56 gtk+-wayland-3.0.pc</span><br><span class=\"line\">-rw-r--r-- 1 root root  631  7月 24 15:56 gtk+-x11-3.0.pc</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> vim gtk+-3.0</span><br><span class=\"line\"></span><br><span class=\"line\">prefix=/usr/include/gtk3.24</span><br><span class=\"line\">exec_prefix=$&#123;prefix&#125;</span><br><span class=\"line\">libdir=$&#123;exec_prefix&#125;/lib</span><br><span class=\"line\">includedir=$&#123;prefix&#125;/include</span><br><span class=\"line\">targets=x11 wayland</span><br><span class=\"line\"> </span><br><span class=\"line\">gtk_binary_version=3.0.0</span><br><span class=\"line\">gtk_host=x86_64-pc-linux-gnu</span><br><span class=\"line\"> </span><br><span class=\"line\">Name: GTK+</span><br><span class=\"line\">Description: GTK+ Graphical UI Library</span><br><span class=\"line\">Version: 3.24.10</span><br><span class=\"line\">Requires: gdk-3.0 atk &gt;= 2.15.1 cairo &gt;= 1.14.0 cairo-gobject &gt;= 1.14.0 gdk-pixbuf-2.0 &gt;= 2.30.0 gio-2.0 &gt;= 2.53.4                                                                                        </span><br><span class=\"line\">Requires.private: atk atk-bridge-2.0 wayland-client &gt;= 1.9.91 wayland-protocols &gt;= 1.12 xkbcommon &gt;= 0.2.0 wayland-cursor &gt;= 1.9.91 wayland-egl  epoxy &gt;= 1.4 fribidi &gt;= 0.19.7 pangoft2 gio-unix-2.0 &gt;= 2</span><br><span class=\"line\">Libs: -L$&#123;libdir&#125; -lgtk-3</span><br><span class=\"line\">Cflags: -I$&#123;includedir&#125;/gtk-3.0</span><br></pre></td></tr></table></figure>"},{"title":"mysql主从复制","url":"45.html","id":"45","comments":0,"date":"2016-11-09T06:34:49.000Z","_content":"\n### 测试环境\n\n主服务器  \n192.168.0.160 mysql 5.6.17 win2008R2  \n从服务器  \n192.168.0.206 mysql 5.6.12 win2003\n\n### 主服务器创建数据库test1, test2\n\n    mysql>CREATE DATABASE `test1` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     \n    mysql>USE test1\n    mysql>CREATE TABLE `test1`.`user` ( `id` INT(10) NOT NULL AUTO_INCREMENT , `name` VARCHAR(100) NOT NULL , PRIMARY KEY (`id`)) ENGINE = MyISAM;  \n    mysql>INSERT INTO `user` (`id`, `name`) VALUES (NULL, 'user1'), (NULL, 'user2')\n    \n\n    mysql>CREATE DATABASE `test2` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;    \n    mysql>USE test2\n    mysql>CREATE TABLE `test2`.`user` ( `id` INT(10) NOT NULL AUTO_INCREMENT , `name` VARCHAR(100) NOT NULL , PRIMARY KEY (`id`)) ENGINE = MyISAM;  \n    mysql>INSERT INTO `user` (`id`, `name`) VALUES (NULL, 'user1'), (NULL, 'user2')\n    \n\n### 将test1,test2 复制到从服务器上\n\n    mysql>CREATE DATABASE `test1` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     \n    mysql>USE test1  \n    mysql>set names utf8;  \n    mysql>source c:/test1.sql;\n    mysql>CREATE DATABASE `test2` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     \n    mysql>USE test2  \n    mysql>set names utf8;  \n    mysql>source c:/test2.sql;\n    \n\n### 主服务器配置\n\n编辑配置文件my.ini\n\n    [mysqld] \n    server-id=1     # 配一个唯一的ID编号，1至32  \n    log-bin=mysql-bin  # 二进制文件存放路径  \n    binlog-do-db=test1  # 需要同步的数据库名  \n    binlog-ignore-db=test2  # 不需要同步的数据库名\n    \n\n重启mysql并重新登陆，创建授权用户\n\n    mysql>grant REPLICATION SLAVE,RELOAD,SUPER on *.* to slave@192.168.0.206 identified by '123456' ;  \n    mysql>grant REPLICATION SLAVE,RELOAD,SUPER on *.* to slave1@192.168.0.118 identified by '123456' ; # 如果是多从\n    mysql>flush privileges;     \n    mysql>show master status;  # 找到File 和 Position 的值记录下来    \n    \n\n![](http://7xq3ry.com1.z0.glb.clouddn.com/20160401152254.png)\n\n### 从服务器配置192.168.0.206\n\n编辑配置文件my.ini添加\n\n    [mysqld]\n    server-id=2     #唯一\n    replicate-do-db=test1\n    replicate-ignore-db=test2\n    \n\n重启数据库并重新登陆\n\n    mysql>mysql -uroot -p  \n    mysql>change master to master_host='192.168.0.160',master_user='slave',master_password='123456', master_log_file='mysql-bin.000001',master_log_pos=199;  \n    mysql>start slave;\n    mysql>show slave status\\G\n    \n\n结果出现一下内容表示成功\n\n    Slave_IO_Running: Yes\n    Slave_SQL_Running: Yes\n    \n\n![](http://7xq3ry.com1.z0.glb.clouddn.com/20160401152538.png) 多从，另一个从服务器配置192.168.0.118  \n编辑配置文件my.ini添加\n\n    [mysqld]\n    server-id=3     #唯一，注意和其他的从服务器不一致\n    replicate-do-db=test1\n    replicate-ignore-db=test2\n    \n\n重启mysql并重新登陆，创建授权用户\n\n    mysql>change master to master_host='192.168.0.160',master_user='slave1',master_password='123456', master_log_file='mysql-bin.000001',master_log_pos=199;  \n    mysql>start slave;\n    mysql>show slave status\\G    \n    \n\n### 最后测试\n\n在主服务器添加表和数据，可以看到从服务器数据库已经修改。  \n重启主从数据库，依然可以正常同步。\n\n### 错误处理办法\n\n连接不上master：  \n1，密码是否正确，是否给予权限  \n2，防火墙是否开启3306端口 配置的时候注意锁表\n\n    LOCK TABLES\n    \n\n    UNLOCK TABLES;\n    \n\n错误提示 Got fatal error 1236 from master when reading data from binary log: 'Slave can not handle replication events with the checksum that master is configured to log; the first event 'mysql-bin.000002' at 120, the last event read from './mysql-bin.000002' at 120, the last byte read from './mysql-bin.000002' at 120 由于主库是5.6, 从库是5.5.  \n5.6的版本中加入了replication event checksum，主从复制时间校验功能，所以需要把这个关掉才能正常同步到5.5的slave 修改主库\n\n    sudo vim /etc/my.cnf\n    binlog_checksum=none\n    \n\n重新配置主从即可","source":"_posts/mysql主从复制.md","raw":"---\ntitle: mysql主从复制\ntags:\n  - mysql\nurl: 45.html\nid: 45\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-09 14:34:49\n---\n\n### 测试环境\n\n主服务器  \n192.168.0.160 mysql 5.6.17 win2008R2  \n从服务器  \n192.168.0.206 mysql 5.6.12 win2003\n\n### 主服务器创建数据库test1, test2\n\n    mysql>CREATE DATABASE `test1` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     \n    mysql>USE test1\n    mysql>CREATE TABLE `test1`.`user` ( `id` INT(10) NOT NULL AUTO_INCREMENT , `name` VARCHAR(100) NOT NULL , PRIMARY KEY (`id`)) ENGINE = MyISAM;  \n    mysql>INSERT INTO `user` (`id`, `name`) VALUES (NULL, 'user1'), (NULL, 'user2')\n    \n\n    mysql>CREATE DATABASE `test2` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;    \n    mysql>USE test2\n    mysql>CREATE TABLE `test2`.`user` ( `id` INT(10) NOT NULL AUTO_INCREMENT , `name` VARCHAR(100) NOT NULL , PRIMARY KEY (`id`)) ENGINE = MyISAM;  \n    mysql>INSERT INTO `user` (`id`, `name`) VALUES (NULL, 'user1'), (NULL, 'user2')\n    \n\n### 将test1,test2 复制到从服务器上\n\n    mysql>CREATE DATABASE `test1` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     \n    mysql>USE test1  \n    mysql>set names utf8;  \n    mysql>source c:/test1.sql;\n    mysql>CREATE DATABASE `test2` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     \n    mysql>USE test2  \n    mysql>set names utf8;  \n    mysql>source c:/test2.sql;\n    \n\n### 主服务器配置\n\n编辑配置文件my.ini\n\n    [mysqld] \n    server-id=1     # 配一个唯一的ID编号，1至32  \n    log-bin=mysql-bin  # 二进制文件存放路径  \n    binlog-do-db=test1  # 需要同步的数据库名  \n    binlog-ignore-db=test2  # 不需要同步的数据库名\n    \n\n重启mysql并重新登陆，创建授权用户\n\n    mysql>grant REPLICATION SLAVE,RELOAD,SUPER on *.* to slave@192.168.0.206 identified by '123456' ;  \n    mysql>grant REPLICATION SLAVE,RELOAD,SUPER on *.* to slave1@192.168.0.118 identified by '123456' ; # 如果是多从\n    mysql>flush privileges;     \n    mysql>show master status;  # 找到File 和 Position 的值记录下来    \n    \n\n![](http://7xq3ry.com1.z0.glb.clouddn.com/20160401152254.png)\n\n### 从服务器配置192.168.0.206\n\n编辑配置文件my.ini添加\n\n    [mysqld]\n    server-id=2     #唯一\n    replicate-do-db=test1\n    replicate-ignore-db=test2\n    \n\n重启数据库并重新登陆\n\n    mysql>mysql -uroot -p  \n    mysql>change master to master_host='192.168.0.160',master_user='slave',master_password='123456', master_log_file='mysql-bin.000001',master_log_pos=199;  \n    mysql>start slave;\n    mysql>show slave status\\G\n    \n\n结果出现一下内容表示成功\n\n    Slave_IO_Running: Yes\n    Slave_SQL_Running: Yes\n    \n\n![](http://7xq3ry.com1.z0.glb.clouddn.com/20160401152538.png) 多从，另一个从服务器配置192.168.0.118  \n编辑配置文件my.ini添加\n\n    [mysqld]\n    server-id=3     #唯一，注意和其他的从服务器不一致\n    replicate-do-db=test1\n    replicate-ignore-db=test2\n    \n\n重启mysql并重新登陆，创建授权用户\n\n    mysql>change master to master_host='192.168.0.160',master_user='slave1',master_password='123456', master_log_file='mysql-bin.000001',master_log_pos=199;  \n    mysql>start slave;\n    mysql>show slave status\\G    \n    \n\n### 最后测试\n\n在主服务器添加表和数据，可以看到从服务器数据库已经修改。  \n重启主从数据库，依然可以正常同步。\n\n### 错误处理办法\n\n连接不上master：  \n1，密码是否正确，是否给予权限  \n2，防火墙是否开启3306端口 配置的时候注意锁表\n\n    LOCK TABLES\n    \n\n    UNLOCK TABLES;\n    \n\n错误提示 Got fatal error 1236 from master when reading data from binary log: 'Slave can not handle replication events with the checksum that master is configured to log; the first event 'mysql-bin.000002' at 120, the last event read from './mysql-bin.000002' at 120, the last byte read from './mysql-bin.000002' at 120 由于主库是5.6, 从库是5.5.  \n5.6的版本中加入了replication event checksum，主从复制时间校验功能，所以需要把这个关掉才能正常同步到5.5的slave 修改主库\n\n    sudo vim /etc/my.cnf\n    binlog_checksum=none\n    \n\n重新配置主从即可","slug":"mysql主从复制","published":1,"updated":"2019-07-24T01:27:38.890Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5o2001m9ka46hwrdc2s","content":"<h3 id=\"测试环境\"><a href=\"#测试环境\" class=\"headerlink\" title=\"测试环境\"></a>测试环境</h3><p>主服务器<br>192.168.0.160 mysql 5.6.17 win2008R2<br>从服务器<br>192.168.0.206 mysql 5.6.12 win2003</p>\n<h3 id=\"主服务器创建数据库test1-test2\"><a href=\"#主服务器创建数据库test1-test2\" class=\"headerlink\" title=\"主服务器创建数据库test1, test2\"></a>主服务器创建数据库test1, test2</h3><pre><code>mysql&gt;CREATE DATABASE `test1` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     \nmysql&gt;USE test1\nmysql&gt;CREATE TABLE `test1`.`user` ( `id` INT(10) NOT NULL AUTO_INCREMENT , `name` VARCHAR(100) NOT NULL , PRIMARY KEY (`id`)) ENGINE = MyISAM;  \nmysql&gt;INSERT INTO `user` (`id`, `name`) VALUES (NULL, &apos;user1&apos;), (NULL, &apos;user2&apos;)\n\n\nmysql&gt;CREATE DATABASE `test2` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;    \nmysql&gt;USE test2\nmysql&gt;CREATE TABLE `test2`.`user` ( `id` INT(10) NOT NULL AUTO_INCREMENT , `name` VARCHAR(100) NOT NULL , PRIMARY KEY (`id`)) ENGINE = MyISAM;  \nmysql&gt;INSERT INTO `user` (`id`, `name`) VALUES (NULL, &apos;user1&apos;), (NULL, &apos;user2&apos;)</code></pre><h3 id=\"将test1-test2-复制到从服务器上\"><a href=\"#将test1-test2-复制到从服务器上\" class=\"headerlink\" title=\"将test1,test2 复制到从服务器上\"></a>将test1,test2 复制到从服务器上</h3><pre><code>mysql&gt;CREATE DATABASE `test1` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     \nmysql&gt;USE test1  \nmysql&gt;set names utf8;  \nmysql&gt;source c:/test1.sql;\nmysql&gt;CREATE DATABASE `test2` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     \nmysql&gt;USE test2  \nmysql&gt;set names utf8;  \nmysql&gt;source c:/test2.sql;</code></pre><h3 id=\"主服务器配置\"><a href=\"#主服务器配置\" class=\"headerlink\" title=\"主服务器配置\"></a>主服务器配置</h3><p>编辑配置文件my.ini</p>\n<pre><code>[mysqld] \nserver-id=1     # 配一个唯一的ID编号，1至32  \nlog-bin=mysql-bin  # 二进制文件存放路径  \nbinlog-do-db=test1  # 需要同步的数据库名  \nbinlog-ignore-db=test2  # 不需要同步的数据库名</code></pre><p>重启mysql并重新登陆，创建授权用户</p>\n<pre><code>mysql&gt;grant REPLICATION SLAVE,RELOAD,SUPER on *.* to slave@192.168.0.206 identified by &apos;123456&apos; ;  \nmysql&gt;grant REPLICATION SLAVE,RELOAD,SUPER on *.* to slave1@192.168.0.118 identified by &apos;123456&apos; ; # 如果是多从\nmysql&gt;flush privileges;     \nmysql&gt;show master status;  # 找到File 和 Position 的值记录下来    </code></pre><p><img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160401152254.png\" alt></p>\n<h3 id=\"从服务器配置192-168-0-206\"><a href=\"#从服务器配置192-168-0-206\" class=\"headerlink\" title=\"从服务器配置192.168.0.206\"></a>从服务器配置192.168.0.206</h3><p>编辑配置文件my.ini添加</p>\n<pre><code>[mysqld]\nserver-id=2     #唯一\nreplicate-do-db=test1\nreplicate-ignore-db=test2</code></pre><p>重启数据库并重新登陆</p>\n<pre><code>mysql&gt;mysql -uroot -p  \nmysql&gt;change master to master_host=&apos;192.168.0.160&apos;,master_user=&apos;slave&apos;,master_password=&apos;123456&apos;, master_log_file=&apos;mysql-bin.000001&apos;,master_log_pos=199;  \nmysql&gt;start slave;\nmysql&gt;show slave status\\G</code></pre><p>结果出现一下内容表示成功</p>\n<pre><code>Slave_IO_Running: Yes\nSlave_SQL_Running: Yes</code></pre><p><img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160401152538.png\" alt> 多从，另一个从服务器配置192.168.0.118<br>编辑配置文件my.ini添加</p>\n<pre><code>[mysqld]\nserver-id=3     #唯一，注意和其他的从服务器不一致\nreplicate-do-db=test1\nreplicate-ignore-db=test2</code></pre><p>重启mysql并重新登陆，创建授权用户</p>\n<pre><code>mysql&gt;change master to master_host=&apos;192.168.0.160&apos;,master_user=&apos;slave1&apos;,master_password=&apos;123456&apos;, master_log_file=&apos;mysql-bin.000001&apos;,master_log_pos=199;  \nmysql&gt;start slave;\nmysql&gt;show slave status\\G    </code></pre><h3 id=\"最后测试\"><a href=\"#最后测试\" class=\"headerlink\" title=\"最后测试\"></a>最后测试</h3><p>在主服务器添加表和数据，可以看到从服务器数据库已经修改。<br>重启主从数据库，依然可以正常同步。</p>\n<h3 id=\"错误处理办法\"><a href=\"#错误处理办法\" class=\"headerlink\" title=\"错误处理办法\"></a>错误处理办法</h3><p>连接不上master：<br>1，密码是否正确，是否给予权限<br>2，防火墙是否开启3306端口 配置的时候注意锁表</p>\n<pre><code>LOCK TABLES\n\n\nUNLOCK TABLES;</code></pre><p>错误提示 Got fatal error 1236 from master when reading data from binary log: ‘Slave can not handle replication events with the checksum that master is configured to log; the first event ‘mysql-bin.000002’ at 120, the last event read from ‘./mysql-bin.000002’ at 120, the last byte read from ‘./mysql-bin.000002’ at 120 由于主库是5.6, 从库是5.5.<br>5.6的版本中加入了replication event checksum，主从复制时间校验功能，所以需要把这个关掉才能正常同步到5.5的slave 修改主库</p>\n<pre><code>sudo vim /etc/my.cnf\nbinlog_checksum=none</code></pre><p>重新配置主从即可</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"测试环境\"><a href=\"#测试环境\" class=\"headerlink\" title=\"测试环境\"></a>测试环境</h3><p>主服务器<br>192.168.0.160 mysql 5.6.17 win2008R2<br>从服务器<br>192.168.0.206 mysql 5.6.12 win2003</p>\n<h3 id=\"主服务器创建数据库test1-test2\"><a href=\"#主服务器创建数据库test1-test2\" class=\"headerlink\" title=\"主服务器创建数据库test1, test2\"></a>主服务器创建数据库test1, test2</h3><pre><code>mysql&gt;CREATE DATABASE `test1` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     \nmysql&gt;USE test1\nmysql&gt;CREATE TABLE `test1`.`user` ( `id` INT(10) NOT NULL AUTO_INCREMENT , `name` VARCHAR(100) NOT NULL , PRIMARY KEY (`id`)) ENGINE = MyISAM;  \nmysql&gt;INSERT INTO `user` (`id`, `name`) VALUES (NULL, &apos;user1&apos;), (NULL, &apos;user2&apos;)\n\n\nmysql&gt;CREATE DATABASE `test2` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;    \nmysql&gt;USE test2\nmysql&gt;CREATE TABLE `test2`.`user` ( `id` INT(10) NOT NULL AUTO_INCREMENT , `name` VARCHAR(100) NOT NULL , PRIMARY KEY (`id`)) ENGINE = MyISAM;  \nmysql&gt;INSERT INTO `user` (`id`, `name`) VALUES (NULL, &apos;user1&apos;), (NULL, &apos;user2&apos;)</code></pre><h3 id=\"将test1-test2-复制到从服务器上\"><a href=\"#将test1-test2-复制到从服务器上\" class=\"headerlink\" title=\"将test1,test2 复制到从服务器上\"></a>将test1,test2 复制到从服务器上</h3><pre><code>mysql&gt;CREATE DATABASE `test1` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     \nmysql&gt;USE test1  \nmysql&gt;set names utf8;  \nmysql&gt;source c:/test1.sql;\nmysql&gt;CREATE DATABASE `test2` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;     \nmysql&gt;USE test2  \nmysql&gt;set names utf8;  \nmysql&gt;source c:/test2.sql;</code></pre><h3 id=\"主服务器配置\"><a href=\"#主服务器配置\" class=\"headerlink\" title=\"主服务器配置\"></a>主服务器配置</h3><p>编辑配置文件my.ini</p>\n<pre><code>[mysqld] \nserver-id=1     # 配一个唯一的ID编号，1至32  \nlog-bin=mysql-bin  # 二进制文件存放路径  \nbinlog-do-db=test1  # 需要同步的数据库名  \nbinlog-ignore-db=test2  # 不需要同步的数据库名</code></pre><p>重启mysql并重新登陆，创建授权用户</p>\n<pre><code>mysql&gt;grant REPLICATION SLAVE,RELOAD,SUPER on *.* to slave@192.168.0.206 identified by &apos;123456&apos; ;  \nmysql&gt;grant REPLICATION SLAVE,RELOAD,SUPER on *.* to slave1@192.168.0.118 identified by &apos;123456&apos; ; # 如果是多从\nmysql&gt;flush privileges;     \nmysql&gt;show master status;  # 找到File 和 Position 的值记录下来    </code></pre><p><img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160401152254.png\" alt></p>\n<h3 id=\"从服务器配置192-168-0-206\"><a href=\"#从服务器配置192-168-0-206\" class=\"headerlink\" title=\"从服务器配置192.168.0.206\"></a>从服务器配置192.168.0.206</h3><p>编辑配置文件my.ini添加</p>\n<pre><code>[mysqld]\nserver-id=2     #唯一\nreplicate-do-db=test1\nreplicate-ignore-db=test2</code></pre><p>重启数据库并重新登陆</p>\n<pre><code>mysql&gt;mysql -uroot -p  \nmysql&gt;change master to master_host=&apos;192.168.0.160&apos;,master_user=&apos;slave&apos;,master_password=&apos;123456&apos;, master_log_file=&apos;mysql-bin.000001&apos;,master_log_pos=199;  \nmysql&gt;start slave;\nmysql&gt;show slave status\\G</code></pre><p>结果出现一下内容表示成功</p>\n<pre><code>Slave_IO_Running: Yes\nSlave_SQL_Running: Yes</code></pre><p><img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160401152538.png\" alt> 多从，另一个从服务器配置192.168.0.118<br>编辑配置文件my.ini添加</p>\n<pre><code>[mysqld]\nserver-id=3     #唯一，注意和其他的从服务器不一致\nreplicate-do-db=test1\nreplicate-ignore-db=test2</code></pre><p>重启mysql并重新登陆，创建授权用户</p>\n<pre><code>mysql&gt;change master to master_host=&apos;192.168.0.160&apos;,master_user=&apos;slave1&apos;,master_password=&apos;123456&apos;, master_log_file=&apos;mysql-bin.000001&apos;,master_log_pos=199;  \nmysql&gt;start slave;\nmysql&gt;show slave status\\G    </code></pre><h3 id=\"最后测试\"><a href=\"#最后测试\" class=\"headerlink\" title=\"最后测试\"></a>最后测试</h3><p>在主服务器添加表和数据，可以看到从服务器数据库已经修改。<br>重启主从数据库，依然可以正常同步。</p>\n<h3 id=\"错误处理办法\"><a href=\"#错误处理办法\" class=\"headerlink\" title=\"错误处理办法\"></a>错误处理办法</h3><p>连接不上master：<br>1，密码是否正确，是否给予权限<br>2，防火墙是否开启3306端口 配置的时候注意锁表</p>\n<pre><code>LOCK TABLES\n\n\nUNLOCK TABLES;</code></pre><p>错误提示 Got fatal error 1236 from master when reading data from binary log: ‘Slave can not handle replication events with the checksum that master is configured to log; the first event ‘mysql-bin.000002’ at 120, the last event read from ‘./mysql-bin.000002’ at 120, the last byte read from ‘./mysql-bin.000002’ at 120 由于主库是5.6, 从库是5.5.<br>5.6的版本中加入了replication event checksum，主从复制时间校验功能，所以需要把这个关掉才能正常同步到5.5的slave 修改主库</p>\n<pre><code>sudo vim /etc/my.cnf\nbinlog_checksum=none</code></pre><p>重新配置主从即可</p>\n"},{"title":"node入门基础","date":"2019-07-26T07:48:00.000Z","_content":"#### 安装\n\n**开发环境**\n\n[安装nvm](https://github.com/nvm-sh/nvm)\n\n```shell\n$ wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash\n```\n\n添加以下代码到~/.bashrc, ~/.profile, or ~/.zshrc\n\n```shell\nexport NVM_DIR=\"$HOME/.nvm\"\n[ -s \"$NVM_DIR/nvm.sh\" ] && \\. \"$NVM_DIR/nvm.sh\"  # This loads nvm\n[ -s \"$NVM_DIR/bash_completion\" ] && \\. \"$NVM_DIR/bash_completion\"  # This loads nvm bash_completion\n```\n\nnvm命令\n```shell\n$ nvm install 6.14.4  # 安装or 10.10.0, 8.9.1, etc\n$ nvm ls 查看\n```\n\n安装cnpm\n```shell\n$ npm --registry=https://registry.npm.taobao.org install cnpm -g\n```\n\n#### 待续","source":"_posts/node入门基础.md","raw":"---\ntitle: node入门基础\ndate: 2019-07-26 15:48:00\ntags:\n---\n#### 安装\n\n**开发环境**\n\n[安装nvm](https://github.com/nvm-sh/nvm)\n\n```shell\n$ wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash\n```\n\n添加以下代码到~/.bashrc, ~/.profile, or ~/.zshrc\n\n```shell\nexport NVM_DIR=\"$HOME/.nvm\"\n[ -s \"$NVM_DIR/nvm.sh\" ] && \\. \"$NVM_DIR/nvm.sh\"  # This loads nvm\n[ -s \"$NVM_DIR/bash_completion\" ] && \\. \"$NVM_DIR/bash_completion\"  # This loads nvm bash_completion\n```\n\nnvm命令\n```shell\n$ nvm install 6.14.4  # 安装or 10.10.0, 8.9.1, etc\n$ nvm ls 查看\n```\n\n安装cnpm\n```shell\n$ npm --registry=https://registry.npm.taobao.org install cnpm -g\n```\n\n#### 待续","slug":"node入门基础","published":1,"updated":"2019-07-26T08:07:02.471Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjyu0a5o3001p9ka4s9i6f4g1","content":"<h4 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h4><p><strong>开发环境</strong></p>\n<p><a href=\"https://github.com/nvm-sh/nvm\" target=\"_blank\" rel=\"noopener\">安装nvm</a></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash</span><br></pre></td></tr></table></figure>\n\n<p>添加以下代码到~/.bashrc, ~/.profile, or ~/.zshrc</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export NVM_DIR=\"$HOME/.nvm\"</span><br><span class=\"line\">[ -s \"$NVM_DIR/nvm.sh\" ] &amp;&amp; \\. \"$NVM_DIR/nvm.sh\"  # This loads nvm</span><br><span class=\"line\">[ -s \"$NVM_DIR/bash_completion\" ] &amp;&amp; \\. \"$NVM_DIR/bash_completion\"  # This loads nvm bash_completion</span><br></pre></td></tr></table></figure>\n\n<p>nvm命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> nvm install 6.14.4  # 安装or 10.10.0, 8.9.1, etc</span><br><span class=\"line\"><span class=\"meta\">$</span> nvm ls 查看</span><br></pre></td></tr></table></figure>\n\n<p>安装cnpm</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> npm --registry=https://registry.npm.taobao.org install cnpm -g</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"待续\"><a href=\"#待续\" class=\"headerlink\" title=\"待续\"></a>待续</h4>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h4><p><strong>开发环境</strong></p>\n<p><a href=\"https://github.com/nvm-sh/nvm\" target=\"_blank\" rel=\"noopener\">安装nvm</a></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash</span><br></pre></td></tr></table></figure>\n\n<p>添加以下代码到~/.bashrc, ~/.profile, or ~/.zshrc</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export NVM_DIR=\"$HOME/.nvm\"</span><br><span class=\"line\">[ -s \"$NVM_DIR/nvm.sh\" ] &amp;&amp; \\. \"$NVM_DIR/nvm.sh\"  # This loads nvm</span><br><span class=\"line\">[ -s \"$NVM_DIR/bash_completion\" ] &amp;&amp; \\. \"$NVM_DIR/bash_completion\"  # This loads nvm bash_completion</span><br></pre></td></tr></table></figure>\n\n<p>nvm命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> nvm install 6.14.4  # 安装or 10.10.0, 8.9.1, etc</span><br><span class=\"line\"><span class=\"meta\">$</span> nvm ls 查看</span><br></pre></td></tr></table></figure>\n\n<p>安装cnpm</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> npm --registry=https://registry.npm.taobao.org install cnpm -g</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"待续\"><a href=\"#待续\" class=\"headerlink\" title=\"待续\"></a>待续</h4>"},{"title":"centos7创建nagios监控集群服务","url":"166.html","id":"166","comments":0,"date":"2017-04-20T03:17:12.000Z","_content":"\n### 安装服务器端192.168.0.206\n\n1,安装lamp环境 [参考](http://www.zhuohc.com/articles/centos7%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/) 2, 配置nagios服务\n\n    # 创建nagiso用户\n    $ sudo useradd nagios\n    # 创建apache用户，yum安装httpd服务会自动创建\n    $ sudo useradd apache -M -s /sbin/nologin\n    useradd：用户“apache”已存在\n    # 创建nagcmd用户组\n    $ sudo groupadd nagcmd\n    # 将usermod加入nagcmd用户组\n    sudo usermod -a -G nagcmd nagios\n    # 将apache用户加入nagcmd用户组\n    $ sudo usermod -a -G nagcmd apache\n    # 查看nagios用户所属的组\n    $ id -n -G nagios\n    nagios nagcmd\n    # 查看apace用户所属的组\n    $ id -n -G apache\n    apache nagcmd\n    # 安装nagiso服务\n    $sudo yum install nagios\n    $sudo yum install nagios-plugins-all\n    # 安装nrpe（服务器端和客户端都需要安装）\n    $sudo yum install nrpe\n    # 启动和开机启动\n    $sudo systemctl start nagios\n    $sudo systemctl enable nagios\n    $sudo systemctl start nrpe\n    $sudo systemctl enable nrpe\n    \n\n3,配置web\n\n    # 取消认证\n    $ sudo vim /etc/nagios/cgi.cfg\n    use_authentication=0 # 此处将1改为0\n    # 查看配置文件\n    $ls /etc/httpd/conf.d\n    autoindex.conf  nagios.conf  php.conf  README  userdir.conf  welcome.conf  xcache.conf\n    # 其中nagiso.conf就是nagios的web配置文件\n    # 访问http://192.168.0.206/nagios，其中登陆密码在/etc/nagios/passwd文件中，具体文件位置可以在/etc/httpd/conf.d/nagios.conf中查看\n    \n\n### 安装客户端192.168.0.208\n\n    # 安装mysql，参考上方链接，配合生成check_mysql插件\n    # 安装nrpe（服务器端和客户端都需要安装）\n    $ sudo yum -y install epel-release\n    $ sudo yum install nrpe\n    $ sudo yum install nagios-plugins-all\n    # 配置nagios客户端\n    $ sudo vim /etc/nagios/nrpe.cfg\n    allowed_hosts=127.0.0.1,192.168.0.206 # 监控当前客户端的nagios服务器地址\n    # 启动服务\n    $ sudo systemctl restart nrpe\n    $ sudo systemctl enable nrpe\n    # 检查启动结果\n    $ sudo netstat -lntup | grep nrpe\n    tcp        0      0 0.0.0.0:5666            0.0.0.0:*               LISTEN      2540/nrpe           \n    tcp6       0      0 :::5666                 :::*                    LISTEN      2540/nrpe\n    $ sudo ps -ef | grep nrpe | grep -v grep\n    nrpe      2540     1  0 11:59 ?        00:00:00 /usr/sbin/nrpe -c /etc/nagios/nrpe.cfg -d\n    \n\n### 配置服务器端192.168.0.206\n\n    $ tree /etc/nagios\n    .\n    ├── cgi.cfg  \n    ├── conf.d  # 添加新的监视客户端信息\n    │   └── web_one.cfg\n    ├── nagios.cfg  # 配置服务器端nagios\n    ├── nrpe.cfg # 配置服务器端nrpe\n    ├── objects\n    │   ├── commands.cfg\n    │   ├── contacts.cfg\n    │   ├── localhost.cfg\n    │   ├── printer.cfg\n    │   ├── switch.cfg\n    │   ├── templates.cfg\n    │   ├── timeperiods.cfg\n    │   └── windows.cfg\n    ├── passwd\n    └── private\n        └── resource.cfg\n    $ cp /etc/nagios/objects/localhost.cfg  /etc/nagios/conf.d/web_one.cfg\n    $ vim /etc/nagios/conf.d/web_one.cfg # 将localhost 改成web_one\n    define host{\n            use                     linux-server  \n            host_name         web_one\n            alias                   web_one\n            address              192.168.0.208\n    }\n    define service{\n            use                             local-service \n            host_name                 web_one\n            service_description    PING\n            check_command        check_ping!100.0,20%!500.0,60%\n    }\n    \n\n### 查看结果\n\n![nagios](http://www.zhuohc.com/wp-content/uploads/2017/04/nagios.png)","source":"_posts/centos7创建nagios监控集群服务.md","raw":"---\ntitle: centos7创建nagios监控集群服务\nurl: 166.html\nid: 166\ncomments: false\ncategories:\n  - 运维\ndate: 2017-04-20 11:17:12\ntags:\n---\n\n### 安装服务器端192.168.0.206\n\n1,安装lamp环境 [参考](http://www.zhuohc.com/articles/centos7%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/) 2, 配置nagios服务\n\n    # 创建nagiso用户\n    $ sudo useradd nagios\n    # 创建apache用户，yum安装httpd服务会自动创建\n    $ sudo useradd apache -M -s /sbin/nologin\n    useradd：用户“apache”已存在\n    # 创建nagcmd用户组\n    $ sudo groupadd nagcmd\n    # 将usermod加入nagcmd用户组\n    sudo usermod -a -G nagcmd nagios\n    # 将apache用户加入nagcmd用户组\n    $ sudo usermod -a -G nagcmd apache\n    # 查看nagios用户所属的组\n    $ id -n -G nagios\n    nagios nagcmd\n    # 查看apace用户所属的组\n    $ id -n -G apache\n    apache nagcmd\n    # 安装nagiso服务\n    $sudo yum install nagios\n    $sudo yum install nagios-plugins-all\n    # 安装nrpe（服务器端和客户端都需要安装）\n    $sudo yum install nrpe\n    # 启动和开机启动\n    $sudo systemctl start nagios\n    $sudo systemctl enable nagios\n    $sudo systemctl start nrpe\n    $sudo systemctl enable nrpe\n    \n\n3,配置web\n\n    # 取消认证\n    $ sudo vim /etc/nagios/cgi.cfg\n    use_authentication=0 # 此处将1改为0\n    # 查看配置文件\n    $ls /etc/httpd/conf.d\n    autoindex.conf  nagios.conf  php.conf  README  userdir.conf  welcome.conf  xcache.conf\n    # 其中nagiso.conf就是nagios的web配置文件\n    # 访问http://192.168.0.206/nagios，其中登陆密码在/etc/nagios/passwd文件中，具体文件位置可以在/etc/httpd/conf.d/nagios.conf中查看\n    \n\n### 安装客户端192.168.0.208\n\n    # 安装mysql，参考上方链接，配合生成check_mysql插件\n    # 安装nrpe（服务器端和客户端都需要安装）\n    $ sudo yum -y install epel-release\n    $ sudo yum install nrpe\n    $ sudo yum install nagios-plugins-all\n    # 配置nagios客户端\n    $ sudo vim /etc/nagios/nrpe.cfg\n    allowed_hosts=127.0.0.1,192.168.0.206 # 监控当前客户端的nagios服务器地址\n    # 启动服务\n    $ sudo systemctl restart nrpe\n    $ sudo systemctl enable nrpe\n    # 检查启动结果\n    $ sudo netstat -lntup | grep nrpe\n    tcp        0      0 0.0.0.0:5666            0.0.0.0:*               LISTEN      2540/nrpe           \n    tcp6       0      0 :::5666                 :::*                    LISTEN      2540/nrpe\n    $ sudo ps -ef | grep nrpe | grep -v grep\n    nrpe      2540     1  0 11:59 ?        00:00:00 /usr/sbin/nrpe -c /etc/nagios/nrpe.cfg -d\n    \n\n### 配置服务器端192.168.0.206\n\n    $ tree /etc/nagios\n    .\n    ├── cgi.cfg  \n    ├── conf.d  # 添加新的监视客户端信息\n    │   └── web_one.cfg\n    ├── nagios.cfg  # 配置服务器端nagios\n    ├── nrpe.cfg # 配置服务器端nrpe\n    ├── objects\n    │   ├── commands.cfg\n    │   ├── contacts.cfg\n    │   ├── localhost.cfg\n    │   ├── printer.cfg\n    │   ├── switch.cfg\n    │   ├── templates.cfg\n    │   ├── timeperiods.cfg\n    │   └── windows.cfg\n    ├── passwd\n    └── private\n        └── resource.cfg\n    $ cp /etc/nagios/objects/localhost.cfg  /etc/nagios/conf.d/web_one.cfg\n    $ vim /etc/nagios/conf.d/web_one.cfg # 将localhost 改成web_one\n    define host{\n            use                     linux-server  \n            host_name         web_one\n            alias                   web_one\n            address              192.168.0.208\n    }\n    define service{\n            use                             local-service \n            host_name                 web_one\n            service_description    PING\n            check_command        check_ping!100.0,20%!500.0,60%\n    }\n    \n\n### 查看结果\n\n![nagios](http://www.zhuohc.com/wp-content/uploads/2017/04/nagios.png)","slug":"centos7创建nagios监控集群服务","published":1,"updated":"2019-07-23T05:51:43.847Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5o5001r9ka4uvk9xe6p","content":"<h3 id=\"安装服务器端192-168-0-206\"><a href=\"#安装服务器端192-168-0-206\" class=\"headerlink\" title=\"安装服务器端192.168.0.206\"></a>安装服务器端192.168.0.206</h3><p>1,安装lamp环境 <a href=\"http://www.zhuohc.com/articles/centos7%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/\">参考</a> 2, 配置nagios服务</p>\n<pre><code># 创建nagiso用户\n$ sudo useradd nagios\n# 创建apache用户，yum安装httpd服务会自动创建\n$ sudo useradd apache -M -s /sbin/nologin\nuseradd：用户“apache”已存在\n# 创建nagcmd用户组\n$ sudo groupadd nagcmd\n# 将usermod加入nagcmd用户组\nsudo usermod -a -G nagcmd nagios\n# 将apache用户加入nagcmd用户组\n$ sudo usermod -a -G nagcmd apache\n# 查看nagios用户所属的组\n$ id -n -G nagios\nnagios nagcmd\n# 查看apace用户所属的组\n$ id -n -G apache\napache nagcmd\n# 安装nagiso服务\n$sudo yum install nagios\n$sudo yum install nagios-plugins-all\n# 安装nrpe（服务器端和客户端都需要安装）\n$sudo yum install nrpe\n# 启动和开机启动\n$sudo systemctl start nagios\n$sudo systemctl enable nagios\n$sudo systemctl start nrpe\n$sudo systemctl enable nrpe</code></pre><p>3,配置web</p>\n<pre><code># 取消认证\n$ sudo vim /etc/nagios/cgi.cfg\nuse_authentication=0 # 此处将1改为0\n# 查看配置文件\n$ls /etc/httpd/conf.d\nautoindex.conf  nagios.conf  php.conf  README  userdir.conf  welcome.conf  xcache.conf\n# 其中nagiso.conf就是nagios的web配置文件\n# 访问http://192.168.0.206/nagios，其中登陆密码在/etc/nagios/passwd文件中，具体文件位置可以在/etc/httpd/conf.d/nagios.conf中查看</code></pre><h3 id=\"安装客户端192-168-0-208\"><a href=\"#安装客户端192-168-0-208\" class=\"headerlink\" title=\"安装客户端192.168.0.208\"></a>安装客户端192.168.0.208</h3><pre><code># 安装mysql，参考上方链接，配合生成check_mysql插件\n# 安装nrpe（服务器端和客户端都需要安装）\n$ sudo yum -y install epel-release\n$ sudo yum install nrpe\n$ sudo yum install nagios-plugins-all\n# 配置nagios客户端\n$ sudo vim /etc/nagios/nrpe.cfg\nallowed_hosts=127.0.0.1,192.168.0.206 # 监控当前客户端的nagios服务器地址\n# 启动服务\n$ sudo systemctl restart nrpe\n$ sudo systemctl enable nrpe\n# 检查启动结果\n$ sudo netstat -lntup | grep nrpe\ntcp        0      0 0.0.0.0:5666            0.0.0.0:*               LISTEN      2540/nrpe           \ntcp6       0      0 :::5666                 :::*                    LISTEN      2540/nrpe\n$ sudo ps -ef | grep nrpe | grep -v grep\nnrpe      2540     1  0 11:59 ?        00:00:00 /usr/sbin/nrpe -c /etc/nagios/nrpe.cfg -d</code></pre><h3 id=\"配置服务器端192-168-0-206\"><a href=\"#配置服务器端192-168-0-206\" class=\"headerlink\" title=\"配置服务器端192.168.0.206\"></a>配置服务器端192.168.0.206</h3><pre><code>$ tree /etc/nagios\n.\n├── cgi.cfg  \n├── conf.d  # 添加新的监视客户端信息\n│   └── web_one.cfg\n├── nagios.cfg  # 配置服务器端nagios\n├── nrpe.cfg # 配置服务器端nrpe\n├── objects\n│   ├── commands.cfg\n│   ├── contacts.cfg\n│   ├── localhost.cfg\n│   ├── printer.cfg\n│   ├── switch.cfg\n│   ├── templates.cfg\n│   ├── timeperiods.cfg\n│   └── windows.cfg\n├── passwd\n└── private\n    └── resource.cfg\n$ cp /etc/nagios/objects/localhost.cfg  /etc/nagios/conf.d/web_one.cfg\n$ vim /etc/nagios/conf.d/web_one.cfg # 将localhost 改成web_one\ndefine host{\n        use                     linux-server  \n        host_name         web_one\n        alias                   web_one\n        address              192.168.0.208\n}\ndefine service{\n        use                             local-service \n        host_name                 web_one\n        service_description    PING\n        check_command        check_ping!100.0,20%!500.0,60%\n}</code></pre><h3 id=\"查看结果\"><a href=\"#查看结果\" class=\"headerlink\" title=\"查看结果\"></a>查看结果</h3><p><img src=\"http://www.zhuohc.com/wp-content/uploads/2017/04/nagios.png\" alt=\"nagios\"></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"安装服务器端192-168-0-206\"><a href=\"#安装服务器端192-168-0-206\" class=\"headerlink\" title=\"安装服务器端192.168.0.206\"></a>安装服务器端192.168.0.206</h3><p>1,安装lamp环境 <a href=\"http://www.zhuohc.com/articles/centos7%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/\">参考</a> 2, 配置nagios服务</p>\n<pre><code># 创建nagiso用户\n$ sudo useradd nagios\n# 创建apache用户，yum安装httpd服务会自动创建\n$ sudo useradd apache -M -s /sbin/nologin\nuseradd：用户“apache”已存在\n# 创建nagcmd用户组\n$ sudo groupadd nagcmd\n# 将usermod加入nagcmd用户组\nsudo usermod -a -G nagcmd nagios\n# 将apache用户加入nagcmd用户组\n$ sudo usermod -a -G nagcmd apache\n# 查看nagios用户所属的组\n$ id -n -G nagios\nnagios nagcmd\n# 查看apace用户所属的组\n$ id -n -G apache\napache nagcmd\n# 安装nagiso服务\n$sudo yum install nagios\n$sudo yum install nagios-plugins-all\n# 安装nrpe（服务器端和客户端都需要安装）\n$sudo yum install nrpe\n# 启动和开机启动\n$sudo systemctl start nagios\n$sudo systemctl enable nagios\n$sudo systemctl start nrpe\n$sudo systemctl enable nrpe</code></pre><p>3,配置web</p>\n<pre><code># 取消认证\n$ sudo vim /etc/nagios/cgi.cfg\nuse_authentication=0 # 此处将1改为0\n# 查看配置文件\n$ls /etc/httpd/conf.d\nautoindex.conf  nagios.conf  php.conf  README  userdir.conf  welcome.conf  xcache.conf\n# 其中nagiso.conf就是nagios的web配置文件\n# 访问http://192.168.0.206/nagios，其中登陆密码在/etc/nagios/passwd文件中，具体文件位置可以在/etc/httpd/conf.d/nagios.conf中查看</code></pre><h3 id=\"安装客户端192-168-0-208\"><a href=\"#安装客户端192-168-0-208\" class=\"headerlink\" title=\"安装客户端192.168.0.208\"></a>安装客户端192.168.0.208</h3><pre><code># 安装mysql，参考上方链接，配合生成check_mysql插件\n# 安装nrpe（服务器端和客户端都需要安装）\n$ sudo yum -y install epel-release\n$ sudo yum install nrpe\n$ sudo yum install nagios-plugins-all\n# 配置nagios客户端\n$ sudo vim /etc/nagios/nrpe.cfg\nallowed_hosts=127.0.0.1,192.168.0.206 # 监控当前客户端的nagios服务器地址\n# 启动服务\n$ sudo systemctl restart nrpe\n$ sudo systemctl enable nrpe\n# 检查启动结果\n$ sudo netstat -lntup | grep nrpe\ntcp        0      0 0.0.0.0:5666            0.0.0.0:*               LISTEN      2540/nrpe           \ntcp6       0      0 :::5666                 :::*                    LISTEN      2540/nrpe\n$ sudo ps -ef | grep nrpe | grep -v grep\nnrpe      2540     1  0 11:59 ?        00:00:00 /usr/sbin/nrpe -c /etc/nagios/nrpe.cfg -d</code></pre><h3 id=\"配置服务器端192-168-0-206\"><a href=\"#配置服务器端192-168-0-206\" class=\"headerlink\" title=\"配置服务器端192.168.0.206\"></a>配置服务器端192.168.0.206</h3><pre><code>$ tree /etc/nagios\n.\n├── cgi.cfg  \n├── conf.d  # 添加新的监视客户端信息\n│   └── web_one.cfg\n├── nagios.cfg  # 配置服务器端nagios\n├── nrpe.cfg # 配置服务器端nrpe\n├── objects\n│   ├── commands.cfg\n│   ├── contacts.cfg\n│   ├── localhost.cfg\n│   ├── printer.cfg\n│   ├── switch.cfg\n│   ├── templates.cfg\n│   ├── timeperiods.cfg\n│   └── windows.cfg\n├── passwd\n└── private\n    └── resource.cfg\n$ cp /etc/nagios/objects/localhost.cfg  /etc/nagios/conf.d/web_one.cfg\n$ vim /etc/nagios/conf.d/web_one.cfg # 将localhost 改成web_one\ndefine host{\n        use                     linux-server  \n        host_name         web_one\n        alias                   web_one\n        address              192.168.0.208\n}\ndefine service{\n        use                             local-service \n        host_name                 web_one\n        service_description    PING\n        check_command        check_ping!100.0,20%!500.0,60%\n}</code></pre><h3 id=\"查看结果\"><a href=\"#查看结果\" class=\"headerlink\" title=\"查看结果\"></a>查看结果</h3><p><img src=\"http://www.zhuohc.com/wp-content/uploads/2017/04/nagios.png\" alt=\"nagios\"></p>\n"},{"title":"php将pdf转为jpg，png图片","url":"14.html","id":"14","comments":0,"date":"2016-11-08T08:23:41.000Z","_content":"\n### 环境\n\nWINDOW,PHP5.2\n\n### 安装\n\n安装ImageMagick并添加环境变量 [官网](http://www.imagemagick.org/script/index.php)  \n安装php扩展php_imagick.dll,并在php.ini开启 [官网](https://pecl.php.net/package/imagick)  \n查看是否载入扩展\n\n    phpinfo();\n    \n\n安装Ghostscript并添加环境变量 [官网](http://www.ghostscript.com/download/)\n\n### 下载地址\n\n[百度网盘](http://pan.baidu.com/s/1kTOkhFL)\n\n### 测试是否可以正常运行\n\n    λ convert.exe SEZ588Hu.pdf SEZ588Hu.png\n    \n\n### php代码\n\n生成jpg文件\n```php\n<?php\n    $im = new imagick('A.pdf[0]');\n    $im->setImageFormat('jpg');\n    $im->writeImages('A.jpg', true);\n?>\n```\n\n    \n    \n\n或者直接输出到浏览器\n```php\n<?php\n    $im = new imagick('file.pdf[0]');\n    $im->setImageFormat('jpg');\n    header('Content-Type: image/jpeg');\n    echo $im;\n?>\n```  \n\n### 错误处理\n\n1，将Ghostscript64位卸载，安装32位  \n2，将php.ini里的upload\\_tmp\\_dir对应目录权限修改为IISUER可读写","source":"_posts/php将pdf转为jpg，png图片.md","raw":"---\ntitle: php将pdf转为jpg，png图片\ntags:\n  - php\nurl: 14.html\nid: 14\ncomments: false\ncategories:\n  - 前端\ndate: 2016-11-08 16:23:41\n---\n\n### 环境\n\nWINDOW,PHP5.2\n\n### 安装\n\n安装ImageMagick并添加环境变量 [官网](http://www.imagemagick.org/script/index.php)  \n安装php扩展php_imagick.dll,并在php.ini开启 [官网](https://pecl.php.net/package/imagick)  \n查看是否载入扩展\n\n    phpinfo();\n    \n\n安装Ghostscript并添加环境变量 [官网](http://www.ghostscript.com/download/)\n\n### 下载地址\n\n[百度网盘](http://pan.baidu.com/s/1kTOkhFL)\n\n### 测试是否可以正常运行\n\n    λ convert.exe SEZ588Hu.pdf SEZ588Hu.png\n    \n\n### php代码\n\n生成jpg文件\n```php\n<?php\n    $im = new imagick('A.pdf[0]');\n    $im->setImageFormat('jpg');\n    $im->writeImages('A.jpg', true);\n?>\n```\n\n    \n    \n\n或者直接输出到浏览器\n```php\n<?php\n    $im = new imagick('file.pdf[0]');\n    $im->setImageFormat('jpg');\n    header('Content-Type: image/jpeg');\n    echo $im;\n?>\n```  \n\n### 错误处理\n\n1，将Ghostscript64位卸载，安装32位  \n2，将php.ini里的upload\\_tmp\\_dir对应目录权限修改为IISUER可读写","slug":"php将pdf转为jpg，png图片","published":1,"updated":"2019-07-24T01:29:12.170Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5o6001v9ka4rud5frx1","content":"<h3 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h3><p>WINDOW,PHP5.2</p>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><p>安装ImageMagick并添加环境变量 <a href=\"http://www.imagemagick.org/script/index.php\" target=\"_blank\" rel=\"noopener\">官网</a><br>安装php扩展php_imagick.dll,并在php.ini开启 <a href=\"https://pecl.php.net/package/imagick\" target=\"_blank\" rel=\"noopener\">官网</a><br>查看是否载入扩展</p>\n<pre><code>phpinfo();</code></pre><p>安装Ghostscript并添加环境变量 <a href=\"http://www.ghostscript.com/download/\" target=\"_blank\" rel=\"noopener\">官网</a></p>\n<h3 id=\"下载地址\"><a href=\"#下载地址\" class=\"headerlink\" title=\"下载地址\"></a>下载地址</h3><p><a href=\"http://pan.baidu.com/s/1kTOkhFL\" target=\"_blank\" rel=\"noopener\">百度网盘</a></p>\n<h3 id=\"测试是否可以正常运行\"><a href=\"#测试是否可以正常运行\" class=\"headerlink\" title=\"测试是否可以正常运行\"></a>测试是否可以正常运行</h3><pre><code>λ convert.exe SEZ588Hu.pdf SEZ588Hu.png</code></pre><h3 id=\"php代码\"><a href=\"#php代码\" class=\"headerlink\" title=\"php代码\"></a>php代码</h3><p>生成jpg文件</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">    $im = <span class=\"keyword\">new</span> imagick(<span class=\"string\">'A.pdf[0]'</span>);</span><br><span class=\"line\">    $im-&gt;setImageFormat(<span class=\"string\">'jpg'</span>);</span><br><span class=\"line\">    $im-&gt;writeImages(<span class=\"string\">'A.jpg'</span>, <span class=\"keyword\">true</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n\n<p>或者直接输出到浏览器</p>\n<pre><code class=\"php\"><span class=\"meta\">&lt;?php</span>\n    $im = <span class=\"keyword\">new</span> imagick(<span class=\"string\">'file.pdf[0]'</span>);\n    $im-&gt;setImageFormat(<span class=\"string\">'jpg'</span>);\n    header(<span class=\"string\">'Content-Type: image/jpeg'</span>);\n    <span class=\"keyword\">echo</span> $im;\n<span class=\"meta\">?&gt;</span></code></pre>\n<h3 id=\"错误处理\"><a href=\"#错误处理\" class=\"headerlink\" title=\"错误处理\"></a>错误处理</h3><p>1，将Ghostscript64位卸载，安装32位<br>2，将php.ini里的upload_tmp_dir对应目录权限修改为IISUER可读写</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h3><p>WINDOW,PHP5.2</p>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><p>安装ImageMagick并添加环境变量 <a href=\"http://www.imagemagick.org/script/index.php\" target=\"_blank\" rel=\"noopener\">官网</a><br>安装php扩展php_imagick.dll,并在php.ini开启 <a href=\"https://pecl.php.net/package/imagick\" target=\"_blank\" rel=\"noopener\">官网</a><br>查看是否载入扩展</p>\n<pre><code>phpinfo();</code></pre><p>安装Ghostscript并添加环境变量 <a href=\"http://www.ghostscript.com/download/\" target=\"_blank\" rel=\"noopener\">官网</a></p>\n<h3 id=\"下载地址\"><a href=\"#下载地址\" class=\"headerlink\" title=\"下载地址\"></a>下载地址</h3><p><a href=\"http://pan.baidu.com/s/1kTOkhFL\" target=\"_blank\" rel=\"noopener\">百度网盘</a></p>\n<h3 id=\"测试是否可以正常运行\"><a href=\"#测试是否可以正常运行\" class=\"headerlink\" title=\"测试是否可以正常运行\"></a>测试是否可以正常运行</h3><pre><code>λ convert.exe SEZ588Hu.pdf SEZ588Hu.png</code></pre><h3 id=\"php代码\"><a href=\"#php代码\" class=\"headerlink\" title=\"php代码\"></a>php代码</h3><p>生成jpg文件</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">    $im = <span class=\"keyword\">new</span> imagick(<span class=\"string\">'A.pdf[0]'</span>);</span><br><span class=\"line\">    $im-&gt;setImageFormat(<span class=\"string\">'jpg'</span>);</span><br><span class=\"line\">    $im-&gt;writeImages(<span class=\"string\">'A.jpg'</span>, <span class=\"keyword\">true</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n\n<p>或者直接输出到浏览器</p>\n<pre><code class=\"php\"><span class=\"meta\">&lt;?php</span>\n    $im = <span class=\"keyword\">new</span> imagick(<span class=\"string\">'file.pdf[0]'</span>);\n    $im-&gt;setImageFormat(<span class=\"string\">'jpg'</span>);\n    header(<span class=\"string\">'Content-Type: image/jpeg'</span>);\n    <span class=\"keyword\">echo</span> $im;\n<span class=\"meta\">?&gt;</span></code></pre>\n<h3 id=\"错误处理\"><a href=\"#错误处理\" class=\"headerlink\" title=\"错误处理\"></a>错误处理</h3><p>1，将Ghostscript64位卸载，安装32位<br>2，将php.ini里的upload_tmp_dir对应目录权限修改为IISUER可读写</p>\n"},{"title":"oracle virtualbox入门基础","url":"11.html","id":"11","comments":0,"date":"2016-11-08T01:09:01.000Z","_content":"\n### 安装和主机共享\n\n> 点击设备，安装增强功能\n\n### 共享剪贴板\n\n> 点击设备，共享剪贴板，双向\n\n### 快捷键\n\n> 显示客户机菜单 右Ctrl+C 全屏快捷键 右Ctrl+F\n\n### 4中网络连接形式(以下内容来自网络)\n\n**第一种 NAT模式**  \n解释： NAT模式是最简单的实现虚拟机上网的方式，你可以这样理解：Vhost访问网络的所有数据都是由主机提供的，vhost并不真实存在于网络中，主机与网络中的任何机器都不能查看和访问到Vhost的存在。  \n虚拟机与主机关系：  \n只能单向访问，虚拟机可以通过网络访问到主机，主机无法通过网络访问到虚拟机。  \n虚拟机与网络中其他主机的关系：  \n只能单向访问，虚拟机可以访问到网络中其他主机，其他主机不能通过网络访问到虚拟机。  \n虚拟机与虚拟机之间的关系：  \n相互不能访问，虚拟机与虚拟机各自完全独立，相互间无法通过网络访问彼此。  \nIP:10.0.2.15  \n网关：10.0.2.2  \nDNS：10.0.2.3  \n一台虚拟机的多个网卡可以被设定使用 NAT， 第一个网卡连接了到专用网 10.0.2.0，第二个网卡连接到专用网络 10.0.3.0，等等。默认得到的客户端ip（IP Address）是10.0.2.15，网关（Gateway）是10.0.2.2，域名服务器（DNS）是10.0.2.3，可以手动参考这个进行修改。  \nNAT方案优缺点：  \n笔记本已插网线时： 虚拟机可以访问主机，虚拟机可以访问互联网，在做了端口映射后（最后有说明），主机可以访问虚拟机上的服务（如数据库）。  \n笔记本没插网线时： 主机的“本地连接”有红叉的，虚拟机可以访问主机，虚拟机不可以访问互联网，在做了端口映射后，主机可以访问虚拟机上的服务（如数据库）。 **第二种 Bridged Adapter模式**  \n解释：  \n网桥模式是我最喜欢的用的一种模式，同时，模拟度也是相当完美。你可以这样理解，它是通过主机网卡，架设了一条桥，直接连入到网络中了。因此，它使得虚拟机能被分配到一个网络中独立的IP，所有网络功能完全和在网络中的真实机器一样。  \n虚拟机与主机关系：  \n可以相互访问，因为虚拟机在真实网络段中有独立IP，主机与虚拟机处于同一网络段中，彼此可以通过各自IP相互访问。  \n虚拟机于网络中其他主机关系：  \n可以相互访问，同样因为虚拟机在真实网络段中有独立IP，虚拟机与所有网络其他主机处于同一网络段中，彼此可以通过各自IP相互访问。  \n虚拟机于虚拟机关系：  \n可以相互访问，原因同上。  \nIP：一般是DHCP分配的，与主机的“本地连接”的IP 是同一网段的。虚拟机就能与主机互相通信。  \n笔记本已插网线时：（若网络中有DHCP服务器）主机与虚拟机会通过DHCP分别得到一个IP，这两个IP在同一网段。 主机与虚拟机可以ping通，虚拟机可以上互联网。  \n笔记本没插网线时：主机与虚拟机不能通信。主机的“本地连接”有红叉，就不能手工指定IP。虚拟机也不能通过DHCP得到IP地址，手工指定IP后，也无法与主机通信，因为主机无IP。  \n这时主机的VirtualBox Host-Only Network 网卡是有ip的，192.168.56.1。虚拟机就算手工指定了IP 192.168.56.*，也ping不能主机。 **第三种 Internal模式**  \n解释：  \n内网模式，顾名思义就是内部网络模式，虚拟机与外网完全断开，只实现虚拟机于虚拟机之间的内部网络模式。  \n虚拟机与主机关系：  \n不能相互访问，彼此不属于同一个网络，无法相互访问。  \n虚拟机与网络中其他主机关系：  \n不能相互访问，理由同上。  \n虚拟机与虚拟机关系：  \n可以相互访问，前提是在设置网络时，两台虚拟机设置同一网络名称。如上配置图中，名称为intnet。  \nIP: VirtualBox的DHCP服务器会为它分配IP ，一般得到的是192.168.56.101，因为是从101起分的，也可手工指定192.168.56.*。  \n笔记本已插网线时：虚拟机可以与主机的VirtualBox Host-Only Network 网卡通信  \n这种方案不受主机本地连接（网卡）是否有红叉的影响。 **第四种 Host-only Adapter模式**  \n解释：  \n主机模式，这是一种比较复杂的模式，需要有比较扎实的网络基础知识才能玩转。可以说前面几种模式所实现的功能，在这种模式下，通过虚拟机及网卡的设置都可以被实现。  \n我们可以理解为Vbox在主机中模拟出一张专供虚拟机使用的网卡，所有虚拟机都是连接到该网卡上的，我们可以通过设置这张网卡来实现上网及其他很多功能，比如（网卡共享、网卡桥接等）。  \n虚拟机与主机关系  \n默认不能相互访问，双方不属于同一IP段，host-only网卡默认IP段为192.168.56.X 子网掩码为255.255.255.0，后面的虚拟机被分配到的也都是这个网段。通过网卡共享、网卡桥接等，可以实现虚拟机于主机相互访问。  \n虚拟机与网络主机关系  \n默认不能相互访问，原因同上，通过设置，可以实现相互访问。  \n虚拟机与虚拟机关系  \n默认可以相互访问，都是同处于一个网段。  \n虚拟机访问主机 用的是主机的VirtualBox Host-Only Network网卡的IP：192.168.56.1 ，不管主机“本地连接”有无红叉，永远通。  \n主机访问虚拟机，用是的虚拟机的网卡3的IP： 192.168.56.101 ，不管主机“本地连接”有无红叉，永远通。  \n虚拟机访问互联网，用的是自己的网卡2， 这时主机要能通过“本地连接”有线上网，（无线网卡不行） 通过对以上几种网络模式的了解，我们就可以灵活运用，模拟组建出我们所想要的任何一种网络环境了。  \n比如我想模拟出来一个一台主机，监控一个局域网上网情况的网络环境。  \n首先我开启了两台虚拟机vhost1与vhost2，当然如果硬件允许，我同样可以再增加vhost3、vhost4…  \n所有的vhost我都设置成internat内网模式，网络名称为intnal，网关为192.168.56.100，意思就是通过 192.168.56.100网卡上网。其中有一台vhost1我设置为双网卡，一张为内网模式（192.168.56.100），一张为网桥模式 （192.168.1.101）。两张网卡设置双网卡共享上网  \n虚拟机之间为局域网，其中有一台虚拟机vhost1通过与外网相连，所有局域网中的虚拟机又通过vhost1来实现上外网。这样vhost1就可以监控整个虚拟机局域网上网情况了。\n\n### xp下全屏\n\n安装增强包后再全局设置里设置成本机的分辨率 ![](http://7xq3ry.com1.z0.glb.clouddn.com/20160119172333.png)\n\n### Ubuntu全屏\n\n首先，安装增强包，点击Run Software![](http://7xq3ry.com1.z0.glb.clouddn.com/20160114170837.png) 重启虚拟机  \n点击设备->分配光驱->移除虚拟盘  \n点击 右Ctrl+F全屏快捷键\n\n### Ubuntu设置桥接网卡\n\n在设置->网络->连接方式->桥接网卡\n\n    sudo vim /etc/network/interfaces\n    \n\n修改配置文件,对应的信息要和主机的一致，保证虚拟机和主机在同一IP段\n\n    # The primary network interface\n    auto eth0\n    iface eth0 inet static\n    address 192.168.2.1\n    gateway 192.168.2.254\n    netmask 255.255.255.0\n    #network 192.168.2.0\n    #broadcast 192.168.2.255\n    \n\n重启\n\n    sudo /etc/init.d/networking restart\n    \n\n在主机中设置上级路由器，放行虚拟机的MAC地址保证虚拟机可以访问外网。","source":"_posts/oracle virtualbox入门基础.md","raw":"---\ntitle: oracle virtualbox入门基础\nurl: 11.html\nid: 11\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-08 09:09:01\ntags:\n---\n\n### 安装和主机共享\n\n> 点击设备，安装增强功能\n\n### 共享剪贴板\n\n> 点击设备，共享剪贴板，双向\n\n### 快捷键\n\n> 显示客户机菜单 右Ctrl+C 全屏快捷键 右Ctrl+F\n\n### 4中网络连接形式(以下内容来自网络)\n\n**第一种 NAT模式**  \n解释： NAT模式是最简单的实现虚拟机上网的方式，你可以这样理解：Vhost访问网络的所有数据都是由主机提供的，vhost并不真实存在于网络中，主机与网络中的任何机器都不能查看和访问到Vhost的存在。  \n虚拟机与主机关系：  \n只能单向访问，虚拟机可以通过网络访问到主机，主机无法通过网络访问到虚拟机。  \n虚拟机与网络中其他主机的关系：  \n只能单向访问，虚拟机可以访问到网络中其他主机，其他主机不能通过网络访问到虚拟机。  \n虚拟机与虚拟机之间的关系：  \n相互不能访问，虚拟机与虚拟机各自完全独立，相互间无法通过网络访问彼此。  \nIP:10.0.2.15  \n网关：10.0.2.2  \nDNS：10.0.2.3  \n一台虚拟机的多个网卡可以被设定使用 NAT， 第一个网卡连接了到专用网 10.0.2.0，第二个网卡连接到专用网络 10.0.3.0，等等。默认得到的客户端ip（IP Address）是10.0.2.15，网关（Gateway）是10.0.2.2，域名服务器（DNS）是10.0.2.3，可以手动参考这个进行修改。  \nNAT方案优缺点：  \n笔记本已插网线时： 虚拟机可以访问主机，虚拟机可以访问互联网，在做了端口映射后（最后有说明），主机可以访问虚拟机上的服务（如数据库）。  \n笔记本没插网线时： 主机的“本地连接”有红叉的，虚拟机可以访问主机，虚拟机不可以访问互联网，在做了端口映射后，主机可以访问虚拟机上的服务（如数据库）。 **第二种 Bridged Adapter模式**  \n解释：  \n网桥模式是我最喜欢的用的一种模式，同时，模拟度也是相当完美。你可以这样理解，它是通过主机网卡，架设了一条桥，直接连入到网络中了。因此，它使得虚拟机能被分配到一个网络中独立的IP，所有网络功能完全和在网络中的真实机器一样。  \n虚拟机与主机关系：  \n可以相互访问，因为虚拟机在真实网络段中有独立IP，主机与虚拟机处于同一网络段中，彼此可以通过各自IP相互访问。  \n虚拟机于网络中其他主机关系：  \n可以相互访问，同样因为虚拟机在真实网络段中有独立IP，虚拟机与所有网络其他主机处于同一网络段中，彼此可以通过各自IP相互访问。  \n虚拟机于虚拟机关系：  \n可以相互访问，原因同上。  \nIP：一般是DHCP分配的，与主机的“本地连接”的IP 是同一网段的。虚拟机就能与主机互相通信。  \n笔记本已插网线时：（若网络中有DHCP服务器）主机与虚拟机会通过DHCP分别得到一个IP，这两个IP在同一网段。 主机与虚拟机可以ping通，虚拟机可以上互联网。  \n笔记本没插网线时：主机与虚拟机不能通信。主机的“本地连接”有红叉，就不能手工指定IP。虚拟机也不能通过DHCP得到IP地址，手工指定IP后，也无法与主机通信，因为主机无IP。  \n这时主机的VirtualBox Host-Only Network 网卡是有ip的，192.168.56.1。虚拟机就算手工指定了IP 192.168.56.*，也ping不能主机。 **第三种 Internal模式**  \n解释：  \n内网模式，顾名思义就是内部网络模式，虚拟机与外网完全断开，只实现虚拟机于虚拟机之间的内部网络模式。  \n虚拟机与主机关系：  \n不能相互访问，彼此不属于同一个网络，无法相互访问。  \n虚拟机与网络中其他主机关系：  \n不能相互访问，理由同上。  \n虚拟机与虚拟机关系：  \n可以相互访问，前提是在设置网络时，两台虚拟机设置同一网络名称。如上配置图中，名称为intnet。  \nIP: VirtualBox的DHCP服务器会为它分配IP ，一般得到的是192.168.56.101，因为是从101起分的，也可手工指定192.168.56.*。  \n笔记本已插网线时：虚拟机可以与主机的VirtualBox Host-Only Network 网卡通信  \n这种方案不受主机本地连接（网卡）是否有红叉的影响。 **第四种 Host-only Adapter模式**  \n解释：  \n主机模式，这是一种比较复杂的模式，需要有比较扎实的网络基础知识才能玩转。可以说前面几种模式所实现的功能，在这种模式下，通过虚拟机及网卡的设置都可以被实现。  \n我们可以理解为Vbox在主机中模拟出一张专供虚拟机使用的网卡，所有虚拟机都是连接到该网卡上的，我们可以通过设置这张网卡来实现上网及其他很多功能，比如（网卡共享、网卡桥接等）。  \n虚拟机与主机关系  \n默认不能相互访问，双方不属于同一IP段，host-only网卡默认IP段为192.168.56.X 子网掩码为255.255.255.0，后面的虚拟机被分配到的也都是这个网段。通过网卡共享、网卡桥接等，可以实现虚拟机于主机相互访问。  \n虚拟机与网络主机关系  \n默认不能相互访问，原因同上，通过设置，可以实现相互访问。  \n虚拟机与虚拟机关系  \n默认可以相互访问，都是同处于一个网段。  \n虚拟机访问主机 用的是主机的VirtualBox Host-Only Network网卡的IP：192.168.56.1 ，不管主机“本地连接”有无红叉，永远通。  \n主机访问虚拟机，用是的虚拟机的网卡3的IP： 192.168.56.101 ，不管主机“本地连接”有无红叉，永远通。  \n虚拟机访问互联网，用的是自己的网卡2， 这时主机要能通过“本地连接”有线上网，（无线网卡不行） 通过对以上几种网络模式的了解，我们就可以灵活运用，模拟组建出我们所想要的任何一种网络环境了。  \n比如我想模拟出来一个一台主机，监控一个局域网上网情况的网络环境。  \n首先我开启了两台虚拟机vhost1与vhost2，当然如果硬件允许，我同样可以再增加vhost3、vhost4…  \n所有的vhost我都设置成internat内网模式，网络名称为intnal，网关为192.168.56.100，意思就是通过 192.168.56.100网卡上网。其中有一台vhost1我设置为双网卡，一张为内网模式（192.168.56.100），一张为网桥模式 （192.168.1.101）。两张网卡设置双网卡共享上网  \n虚拟机之间为局域网，其中有一台虚拟机vhost1通过与外网相连，所有局域网中的虚拟机又通过vhost1来实现上外网。这样vhost1就可以监控整个虚拟机局域网上网情况了。\n\n### xp下全屏\n\n安装增强包后再全局设置里设置成本机的分辨率 ![](http://7xq3ry.com1.z0.glb.clouddn.com/20160119172333.png)\n\n### Ubuntu全屏\n\n首先，安装增强包，点击Run Software![](http://7xq3ry.com1.z0.glb.clouddn.com/20160114170837.png) 重启虚拟机  \n点击设备->分配光驱->移除虚拟盘  \n点击 右Ctrl+F全屏快捷键\n\n### Ubuntu设置桥接网卡\n\n在设置->网络->连接方式->桥接网卡\n\n    sudo vim /etc/network/interfaces\n    \n\n修改配置文件,对应的信息要和主机的一致，保证虚拟机和主机在同一IP段\n\n    # The primary network interface\n    auto eth0\n    iface eth0 inet static\n    address 192.168.2.1\n    gateway 192.168.2.254\n    netmask 255.255.255.0\n    #network 192.168.2.0\n    #broadcast 192.168.2.255\n    \n\n重启\n\n    sudo /etc/init.d/networking restart\n    \n\n在主机中设置上级路由器，放行虚拟机的MAC地址保证虚拟机可以访问外网。","slug":"oracle virtualbox入门基础","published":1,"updated":"2019-07-24T01:28:51.966Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5o7001x9ka4igwl8sji","content":"<h3 id=\"安装和主机共享\"><a href=\"#安装和主机共享\" class=\"headerlink\" title=\"安装和主机共享\"></a>安装和主机共享</h3><blockquote>\n<p>点击设备，安装增强功能</p>\n</blockquote>\n<h3 id=\"共享剪贴板\"><a href=\"#共享剪贴板\" class=\"headerlink\" title=\"共享剪贴板\"></a>共享剪贴板</h3><blockquote>\n<p>点击设备，共享剪贴板，双向</p>\n</blockquote>\n<h3 id=\"快捷键\"><a href=\"#快捷键\" class=\"headerlink\" title=\"快捷键\"></a>快捷键</h3><blockquote>\n<p>显示客户机菜单 右Ctrl+C 全屏快捷键 右Ctrl+F</p>\n</blockquote>\n<h3 id=\"4中网络连接形式-以下内容来自网络\"><a href=\"#4中网络连接形式-以下内容来自网络\" class=\"headerlink\" title=\"4中网络连接形式(以下内容来自网络)\"></a>4中网络连接形式(以下内容来自网络)</h3><p><strong>第一种 NAT模式</strong><br>解释： NAT模式是最简单的实现虚拟机上网的方式，你可以这样理解：Vhost访问网络的所有数据都是由主机提供的，vhost并不真实存在于网络中，主机与网络中的任何机器都不能查看和访问到Vhost的存在。<br>虚拟机与主机关系：<br>只能单向访问，虚拟机可以通过网络访问到主机，主机无法通过网络访问到虚拟机。<br>虚拟机与网络中其他主机的关系：<br>只能单向访问，虚拟机可以访问到网络中其他主机，其他主机不能通过网络访问到虚拟机。<br>虚拟机与虚拟机之间的关系：<br>相互不能访问，虚拟机与虚拟机各自完全独立，相互间无法通过网络访问彼此。<br>IP:10.0.2.15<br>网关：10.0.2.2<br>DNS：10.0.2.3<br>一台虚拟机的多个网卡可以被设定使用 NAT， 第一个网卡连接了到专用网 10.0.2.0，第二个网卡连接到专用网络 10.0.3.0，等等。默认得到的客户端ip（IP Address）是10.0.2.15，网关（Gateway）是10.0.2.2，域名服务器（DNS）是10.0.2.3，可以手动参考这个进行修改。<br>NAT方案优缺点：<br>笔记本已插网线时： 虚拟机可以访问主机，虚拟机可以访问互联网，在做了端口映射后（最后有说明），主机可以访问虚拟机上的服务（如数据库）。<br>笔记本没插网线时： 主机的“本地连接”有红叉的，虚拟机可以访问主机，虚拟机不可以访问互联网，在做了端口映射后，主机可以访问虚拟机上的服务（如数据库）。 <strong>第二种 Bridged Adapter模式</strong><br>解释：<br>网桥模式是我最喜欢的用的一种模式，同时，模拟度也是相当完美。你可以这样理解，它是通过主机网卡，架设了一条桥，直接连入到网络中了。因此，它使得虚拟机能被分配到一个网络中独立的IP，所有网络功能完全和在网络中的真实机器一样。<br>虚拟机与主机关系：<br>可以相互访问，因为虚拟机在真实网络段中有独立IP，主机与虚拟机处于同一网络段中，彼此可以通过各自IP相互访问。<br>虚拟机于网络中其他主机关系：<br>可以相互访问，同样因为虚拟机在真实网络段中有独立IP，虚拟机与所有网络其他主机处于同一网络段中，彼此可以通过各自IP相互访问。<br>虚拟机于虚拟机关系：<br>可以相互访问，原因同上。<br>IP：一般是DHCP分配的，与主机的“本地连接”的IP 是同一网段的。虚拟机就能与主机互相通信。<br>笔记本已插网线时：（若网络中有DHCP服务器）主机与虚拟机会通过DHCP分别得到一个IP，这两个IP在同一网段。 主机与虚拟机可以ping通，虚拟机可以上互联网。<br>笔记本没插网线时：主机与虚拟机不能通信。主机的“本地连接”有红叉，就不能手工指定IP。虚拟机也不能通过DHCP得到IP地址，手工指定IP后，也无法与主机通信，因为主机无IP。<br>这时主机的VirtualBox Host-Only Network 网卡是有ip的，192.168.56.1。虚拟机就算手工指定了IP 192.168.56.<em>，也ping不能主机。 *</em>第三种 Internal模式**<br>解释：<br>内网模式，顾名思义就是内部网络模式，虚拟机与外网完全断开，只实现虚拟机于虚拟机之间的内部网络模式。<br>虚拟机与主机关系：<br>不能相互访问，彼此不属于同一个网络，无法相互访问。<br>虚拟机与网络中其他主机关系：<br>不能相互访问，理由同上。<br>虚拟机与虚拟机关系：<br>可以相互访问，前提是在设置网络时，两台虚拟机设置同一网络名称。如上配置图中，名称为intnet。<br>IP: VirtualBox的DHCP服务器会为它分配IP ，一般得到的是192.168.56.101，因为是从101起分的，也可手工指定192.168.56.<em>。<br>笔记本已插网线时：虚拟机可以与主机的VirtualBox Host-Only Network 网卡通信<br>这种方案不受主机本地连接（网卡）是否有红叉的影响。 *</em>第四种 Host-only Adapter模式**<br>解释：<br>主机模式，这是一种比较复杂的模式，需要有比较扎实的网络基础知识才能玩转。可以说前面几种模式所实现的功能，在这种模式下，通过虚拟机及网卡的设置都可以被实现。<br>我们可以理解为Vbox在主机中模拟出一张专供虚拟机使用的网卡，所有虚拟机都是连接到该网卡上的，我们可以通过设置这张网卡来实现上网及其他很多功能，比如（网卡共享、网卡桥接等）。<br>虚拟机与主机关系<br>默认不能相互访问，双方不属于同一IP段，host-only网卡默认IP段为192.168.56.X 子网掩码为255.255.255.0，后面的虚拟机被分配到的也都是这个网段。通过网卡共享、网卡桥接等，可以实现虚拟机于主机相互访问。<br>虚拟机与网络主机关系<br>默认不能相互访问，原因同上，通过设置，可以实现相互访问。<br>虚拟机与虚拟机关系<br>默认可以相互访问，都是同处于一个网段。<br>虚拟机访问主机 用的是主机的VirtualBox Host-Only Network网卡的IP：192.168.56.1 ，不管主机“本地连接”有无红叉，永远通。<br>主机访问虚拟机，用是的虚拟机的网卡3的IP： 192.168.56.101 ，不管主机“本地连接”有无红叉，永远通。<br>虚拟机访问互联网，用的是自己的网卡2， 这时主机要能通过“本地连接”有线上网，（无线网卡不行） 通过对以上几种网络模式的了解，我们就可以灵活运用，模拟组建出我们所想要的任何一种网络环境了。<br>比如我想模拟出来一个一台主机，监控一个局域网上网情况的网络环境。<br>首先我开启了两台虚拟机vhost1与vhost2，当然如果硬件允许，我同样可以再增加vhost3、vhost4…<br>所有的vhost我都设置成internat内网模式，网络名称为intnal，网关为192.168.56.100，意思就是通过 192.168.56.100网卡上网。其中有一台vhost1我设置为双网卡，一张为内网模式（192.168.56.100），一张为网桥模式 （192.168.1.101）。两张网卡设置双网卡共享上网<br>虚拟机之间为局域网，其中有一台虚拟机vhost1通过与外网相连，所有局域网中的虚拟机又通过vhost1来实现上外网。这样vhost1就可以监控整个虚拟机局域网上网情况了。</p>\n<h3 id=\"xp下全屏\"><a href=\"#xp下全屏\" class=\"headerlink\" title=\"xp下全屏\"></a>xp下全屏</h3><p>安装增强包后再全局设置里设置成本机的分辨率 <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160119172333.png\" alt></p>\n<h3 id=\"Ubuntu全屏\"><a href=\"#Ubuntu全屏\" class=\"headerlink\" title=\"Ubuntu全屏\"></a>Ubuntu全屏</h3><p>首先，安装增强包，点击Run Software<img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160114170837.png\" alt> 重启虚拟机<br>点击设备-&gt;分配光驱-&gt;移除虚拟盘<br>点击 右Ctrl+F全屏快捷键</p>\n<h3 id=\"Ubuntu设置桥接网卡\"><a href=\"#Ubuntu设置桥接网卡\" class=\"headerlink\" title=\"Ubuntu设置桥接网卡\"></a>Ubuntu设置桥接网卡</h3><p>在设置-&gt;网络-&gt;连接方式-&gt;桥接网卡</p>\n<pre><code>sudo vim /etc/network/interfaces</code></pre><p>修改配置文件,对应的信息要和主机的一致，保证虚拟机和主机在同一IP段</p>\n<pre><code># The primary network interface\nauto eth0\niface eth0 inet static\naddress 192.168.2.1\ngateway 192.168.2.254\nnetmask 255.255.255.0\n#network 192.168.2.0\n#broadcast 192.168.2.255</code></pre><p>重启</p>\n<pre><code>sudo /etc/init.d/networking restart</code></pre><p>在主机中设置上级路由器，放行虚拟机的MAC地址保证虚拟机可以访问外网。</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"安装和主机共享\"><a href=\"#安装和主机共享\" class=\"headerlink\" title=\"安装和主机共享\"></a>安装和主机共享</h3><blockquote>\n<p>点击设备，安装增强功能</p>\n</blockquote>\n<h3 id=\"共享剪贴板\"><a href=\"#共享剪贴板\" class=\"headerlink\" title=\"共享剪贴板\"></a>共享剪贴板</h3><blockquote>\n<p>点击设备，共享剪贴板，双向</p>\n</blockquote>\n<h3 id=\"快捷键\"><a href=\"#快捷键\" class=\"headerlink\" title=\"快捷键\"></a>快捷键</h3><blockquote>\n<p>显示客户机菜单 右Ctrl+C 全屏快捷键 右Ctrl+F</p>\n</blockquote>\n<h3 id=\"4中网络连接形式-以下内容来自网络\"><a href=\"#4中网络连接形式-以下内容来自网络\" class=\"headerlink\" title=\"4中网络连接形式(以下内容来自网络)\"></a>4中网络连接形式(以下内容来自网络)</h3><p><strong>第一种 NAT模式</strong><br>解释： NAT模式是最简单的实现虚拟机上网的方式，你可以这样理解：Vhost访问网络的所有数据都是由主机提供的，vhost并不真实存在于网络中，主机与网络中的任何机器都不能查看和访问到Vhost的存在。<br>虚拟机与主机关系：<br>只能单向访问，虚拟机可以通过网络访问到主机，主机无法通过网络访问到虚拟机。<br>虚拟机与网络中其他主机的关系：<br>只能单向访问，虚拟机可以访问到网络中其他主机，其他主机不能通过网络访问到虚拟机。<br>虚拟机与虚拟机之间的关系：<br>相互不能访问，虚拟机与虚拟机各自完全独立，相互间无法通过网络访问彼此。<br>IP:10.0.2.15<br>网关：10.0.2.2<br>DNS：10.0.2.3<br>一台虚拟机的多个网卡可以被设定使用 NAT， 第一个网卡连接了到专用网 10.0.2.0，第二个网卡连接到专用网络 10.0.3.0，等等。默认得到的客户端ip（IP Address）是10.0.2.15，网关（Gateway）是10.0.2.2，域名服务器（DNS）是10.0.2.3，可以手动参考这个进行修改。<br>NAT方案优缺点：<br>笔记本已插网线时： 虚拟机可以访问主机，虚拟机可以访问互联网，在做了端口映射后（最后有说明），主机可以访问虚拟机上的服务（如数据库）。<br>笔记本没插网线时： 主机的“本地连接”有红叉的，虚拟机可以访问主机，虚拟机不可以访问互联网，在做了端口映射后，主机可以访问虚拟机上的服务（如数据库）。 <strong>第二种 Bridged Adapter模式</strong><br>解释：<br>网桥模式是我最喜欢的用的一种模式，同时，模拟度也是相当完美。你可以这样理解，它是通过主机网卡，架设了一条桥，直接连入到网络中了。因此，它使得虚拟机能被分配到一个网络中独立的IP，所有网络功能完全和在网络中的真实机器一样。<br>虚拟机与主机关系：<br>可以相互访问，因为虚拟机在真实网络段中有独立IP，主机与虚拟机处于同一网络段中，彼此可以通过各自IP相互访问。<br>虚拟机于网络中其他主机关系：<br>可以相互访问，同样因为虚拟机在真实网络段中有独立IP，虚拟机与所有网络其他主机处于同一网络段中，彼此可以通过各自IP相互访问。<br>虚拟机于虚拟机关系：<br>可以相互访问，原因同上。<br>IP：一般是DHCP分配的，与主机的“本地连接”的IP 是同一网段的。虚拟机就能与主机互相通信。<br>笔记本已插网线时：（若网络中有DHCP服务器）主机与虚拟机会通过DHCP分别得到一个IP，这两个IP在同一网段。 主机与虚拟机可以ping通，虚拟机可以上互联网。<br>笔记本没插网线时：主机与虚拟机不能通信。主机的“本地连接”有红叉，就不能手工指定IP。虚拟机也不能通过DHCP得到IP地址，手工指定IP后，也无法与主机通信，因为主机无IP。<br>这时主机的VirtualBox Host-Only Network 网卡是有ip的，192.168.56.1。虚拟机就算手工指定了IP 192.168.56.<em>，也ping不能主机。 *</em>第三种 Internal模式**<br>解释：<br>内网模式，顾名思义就是内部网络模式，虚拟机与外网完全断开，只实现虚拟机于虚拟机之间的内部网络模式。<br>虚拟机与主机关系：<br>不能相互访问，彼此不属于同一个网络，无法相互访问。<br>虚拟机与网络中其他主机关系：<br>不能相互访问，理由同上。<br>虚拟机与虚拟机关系：<br>可以相互访问，前提是在设置网络时，两台虚拟机设置同一网络名称。如上配置图中，名称为intnet。<br>IP: VirtualBox的DHCP服务器会为它分配IP ，一般得到的是192.168.56.101，因为是从101起分的，也可手工指定192.168.56.<em>。<br>笔记本已插网线时：虚拟机可以与主机的VirtualBox Host-Only Network 网卡通信<br>这种方案不受主机本地连接（网卡）是否有红叉的影响。 *</em>第四种 Host-only Adapter模式**<br>解释：<br>主机模式，这是一种比较复杂的模式，需要有比较扎实的网络基础知识才能玩转。可以说前面几种模式所实现的功能，在这种模式下，通过虚拟机及网卡的设置都可以被实现。<br>我们可以理解为Vbox在主机中模拟出一张专供虚拟机使用的网卡，所有虚拟机都是连接到该网卡上的，我们可以通过设置这张网卡来实现上网及其他很多功能，比如（网卡共享、网卡桥接等）。<br>虚拟机与主机关系<br>默认不能相互访问，双方不属于同一IP段，host-only网卡默认IP段为192.168.56.X 子网掩码为255.255.255.0，后面的虚拟机被分配到的也都是这个网段。通过网卡共享、网卡桥接等，可以实现虚拟机于主机相互访问。<br>虚拟机与网络主机关系<br>默认不能相互访问，原因同上，通过设置，可以实现相互访问。<br>虚拟机与虚拟机关系<br>默认可以相互访问，都是同处于一个网段。<br>虚拟机访问主机 用的是主机的VirtualBox Host-Only Network网卡的IP：192.168.56.1 ，不管主机“本地连接”有无红叉，永远通。<br>主机访问虚拟机，用是的虚拟机的网卡3的IP： 192.168.56.101 ，不管主机“本地连接”有无红叉，永远通。<br>虚拟机访问互联网，用的是自己的网卡2， 这时主机要能通过“本地连接”有线上网，（无线网卡不行） 通过对以上几种网络模式的了解，我们就可以灵活运用，模拟组建出我们所想要的任何一种网络环境了。<br>比如我想模拟出来一个一台主机，监控一个局域网上网情况的网络环境。<br>首先我开启了两台虚拟机vhost1与vhost2，当然如果硬件允许，我同样可以再增加vhost3、vhost4…<br>所有的vhost我都设置成internat内网模式，网络名称为intnal，网关为192.168.56.100，意思就是通过 192.168.56.100网卡上网。其中有一台vhost1我设置为双网卡，一张为内网模式（192.168.56.100），一张为网桥模式 （192.168.1.101）。两张网卡设置双网卡共享上网<br>虚拟机之间为局域网，其中有一台虚拟机vhost1通过与外网相连，所有局域网中的虚拟机又通过vhost1来实现上外网。这样vhost1就可以监控整个虚拟机局域网上网情况了。</p>\n<h3 id=\"xp下全屏\"><a href=\"#xp下全屏\" class=\"headerlink\" title=\"xp下全屏\"></a>xp下全屏</h3><p>安装增强包后再全局设置里设置成本机的分辨率 <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160119172333.png\" alt></p>\n<h3 id=\"Ubuntu全屏\"><a href=\"#Ubuntu全屏\" class=\"headerlink\" title=\"Ubuntu全屏\"></a>Ubuntu全屏</h3><p>首先，安装增强包，点击Run Software<img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160114170837.png\" alt> 重启虚拟机<br>点击设备-&gt;分配光驱-&gt;移除虚拟盘<br>点击 右Ctrl+F全屏快捷键</p>\n<h3 id=\"Ubuntu设置桥接网卡\"><a href=\"#Ubuntu设置桥接网卡\" class=\"headerlink\" title=\"Ubuntu设置桥接网卡\"></a>Ubuntu设置桥接网卡</h3><p>在设置-&gt;网络-&gt;连接方式-&gt;桥接网卡</p>\n<pre><code>sudo vim /etc/network/interfaces</code></pre><p>修改配置文件,对应的信息要和主机的一致，保证虚拟机和主机在同一IP段</p>\n<pre><code># The primary network interface\nauto eth0\niface eth0 inet static\naddress 192.168.2.1\ngateway 192.168.2.254\nnetmask 255.255.255.0\n#network 192.168.2.0\n#broadcast 192.168.2.255</code></pre><p>重启</p>\n<pre><code>sudo /etc/init.d/networking restart</code></pre><p>在主机中设置上级路由器，放行虚拟机的MAC地址保证虚拟机可以访问外网。</p>\n"},{"title":"postgresql入门基础","url":"528.html","id":"528","comments":0,"date":"2018-08-07T05:55:57.000Z","_content":"\n#### manjaro安装\n##### 安装postgresql\n```\n$ git clone https://aur.archlinux.org/postgresql-9.6.git\n$ cd postgresql-9.6-git\n$ less PKGBUILD  # 查看\n$ makepkg -si  # 安装\n```\n\n```\n# 初始化数据\n$ sudo su postgres -l \n$ initdb --locale $LANG -E UTF8 -D '/var/lib/postgres/data/'\n$ exit\n```\n\n```\n# 启动及开机启动\nsudo systemctl start postgresql.service \nsudo systemctl enable postgresql.service\n```\n\n```\n# 登录\n$ sudo su postgres -l\n$ psql\n```\n\n##### 安装postgis\n\n1, 安装proj4.9\n\n下载源码 [地址](<https://proj.org/download.html>)\n\n```\ntar xfz proj-4.9.3.tar.gz\ncd proj-4.9.3\n./configure\nmake\nsudo make install\n# 安装postgis时，如果没有找到库则需要复制动态库\nsudo ln -s /usr/local/lib/libproj.so.12 /usr/lib/libproj.so.12\n```\n\n2, 安装postgis2.5.2\n\n下载源码 [地址](<https://postgis.net/source/>)\n\n```\nwget http://download.osgeo.org/postgis/source/postgis-2.5.2.tar.gz\ntar xfz postgis-2.5.2.tar.gz\ncd postgis-2.5.2\n./configure\nmake\nsudo make install\nsudo ldconfig\nsudo make comments-install\n```\n##### 创建库\n```\n# 第一件事是使用\\password命令，为postgres用户设置一个密码。\npostgres=# \\password postgres\n# 第二件事是创建数据库用户dbuser（刚才创建的是Linux系统用户），并设置密码。\npostgres=# CREATE USER dbuser WITH PASSWORD 'password';\n# 第三件事是创建用户数据库，这里为exampledb，并指定所有者为dbuser。\npostgres=# CREATE DATABASE exampledb OWNER dbuser;\n# 第四件事是将exampledb数据库的所有权限都赋予dbuser，否则dbuser只能登录控制台，没有数据库操作权限。\npostgres=# GRANT ALL PRIVILEGES ON DATABASE exampledb to dbuser;\n```\n\n\n#### ubuntu/centos安装\n\n[ubuntu安装](https://www.postgresql.org/download/linux/ubuntu/) [centos安装](https://www.postgresql.org/download/linux/redhat/) centos7.2 安装postgresql9.6\n\n    # 添加RPM\n    yum install https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-7-x86_64/pgdg-centos96-9.6-3.noarch.rpm\n    \n    # 安装PostgreSQL 9.6\n    # postgresql96-server 数据库核心服务端\n    # postgresql96-contrib 附加第三方扩展\n    # postgresql96-devel C语言开发Header头文件和库\n    yum install postgresql96-server postgresql96-contrib postgresql96-devel\n    \n    # 验证是否安装成功\n    rpm -aq| grep postgres\n    \n\n    # 设置目录（可省略）\n    cd /mnt\n    sudo mkdir vdb1\n    sudo chown -R postgres:postgres vdb1\n    sudo chmod 700 vdb1\n    vi /usr/lib/systemd/system/postgresql-9.6.service\n    Environment=PGDATA=/mnt/vdb1/ 修改为自己的新的数据路径\n    \n\n    # 初始化数据库\n    sudo /usr/pgsql-9.6/bin/postgresql96-setup initdb\n    # 开启服务\n    sudo service postgresql-9.6 start 或者 systemctl start postgresql-9.6.service\n    # 开机启动\n    sudo sudo chkconfig postgresql-9.6 on 或者 systemctl enable postgresql-9.6.service\n    \n\n    # 配置文件\n     /var/lib/pgsql/9.6/data/postgresql.conf 通用设置\n     /var/lib/pgsql/9.6/data/pg_hba.conf  控制访问安全\n     /var/lib/pgsql/9.6/data/pg_ident.conf 配合pg_hba.conf使用  \n    \n\n    sudo su postgres\n    psql # 进入命令行模式\n    # 修改密码\n    ALTER USER postgres WITH PASSWORD '密码'; \n    # 创建用户\n    CREATE USER userdoneself WITH PASSWORD '密码passworddoneself';\n    # 创建数据库\n    create --encoding=UTF8 database dbdoneself owner userdoneself;\n    # 赋予权限\n    grant all privileges on database dbdoneself to userdoneself;\n    \\q\n    # 安装postgresql时，系统会自动创建postgres用户\n    \n\n    # 开启远程访问\n    vi /var/lib/pgsql/9.6/data/postgresql.conf 或者  vi /mnt/vdb1/postgresql.conf(创建了目录)\n    \n    修改#listen_addresses = 'localhost' 为  listen_addresses='*'\n    \n\n    # 连接数据库\n    先配置登录权限\n    vim pg_hba.conf\n    # 是否远程登录 数据库 用户名 ip地段 方式\n    # 允许doneself用户远程访问\n    host doneself doneself 127.0.0.1/32 md5\n    # 允许管理员密码登录\n    local all postgres  md5\n    # 如果不知道怎么配置， 将全部登录方式改成md5\n    \n    # 查看版本\n    /usr/pgsql-9.6/bin/psql --version\n    \n\n#### 安装postgis2\n\ncentos7.2\n\n    sudo yum install postgis2_96  # 96和安装的postgresql一致\n    sudo yum install ogr_fdw96  # 安装ogrfdw\n    sudo yum install pgrouting_96 # 安装pgrouting\n    \n\n    # 用管理员登录postgerysql\n    >-- Enable PostGIS (includes raster)\n    CREATE EXTENSION postgis;\n    -- Enable Topology\n    CREATE EXTENSION postgis_topology;\n    -- Enable PostGIS Advanced 3D\n    -- and other geoprocessing algorithms\n    -- sfcgal not available with all distributions\n    CREATE EXTENSION postgis_sfcgal;\n    -- fuzzy matching needed for Tiger\n    CREATE EXTENSION fuzzystrmatch;\n    -- rule based standardizer\n    CREATE EXTENSION address_standardizer;\n    -- example rule data set\n    CREATE EXTENSION address_standardizer_data_us;\n    -- Enable US Tiger Geocoder\n    CREATE EXTENSION postgis_tiger_geocoder;\n    \n    # 验证是否安装成功\n    #postgres=> postgis_full_version();\n    \n\n#### 安装postgresql中文全文搜索zhparser\n\ncentos7.2\n\n     yum install bzip2  # 安装解压包\n     # 安装SCWS中文分词 https://github.com/hightman/scws\n     wget http://www.xunsearch.com/scws/down/scws-1.2.3.tar.bz2\n     tar -jxvf scws-1.2.3.tar.bz2 \n     cd scws-1.2.3\n     ./configure\n     make install\n     # 测试\n     scws '请问怎么自己动手做西红柿蛋炒饭' -c utf-8\n     # 安装zhparser\n     git clone https://github.com/amutu/zhparser.git\n     cd zhparser\n    export PATH=$PATH:/usr/pgsql-9.6/bin/\n    cmake && make install\n    \n\n    # 登录（第一次登录）\n    > sudo su - postgres\n    # 修改可以md5登录后\n    > > psql -U user -D database -W\n    >  输入口令\n    # 创建用户\n    user=>  CREATE USER dbuser WITH PASSWORD 'password';\n    # 修改密码\n    user=>  ALTER USER dbuser WITH PASSWORD 'newpassword';\n    # 赋予权限\n    user=>  GRANT ALL PRIVILEGES ON DATABASE exampledb to dbuser;\n    # 允许用户创建数据库\n    user=> ALTER USER doneself CREATEDB;\n    # 设置为超级管理员\n    user=> ALTER ROLE doneself SUPERUSER;\n    # 创建数据库\n    user=>  Create database exampledb owner=dbuser  template= template1  ENCODING = 'UTF8';\n    # 选择数据库\n    user=> \\c database\n    # 查看当前数据库所有表\n    user=>  \\dt\n    user=>  \\d 数据库 —— 得到所有表的名字\n    user=>  \\d 表名 —— 得到表结构","source":"_posts/postgresql入门基础.md","raw":"---\ntitle: postgresql入门基础\nurl: 528.html\nid: 528\ncomments: false\ncategories:\n  - 后端\n  - 运维\ndate: 2018-08-07 13:55:57\ntags:\n---\n\n#### manjaro安装\n##### 安装postgresql\n```\n$ git clone https://aur.archlinux.org/postgresql-9.6.git\n$ cd postgresql-9.6-git\n$ less PKGBUILD  # 查看\n$ makepkg -si  # 安装\n```\n\n```\n# 初始化数据\n$ sudo su postgres -l \n$ initdb --locale $LANG -E UTF8 -D '/var/lib/postgres/data/'\n$ exit\n```\n\n```\n# 启动及开机启动\nsudo systemctl start postgresql.service \nsudo systemctl enable postgresql.service\n```\n\n```\n# 登录\n$ sudo su postgres -l\n$ psql\n```\n\n##### 安装postgis\n\n1, 安装proj4.9\n\n下载源码 [地址](<https://proj.org/download.html>)\n\n```\ntar xfz proj-4.9.3.tar.gz\ncd proj-4.9.3\n./configure\nmake\nsudo make install\n# 安装postgis时，如果没有找到库则需要复制动态库\nsudo ln -s /usr/local/lib/libproj.so.12 /usr/lib/libproj.so.12\n```\n\n2, 安装postgis2.5.2\n\n下载源码 [地址](<https://postgis.net/source/>)\n\n```\nwget http://download.osgeo.org/postgis/source/postgis-2.5.2.tar.gz\ntar xfz postgis-2.5.2.tar.gz\ncd postgis-2.5.2\n./configure\nmake\nsudo make install\nsudo ldconfig\nsudo make comments-install\n```\n##### 创建库\n```\n# 第一件事是使用\\password命令，为postgres用户设置一个密码。\npostgres=# \\password postgres\n# 第二件事是创建数据库用户dbuser（刚才创建的是Linux系统用户），并设置密码。\npostgres=# CREATE USER dbuser WITH PASSWORD 'password';\n# 第三件事是创建用户数据库，这里为exampledb，并指定所有者为dbuser。\npostgres=# CREATE DATABASE exampledb OWNER dbuser;\n# 第四件事是将exampledb数据库的所有权限都赋予dbuser，否则dbuser只能登录控制台，没有数据库操作权限。\npostgres=# GRANT ALL PRIVILEGES ON DATABASE exampledb to dbuser;\n```\n\n\n#### ubuntu/centos安装\n\n[ubuntu安装](https://www.postgresql.org/download/linux/ubuntu/) [centos安装](https://www.postgresql.org/download/linux/redhat/) centos7.2 安装postgresql9.6\n\n    # 添加RPM\n    yum install https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-7-x86_64/pgdg-centos96-9.6-3.noarch.rpm\n    \n    # 安装PostgreSQL 9.6\n    # postgresql96-server 数据库核心服务端\n    # postgresql96-contrib 附加第三方扩展\n    # postgresql96-devel C语言开发Header头文件和库\n    yum install postgresql96-server postgresql96-contrib postgresql96-devel\n    \n    # 验证是否安装成功\n    rpm -aq| grep postgres\n    \n\n    # 设置目录（可省略）\n    cd /mnt\n    sudo mkdir vdb1\n    sudo chown -R postgres:postgres vdb1\n    sudo chmod 700 vdb1\n    vi /usr/lib/systemd/system/postgresql-9.6.service\n    Environment=PGDATA=/mnt/vdb1/ 修改为自己的新的数据路径\n    \n\n    # 初始化数据库\n    sudo /usr/pgsql-9.6/bin/postgresql96-setup initdb\n    # 开启服务\n    sudo service postgresql-9.6 start 或者 systemctl start postgresql-9.6.service\n    # 开机启动\n    sudo sudo chkconfig postgresql-9.6 on 或者 systemctl enable postgresql-9.6.service\n    \n\n    # 配置文件\n     /var/lib/pgsql/9.6/data/postgresql.conf 通用设置\n     /var/lib/pgsql/9.6/data/pg_hba.conf  控制访问安全\n     /var/lib/pgsql/9.6/data/pg_ident.conf 配合pg_hba.conf使用  \n    \n\n    sudo su postgres\n    psql # 进入命令行模式\n    # 修改密码\n    ALTER USER postgres WITH PASSWORD '密码'; \n    # 创建用户\n    CREATE USER userdoneself WITH PASSWORD '密码passworddoneself';\n    # 创建数据库\n    create --encoding=UTF8 database dbdoneself owner userdoneself;\n    # 赋予权限\n    grant all privileges on database dbdoneself to userdoneself;\n    \\q\n    # 安装postgresql时，系统会自动创建postgres用户\n    \n\n    # 开启远程访问\n    vi /var/lib/pgsql/9.6/data/postgresql.conf 或者  vi /mnt/vdb1/postgresql.conf(创建了目录)\n    \n    修改#listen_addresses = 'localhost' 为  listen_addresses='*'\n    \n\n    # 连接数据库\n    先配置登录权限\n    vim pg_hba.conf\n    # 是否远程登录 数据库 用户名 ip地段 方式\n    # 允许doneself用户远程访问\n    host doneself doneself 127.0.0.1/32 md5\n    # 允许管理员密码登录\n    local all postgres  md5\n    # 如果不知道怎么配置， 将全部登录方式改成md5\n    \n    # 查看版本\n    /usr/pgsql-9.6/bin/psql --version\n    \n\n#### 安装postgis2\n\ncentos7.2\n\n    sudo yum install postgis2_96  # 96和安装的postgresql一致\n    sudo yum install ogr_fdw96  # 安装ogrfdw\n    sudo yum install pgrouting_96 # 安装pgrouting\n    \n\n    # 用管理员登录postgerysql\n    >-- Enable PostGIS (includes raster)\n    CREATE EXTENSION postgis;\n    -- Enable Topology\n    CREATE EXTENSION postgis_topology;\n    -- Enable PostGIS Advanced 3D\n    -- and other geoprocessing algorithms\n    -- sfcgal not available with all distributions\n    CREATE EXTENSION postgis_sfcgal;\n    -- fuzzy matching needed for Tiger\n    CREATE EXTENSION fuzzystrmatch;\n    -- rule based standardizer\n    CREATE EXTENSION address_standardizer;\n    -- example rule data set\n    CREATE EXTENSION address_standardizer_data_us;\n    -- Enable US Tiger Geocoder\n    CREATE EXTENSION postgis_tiger_geocoder;\n    \n    # 验证是否安装成功\n    #postgres=> postgis_full_version();\n    \n\n#### 安装postgresql中文全文搜索zhparser\n\ncentos7.2\n\n     yum install bzip2  # 安装解压包\n     # 安装SCWS中文分词 https://github.com/hightman/scws\n     wget http://www.xunsearch.com/scws/down/scws-1.2.3.tar.bz2\n     tar -jxvf scws-1.2.3.tar.bz2 \n     cd scws-1.2.3\n     ./configure\n     make install\n     # 测试\n     scws '请问怎么自己动手做西红柿蛋炒饭' -c utf-8\n     # 安装zhparser\n     git clone https://github.com/amutu/zhparser.git\n     cd zhparser\n    export PATH=$PATH:/usr/pgsql-9.6/bin/\n    cmake && make install\n    \n\n    # 登录（第一次登录）\n    > sudo su - postgres\n    # 修改可以md5登录后\n    > > psql -U user -D database -W\n    >  输入口令\n    # 创建用户\n    user=>  CREATE USER dbuser WITH PASSWORD 'password';\n    # 修改密码\n    user=>  ALTER USER dbuser WITH PASSWORD 'newpassword';\n    # 赋予权限\n    user=>  GRANT ALL PRIVILEGES ON DATABASE exampledb to dbuser;\n    # 允许用户创建数据库\n    user=> ALTER USER doneself CREATEDB;\n    # 设置为超级管理员\n    user=> ALTER ROLE doneself SUPERUSER;\n    # 创建数据库\n    user=>  Create database exampledb owner=dbuser  template= template1  ENCODING = 'UTF8';\n    # 选择数据库\n    user=> \\c database\n    # 查看当前数据库所有表\n    user=>  \\dt\n    user=>  \\d 数据库 —— 得到所有表的名字\n    user=>  \\d 表名 —— 得到表结构","slug":"postgresql入门基础","published":1,"updated":"2019-07-24T06:24:41.084Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5o8001z9ka4wz0goqmq","content":"<h4 id=\"manjaro安装\"><a href=\"#manjaro安装\" class=\"headerlink\" title=\"manjaro安装\"></a>manjaro安装</h4><h5 id=\"安装postgresql\"><a href=\"#安装postgresql\" class=\"headerlink\" title=\"安装postgresql\"></a>安装postgresql</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git clone https://aur.archlinux.org/postgresql-9.6.git</span><br><span class=\"line\">$ cd postgresql-9.6-git</span><br><span class=\"line\">$ less PKGBUILD  # 查看</span><br><span class=\"line\">$ makepkg -si  # 安装</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 初始化数据</span><br><span class=\"line\">$ sudo su postgres -l </span><br><span class=\"line\">$ initdb --locale $LANG -E UTF8 -D &apos;/var/lib/postgres/data/&apos;</span><br><span class=\"line\">$ exit</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 启动及开机启动</span><br><span class=\"line\">sudo systemctl start postgresql.service </span><br><span class=\"line\">sudo systemctl enable postgresql.service</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 登录</span><br><span class=\"line\">$ sudo su postgres -l</span><br><span class=\"line\">$ psql</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"安装postgis\"><a href=\"#安装postgis\" class=\"headerlink\" title=\"安装postgis\"></a>安装postgis</h5><p>1, 安装proj4.9</p>\n<p>下载源码 <a href=\"https://proj.org/download.html\" target=\"_blank\" rel=\"noopener\">地址</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar xfz proj-4.9.3.tar.gz</span><br><span class=\"line\">cd proj-4.9.3</span><br><span class=\"line\">./configure</span><br><span class=\"line\">make</span><br><span class=\"line\">sudo make install</span><br><span class=\"line\"># 安装postgis时，如果没有找到库则需要复制动态库</span><br><span class=\"line\">sudo ln -s /usr/local/lib/libproj.so.12 /usr/lib/libproj.so.12</span><br></pre></td></tr></table></figure>\n\n<p>2, 安装postgis2.5.2</p>\n<p>下载源码 <a href=\"https://postgis.net/source/\" target=\"_blank\" rel=\"noopener\">地址</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://download.osgeo.org/postgis/source/postgis-2.5.2.tar.gz</span><br><span class=\"line\">tar xfz postgis-2.5.2.tar.gz</span><br><span class=\"line\">cd postgis-2.5.2</span><br><span class=\"line\">./configure</span><br><span class=\"line\">make</span><br><span class=\"line\">sudo make install</span><br><span class=\"line\">sudo ldconfig</span><br><span class=\"line\">sudo make comments-install</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"创建库\"><a href=\"#创建库\" class=\"headerlink\" title=\"创建库\"></a>创建库</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 第一件事是使用\\password命令，为postgres用户设置一个密码。</span><br><span class=\"line\">postgres=# \\password postgres</span><br><span class=\"line\"># 第二件事是创建数据库用户dbuser（刚才创建的是Linux系统用户），并设置密码。</span><br><span class=\"line\">postgres=# CREATE USER dbuser WITH PASSWORD &apos;password&apos;;</span><br><span class=\"line\"># 第三件事是创建用户数据库，这里为exampledb，并指定所有者为dbuser。</span><br><span class=\"line\">postgres=# CREATE DATABASE exampledb OWNER dbuser;</span><br><span class=\"line\"># 第四件事是将exampledb数据库的所有权限都赋予dbuser，否则dbuser只能登录控制台，没有数据库操作权限。</span><br><span class=\"line\">postgres=# GRANT ALL PRIVILEGES ON DATABASE exampledb to dbuser;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ubuntu-centos安装\"><a href=\"#ubuntu-centos安装\" class=\"headerlink\" title=\"ubuntu/centos安装\"></a>ubuntu/centos安装</h4><p><a href=\"https://www.postgresql.org/download/linux/ubuntu/\" target=\"_blank\" rel=\"noopener\">ubuntu安装</a> <a href=\"https://www.postgresql.org/download/linux/redhat/\" target=\"_blank\" rel=\"noopener\">centos安装</a> centos7.2 安装postgresql9.6</p>\n<pre><code># 添加RPM\nyum install https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-7-x86_64/pgdg-centos96-9.6-3.noarch.rpm\n\n# 安装PostgreSQL 9.6\n# postgresql96-server 数据库核心服务端\n# postgresql96-contrib 附加第三方扩展\n# postgresql96-devel C语言开发Header头文件和库\nyum install postgresql96-server postgresql96-contrib postgresql96-devel\n\n# 验证是否安装成功\nrpm -aq| grep postgres\n\n\n# 设置目录（可省略）\ncd /mnt\nsudo mkdir vdb1\nsudo chown -R postgres:postgres vdb1\nsudo chmod 700 vdb1\nvi /usr/lib/systemd/system/postgresql-9.6.service\nEnvironment=PGDATA=/mnt/vdb1/ 修改为自己的新的数据路径\n\n\n# 初始化数据库\nsudo /usr/pgsql-9.6/bin/postgresql96-setup initdb\n# 开启服务\nsudo service postgresql-9.6 start 或者 systemctl start postgresql-9.6.service\n# 开机启动\nsudo sudo chkconfig postgresql-9.6 on 或者 systemctl enable postgresql-9.6.service\n\n\n# 配置文件\n /var/lib/pgsql/9.6/data/postgresql.conf 通用设置\n /var/lib/pgsql/9.6/data/pg_hba.conf  控制访问安全\n /var/lib/pgsql/9.6/data/pg_ident.conf 配合pg_hba.conf使用  \n\n\nsudo su postgres\npsql # 进入命令行模式\n# 修改密码\nALTER USER postgres WITH PASSWORD &apos;密码&apos;; \n# 创建用户\nCREATE USER userdoneself WITH PASSWORD &apos;密码passworddoneself&apos;;\n# 创建数据库\ncreate --encoding=UTF8 database dbdoneself owner userdoneself;\n# 赋予权限\ngrant all privileges on database dbdoneself to userdoneself;\n\\q\n# 安装postgresql时，系统会自动创建postgres用户\n\n\n# 开启远程访问\nvi /var/lib/pgsql/9.6/data/postgresql.conf 或者  vi /mnt/vdb1/postgresql.conf(创建了目录)\n\n修改#listen_addresses = &apos;localhost&apos; 为  listen_addresses=&apos;*&apos;\n\n\n# 连接数据库\n先配置登录权限\nvim pg_hba.conf\n# 是否远程登录 数据库 用户名 ip地段 方式\n# 允许doneself用户远程访问\nhost doneself doneself 127.0.0.1/32 md5\n# 允许管理员密码登录\nlocal all postgres  md5\n# 如果不知道怎么配置， 将全部登录方式改成md5\n\n# 查看版本\n/usr/pgsql-9.6/bin/psql --version</code></pre><h4 id=\"安装postgis2\"><a href=\"#安装postgis2\" class=\"headerlink\" title=\"安装postgis2\"></a>安装postgis2</h4><p>centos7.2</p>\n<pre><code>sudo yum install postgis2_96  # 96和安装的postgresql一致\nsudo yum install ogr_fdw96  # 安装ogrfdw\nsudo yum install pgrouting_96 # 安装pgrouting\n\n\n# 用管理员登录postgerysql\n&gt;-- Enable PostGIS (includes raster)\nCREATE EXTENSION postgis;\n-- Enable Topology\nCREATE EXTENSION postgis_topology;\n-- Enable PostGIS Advanced 3D\n-- and other geoprocessing algorithms\n-- sfcgal not available with all distributions\nCREATE EXTENSION postgis_sfcgal;\n-- fuzzy matching needed for Tiger\nCREATE EXTENSION fuzzystrmatch;\n-- rule based standardizer\nCREATE EXTENSION address_standardizer;\n-- example rule data set\nCREATE EXTENSION address_standardizer_data_us;\n-- Enable US Tiger Geocoder\nCREATE EXTENSION postgis_tiger_geocoder;\n\n# 验证是否安装成功\n#postgres=&gt; postgis_full_version();</code></pre><h4 id=\"安装postgresql中文全文搜索zhparser\"><a href=\"#安装postgresql中文全文搜索zhparser\" class=\"headerlink\" title=\"安装postgresql中文全文搜索zhparser\"></a>安装postgresql中文全文搜索zhparser</h4><p>centos7.2</p>\n<pre><code> yum install bzip2  # 安装解压包\n # 安装SCWS中文分词 https://github.com/hightman/scws\n wget http://www.xunsearch.com/scws/down/scws-1.2.3.tar.bz2\n tar -jxvf scws-1.2.3.tar.bz2 \n cd scws-1.2.3\n ./configure\n make install\n # 测试\n scws &apos;请问怎么自己动手做西红柿蛋炒饭&apos; -c utf-8\n # 安装zhparser\n git clone https://github.com/amutu/zhparser.git\n cd zhparser\nexport PATH=$PATH:/usr/pgsql-9.6/bin/\ncmake &amp;&amp; make install\n\n\n# 登录（第一次登录）\n&gt; sudo su - postgres\n# 修改可以md5登录后\n&gt; &gt; psql -U user -D database -W\n&gt;  输入口令\n# 创建用户\nuser=&gt;  CREATE USER dbuser WITH PASSWORD &apos;password&apos;;\n# 修改密码\nuser=&gt;  ALTER USER dbuser WITH PASSWORD &apos;newpassword&apos;;\n# 赋予权限\nuser=&gt;  GRANT ALL PRIVILEGES ON DATABASE exampledb to dbuser;\n# 允许用户创建数据库\nuser=&gt; ALTER USER doneself CREATEDB;\n# 设置为超级管理员\nuser=&gt; ALTER ROLE doneself SUPERUSER;\n# 创建数据库\nuser=&gt;  Create database exampledb owner=dbuser  template= template1  ENCODING = &apos;UTF8&apos;;\n# 选择数据库\nuser=&gt; \\c database\n# 查看当前数据库所有表\nuser=&gt;  \\dt\nuser=&gt;  \\d 数据库 —— 得到所有表的名字\nuser=&gt;  \\d 表名 —— 得到表结构</code></pre>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"manjaro安装\"><a href=\"#manjaro安装\" class=\"headerlink\" title=\"manjaro安装\"></a>manjaro安装</h4><h5 id=\"安装postgresql\"><a href=\"#安装postgresql\" class=\"headerlink\" title=\"安装postgresql\"></a>安装postgresql</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git clone https://aur.archlinux.org/postgresql-9.6.git</span><br><span class=\"line\">$ cd postgresql-9.6-git</span><br><span class=\"line\">$ less PKGBUILD  # 查看</span><br><span class=\"line\">$ makepkg -si  # 安装</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 初始化数据</span><br><span class=\"line\">$ sudo su postgres -l </span><br><span class=\"line\">$ initdb --locale $LANG -E UTF8 -D &apos;/var/lib/postgres/data/&apos;</span><br><span class=\"line\">$ exit</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 启动及开机启动</span><br><span class=\"line\">sudo systemctl start postgresql.service </span><br><span class=\"line\">sudo systemctl enable postgresql.service</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 登录</span><br><span class=\"line\">$ sudo su postgres -l</span><br><span class=\"line\">$ psql</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"安装postgis\"><a href=\"#安装postgis\" class=\"headerlink\" title=\"安装postgis\"></a>安装postgis</h5><p>1, 安装proj4.9</p>\n<p>下载源码 <a href=\"https://proj.org/download.html\" target=\"_blank\" rel=\"noopener\">地址</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar xfz proj-4.9.3.tar.gz</span><br><span class=\"line\">cd proj-4.9.3</span><br><span class=\"line\">./configure</span><br><span class=\"line\">make</span><br><span class=\"line\">sudo make install</span><br><span class=\"line\"># 安装postgis时，如果没有找到库则需要复制动态库</span><br><span class=\"line\">sudo ln -s /usr/local/lib/libproj.so.12 /usr/lib/libproj.so.12</span><br></pre></td></tr></table></figure>\n\n<p>2, 安装postgis2.5.2</p>\n<p>下载源码 <a href=\"https://postgis.net/source/\" target=\"_blank\" rel=\"noopener\">地址</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://download.osgeo.org/postgis/source/postgis-2.5.2.tar.gz</span><br><span class=\"line\">tar xfz postgis-2.5.2.tar.gz</span><br><span class=\"line\">cd postgis-2.5.2</span><br><span class=\"line\">./configure</span><br><span class=\"line\">make</span><br><span class=\"line\">sudo make install</span><br><span class=\"line\">sudo ldconfig</span><br><span class=\"line\">sudo make comments-install</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"创建库\"><a href=\"#创建库\" class=\"headerlink\" title=\"创建库\"></a>创建库</h5><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 第一件事是使用\\password命令，为postgres用户设置一个密码。</span><br><span class=\"line\">postgres=# \\password postgres</span><br><span class=\"line\"># 第二件事是创建数据库用户dbuser（刚才创建的是Linux系统用户），并设置密码。</span><br><span class=\"line\">postgres=# CREATE USER dbuser WITH PASSWORD &apos;password&apos;;</span><br><span class=\"line\"># 第三件事是创建用户数据库，这里为exampledb，并指定所有者为dbuser。</span><br><span class=\"line\">postgres=# CREATE DATABASE exampledb OWNER dbuser;</span><br><span class=\"line\"># 第四件事是将exampledb数据库的所有权限都赋予dbuser，否则dbuser只能登录控制台，没有数据库操作权限。</span><br><span class=\"line\">postgres=# GRANT ALL PRIVILEGES ON DATABASE exampledb to dbuser;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ubuntu-centos安装\"><a href=\"#ubuntu-centos安装\" class=\"headerlink\" title=\"ubuntu/centos安装\"></a>ubuntu/centos安装</h4><p><a href=\"https://www.postgresql.org/download/linux/ubuntu/\" target=\"_blank\" rel=\"noopener\">ubuntu安装</a> <a href=\"https://www.postgresql.org/download/linux/redhat/\" target=\"_blank\" rel=\"noopener\">centos安装</a> centos7.2 安装postgresql9.6</p>\n<pre><code># 添加RPM\nyum install https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-7-x86_64/pgdg-centos96-9.6-3.noarch.rpm\n\n# 安装PostgreSQL 9.6\n# postgresql96-server 数据库核心服务端\n# postgresql96-contrib 附加第三方扩展\n# postgresql96-devel C语言开发Header头文件和库\nyum install postgresql96-server postgresql96-contrib postgresql96-devel\n\n# 验证是否安装成功\nrpm -aq| grep postgres\n\n\n# 设置目录（可省略）\ncd /mnt\nsudo mkdir vdb1\nsudo chown -R postgres:postgres vdb1\nsudo chmod 700 vdb1\nvi /usr/lib/systemd/system/postgresql-9.6.service\nEnvironment=PGDATA=/mnt/vdb1/ 修改为自己的新的数据路径\n\n\n# 初始化数据库\nsudo /usr/pgsql-9.6/bin/postgresql96-setup initdb\n# 开启服务\nsudo service postgresql-9.6 start 或者 systemctl start postgresql-9.6.service\n# 开机启动\nsudo sudo chkconfig postgresql-9.6 on 或者 systemctl enable postgresql-9.6.service\n\n\n# 配置文件\n /var/lib/pgsql/9.6/data/postgresql.conf 通用设置\n /var/lib/pgsql/9.6/data/pg_hba.conf  控制访问安全\n /var/lib/pgsql/9.6/data/pg_ident.conf 配合pg_hba.conf使用  \n\n\nsudo su postgres\npsql # 进入命令行模式\n# 修改密码\nALTER USER postgres WITH PASSWORD &apos;密码&apos;; \n# 创建用户\nCREATE USER userdoneself WITH PASSWORD &apos;密码passworddoneself&apos;;\n# 创建数据库\ncreate --encoding=UTF8 database dbdoneself owner userdoneself;\n# 赋予权限\ngrant all privileges on database dbdoneself to userdoneself;\n\\q\n# 安装postgresql时，系统会自动创建postgres用户\n\n\n# 开启远程访问\nvi /var/lib/pgsql/9.6/data/postgresql.conf 或者  vi /mnt/vdb1/postgresql.conf(创建了目录)\n\n修改#listen_addresses = &apos;localhost&apos; 为  listen_addresses=&apos;*&apos;\n\n\n# 连接数据库\n先配置登录权限\nvim pg_hba.conf\n# 是否远程登录 数据库 用户名 ip地段 方式\n# 允许doneself用户远程访问\nhost doneself doneself 127.0.0.1/32 md5\n# 允许管理员密码登录\nlocal all postgres  md5\n# 如果不知道怎么配置， 将全部登录方式改成md5\n\n# 查看版本\n/usr/pgsql-9.6/bin/psql --version</code></pre><h4 id=\"安装postgis2\"><a href=\"#安装postgis2\" class=\"headerlink\" title=\"安装postgis2\"></a>安装postgis2</h4><p>centos7.2</p>\n<pre><code>sudo yum install postgis2_96  # 96和安装的postgresql一致\nsudo yum install ogr_fdw96  # 安装ogrfdw\nsudo yum install pgrouting_96 # 安装pgrouting\n\n\n# 用管理员登录postgerysql\n&gt;-- Enable PostGIS (includes raster)\nCREATE EXTENSION postgis;\n-- Enable Topology\nCREATE EXTENSION postgis_topology;\n-- Enable PostGIS Advanced 3D\n-- and other geoprocessing algorithms\n-- sfcgal not available with all distributions\nCREATE EXTENSION postgis_sfcgal;\n-- fuzzy matching needed for Tiger\nCREATE EXTENSION fuzzystrmatch;\n-- rule based standardizer\nCREATE EXTENSION address_standardizer;\n-- example rule data set\nCREATE EXTENSION address_standardizer_data_us;\n-- Enable US Tiger Geocoder\nCREATE EXTENSION postgis_tiger_geocoder;\n\n# 验证是否安装成功\n#postgres=&gt; postgis_full_version();</code></pre><h4 id=\"安装postgresql中文全文搜索zhparser\"><a href=\"#安装postgresql中文全文搜索zhparser\" class=\"headerlink\" title=\"安装postgresql中文全文搜索zhparser\"></a>安装postgresql中文全文搜索zhparser</h4><p>centos7.2</p>\n<pre><code> yum install bzip2  # 安装解压包\n # 安装SCWS中文分词 https://github.com/hightman/scws\n wget http://www.xunsearch.com/scws/down/scws-1.2.3.tar.bz2\n tar -jxvf scws-1.2.3.tar.bz2 \n cd scws-1.2.3\n ./configure\n make install\n # 测试\n scws &apos;请问怎么自己动手做西红柿蛋炒饭&apos; -c utf-8\n # 安装zhparser\n git clone https://github.com/amutu/zhparser.git\n cd zhparser\nexport PATH=$PATH:/usr/pgsql-9.6/bin/\ncmake &amp;&amp; make install\n\n\n# 登录（第一次登录）\n&gt; sudo su - postgres\n# 修改可以md5登录后\n&gt; &gt; psql -U user -D database -W\n&gt;  输入口令\n# 创建用户\nuser=&gt;  CREATE USER dbuser WITH PASSWORD &apos;password&apos;;\n# 修改密码\nuser=&gt;  ALTER USER dbuser WITH PASSWORD &apos;newpassword&apos;;\n# 赋予权限\nuser=&gt;  GRANT ALL PRIVILEGES ON DATABASE exampledb to dbuser;\n# 允许用户创建数据库\nuser=&gt; ALTER USER doneself CREATEDB;\n# 设置为超级管理员\nuser=&gt; ALTER ROLE doneself SUPERUSER;\n# 创建数据库\nuser=&gt;  Create database exampledb owner=dbuser  template= template1  ENCODING = &apos;UTF8&apos;;\n# 选择数据库\nuser=&gt; \\c database\n# 查看当前数据库所有表\nuser=&gt;  \\dt\nuser=&gt;  \\d 数据库 —— 得到所有表的名字\nuser=&gt;  \\d 表名 —— 得到表结构</code></pre>"},{"title":"python入门基础","url":"34.html","id":"34","comments":0,"date":"2016-11-09T02:46:24.000Z","_content":"#### 1. linux源码安装（适合生产环境）\n安装python3.x.x\n```\n# 以centos系统安装python3.6.6为例\n$ sudo yum groupinstall \"Development tools\"\n$ sudo yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel\n$ wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tar.xz\n$ tar -xJf Python-3.6.6.tar.xz\n$ cd Python-3.6.6\n$ ./configure --prefix=/usr/local/python3  # 编译配置\n$ sudo make\n$ sudo make install\n# 创建软链接\n$ ln -s /usr/local/python3/bin/python3 /usr/bin/python3\n$ ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3\n```\n\n安装虚拟环境\n\n```\nsudo yum install python-virtualenv  # centos\n```\n\n创建项目\n\n```\n$ virtualenv --no-site-packages -p /usr/bin/python3 .env-project\n$ source.env-project/bin/active  # 进入虚拟环境\n(.env-project) deactive  # 退出虚拟环境\n```\n\n#### 2. pyenv安装(适合开发环境)\n\n安装pyenv\n\n```\ncurl -L https://raw.githubusercontent.com/pyenv/pyenv-installer/master/bin/pyenv-installer | bash\n```\n\n设置环境变量\n\n```\n$ vim ~/.zshrc  # 具体文件看自己的终端工具\n```\n\n```\nexport PATH=$HOME/.pyenv/bin:$PATH\neval \"$(pyenv init -)\"\neval \"$(pyenv virtualenv-init -)\"\n```\n\n```\n$ source ~/.zshrc\n```\n\n检查环境\n\n```\n$ pyenv doctor  # 如有错误，根据自己的环境解决\n```\n\n安装python3.x.x\n\n```\n$ pyenv install 3.6.6\n```\n\n如果pyenv下载文件缓慢，可以先下载文件到缓存中\n\n```\n$ cd ~/.pyenv/cache  # 没有则创建文件\n$ wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tar.xz\n$ pyenv install 3.6.6\n```\n\n依次安装python3.7.3 python2.7.10\n\n查看当前系统所有python版本\n\n```\n$ pyenv versions\n* system (set by /home/zhc/.pyenv/version)\n  2.7.10\n  3.6.6\n  3.7.3\n```\n\npyenv系统级别global切换版本<pyenv目录级别local切换版本<pyenv当前shell级别切换版本\n\n```\n$ pyenv global 3.6.6                                                                 \n$ pyenv version                                                                     \n3.6.6 (set by /home/zhc/.pyenv/version)                                                 \n$ pyenv global 3.7.3\n$ pyenv version\n3.7.3 (set by /home/zhc/.pyenv/version)\n$ pyenv shell 3.6.6\n$ pyenv version\n3.6.6 (set by PYENV_VERSION environment variable) \n$ pyenv local 3.6.6  # 会在当前文件夹下创建.python-version文件，存储虚拟环境名称 \n```\n\npyenv安装虚拟环境\n\n```\npyenv virtualenv 3.6.6 test-3.6.6\npyenv virtualenv 3.7.3 test-3.7.3\n```\n\npyenv删除虚拟环境\n\n```\npyenv uninstall test-3.6.6\n```\n\npyenv查看全部虚拟环境\n\n```\n➜  ~ pyenv virtualenvs                                                                 \n  3.6.6/envs/test-3.6.6 (created from /home/zhc/.pyenv/versions/3.6.6)                 \n  3.7.3/envs/test-3.7.3 (created from /home/zhc/.pyenv/versions/3.7.3)                 \n  test-3.6.6 (created from /home/zhc/.pyenv/versions/3.6.6)\n  test-3.7.3 (created from /home/zhc/.pyenv/versions/3.7.3)\n```\n\n切换虚拟环境\n\n```\n$ pyenv activate test-3.6.6\n$ pyenv local test-3.6.6\n$ source deactivate\n```\n\npyenv重建环境变量\n\n```\npyenv rehash\n```\n\n\n\n#### 源码安装python2.7.9\n\n    $ sudo apt-get install -y openssl\n    $ sudo apt-get install -y libssl-dev # 即 openssl-devel\n    $ sudo apt-get install -y libffi-dev # 即 libffi-devel\n    $ sudo apt-get install -y python-openssl\n    $ sudo apt-get install libbz2-dev\n    $ sudo apt-get install libxml2-dev\n    $ sudo apt-get install libxslt1-dev\n    $ sudo apt-get install sqlite3 libsqlite3-dev\n    $ sudo apt-get install libmysqlclient-dev\n    \n\n    wget -c https://www.python.org/ftp/python/2.7.9/Python-2.7.9.tgz  \n    tar -xzvf Python-2.7.9.tgz  \n    cd Python-2.7.9/ \n    \n\n修改源码，支持ssl\n\n    vim Modules/Setup.dist\n    \n\n    # Socket module helper for SSL support; you must comment out the other\n    # socket line above, and possibly edit the SSL variable:\n    #SSL=/usr/local/ssl\n    #_ssl _ssl.c \\\n    #        -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \\\n    #        -L$(SSL)/lib -lssl -lcrypto\n    \n\n改成\n\n    # Socket module helper for SSL support; you must comment out the other\n    # socket line above, and possibly edit the SSL variable:\n    SSL=/usr/local/ssl\n    _ssl _ssl.c \\\n            -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \\\n    \n            -L$(SSL)/lib -lssl -lcrypto\n    \n\n    LDFLAGS=\"-L/usr/lib/x86_64-linux-gnu\" ./configure  \n    make  \n    sudo make install\n    \n\n#### 虚拟环境搭建\n\n安装\n\n    sudo apt-get install python-virtualenv\n    \n\n创建虚拟环境\n\n    cd ~/var/www\n    virtualenv --no-site-packages -p /usr/local/bin/python Novel # 参数表示不安装系统已经安装的第三方包, -p表示用哪个版本的python\n    \n\n启用虚拟环境\n\n    cd /var/www/Novel\n    source ./bin/activate\n    \n\n虚拟环境安装包\n\n    (Novel) pip isntall django==1.8.2 # 不能加sudo\n    \n\n退出虚拟环境，进入正常环境\n\n    deactivate\n    \n\n虚拟环境复制\n\n    pip freeze > requirements.txt\n    pip install -r requirements.txt\n    \n\n#### pip安装超时\n\n    pip --default-timeout=100 install -U pip\n    \n\n#### 安装python-mysql\n\n    sudo apt-get install python-setuptools\n    \n    sudo apt-get install libmysqld-dev\n    \n    sudo apt-get install libmysqlclient-dev\n    \n    sudo apt-get install python-dev\n    \n    sudo easy_install mysql-python\n    \n\n在终端输入以下内容,不报错则表示成功\n\n    import MySQLdb\n    \n\n#### 获取文件修改时间\n\n    import time\n    filemt= time.localtime(os.stat(filename).st_mtime)  #文件修改时间\n    filect = time.localtime(os.stat(filename).st_ctime)  #文件创建\n    print time.strftime(\"%Y-%m-%d\",filemt)  \n    print time.strftime(\"%Y-%m-%d\",filect)\n    \n\n#### 获取多少天以前的时间\n\n    import datetime\n    # 30天以前的日期\n    date_time = (datetime.datetime.now() - datetime.timedelta(days=30)).strftime(\"%Y-%m-%d\")\n    print date_time\n    \n\n#### 去除列表重复项内容\n\n    # 如果列表里面内容为字典\n    f = lambda x,y:x if y in x else x + [y]\n    products = reduce(f, [[], ] + products_query)\n    print products\n    \n    # 如果列表里面内容为字符串\n    l1 = ['b','c','d','b','c','a','a']\n    l2 = list(set(l1))\n    print l2\n    # 保持原来的顺序\n    l1 = ['b','c','d','b','c','a','a']\n    l2 = sorted(set(l1),key=l1.index)\n    print l2\n    \n\n#### md5，hash加密\n\n    import hashlib\n    data =  'This a md5 test!'\n    hash_md5 = hashlib.md5(data)  # md5\n    hash_md5.hexdigest()\n    \n    hashlib.sha1('This is a sha1 test!').hexdigest() # sha1\n    \n\n#### 打印输出对象\n\n    from pprint import pprint\n    pprint(vars(object))\n    \n\nwindows安装python相关环境\n===================\n\n#### 安装虚拟环境\n\n    # 安装包\n    pip install virtualenv\n    # 创建虚拟环境env\n    virtualenv.exe  env\n    # 开启虚拟环境\n    ./scripts/active\n    # 退出虚拟环境\n    deactivate","source":"_posts/python入门基础.md","raw":"---\ntitle: python入门基础\ntags:\n  - python\nurl: 34.html\nid: 34\ncomments: false\ncategories:\n  - 后端\ndate: 2016-11-09 10:46:24\n---\n#### 1. linux源码安装（适合生产环境）\n安装python3.x.x\n```\n# 以centos系统安装python3.6.6为例\n$ sudo yum groupinstall \"Development tools\"\n$ sudo yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel\n$ wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tar.xz\n$ tar -xJf Python-3.6.6.tar.xz\n$ cd Python-3.6.6\n$ ./configure --prefix=/usr/local/python3  # 编译配置\n$ sudo make\n$ sudo make install\n# 创建软链接\n$ ln -s /usr/local/python3/bin/python3 /usr/bin/python3\n$ ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3\n```\n\n安装虚拟环境\n\n```\nsudo yum install python-virtualenv  # centos\n```\n\n创建项目\n\n```\n$ virtualenv --no-site-packages -p /usr/bin/python3 .env-project\n$ source.env-project/bin/active  # 进入虚拟环境\n(.env-project) deactive  # 退出虚拟环境\n```\n\n#### 2. pyenv安装(适合开发环境)\n\n安装pyenv\n\n```\ncurl -L https://raw.githubusercontent.com/pyenv/pyenv-installer/master/bin/pyenv-installer | bash\n```\n\n设置环境变量\n\n```\n$ vim ~/.zshrc  # 具体文件看自己的终端工具\n```\n\n```\nexport PATH=$HOME/.pyenv/bin:$PATH\neval \"$(pyenv init -)\"\neval \"$(pyenv virtualenv-init -)\"\n```\n\n```\n$ source ~/.zshrc\n```\n\n检查环境\n\n```\n$ pyenv doctor  # 如有错误，根据自己的环境解决\n```\n\n安装python3.x.x\n\n```\n$ pyenv install 3.6.6\n```\n\n如果pyenv下载文件缓慢，可以先下载文件到缓存中\n\n```\n$ cd ~/.pyenv/cache  # 没有则创建文件\n$ wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tar.xz\n$ pyenv install 3.6.6\n```\n\n依次安装python3.7.3 python2.7.10\n\n查看当前系统所有python版本\n\n```\n$ pyenv versions\n* system (set by /home/zhc/.pyenv/version)\n  2.7.10\n  3.6.6\n  3.7.3\n```\n\npyenv系统级别global切换版本<pyenv目录级别local切换版本<pyenv当前shell级别切换版本\n\n```\n$ pyenv global 3.6.6                                                                 \n$ pyenv version                                                                     \n3.6.6 (set by /home/zhc/.pyenv/version)                                                 \n$ pyenv global 3.7.3\n$ pyenv version\n3.7.3 (set by /home/zhc/.pyenv/version)\n$ pyenv shell 3.6.6\n$ pyenv version\n3.6.6 (set by PYENV_VERSION environment variable) \n$ pyenv local 3.6.6  # 会在当前文件夹下创建.python-version文件，存储虚拟环境名称 \n```\n\npyenv安装虚拟环境\n\n```\npyenv virtualenv 3.6.6 test-3.6.6\npyenv virtualenv 3.7.3 test-3.7.3\n```\n\npyenv删除虚拟环境\n\n```\npyenv uninstall test-3.6.6\n```\n\npyenv查看全部虚拟环境\n\n```\n➜  ~ pyenv virtualenvs                                                                 \n  3.6.6/envs/test-3.6.6 (created from /home/zhc/.pyenv/versions/3.6.6)                 \n  3.7.3/envs/test-3.7.3 (created from /home/zhc/.pyenv/versions/3.7.3)                 \n  test-3.6.6 (created from /home/zhc/.pyenv/versions/3.6.6)\n  test-3.7.3 (created from /home/zhc/.pyenv/versions/3.7.3)\n```\n\n切换虚拟环境\n\n```\n$ pyenv activate test-3.6.6\n$ pyenv local test-3.6.6\n$ source deactivate\n```\n\npyenv重建环境变量\n\n```\npyenv rehash\n```\n\n\n\n#### 源码安装python2.7.9\n\n    $ sudo apt-get install -y openssl\n    $ sudo apt-get install -y libssl-dev # 即 openssl-devel\n    $ sudo apt-get install -y libffi-dev # 即 libffi-devel\n    $ sudo apt-get install -y python-openssl\n    $ sudo apt-get install libbz2-dev\n    $ sudo apt-get install libxml2-dev\n    $ sudo apt-get install libxslt1-dev\n    $ sudo apt-get install sqlite3 libsqlite3-dev\n    $ sudo apt-get install libmysqlclient-dev\n    \n\n    wget -c https://www.python.org/ftp/python/2.7.9/Python-2.7.9.tgz  \n    tar -xzvf Python-2.7.9.tgz  \n    cd Python-2.7.9/ \n    \n\n修改源码，支持ssl\n\n    vim Modules/Setup.dist\n    \n\n    # Socket module helper for SSL support; you must comment out the other\n    # socket line above, and possibly edit the SSL variable:\n    #SSL=/usr/local/ssl\n    #_ssl _ssl.c \\\n    #        -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \\\n    #        -L$(SSL)/lib -lssl -lcrypto\n    \n\n改成\n\n    # Socket module helper for SSL support; you must comment out the other\n    # socket line above, and possibly edit the SSL variable:\n    SSL=/usr/local/ssl\n    _ssl _ssl.c \\\n            -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \\\n    \n            -L$(SSL)/lib -lssl -lcrypto\n    \n\n    LDFLAGS=\"-L/usr/lib/x86_64-linux-gnu\" ./configure  \n    make  \n    sudo make install\n    \n\n#### 虚拟环境搭建\n\n安装\n\n    sudo apt-get install python-virtualenv\n    \n\n创建虚拟环境\n\n    cd ~/var/www\n    virtualenv --no-site-packages -p /usr/local/bin/python Novel # 参数表示不安装系统已经安装的第三方包, -p表示用哪个版本的python\n    \n\n启用虚拟环境\n\n    cd /var/www/Novel\n    source ./bin/activate\n    \n\n虚拟环境安装包\n\n    (Novel) pip isntall django==1.8.2 # 不能加sudo\n    \n\n退出虚拟环境，进入正常环境\n\n    deactivate\n    \n\n虚拟环境复制\n\n    pip freeze > requirements.txt\n    pip install -r requirements.txt\n    \n\n#### pip安装超时\n\n    pip --default-timeout=100 install -U pip\n    \n\n#### 安装python-mysql\n\n    sudo apt-get install python-setuptools\n    \n    sudo apt-get install libmysqld-dev\n    \n    sudo apt-get install libmysqlclient-dev\n    \n    sudo apt-get install python-dev\n    \n    sudo easy_install mysql-python\n    \n\n在终端输入以下内容,不报错则表示成功\n\n    import MySQLdb\n    \n\n#### 获取文件修改时间\n\n    import time\n    filemt= time.localtime(os.stat(filename).st_mtime)  #文件修改时间\n    filect = time.localtime(os.stat(filename).st_ctime)  #文件创建\n    print time.strftime(\"%Y-%m-%d\",filemt)  \n    print time.strftime(\"%Y-%m-%d\",filect)\n    \n\n#### 获取多少天以前的时间\n\n    import datetime\n    # 30天以前的日期\n    date_time = (datetime.datetime.now() - datetime.timedelta(days=30)).strftime(\"%Y-%m-%d\")\n    print date_time\n    \n\n#### 去除列表重复项内容\n\n    # 如果列表里面内容为字典\n    f = lambda x,y:x if y in x else x + [y]\n    products = reduce(f, [[], ] + products_query)\n    print products\n    \n    # 如果列表里面内容为字符串\n    l1 = ['b','c','d','b','c','a','a']\n    l2 = list(set(l1))\n    print l2\n    # 保持原来的顺序\n    l1 = ['b','c','d','b','c','a','a']\n    l2 = sorted(set(l1),key=l1.index)\n    print l2\n    \n\n#### md5，hash加密\n\n    import hashlib\n    data =  'This a md5 test!'\n    hash_md5 = hashlib.md5(data)  # md5\n    hash_md5.hexdigest()\n    \n    hashlib.sha1('This is a sha1 test!').hexdigest() # sha1\n    \n\n#### 打印输出对象\n\n    from pprint import pprint\n    pprint(vars(object))\n    \n\nwindows安装python相关环境\n===================\n\n#### 安装虚拟环境\n\n    # 安装包\n    pip install virtualenv\n    # 创建虚拟环境env\n    virtualenv.exe  env\n    # 开启虚拟环境\n    ./scripts/active\n    # 退出虚拟环境\n    deactivate","slug":"python入门基础","published":1,"updated":"2019-07-24T01:31:12.816Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5o800229ka4dvh06dpg","content":"<h4 id=\"1-linux源码安装（适合生产环境）\"><a href=\"#1-linux源码安装（适合生产环境）\" class=\"headerlink\" title=\"1. linux源码安装（适合生产环境）\"></a>1. linux源码安装（适合生产环境）</h4><p>安装python3.x.x</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 以centos系统安装python3.6.6为例</span><br><span class=\"line\">$ sudo yum groupinstall &quot;Development tools&quot;</span><br><span class=\"line\">$ sudo yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel</span><br><span class=\"line\">$ wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tar.xz</span><br><span class=\"line\">$ tar -xJf Python-3.6.6.tar.xz</span><br><span class=\"line\">$ cd Python-3.6.6</span><br><span class=\"line\">$ ./configure --prefix=/usr/local/python3  # 编译配置</span><br><span class=\"line\">$ sudo make</span><br><span class=\"line\">$ sudo make install</span><br><span class=\"line\"># 创建软链接</span><br><span class=\"line\">$ ln -s /usr/local/python3/bin/python3 /usr/bin/python3</span><br><span class=\"line\">$ ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3</span><br></pre></td></tr></table></figure>\n\n<p>安装虚拟环境</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install python-virtualenv  # centos</span><br></pre></td></tr></table></figure>\n\n<p>创建项目</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ virtualenv --no-site-packages -p /usr/bin/python3 .env-project</span><br><span class=\"line\">$ source.env-project/bin/active  # 进入虚拟环境</span><br><span class=\"line\">(.env-project) deactive  # 退出虚拟环境</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2-pyenv安装-适合开发环境\"><a href=\"#2-pyenv安装-适合开发环境\" class=\"headerlink\" title=\"2. pyenv安装(适合开发环境)\"></a>2. pyenv安装(适合开发环境)</h4><p>安装pyenv</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -L https://raw.githubusercontent.com/pyenv/pyenv-installer/master/bin/pyenv-installer | bash</span><br></pre></td></tr></table></figure>\n\n<p>设置环境变量</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim ~/.zshrc  # 具体文件看自己的终端工具</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export PATH=$HOME/.pyenv/bin:$PATH</span><br><span class=\"line\">eval &quot;$(pyenv init -)&quot;</span><br><span class=\"line\">eval &quot;$(pyenv virtualenv-init -)&quot;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ source ~/.zshrc</span><br></pre></td></tr></table></figure>\n\n<p>检查环境</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ pyenv doctor  # 如有错误，根据自己的环境解决</span><br></pre></td></tr></table></figure>\n\n<p>安装python3.x.x</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ pyenv install 3.6.6</span><br></pre></td></tr></table></figure>\n\n<p>如果pyenv下载文件缓慢，可以先下载文件到缓存中</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ cd ~/.pyenv/cache  # 没有则创建文件</span><br><span class=\"line\">$ wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tar.xz</span><br><span class=\"line\">$ pyenv install 3.6.6</span><br></pre></td></tr></table></figure>\n\n<p>依次安装python3.7.3 python2.7.10</p>\n<p>查看当前系统所有python版本</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ pyenv versions</span><br><span class=\"line\">* system (set by /home/zhc/.pyenv/version)</span><br><span class=\"line\">  2.7.10</span><br><span class=\"line\">  3.6.6</span><br><span class=\"line\">  3.7.3</span><br></pre></td></tr></table></figure>\n\n<p>pyenv系统级别global切换版本&lt;pyenv目录级别local切换版本&lt;pyenv当前shell级别切换版本</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ pyenv global 3.6.6                                                                 </span><br><span class=\"line\">$ pyenv version                                                                     </span><br><span class=\"line\">3.6.6 (set by /home/zhc/.pyenv/version)                                                 </span><br><span class=\"line\">$ pyenv global 3.7.3</span><br><span class=\"line\">$ pyenv version</span><br><span class=\"line\">3.7.3 (set by /home/zhc/.pyenv/version)</span><br><span class=\"line\">$ pyenv shell 3.6.6</span><br><span class=\"line\">$ pyenv version</span><br><span class=\"line\">3.6.6 (set by PYENV_VERSION environment variable) </span><br><span class=\"line\">$ pyenv local 3.6.6  # 会在当前文件夹下创建.python-version文件，存储虚拟环境名称</span><br></pre></td></tr></table></figure>\n\n<p>pyenv安装虚拟环境</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyenv virtualenv 3.6.6 test-3.6.6</span><br><span class=\"line\">pyenv virtualenv 3.7.3 test-3.7.3</span><br></pre></td></tr></table></figure>\n\n<p>pyenv删除虚拟环境</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyenv uninstall test-3.6.6</span><br></pre></td></tr></table></figure>\n\n<p>pyenv查看全部虚拟环境</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  ~ pyenv virtualenvs                                                                 </span><br><span class=\"line\">  3.6.6/envs/test-3.6.6 (created from /home/zhc/.pyenv/versions/3.6.6)                 </span><br><span class=\"line\">  3.7.3/envs/test-3.7.3 (created from /home/zhc/.pyenv/versions/3.7.3)                 </span><br><span class=\"line\">  test-3.6.6 (created from /home/zhc/.pyenv/versions/3.6.6)</span><br><span class=\"line\">  test-3.7.3 (created from /home/zhc/.pyenv/versions/3.7.3)</span><br></pre></td></tr></table></figure>\n\n<p>切换虚拟环境</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ pyenv activate test-3.6.6</span><br><span class=\"line\">$ pyenv local test-3.6.6</span><br><span class=\"line\">$ source deactivate</span><br></pre></td></tr></table></figure>\n\n<p>pyenv重建环境变量</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyenv rehash</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码安装python2-7-9\"><a href=\"#源码安装python2-7-9\" class=\"headerlink\" title=\"源码安装python2.7.9\"></a>源码安装python2.7.9</h4><pre><code>$ sudo apt-get install -y openssl\n$ sudo apt-get install -y libssl-dev # 即 openssl-devel\n$ sudo apt-get install -y libffi-dev # 即 libffi-devel\n$ sudo apt-get install -y python-openssl\n$ sudo apt-get install libbz2-dev\n$ sudo apt-get install libxml2-dev\n$ sudo apt-get install libxslt1-dev\n$ sudo apt-get install sqlite3 libsqlite3-dev\n$ sudo apt-get install libmysqlclient-dev\n\n\nwget -c https://www.python.org/ftp/python/2.7.9/Python-2.7.9.tgz  \ntar -xzvf Python-2.7.9.tgz  \ncd Python-2.7.9/ </code></pre><p>修改源码，支持ssl</p>\n<pre><code>vim Modules/Setup.dist\n\n\n# Socket module helper for SSL support; you must comment out the other\n# socket line above, and possibly edit the SSL variable:\n#SSL=/usr/local/ssl\n#_ssl _ssl.c \\\n#        -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \\\n#        -L$(SSL)/lib -lssl -lcrypto</code></pre><p>改成</p>\n<pre><code># Socket module helper for SSL support; you must comment out the other\n# socket line above, and possibly edit the SSL variable:\nSSL=/usr/local/ssl\n_ssl _ssl.c \\\n        -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \\\n\n        -L$(SSL)/lib -lssl -lcrypto\n\n\nLDFLAGS=&quot;-L/usr/lib/x86_64-linux-gnu&quot; ./configure  \nmake  \nsudo make install</code></pre><h4 id=\"虚拟环境搭建\"><a href=\"#虚拟环境搭建\" class=\"headerlink\" title=\"虚拟环境搭建\"></a>虚拟环境搭建</h4><p>安装</p>\n<pre><code>sudo apt-get install python-virtualenv</code></pre><p>创建虚拟环境</p>\n<pre><code>cd ~/var/www\nvirtualenv --no-site-packages -p /usr/local/bin/python Novel # 参数表示不安装系统已经安装的第三方包, -p表示用哪个版本的python</code></pre><p>启用虚拟环境</p>\n<pre><code>cd /var/www/Novel\nsource ./bin/activate</code></pre><p>虚拟环境安装包</p>\n<pre><code>(Novel) pip isntall django==1.8.2 # 不能加sudo</code></pre><p>退出虚拟环境，进入正常环境</p>\n<pre><code>deactivate</code></pre><p>虚拟环境复制</p>\n<pre><code>pip freeze &gt; requirements.txt\npip install -r requirements.txt</code></pre><h4 id=\"pip安装超时\"><a href=\"#pip安装超时\" class=\"headerlink\" title=\"pip安装超时\"></a>pip安装超时</h4><pre><code>pip --default-timeout=100 install -U pip</code></pre><h4 id=\"安装python-mysql\"><a href=\"#安装python-mysql\" class=\"headerlink\" title=\"安装python-mysql\"></a>安装python-mysql</h4><pre><code>sudo apt-get install python-setuptools\n\nsudo apt-get install libmysqld-dev\n\nsudo apt-get install libmysqlclient-dev\n\nsudo apt-get install python-dev\n\nsudo easy_install mysql-python</code></pre><p>在终端输入以下内容,不报错则表示成功</p>\n<pre><code>import MySQLdb</code></pre><h4 id=\"获取文件修改时间\"><a href=\"#获取文件修改时间\" class=\"headerlink\" title=\"获取文件修改时间\"></a>获取文件修改时间</h4><pre><code>import time\nfilemt= time.localtime(os.stat(filename).st_mtime)  #文件修改时间\nfilect = time.localtime(os.stat(filename).st_ctime)  #文件创建\nprint time.strftime(&quot;%Y-%m-%d&quot;,filemt)  \nprint time.strftime(&quot;%Y-%m-%d&quot;,filect)</code></pre><h4 id=\"获取多少天以前的时间\"><a href=\"#获取多少天以前的时间\" class=\"headerlink\" title=\"获取多少天以前的时间\"></a>获取多少天以前的时间</h4><pre><code>import datetime\n# 30天以前的日期\ndate_time = (datetime.datetime.now() - datetime.timedelta(days=30)).strftime(&quot;%Y-%m-%d&quot;)\nprint date_time</code></pre><h4 id=\"去除列表重复项内容\"><a href=\"#去除列表重复项内容\" class=\"headerlink\" title=\"去除列表重复项内容\"></a>去除列表重复项内容</h4><pre><code># 如果列表里面内容为字典\nf = lambda x,y:x if y in x else x + [y]\nproducts = reduce(f, [[], ] + products_query)\nprint products\n\n# 如果列表里面内容为字符串\nl1 = [&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;b&apos;,&apos;c&apos;,&apos;a&apos;,&apos;a&apos;]\nl2 = list(set(l1))\nprint l2\n# 保持原来的顺序\nl1 = [&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;b&apos;,&apos;c&apos;,&apos;a&apos;,&apos;a&apos;]\nl2 = sorted(set(l1),key=l1.index)\nprint l2</code></pre><h4 id=\"md5，hash加密\"><a href=\"#md5，hash加密\" class=\"headerlink\" title=\"md5，hash加密\"></a>md5，hash加密</h4><pre><code>import hashlib\ndata =  &apos;This a md5 test!&apos;\nhash_md5 = hashlib.md5(data)  # md5\nhash_md5.hexdigest()\n\nhashlib.sha1(&apos;This is a sha1 test!&apos;).hexdigest() # sha1</code></pre><h4 id=\"打印输出对象\"><a href=\"#打印输出对象\" class=\"headerlink\" title=\"打印输出对象\"></a>打印输出对象</h4><pre><code>from pprint import pprint\npprint(vars(object))</code></pre><h1 id=\"windows安装python相关环境\"><a href=\"#windows安装python相关环境\" class=\"headerlink\" title=\"windows安装python相关环境\"></a>windows安装python相关环境</h1><h4 id=\"安装虚拟环境\"><a href=\"#安装虚拟环境\" class=\"headerlink\" title=\"安装虚拟环境\"></a>安装虚拟环境</h4><pre><code># 安装包\npip install virtualenv\n# 创建虚拟环境env\nvirtualenv.exe  env\n# 开启虚拟环境\n./scripts/active\n# 退出虚拟环境\ndeactivate</code></pre>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"1-linux源码安装（适合生产环境）\"><a href=\"#1-linux源码安装（适合生产环境）\" class=\"headerlink\" title=\"1. linux源码安装（适合生产环境）\"></a>1. linux源码安装（适合生产环境）</h4><p>安装python3.x.x</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 以centos系统安装python3.6.6为例</span><br><span class=\"line\">$ sudo yum groupinstall &quot;Development tools&quot;</span><br><span class=\"line\">$ sudo yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel</span><br><span class=\"line\">$ wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tar.xz</span><br><span class=\"line\">$ tar -xJf Python-3.6.6.tar.xz</span><br><span class=\"line\">$ cd Python-3.6.6</span><br><span class=\"line\">$ ./configure --prefix=/usr/local/python3  # 编译配置</span><br><span class=\"line\">$ sudo make</span><br><span class=\"line\">$ sudo make install</span><br><span class=\"line\"># 创建软链接</span><br><span class=\"line\">$ ln -s /usr/local/python3/bin/python3 /usr/bin/python3</span><br><span class=\"line\">$ ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3</span><br></pre></td></tr></table></figure>\n\n<p>安装虚拟环境</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install python-virtualenv  # centos</span><br></pre></td></tr></table></figure>\n\n<p>创建项目</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ virtualenv --no-site-packages -p /usr/bin/python3 .env-project</span><br><span class=\"line\">$ source.env-project/bin/active  # 进入虚拟环境</span><br><span class=\"line\">(.env-project) deactive  # 退出虚拟环境</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2-pyenv安装-适合开发环境\"><a href=\"#2-pyenv安装-适合开发环境\" class=\"headerlink\" title=\"2. pyenv安装(适合开发环境)\"></a>2. pyenv安装(适合开发环境)</h4><p>安装pyenv</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -L https://raw.githubusercontent.com/pyenv/pyenv-installer/master/bin/pyenv-installer | bash</span><br></pre></td></tr></table></figure>\n\n<p>设置环境变量</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim ~/.zshrc  # 具体文件看自己的终端工具</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export PATH=$HOME/.pyenv/bin:$PATH</span><br><span class=\"line\">eval &quot;$(pyenv init -)&quot;</span><br><span class=\"line\">eval &quot;$(pyenv virtualenv-init -)&quot;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ source ~/.zshrc</span><br></pre></td></tr></table></figure>\n\n<p>检查环境</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ pyenv doctor  # 如有错误，根据自己的环境解决</span><br></pre></td></tr></table></figure>\n\n<p>安装python3.x.x</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ pyenv install 3.6.6</span><br></pre></td></tr></table></figure>\n\n<p>如果pyenv下载文件缓慢，可以先下载文件到缓存中</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ cd ~/.pyenv/cache  # 没有则创建文件</span><br><span class=\"line\">$ wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tar.xz</span><br><span class=\"line\">$ pyenv install 3.6.6</span><br></pre></td></tr></table></figure>\n\n<p>依次安装python3.7.3 python2.7.10</p>\n<p>查看当前系统所有python版本</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ pyenv versions</span><br><span class=\"line\">* system (set by /home/zhc/.pyenv/version)</span><br><span class=\"line\">  2.7.10</span><br><span class=\"line\">  3.6.6</span><br><span class=\"line\">  3.7.3</span><br></pre></td></tr></table></figure>\n\n<p>pyenv系统级别global切换版本&lt;pyenv目录级别local切换版本&lt;pyenv当前shell级别切换版本</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ pyenv global 3.6.6                                                                 </span><br><span class=\"line\">$ pyenv version                                                                     </span><br><span class=\"line\">3.6.6 (set by /home/zhc/.pyenv/version)                                                 </span><br><span class=\"line\">$ pyenv global 3.7.3</span><br><span class=\"line\">$ pyenv version</span><br><span class=\"line\">3.7.3 (set by /home/zhc/.pyenv/version)</span><br><span class=\"line\">$ pyenv shell 3.6.6</span><br><span class=\"line\">$ pyenv version</span><br><span class=\"line\">3.6.6 (set by PYENV_VERSION environment variable) </span><br><span class=\"line\">$ pyenv local 3.6.6  # 会在当前文件夹下创建.python-version文件，存储虚拟环境名称</span><br></pre></td></tr></table></figure>\n\n<p>pyenv安装虚拟环境</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyenv virtualenv 3.6.6 test-3.6.6</span><br><span class=\"line\">pyenv virtualenv 3.7.3 test-3.7.3</span><br></pre></td></tr></table></figure>\n\n<p>pyenv删除虚拟环境</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyenv uninstall test-3.6.6</span><br></pre></td></tr></table></figure>\n\n<p>pyenv查看全部虚拟环境</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  ~ pyenv virtualenvs                                                                 </span><br><span class=\"line\">  3.6.6/envs/test-3.6.6 (created from /home/zhc/.pyenv/versions/3.6.6)                 </span><br><span class=\"line\">  3.7.3/envs/test-3.7.3 (created from /home/zhc/.pyenv/versions/3.7.3)                 </span><br><span class=\"line\">  test-3.6.6 (created from /home/zhc/.pyenv/versions/3.6.6)</span><br><span class=\"line\">  test-3.7.3 (created from /home/zhc/.pyenv/versions/3.7.3)</span><br></pre></td></tr></table></figure>\n\n<p>切换虚拟环境</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ pyenv activate test-3.6.6</span><br><span class=\"line\">$ pyenv local test-3.6.6</span><br><span class=\"line\">$ source deactivate</span><br></pre></td></tr></table></figure>\n\n<p>pyenv重建环境变量</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyenv rehash</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码安装python2-7-9\"><a href=\"#源码安装python2-7-9\" class=\"headerlink\" title=\"源码安装python2.7.9\"></a>源码安装python2.7.9</h4><pre><code>$ sudo apt-get install -y openssl\n$ sudo apt-get install -y libssl-dev # 即 openssl-devel\n$ sudo apt-get install -y libffi-dev # 即 libffi-devel\n$ sudo apt-get install -y python-openssl\n$ sudo apt-get install libbz2-dev\n$ sudo apt-get install libxml2-dev\n$ sudo apt-get install libxslt1-dev\n$ sudo apt-get install sqlite3 libsqlite3-dev\n$ sudo apt-get install libmysqlclient-dev\n\n\nwget -c https://www.python.org/ftp/python/2.7.9/Python-2.7.9.tgz  \ntar -xzvf Python-2.7.9.tgz  \ncd Python-2.7.9/ </code></pre><p>修改源码，支持ssl</p>\n<pre><code>vim Modules/Setup.dist\n\n\n# Socket module helper for SSL support; you must comment out the other\n# socket line above, and possibly edit the SSL variable:\n#SSL=/usr/local/ssl\n#_ssl _ssl.c \\\n#        -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \\\n#        -L$(SSL)/lib -lssl -lcrypto</code></pre><p>改成</p>\n<pre><code># Socket module helper for SSL support; you must comment out the other\n# socket line above, and possibly edit the SSL variable:\nSSL=/usr/local/ssl\n_ssl _ssl.c \\\n        -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \\\n\n        -L$(SSL)/lib -lssl -lcrypto\n\n\nLDFLAGS=&quot;-L/usr/lib/x86_64-linux-gnu&quot; ./configure  \nmake  \nsudo make install</code></pre><h4 id=\"虚拟环境搭建\"><a href=\"#虚拟环境搭建\" class=\"headerlink\" title=\"虚拟环境搭建\"></a>虚拟环境搭建</h4><p>安装</p>\n<pre><code>sudo apt-get install python-virtualenv</code></pre><p>创建虚拟环境</p>\n<pre><code>cd ~/var/www\nvirtualenv --no-site-packages -p /usr/local/bin/python Novel # 参数表示不安装系统已经安装的第三方包, -p表示用哪个版本的python</code></pre><p>启用虚拟环境</p>\n<pre><code>cd /var/www/Novel\nsource ./bin/activate</code></pre><p>虚拟环境安装包</p>\n<pre><code>(Novel) pip isntall django==1.8.2 # 不能加sudo</code></pre><p>退出虚拟环境，进入正常环境</p>\n<pre><code>deactivate</code></pre><p>虚拟环境复制</p>\n<pre><code>pip freeze &gt; requirements.txt\npip install -r requirements.txt</code></pre><h4 id=\"pip安装超时\"><a href=\"#pip安装超时\" class=\"headerlink\" title=\"pip安装超时\"></a>pip安装超时</h4><pre><code>pip --default-timeout=100 install -U pip</code></pre><h4 id=\"安装python-mysql\"><a href=\"#安装python-mysql\" class=\"headerlink\" title=\"安装python-mysql\"></a>安装python-mysql</h4><pre><code>sudo apt-get install python-setuptools\n\nsudo apt-get install libmysqld-dev\n\nsudo apt-get install libmysqlclient-dev\n\nsudo apt-get install python-dev\n\nsudo easy_install mysql-python</code></pre><p>在终端输入以下内容,不报错则表示成功</p>\n<pre><code>import MySQLdb</code></pre><h4 id=\"获取文件修改时间\"><a href=\"#获取文件修改时间\" class=\"headerlink\" title=\"获取文件修改时间\"></a>获取文件修改时间</h4><pre><code>import time\nfilemt= time.localtime(os.stat(filename).st_mtime)  #文件修改时间\nfilect = time.localtime(os.stat(filename).st_ctime)  #文件创建\nprint time.strftime(&quot;%Y-%m-%d&quot;,filemt)  \nprint time.strftime(&quot;%Y-%m-%d&quot;,filect)</code></pre><h4 id=\"获取多少天以前的时间\"><a href=\"#获取多少天以前的时间\" class=\"headerlink\" title=\"获取多少天以前的时间\"></a>获取多少天以前的时间</h4><pre><code>import datetime\n# 30天以前的日期\ndate_time = (datetime.datetime.now() - datetime.timedelta(days=30)).strftime(&quot;%Y-%m-%d&quot;)\nprint date_time</code></pre><h4 id=\"去除列表重复项内容\"><a href=\"#去除列表重复项内容\" class=\"headerlink\" title=\"去除列表重复项内容\"></a>去除列表重复项内容</h4><pre><code># 如果列表里面内容为字典\nf = lambda x,y:x if y in x else x + [y]\nproducts = reduce(f, [[], ] + products_query)\nprint products\n\n# 如果列表里面内容为字符串\nl1 = [&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;b&apos;,&apos;c&apos;,&apos;a&apos;,&apos;a&apos;]\nl2 = list(set(l1))\nprint l2\n# 保持原来的顺序\nl1 = [&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;b&apos;,&apos;c&apos;,&apos;a&apos;,&apos;a&apos;]\nl2 = sorted(set(l1),key=l1.index)\nprint l2</code></pre><h4 id=\"md5，hash加密\"><a href=\"#md5，hash加密\" class=\"headerlink\" title=\"md5，hash加密\"></a>md5，hash加密</h4><pre><code>import hashlib\ndata =  &apos;This a md5 test!&apos;\nhash_md5 = hashlib.md5(data)  # md5\nhash_md5.hexdigest()\n\nhashlib.sha1(&apos;This is a sha1 test!&apos;).hexdigest() # sha1</code></pre><h4 id=\"打印输出对象\"><a href=\"#打印输出对象\" class=\"headerlink\" title=\"打印输出对象\"></a>打印输出对象</h4><pre><code>from pprint import pprint\npprint(vars(object))</code></pre><h1 id=\"windows安装python相关环境\"><a href=\"#windows安装python相关环境\" class=\"headerlink\" title=\"windows安装python相关环境\"></a>windows安装python相关环境</h1><h4 id=\"安装虚拟环境\"><a href=\"#安装虚拟环境\" class=\"headerlink\" title=\"安装虚拟环境\"></a>安装虚拟环境</h4><pre><code># 安装包\npip install virtualenv\n# 创建虚拟环境env\nvirtualenv.exe  env\n# 开启虚拟环境\n./scripts/active\n# 退出虚拟环境\ndeactivate</code></pre>"},{"title":"minicat-manjaro-18.0.4-dev","date":"2019-07-24T06:11:44.000Z","_content":"\n#### 添加中科大源\n\n```shell\n$ sudo vi /etc/pacman.conf\n```\n```shell\n# 在文件末尾添加\n[archlinuxcn]\nSigLevel = Optional TrustedOnly\nServer = https://mirrors.ustc.edu.cn/archlinuxcn/$arch\n```\n\n#### 导入GPG Key\n\n```shell\n$ sudo pacman -Syy && sudo pacman -S archlinuxcn-keyring\n```\n#### 安装基本开发编译软件\n\n```shell\nsudo pacman -S --needed base-devel\n```\n#### 安装git\n\n```shell\n$ sudo pacman -S git\n```\n\n#### 安装chrome\n\n```shell\n$ sudo pacman -S google-chrome\n```\n\n#### 安装搜狗拼音输入法\n\n```shell\n$ sudo pacman -S fcitx-im #默认全部安装\n$ sudo pacman -S fcitx-configtool\n$ sudo pacman -S fcitx-sogoupinyin\n```\n#### 编辑输入法配置文件\n\n```shell\n$ sudo nano ~/.xprofile\n\nexport GTK_IM_MODULE=fcitx\nexport QT_IM_MODULE=fcitx\nexport XMODIFIERS=\"@im=fcitx\"\n# 重启后输入法就可以正常使用。\n```\n\n#### 安装vim\n\n```shell\n$ sudo pacman -S vim\n```\n安装vim基础配置\n\n```shell\n$ curl https://raw.githubusercontent.com/wklken/vim-for-server/master/vimrc > ~/.vimrc\n```\n\n#### 安装tmux和.tmux\n\n```shell\n$ sudo pacman -S tmux\n$ cd ~\n$ git clone https://github.com/gpakosz/.tmux.git\n$ ln -s -f .tmux/.tmux.conf\n$ cp .tmux/.tmux.conf.local .\n```\n\n#### 安装zsh和oh-my-zsh\n\n```shell\n$ sudo pacman -S zsh\n$ sh -c \"$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)\"\n```\n\n#### 安装yaourt\n\n```shell\n$ sudo pacman -S --needed base-devel git wget yajl\n$ cd /tmp\n$ git clone https://aur.archlinux.org/package-query.git\n$ cd package-query/\n$ makepkg -si && cd /tmp/\n$ git clone https://aur.archlinux.org/yaourt.git\n$ cd yaourt/\n$ makepkg -si\n```\n\n#### 安装shadowsocks\n\n```shell\n$ git clone https://aur.archlinux.org/shadowsocks-qt5-git.git\n$ cd shadowsocks-qt5-git\n$ less PKGBUILD  # 查看\n$ makepkg -si  # 安装\n```\n\n#### 设置ssh连接不断开\n\n```shell\n# vim ~/.ssh/config\nHost *\n    ServerAliveInterval 60\n```\n\n#### 安装jetbrain全家桶\n\n[jetbrain激活参考地址](http://idea.lanyus.com/)\n\n```shell\n$ sudo vim /etc/hosts\n# 添加以下两行代码\n0.0.0.0 account.jetbrains.com\n0.0.0.0 www.jetbrains.com\n```\n\n#### 安装python开发环境\n\n{% post_link python入门基础 python开发环境 %}\n\n#### 安装rabbitmq\n\n```shell\n$ sudo pacman -S rabbitmq rabbitmqadmin\n$ sudo systemctl enable rabbitmq.service  # 开机启动\n$ sudo systemctl start rabbitmq.service  # 启动\n$ rabbitmq-plugins enable rabbitmq_management  # 开启web界面\n```\n\n#### 安装redis\n```shell\n$ sudo pacman -S redis\n$ sudo systemctl enable redis.service  # 开机启动\n$ sudo systemctl start redis.service  # 启动\n```\n\n设置密码\n\n```shell\n$ sudo vim /etc/redis.conf\nredispassword password\n```\n\n#### 安装node\n\n{% post_link node入门基础 python开发环境 %}\n\n#### 其他软件清单\n\n> peek 录制gif软件\n\n> github desktop github客户端\n\n> postman","source":"_posts/minicat-manjaro-18-0-4-dev.md","raw":"---\ntitle: minicat-manjaro-18.0.4-dev\ndate: 2019-07-24 14:11:44\ntags: \n  - manjaro\n  - linux\n---\n\n#### 添加中科大源\n\n```shell\n$ sudo vi /etc/pacman.conf\n```\n```shell\n# 在文件末尾添加\n[archlinuxcn]\nSigLevel = Optional TrustedOnly\nServer = https://mirrors.ustc.edu.cn/archlinuxcn/$arch\n```\n\n#### 导入GPG Key\n\n```shell\n$ sudo pacman -Syy && sudo pacman -S archlinuxcn-keyring\n```\n#### 安装基本开发编译软件\n\n```shell\nsudo pacman -S --needed base-devel\n```\n#### 安装git\n\n```shell\n$ sudo pacman -S git\n```\n\n#### 安装chrome\n\n```shell\n$ sudo pacman -S google-chrome\n```\n\n#### 安装搜狗拼音输入法\n\n```shell\n$ sudo pacman -S fcitx-im #默认全部安装\n$ sudo pacman -S fcitx-configtool\n$ sudo pacman -S fcitx-sogoupinyin\n```\n#### 编辑输入法配置文件\n\n```shell\n$ sudo nano ~/.xprofile\n\nexport GTK_IM_MODULE=fcitx\nexport QT_IM_MODULE=fcitx\nexport XMODIFIERS=\"@im=fcitx\"\n# 重启后输入法就可以正常使用。\n```\n\n#### 安装vim\n\n```shell\n$ sudo pacman -S vim\n```\n安装vim基础配置\n\n```shell\n$ curl https://raw.githubusercontent.com/wklken/vim-for-server/master/vimrc > ~/.vimrc\n```\n\n#### 安装tmux和.tmux\n\n```shell\n$ sudo pacman -S tmux\n$ cd ~\n$ git clone https://github.com/gpakosz/.tmux.git\n$ ln -s -f .tmux/.tmux.conf\n$ cp .tmux/.tmux.conf.local .\n```\n\n#### 安装zsh和oh-my-zsh\n\n```shell\n$ sudo pacman -S zsh\n$ sh -c \"$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)\"\n```\n\n#### 安装yaourt\n\n```shell\n$ sudo pacman -S --needed base-devel git wget yajl\n$ cd /tmp\n$ git clone https://aur.archlinux.org/package-query.git\n$ cd package-query/\n$ makepkg -si && cd /tmp/\n$ git clone https://aur.archlinux.org/yaourt.git\n$ cd yaourt/\n$ makepkg -si\n```\n\n#### 安装shadowsocks\n\n```shell\n$ git clone https://aur.archlinux.org/shadowsocks-qt5-git.git\n$ cd shadowsocks-qt5-git\n$ less PKGBUILD  # 查看\n$ makepkg -si  # 安装\n```\n\n#### 设置ssh连接不断开\n\n```shell\n# vim ~/.ssh/config\nHost *\n    ServerAliveInterval 60\n```\n\n#### 安装jetbrain全家桶\n\n[jetbrain激活参考地址](http://idea.lanyus.com/)\n\n```shell\n$ sudo vim /etc/hosts\n# 添加以下两行代码\n0.0.0.0 account.jetbrains.com\n0.0.0.0 www.jetbrains.com\n```\n\n#### 安装python开发环境\n\n{% post_link python入门基础 python开发环境 %}\n\n#### 安装rabbitmq\n\n```shell\n$ sudo pacman -S rabbitmq rabbitmqadmin\n$ sudo systemctl enable rabbitmq.service  # 开机启动\n$ sudo systemctl start rabbitmq.service  # 启动\n$ rabbitmq-plugins enable rabbitmq_management  # 开启web界面\n```\n\n#### 安装redis\n```shell\n$ sudo pacman -S redis\n$ sudo systemctl enable redis.service  # 开机启动\n$ sudo systemctl start redis.service  # 启动\n```\n\n设置密码\n\n```shell\n$ sudo vim /etc/redis.conf\nredispassword password\n```\n\n#### 安装node\n\n{% post_link node入门基础 python开发环境 %}\n\n#### 其他软件清单\n\n> peek 录制gif软件\n\n> github desktop github客户端\n\n> postman","slug":"minicat-manjaro-18-0-4-dev","published":1,"updated":"2019-07-26T07:58:46.167Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjyu0a5o900249ka4v168kr99","content":"<h4 id=\"添加中科大源\"><a href=\"#添加中科大源\" class=\"headerlink\" title=\"添加中科大源\"></a>添加中科大源</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo vi /etc/pacman.conf</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 在文件末尾添加</span><br><span class=\"line\">[archlinuxcn]</span><br><span class=\"line\">SigLevel = Optional TrustedOnly</span><br><span class=\"line\">Server = https://mirrors.ustc.edu.cn/archlinuxcn/$arch</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"导入GPG-Key\"><a href=\"#导入GPG-Key\" class=\"headerlink\" title=\"导入GPG Key\"></a>导入GPG Key</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -Syy &amp;&amp; sudo pacman -S archlinuxcn-keyring</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装基本开发编译软件\"><a href=\"#安装基本开发编译软件\" class=\"headerlink\" title=\"安装基本开发编译软件\"></a>安装基本开发编译软件</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo pacman -S --needed base-devel</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装git\"><a href=\"#安装git\" class=\"headerlink\" title=\"安装git\"></a>安装git</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S git</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装chrome\"><a href=\"#安装chrome\" class=\"headerlink\" title=\"安装chrome\"></a>安装chrome</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S google-chrome</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装搜狗拼音输入法\"><a href=\"#安装搜狗拼音输入法\" class=\"headerlink\" title=\"安装搜狗拼音输入法\"></a>安装搜狗拼音输入法</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S fcitx-im #默认全部安装</span><br><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S fcitx-configtool</span><br><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S fcitx-sogoupinyin</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"编辑输入法配置文件\"><a href=\"#编辑输入法配置文件\" class=\"headerlink\" title=\"编辑输入法配置文件\"></a>编辑输入法配置文件</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo nano ~/.xprofile</span><br><span class=\"line\"></span><br><span class=\"line\">export GTK_IM_MODULE=fcitx</span><br><span class=\"line\">export QT_IM_MODULE=fcitx</span><br><span class=\"line\">export XMODIFIERS=\"@im=fcitx\"</span><br><span class=\"line\"><span class=\"meta\">#</span> 重启后输入法就可以正常使用。</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装vim\"><a href=\"#安装vim\" class=\"headerlink\" title=\"安装vim\"></a>安装vim</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S vim</span><br></pre></td></tr></table></figure>\n\n<p>安装vim基础配置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> curl https://raw.githubusercontent.com/wklken/vim-for-server/master/vimrc &gt; ~/.vimrc</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装tmux和-tmux\"><a href=\"#安装tmux和-tmux\" class=\"headerlink\" title=\"安装tmux和.tmux\"></a>安装tmux和.tmux</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S tmux</span><br><span class=\"line\"><span class=\"meta\">$</span> cd ~</span><br><span class=\"line\"><span class=\"meta\">$</span> git clone https://github.com/gpakosz/.tmux.git</span><br><span class=\"line\"><span class=\"meta\">$</span> ln -s -f .tmux/.tmux.conf</span><br><span class=\"line\"><span class=\"meta\">$</span> cp .tmux/.tmux.conf.local .</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装zsh和oh-my-zsh\"><a href=\"#安装zsh和oh-my-zsh\" class=\"headerlink\" title=\"安装zsh和oh-my-zsh\"></a>安装zsh和oh-my-zsh</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S zsh</span><br><span class=\"line\"><span class=\"meta\">$</span> sh -c \"$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)\"</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装yaourt\"><a href=\"#安装yaourt\" class=\"headerlink\" title=\"安装yaourt\"></a>安装yaourt</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S --needed base-devel git wget yajl</span><br><span class=\"line\"><span class=\"meta\">$</span> cd /tmp</span><br><span class=\"line\"><span class=\"meta\">$</span> git clone https://aur.archlinux.org/package-query.git</span><br><span class=\"line\"><span class=\"meta\">$</span> cd package-query/</span><br><span class=\"line\"><span class=\"meta\">$</span> makepkg -si &amp;&amp; cd /tmp/</span><br><span class=\"line\"><span class=\"meta\">$</span> git clone https://aur.archlinux.org/yaourt.git</span><br><span class=\"line\"><span class=\"meta\">$</span> cd yaourt/</span><br><span class=\"line\"><span class=\"meta\">$</span> makepkg -si</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装shadowsocks\"><a href=\"#安装shadowsocks\" class=\"headerlink\" title=\"安装shadowsocks\"></a>安装shadowsocks</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> git clone https://aur.archlinux.org/shadowsocks-qt5-git.git</span><br><span class=\"line\"><span class=\"meta\">$</span> cd shadowsocks-qt5-git</span><br><span class=\"line\"><span class=\"meta\">$</span> less PKGBUILD  # 查看</span><br><span class=\"line\"><span class=\"meta\">$</span> makepkg -si  # 安装</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"设置ssh连接不断开\"><a href=\"#设置ssh连接不断开\" class=\"headerlink\" title=\"设置ssh连接不断开\"></a>设置ssh连接不断开</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> vim ~/.ssh/config</span><br><span class=\"line\">Host *</span><br><span class=\"line\">    ServerAliveInterval 60</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装jetbrain全家桶\"><a href=\"#安装jetbrain全家桶\" class=\"headerlink\" title=\"安装jetbrain全家桶\"></a>安装jetbrain全家桶</h4><p><a href=\"http://idea.lanyus.com/\" target=\"_blank\" rel=\"noopener\">jetbrain激活参考地址</a></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo vim /etc/hosts</span><br><span class=\"line\"><span class=\"meta\">#</span> 添加以下两行代码</span><br><span class=\"line\">0.0.0.0 account.jetbrains.com</span><br><span class=\"line\">0.0.0.0 www.jetbrains.com</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装python开发环境\"><a href=\"#安装python开发环境\" class=\"headerlink\" title=\"安装python开发环境\"></a>安装python开发环境</h4><a href=\"/2016/11/09/python入门基础/\" title=\"python开发环境\">python开发环境</a>\n\n<h4 id=\"安装rabbitmq\"><a href=\"#安装rabbitmq\" class=\"headerlink\" title=\"安装rabbitmq\"></a>安装rabbitmq</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S rabbitmq rabbitmqadmin</span><br><span class=\"line\"><span class=\"meta\">$</span> sudo systemctl enable rabbitmq.service  # 开机启动</span><br><span class=\"line\"><span class=\"meta\">$</span> sudo systemctl start rabbitmq.service  # 启动</span><br><span class=\"line\"><span class=\"meta\">$</span> rabbitmq-plugins enable rabbitmq_management  # 开启web界面</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装redis\"><a href=\"#安装redis\" class=\"headerlink\" title=\"安装redis\"></a>安装redis</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S redis</span><br><span class=\"line\"><span class=\"meta\">$</span> sudo systemctl enable redis.service  # 开机启动</span><br><span class=\"line\"><span class=\"meta\">$</span> sudo systemctl start redis.service  # 启动</span><br></pre></td></tr></table></figure>\n\n<p>设置密码</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo vim /etc/redis.conf</span><br><span class=\"line\">redispassword password</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装node\"><a href=\"#安装node\" class=\"headerlink\" title=\"安装node\"></a>安装node</h4><a href=\"/2019/07/26/node入门基础/\" title=\"python开发环境\">python开发环境</a>\n\n<h4 id=\"其他软件清单\"><a href=\"#其他软件清单\" class=\"headerlink\" title=\"其他软件清单\"></a>其他软件清单</h4><blockquote>\n<p>peek 录制gif软件</p>\n</blockquote>\n<blockquote>\n<p>github desktop github客户端</p>\n</blockquote>\n<blockquote>\n<p>postman</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"添加中科大源\"><a href=\"#添加中科大源\" class=\"headerlink\" title=\"添加中科大源\"></a>添加中科大源</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo vi /etc/pacman.conf</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 在文件末尾添加</span><br><span class=\"line\">[archlinuxcn]</span><br><span class=\"line\">SigLevel = Optional TrustedOnly</span><br><span class=\"line\">Server = https://mirrors.ustc.edu.cn/archlinuxcn/$arch</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"导入GPG-Key\"><a href=\"#导入GPG-Key\" class=\"headerlink\" title=\"导入GPG Key\"></a>导入GPG Key</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -Syy &amp;&amp; sudo pacman -S archlinuxcn-keyring</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装基本开发编译软件\"><a href=\"#安装基本开发编译软件\" class=\"headerlink\" title=\"安装基本开发编译软件\"></a>安装基本开发编译软件</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo pacman -S --needed base-devel</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装git\"><a href=\"#安装git\" class=\"headerlink\" title=\"安装git\"></a>安装git</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S git</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装chrome\"><a href=\"#安装chrome\" class=\"headerlink\" title=\"安装chrome\"></a>安装chrome</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S google-chrome</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装搜狗拼音输入法\"><a href=\"#安装搜狗拼音输入法\" class=\"headerlink\" title=\"安装搜狗拼音输入法\"></a>安装搜狗拼音输入法</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S fcitx-im #默认全部安装</span><br><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S fcitx-configtool</span><br><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S fcitx-sogoupinyin</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"编辑输入法配置文件\"><a href=\"#编辑输入法配置文件\" class=\"headerlink\" title=\"编辑输入法配置文件\"></a>编辑输入法配置文件</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo nano ~/.xprofile</span><br><span class=\"line\"></span><br><span class=\"line\">export GTK_IM_MODULE=fcitx</span><br><span class=\"line\">export QT_IM_MODULE=fcitx</span><br><span class=\"line\">export XMODIFIERS=\"@im=fcitx\"</span><br><span class=\"line\"><span class=\"meta\">#</span> 重启后输入法就可以正常使用。</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装vim\"><a href=\"#安装vim\" class=\"headerlink\" title=\"安装vim\"></a>安装vim</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S vim</span><br></pre></td></tr></table></figure>\n\n<p>安装vim基础配置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> curl https://raw.githubusercontent.com/wklken/vim-for-server/master/vimrc &gt; ~/.vimrc</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装tmux和-tmux\"><a href=\"#安装tmux和-tmux\" class=\"headerlink\" title=\"安装tmux和.tmux\"></a>安装tmux和.tmux</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S tmux</span><br><span class=\"line\"><span class=\"meta\">$</span> cd ~</span><br><span class=\"line\"><span class=\"meta\">$</span> git clone https://github.com/gpakosz/.tmux.git</span><br><span class=\"line\"><span class=\"meta\">$</span> ln -s -f .tmux/.tmux.conf</span><br><span class=\"line\"><span class=\"meta\">$</span> cp .tmux/.tmux.conf.local .</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装zsh和oh-my-zsh\"><a href=\"#安装zsh和oh-my-zsh\" class=\"headerlink\" title=\"安装zsh和oh-my-zsh\"></a>安装zsh和oh-my-zsh</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S zsh</span><br><span class=\"line\"><span class=\"meta\">$</span> sh -c \"$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)\"</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装yaourt\"><a href=\"#安装yaourt\" class=\"headerlink\" title=\"安装yaourt\"></a>安装yaourt</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S --needed base-devel git wget yajl</span><br><span class=\"line\"><span class=\"meta\">$</span> cd /tmp</span><br><span class=\"line\"><span class=\"meta\">$</span> git clone https://aur.archlinux.org/package-query.git</span><br><span class=\"line\"><span class=\"meta\">$</span> cd package-query/</span><br><span class=\"line\"><span class=\"meta\">$</span> makepkg -si &amp;&amp; cd /tmp/</span><br><span class=\"line\"><span class=\"meta\">$</span> git clone https://aur.archlinux.org/yaourt.git</span><br><span class=\"line\"><span class=\"meta\">$</span> cd yaourt/</span><br><span class=\"line\"><span class=\"meta\">$</span> makepkg -si</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装shadowsocks\"><a href=\"#安装shadowsocks\" class=\"headerlink\" title=\"安装shadowsocks\"></a>安装shadowsocks</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> git clone https://aur.archlinux.org/shadowsocks-qt5-git.git</span><br><span class=\"line\"><span class=\"meta\">$</span> cd shadowsocks-qt5-git</span><br><span class=\"line\"><span class=\"meta\">$</span> less PKGBUILD  # 查看</span><br><span class=\"line\"><span class=\"meta\">$</span> makepkg -si  # 安装</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"设置ssh连接不断开\"><a href=\"#设置ssh连接不断开\" class=\"headerlink\" title=\"设置ssh连接不断开\"></a>设置ssh连接不断开</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> vim ~/.ssh/config</span><br><span class=\"line\">Host *</span><br><span class=\"line\">    ServerAliveInterval 60</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装jetbrain全家桶\"><a href=\"#安装jetbrain全家桶\" class=\"headerlink\" title=\"安装jetbrain全家桶\"></a>安装jetbrain全家桶</h4><p><a href=\"http://idea.lanyus.com/\" target=\"_blank\" rel=\"noopener\">jetbrain激活参考地址</a></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo vim /etc/hosts</span><br><span class=\"line\"><span class=\"meta\">#</span> 添加以下两行代码</span><br><span class=\"line\">0.0.0.0 account.jetbrains.com</span><br><span class=\"line\">0.0.0.0 www.jetbrains.com</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装python开发环境\"><a href=\"#安装python开发环境\" class=\"headerlink\" title=\"安装python开发环境\"></a>安装python开发环境</h4><a href=\"/2016/11/09/python入门基础/\" title=\"python开发环境\">python开发环境</a>\n\n<h4 id=\"安装rabbitmq\"><a href=\"#安装rabbitmq\" class=\"headerlink\" title=\"安装rabbitmq\"></a>安装rabbitmq</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S rabbitmq rabbitmqadmin</span><br><span class=\"line\"><span class=\"meta\">$</span> sudo systemctl enable rabbitmq.service  # 开机启动</span><br><span class=\"line\"><span class=\"meta\">$</span> sudo systemctl start rabbitmq.service  # 启动</span><br><span class=\"line\"><span class=\"meta\">$</span> rabbitmq-plugins enable rabbitmq_management  # 开启web界面</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装redis\"><a href=\"#安装redis\" class=\"headerlink\" title=\"安装redis\"></a>安装redis</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo pacman -S redis</span><br><span class=\"line\"><span class=\"meta\">$</span> sudo systemctl enable redis.service  # 开机启动</span><br><span class=\"line\"><span class=\"meta\">$</span> sudo systemctl start redis.service  # 启动</span><br></pre></td></tr></table></figure>\n\n<p>设置密码</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> sudo vim /etc/redis.conf</span><br><span class=\"line\">redispassword password</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装node\"><a href=\"#安装node\" class=\"headerlink\" title=\"安装node\"></a>安装node</h4><a href=\"/2019/07/26/node入门基础/\" title=\"python开发环境\">python开发环境</a>\n\n<h4 id=\"其他软件清单\"><a href=\"#其他软件清单\" class=\"headerlink\" title=\"其他软件清单\"></a>其他软件清单</h4><blockquote>\n<p>peek 录制gif软件</p>\n</blockquote>\n<blockquote>\n<p>github desktop github客户端</p>\n</blockquote>\n<blockquote>\n<p>postman</p>\n</blockquote>\n"},{"title":"redis基础","url":"486.html","id":"486","comments":0,"date":"2018-01-11T07:51:36.000Z","_content":"\nREmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。 Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。 它通常被称为数据结构服务器，因为值（value）可以是 字符串(String), 哈希(Map), 列表(list), 集合(sets) 和 有序集合(sorted sets)等类型。\n\n### redis安装\n\n    $sudo apt-get update\n    $sudo apt-get install redis-server\n    $redis-cli\n    \n\n### redis配置\n\n    sudo vim /etc/redis.conf\n    # 设置为守护进程\n    protected-mode yes\n    # 设置密码\n    requirepass redispassword\n    # port\n    port 6379\n    # bind 127.0.0.1\n    bing 0.0.0.0 # 允许远程访问\n    \n    \n\n### 客户端远程登录\n\n    redis-cli -h 127.0.0.1 -p 6379 -a redispassword\n    \n\n### redis客户端\n\n    # redis-commander，基于nodejs\n    $ npm install -g redis-commander\n    $ redis-commander\n    \n\n### 通用命令\n\n    $ 127.0.0.1:6379> del name # 删除数据\n    $ 127.0.0.1:6379> type name # 查看数据类型\n    $ 127.0.0.1:6379> rename name # 重命名\n    \n    \n\n### 数据结构\n\n字符串string\n\n    $ 127.0.0.1:6379>  set string-name value\n    $ 127.0.0.1:6379> get string-name\n    $ 127.0.0.1:6379>  del string-name\n    \n\n列表list： 相当于默认键的数组\n\n    $ 127.0.0.1:6379> lpush list-name value1 value2 value3 ... # 左侧插入列表值\n    (integer) 3\n    $ 127.0.0.1:6379> rpush list-name value4 value5 value6... # 右侧插入列表值\n    (integer) 6\n    $ 127.0.0.1:6379>  lindex list-name 1 # 获取第1个的值\n    \"value2\"\n    $ 127.0.0.1:6379>  lrange list-name 1 2 # 获取从第1位置到2位置的列表值\n    1) \"value2\"\n    2) \"value1\"\n    $ 127.0.0.1:6379>  lpop list-name # 弹出最左边值\n    \"value3\"\n    $ 127.0.0.1:6379> rpop list-name # 弹出最右边值\n    \"value6\"\n    \n\n集合set：无序，不重复的列表\n\n    $ 127.0.0.1:6379>  sadd set-name value1 value2 value3 # 设置无序列表值\n    (integer) 3\n    $ 127.0.0.1:6379> smembers set-name  # 查看所有值\n    1) \"value3\"\n    2) \"value2\"\n    3) \"value1\"\n    $ 127.0.0.1:6379> srem set-name value1 # 删除值\n    (integer) 1\n    $ 127.0.0.1:6379> sismember set-name value2 # 查看是否在无序列表内\n    (integer) 1\n    \n\n散列值hash：相当于自定义键的数组\n\n    $ 127.0.0.1:6379> HSET hash-name key1 value1 #设置键值对\n    (integer) 1\n    $ 127.0.0.1:6379> HGET hash-name key1 # 获取指定键的值\n    \"value1\"\n    $ 127.0.0.1:6379> HSET hash-name key1 value2 # 更新键的值\n    (integer) 0\n    $ 127.0.0.1:6379> HGET hash-name key1 \n    \"value2\"\n    $ 127.0.0.1:6379> HSET hash-name key2 value2\n    (integer) 1\n    $ 127.0.0.1:6379> HGETALL hash-name # 查找所有键值对\n    1) \"key1\"\n    2) \"value2\"\n    3) \"key2\"\n    4) \"value2\"\n    $ 127.0.0.1:6379> HDEL hash-name key1 # 删除hash键值对\n    (integer) 1\n    \n\n有序集合zset：成员+分值，分值必须是浮点数，通过浮点数进行排序\n\n    $ 127.0.0.1:6379> zadd zset-name 100 member1 # 添加键值对\n    (integer) 1\n    $ 127.0.0.1:6379> zadd zset-name 202 member2\n    (integer) 1\n    $ 127.0.0.1:6379> zadd zset-name 803 member3\n    (integer) 1\n    $ 127.0.0.1:6379> ZRANGE zset-name 0 -1 # 获取多个元素\n    1) \"member1\"\n    2) \"member2\"\n    3) \"member3\"\n    $ 127.0.0.1:6379> ZRANGE zset-name 0 -1 withscores # 获取多个元素\n    1) \"member1\"\n    2) \"100\"\n    3) \"member2\"\n    4) \"202\"\n    5) \"member3\"\n    6) \"803\"\n    $ 127.0.0.1:6379> ZRANGEBYSCORE zset-name 0 300 withscores # 按score获取多个元素\n    1) \"member1\"\n    2) \"100\"\n    3) \"member2\"\n    4) \"202\"\n    $ 127.0.0.1:6379> ZREM zset-name member1 # 移除一个元素\n    (integer) 1","source":"_posts/redis基础.md","raw":"---\ntitle: redis基础\ntags:\n  - redis\n  - 数据库\nurl: 486.html\nid: 486\ncomments: false\ncategories:\n  - 后端\n  - 运维\ndate: 2018-01-11 15:51:36\n---\n\nREmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。 Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。 它通常被称为数据结构服务器，因为值（value）可以是 字符串(String), 哈希(Map), 列表(list), 集合(sets) 和 有序集合(sorted sets)等类型。\n\n### redis安装\n\n    $sudo apt-get update\n    $sudo apt-get install redis-server\n    $redis-cli\n    \n\n### redis配置\n\n    sudo vim /etc/redis.conf\n    # 设置为守护进程\n    protected-mode yes\n    # 设置密码\n    requirepass redispassword\n    # port\n    port 6379\n    # bind 127.0.0.1\n    bing 0.0.0.0 # 允许远程访问\n    \n    \n\n### 客户端远程登录\n\n    redis-cli -h 127.0.0.1 -p 6379 -a redispassword\n    \n\n### redis客户端\n\n    # redis-commander，基于nodejs\n    $ npm install -g redis-commander\n    $ redis-commander\n    \n\n### 通用命令\n\n    $ 127.0.0.1:6379> del name # 删除数据\n    $ 127.0.0.1:6379> type name # 查看数据类型\n    $ 127.0.0.1:6379> rename name # 重命名\n    \n    \n\n### 数据结构\n\n字符串string\n\n    $ 127.0.0.1:6379>  set string-name value\n    $ 127.0.0.1:6379> get string-name\n    $ 127.0.0.1:6379>  del string-name\n    \n\n列表list： 相当于默认键的数组\n\n    $ 127.0.0.1:6379> lpush list-name value1 value2 value3 ... # 左侧插入列表值\n    (integer) 3\n    $ 127.0.0.1:6379> rpush list-name value4 value5 value6... # 右侧插入列表值\n    (integer) 6\n    $ 127.0.0.1:6379>  lindex list-name 1 # 获取第1个的值\n    \"value2\"\n    $ 127.0.0.1:6379>  lrange list-name 1 2 # 获取从第1位置到2位置的列表值\n    1) \"value2\"\n    2) \"value1\"\n    $ 127.0.0.1:6379>  lpop list-name # 弹出最左边值\n    \"value3\"\n    $ 127.0.0.1:6379> rpop list-name # 弹出最右边值\n    \"value6\"\n    \n\n集合set：无序，不重复的列表\n\n    $ 127.0.0.1:6379>  sadd set-name value1 value2 value3 # 设置无序列表值\n    (integer) 3\n    $ 127.0.0.1:6379> smembers set-name  # 查看所有值\n    1) \"value3\"\n    2) \"value2\"\n    3) \"value1\"\n    $ 127.0.0.1:6379> srem set-name value1 # 删除值\n    (integer) 1\n    $ 127.0.0.1:6379> sismember set-name value2 # 查看是否在无序列表内\n    (integer) 1\n    \n\n散列值hash：相当于自定义键的数组\n\n    $ 127.0.0.1:6379> HSET hash-name key1 value1 #设置键值对\n    (integer) 1\n    $ 127.0.0.1:6379> HGET hash-name key1 # 获取指定键的值\n    \"value1\"\n    $ 127.0.0.1:6379> HSET hash-name key1 value2 # 更新键的值\n    (integer) 0\n    $ 127.0.0.1:6379> HGET hash-name key1 \n    \"value2\"\n    $ 127.0.0.1:6379> HSET hash-name key2 value2\n    (integer) 1\n    $ 127.0.0.1:6379> HGETALL hash-name # 查找所有键值对\n    1) \"key1\"\n    2) \"value2\"\n    3) \"key2\"\n    4) \"value2\"\n    $ 127.0.0.1:6379> HDEL hash-name key1 # 删除hash键值对\n    (integer) 1\n    \n\n有序集合zset：成员+分值，分值必须是浮点数，通过浮点数进行排序\n\n    $ 127.0.0.1:6379> zadd zset-name 100 member1 # 添加键值对\n    (integer) 1\n    $ 127.0.0.1:6379> zadd zset-name 202 member2\n    (integer) 1\n    $ 127.0.0.1:6379> zadd zset-name 803 member3\n    (integer) 1\n    $ 127.0.0.1:6379> ZRANGE zset-name 0 -1 # 获取多个元素\n    1) \"member1\"\n    2) \"member2\"\n    3) \"member3\"\n    $ 127.0.0.1:6379> ZRANGE zset-name 0 -1 withscores # 获取多个元素\n    1) \"member1\"\n    2) \"100\"\n    3) \"member2\"\n    4) \"202\"\n    5) \"member3\"\n    6) \"803\"\n    $ 127.0.0.1:6379> ZRANGEBYSCORE zset-name 0 300 withscores # 按score获取多个元素\n    1) \"member1\"\n    2) \"100\"\n    3) \"member2\"\n    4) \"202\"\n    $ 127.0.0.1:6379> ZREM zset-name member1 # 移除一个元素\n    (integer) 1","slug":"redis基础","published":1,"updated":"2019-07-24T01:33:20.923Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5oa00279ka4n1mxjwtl","content":"<p>REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。 Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。 它通常被称为数据结构服务器，因为值（value）可以是 字符串(String), 哈希(Map), 列表(list), 集合(sets) 和 有序集合(sorted sets)等类型。</p>\n<h3 id=\"redis安装\"><a href=\"#redis安装\" class=\"headerlink\" title=\"redis安装\"></a>redis安装</h3><pre><code>$sudo apt-get update\n$sudo apt-get install redis-server\n$redis-cli</code></pre><h3 id=\"redis配置\"><a href=\"#redis配置\" class=\"headerlink\" title=\"redis配置\"></a>redis配置</h3><pre><code>sudo vim /etc/redis.conf\n# 设置为守护进程\nprotected-mode yes\n# 设置密码\nrequirepass redispassword\n# port\nport 6379\n# bind 127.0.0.1\nbing 0.0.0.0 # 允许远程访问</code></pre><h3 id=\"客户端远程登录\"><a href=\"#客户端远程登录\" class=\"headerlink\" title=\"客户端远程登录\"></a>客户端远程登录</h3><pre><code>redis-cli -h 127.0.0.1 -p 6379 -a redispassword</code></pre><h3 id=\"redis客户端\"><a href=\"#redis客户端\" class=\"headerlink\" title=\"redis客户端\"></a>redis客户端</h3><pre><code># redis-commander，基于nodejs\n$ npm install -g redis-commander\n$ redis-commander</code></pre><h3 id=\"通用命令\"><a href=\"#通用命令\" class=\"headerlink\" title=\"通用命令\"></a>通用命令</h3><pre><code>$ 127.0.0.1:6379&gt; del name # 删除数据\n$ 127.0.0.1:6379&gt; type name # 查看数据类型\n$ 127.0.0.1:6379&gt; rename name # 重命名</code></pre><h3 id=\"数据结构\"><a href=\"#数据结构\" class=\"headerlink\" title=\"数据结构\"></a>数据结构</h3><p>字符串string</p>\n<pre><code>$ 127.0.0.1:6379&gt;  set string-name value\n$ 127.0.0.1:6379&gt; get string-name\n$ 127.0.0.1:6379&gt;  del string-name</code></pre><p>列表list： 相当于默认键的数组</p>\n<pre><code>$ 127.0.0.1:6379&gt; lpush list-name value1 value2 value3 ... # 左侧插入列表值\n(integer) 3\n$ 127.0.0.1:6379&gt; rpush list-name value4 value5 value6... # 右侧插入列表值\n(integer) 6\n$ 127.0.0.1:6379&gt;  lindex list-name 1 # 获取第1个的值\n&quot;value2&quot;\n$ 127.0.0.1:6379&gt;  lrange list-name 1 2 # 获取从第1位置到2位置的列表值\n1) &quot;value2&quot;\n2) &quot;value1&quot;\n$ 127.0.0.1:6379&gt;  lpop list-name # 弹出最左边值\n&quot;value3&quot;\n$ 127.0.0.1:6379&gt; rpop list-name # 弹出最右边值\n&quot;value6&quot;</code></pre><p>集合set：无序，不重复的列表</p>\n<pre><code>$ 127.0.0.1:6379&gt;  sadd set-name value1 value2 value3 # 设置无序列表值\n(integer) 3\n$ 127.0.0.1:6379&gt; smembers set-name  # 查看所有值\n1) &quot;value3&quot;\n2) &quot;value2&quot;\n3) &quot;value1&quot;\n$ 127.0.0.1:6379&gt; srem set-name value1 # 删除值\n(integer) 1\n$ 127.0.0.1:6379&gt; sismember set-name value2 # 查看是否在无序列表内\n(integer) 1</code></pre><p>散列值hash：相当于自定义键的数组</p>\n<pre><code>$ 127.0.0.1:6379&gt; HSET hash-name key1 value1 #设置键值对\n(integer) 1\n$ 127.0.0.1:6379&gt; HGET hash-name key1 # 获取指定键的值\n&quot;value1&quot;\n$ 127.0.0.1:6379&gt; HSET hash-name key1 value2 # 更新键的值\n(integer) 0\n$ 127.0.0.1:6379&gt; HGET hash-name key1 \n&quot;value2&quot;\n$ 127.0.0.1:6379&gt; HSET hash-name key2 value2\n(integer) 1\n$ 127.0.0.1:6379&gt; HGETALL hash-name # 查找所有键值对\n1) &quot;key1&quot;\n2) &quot;value2&quot;\n3) &quot;key2&quot;\n4) &quot;value2&quot;\n$ 127.0.0.1:6379&gt; HDEL hash-name key1 # 删除hash键值对\n(integer) 1</code></pre><p>有序集合zset：成员+分值，分值必须是浮点数，通过浮点数进行排序</p>\n<pre><code>$ 127.0.0.1:6379&gt; zadd zset-name 100 member1 # 添加键值对\n(integer) 1\n$ 127.0.0.1:6379&gt; zadd zset-name 202 member2\n(integer) 1\n$ 127.0.0.1:6379&gt; zadd zset-name 803 member3\n(integer) 1\n$ 127.0.0.1:6379&gt; ZRANGE zset-name 0 -1 # 获取多个元素\n1) &quot;member1&quot;\n2) &quot;member2&quot;\n3) &quot;member3&quot;\n$ 127.0.0.1:6379&gt; ZRANGE zset-name 0 -1 withscores # 获取多个元素\n1) &quot;member1&quot;\n2) &quot;100&quot;\n3) &quot;member2&quot;\n4) &quot;202&quot;\n5) &quot;member3&quot;\n6) &quot;803&quot;\n$ 127.0.0.1:6379&gt; ZRANGEBYSCORE zset-name 0 300 withscores # 按score获取多个元素\n1) &quot;member1&quot;\n2) &quot;100&quot;\n3) &quot;member2&quot;\n4) &quot;202&quot;\n$ 127.0.0.1:6379&gt; ZREM zset-name member1 # 移除一个元素\n(integer) 1</code></pre>","site":{"data":{}},"excerpt":"","more":"<p>REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。 Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。 它通常被称为数据结构服务器，因为值（value）可以是 字符串(String), 哈希(Map), 列表(list), 集合(sets) 和 有序集合(sorted sets)等类型。</p>\n<h3 id=\"redis安装\"><a href=\"#redis安装\" class=\"headerlink\" title=\"redis安装\"></a>redis安装</h3><pre><code>$sudo apt-get update\n$sudo apt-get install redis-server\n$redis-cli</code></pre><h3 id=\"redis配置\"><a href=\"#redis配置\" class=\"headerlink\" title=\"redis配置\"></a>redis配置</h3><pre><code>sudo vim /etc/redis.conf\n# 设置为守护进程\nprotected-mode yes\n# 设置密码\nrequirepass redispassword\n# port\nport 6379\n# bind 127.0.0.1\nbing 0.0.0.0 # 允许远程访问</code></pre><h3 id=\"客户端远程登录\"><a href=\"#客户端远程登录\" class=\"headerlink\" title=\"客户端远程登录\"></a>客户端远程登录</h3><pre><code>redis-cli -h 127.0.0.1 -p 6379 -a redispassword</code></pre><h3 id=\"redis客户端\"><a href=\"#redis客户端\" class=\"headerlink\" title=\"redis客户端\"></a>redis客户端</h3><pre><code># redis-commander，基于nodejs\n$ npm install -g redis-commander\n$ redis-commander</code></pre><h3 id=\"通用命令\"><a href=\"#通用命令\" class=\"headerlink\" title=\"通用命令\"></a>通用命令</h3><pre><code>$ 127.0.0.1:6379&gt; del name # 删除数据\n$ 127.0.0.1:6379&gt; type name # 查看数据类型\n$ 127.0.0.1:6379&gt; rename name # 重命名</code></pre><h3 id=\"数据结构\"><a href=\"#数据结构\" class=\"headerlink\" title=\"数据结构\"></a>数据结构</h3><p>字符串string</p>\n<pre><code>$ 127.0.0.1:6379&gt;  set string-name value\n$ 127.0.0.1:6379&gt; get string-name\n$ 127.0.0.1:6379&gt;  del string-name</code></pre><p>列表list： 相当于默认键的数组</p>\n<pre><code>$ 127.0.0.1:6379&gt; lpush list-name value1 value2 value3 ... # 左侧插入列表值\n(integer) 3\n$ 127.0.0.1:6379&gt; rpush list-name value4 value5 value6... # 右侧插入列表值\n(integer) 6\n$ 127.0.0.1:6379&gt;  lindex list-name 1 # 获取第1个的值\n&quot;value2&quot;\n$ 127.0.0.1:6379&gt;  lrange list-name 1 2 # 获取从第1位置到2位置的列表值\n1) &quot;value2&quot;\n2) &quot;value1&quot;\n$ 127.0.0.1:6379&gt;  lpop list-name # 弹出最左边值\n&quot;value3&quot;\n$ 127.0.0.1:6379&gt; rpop list-name # 弹出最右边值\n&quot;value6&quot;</code></pre><p>集合set：无序，不重复的列表</p>\n<pre><code>$ 127.0.0.1:6379&gt;  sadd set-name value1 value2 value3 # 设置无序列表值\n(integer) 3\n$ 127.0.0.1:6379&gt; smembers set-name  # 查看所有值\n1) &quot;value3&quot;\n2) &quot;value2&quot;\n3) &quot;value1&quot;\n$ 127.0.0.1:6379&gt; srem set-name value1 # 删除值\n(integer) 1\n$ 127.0.0.1:6379&gt; sismember set-name value2 # 查看是否在无序列表内\n(integer) 1</code></pre><p>散列值hash：相当于自定义键的数组</p>\n<pre><code>$ 127.0.0.1:6379&gt; HSET hash-name key1 value1 #设置键值对\n(integer) 1\n$ 127.0.0.1:6379&gt; HGET hash-name key1 # 获取指定键的值\n&quot;value1&quot;\n$ 127.0.0.1:6379&gt; HSET hash-name key1 value2 # 更新键的值\n(integer) 0\n$ 127.0.0.1:6379&gt; HGET hash-name key1 \n&quot;value2&quot;\n$ 127.0.0.1:6379&gt; HSET hash-name key2 value2\n(integer) 1\n$ 127.0.0.1:6379&gt; HGETALL hash-name # 查找所有键值对\n1) &quot;key1&quot;\n2) &quot;value2&quot;\n3) &quot;key2&quot;\n4) &quot;value2&quot;\n$ 127.0.0.1:6379&gt; HDEL hash-name key1 # 删除hash键值对\n(integer) 1</code></pre><p>有序集合zset：成员+分值，分值必须是浮点数，通过浮点数进行排序</p>\n<pre><code>$ 127.0.0.1:6379&gt; zadd zset-name 100 member1 # 添加键值对\n(integer) 1\n$ 127.0.0.1:6379&gt; zadd zset-name 202 member2\n(integer) 1\n$ 127.0.0.1:6379&gt; zadd zset-name 803 member3\n(integer) 1\n$ 127.0.0.1:6379&gt; ZRANGE zset-name 0 -1 # 获取多个元素\n1) &quot;member1&quot;\n2) &quot;member2&quot;\n3) &quot;member3&quot;\n$ 127.0.0.1:6379&gt; ZRANGE zset-name 0 -1 withscores # 获取多个元素\n1) &quot;member1&quot;\n2) &quot;100&quot;\n3) &quot;member2&quot;\n4) &quot;202&quot;\n5) &quot;member3&quot;\n6) &quot;803&quot;\n$ 127.0.0.1:6379&gt; ZRANGEBYSCORE zset-name 0 300 withscores # 按score获取多个元素\n1) &quot;member1&quot;\n2) &quot;100&quot;\n3) &quot;member2&quot;\n4) &quot;202&quot;\n$ 127.0.0.1:6379&gt; ZREM zset-name member1 # 移除一个元素\n(integer) 1</code></pre>"},{"title":"centos7配置keepalived实现高可用集群","url":"161.html","id":"161","comments":0,"date":"2017-04-19T06:30:29.000Z","_content":"\n### CENTOS6.8 192.168.0.106 MASTER\n\n    # 安装\n    sudo yum install keepalived\n    # 配置\n    sudo vim /etc/keepalived/keepalived.conf\n    \n    ! Configuration File for keepalived\n    \n    global_defs {\n        # 这些信息是配置报警发邮件信息\n       notification_email {\n         acassen@firewall.loc\n         failover@firewall.loc\n         sysadmin@firewall.loc\n       }\n       notification_email_from Alexandre.Cassen@firewall.loc\n       smtp_server 192.168.200.1\n       smtp_connect_timeout 30\n         # 路由标识，同一局域网应该唯一\n       router_id lb01\n    }\n    vrrp_instance VI_1 {\n        # 当前角色是master\n        state MASTER\n            # 对外提供网络的接口\n        interface eth0\n            # 虚拟路由id标识，数字，必须和backup里相同实例一致\n        virtual_router_id 55\n            # 优先级，数字必须比backup大\n        priority 150\n        advert_int 1\n            # 权限认证，和backup一致\n        authentication {\n            auth_type PASS\n            auth_pass 1111\n        }\n        virtual_ipaddress {\n           192.168.0.200\n        }\n    }\n    \n    # 重启\n    sudo /etc/init.d/keepalived restart\n    # 查看结果\n    ip addr | grep 192.168.0.200\n    \n\n### CENTOS7.2 192.168.0.209 BACKUP\n\n    # 安装\n    sudo yum install keepalived\n    # 配置\n    sudo vim /etc/keepalived/keepalived.conf\n    \n    ! Configuration File for keepalived\n    \n    global_defs {\n       notification_email {\n         acassen@firewall.loc\n         failover@firewall.loc\n         sysadmin@firewall.loc\n       }\n       notification_email_from Alexandre.Cassen@firewall.loc\n       smtp_server 192.168.200.1\n       smtp_connect_timeout 30\n       router_id lb02  # 和master不一致\n    }\n    \n    vrrp_instance VI_1 {\n        state BACKUP      # 和MASTER不一致\n        interface enp0s3\n        virtual_router_id 55\n        priority 100      # 和master不一致\n        advert_int 1\n        authentication {\n            auth_type PASS\n            auth_pass 1111\n        }\n        virtual_ipaddress {\n            192.168.0.200\n        }\n    }\n    # 重启\n    sudo systemctl restart keepalived\n    # 查看结果\n    ip addr | grep 192.168.0.200\n    \n\n### CENTOS6.8 192.168.0.106 nginx配置\n\n    # nginx配置文件\n        server {\n            listen       192.168.0.200:80; # 这里需要指定虚拟vip监听\n            server_name  localhost;\n    \n            location / {\n                      # 只访问web站点\n               proxy_pass http://www_server_pools;\n            }\n            error_page   500 502 503 504  /50x.html;\n            location = /50x.html {\n                root   html;\n            }\n        }\n    \n\n### CENTOS7.2 192.168.0.209 配置nginx\n\n    # nginx配置文件\n       server {\n            listen       192.168.0.200:80;\n            server_name  localhost;\n    \n            location / {\n                         # 只访问phone站点\n               proxy_pass http://www_phone_pools;\n            }\n            error_page   500 502 503 504  /50x.html;\n            location = /50x.html {\n                root   html;\n            }\n        }\n    \n    \n\n### 测试结果\n\n    # 开启192.168.0.106，192.168.0.209的keepalive服务\n    \n    # 查看192.168.0.106\n    $ ip addr | grep 192.168.0.200\n    inet 192.168.0.200/32 scope global eth0 # 应该有这行结果\n    \n    # 查看192.168.0.209\n    $ ip addr | grep 192.168.0.200 # 结果应该为空，如果有结果，表示脑裂，检查相关配置和防火墙\n    \n    # 访问http://192.168.200 \n    curl 192.168.0.200 # 结果应该只访问web网站\n    \n    \n    # 关停192.168.0.106的keepalive服务\n    \n    # 访问http://192.168.200 \n    curl 192.168.0.200 # 结果应该只访问phone网站\n    \n    # 查看192.168.0.106\n    $ ip addr | grep 192.168.0.200\n    inet 192.168.0.200/32 scope global eth0 # 结果应该为空\n    \n    # 查看192.168.0.209\n    $ ip addr | grep 192.168.0.200 \n    inet 192.168.0.200/32 scope global enp0s3 # 此时有这行结果\n    \n    # 重启192.168.0.106的keepalive服务，应该恢复之前的测试结果","source":"_posts/centos7配置keepalived实现高可用集群.md","raw":"---\ntitle: centos7配置keepalived实现高可用集群\nurl: 161.html\nid: 161\ncomments: false\ncategories:\n  - 运维\ndate: 2017-04-19 14:30:29\ntags:\n---\n\n### CENTOS6.8 192.168.0.106 MASTER\n\n    # 安装\n    sudo yum install keepalived\n    # 配置\n    sudo vim /etc/keepalived/keepalived.conf\n    \n    ! Configuration File for keepalived\n    \n    global_defs {\n        # 这些信息是配置报警发邮件信息\n       notification_email {\n         acassen@firewall.loc\n         failover@firewall.loc\n         sysadmin@firewall.loc\n       }\n       notification_email_from Alexandre.Cassen@firewall.loc\n       smtp_server 192.168.200.1\n       smtp_connect_timeout 30\n         # 路由标识，同一局域网应该唯一\n       router_id lb01\n    }\n    vrrp_instance VI_1 {\n        # 当前角色是master\n        state MASTER\n            # 对外提供网络的接口\n        interface eth0\n            # 虚拟路由id标识，数字，必须和backup里相同实例一致\n        virtual_router_id 55\n            # 优先级，数字必须比backup大\n        priority 150\n        advert_int 1\n            # 权限认证，和backup一致\n        authentication {\n            auth_type PASS\n            auth_pass 1111\n        }\n        virtual_ipaddress {\n           192.168.0.200\n        }\n    }\n    \n    # 重启\n    sudo /etc/init.d/keepalived restart\n    # 查看结果\n    ip addr | grep 192.168.0.200\n    \n\n### CENTOS7.2 192.168.0.209 BACKUP\n\n    # 安装\n    sudo yum install keepalived\n    # 配置\n    sudo vim /etc/keepalived/keepalived.conf\n    \n    ! Configuration File for keepalived\n    \n    global_defs {\n       notification_email {\n         acassen@firewall.loc\n         failover@firewall.loc\n         sysadmin@firewall.loc\n       }\n       notification_email_from Alexandre.Cassen@firewall.loc\n       smtp_server 192.168.200.1\n       smtp_connect_timeout 30\n       router_id lb02  # 和master不一致\n    }\n    \n    vrrp_instance VI_1 {\n        state BACKUP      # 和MASTER不一致\n        interface enp0s3\n        virtual_router_id 55\n        priority 100      # 和master不一致\n        advert_int 1\n        authentication {\n            auth_type PASS\n            auth_pass 1111\n        }\n        virtual_ipaddress {\n            192.168.0.200\n        }\n    }\n    # 重启\n    sudo systemctl restart keepalived\n    # 查看结果\n    ip addr | grep 192.168.0.200\n    \n\n### CENTOS6.8 192.168.0.106 nginx配置\n\n    # nginx配置文件\n        server {\n            listen       192.168.0.200:80; # 这里需要指定虚拟vip监听\n            server_name  localhost;\n    \n            location / {\n                      # 只访问web站点\n               proxy_pass http://www_server_pools;\n            }\n            error_page   500 502 503 504  /50x.html;\n            location = /50x.html {\n                root   html;\n            }\n        }\n    \n\n### CENTOS7.2 192.168.0.209 配置nginx\n\n    # nginx配置文件\n       server {\n            listen       192.168.0.200:80;\n            server_name  localhost;\n    \n            location / {\n                         # 只访问phone站点\n               proxy_pass http://www_phone_pools;\n            }\n            error_page   500 502 503 504  /50x.html;\n            location = /50x.html {\n                root   html;\n            }\n        }\n    \n    \n\n### 测试结果\n\n    # 开启192.168.0.106，192.168.0.209的keepalive服务\n    \n    # 查看192.168.0.106\n    $ ip addr | grep 192.168.0.200\n    inet 192.168.0.200/32 scope global eth0 # 应该有这行结果\n    \n    # 查看192.168.0.209\n    $ ip addr | grep 192.168.0.200 # 结果应该为空，如果有结果，表示脑裂，检查相关配置和防火墙\n    \n    # 访问http://192.168.200 \n    curl 192.168.0.200 # 结果应该只访问web网站\n    \n    \n    # 关停192.168.0.106的keepalive服务\n    \n    # 访问http://192.168.200 \n    curl 192.168.0.200 # 结果应该只访问phone网站\n    \n    # 查看192.168.0.106\n    $ ip addr | grep 192.168.0.200\n    inet 192.168.0.200/32 scope global eth0 # 结果应该为空\n    \n    # 查看192.168.0.209\n    $ ip addr | grep 192.168.0.200 \n    inet 192.168.0.200/32 scope global enp0s3 # 此时有这行结果\n    \n    # 重启192.168.0.106的keepalive服务，应该恢复之前的测试结果","slug":"centos7配置keepalived实现高可用集群","published":1,"updated":"2019-07-23T05:51:43.847Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5ob002b9ka4jt4mvchv","content":"<h3 id=\"CENTOS6-8-192-168-0-106-MASTER\"><a href=\"#CENTOS6-8-192-168-0-106-MASTER\" class=\"headerlink\" title=\"CENTOS6.8 192.168.0.106 MASTER\"></a>CENTOS6.8 192.168.0.106 MASTER</h3><pre><code># 安装\nsudo yum install keepalived\n# 配置\nsudo vim /etc/keepalived/keepalived.conf\n\n! Configuration File for keepalived\n\nglobal_defs {\n    # 这些信息是配置报警发邮件信息\n   notification_email {\n     acassen@firewall.loc\n     failover@firewall.loc\n     sysadmin@firewall.loc\n   }\n   notification_email_from Alexandre.Cassen@firewall.loc\n   smtp_server 192.168.200.1\n   smtp_connect_timeout 30\n     # 路由标识，同一局域网应该唯一\n   router_id lb01\n}\nvrrp_instance VI_1 {\n    # 当前角色是master\n    state MASTER\n        # 对外提供网络的接口\n    interface eth0\n        # 虚拟路由id标识，数字，必须和backup里相同实例一致\n    virtual_router_id 55\n        # 优先级，数字必须比backup大\n    priority 150\n    advert_int 1\n        # 权限认证，和backup一致\n    authentication {\n        auth_type PASS\n        auth_pass 1111\n    }\n    virtual_ipaddress {\n       192.168.0.200\n    }\n}\n\n# 重启\nsudo /etc/init.d/keepalived restart\n# 查看结果\nip addr | grep 192.168.0.200</code></pre><h3 id=\"CENTOS7-2-192-168-0-209-BACKUP\"><a href=\"#CENTOS7-2-192-168-0-209-BACKUP\" class=\"headerlink\" title=\"CENTOS7.2 192.168.0.209 BACKUP\"></a>CENTOS7.2 192.168.0.209 BACKUP</h3><pre><code># 安装\nsudo yum install keepalived\n# 配置\nsudo vim /etc/keepalived/keepalived.conf\n\n! Configuration File for keepalived\n\nglobal_defs {\n   notification_email {\n     acassen@firewall.loc\n     failover@firewall.loc\n     sysadmin@firewall.loc\n   }\n   notification_email_from Alexandre.Cassen@firewall.loc\n   smtp_server 192.168.200.1\n   smtp_connect_timeout 30\n   router_id lb02  # 和master不一致\n}\n\nvrrp_instance VI_1 {\n    state BACKUP      # 和MASTER不一致\n    interface enp0s3\n    virtual_router_id 55\n    priority 100      # 和master不一致\n    advert_int 1\n    authentication {\n        auth_type PASS\n        auth_pass 1111\n    }\n    virtual_ipaddress {\n        192.168.0.200\n    }\n}\n# 重启\nsudo systemctl restart keepalived\n# 查看结果\nip addr | grep 192.168.0.200</code></pre><h3 id=\"CENTOS6-8-192-168-0-106-nginx配置\"><a href=\"#CENTOS6-8-192-168-0-106-nginx配置\" class=\"headerlink\" title=\"CENTOS6.8 192.168.0.106 nginx配置\"></a>CENTOS6.8 192.168.0.106 nginx配置</h3><pre><code># nginx配置文件\n    server {\n        listen       192.168.0.200:80; # 这里需要指定虚拟vip监听\n        server_name  localhost;\n\n        location / {\n                  # 只访问web站点\n           proxy_pass http://www_server_pools;\n        }\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n    }</code></pre><h3 id=\"CENTOS7-2-192-168-0-209-配置nginx\"><a href=\"#CENTOS7-2-192-168-0-209-配置nginx\" class=\"headerlink\" title=\"CENTOS7.2 192.168.0.209 配置nginx\"></a>CENTOS7.2 192.168.0.209 配置nginx</h3><pre><code># nginx配置文件\n   server {\n        listen       192.168.0.200:80;\n        server_name  localhost;\n\n        location / {\n                     # 只访问phone站点\n           proxy_pass http://www_phone_pools;\n        }\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n    }</code></pre><h3 id=\"测试结果\"><a href=\"#测试结果\" class=\"headerlink\" title=\"测试结果\"></a>测试结果</h3><pre><code># 开启192.168.0.106，192.168.0.209的keepalive服务\n\n# 查看192.168.0.106\n$ ip addr | grep 192.168.0.200\ninet 192.168.0.200/32 scope global eth0 # 应该有这行结果\n\n# 查看192.168.0.209\n$ ip addr | grep 192.168.0.200 # 结果应该为空，如果有结果，表示脑裂，检查相关配置和防火墙\n\n# 访问http://192.168.200 \ncurl 192.168.0.200 # 结果应该只访问web网站\n\n\n# 关停192.168.0.106的keepalive服务\n\n# 访问http://192.168.200 \ncurl 192.168.0.200 # 结果应该只访问phone网站\n\n# 查看192.168.0.106\n$ ip addr | grep 192.168.0.200\ninet 192.168.0.200/32 scope global eth0 # 结果应该为空\n\n# 查看192.168.0.209\n$ ip addr | grep 192.168.0.200 \ninet 192.168.0.200/32 scope global enp0s3 # 此时有这行结果\n\n# 重启192.168.0.106的keepalive服务，应该恢复之前的测试结果</code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"CENTOS6-8-192-168-0-106-MASTER\"><a href=\"#CENTOS6-8-192-168-0-106-MASTER\" class=\"headerlink\" title=\"CENTOS6.8 192.168.0.106 MASTER\"></a>CENTOS6.8 192.168.0.106 MASTER</h3><pre><code># 安装\nsudo yum install keepalived\n# 配置\nsudo vim /etc/keepalived/keepalived.conf\n\n! Configuration File for keepalived\n\nglobal_defs {\n    # 这些信息是配置报警发邮件信息\n   notification_email {\n     acassen@firewall.loc\n     failover@firewall.loc\n     sysadmin@firewall.loc\n   }\n   notification_email_from Alexandre.Cassen@firewall.loc\n   smtp_server 192.168.200.1\n   smtp_connect_timeout 30\n     # 路由标识，同一局域网应该唯一\n   router_id lb01\n}\nvrrp_instance VI_1 {\n    # 当前角色是master\n    state MASTER\n        # 对外提供网络的接口\n    interface eth0\n        # 虚拟路由id标识，数字，必须和backup里相同实例一致\n    virtual_router_id 55\n        # 优先级，数字必须比backup大\n    priority 150\n    advert_int 1\n        # 权限认证，和backup一致\n    authentication {\n        auth_type PASS\n        auth_pass 1111\n    }\n    virtual_ipaddress {\n       192.168.0.200\n    }\n}\n\n# 重启\nsudo /etc/init.d/keepalived restart\n# 查看结果\nip addr | grep 192.168.0.200</code></pre><h3 id=\"CENTOS7-2-192-168-0-209-BACKUP\"><a href=\"#CENTOS7-2-192-168-0-209-BACKUP\" class=\"headerlink\" title=\"CENTOS7.2 192.168.0.209 BACKUP\"></a>CENTOS7.2 192.168.0.209 BACKUP</h3><pre><code># 安装\nsudo yum install keepalived\n# 配置\nsudo vim /etc/keepalived/keepalived.conf\n\n! Configuration File for keepalived\n\nglobal_defs {\n   notification_email {\n     acassen@firewall.loc\n     failover@firewall.loc\n     sysadmin@firewall.loc\n   }\n   notification_email_from Alexandre.Cassen@firewall.loc\n   smtp_server 192.168.200.1\n   smtp_connect_timeout 30\n   router_id lb02  # 和master不一致\n}\n\nvrrp_instance VI_1 {\n    state BACKUP      # 和MASTER不一致\n    interface enp0s3\n    virtual_router_id 55\n    priority 100      # 和master不一致\n    advert_int 1\n    authentication {\n        auth_type PASS\n        auth_pass 1111\n    }\n    virtual_ipaddress {\n        192.168.0.200\n    }\n}\n# 重启\nsudo systemctl restart keepalived\n# 查看结果\nip addr | grep 192.168.0.200</code></pre><h3 id=\"CENTOS6-8-192-168-0-106-nginx配置\"><a href=\"#CENTOS6-8-192-168-0-106-nginx配置\" class=\"headerlink\" title=\"CENTOS6.8 192.168.0.106 nginx配置\"></a>CENTOS6.8 192.168.0.106 nginx配置</h3><pre><code># nginx配置文件\n    server {\n        listen       192.168.0.200:80; # 这里需要指定虚拟vip监听\n        server_name  localhost;\n\n        location / {\n                  # 只访问web站点\n           proxy_pass http://www_server_pools;\n        }\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n    }</code></pre><h3 id=\"CENTOS7-2-192-168-0-209-配置nginx\"><a href=\"#CENTOS7-2-192-168-0-209-配置nginx\" class=\"headerlink\" title=\"CENTOS7.2 192.168.0.209 配置nginx\"></a>CENTOS7.2 192.168.0.209 配置nginx</h3><pre><code># nginx配置文件\n   server {\n        listen       192.168.0.200:80;\n        server_name  localhost;\n\n        location / {\n                     # 只访问phone站点\n           proxy_pass http://www_phone_pools;\n        }\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n    }</code></pre><h3 id=\"测试结果\"><a href=\"#测试结果\" class=\"headerlink\" title=\"测试结果\"></a>测试结果</h3><pre><code># 开启192.168.0.106，192.168.0.209的keepalive服务\n\n# 查看192.168.0.106\n$ ip addr | grep 192.168.0.200\ninet 192.168.0.200/32 scope global eth0 # 应该有这行结果\n\n# 查看192.168.0.209\n$ ip addr | grep 192.168.0.200 # 结果应该为空，如果有结果，表示脑裂，检查相关配置和防火墙\n\n# 访问http://192.168.200 \ncurl 192.168.0.200 # 结果应该只访问web网站\n\n\n# 关停192.168.0.106的keepalive服务\n\n# 访问http://192.168.200 \ncurl 192.168.0.200 # 结果应该只访问phone网站\n\n# 查看192.168.0.106\n$ ip addr | grep 192.168.0.200\ninet 192.168.0.200/32 scope global eth0 # 结果应该为空\n\n# 查看192.168.0.209\n$ ip addr | grep 192.168.0.200 \ninet 192.168.0.200/32 scope global enp0s3 # 此时有这行结果\n\n# 重启192.168.0.106的keepalive服务，应该恢复之前的测试结果</code></pre>"},{"title":"python爬虫scrapy框架入门基础","url":"475.html","id":"475","comments":0,"date":"2018-01-10T07:44:12.000Z","_content":"\nScrapy是一个为了爬取网站数据，提取结构性数据而编写的应用框架。 可以应用在包括数据挖掘，信息处理或存储历史数据等一系列的程序中。 其最初是为了页面抓取 (更确切来说, 网络抓取 )所设计的， 也可以应用在获取API所返回的数据(例如 Amazon Associates Web Services ) 或者通用的网络爬虫。Scrapy用途广泛，可以用于数据挖掘、监测和自动化测试\n\n### Scrapy主要包括了以下组件：\n\n1.  引擎(Scrapy): 用来处理整个系统的数据流处理, 触发事务(框架核心)\n2.  调度器(Scheduler): 用来接受引擎发过来的请求, 压入队列中, 并在引擎再次请求的时候返回. 可以想像成一个URL（抓取网页的网址或者说是链接）的优先队列, 由它来决定下一个要抓取的网址是什么, 同时去除重复的网址\n3.  下载器(Downloader): 用于下载网页内容, 并将网页内容返回给蜘蛛(Scrapy下载器是建立在twisted这个高效的异步模型上的)\n4.  爬虫(Spiders): 爬虫是主要干活的, 用于从特定的网页中提取自己需要的信息, 即所谓的实体(Item)。用户也可以从中提取出链接,让Scrapy继续抓取下一个页面\n5.  项目管道(Pipeline): 负责处理爬虫从网页中抽取的实体，主要的功能是持久化实体、验证实体的有效性、清除不需要的信息。当页面被爬虫解析后，将被发送到项目管道，并经过几个特定的次序处理数据。\n6.  下载器中间件(Downloader Middlewares): 位于Scrapy引擎和下载器之间的框架，主要是处理Scrapy引擎与下载器之间的请求及响应。\n7.  爬虫中间件(Spider Middlewares): 介于Scrapy引擎和爬虫之间的框架，主要工作是处理蜘蛛的响应输入和请求输出。\n8.  调度中间件(Scheduler Middewares): 介于Scrapy引擎和调度之间的中间件，从Scrapy引擎发送到调度的请求和响应。\n\n### Scrapy运行流程大概如下：\n\n首先，引擎从调度器中取出一个链接(URL)用于接下来的抓取 引擎把URL封装成一个请求(Request)传给下载器，下载器把资源下载下来，并封装成应答包(Response) 然后，爬虫解析Response 若是解析出实体（Item）,则交给实体管道进行进一步的处理。 若是解析出的是链接（URL）,则把URL交给Scheduler等待抓取\n\n### 备忘\n\n#### 使用Selector提取数据\n\n#### xpath语法和基本函数\n\n    /\n    .\n    ..\n    ELEMENT\n    //ELEMENT\n    *\n    text\n    @ALTER\n    @*\n    position()\n    last()\n    string()\n    \n\n#### css选择器\n\n    *\n    E\n    E1>E2\n    E1+E2\n    .CLASS\n    #ID\n    [ATTR]\n    [ATTR=VALUE]\n    E:nth-child(n)\n    E:first-child\n    \n\n#### 使用Item和Field封装数据\n\nField(serializer=lambda)设置存储数据\n\n#### 使用Item Pipeline处理数据\n\n修改数据,过滤重复数据,将数据写入到数据库等\n\n#### LinkExtractor提取链接\n\n    LinkExtractor参数\n    allow 允许链接\n    deny 拒绝链接\n    allow_domains 允许域名\n    deny_domains 拒绝域名\n    restrict_xpaths 允许xpath链接\n    restrict_css 允许css选择器链接\n    \n\n#### Exporter导出数据\n\n默认包含以下\n\n    JSON, JSON LINES, CSV, XML, PICKLE, MARSHAL\n    \n\n可配置导出格式和存放文件地址, 可自定义导出格式,例如xls\n\n#### 下载文件和图片\n\nFIlesPipeline\n\n    setting.py\n    ITEM_PIPELINES = {'scrapy.pipelines.files.FilesPipeline': 1}\n    FILES_STORE = '/home/hanchang/download'\n    \n\nImagesPipeline\n\n#### 模拟登录\n\n使用FromRequest ORC识别验证码:pillow, pytesseract 付费网络平台识别 人工识别:爬取登录页面的验证码图片,调用Image.show方法,肉眼识别并输入到内置的input函数中 Cookie登录: 获取浏览器的cookie值(browsercookie包), 利用BrowserCookiesMiddleware将获取的cookie值添加到CookieJar中\n\n#### 动态页面抓取\n\nSplash是Scrapy官方推荐的javascript渲染引擎, Webkit无界面浏览器\n\n    # 安装\n    sudo apt-get install docker\n    sudo docker pull scrapinghub/splash\n    sudo docker run -p 8050:8050 -p 8051:8051 scrapinghub/splash\n    \n\nsplash常见服务端点 http://localhost:8050/render.html GET/POST 返回html 参数: url, timeout, proxy, wait, images, js_source http://localhost:8050/excute 传递模拟的动作给splash,例如等待页面渲染，执行代码，等等\n\n##### scrapy使用splash\n\n    安装\n    pip install scrapy-splash\n    \n\n    setting.py\n    # splash服务器地址\n    SPLASH_URL = 'http://localhost:8050'\n    # 开启splash的两个下载中间件并调整HttpCompressionMiddleware的次序\n    DOWNLOADER_MIDDLEWARES = {\n        'scrapy_splash.SplashCookiesMiddleware': 723,\n            'scrapy_splash.SplashMiddleware': 725,\n            'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware': 810,\n    }\n    # 过滤去重函数\n    DUPEFILTER_CLASS = 'scrapy_splash.SplashAwareDupeFilter',\n    # 用户支持cahce_args\n    SPIDER_MIDDLEWARES = {\n      'scrapy_splash.SplashDeduplicateArgsMiddleware': 100,\n    }\n    \n\n#### 分布式爬取\n\n使用scrapy-redis\n\n    # 安装\n    pip install scrapy\n    pip install scrapy-redis\n    \n\n    # 在配置文件setting.py中添加scrapy-redis相关信息\n    # redis服务器\n    REDIS_URL = 'redis://127.0.0.1:6379'\n    # 使用scrapy_redis调度器替代原生调度器\n    SCHEDULER = 'scrapy_redis.scheduler.Scheduler'\n    # 使用scrapy_redis的RFPDupeFilter作为去重过滤器\n    DUPEFILTER_CLASS = 'scrapy_redis.dupefilter.RFPDupeFilter'\n    # 将爬取的数据存储到redis中\n    ITEM_PIPELINES = {\n        'scrapy_redis.pipelines.RedisPipeline': 300,\n    }\n    # 爬虫停止后,保留/清除Reids中的请求队列以及去重集合\n    SCHEDULER_PERSIST = False\n    \n\n    # 修改爬虫spider.py\n    from scrapy_redis.spiders import RedisSpider\n    \n    class BookSpider(RedisSpider):\n    \n        # 注释start_urls\n        # start_urls = []\n    \n\n    # 手动添加start_urls\n    redis-cli -h 127.0.0.1\n    lpush books:start_urls 'http://www.books.com/'","source":"_posts/python爬虫scrapy框架入门基础.md","raw":"---\ntitle: python爬虫scrapy框架入门基础\nurl: 475.html\nid: 475\ncomments: false\ncategories:\n  - 后端\n  - 运维\ndate: 2018-01-10 15:44:12\ntags:\n---\n\nScrapy是一个为了爬取网站数据，提取结构性数据而编写的应用框架。 可以应用在包括数据挖掘，信息处理或存储历史数据等一系列的程序中。 其最初是为了页面抓取 (更确切来说, 网络抓取 )所设计的， 也可以应用在获取API所返回的数据(例如 Amazon Associates Web Services ) 或者通用的网络爬虫。Scrapy用途广泛，可以用于数据挖掘、监测和自动化测试\n\n### Scrapy主要包括了以下组件：\n\n1.  引擎(Scrapy): 用来处理整个系统的数据流处理, 触发事务(框架核心)\n2.  调度器(Scheduler): 用来接受引擎发过来的请求, 压入队列中, 并在引擎再次请求的时候返回. 可以想像成一个URL（抓取网页的网址或者说是链接）的优先队列, 由它来决定下一个要抓取的网址是什么, 同时去除重复的网址\n3.  下载器(Downloader): 用于下载网页内容, 并将网页内容返回给蜘蛛(Scrapy下载器是建立在twisted这个高效的异步模型上的)\n4.  爬虫(Spiders): 爬虫是主要干活的, 用于从特定的网页中提取自己需要的信息, 即所谓的实体(Item)。用户也可以从中提取出链接,让Scrapy继续抓取下一个页面\n5.  项目管道(Pipeline): 负责处理爬虫从网页中抽取的实体，主要的功能是持久化实体、验证实体的有效性、清除不需要的信息。当页面被爬虫解析后，将被发送到项目管道，并经过几个特定的次序处理数据。\n6.  下载器中间件(Downloader Middlewares): 位于Scrapy引擎和下载器之间的框架，主要是处理Scrapy引擎与下载器之间的请求及响应。\n7.  爬虫中间件(Spider Middlewares): 介于Scrapy引擎和爬虫之间的框架，主要工作是处理蜘蛛的响应输入和请求输出。\n8.  调度中间件(Scheduler Middewares): 介于Scrapy引擎和调度之间的中间件，从Scrapy引擎发送到调度的请求和响应。\n\n### Scrapy运行流程大概如下：\n\n首先，引擎从调度器中取出一个链接(URL)用于接下来的抓取 引擎把URL封装成一个请求(Request)传给下载器，下载器把资源下载下来，并封装成应答包(Response) 然后，爬虫解析Response 若是解析出实体（Item）,则交给实体管道进行进一步的处理。 若是解析出的是链接（URL）,则把URL交给Scheduler等待抓取\n\n### 备忘\n\n#### 使用Selector提取数据\n\n#### xpath语法和基本函数\n\n    /\n    .\n    ..\n    ELEMENT\n    //ELEMENT\n    *\n    text\n    @ALTER\n    @*\n    position()\n    last()\n    string()\n    \n\n#### css选择器\n\n    *\n    E\n    E1>E2\n    E1+E2\n    .CLASS\n    #ID\n    [ATTR]\n    [ATTR=VALUE]\n    E:nth-child(n)\n    E:first-child\n    \n\n#### 使用Item和Field封装数据\n\nField(serializer=lambda)设置存储数据\n\n#### 使用Item Pipeline处理数据\n\n修改数据,过滤重复数据,将数据写入到数据库等\n\n#### LinkExtractor提取链接\n\n    LinkExtractor参数\n    allow 允许链接\n    deny 拒绝链接\n    allow_domains 允许域名\n    deny_domains 拒绝域名\n    restrict_xpaths 允许xpath链接\n    restrict_css 允许css选择器链接\n    \n\n#### Exporter导出数据\n\n默认包含以下\n\n    JSON, JSON LINES, CSV, XML, PICKLE, MARSHAL\n    \n\n可配置导出格式和存放文件地址, 可自定义导出格式,例如xls\n\n#### 下载文件和图片\n\nFIlesPipeline\n\n    setting.py\n    ITEM_PIPELINES = {'scrapy.pipelines.files.FilesPipeline': 1}\n    FILES_STORE = '/home/hanchang/download'\n    \n\nImagesPipeline\n\n#### 模拟登录\n\n使用FromRequest ORC识别验证码:pillow, pytesseract 付费网络平台识别 人工识别:爬取登录页面的验证码图片,调用Image.show方法,肉眼识别并输入到内置的input函数中 Cookie登录: 获取浏览器的cookie值(browsercookie包), 利用BrowserCookiesMiddleware将获取的cookie值添加到CookieJar中\n\n#### 动态页面抓取\n\nSplash是Scrapy官方推荐的javascript渲染引擎, Webkit无界面浏览器\n\n    # 安装\n    sudo apt-get install docker\n    sudo docker pull scrapinghub/splash\n    sudo docker run -p 8050:8050 -p 8051:8051 scrapinghub/splash\n    \n\nsplash常见服务端点 http://localhost:8050/render.html GET/POST 返回html 参数: url, timeout, proxy, wait, images, js_source http://localhost:8050/excute 传递模拟的动作给splash,例如等待页面渲染，执行代码，等等\n\n##### scrapy使用splash\n\n    安装\n    pip install scrapy-splash\n    \n\n    setting.py\n    # splash服务器地址\n    SPLASH_URL = 'http://localhost:8050'\n    # 开启splash的两个下载中间件并调整HttpCompressionMiddleware的次序\n    DOWNLOADER_MIDDLEWARES = {\n        'scrapy_splash.SplashCookiesMiddleware': 723,\n            'scrapy_splash.SplashMiddleware': 725,\n            'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware': 810,\n    }\n    # 过滤去重函数\n    DUPEFILTER_CLASS = 'scrapy_splash.SplashAwareDupeFilter',\n    # 用户支持cahce_args\n    SPIDER_MIDDLEWARES = {\n      'scrapy_splash.SplashDeduplicateArgsMiddleware': 100,\n    }\n    \n\n#### 分布式爬取\n\n使用scrapy-redis\n\n    # 安装\n    pip install scrapy\n    pip install scrapy-redis\n    \n\n    # 在配置文件setting.py中添加scrapy-redis相关信息\n    # redis服务器\n    REDIS_URL = 'redis://127.0.0.1:6379'\n    # 使用scrapy_redis调度器替代原生调度器\n    SCHEDULER = 'scrapy_redis.scheduler.Scheduler'\n    # 使用scrapy_redis的RFPDupeFilter作为去重过滤器\n    DUPEFILTER_CLASS = 'scrapy_redis.dupefilter.RFPDupeFilter'\n    # 将爬取的数据存储到redis中\n    ITEM_PIPELINES = {\n        'scrapy_redis.pipelines.RedisPipeline': 300,\n    }\n    # 爬虫停止后,保留/清除Reids中的请求队列以及去重集合\n    SCHEDULER_PERSIST = False\n    \n\n    # 修改爬虫spider.py\n    from scrapy_redis.spiders import RedisSpider\n    \n    class BookSpider(RedisSpider):\n    \n        # 注释start_urls\n        # start_urls = []\n    \n\n    # 手动添加start_urls\n    redis-cli -h 127.0.0.1\n    lpush books:start_urls 'http://www.books.com/'","slug":"python爬虫scrapy框架入门基础","published":1,"updated":"2019-07-24T01:33:09.180Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5oc002d9ka4ub8hgbk9","content":"<p>Scrapy是一个为了爬取网站数据，提取结构性数据而编写的应用框架。 可以应用在包括数据挖掘，信息处理或存储历史数据等一系列的程序中。 其最初是为了页面抓取 (更确切来说, 网络抓取 )所设计的， 也可以应用在获取API所返回的数据(例如 Amazon Associates Web Services ) 或者通用的网络爬虫。Scrapy用途广泛，可以用于数据挖掘、监测和自动化测试</p>\n<h3 id=\"Scrapy主要包括了以下组件：\"><a href=\"#Scrapy主要包括了以下组件：\" class=\"headerlink\" title=\"Scrapy主要包括了以下组件：\"></a>Scrapy主要包括了以下组件：</h3><ol>\n<li>引擎(Scrapy): 用来处理整个系统的数据流处理, 触发事务(框架核心)</li>\n<li>调度器(Scheduler): 用来接受引擎发过来的请求, 压入队列中, 并在引擎再次请求的时候返回. 可以想像成一个URL（抓取网页的网址或者说是链接）的优先队列, 由它来决定下一个要抓取的网址是什么, 同时去除重复的网址</li>\n<li>下载器(Downloader): 用于下载网页内容, 并将网页内容返回给蜘蛛(Scrapy下载器是建立在twisted这个高效的异步模型上的)</li>\n<li>爬虫(Spiders): 爬虫是主要干活的, 用于从特定的网页中提取自己需要的信息, 即所谓的实体(Item)。用户也可以从中提取出链接,让Scrapy继续抓取下一个页面</li>\n<li>项目管道(Pipeline): 负责处理爬虫从网页中抽取的实体，主要的功能是持久化实体、验证实体的有效性、清除不需要的信息。当页面被爬虫解析后，将被发送到项目管道，并经过几个特定的次序处理数据。</li>\n<li>下载器中间件(Downloader Middlewares): 位于Scrapy引擎和下载器之间的框架，主要是处理Scrapy引擎与下载器之间的请求及响应。</li>\n<li>爬虫中间件(Spider Middlewares): 介于Scrapy引擎和爬虫之间的框架，主要工作是处理蜘蛛的响应输入和请求输出。</li>\n<li>调度中间件(Scheduler Middewares): 介于Scrapy引擎和调度之间的中间件，从Scrapy引擎发送到调度的请求和响应。</li>\n</ol>\n<h3 id=\"Scrapy运行流程大概如下：\"><a href=\"#Scrapy运行流程大概如下：\" class=\"headerlink\" title=\"Scrapy运行流程大概如下：\"></a>Scrapy运行流程大概如下：</h3><p>首先，引擎从调度器中取出一个链接(URL)用于接下来的抓取 引擎把URL封装成一个请求(Request)传给下载器，下载器把资源下载下来，并封装成应答包(Response) 然后，爬虫解析Response 若是解析出实体（Item）,则交给实体管道进行进一步的处理。 若是解析出的是链接（URL）,则把URL交给Scheduler等待抓取</p>\n<h3 id=\"备忘\"><a href=\"#备忘\" class=\"headerlink\" title=\"备忘\"></a>备忘</h3><h4 id=\"使用Selector提取数据\"><a href=\"#使用Selector提取数据\" class=\"headerlink\" title=\"使用Selector提取数据\"></a>使用Selector提取数据</h4><h4 id=\"xpath语法和基本函数\"><a href=\"#xpath语法和基本函数\" class=\"headerlink\" title=\"xpath语法和基本函数\"></a>xpath语法和基本函数</h4><pre><code>/\n.\n..\nELEMENT\n//ELEMENT\n*\ntext\n@ALTER\n@*\nposition()\nlast()\nstring()</code></pre><h4 id=\"css选择器\"><a href=\"#css选择器\" class=\"headerlink\" title=\"css选择器\"></a>css选择器</h4><pre><code>*\nE\nE1&gt;E2\nE1+E2\n.CLASS\n#ID\n[ATTR]\n[ATTR=VALUE]\nE:nth-child(n)\nE:first-child</code></pre><h4 id=\"使用Item和Field封装数据\"><a href=\"#使用Item和Field封装数据\" class=\"headerlink\" title=\"使用Item和Field封装数据\"></a>使用Item和Field封装数据</h4><p>Field(serializer=lambda)设置存储数据</p>\n<h4 id=\"使用Item-Pipeline处理数据\"><a href=\"#使用Item-Pipeline处理数据\" class=\"headerlink\" title=\"使用Item Pipeline处理数据\"></a>使用Item Pipeline处理数据</h4><p>修改数据,过滤重复数据,将数据写入到数据库等</p>\n<h4 id=\"LinkExtractor提取链接\"><a href=\"#LinkExtractor提取链接\" class=\"headerlink\" title=\"LinkExtractor提取链接\"></a>LinkExtractor提取链接</h4><pre><code>LinkExtractor参数\nallow 允许链接\ndeny 拒绝链接\nallow_domains 允许域名\ndeny_domains 拒绝域名\nrestrict_xpaths 允许xpath链接\nrestrict_css 允许css选择器链接</code></pre><h4 id=\"Exporter导出数据\"><a href=\"#Exporter导出数据\" class=\"headerlink\" title=\"Exporter导出数据\"></a>Exporter导出数据</h4><p>默认包含以下</p>\n<pre><code>JSON, JSON LINES, CSV, XML, PICKLE, MARSHAL</code></pre><p>可配置导出格式和存放文件地址, 可自定义导出格式,例如xls</p>\n<h4 id=\"下载文件和图片\"><a href=\"#下载文件和图片\" class=\"headerlink\" title=\"下载文件和图片\"></a>下载文件和图片</h4><p>FIlesPipeline</p>\n<pre><code>setting.py\nITEM_PIPELINES = {&apos;scrapy.pipelines.files.FilesPipeline&apos;: 1}\nFILES_STORE = &apos;/home/hanchang/download&apos;</code></pre><p>ImagesPipeline</p>\n<h4 id=\"模拟登录\"><a href=\"#模拟登录\" class=\"headerlink\" title=\"模拟登录\"></a>模拟登录</h4><p>使用FromRequest ORC识别验证码:pillow, pytesseract 付费网络平台识别 人工识别:爬取登录页面的验证码图片,调用Image.show方法,肉眼识别并输入到内置的input函数中 Cookie登录: 获取浏览器的cookie值(browsercookie包), 利用BrowserCookiesMiddleware将获取的cookie值添加到CookieJar中</p>\n<h4 id=\"动态页面抓取\"><a href=\"#动态页面抓取\" class=\"headerlink\" title=\"动态页面抓取\"></a>动态页面抓取</h4><p>Splash是Scrapy官方推荐的javascript渲染引擎, Webkit无界面浏览器</p>\n<pre><code># 安装\nsudo apt-get install docker\nsudo docker pull scrapinghub/splash\nsudo docker run -p 8050:8050 -p 8051:8051 scrapinghub/splash</code></pre><p>splash常见服务端点 <a href=\"http://localhost:8050/render.html\" target=\"_blank\" rel=\"noopener\">http://localhost:8050/render.html</a> GET/POST 返回html 参数: url, timeout, proxy, wait, images, js_source <a href=\"http://localhost:8050/excute\" target=\"_blank\" rel=\"noopener\">http://localhost:8050/excute</a> 传递模拟的动作给splash,例如等待页面渲染，执行代码，等等</p>\n<h5 id=\"scrapy使用splash\"><a href=\"#scrapy使用splash\" class=\"headerlink\" title=\"scrapy使用splash\"></a>scrapy使用splash</h5><pre><code>安装\npip install scrapy-splash\n\n\nsetting.py\n# splash服务器地址\nSPLASH_URL = &apos;http://localhost:8050&apos;\n# 开启splash的两个下载中间件并调整HttpCompressionMiddleware的次序\nDOWNLOADER_MIDDLEWARES = {\n    &apos;scrapy_splash.SplashCookiesMiddleware&apos;: 723,\n        &apos;scrapy_splash.SplashMiddleware&apos;: 725,\n        &apos;scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware&apos;: 810,\n}\n# 过滤去重函数\nDUPEFILTER_CLASS = &apos;scrapy_splash.SplashAwareDupeFilter&apos;,\n# 用户支持cahce_args\nSPIDER_MIDDLEWARES = {\n  &apos;scrapy_splash.SplashDeduplicateArgsMiddleware&apos;: 100,\n}</code></pre><h4 id=\"分布式爬取\"><a href=\"#分布式爬取\" class=\"headerlink\" title=\"分布式爬取\"></a>分布式爬取</h4><p>使用scrapy-redis</p>\n<pre><code># 安装\npip install scrapy\npip install scrapy-redis\n\n\n# 在配置文件setting.py中添加scrapy-redis相关信息\n# redis服务器\nREDIS_URL = &apos;redis://127.0.0.1:6379&apos;\n# 使用scrapy_redis调度器替代原生调度器\nSCHEDULER = &apos;scrapy_redis.scheduler.Scheduler&apos;\n# 使用scrapy_redis的RFPDupeFilter作为去重过滤器\nDUPEFILTER_CLASS = &apos;scrapy_redis.dupefilter.RFPDupeFilter&apos;\n# 将爬取的数据存储到redis中\nITEM_PIPELINES = {\n    &apos;scrapy_redis.pipelines.RedisPipeline&apos;: 300,\n}\n# 爬虫停止后,保留/清除Reids中的请求队列以及去重集合\nSCHEDULER_PERSIST = False\n\n\n# 修改爬虫spider.py\nfrom scrapy_redis.spiders import RedisSpider\n\nclass BookSpider(RedisSpider):\n\n    # 注释start_urls\n    # start_urls = []\n\n\n# 手动添加start_urls\nredis-cli -h 127.0.0.1\nlpush books:start_urls &apos;http://www.books.com/&apos;</code></pre>","site":{"data":{}},"excerpt":"","more":"<p>Scrapy是一个为了爬取网站数据，提取结构性数据而编写的应用框架。 可以应用在包括数据挖掘，信息处理或存储历史数据等一系列的程序中。 其最初是为了页面抓取 (更确切来说, 网络抓取 )所设计的， 也可以应用在获取API所返回的数据(例如 Amazon Associates Web Services ) 或者通用的网络爬虫。Scrapy用途广泛，可以用于数据挖掘、监测和自动化测试</p>\n<h3 id=\"Scrapy主要包括了以下组件：\"><a href=\"#Scrapy主要包括了以下组件：\" class=\"headerlink\" title=\"Scrapy主要包括了以下组件：\"></a>Scrapy主要包括了以下组件：</h3><ol>\n<li>引擎(Scrapy): 用来处理整个系统的数据流处理, 触发事务(框架核心)</li>\n<li>调度器(Scheduler): 用来接受引擎发过来的请求, 压入队列中, 并在引擎再次请求的时候返回. 可以想像成一个URL（抓取网页的网址或者说是链接）的优先队列, 由它来决定下一个要抓取的网址是什么, 同时去除重复的网址</li>\n<li>下载器(Downloader): 用于下载网页内容, 并将网页内容返回给蜘蛛(Scrapy下载器是建立在twisted这个高效的异步模型上的)</li>\n<li>爬虫(Spiders): 爬虫是主要干活的, 用于从特定的网页中提取自己需要的信息, 即所谓的实体(Item)。用户也可以从中提取出链接,让Scrapy继续抓取下一个页面</li>\n<li>项目管道(Pipeline): 负责处理爬虫从网页中抽取的实体，主要的功能是持久化实体、验证实体的有效性、清除不需要的信息。当页面被爬虫解析后，将被发送到项目管道，并经过几个特定的次序处理数据。</li>\n<li>下载器中间件(Downloader Middlewares): 位于Scrapy引擎和下载器之间的框架，主要是处理Scrapy引擎与下载器之间的请求及响应。</li>\n<li>爬虫中间件(Spider Middlewares): 介于Scrapy引擎和爬虫之间的框架，主要工作是处理蜘蛛的响应输入和请求输出。</li>\n<li>调度中间件(Scheduler Middewares): 介于Scrapy引擎和调度之间的中间件，从Scrapy引擎发送到调度的请求和响应。</li>\n</ol>\n<h3 id=\"Scrapy运行流程大概如下：\"><a href=\"#Scrapy运行流程大概如下：\" class=\"headerlink\" title=\"Scrapy运行流程大概如下：\"></a>Scrapy运行流程大概如下：</h3><p>首先，引擎从调度器中取出一个链接(URL)用于接下来的抓取 引擎把URL封装成一个请求(Request)传给下载器，下载器把资源下载下来，并封装成应答包(Response) 然后，爬虫解析Response 若是解析出实体（Item）,则交给实体管道进行进一步的处理。 若是解析出的是链接（URL）,则把URL交给Scheduler等待抓取</p>\n<h3 id=\"备忘\"><a href=\"#备忘\" class=\"headerlink\" title=\"备忘\"></a>备忘</h3><h4 id=\"使用Selector提取数据\"><a href=\"#使用Selector提取数据\" class=\"headerlink\" title=\"使用Selector提取数据\"></a>使用Selector提取数据</h4><h4 id=\"xpath语法和基本函数\"><a href=\"#xpath语法和基本函数\" class=\"headerlink\" title=\"xpath语法和基本函数\"></a>xpath语法和基本函数</h4><pre><code>/\n.\n..\nELEMENT\n//ELEMENT\n*\ntext\n@ALTER\n@*\nposition()\nlast()\nstring()</code></pre><h4 id=\"css选择器\"><a href=\"#css选择器\" class=\"headerlink\" title=\"css选择器\"></a>css选择器</h4><pre><code>*\nE\nE1&gt;E2\nE1+E2\n.CLASS\n#ID\n[ATTR]\n[ATTR=VALUE]\nE:nth-child(n)\nE:first-child</code></pre><h4 id=\"使用Item和Field封装数据\"><a href=\"#使用Item和Field封装数据\" class=\"headerlink\" title=\"使用Item和Field封装数据\"></a>使用Item和Field封装数据</h4><p>Field(serializer=lambda)设置存储数据</p>\n<h4 id=\"使用Item-Pipeline处理数据\"><a href=\"#使用Item-Pipeline处理数据\" class=\"headerlink\" title=\"使用Item Pipeline处理数据\"></a>使用Item Pipeline处理数据</h4><p>修改数据,过滤重复数据,将数据写入到数据库等</p>\n<h4 id=\"LinkExtractor提取链接\"><a href=\"#LinkExtractor提取链接\" class=\"headerlink\" title=\"LinkExtractor提取链接\"></a>LinkExtractor提取链接</h4><pre><code>LinkExtractor参数\nallow 允许链接\ndeny 拒绝链接\nallow_domains 允许域名\ndeny_domains 拒绝域名\nrestrict_xpaths 允许xpath链接\nrestrict_css 允许css选择器链接</code></pre><h4 id=\"Exporter导出数据\"><a href=\"#Exporter导出数据\" class=\"headerlink\" title=\"Exporter导出数据\"></a>Exporter导出数据</h4><p>默认包含以下</p>\n<pre><code>JSON, JSON LINES, CSV, XML, PICKLE, MARSHAL</code></pre><p>可配置导出格式和存放文件地址, 可自定义导出格式,例如xls</p>\n<h4 id=\"下载文件和图片\"><a href=\"#下载文件和图片\" class=\"headerlink\" title=\"下载文件和图片\"></a>下载文件和图片</h4><p>FIlesPipeline</p>\n<pre><code>setting.py\nITEM_PIPELINES = {&apos;scrapy.pipelines.files.FilesPipeline&apos;: 1}\nFILES_STORE = &apos;/home/hanchang/download&apos;</code></pre><p>ImagesPipeline</p>\n<h4 id=\"模拟登录\"><a href=\"#模拟登录\" class=\"headerlink\" title=\"模拟登录\"></a>模拟登录</h4><p>使用FromRequest ORC识别验证码:pillow, pytesseract 付费网络平台识别 人工识别:爬取登录页面的验证码图片,调用Image.show方法,肉眼识别并输入到内置的input函数中 Cookie登录: 获取浏览器的cookie值(browsercookie包), 利用BrowserCookiesMiddleware将获取的cookie值添加到CookieJar中</p>\n<h4 id=\"动态页面抓取\"><a href=\"#动态页面抓取\" class=\"headerlink\" title=\"动态页面抓取\"></a>动态页面抓取</h4><p>Splash是Scrapy官方推荐的javascript渲染引擎, Webkit无界面浏览器</p>\n<pre><code># 安装\nsudo apt-get install docker\nsudo docker pull scrapinghub/splash\nsudo docker run -p 8050:8050 -p 8051:8051 scrapinghub/splash</code></pre><p>splash常见服务端点 <a href=\"http://localhost:8050/render.html\" target=\"_blank\" rel=\"noopener\">http://localhost:8050/render.html</a> GET/POST 返回html 参数: url, timeout, proxy, wait, images, js_source <a href=\"http://localhost:8050/excute\" target=\"_blank\" rel=\"noopener\">http://localhost:8050/excute</a> 传递模拟的动作给splash,例如等待页面渲染，执行代码，等等</p>\n<h5 id=\"scrapy使用splash\"><a href=\"#scrapy使用splash\" class=\"headerlink\" title=\"scrapy使用splash\"></a>scrapy使用splash</h5><pre><code>安装\npip install scrapy-splash\n\n\nsetting.py\n# splash服务器地址\nSPLASH_URL = &apos;http://localhost:8050&apos;\n# 开启splash的两个下载中间件并调整HttpCompressionMiddleware的次序\nDOWNLOADER_MIDDLEWARES = {\n    &apos;scrapy_splash.SplashCookiesMiddleware&apos;: 723,\n        &apos;scrapy_splash.SplashMiddleware&apos;: 725,\n        &apos;scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware&apos;: 810,\n}\n# 过滤去重函数\nDUPEFILTER_CLASS = &apos;scrapy_splash.SplashAwareDupeFilter&apos;,\n# 用户支持cahce_args\nSPIDER_MIDDLEWARES = {\n  &apos;scrapy_splash.SplashDeduplicateArgsMiddleware&apos;: 100,\n}</code></pre><h4 id=\"分布式爬取\"><a href=\"#分布式爬取\" class=\"headerlink\" title=\"分布式爬取\"></a>分布式爬取</h4><p>使用scrapy-redis</p>\n<pre><code># 安装\npip install scrapy\npip install scrapy-redis\n\n\n# 在配置文件setting.py中添加scrapy-redis相关信息\n# redis服务器\nREDIS_URL = &apos;redis://127.0.0.1:6379&apos;\n# 使用scrapy_redis调度器替代原生调度器\nSCHEDULER = &apos;scrapy_redis.scheduler.Scheduler&apos;\n# 使用scrapy_redis的RFPDupeFilter作为去重过滤器\nDUPEFILTER_CLASS = &apos;scrapy_redis.dupefilter.RFPDupeFilter&apos;\n# 将爬取的数据存储到redis中\nITEM_PIPELINES = {\n    &apos;scrapy_redis.pipelines.RedisPipeline&apos;: 300,\n}\n# 爬虫停止后,保留/清除Reids中的请求队列以及去重集合\nSCHEDULER_PERSIST = False\n\n\n# 修改爬虫spider.py\nfrom scrapy_redis.spiders import RedisSpider\n\nclass BookSpider(RedisSpider):\n\n    # 注释start_urls\n    # start_urls = []\n\n\n# 手动添加start_urls\nredis-cli -h 127.0.0.1\nlpush books:start_urls &apos;http://www.books.com/&apos;</code></pre>"},{"title":"sublime入门基础","url":"67.html","id":"67","comments":0,"date":"2016-11-09T07:36:07.000Z","_content":"\n### 下载地址\n\n[http://www.sublimetext.com/3](http://www.sublimetext.com/3)\n\n### Ubuntu下载\n\n    sudo add-apt-repository ppa:webupd8team/sublime-text-3\n    sudo apt-get update\n    sudo apt-get install sublime-text-installer\n    \n\n### 插件下载地址\n\n[https://packagecontrol.io/](https://packagecontrol.io/)\n\n### 注册码\n\n    ----- BEGIN LICENSE ----\n    Andrew Weber\n    Single User License\n    EA7E-855605\n    813A03DD 5E4AD9E6 6C0EEB94 BC99798F\n    942194A6 02396E98 E62C9979 4BB979FE\n    91424C9D A45400BF F6747D88 2FB88078\n    90F5CC94 1CDC92DC 8457107A F151657B\n    1D22E383 A997F016 42397640 33F41CFC\n    E1D0AE85 A0BBD039 0E9C8D55 E1B89D5D\n    5CDB7036 E56DE1C0 EFCC0840 650CD3A6\n    B98FC99C 8FAC73EE D2B95564 DF450523\n    ------ END LICENSE ------\n    \n\n### 安装Package Control\n\n    import urllib.request,os; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); open(os.path.join(ipp, pf), 'wb').write(urllib.request.urlopen( 'http://sublime.wbond.net/' + pf.replace(' ','%20')).read())\n    \n    \n\n### 安装模板Material Theme\n\n配置方法\n\n    Package Control Messages\n    ========================\n    \n    Material Theme\n    --------------\n    \n      Material Theme for Sublime Text 3\n    \n      For more information on the Material Theme: https://github.com/equinusocio/material-theme\n    \n      **********************************************************************************************\n    \n      If installing manually (not through Package Control), add the following to your \n      Settings - User file and restart Sublime Text after:\n    \n      {\n        \"theme\": \"Material-Theme.sublime-theme\",\n        \"color_scheme\": \"Packages/Material Theme/schemes/Material-Theme.tmTheme\",\n      }\n    \n      **********************************************************************************************\n    \n      This theme includes a Darker and Lighter version:\n    \n      Darker version:\n    \n      {\n        \"theme\": \"Material-Theme-Darker.sublime-theme\",\n        \"color_scheme\": \"Packages/Material Theme/schemes/Material-Theme-Darker.tmTheme\",\n      }\n    \n      Lighter version:\n    \n      {\n        \"theme\": \"Material-Theme-Lighter.sublime-theme\",\n        \"color_scheme\": \"Packages/Material Theme/schemes/Material-Theme-Lighter.tmTheme\",\n      }\n    \n      **********************************************************************************************\n    \n      Recommended UI and font settings for a better experience:\n    \n      {\n        \"overlay_scroll_bars\": \"enabled\",\n        \"line_padding_top\": 3,\n        \"line_padding_bottom\": 3,\n        \"always_show_minimap_viewport\": true,\n        \"bold_folder_labels\": true,\n        \"indent_guide_options\": [ \"draw_normal\", \"draw_active\" ]    // Highlight active indent\n        \"font_options\": [ \"gray_antialias\" ],                       // For retina Mac\n      }\n    \n      **********************************************************************************************\n    \n      Other available theme options:\n    \n      \"material_theme_small_tab\": true,                           // Set small tabs\n      \"material_theme_disable_fileicons\": true,                   // Hide siderbar file type icons\n      \"material_theme_disable_folder_animation\": true,            // Disable folder animation\n      \"material_theme_small_statusbar\": true,                     // Set small status bar\n      \"material_theme_disable_tree_indicator\": true,              // Disable sidebar file indicator\n      \"material_theme_bold_tab\": true,                            // Make the tab labels bolder\n      \"material_theme_tabs_separator\": true,                      // Show tabs separator\n      \"material_theme_accent_lime\": true,                         // set green lime accent color\n      \"material_theme_accent_purple\": true,                       // set purple accent color\n      \"material_theme_accent_red\": true,                          // set pale red accent color\n      \"material_theme_accent_orange\": true,                       // set orange accent color\n      \"material_theme_accent_yellow\": true,                       // set yellow accent color\n      \"material_theme_panel_separator\": true,                     // show bottom panel separator\n      \"material_theme_tabs_autowidth\": true,                      // Enable autowidth for tabs\n      \"material_theme_contrast_mode\": true,                       // Enable sidebar and panels contrast mode\n    \n\n### 设置空格缩进\n\n    {    \n        \"tab_size\": 4,    \n        \"translate_tabs_to_spaces\": true \n    } \n    \n\n### 设置行间距\n\n    {\n        \"line_padding_bottom\": 3, \n        \"line_padding_top\": 3,\n    }    \n    \n\n### 插件安装\n\n**Emmet(懂的)**  \n**ConvertToUtf8(编码转换)**  \n**Sublime​Linter(代码检查工具，需要配合各语言插件包检查)**  \n**SideBarEnhancements（侧边栏右键增强）**  \n**Bracket​Highlighter（显示标签块？？）**  \n**SublimeCodeIntel(跳转到自定义函数)**\n\n> For Windows:  \n> Jump to definition = Alt+Click  \n> Jump to definition = Control+Windows+Alt+Up  \n> Go back = Control+Windows+Alt+Left  \n> Manual Code Intelligence = Control+Shift+space  \n> 需要自己设置执行路径\n\n            \"PHP\": {\n                \"php\": \"D:\\\\PHP\\\\php.exe\",\n                \"codeintel_scan_extra_dir\": [],\n                \"codeintel_scan_files_in_project\": true,\n                \"codeintel_max_recursive_dir_depth\": 15,\n                \"codeintel_scan_exclude_dir\":[\"D:\\\\PHP\"]\n            }\n    \n\n**HTML5(html5的snippets)**  \n**Alignment(自动对齐插件)**  \n**SFTP(ftp上传)需要配置对应的ftp路径等信息** **git** **jquery(jquery snippets)** **SaSS(可以支持sass)** **DocBlockr（块状注释）**\n\n### ubuntu安装中文输入法\n\n### 安装\n\n    git clone https://github.com/lyfeyaj/sublime-text-imfix.git\n    \n\n### 复制文件\n\n    cd ~/sublime-text-imfix\n    sudo cp ./lib/libsublime-imfix.so /opt/sublime_text/\n    sudo cp ./src/subl /usr/bin/\n    \n\n### 测试\n\n终端输入\n\n    LD_PRELOAD=./libsublime-imfix.so subl\n    \n\n### 建立快捷方式\n\n新建文件sublime放在/home目录下，脚本内容：\n\n    #!/bin/bash\n    LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so subl\n    \n\n### 测试\n\n终端输入\n\n    bash ~/sublime\n    \n\n### 快捷方式修改\n\n将\\[Desktop Entry\\]中的字符串  \nExec=/opt/sublime\\_text/sublime\\_text %F  \n修改为  \nExec=bash -c \"LD\\_PRELOAD=/opt/sublime\\_text/libsublime-imfix.so exec /opt/sublime\\_text/sublime\\_text %F\"  \n将\\[Desktop Action Window\\]中的字符串  \nExec=/opt/sublime\\_text/sublime\\_text -n  \n修改为  \nExec=bash -c \"LD\\_PRELOAD=/opt/sublime\\_text/libsublime-imfix.so exec /opt/sublime\\_text/sublime\\_text -n\"  \n将\\[Desktop Action Document\\]中的字符串  \nExec=/opt/sublime\\_text/sublime\\_text --command new_file  \n修改为  \nExec=bash -c \"LD\\_PRELOAD=/opt/sublime\\_text/libsublime-imfix.so exec /opt/sublime\\_text/sublime\\_text --command new_file\"  \n注意：  \n修改时请注意双引号\"\",否则会导致不能打开带有空格文件名的文件。","source":"_posts/sublime入门基础.md","raw":"---\ntitle: sublime入门基础\ntags:\n  - IDE\nurl: 67.html\nid: 67\ncomments: false\ncategories:\n  - 办公\ndate: 2016-11-09 15:36:07\n---\n\n### 下载地址\n\n[http://www.sublimetext.com/3](http://www.sublimetext.com/3)\n\n### Ubuntu下载\n\n    sudo add-apt-repository ppa:webupd8team/sublime-text-3\n    sudo apt-get update\n    sudo apt-get install sublime-text-installer\n    \n\n### 插件下载地址\n\n[https://packagecontrol.io/](https://packagecontrol.io/)\n\n### 注册码\n\n    ----- BEGIN LICENSE ----\n    Andrew Weber\n    Single User License\n    EA7E-855605\n    813A03DD 5E4AD9E6 6C0EEB94 BC99798F\n    942194A6 02396E98 E62C9979 4BB979FE\n    91424C9D A45400BF F6747D88 2FB88078\n    90F5CC94 1CDC92DC 8457107A F151657B\n    1D22E383 A997F016 42397640 33F41CFC\n    E1D0AE85 A0BBD039 0E9C8D55 E1B89D5D\n    5CDB7036 E56DE1C0 EFCC0840 650CD3A6\n    B98FC99C 8FAC73EE D2B95564 DF450523\n    ------ END LICENSE ------\n    \n\n### 安装Package Control\n\n    import urllib.request,os; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); open(os.path.join(ipp, pf), 'wb').write(urllib.request.urlopen( 'http://sublime.wbond.net/' + pf.replace(' ','%20')).read())\n    \n    \n\n### 安装模板Material Theme\n\n配置方法\n\n    Package Control Messages\n    ========================\n    \n    Material Theme\n    --------------\n    \n      Material Theme for Sublime Text 3\n    \n      For more information on the Material Theme: https://github.com/equinusocio/material-theme\n    \n      **********************************************************************************************\n    \n      If installing manually (not through Package Control), add the following to your \n      Settings - User file and restart Sublime Text after:\n    \n      {\n        \"theme\": \"Material-Theme.sublime-theme\",\n        \"color_scheme\": \"Packages/Material Theme/schemes/Material-Theme.tmTheme\",\n      }\n    \n      **********************************************************************************************\n    \n      This theme includes a Darker and Lighter version:\n    \n      Darker version:\n    \n      {\n        \"theme\": \"Material-Theme-Darker.sublime-theme\",\n        \"color_scheme\": \"Packages/Material Theme/schemes/Material-Theme-Darker.tmTheme\",\n      }\n    \n      Lighter version:\n    \n      {\n        \"theme\": \"Material-Theme-Lighter.sublime-theme\",\n        \"color_scheme\": \"Packages/Material Theme/schemes/Material-Theme-Lighter.tmTheme\",\n      }\n    \n      **********************************************************************************************\n    \n      Recommended UI and font settings for a better experience:\n    \n      {\n        \"overlay_scroll_bars\": \"enabled\",\n        \"line_padding_top\": 3,\n        \"line_padding_bottom\": 3,\n        \"always_show_minimap_viewport\": true,\n        \"bold_folder_labels\": true,\n        \"indent_guide_options\": [ \"draw_normal\", \"draw_active\" ]    // Highlight active indent\n        \"font_options\": [ \"gray_antialias\" ],                       // For retina Mac\n      }\n    \n      **********************************************************************************************\n    \n      Other available theme options:\n    \n      \"material_theme_small_tab\": true,                           // Set small tabs\n      \"material_theme_disable_fileicons\": true,                   // Hide siderbar file type icons\n      \"material_theme_disable_folder_animation\": true,            // Disable folder animation\n      \"material_theme_small_statusbar\": true,                     // Set small status bar\n      \"material_theme_disable_tree_indicator\": true,              // Disable sidebar file indicator\n      \"material_theme_bold_tab\": true,                            // Make the tab labels bolder\n      \"material_theme_tabs_separator\": true,                      // Show tabs separator\n      \"material_theme_accent_lime\": true,                         // set green lime accent color\n      \"material_theme_accent_purple\": true,                       // set purple accent color\n      \"material_theme_accent_red\": true,                          // set pale red accent color\n      \"material_theme_accent_orange\": true,                       // set orange accent color\n      \"material_theme_accent_yellow\": true,                       // set yellow accent color\n      \"material_theme_panel_separator\": true,                     // show bottom panel separator\n      \"material_theme_tabs_autowidth\": true,                      // Enable autowidth for tabs\n      \"material_theme_contrast_mode\": true,                       // Enable sidebar and panels contrast mode\n    \n\n### 设置空格缩进\n\n    {    \n        \"tab_size\": 4,    \n        \"translate_tabs_to_spaces\": true \n    } \n    \n\n### 设置行间距\n\n    {\n        \"line_padding_bottom\": 3, \n        \"line_padding_top\": 3,\n    }    \n    \n\n### 插件安装\n\n**Emmet(懂的)**  \n**ConvertToUtf8(编码转换)**  \n**Sublime​Linter(代码检查工具，需要配合各语言插件包检查)**  \n**SideBarEnhancements（侧边栏右键增强）**  \n**Bracket​Highlighter（显示标签块？？）**  \n**SublimeCodeIntel(跳转到自定义函数)**\n\n> For Windows:  \n> Jump to definition = Alt+Click  \n> Jump to definition = Control+Windows+Alt+Up  \n> Go back = Control+Windows+Alt+Left  \n> Manual Code Intelligence = Control+Shift+space  \n> 需要自己设置执行路径\n\n            \"PHP\": {\n                \"php\": \"D:\\\\PHP\\\\php.exe\",\n                \"codeintel_scan_extra_dir\": [],\n                \"codeintel_scan_files_in_project\": true,\n                \"codeintel_max_recursive_dir_depth\": 15,\n                \"codeintel_scan_exclude_dir\":[\"D:\\\\PHP\"]\n            }\n    \n\n**HTML5(html5的snippets)**  \n**Alignment(自动对齐插件)**  \n**SFTP(ftp上传)需要配置对应的ftp路径等信息** **git** **jquery(jquery snippets)** **SaSS(可以支持sass)** **DocBlockr（块状注释）**\n\n### ubuntu安装中文输入法\n\n### 安装\n\n    git clone https://github.com/lyfeyaj/sublime-text-imfix.git\n    \n\n### 复制文件\n\n    cd ~/sublime-text-imfix\n    sudo cp ./lib/libsublime-imfix.so /opt/sublime_text/\n    sudo cp ./src/subl /usr/bin/\n    \n\n### 测试\n\n终端输入\n\n    LD_PRELOAD=./libsublime-imfix.so subl\n    \n\n### 建立快捷方式\n\n新建文件sublime放在/home目录下，脚本内容：\n\n    #!/bin/bash\n    LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so subl\n    \n\n### 测试\n\n终端输入\n\n    bash ~/sublime\n    \n\n### 快捷方式修改\n\n将\\[Desktop Entry\\]中的字符串  \nExec=/opt/sublime\\_text/sublime\\_text %F  \n修改为  \nExec=bash -c \"LD\\_PRELOAD=/opt/sublime\\_text/libsublime-imfix.so exec /opt/sublime\\_text/sublime\\_text %F\"  \n将\\[Desktop Action Window\\]中的字符串  \nExec=/opt/sublime\\_text/sublime\\_text -n  \n修改为  \nExec=bash -c \"LD\\_PRELOAD=/opt/sublime\\_text/libsublime-imfix.so exec /opt/sublime\\_text/sublime\\_text -n\"  \n将\\[Desktop Action Document\\]中的字符串  \nExec=/opt/sublime\\_text/sublime\\_text --command new_file  \n修改为  \nExec=bash -c \"LD\\_PRELOAD=/opt/sublime\\_text/libsublime-imfix.so exec /opt/sublime\\_text/sublime\\_text --command new_file\"  \n注意：  \n修改时请注意双引号\"\",否则会导致不能打开带有空格文件名的文件。","slug":"sublime入门基础","published":1,"updated":"2019-07-24T01:34:15.320Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5oc002f9ka4cc1mp0kf","content":"<h3 id=\"下载地址\"><a href=\"#下载地址\" class=\"headerlink\" title=\"下载地址\"></a>下载地址</h3><p><a href=\"http://www.sublimetext.com/3\" target=\"_blank\" rel=\"noopener\">http://www.sublimetext.com/3</a></p>\n<h3 id=\"Ubuntu下载\"><a href=\"#Ubuntu下载\" class=\"headerlink\" title=\"Ubuntu下载\"></a>Ubuntu下载</h3><pre><code>sudo add-apt-repository ppa:webupd8team/sublime-text-3\nsudo apt-get update\nsudo apt-get install sublime-text-installer</code></pre><h3 id=\"插件下载地址\"><a href=\"#插件下载地址\" class=\"headerlink\" title=\"插件下载地址\"></a>插件下载地址</h3><p><a href=\"https://packagecontrol.io/\" target=\"_blank\" rel=\"noopener\">https://packagecontrol.io/</a></p>\n<h3 id=\"注册码\"><a href=\"#注册码\" class=\"headerlink\" title=\"注册码\"></a>注册码</h3><pre><code>----- BEGIN LICENSE ----\nAndrew Weber\nSingle User License\nEA7E-855605\n813A03DD 5E4AD9E6 6C0EEB94 BC99798F\n942194A6 02396E98 E62C9979 4BB979FE\n91424C9D A45400BF F6747D88 2FB88078\n90F5CC94 1CDC92DC 8457107A F151657B\n1D22E383 A997F016 42397640 33F41CFC\nE1D0AE85 A0BBD039 0E9C8D55 E1B89D5D\n5CDB7036 E56DE1C0 EFCC0840 650CD3A6\nB98FC99C 8FAC73EE D2B95564 DF450523\n------ END LICENSE ------</code></pre><h3 id=\"安装Package-Control\"><a href=\"#安装Package-Control\" class=\"headerlink\" title=\"安装Package Control\"></a>安装Package Control</h3><pre><code>import urllib.request,os; pf = &apos;Package Control.sublime-package&apos;; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); open(os.path.join(ipp, pf), &apos;wb&apos;).write(urllib.request.urlopen( &apos;http://sublime.wbond.net/&apos; + pf.replace(&apos; &apos;,&apos;%20&apos;)).read())</code></pre><h3 id=\"安装模板Material-Theme\"><a href=\"#安装模板Material-Theme\" class=\"headerlink\" title=\"安装模板Material Theme\"></a>安装模板Material Theme</h3><p>配置方法</p>\n<pre><code>Package Control Messages\n========================\n\nMaterial Theme\n--------------\n\n  Material Theme for Sublime Text 3\n\n  For more information on the Material Theme: https://github.com/equinusocio/material-theme\n\n  **********************************************************************************************\n\n  If installing manually (not through Package Control), add the following to your \n  Settings - User file and restart Sublime Text after:\n\n  {\n    &quot;theme&quot;: &quot;Material-Theme.sublime-theme&quot;,\n    &quot;color_scheme&quot;: &quot;Packages/Material Theme/schemes/Material-Theme.tmTheme&quot;,\n  }\n\n  **********************************************************************************************\n\n  This theme includes a Darker and Lighter version:\n\n  Darker version:\n\n  {\n    &quot;theme&quot;: &quot;Material-Theme-Darker.sublime-theme&quot;,\n    &quot;color_scheme&quot;: &quot;Packages/Material Theme/schemes/Material-Theme-Darker.tmTheme&quot;,\n  }\n\n  Lighter version:\n\n  {\n    &quot;theme&quot;: &quot;Material-Theme-Lighter.sublime-theme&quot;,\n    &quot;color_scheme&quot;: &quot;Packages/Material Theme/schemes/Material-Theme-Lighter.tmTheme&quot;,\n  }\n\n  **********************************************************************************************\n\n  Recommended UI and font settings for a better experience:\n\n  {\n    &quot;overlay_scroll_bars&quot;: &quot;enabled&quot;,\n    &quot;line_padding_top&quot;: 3,\n    &quot;line_padding_bottom&quot;: 3,\n    &quot;always_show_minimap_viewport&quot;: true,\n    &quot;bold_folder_labels&quot;: true,\n    &quot;indent_guide_options&quot;: [ &quot;draw_normal&quot;, &quot;draw_active&quot; ]    // Highlight active indent\n    &quot;font_options&quot;: [ &quot;gray_antialias&quot; ],                       // For retina Mac\n  }\n\n  **********************************************************************************************\n\n  Other available theme options:\n\n  &quot;material_theme_small_tab&quot;: true,                           // Set small tabs\n  &quot;material_theme_disable_fileicons&quot;: true,                   // Hide siderbar file type icons\n  &quot;material_theme_disable_folder_animation&quot;: true,            // Disable folder animation\n  &quot;material_theme_small_statusbar&quot;: true,                     // Set small status bar\n  &quot;material_theme_disable_tree_indicator&quot;: true,              // Disable sidebar file indicator\n  &quot;material_theme_bold_tab&quot;: true,                            // Make the tab labels bolder\n  &quot;material_theme_tabs_separator&quot;: true,                      // Show tabs separator\n  &quot;material_theme_accent_lime&quot;: true,                         // set green lime accent color\n  &quot;material_theme_accent_purple&quot;: true,                       // set purple accent color\n  &quot;material_theme_accent_red&quot;: true,                          // set pale red accent color\n  &quot;material_theme_accent_orange&quot;: true,                       // set orange accent color\n  &quot;material_theme_accent_yellow&quot;: true,                       // set yellow accent color\n  &quot;material_theme_panel_separator&quot;: true,                     // show bottom panel separator\n  &quot;material_theme_tabs_autowidth&quot;: true,                      // Enable autowidth for tabs\n  &quot;material_theme_contrast_mode&quot;: true,                       // Enable sidebar and panels contrast mode</code></pre><h3 id=\"设置空格缩进\"><a href=\"#设置空格缩进\" class=\"headerlink\" title=\"设置空格缩进\"></a>设置空格缩进</h3><pre><code>{    \n    &quot;tab_size&quot;: 4,    \n    &quot;translate_tabs_to_spaces&quot;: true \n} </code></pre><h3 id=\"设置行间距\"><a href=\"#设置行间距\" class=\"headerlink\" title=\"设置行间距\"></a>设置行间距</h3><pre><code>{\n    &quot;line_padding_bottom&quot;: 3, \n    &quot;line_padding_top&quot;: 3,\n}    </code></pre><h3 id=\"插件安装\"><a href=\"#插件安装\" class=\"headerlink\" title=\"插件安装\"></a>插件安装</h3><p><strong>Emmet(懂的)</strong><br><strong>ConvertToUtf8(编码转换)</strong><br><strong>Sublime​Linter(代码检查工具，需要配合各语言插件包检查)</strong><br><strong>SideBarEnhancements（侧边栏右键增强）</strong><br><strong>Bracket​Highlighter（显示标签块？？）</strong><br><strong>SublimeCodeIntel(跳转到自定义函数)</strong></p>\n<blockquote>\n<p>For Windows:<br>Jump to definition = Alt+Click<br>Jump to definition = Control+Windows+Alt+Up<br>Go back = Control+Windows+Alt+Left<br>Manual Code Intelligence = Control+Shift+space<br>需要自己设置执行路径</p>\n</blockquote>\n<pre><code>&quot;PHP&quot;: {\n    &quot;php&quot;: &quot;D:\\\\PHP\\\\php.exe&quot;,\n    &quot;codeintel_scan_extra_dir&quot;: [],\n    &quot;codeintel_scan_files_in_project&quot;: true,\n    &quot;codeintel_max_recursive_dir_depth&quot;: 15,\n    &quot;codeintel_scan_exclude_dir&quot;:[&quot;D:\\\\PHP&quot;]\n}</code></pre><p><strong>HTML5(html5的snippets)</strong><br><strong>Alignment(自动对齐插件)</strong><br><strong>SFTP(ftp上传)需要配置对应的ftp路径等信息</strong> <strong>git</strong> <strong>jquery(jquery snippets)</strong> <strong>SaSS(可以支持sass)</strong> <strong>DocBlockr（块状注释）</strong></p>\n<h3 id=\"ubuntu安装中文输入法\"><a href=\"#ubuntu安装中文输入法\" class=\"headerlink\" title=\"ubuntu安装中文输入法\"></a>ubuntu安装中文输入法</h3><h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><pre><code>git clone https://github.com/lyfeyaj/sublime-text-imfix.git</code></pre><h3 id=\"复制文件\"><a href=\"#复制文件\" class=\"headerlink\" title=\"复制文件\"></a>复制文件</h3><pre><code>cd ~/sublime-text-imfix\nsudo cp ./lib/libsublime-imfix.so /opt/sublime_text/\nsudo cp ./src/subl /usr/bin/</code></pre><h3 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h3><p>终端输入</p>\n<pre><code>LD_PRELOAD=./libsublime-imfix.so subl</code></pre><h3 id=\"建立快捷方式\"><a href=\"#建立快捷方式\" class=\"headerlink\" title=\"建立快捷方式\"></a>建立快捷方式</h3><p>新建文件sublime放在/home目录下，脚本内容：</p>\n<pre><code>#!/bin/bash\nLD_PRELOAD=/opt/sublime_text/libsublime-imfix.so subl</code></pre><h3 id=\"测试-1\"><a href=\"#测试-1\" class=\"headerlink\" title=\"测试\"></a>测试</h3><p>终端输入</p>\n<pre><code>bash ~/sublime</code></pre><h3 id=\"快捷方式修改\"><a href=\"#快捷方式修改\" class=\"headerlink\" title=\"快捷方式修改\"></a>快捷方式修改</h3><p>将[Desktop Entry]中的字符串<br>Exec=/opt/sublime_text/sublime_text %F<br>修改为<br>Exec=bash -c “LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text %F”<br>将[Desktop Action Window]中的字符串<br>Exec=/opt/sublime_text/sublime_text -n<br>修改为<br>Exec=bash -c “LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text -n”<br>将[Desktop Action Document]中的字符串<br>Exec=/opt/sublime_text/sublime_text –command new_file<br>修改为<br>Exec=bash -c “LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text –command new_file”<br>注意：<br>修改时请注意双引号””,否则会导致不能打开带有空格文件名的文件。</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"下载地址\"><a href=\"#下载地址\" class=\"headerlink\" title=\"下载地址\"></a>下载地址</h3><p><a href=\"http://www.sublimetext.com/3\" target=\"_blank\" rel=\"noopener\">http://www.sublimetext.com/3</a></p>\n<h3 id=\"Ubuntu下载\"><a href=\"#Ubuntu下载\" class=\"headerlink\" title=\"Ubuntu下载\"></a>Ubuntu下载</h3><pre><code>sudo add-apt-repository ppa:webupd8team/sublime-text-3\nsudo apt-get update\nsudo apt-get install sublime-text-installer</code></pre><h3 id=\"插件下载地址\"><a href=\"#插件下载地址\" class=\"headerlink\" title=\"插件下载地址\"></a>插件下载地址</h3><p><a href=\"https://packagecontrol.io/\" target=\"_blank\" rel=\"noopener\">https://packagecontrol.io/</a></p>\n<h3 id=\"注册码\"><a href=\"#注册码\" class=\"headerlink\" title=\"注册码\"></a>注册码</h3><pre><code>----- BEGIN LICENSE ----\nAndrew Weber\nSingle User License\nEA7E-855605\n813A03DD 5E4AD9E6 6C0EEB94 BC99798F\n942194A6 02396E98 E62C9979 4BB979FE\n91424C9D A45400BF F6747D88 2FB88078\n90F5CC94 1CDC92DC 8457107A F151657B\n1D22E383 A997F016 42397640 33F41CFC\nE1D0AE85 A0BBD039 0E9C8D55 E1B89D5D\n5CDB7036 E56DE1C0 EFCC0840 650CD3A6\nB98FC99C 8FAC73EE D2B95564 DF450523\n------ END LICENSE ------</code></pre><h3 id=\"安装Package-Control\"><a href=\"#安装Package-Control\" class=\"headerlink\" title=\"安装Package Control\"></a>安装Package Control</h3><pre><code>import urllib.request,os; pf = &apos;Package Control.sublime-package&apos;; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); open(os.path.join(ipp, pf), &apos;wb&apos;).write(urllib.request.urlopen( &apos;http://sublime.wbond.net/&apos; + pf.replace(&apos; &apos;,&apos;%20&apos;)).read())</code></pre><h3 id=\"安装模板Material-Theme\"><a href=\"#安装模板Material-Theme\" class=\"headerlink\" title=\"安装模板Material Theme\"></a>安装模板Material Theme</h3><p>配置方法</p>\n<pre><code>Package Control Messages\n========================\n\nMaterial Theme\n--------------\n\n  Material Theme for Sublime Text 3\n\n  For more information on the Material Theme: https://github.com/equinusocio/material-theme\n\n  **********************************************************************************************\n\n  If installing manually (not through Package Control), add the following to your \n  Settings - User file and restart Sublime Text after:\n\n  {\n    &quot;theme&quot;: &quot;Material-Theme.sublime-theme&quot;,\n    &quot;color_scheme&quot;: &quot;Packages/Material Theme/schemes/Material-Theme.tmTheme&quot;,\n  }\n\n  **********************************************************************************************\n\n  This theme includes a Darker and Lighter version:\n\n  Darker version:\n\n  {\n    &quot;theme&quot;: &quot;Material-Theme-Darker.sublime-theme&quot;,\n    &quot;color_scheme&quot;: &quot;Packages/Material Theme/schemes/Material-Theme-Darker.tmTheme&quot;,\n  }\n\n  Lighter version:\n\n  {\n    &quot;theme&quot;: &quot;Material-Theme-Lighter.sublime-theme&quot;,\n    &quot;color_scheme&quot;: &quot;Packages/Material Theme/schemes/Material-Theme-Lighter.tmTheme&quot;,\n  }\n\n  **********************************************************************************************\n\n  Recommended UI and font settings for a better experience:\n\n  {\n    &quot;overlay_scroll_bars&quot;: &quot;enabled&quot;,\n    &quot;line_padding_top&quot;: 3,\n    &quot;line_padding_bottom&quot;: 3,\n    &quot;always_show_minimap_viewport&quot;: true,\n    &quot;bold_folder_labels&quot;: true,\n    &quot;indent_guide_options&quot;: [ &quot;draw_normal&quot;, &quot;draw_active&quot; ]    // Highlight active indent\n    &quot;font_options&quot;: [ &quot;gray_antialias&quot; ],                       // For retina Mac\n  }\n\n  **********************************************************************************************\n\n  Other available theme options:\n\n  &quot;material_theme_small_tab&quot;: true,                           // Set small tabs\n  &quot;material_theme_disable_fileicons&quot;: true,                   // Hide siderbar file type icons\n  &quot;material_theme_disable_folder_animation&quot;: true,            // Disable folder animation\n  &quot;material_theme_small_statusbar&quot;: true,                     // Set small status bar\n  &quot;material_theme_disable_tree_indicator&quot;: true,              // Disable sidebar file indicator\n  &quot;material_theme_bold_tab&quot;: true,                            // Make the tab labels bolder\n  &quot;material_theme_tabs_separator&quot;: true,                      // Show tabs separator\n  &quot;material_theme_accent_lime&quot;: true,                         // set green lime accent color\n  &quot;material_theme_accent_purple&quot;: true,                       // set purple accent color\n  &quot;material_theme_accent_red&quot;: true,                          // set pale red accent color\n  &quot;material_theme_accent_orange&quot;: true,                       // set orange accent color\n  &quot;material_theme_accent_yellow&quot;: true,                       // set yellow accent color\n  &quot;material_theme_panel_separator&quot;: true,                     // show bottom panel separator\n  &quot;material_theme_tabs_autowidth&quot;: true,                      // Enable autowidth for tabs\n  &quot;material_theme_contrast_mode&quot;: true,                       // Enable sidebar and panels contrast mode</code></pre><h3 id=\"设置空格缩进\"><a href=\"#设置空格缩进\" class=\"headerlink\" title=\"设置空格缩进\"></a>设置空格缩进</h3><pre><code>{    \n    &quot;tab_size&quot;: 4,    \n    &quot;translate_tabs_to_spaces&quot;: true \n} </code></pre><h3 id=\"设置行间距\"><a href=\"#设置行间距\" class=\"headerlink\" title=\"设置行间距\"></a>设置行间距</h3><pre><code>{\n    &quot;line_padding_bottom&quot;: 3, \n    &quot;line_padding_top&quot;: 3,\n}    </code></pre><h3 id=\"插件安装\"><a href=\"#插件安装\" class=\"headerlink\" title=\"插件安装\"></a>插件安装</h3><p><strong>Emmet(懂的)</strong><br><strong>ConvertToUtf8(编码转换)</strong><br><strong>Sublime​Linter(代码检查工具，需要配合各语言插件包检查)</strong><br><strong>SideBarEnhancements（侧边栏右键增强）</strong><br><strong>Bracket​Highlighter（显示标签块？？）</strong><br><strong>SublimeCodeIntel(跳转到自定义函数)</strong></p>\n<blockquote>\n<p>For Windows:<br>Jump to definition = Alt+Click<br>Jump to definition = Control+Windows+Alt+Up<br>Go back = Control+Windows+Alt+Left<br>Manual Code Intelligence = Control+Shift+space<br>需要自己设置执行路径</p>\n</blockquote>\n<pre><code>&quot;PHP&quot;: {\n    &quot;php&quot;: &quot;D:\\\\PHP\\\\php.exe&quot;,\n    &quot;codeintel_scan_extra_dir&quot;: [],\n    &quot;codeintel_scan_files_in_project&quot;: true,\n    &quot;codeintel_max_recursive_dir_depth&quot;: 15,\n    &quot;codeintel_scan_exclude_dir&quot;:[&quot;D:\\\\PHP&quot;]\n}</code></pre><p><strong>HTML5(html5的snippets)</strong><br><strong>Alignment(自动对齐插件)</strong><br><strong>SFTP(ftp上传)需要配置对应的ftp路径等信息</strong> <strong>git</strong> <strong>jquery(jquery snippets)</strong> <strong>SaSS(可以支持sass)</strong> <strong>DocBlockr（块状注释）</strong></p>\n<h3 id=\"ubuntu安装中文输入法\"><a href=\"#ubuntu安装中文输入法\" class=\"headerlink\" title=\"ubuntu安装中文输入法\"></a>ubuntu安装中文输入法</h3><h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><pre><code>git clone https://github.com/lyfeyaj/sublime-text-imfix.git</code></pre><h3 id=\"复制文件\"><a href=\"#复制文件\" class=\"headerlink\" title=\"复制文件\"></a>复制文件</h3><pre><code>cd ~/sublime-text-imfix\nsudo cp ./lib/libsublime-imfix.so /opt/sublime_text/\nsudo cp ./src/subl /usr/bin/</code></pre><h3 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h3><p>终端输入</p>\n<pre><code>LD_PRELOAD=./libsublime-imfix.so subl</code></pre><h3 id=\"建立快捷方式\"><a href=\"#建立快捷方式\" class=\"headerlink\" title=\"建立快捷方式\"></a>建立快捷方式</h3><p>新建文件sublime放在/home目录下，脚本内容：</p>\n<pre><code>#!/bin/bash\nLD_PRELOAD=/opt/sublime_text/libsublime-imfix.so subl</code></pre><h3 id=\"测试-1\"><a href=\"#测试-1\" class=\"headerlink\" title=\"测试\"></a>测试</h3><p>终端输入</p>\n<pre><code>bash ~/sublime</code></pre><h3 id=\"快捷方式修改\"><a href=\"#快捷方式修改\" class=\"headerlink\" title=\"快捷方式修改\"></a>快捷方式修改</h3><p>将[Desktop Entry]中的字符串<br>Exec=/opt/sublime_text/sublime_text %F<br>修改为<br>Exec=bash -c “LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text %F”<br>将[Desktop Action Window]中的字符串<br>Exec=/opt/sublime_text/sublime_text -n<br>修改为<br>Exec=bash -c “LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text -n”<br>将[Desktop Action Document]中的字符串<br>Exec=/opt/sublime_text/sublime_text –command new_file<br>修改为<br>Exec=bash -c “LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text –command new_file”<br>注意：<br>修改时请注意双引号””,否则会导致不能打开带有空格文件名的文件。</p>\n"},{"title":"thinkphp入门基础","url":"73.html","id":"73","comments":0,"date":"2016-11-09T07:46:39.000Z","_content":"\n### URL\n\n### 配置URL伪静态\n\n3.1版本默认支持.html,.shtml,.xml,.pdf伪静态  \n在配置文件中配置\\[是在项目下的配置文件./App/Conf/config.php\\]\n\n    'URL_HTML_SUFFIX'=>'html|shmtl|xml' // 多个用 | 分割\n    \n\n### 配置URL路由\n\n基本规则\n\n> 一、规则路由  \n> 格式1：'路由规则'=>'\\[分组/模块/操作\\]?额外参数1=值1&额外参数2=值2...'  \n> 格式2：'路由规则'=>array('\\[分组/模块/操作\\]','额外参数1=值1&额外参数2=值2...')  \n> 格式3：'路由规则'=>'外部地址'  \n> 格式4：'路由规则'=>array('外部地址','重定向代码')  \n> 注意事项：  \n> 路由规则中如果以“:”开头，表示动态变量，否则为静态地址  \n> 格式2的额外参数可以传入数组或者字符串  \n> 外部地址中如果要引用动态变量， 采用 :1、:2 的方式  \n> 路由规则支持变量的数字约束定义，例如：'news/:id\\\\d'=>'News/read'  \n> 规则路由可以支持 全动态和动静结合定义，例如':user/blog/:id'=>'Home/Blog/user'  \n> 路由规则非数字变量支持排除，例如 'news/:cate^add|edit|delete'=>'News/category'  \n> 路由规则中的静态地址部分不区分大小写\n\n配置文件开启路由\n\n    'URL_ROUTER_ON'   => true, //开启路由\n    'URL_ROUTE_RULES' => array( //定义路由规则\n        'news/:year/:month/:day' => array('News/archive', 'status=1'),\n        'news/:id'               => 'News/read',\n        'news/read/:id'          => '/news/:1',\n     ),\n    \n\n> `http://serverName/index.php/news/2012/01/08`匹配第一条路由  \n> 也可以写成`'news/:year/:month/:day/'=>'News/archive?status=1',` `http://serverName/index.php/news/8`匹配第二条路由 第三条用于url地址迁移，重定向使用\n\n### 正则路由\n\n> 正则路由可以实现更加复杂的路由定义，支持的定义格式如下：  \n> 格式1：'路由正则'=>'\\[分组/模块/操作\\]?参数1=值1&参数2=值2...'  \n> 格式2：'路由正则'=>array('\\[分组/模块/操作\\]','参数1=值1&参数2=值2...')  \n> 格式3：'路由正则'=>'外部地址'  \n> 格式4：'路由正则'=>array('外部地址','重定向代码')\n\n注意事项：  \n正则路由规则必须以“/”开始和结束  \n格式2的参数可以传入数组或者字符串  \n参数值和外部地址中可以用动态变量 采用 :1、 :2 的方式  \n下面是正则路由的定义示例：\n\n    'URL_ROUTER_ON'   => true, //开启路由\n     'URL_ROUTE_RULES' => array( //定义路由规则\n        '/^blog\\/(\\d+)$/'        => 'Blog/read?id=:1',\n        '/^blog\\/(\\d+)\\/(\\d+)$/' => 'Blog/achive?year=:1&month=:2',\n        '/^blog\\/(\\d+)_(\\d+)$/'  => 'blog.php?id=:1&page=:2',\n     ),\n     ```   \n    ### URL区分大小写\n    \n\n'URL\\_CASE\\_INSENSITIVE' =>true, // 不区分 'URL\\_CASE\\_INSENSITIVE' =>false, // 区分\n\n    ### 缓存\n    ### 静态缓存\n    开启静态缓存[是在分组下的配置文件./App/Moduels/Index/Conf/config.php]  \n    和静态缓存相关的配置参数包括：  \n    HTML_CACHE_ON 是否开启静态缓存功能  \n    HTML_FILE_SUFFIX 静态文件后缀 惯例配置的值是 .html  \n    HTML_CACHE_TIME 默认的静态缓存有效期 默认60秒 可以在静态规则定义覆盖  \n    \n\n'HTML\\_CACHE\\_ON'=>true, 'HTML\\_CACHE\\_RULES'=> array( 'ActionName' => array('静态规则', '静态缓存有效期', '附加规则'), 'ModuleName(小写)' => array('静态规则', '静态缓存有效期', '附加规则'), 'ModuleName(小写):ActionName' => array('静态规则', '静态缓存有效期', '附加规则'), '*' => array('静态规则', '静态缓存有效期', '附加规则'), 'Show:index' => array('{:module}_{:action}_{id}', 100),\n\n    所有控制器下read方法缓存，其中，{id} 表示取$_GET['id'] 为静态缓存文件名，第二个参数表示缓存60秒\n    \n\n'read'=>array('{id}','60')\n\n    User控制器下所有方法缓存，其中，{:action} 表示当前的操作名称\n    \n\n'user:'=>array('User/{:action}_{id}','600')\n\n    Blog控制器下read方法缓存\n    \n\n'blog:read'=>array('{id}',0)\n\n    全局缓存\n    \n\n'*'=>array('{$\\_SERVER.REQUEST\\_URI|md5}'),\n\n    静态规则  \n    1.  使用系统变量 包括 _GET _REQUEST _SERVER _SESSION _COOKIE\n    > {$_×××|function}\n    \n    2.  使用框架特定的变量\n    > {:app}、{:group} 、{:module} 和{:action} 分别表示当前项目名、分组名、模块名和操作名\n    \n    3.  使用_GET变量\n    > {var|function}    也就是说 {id} 其实等效于 {$_GET.id}\n    \n    4.  直接使用函数\n    > {|function}   例如：{|time}\n    \n    5.  支持混合定义\n    > '{id},{name|md5}'   \n    在{}之外的字符作为字符串对待，如果包含有”/”，会自动创建目录。  \n    例如，定义下面的静态规则：  \n    {:module}/{:action}_{id}  \n    则会在静态目录下面创建模块名称的子目录，然后写入操作名_id.shtml 文件。    \n    \n    \n    \n    \n    使用get中文参数乱码问题\n    ### 原因\n    中文浏览器中默认使用的是gbk2312编码\n    \n    ### 解决方法\n    \n\n/\\*\\* \\* 解决get参数中带中文的乱码问题 * @param $keywords 传入的关键字 * @return string */ function decodeToUtf($keywords) { $keywords = mb\\_convert\\_encoding($keywords, 'UTF-8','GB2312,UTF-8'); return $keywords; }\n\n    \n\n$keywords = I('keywords'); $keywords = decodeToUtf($keywords); $page = new Page($count,self::$perPage); $page->parameter = 'keywords=' . $keywords; ```","source":"_posts/thinkphp入门基础.md","raw":"---\ntitle: thinkphp入门基础\ntags:\n  - php\nurl: 73.html\nid: 73\ncomments: false\ncategories:\n  - 后端\ndate: 2016-11-09 15:46:39\n---\n\n### URL\n\n### 配置URL伪静态\n\n3.1版本默认支持.html,.shtml,.xml,.pdf伪静态  \n在配置文件中配置\\[是在项目下的配置文件./App/Conf/config.php\\]\n\n    'URL_HTML_SUFFIX'=>'html|shmtl|xml' // 多个用 | 分割\n    \n\n### 配置URL路由\n\n基本规则\n\n> 一、规则路由  \n> 格式1：'路由规则'=>'\\[分组/模块/操作\\]?额外参数1=值1&额外参数2=值2...'  \n> 格式2：'路由规则'=>array('\\[分组/模块/操作\\]','额外参数1=值1&额外参数2=值2...')  \n> 格式3：'路由规则'=>'外部地址'  \n> 格式4：'路由规则'=>array('外部地址','重定向代码')  \n> 注意事项：  \n> 路由规则中如果以“:”开头，表示动态变量，否则为静态地址  \n> 格式2的额外参数可以传入数组或者字符串  \n> 外部地址中如果要引用动态变量， 采用 :1、:2 的方式  \n> 路由规则支持变量的数字约束定义，例如：'news/:id\\\\d'=>'News/read'  \n> 规则路由可以支持 全动态和动静结合定义，例如':user/blog/:id'=>'Home/Blog/user'  \n> 路由规则非数字变量支持排除，例如 'news/:cate^add|edit|delete'=>'News/category'  \n> 路由规则中的静态地址部分不区分大小写\n\n配置文件开启路由\n\n    'URL_ROUTER_ON'   => true, //开启路由\n    'URL_ROUTE_RULES' => array( //定义路由规则\n        'news/:year/:month/:day' => array('News/archive', 'status=1'),\n        'news/:id'               => 'News/read',\n        'news/read/:id'          => '/news/:1',\n     ),\n    \n\n> `http://serverName/index.php/news/2012/01/08`匹配第一条路由  \n> 也可以写成`'news/:year/:month/:day/'=>'News/archive?status=1',` `http://serverName/index.php/news/8`匹配第二条路由 第三条用于url地址迁移，重定向使用\n\n### 正则路由\n\n> 正则路由可以实现更加复杂的路由定义，支持的定义格式如下：  \n> 格式1：'路由正则'=>'\\[分组/模块/操作\\]?参数1=值1&参数2=值2...'  \n> 格式2：'路由正则'=>array('\\[分组/模块/操作\\]','参数1=值1&参数2=值2...')  \n> 格式3：'路由正则'=>'外部地址'  \n> 格式4：'路由正则'=>array('外部地址','重定向代码')\n\n注意事项：  \n正则路由规则必须以“/”开始和结束  \n格式2的参数可以传入数组或者字符串  \n参数值和外部地址中可以用动态变量 采用 :1、 :2 的方式  \n下面是正则路由的定义示例：\n\n    'URL_ROUTER_ON'   => true, //开启路由\n     'URL_ROUTE_RULES' => array( //定义路由规则\n        '/^blog\\/(\\d+)$/'        => 'Blog/read?id=:1',\n        '/^blog\\/(\\d+)\\/(\\d+)$/' => 'Blog/achive?year=:1&month=:2',\n        '/^blog\\/(\\d+)_(\\d+)$/'  => 'blog.php?id=:1&page=:2',\n     ),\n     ```   \n    ### URL区分大小写\n    \n\n'URL\\_CASE\\_INSENSITIVE' =>true, // 不区分 'URL\\_CASE\\_INSENSITIVE' =>false, // 区分\n\n    ### 缓存\n    ### 静态缓存\n    开启静态缓存[是在分组下的配置文件./App/Moduels/Index/Conf/config.php]  \n    和静态缓存相关的配置参数包括：  \n    HTML_CACHE_ON 是否开启静态缓存功能  \n    HTML_FILE_SUFFIX 静态文件后缀 惯例配置的值是 .html  \n    HTML_CACHE_TIME 默认的静态缓存有效期 默认60秒 可以在静态规则定义覆盖  \n    \n\n'HTML\\_CACHE\\_ON'=>true, 'HTML\\_CACHE\\_RULES'=> array( 'ActionName' => array('静态规则', '静态缓存有效期', '附加规则'), 'ModuleName(小写)' => array('静态规则', '静态缓存有效期', '附加规则'), 'ModuleName(小写):ActionName' => array('静态规则', '静态缓存有效期', '附加规则'), '*' => array('静态规则', '静态缓存有效期', '附加规则'), 'Show:index' => array('{:module}_{:action}_{id}', 100),\n\n    所有控制器下read方法缓存，其中，{id} 表示取$_GET['id'] 为静态缓存文件名，第二个参数表示缓存60秒\n    \n\n'read'=>array('{id}','60')\n\n    User控制器下所有方法缓存，其中，{:action} 表示当前的操作名称\n    \n\n'user:'=>array('User/{:action}_{id}','600')\n\n    Blog控制器下read方法缓存\n    \n\n'blog:read'=>array('{id}',0)\n\n    全局缓存\n    \n\n'*'=>array('{$\\_SERVER.REQUEST\\_URI|md5}'),\n\n    静态规则  \n    1.  使用系统变量 包括 _GET _REQUEST _SERVER _SESSION _COOKIE\n    > {$_×××|function}\n    \n    2.  使用框架特定的变量\n    > {:app}、{:group} 、{:module} 和{:action} 分别表示当前项目名、分组名、模块名和操作名\n    \n    3.  使用_GET变量\n    > {var|function}    也就是说 {id} 其实等效于 {$_GET.id}\n    \n    4.  直接使用函数\n    > {|function}   例如：{|time}\n    \n    5.  支持混合定义\n    > '{id},{name|md5}'   \n    在{}之外的字符作为字符串对待，如果包含有”/”，会自动创建目录。  \n    例如，定义下面的静态规则：  \n    {:module}/{:action}_{id}  \n    则会在静态目录下面创建模块名称的子目录，然后写入操作名_id.shtml 文件。    \n    \n    \n    \n    \n    使用get中文参数乱码问题\n    ### 原因\n    中文浏览器中默认使用的是gbk2312编码\n    \n    ### 解决方法\n    \n\n/\\*\\* \\* 解决get参数中带中文的乱码问题 * @param $keywords 传入的关键字 * @return string */ function decodeToUtf($keywords) { $keywords = mb\\_convert\\_encoding($keywords, 'UTF-8','GB2312,UTF-8'); return $keywords; }\n\n    \n\n$keywords = I('keywords'); $keywords = decodeToUtf($keywords); $page = new Page($count,self::$perPage); $page->parameter = 'keywords=' . $keywords; ```","slug":"thinkphp入门基础","published":1,"updated":"2019-07-24T01:34:35.226Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5od002j9ka4g9x9hjzw","content":"<h3 id=\"URL\"><a href=\"#URL\" class=\"headerlink\" title=\"URL\"></a>URL</h3><h3 id=\"配置URL伪静态\"><a href=\"#配置URL伪静态\" class=\"headerlink\" title=\"配置URL伪静态\"></a>配置URL伪静态</h3><p>3.1版本默认支持.html,.shtml,.xml,.pdf伪静态<br>在配置文件中配置[是在项目下的配置文件./App/Conf/config.php]</p>\n<pre><code>&apos;URL_HTML_SUFFIX&apos;=&gt;&apos;html|shmtl|xml&apos; // 多个用 | 分割</code></pre><h3 id=\"配置URL路由\"><a href=\"#配置URL路由\" class=\"headerlink\" title=\"配置URL路由\"></a>配置URL路由</h3><p>基本规则</p>\n<blockquote>\n<p>一、规则路由<br>格式1：’路由规则’=&gt;’[分组/模块/操作]?额外参数1=值1&amp;额外参数2=值2…’<br>格式2：’路由规则’=&gt;array(‘[分组/模块/操作]‘,’额外参数1=值1&amp;额外参数2=值2…’)<br>格式3：’路由规则’=&gt;’外部地址’<br>格式4：’路由规则’=&gt;array(‘外部地址’,’重定向代码’)<br>注意事项：<br>路由规则中如果以“:”开头，表示动态变量，否则为静态地址<br>格式2的额外参数可以传入数组或者字符串<br>外部地址中如果要引用动态变量， 采用 :1、:2 的方式<br>路由规则支持变量的数字约束定义，例如：’news/:id\\d’=&gt;’News/read’<br>规则路由可以支持 全动态和动静结合定义，例如’:user/blog/:id’=&gt;’Home/Blog/user’<br>路由规则非数字变量支持排除，例如 ‘news/:cate^add|edit|delete’=&gt;’News/category’<br>路由规则中的静态地址部分不区分大小写</p>\n</blockquote>\n<p>配置文件开启路由</p>\n<pre><code>&apos;URL_ROUTER_ON&apos;   =&gt; true, //开启路由\n&apos;URL_ROUTE_RULES&apos; =&gt; array( //定义路由规则\n    &apos;news/:year/:month/:day&apos; =&gt; array(&apos;News/archive&apos;, &apos;status=1&apos;),\n    &apos;news/:id&apos;               =&gt; &apos;News/read&apos;,\n    &apos;news/read/:id&apos;          =&gt; &apos;/news/:1&apos;,\n ),</code></pre><blockquote>\n<p><code>http://serverName/index.php/news/2012/01/08</code>匹配第一条路由<br>也可以写成<code>&#39;news/:year/:month/:day/&#39;=&gt;&#39;News/archive?status=1&#39;,</code> <code>http://serverName/index.php/news/8</code>匹配第二条路由 第三条用于url地址迁移，重定向使用</p>\n</blockquote>\n<h3 id=\"正则路由\"><a href=\"#正则路由\" class=\"headerlink\" title=\"正则路由\"></a>正则路由</h3><blockquote>\n<p>正则路由可以实现更加复杂的路由定义，支持的定义格式如下：<br>格式1：’路由正则’=&gt;’[分组/模块/操作]?参数1=值1&amp;参数2=值2…’<br>格式2：’路由正则’=&gt;array(‘[分组/模块/操作]‘,’参数1=值1&amp;参数2=值2…’)<br>格式3：’路由正则’=&gt;’外部地址’<br>格式4：’路由正则’=&gt;array(‘外部地址’,’重定向代码’)</p>\n</blockquote>\n<p>注意事项：<br>正则路由规则必须以“/”开始和结束<br>格式2的参数可以传入数组或者字符串<br>参数值和外部地址中可以用动态变量 采用 :1、 :2 的方式<br>下面是正则路由的定义示例：</p>\n<pre><code>&apos;URL_ROUTER_ON&apos;   =&gt; true, //开启路由\n &apos;URL_ROUTE_RULES&apos; =&gt; array( //定义路由规则\n    &apos;/^blog\\/(\\d+)$/&apos;        =&gt; &apos;Blog/read?id=:1&apos;,\n    &apos;/^blog\\/(\\d+)\\/(\\d+)$/&apos; =&gt; &apos;Blog/achive?year=:1&amp;month=:2&apos;,\n    &apos;/^blog\\/(\\d+)_(\\d+)$/&apos;  =&gt; &apos;blog.php?id=:1&amp;page=:2&apos;,\n ),\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    ### URL区分大小写</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">&apos;URL\\_CASE\\_INSENSITIVE&apos; =&gt;true, // 不区分 &apos;URL\\_CASE\\_INSENSITIVE&apos; =&gt;false, // 区分</span><br><span class=\"line\"></span><br><span class=\"line\">    ### 缓存</span><br><span class=\"line\">    ### 静态缓存</span><br><span class=\"line\">    开启静态缓存[是在分组下的配置文件./App/Moduels/Index/Conf/config.php]  </span><br><span class=\"line\">    和静态缓存相关的配置参数包括：  </span><br><span class=\"line\">    HTML_CACHE_ON 是否开启静态缓存功能  </span><br><span class=\"line\">    HTML_FILE_SUFFIX 静态文件后缀 惯例配置的值是 .html  </span><br><span class=\"line\">    HTML_CACHE_TIME 默认的静态缓存有效期 默认60秒 可以在静态规则定义覆盖  </span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">&apos;HTML\\_CACHE\\_ON&apos;=&gt;true, &apos;HTML\\_CACHE\\_RULES&apos;=&gt; array( &apos;ActionName&apos; =&gt; array(&apos;静态规则&apos;, &apos;静态缓存有效期&apos;, &apos;附加规则&apos;), &apos;ModuleName(小写)&apos; =&gt; array(&apos;静态规则&apos;, &apos;静态缓存有效期&apos;, &apos;附加规则&apos;), &apos;ModuleName(小写):ActionName&apos; =&gt; array(&apos;静态规则&apos;, &apos;静态缓存有效期&apos;, &apos;附加规则&apos;), &apos;*&apos; =&gt; array(&apos;静态规则&apos;, &apos;静态缓存有效期&apos;, &apos;附加规则&apos;), &apos;Show:index&apos; =&gt; array(&apos;&#123;:module&#125;_&#123;:action&#125;_&#123;id&#125;&apos;, 100),</span><br><span class=\"line\"></span><br><span class=\"line\">    所有控制器下read方法缓存，其中，&#123;id&#125; 表示取$_GET[&apos;id&apos;] 为静态缓存文件名，第二个参数表示缓存60秒</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">&apos;read&apos;=&gt;array(&apos;&#123;id&#125;&apos;,&apos;60&apos;)</span><br><span class=\"line\"></span><br><span class=\"line\">    User控制器下所有方法缓存，其中，&#123;:action&#125; 表示当前的操作名称</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">&apos;user:&apos;=&gt;array(&apos;User/&#123;:action&#125;_&#123;id&#125;&apos;,&apos;600&apos;)</span><br><span class=\"line\"></span><br><span class=\"line\">    Blog控制器下read方法缓存</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">&apos;blog:read&apos;=&gt;array(&apos;&#123;id&#125;&apos;,0)</span><br><span class=\"line\"></span><br><span class=\"line\">    全局缓存</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">&apos;*&apos;=&gt;array(&apos;&#123;$\\_SERVER.REQUEST\\_URI|md5&#125;&apos;),</span><br><span class=\"line\"></span><br><span class=\"line\">    静态规则  </span><br><span class=\"line\">    1.  使用系统变量 包括 _GET _REQUEST _SERVER _SESSION _COOKIE</span><br><span class=\"line\">    &gt; &#123;$_×××|function&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    2.  使用框架特定的变量</span><br><span class=\"line\">    &gt; &#123;:app&#125;、&#123;:group&#125; 、&#123;:module&#125; 和&#123;:action&#125; 分别表示当前项目名、分组名、模块名和操作名</span><br><span class=\"line\">    </span><br><span class=\"line\">    3.  使用_GET变量</span><br><span class=\"line\">    &gt; &#123;var|function&#125;    也就是说 &#123;id&#125; 其实等效于 &#123;$_GET.id&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    4.  直接使用函数</span><br><span class=\"line\">    &gt; &#123;|function&#125;   例如：&#123;|time&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    5.  支持混合定义</span><br><span class=\"line\">    &gt; &apos;&#123;id&#125;,&#123;name|md5&#125;&apos;   </span><br><span class=\"line\">    在&#123;&#125;之外的字符作为字符串对待，如果包含有”/”，会自动创建目录。  </span><br><span class=\"line\">    例如，定义下面的静态规则：  </span><br><span class=\"line\">    &#123;:module&#125;/&#123;:action&#125;_&#123;id&#125;  </span><br><span class=\"line\">    则会在静态目录下面创建模块名称的子目录，然后写入操作名_id.shtml 文件。    </span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    使用get中文参数乱码问题</span><br><span class=\"line\">    ### 原因</span><br><span class=\"line\">    中文浏览器中默认使用的是gbk2312编码</span><br><span class=\"line\">    </span><br><span class=\"line\">    ### 解决方法</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">/\\*\\* \\* 解决get参数中带中文的乱码问题 * @param $keywords 传入的关键字 * @return string */ function decodeToUtf($keywords) &#123; $keywords = mb\\_convert\\_encoding($keywords, &apos;UTF-8&apos;,&apos;GB2312,UTF-8&apos;); return $keywords; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">$keywords = I(&apos;keywords&apos;); $keywords = decodeToUtf($keywords); $page = new Page($count,self::$perPage); $page-&gt;parameter = &apos;keywords=&apos; . $keywords;</span><br></pre></td></tr></table></figure></code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"URL\"><a href=\"#URL\" class=\"headerlink\" title=\"URL\"></a>URL</h3><h3 id=\"配置URL伪静态\"><a href=\"#配置URL伪静态\" class=\"headerlink\" title=\"配置URL伪静态\"></a>配置URL伪静态</h3><p>3.1版本默认支持.html,.shtml,.xml,.pdf伪静态<br>在配置文件中配置[是在项目下的配置文件./App/Conf/config.php]</p>\n<pre><code>&apos;URL_HTML_SUFFIX&apos;=&gt;&apos;html|shmtl|xml&apos; // 多个用 | 分割</code></pre><h3 id=\"配置URL路由\"><a href=\"#配置URL路由\" class=\"headerlink\" title=\"配置URL路由\"></a>配置URL路由</h3><p>基本规则</p>\n<blockquote>\n<p>一、规则路由<br>格式1：’路由规则’=&gt;’[分组/模块/操作]?额外参数1=值1&amp;额外参数2=值2…’<br>格式2：’路由规则’=&gt;array(‘[分组/模块/操作]‘,’额外参数1=值1&amp;额外参数2=值2…’)<br>格式3：’路由规则’=&gt;’外部地址’<br>格式4：’路由规则’=&gt;array(‘外部地址’,’重定向代码’)<br>注意事项：<br>路由规则中如果以“:”开头，表示动态变量，否则为静态地址<br>格式2的额外参数可以传入数组或者字符串<br>外部地址中如果要引用动态变量， 采用 :1、:2 的方式<br>路由规则支持变量的数字约束定义，例如：’news/:id\\d’=&gt;’News/read’<br>规则路由可以支持 全动态和动静结合定义，例如’:user/blog/:id’=&gt;’Home/Blog/user’<br>路由规则非数字变量支持排除，例如 ‘news/:cate^add|edit|delete’=&gt;’News/category’<br>路由规则中的静态地址部分不区分大小写</p>\n</blockquote>\n<p>配置文件开启路由</p>\n<pre><code>&apos;URL_ROUTER_ON&apos;   =&gt; true, //开启路由\n&apos;URL_ROUTE_RULES&apos; =&gt; array( //定义路由规则\n    &apos;news/:year/:month/:day&apos; =&gt; array(&apos;News/archive&apos;, &apos;status=1&apos;),\n    &apos;news/:id&apos;               =&gt; &apos;News/read&apos;,\n    &apos;news/read/:id&apos;          =&gt; &apos;/news/:1&apos;,\n ),</code></pre><blockquote>\n<p><code>http://serverName/index.php/news/2012/01/08</code>匹配第一条路由<br>也可以写成<code>&#39;news/:year/:month/:day/&#39;=&gt;&#39;News/archive?status=1&#39;,</code> <code>http://serverName/index.php/news/8</code>匹配第二条路由 第三条用于url地址迁移，重定向使用</p>\n</blockquote>\n<h3 id=\"正则路由\"><a href=\"#正则路由\" class=\"headerlink\" title=\"正则路由\"></a>正则路由</h3><blockquote>\n<p>正则路由可以实现更加复杂的路由定义，支持的定义格式如下：<br>格式1：’路由正则’=&gt;’[分组/模块/操作]?参数1=值1&amp;参数2=值2…’<br>格式2：’路由正则’=&gt;array(‘[分组/模块/操作]‘,’参数1=值1&amp;参数2=值2…’)<br>格式3：’路由正则’=&gt;’外部地址’<br>格式4：’路由正则’=&gt;array(‘外部地址’,’重定向代码’)</p>\n</blockquote>\n<p>注意事项：<br>正则路由规则必须以“/”开始和结束<br>格式2的参数可以传入数组或者字符串<br>参数值和外部地址中可以用动态变量 采用 :1、 :2 的方式<br>下面是正则路由的定义示例：</p>\n<pre><code>&apos;URL_ROUTER_ON&apos;   =&gt; true, //开启路由\n &apos;URL_ROUTE_RULES&apos; =&gt; array( //定义路由规则\n    &apos;/^blog\\/(\\d+)$/&apos;        =&gt; &apos;Blog/read?id=:1&apos;,\n    &apos;/^blog\\/(\\d+)\\/(\\d+)$/&apos; =&gt; &apos;Blog/achive?year=:1&amp;month=:2&apos;,\n    &apos;/^blog\\/(\\d+)_(\\d+)$/&apos;  =&gt; &apos;blog.php?id=:1&amp;page=:2&apos;,\n ),\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    ### URL区分大小写</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">&apos;URL\\_CASE\\_INSENSITIVE&apos; =&gt;true, // 不区分 &apos;URL\\_CASE\\_INSENSITIVE&apos; =&gt;false, // 区分</span><br><span class=\"line\"></span><br><span class=\"line\">    ### 缓存</span><br><span class=\"line\">    ### 静态缓存</span><br><span class=\"line\">    开启静态缓存[是在分组下的配置文件./App/Moduels/Index/Conf/config.php]  </span><br><span class=\"line\">    和静态缓存相关的配置参数包括：  </span><br><span class=\"line\">    HTML_CACHE_ON 是否开启静态缓存功能  </span><br><span class=\"line\">    HTML_FILE_SUFFIX 静态文件后缀 惯例配置的值是 .html  </span><br><span class=\"line\">    HTML_CACHE_TIME 默认的静态缓存有效期 默认60秒 可以在静态规则定义覆盖  </span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">&apos;HTML\\_CACHE\\_ON&apos;=&gt;true, &apos;HTML\\_CACHE\\_RULES&apos;=&gt; array( &apos;ActionName&apos; =&gt; array(&apos;静态规则&apos;, &apos;静态缓存有效期&apos;, &apos;附加规则&apos;), &apos;ModuleName(小写)&apos; =&gt; array(&apos;静态规则&apos;, &apos;静态缓存有效期&apos;, &apos;附加规则&apos;), &apos;ModuleName(小写):ActionName&apos; =&gt; array(&apos;静态规则&apos;, &apos;静态缓存有效期&apos;, &apos;附加规则&apos;), &apos;*&apos; =&gt; array(&apos;静态规则&apos;, &apos;静态缓存有效期&apos;, &apos;附加规则&apos;), &apos;Show:index&apos; =&gt; array(&apos;&#123;:module&#125;_&#123;:action&#125;_&#123;id&#125;&apos;, 100),</span><br><span class=\"line\"></span><br><span class=\"line\">    所有控制器下read方法缓存，其中，&#123;id&#125; 表示取$_GET[&apos;id&apos;] 为静态缓存文件名，第二个参数表示缓存60秒</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">&apos;read&apos;=&gt;array(&apos;&#123;id&#125;&apos;,&apos;60&apos;)</span><br><span class=\"line\"></span><br><span class=\"line\">    User控制器下所有方法缓存，其中，&#123;:action&#125; 表示当前的操作名称</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">&apos;user:&apos;=&gt;array(&apos;User/&#123;:action&#125;_&#123;id&#125;&apos;,&apos;600&apos;)</span><br><span class=\"line\"></span><br><span class=\"line\">    Blog控制器下read方法缓存</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">&apos;blog:read&apos;=&gt;array(&apos;&#123;id&#125;&apos;,0)</span><br><span class=\"line\"></span><br><span class=\"line\">    全局缓存</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">&apos;*&apos;=&gt;array(&apos;&#123;$\\_SERVER.REQUEST\\_URI|md5&#125;&apos;),</span><br><span class=\"line\"></span><br><span class=\"line\">    静态规则  </span><br><span class=\"line\">    1.  使用系统变量 包括 _GET _REQUEST _SERVER _SESSION _COOKIE</span><br><span class=\"line\">    &gt; &#123;$_×××|function&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    2.  使用框架特定的变量</span><br><span class=\"line\">    &gt; &#123;:app&#125;、&#123;:group&#125; 、&#123;:module&#125; 和&#123;:action&#125; 分别表示当前项目名、分组名、模块名和操作名</span><br><span class=\"line\">    </span><br><span class=\"line\">    3.  使用_GET变量</span><br><span class=\"line\">    &gt; &#123;var|function&#125;    也就是说 &#123;id&#125; 其实等效于 &#123;$_GET.id&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    4.  直接使用函数</span><br><span class=\"line\">    &gt; &#123;|function&#125;   例如：&#123;|time&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    5.  支持混合定义</span><br><span class=\"line\">    &gt; &apos;&#123;id&#125;,&#123;name|md5&#125;&apos;   </span><br><span class=\"line\">    在&#123;&#125;之外的字符作为字符串对待，如果包含有”/”，会自动创建目录。  </span><br><span class=\"line\">    例如，定义下面的静态规则：  </span><br><span class=\"line\">    &#123;:module&#125;/&#123;:action&#125;_&#123;id&#125;  </span><br><span class=\"line\">    则会在静态目录下面创建模块名称的子目录，然后写入操作名_id.shtml 文件。    </span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    使用get中文参数乱码问题</span><br><span class=\"line\">    ### 原因</span><br><span class=\"line\">    中文浏览器中默认使用的是gbk2312编码</span><br><span class=\"line\">    </span><br><span class=\"line\">    ### 解决方法</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">/\\*\\* \\* 解决get参数中带中文的乱码问题 * @param $keywords 传入的关键字 * @return string */ function decodeToUtf($keywords) &#123; $keywords = mb\\_convert\\_encoding($keywords, &apos;UTF-8&apos;,&apos;GB2312,UTF-8&apos;); return $keywords; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">$keywords = I(&apos;keywords&apos;); $keywords = decodeToUtf($keywords); $page = new Page($count,self::$perPage); $page-&gt;parameter = &apos;keywords=&apos; . $keywords;</span><br></pre></td></tr></table></figure></code></pre>"},{"title":"python将office word 转为html 并提取相关图片信息","url":"29.html","id":"29","comments":0,"date":"2016-11-09T02:10:01.000Z","_content":"\n### 需求\n\n工作需要将2000多格word文档中的图片提取出来，并改名为word文档名\n\n### 思路1\n\n> More exactly, a .docx document is a Zip archive in OpenXML format: you have first to uncompress it. I downloaded a sample (Google: some search term filetype:docx) and after unzipping I found some folders. The word folder contains the document itself, in file document.xml.\n\n于是使用unzip模块\n\n    import zipfile\n    \n\n但是报错\n\n    BadZipfile: File is not a zip file\n    \n\n检查发现同事提供的office word文件结尾为.doc,  \n于是使用7-zip进行提取发现确实报错\n\n> 文件末端错误\n\n尝试用本机office2013打开并另存为word文档.docx  \n再次使用7-zip进行提取，成功，会生成以下一个文件夹\n\n> _rels文件夹  \n> docProps文件夹  \n> word文件夹  \n> \\[Content_Types\\].xml文件\n\n其中\\\\word\\\\media文件夹下就有我需要的图片信息  \n既然需要更改文件后缀，那么就有另一个思路。\n\n### 思路2\n\n> 通过win32com.clientm将文件改为html文件，会生成类似的文件夹\n\n核心代码\n\n    # -*- encoding: utf8 -*-\n    \n    import win32com\n    from win32com.client import constants\n    \n    # 打开初始化word文档\n    w = win32com.client.Dispatch('Word.Application')\n    w.Visible = 0\n    w.DisplayAlerts = 0\n    doc = w.Documents.Open(source_file)  # 打开文件\n    doc.SaveAs(target_fold + '/' + file_number + '.htm', 8)  # 更名为htm文件\n    doc.Close()\n    w.Quit()\n    \n    \n\n另存为其他规格只需要将参数8修改即可\n\n> wdFormatDocument = 0  \n> wdFormatDocument97 = 0  \n> wdFormatDocumentDefault = 16  \n> wdFormatDOSText = 4  \n> wdFormatDOSTextLineBreaks = 5  \n> wdFormatEncodedText = 7  \n> wdFormatFilteredHTML = 10  \n> wdFormatFlatXML = 19  \n> wdFormatFlatXMLMacroEnabled = 20  \n> wdFormatFlatXMLTemplate = 21  \n> wdFormatFlatXMLTemplateMacroEnabled = 22  \n> wdFormatHTML = 8  \n> wdFormatPDF = 17  \n> wdFormatRTF = 6  \n> wdFormatTemplate = 1  \n> wdFormatTemplate97 = 1  \n> wdFormatText = 2  \n> wdFormatTextLineBreaks = 3  \n> wdFormatUnicodeText = 7  \n> wdFormatWebArchive = 9  \n> wdFormatXML = 11  \n> wdFormatXMLDocument = 12  \n> wdFormatXMLDocumentMacroEnabled = 13  \n> wdFormatXMLTemplate = 14  \n> wdFormatXMLTemplateMacroEnabled = 15  \n> wdFormatXPS = 18\n\n最后脚本\n\n    # -*- encoding: utf8 -*-\n    \n    import win32com\n    import os\n    import xlrd\n    import shutil\n    from win32com.client import constants\n    \n    # 从excel表格中导入数据并组成字典\n    XlsFile = 'default.xlsx'                  # 需要的数据\n    data = xlrd.open_workbook(XlsFile)\n    table = data.sheets()[0]\n    nrows = table.nrows\n    \n    # 获取文件名列表\n    number_list = []\n    for i in range(1, nrows):\n        number_list.append(table.row_values(i)[0])\n    \n    # 打开初始化word文档\n    w = win32com.client.Dispatch('Word.Application')\n    w.Visible = 0\n    w.DisplayAlerts = 0\n    \n    \n    # 遍历文件夹并将文件剪贴到新的文件夹中\n    source_fold = os.path.split(os.path.realpath(__file__))[0] + '/' + 'WordFile'\n    target_fold = os.path.split(os.path.realpath(__file__))[0] + '/' + 'NewFile'\n    img_fold = os.path.split(os.path.realpath(__file__))[0] + '/' + 'Img'\n    word_list = os.listdir(source_fold)\n    for file_name in word_list:\n        # 根据货号在列表中查找\n        try:\n            file_number = file_name[0:10]\n            if file_number in number_list:\n                print(file_name + '是需要的文件.')\n                source_file = source_fold + '/' + file_name\n                doc = w.Documents.Open(source_file)  # 打开文件\n                doc.SaveAs(target_fold + '/' + file_number + '.htm', 8)  # 更名为htm文件\n                doc.Close()\n                od_img = target_fold + '/' + file_number + '.files' + '/' + 'image003.jpg'\n                shutil.copyfile(od_img, img_fold + '/' + file_number + '.jpg')  # 复制新的文件\n                number_list.remove(file_number)  # 从excel列表中删除此元素防止重复选取\n        except Exception, e:\n            print(file_name)\n            print e\n    w.Quit()\n    \n    try:\n        f = open(\"php.json\", \"w\")\n        print >>f, number_list  # 最后将剩下的元素打印到文件中\n    except Exception, e:\n        print '写入php.json失败'","source":"_posts/python将office word 转为html 并提取相关图片信息.md","raw":"---\ntitle: python将office word 转为html 并提取相关图片信息\ntags:\n  - python\nurl: 29.html\nid: 29\ncomments: false\ncategories:\n  - 办公\n  - 运维\ndate: 2016-11-09 10:10:01\n---\n\n### 需求\n\n工作需要将2000多格word文档中的图片提取出来，并改名为word文档名\n\n### 思路1\n\n> More exactly, a .docx document is a Zip archive in OpenXML format: you have first to uncompress it. I downloaded a sample (Google: some search term filetype:docx) and after unzipping I found some folders. The word folder contains the document itself, in file document.xml.\n\n于是使用unzip模块\n\n    import zipfile\n    \n\n但是报错\n\n    BadZipfile: File is not a zip file\n    \n\n检查发现同事提供的office word文件结尾为.doc,  \n于是使用7-zip进行提取发现确实报错\n\n> 文件末端错误\n\n尝试用本机office2013打开并另存为word文档.docx  \n再次使用7-zip进行提取，成功，会生成以下一个文件夹\n\n> _rels文件夹  \n> docProps文件夹  \n> word文件夹  \n> \\[Content_Types\\].xml文件\n\n其中\\\\word\\\\media文件夹下就有我需要的图片信息  \n既然需要更改文件后缀，那么就有另一个思路。\n\n### 思路2\n\n> 通过win32com.clientm将文件改为html文件，会生成类似的文件夹\n\n核心代码\n\n    # -*- encoding: utf8 -*-\n    \n    import win32com\n    from win32com.client import constants\n    \n    # 打开初始化word文档\n    w = win32com.client.Dispatch('Word.Application')\n    w.Visible = 0\n    w.DisplayAlerts = 0\n    doc = w.Documents.Open(source_file)  # 打开文件\n    doc.SaveAs(target_fold + '/' + file_number + '.htm', 8)  # 更名为htm文件\n    doc.Close()\n    w.Quit()\n    \n    \n\n另存为其他规格只需要将参数8修改即可\n\n> wdFormatDocument = 0  \n> wdFormatDocument97 = 0  \n> wdFormatDocumentDefault = 16  \n> wdFormatDOSText = 4  \n> wdFormatDOSTextLineBreaks = 5  \n> wdFormatEncodedText = 7  \n> wdFormatFilteredHTML = 10  \n> wdFormatFlatXML = 19  \n> wdFormatFlatXMLMacroEnabled = 20  \n> wdFormatFlatXMLTemplate = 21  \n> wdFormatFlatXMLTemplateMacroEnabled = 22  \n> wdFormatHTML = 8  \n> wdFormatPDF = 17  \n> wdFormatRTF = 6  \n> wdFormatTemplate = 1  \n> wdFormatTemplate97 = 1  \n> wdFormatText = 2  \n> wdFormatTextLineBreaks = 3  \n> wdFormatUnicodeText = 7  \n> wdFormatWebArchive = 9  \n> wdFormatXML = 11  \n> wdFormatXMLDocument = 12  \n> wdFormatXMLDocumentMacroEnabled = 13  \n> wdFormatXMLTemplate = 14  \n> wdFormatXMLTemplateMacroEnabled = 15  \n> wdFormatXPS = 18\n\n最后脚本\n\n    # -*- encoding: utf8 -*-\n    \n    import win32com\n    import os\n    import xlrd\n    import shutil\n    from win32com.client import constants\n    \n    # 从excel表格中导入数据并组成字典\n    XlsFile = 'default.xlsx'                  # 需要的数据\n    data = xlrd.open_workbook(XlsFile)\n    table = data.sheets()[0]\n    nrows = table.nrows\n    \n    # 获取文件名列表\n    number_list = []\n    for i in range(1, nrows):\n        number_list.append(table.row_values(i)[0])\n    \n    # 打开初始化word文档\n    w = win32com.client.Dispatch('Word.Application')\n    w.Visible = 0\n    w.DisplayAlerts = 0\n    \n    \n    # 遍历文件夹并将文件剪贴到新的文件夹中\n    source_fold = os.path.split(os.path.realpath(__file__))[0] + '/' + 'WordFile'\n    target_fold = os.path.split(os.path.realpath(__file__))[0] + '/' + 'NewFile'\n    img_fold = os.path.split(os.path.realpath(__file__))[0] + '/' + 'Img'\n    word_list = os.listdir(source_fold)\n    for file_name in word_list:\n        # 根据货号在列表中查找\n        try:\n            file_number = file_name[0:10]\n            if file_number in number_list:\n                print(file_name + '是需要的文件.')\n                source_file = source_fold + '/' + file_name\n                doc = w.Documents.Open(source_file)  # 打开文件\n                doc.SaveAs(target_fold + '/' + file_number + '.htm', 8)  # 更名为htm文件\n                doc.Close()\n                od_img = target_fold + '/' + file_number + '.files' + '/' + 'image003.jpg'\n                shutil.copyfile(od_img, img_fold + '/' + file_number + '.jpg')  # 复制新的文件\n                number_list.remove(file_number)  # 从excel列表中删除此元素防止重复选取\n        except Exception, e:\n            print(file_name)\n            print e\n    w.Quit()\n    \n    try:\n        f = open(\"php.json\", \"w\")\n        print >>f, number_list  # 最后将剩下的元素打印到文件中\n    except Exception, e:\n        print '写入php.json失败'","slug":"python将office word 转为html 并提取相关图片信息","published":1,"updated":"2019-07-24T01:32:50.250Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5oe002m9ka4tmnb38wv","content":"<h3 id=\"需求\"><a href=\"#需求\" class=\"headerlink\" title=\"需求\"></a>需求</h3><p>工作需要将2000多格word文档中的图片提取出来，并改名为word文档名</p>\n<h3 id=\"思路1\"><a href=\"#思路1\" class=\"headerlink\" title=\"思路1\"></a>思路1</h3><blockquote>\n<p>More exactly, a .docx document is a Zip archive in OpenXML format: you have first to uncompress it. I downloaded a sample (Google: some search term filetype:docx) and after unzipping I found some folders. The word folder contains the document itself, in file document.xml.</p>\n</blockquote>\n<p>于是使用unzip模块</p>\n<pre><code>import zipfile</code></pre><p>但是报错</p>\n<pre><code>BadZipfile: File is not a zip file</code></pre><p>检查发现同事提供的office word文件结尾为.doc,<br>于是使用7-zip进行提取发现确实报错</p>\n<blockquote>\n<p>文件末端错误</p>\n</blockquote>\n<p>尝试用本机office2013打开并另存为word文档.docx<br>再次使用7-zip进行提取，成功，会生成以下一个文件夹</p>\n<blockquote>\n<p>_rels文件夹<br>docProps文件夹<br>word文件夹<br>[Content_Types].xml文件</p>\n</blockquote>\n<p>其中\\word\\media文件夹下就有我需要的图片信息<br>既然需要更改文件后缀，那么就有另一个思路。</p>\n<h3 id=\"思路2\"><a href=\"#思路2\" class=\"headerlink\" title=\"思路2\"></a>思路2</h3><blockquote>\n<p>通过win32com.clientm将文件改为html文件，会生成类似的文件夹</p>\n</blockquote>\n<p>核心代码</p>\n<pre><code># -*- encoding: utf8 -*-\n\nimport win32com\nfrom win32com.client import constants\n\n# 打开初始化word文档\nw = win32com.client.Dispatch(&apos;Word.Application&apos;)\nw.Visible = 0\nw.DisplayAlerts = 0\ndoc = w.Documents.Open(source_file)  # 打开文件\ndoc.SaveAs(target_fold + &apos;/&apos; + file_number + &apos;.htm&apos;, 8)  # 更名为htm文件\ndoc.Close()\nw.Quit()</code></pre><p>另存为其他规格只需要将参数8修改即可</p>\n<blockquote>\n<p>wdFormatDocument = 0<br>wdFormatDocument97 = 0<br>wdFormatDocumentDefault = 16<br>wdFormatDOSText = 4<br>wdFormatDOSTextLineBreaks = 5<br>wdFormatEncodedText = 7<br>wdFormatFilteredHTML = 10<br>wdFormatFlatXML = 19<br>wdFormatFlatXMLMacroEnabled = 20<br>wdFormatFlatXMLTemplate = 21<br>wdFormatFlatXMLTemplateMacroEnabled = 22<br>wdFormatHTML = 8<br>wdFormatPDF = 17<br>wdFormatRTF = 6<br>wdFormatTemplate = 1<br>wdFormatTemplate97 = 1<br>wdFormatText = 2<br>wdFormatTextLineBreaks = 3<br>wdFormatUnicodeText = 7<br>wdFormatWebArchive = 9<br>wdFormatXML = 11<br>wdFormatXMLDocument = 12<br>wdFormatXMLDocumentMacroEnabled = 13<br>wdFormatXMLTemplate = 14<br>wdFormatXMLTemplateMacroEnabled = 15<br>wdFormatXPS = 18</p>\n</blockquote>\n<p>最后脚本</p>\n<pre><code># -*- encoding: utf8 -*-\n\nimport win32com\nimport os\nimport xlrd\nimport shutil\nfrom win32com.client import constants\n\n# 从excel表格中导入数据并组成字典\nXlsFile = &apos;default.xlsx&apos;                  # 需要的数据\ndata = xlrd.open_workbook(XlsFile)\ntable = data.sheets()[0]\nnrows = table.nrows\n\n# 获取文件名列表\nnumber_list = []\nfor i in range(1, nrows):\n    number_list.append(table.row_values(i)[0])\n\n# 打开初始化word文档\nw = win32com.client.Dispatch(&apos;Word.Application&apos;)\nw.Visible = 0\nw.DisplayAlerts = 0\n\n\n# 遍历文件夹并将文件剪贴到新的文件夹中\nsource_fold = os.path.split(os.path.realpath(__file__))[0] + &apos;/&apos; + &apos;WordFile&apos;\ntarget_fold = os.path.split(os.path.realpath(__file__))[0] + &apos;/&apos; + &apos;NewFile&apos;\nimg_fold = os.path.split(os.path.realpath(__file__))[0] + &apos;/&apos; + &apos;Img&apos;\nword_list = os.listdir(source_fold)\nfor file_name in word_list:\n    # 根据货号在列表中查找\n    try:\n        file_number = file_name[0:10]\n        if file_number in number_list:\n            print(file_name + &apos;是需要的文件.&apos;)\n            source_file = source_fold + &apos;/&apos; + file_name\n            doc = w.Documents.Open(source_file)  # 打开文件\n            doc.SaveAs(target_fold + &apos;/&apos; + file_number + &apos;.htm&apos;, 8)  # 更名为htm文件\n            doc.Close()\n            od_img = target_fold + &apos;/&apos; + file_number + &apos;.files&apos; + &apos;/&apos; + &apos;image003.jpg&apos;\n            shutil.copyfile(od_img, img_fold + &apos;/&apos; + file_number + &apos;.jpg&apos;)  # 复制新的文件\n            number_list.remove(file_number)  # 从excel列表中删除此元素防止重复选取\n    except Exception, e:\n        print(file_name)\n        print e\nw.Quit()\n\ntry:\n    f = open(&quot;php.json&quot;, &quot;w&quot;)\n    print &gt;&gt;f, number_list  # 最后将剩下的元素打印到文件中\nexcept Exception, e:\n    print &apos;写入php.json失败&apos;</code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"需求\"><a href=\"#需求\" class=\"headerlink\" title=\"需求\"></a>需求</h3><p>工作需要将2000多格word文档中的图片提取出来，并改名为word文档名</p>\n<h3 id=\"思路1\"><a href=\"#思路1\" class=\"headerlink\" title=\"思路1\"></a>思路1</h3><blockquote>\n<p>More exactly, a .docx document is a Zip archive in OpenXML format: you have first to uncompress it. I downloaded a sample (Google: some search term filetype:docx) and after unzipping I found some folders. The word folder contains the document itself, in file document.xml.</p>\n</blockquote>\n<p>于是使用unzip模块</p>\n<pre><code>import zipfile</code></pre><p>但是报错</p>\n<pre><code>BadZipfile: File is not a zip file</code></pre><p>检查发现同事提供的office word文件结尾为.doc,<br>于是使用7-zip进行提取发现确实报错</p>\n<blockquote>\n<p>文件末端错误</p>\n</blockquote>\n<p>尝试用本机office2013打开并另存为word文档.docx<br>再次使用7-zip进行提取，成功，会生成以下一个文件夹</p>\n<blockquote>\n<p>_rels文件夹<br>docProps文件夹<br>word文件夹<br>[Content_Types].xml文件</p>\n</blockquote>\n<p>其中\\word\\media文件夹下就有我需要的图片信息<br>既然需要更改文件后缀，那么就有另一个思路。</p>\n<h3 id=\"思路2\"><a href=\"#思路2\" class=\"headerlink\" title=\"思路2\"></a>思路2</h3><blockquote>\n<p>通过win32com.clientm将文件改为html文件，会生成类似的文件夹</p>\n</blockquote>\n<p>核心代码</p>\n<pre><code># -*- encoding: utf8 -*-\n\nimport win32com\nfrom win32com.client import constants\n\n# 打开初始化word文档\nw = win32com.client.Dispatch(&apos;Word.Application&apos;)\nw.Visible = 0\nw.DisplayAlerts = 0\ndoc = w.Documents.Open(source_file)  # 打开文件\ndoc.SaveAs(target_fold + &apos;/&apos; + file_number + &apos;.htm&apos;, 8)  # 更名为htm文件\ndoc.Close()\nw.Quit()</code></pre><p>另存为其他规格只需要将参数8修改即可</p>\n<blockquote>\n<p>wdFormatDocument = 0<br>wdFormatDocument97 = 0<br>wdFormatDocumentDefault = 16<br>wdFormatDOSText = 4<br>wdFormatDOSTextLineBreaks = 5<br>wdFormatEncodedText = 7<br>wdFormatFilteredHTML = 10<br>wdFormatFlatXML = 19<br>wdFormatFlatXMLMacroEnabled = 20<br>wdFormatFlatXMLTemplate = 21<br>wdFormatFlatXMLTemplateMacroEnabled = 22<br>wdFormatHTML = 8<br>wdFormatPDF = 17<br>wdFormatRTF = 6<br>wdFormatTemplate = 1<br>wdFormatTemplate97 = 1<br>wdFormatText = 2<br>wdFormatTextLineBreaks = 3<br>wdFormatUnicodeText = 7<br>wdFormatWebArchive = 9<br>wdFormatXML = 11<br>wdFormatXMLDocument = 12<br>wdFormatXMLDocumentMacroEnabled = 13<br>wdFormatXMLTemplate = 14<br>wdFormatXMLTemplateMacroEnabled = 15<br>wdFormatXPS = 18</p>\n</blockquote>\n<p>最后脚本</p>\n<pre><code># -*- encoding: utf8 -*-\n\nimport win32com\nimport os\nimport xlrd\nimport shutil\nfrom win32com.client import constants\n\n# 从excel表格中导入数据并组成字典\nXlsFile = &apos;default.xlsx&apos;                  # 需要的数据\ndata = xlrd.open_workbook(XlsFile)\ntable = data.sheets()[0]\nnrows = table.nrows\n\n# 获取文件名列表\nnumber_list = []\nfor i in range(1, nrows):\n    number_list.append(table.row_values(i)[0])\n\n# 打开初始化word文档\nw = win32com.client.Dispatch(&apos;Word.Application&apos;)\nw.Visible = 0\nw.DisplayAlerts = 0\n\n\n# 遍历文件夹并将文件剪贴到新的文件夹中\nsource_fold = os.path.split(os.path.realpath(__file__))[0] + &apos;/&apos; + &apos;WordFile&apos;\ntarget_fold = os.path.split(os.path.realpath(__file__))[0] + &apos;/&apos; + &apos;NewFile&apos;\nimg_fold = os.path.split(os.path.realpath(__file__))[0] + &apos;/&apos; + &apos;Img&apos;\nword_list = os.listdir(source_fold)\nfor file_name in word_list:\n    # 根据货号在列表中查找\n    try:\n        file_number = file_name[0:10]\n        if file_number in number_list:\n            print(file_name + &apos;是需要的文件.&apos;)\n            source_file = source_fold + &apos;/&apos; + file_name\n            doc = w.Documents.Open(source_file)  # 打开文件\n            doc.SaveAs(target_fold + &apos;/&apos; + file_number + &apos;.htm&apos;, 8)  # 更名为htm文件\n            doc.Close()\n            od_img = target_fold + &apos;/&apos; + file_number + &apos;.files&apos; + &apos;/&apos; + &apos;image003.jpg&apos;\n            shutil.copyfile(od_img, img_fold + &apos;/&apos; + file_number + &apos;.jpg&apos;)  # 复制新的文件\n            number_list.remove(file_number)  # 从excel列表中删除此元素防止重复选取\n    except Exception, e:\n        print(file_name)\n        print e\nw.Quit()\n\ntry:\n    f = open(&quot;php.json&quot;, &quot;w&quot;)\n    print &gt;&gt;f, number_list  # 最后将剩下的元素打印到文件中\nexcept Exception, e:\n    print &apos;写入php.json失败&apos;</code></pre>"},{"title":"mysql入门基础","url":"42.html","id":"42","comments":0,"date":"2016-11-09T06:32:49.000Z","_content":"\n#### 安装mysql\n\n```shell\n// ubuntu16.04\nsudo apt-get install mysql-server\nsudo apt install mysql-client  # 服务器端不需要\nmysql_secure_installation\n```\n\n#### 查看mysql版本信息\n```shell\nmysql --version  \nmysql> show variables like '%version_%';\n```\n\n#### 数据库创建备份导入命令\n```sql\n// 创建数据库  \nCREATE DATABASE `test` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;  \n\n// 删除数据库  \n DROP DATABASE IF EXISTS `test`; \n\n// 创建表  \nCREATE TABLE test(name varchar(32) not null,password varchar(64) not null)DEFAULT charset=utf8;  \n\n### 重置自增字段\nALTER TABLE `tableName` AUTO_INCREMENT = 1; \n或者\ntruncate tableName; \n\n// 删除表\nDROP TABLE test;\n    \n// 删除表内容，保留表结构  \nmysql> TRUNCATE TABLE `tabel_name`;\n    \n// 删除表并重置主键，不会留下日志，相当于删除表并重建    \nTRUNCATE TABLE `animal_cell_attribute` \n```\n```shell\n// 导出一个数据库    \nmysqldump -u 用户名 -p 数据库名 > 导出的文件名.sql   \nmysqldump -u root -p uscnerp > uscnerp.sql    \nEnter password:  \n    \n// 导出一张表\nmysqldump -u 用户名 -p 数据库名 表名 > 导出的文件名.sql  \nmysqldump -u root -p animal animal_service > animal_service.sql\nEnter password: **********  \n    \n// 导出多个数据库\nmysqldump  -uroot -p --databases test mysql #空格分隔\n    \n// 导出到excel表格\nmysql   -uroot   -p   -e   \"select   *   from   test.table2 \"   >   d:a.xsl\n    \n```\n    \n```sql\n// 导入数据库  \n\nmysql>use 数据库  \nmysql>set names utf8; （先确认编码，如果不设置可能会出现乱码，注意不是UTF-8）   \nmysql>source d:\\wcnc_db.sql\n```\n    \n#### 查看表\n```sql\n// 查看表结构\nshow create table 表名;\n```\n\n\n#### 配置用户权限\n```sql\n# 重置root密码并查看所有用户权限\n mysql> use mysql;\nDatabase changed\nmysql> UPDATE user SET Password = PASSWORD('newpassword') WHERE user = 'root';\nQuery OK, 3 rows affected (0.02 sec)\nRows matched: 3  Changed: 3  Warnings: 0\n\nmysql> SELECT Host,User,Password FROM mysql.user;\n+-----------+--------+-------------------------------------------+\n| Host      | User   | Password                                  |\n+-----------+--------+-------------------------------------------+\n| localhost | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |\n| 127.0.0.1 | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |\n| ::1       | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |\n| localhost |        |                                           |\n| localhost | animal | *CC87B1E39E699B64E0B80741B5D1991BC5BE57AC |\n+-----------+--------+-------------------------------------------+\n5 rows in set (0.00 sec)\n\n// 查看全部用户\nSELECT DISTINCT CONCAT('User: ''',user,'''@''',host,''';') AS query FROM mysql.user;\n    \n\n// 创建用户\nCREATE USER username@localhost IDENTIFIED BY 'password';\n> username:用户名  \n> @localhost：表示用户只能在本地访问  \n> password:密码\n\n// 配置权限\nGRANT SELECT,INSERT,UPDATE ON database.* TO username@localhost IDENTIFIED BY 'password';  \nGRANT ALL PRIVILEGES ON *.* TO user;@localhost \n// GRANT 权限名称 ON 数据库.数据表 TO 用户名@访问地址 IDENTIFIED BY '密码';\n    \n// 刷新权限列表\nflush privileges;\n    \n// 配置备份用户权限\nCREATE USER 'backuper'@'localhost' IDENTIFIED BY 'PASSWORD';\nGRANT SELECT, RELOAD, PROCESS, SHOW DATABASES, SUPER, LOCK TABLES, REPLICATION CLIENT, SHOW VIEW, EVENT ON *.* TO 'backuper'@'localhost';\nFLUSH PRIVILEGES;\n\n// 开启慢查询日志\n```bash \nsudo vim /etc/my.cnf\n\n# slow_query_log\nslow_query_log=on\nslow-query-log-file=/var/log/mysql/slow.log # 保证此文件属于mysql用户，mysql组，并可写权限\nlong_query_time=1 # 超过1秒写入慢查询日志\nlog-queries-not-using-indexes\n    \n// 查看是否开启mysql慢查询日志\n>mysql show variables like \"slow_query_log\";\n\n// 设置密码过期时间\nSET GLOBAL default_password_lifetime = 0;  // 全局用户永不过期\nALTER USER 'root'@'localhost' PASSWORD EXPIRE NEVER;  // 单个用户用户过期\nALTER USER 'root'@'localhost' PASSWORD EXPIRE INTERVAL 90 DAY;  // 单个用户\n```\n\n\n#### window服务器下自动备份\n\n##### 编写脚本\n```bash\nrem *******************************Code Start*****************************\n@echo off\n    \nset \"Ymd=%date:~,4%%date:~5,2%%date:~8,2%\"\nmysqldump --opt -u root --password=abcdefg database > F:\\FTP\\BackupMysql\\database_%Ymd%.sql\n@echo on\nrem *******************************Code End*****************************\n```\n\n##### 定时任务  \n注意在操作中填写脚本并在起始于写入脚本所在盘符E:\\\n\n##### 删除mysql\n\n> 在服务里找到mysql服务，停止使用  \n> 控制面板中卸载mysql 注册表文件删除： HKEY\\_LOCAL\\_MACHINE/SYSTEM/ControlSet001/Services/Eventlog/Application/MySQL 目录删除; HKEY\\_LOCAL\\_MACHINE/SYSTEM/ControlSet002/Services/Eventlog/Application/MySQL 目录删除; HKEY\\_LOCAL\\_MACHINE/SYSTEM/CurrentControlSet/Services/Eventlog/Application/MySQL 目录删除; 在硬盘和注册表中搜索mysql并删除掉\n","source":"_posts/mysql入门基础.md","raw":"---\ntitle: mysql入门基础\ntags:\n  - mysql\nurl: 42.html\nid: 42\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-09 14:32:49\n---\n\n#### 安装mysql\n\n```shell\n// ubuntu16.04\nsudo apt-get install mysql-server\nsudo apt install mysql-client  # 服务器端不需要\nmysql_secure_installation\n```\n\n#### 查看mysql版本信息\n```shell\nmysql --version  \nmysql> show variables like '%version_%';\n```\n\n#### 数据库创建备份导入命令\n```sql\n// 创建数据库  \nCREATE DATABASE `test` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;  \n\n// 删除数据库  \n DROP DATABASE IF EXISTS `test`; \n\n// 创建表  \nCREATE TABLE test(name varchar(32) not null,password varchar(64) not null)DEFAULT charset=utf8;  \n\n### 重置自增字段\nALTER TABLE `tableName` AUTO_INCREMENT = 1; \n或者\ntruncate tableName; \n\n// 删除表\nDROP TABLE test;\n    \n// 删除表内容，保留表结构  \nmysql> TRUNCATE TABLE `tabel_name`;\n    \n// 删除表并重置主键，不会留下日志，相当于删除表并重建    \nTRUNCATE TABLE `animal_cell_attribute` \n```\n```shell\n// 导出一个数据库    \nmysqldump -u 用户名 -p 数据库名 > 导出的文件名.sql   \nmysqldump -u root -p uscnerp > uscnerp.sql    \nEnter password:  \n    \n// 导出一张表\nmysqldump -u 用户名 -p 数据库名 表名 > 导出的文件名.sql  \nmysqldump -u root -p animal animal_service > animal_service.sql\nEnter password: **********  \n    \n// 导出多个数据库\nmysqldump  -uroot -p --databases test mysql #空格分隔\n    \n// 导出到excel表格\nmysql   -uroot   -p   -e   \"select   *   from   test.table2 \"   >   d:a.xsl\n    \n```\n    \n```sql\n// 导入数据库  \n\nmysql>use 数据库  \nmysql>set names utf8; （先确认编码，如果不设置可能会出现乱码，注意不是UTF-8）   \nmysql>source d:\\wcnc_db.sql\n```\n    \n#### 查看表\n```sql\n// 查看表结构\nshow create table 表名;\n```\n\n\n#### 配置用户权限\n```sql\n# 重置root密码并查看所有用户权限\n mysql> use mysql;\nDatabase changed\nmysql> UPDATE user SET Password = PASSWORD('newpassword') WHERE user = 'root';\nQuery OK, 3 rows affected (0.02 sec)\nRows matched: 3  Changed: 3  Warnings: 0\n\nmysql> SELECT Host,User,Password FROM mysql.user;\n+-----------+--------+-------------------------------------------+\n| Host      | User   | Password                                  |\n+-----------+--------+-------------------------------------------+\n| localhost | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |\n| 127.0.0.1 | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |\n| ::1       | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |\n| localhost |        |                                           |\n| localhost | animal | *CC87B1E39E699B64E0B80741B5D1991BC5BE57AC |\n+-----------+--------+-------------------------------------------+\n5 rows in set (0.00 sec)\n\n// 查看全部用户\nSELECT DISTINCT CONCAT('User: ''',user,'''@''',host,''';') AS query FROM mysql.user;\n    \n\n// 创建用户\nCREATE USER username@localhost IDENTIFIED BY 'password';\n> username:用户名  \n> @localhost：表示用户只能在本地访问  \n> password:密码\n\n// 配置权限\nGRANT SELECT,INSERT,UPDATE ON database.* TO username@localhost IDENTIFIED BY 'password';  \nGRANT ALL PRIVILEGES ON *.* TO user;@localhost \n// GRANT 权限名称 ON 数据库.数据表 TO 用户名@访问地址 IDENTIFIED BY '密码';\n    \n// 刷新权限列表\nflush privileges;\n    \n// 配置备份用户权限\nCREATE USER 'backuper'@'localhost' IDENTIFIED BY 'PASSWORD';\nGRANT SELECT, RELOAD, PROCESS, SHOW DATABASES, SUPER, LOCK TABLES, REPLICATION CLIENT, SHOW VIEW, EVENT ON *.* TO 'backuper'@'localhost';\nFLUSH PRIVILEGES;\n\n// 开启慢查询日志\n```bash \nsudo vim /etc/my.cnf\n\n# slow_query_log\nslow_query_log=on\nslow-query-log-file=/var/log/mysql/slow.log # 保证此文件属于mysql用户，mysql组，并可写权限\nlong_query_time=1 # 超过1秒写入慢查询日志\nlog-queries-not-using-indexes\n    \n// 查看是否开启mysql慢查询日志\n>mysql show variables like \"slow_query_log\";\n\n// 设置密码过期时间\nSET GLOBAL default_password_lifetime = 0;  // 全局用户永不过期\nALTER USER 'root'@'localhost' PASSWORD EXPIRE NEVER;  // 单个用户用户过期\nALTER USER 'root'@'localhost' PASSWORD EXPIRE INTERVAL 90 DAY;  // 单个用户\n```\n\n\n#### window服务器下自动备份\n\n##### 编写脚本\n```bash\nrem *******************************Code Start*****************************\n@echo off\n    \nset \"Ymd=%date:~,4%%date:~5,2%%date:~8,2%\"\nmysqldump --opt -u root --password=abcdefg database > F:\\FTP\\BackupMysql\\database_%Ymd%.sql\n@echo on\nrem *******************************Code End*****************************\n```\n\n##### 定时任务  \n注意在操作中填写脚本并在起始于写入脚本所在盘符E:\\\n\n##### 删除mysql\n\n> 在服务里找到mysql服务，停止使用  \n> 控制面板中卸载mysql 注册表文件删除： HKEY\\_LOCAL\\_MACHINE/SYSTEM/ControlSet001/Services/Eventlog/Application/MySQL 目录删除; HKEY\\_LOCAL\\_MACHINE/SYSTEM/ControlSet002/Services/Eventlog/Application/MySQL 目录删除; HKEY\\_LOCAL\\_MACHINE/SYSTEM/CurrentControlSet/Services/Eventlog/Application/MySQL 目录删除; 在硬盘和注册表中搜索mysql并删除掉\n","slug":"mysql入门基础","published":1,"updated":"2019-07-29T01:59:10.494Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5of002q9ka45h3lo960","content":"<h4 id=\"安装mysql\"><a href=\"#安装mysql\" class=\"headerlink\" title=\"安装mysql\"></a>安装mysql</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ubuntu16.04</span><br><span class=\"line\">sudo apt-get install mysql-server</span><br><span class=\"line\">sudo apt install mysql-client  # 服务器端不需要</span><br><span class=\"line\">mysql_secure_installation</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"查看mysql版本信息\"><a href=\"#查看mysql版本信息\" class=\"headerlink\" title=\"查看mysql版本信息\"></a>查看mysql版本信息</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql --version  </span><br><span class=\"line\"><span class=\"meta\">mysql&gt;</span> show variables like '%version_%';</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"数据库创建备份导入命令\"><a href=\"#数据库创建备份导入命令\" class=\"headerlink\" title=\"数据库创建备份导入命令\"></a>数据库创建备份导入命令</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 创建数据库  </span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">DATABASE</span> <span class=\"string\">`test`</span> <span class=\"keyword\">DEFAULT</span> <span class=\"built_in\">CHARACTER</span> <span class=\"keyword\">SET</span> utf8 <span class=\"keyword\">COLLATE</span> utf8_general_ci;  </span><br><span class=\"line\"></span><br><span class=\"line\">// 删除数据库  </span><br><span class=\"line\"> <span class=\"keyword\">DROP</span> <span class=\"keyword\">DATABASE</span> <span class=\"keyword\">IF</span> <span class=\"keyword\">EXISTS</span> <span class=\"string\">`test`</span>; </span><br><span class=\"line\"></span><br><span class=\"line\">// 创建表  </span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">test</span>(<span class=\"keyword\">name</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">32</span>) <span class=\"keyword\">not</span> <span class=\"literal\">null</span>,<span class=\"keyword\">password</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">64</span>) <span class=\"keyword\">not</span> <span class=\"literal\">null</span>)<span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">charset</span>=utf8;  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 重置自增字段</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`tableName`</span> AUTO_INCREMENT = <span class=\"number\">1</span>; </span><br><span class=\"line\">或者</span><br><span class=\"line\"><span class=\"keyword\">truncate</span> tableName; </span><br><span class=\"line\"></span><br><span class=\"line\">// 删除表</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">test</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">// 删除表内容，保留表结构  </span><br><span class=\"line\">mysql&gt; TRUNCATE TABLE `tabel_name`;</span><br><span class=\"line\">    </span><br><span class=\"line\">// 删除表并重置主键，不会留下日志，相当于删除表并重建    </span><br><span class=\"line\"><span class=\"keyword\">TRUNCATE</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`animal_cell_attribute`</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 导出一个数据库    </span><br><span class=\"line\">mysqldump -u 用户名 -p 数据库名 &gt; 导出的文件名.sql   </span><br><span class=\"line\">mysqldump -u root -p uscnerp &gt; uscnerp.sql    </span><br><span class=\"line\">Enter password:  </span><br><span class=\"line\">    </span><br><span class=\"line\">// 导出一张表</span><br><span class=\"line\">mysqldump -u 用户名 -p 数据库名 表名 &gt; 导出的文件名.sql  </span><br><span class=\"line\">mysqldump -u root -p animal animal_service &gt; animal_service.sql</span><br><span class=\"line\">Enter password: **********  </span><br><span class=\"line\">    </span><br><span class=\"line\">// 导出多个数据库</span><br><span class=\"line\">mysqldump  -uroot -p --databases test mysql #空格分隔</span><br><span class=\"line\">    </span><br><span class=\"line\">// 导出到excel表格</span><br><span class=\"line\">mysql   -uroot   -p   -e   \"select   *   from   test.table2 \"   &gt;   d:a.xsl</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 导入数据库  </span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt;use 数据库  </span><br><span class=\"line\">mysql&gt;set names utf8; （先确认编码，如果不设置可能会出现乱码，注意不是UTF-8）   </span><br><span class=\"line\">mysql&gt;source d:\\wcnc_db.sql</span><br></pre></td></tr></table></figure>\n\n\n<h4 id=\"查看表\"><a href=\"#查看表\" class=\"headerlink\" title=\"查看表\"></a>查看表</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 查看表结构</span><br><span class=\"line\"><span class=\"keyword\">show</span> <span class=\"keyword\">create</span> <span class=\"keyword\">table</span> 表名;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"配置用户权限\"><a href=\"#配置用户权限\" class=\"headerlink\" title=\"配置用户权限\"></a>配置用户权限</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 重置root密码并查看所有用户权限</span></span><br><span class=\"line\"> mysql&gt; use mysql;</span><br><span class=\"line\">Database changed</span><br><span class=\"line\">mysql&gt; UPDATE user SET Password = PASSWORD('newpassword') WHERE user = 'root';</span><br><span class=\"line\">Query OK, 3 rows affected (0.02 sec)</span><br><span class=\"line\">Rows matched: 3  Changed: 3  Warnings: 0</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SELECT Host,User,Password FROM mysql.user;</span><br><span class=\"line\">+<span class=\"comment\">-----------+--------+-------------------------------------------+</span></span><br><span class=\"line\">| Host      | User   | Password                                  |</span><br><span class=\"line\">+<span class=\"comment\">-----------+--------+-------------------------------------------+</span></span><br><span class=\"line\">| localhost | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |</span><br><span class=\"line\">| 127.0.0.1 | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |</span><br><span class=\"line\">| ::1       | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |</span><br><span class=\"line\">| localhost |        |                                           |</span><br><span class=\"line\">| localhost | animal | *CC87B1E39E699B64E0B80741B5D1991BC5BE57AC |</span><br><span class=\"line\">+<span class=\"comment\">-----------+--------+-------------------------------------------+</span></span><br><span class=\"line\">5 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">// 查看全部用户</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">DISTINCT</span> <span class=\"keyword\">CONCAT</span>(<span class=\"string\">'User: '''</span>,<span class=\"keyword\">user</span>,<span class=\"string\">'''@'''</span>,host,<span class=\"string\">''';'</span>) <span class=\"keyword\">AS</span> <span class=\"keyword\">query</span> <span class=\"keyword\">FROM</span> mysql.user;</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">// 创建用户</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">USER</span> username@localhost <span class=\"keyword\">IDENTIFIED</span> <span class=\"keyword\">BY</span> <span class=\"string\">'password'</span>;</span><br><span class=\"line\">&gt; username:用户名  </span><br><span class=\"line\">&gt; @localhost：表示用户只能在本地访问  </span><br><span class=\"line\">&gt; password:密码</span><br><span class=\"line\"></span><br><span class=\"line\">// 配置权限</span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">SELECT</span>,<span class=\"keyword\">INSERT</span>,<span class=\"keyword\">UPDATE</span> <span class=\"keyword\">ON</span> database.* <span class=\"keyword\">TO</span> username@localhost <span class=\"keyword\">IDENTIFIED</span> <span class=\"keyword\">BY</span> <span class=\"string\">'password'</span>;  </span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">ALL</span> <span class=\"keyword\">PRIVILEGES</span> <span class=\"keyword\">ON</span> *.* <span class=\"keyword\">TO</span> <span class=\"keyword\">user</span>;@localhost </span><br><span class=\"line\">// <span class=\"keyword\">GRANT</span> 权限名称 <span class=\"keyword\">ON</span> 数据库.数据表 <span class=\"keyword\">TO</span> 用户名@访问地址 <span class=\"keyword\">IDENTIFIED</span> <span class=\"keyword\">BY</span> <span class=\"string\">'密码'</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">// 刷新权限列表</span><br><span class=\"line\"><span class=\"keyword\">flush</span> <span class=\"keyword\">privileges</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">// 配置备份用户权限</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">USER</span> <span class=\"string\">'backuper'</span>@<span class=\"string\">'localhost'</span> <span class=\"keyword\">IDENTIFIED</span> <span class=\"keyword\">BY</span> <span class=\"string\">'PASSWORD'</span>;</span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">SELECT</span>, RELOAD, PROCESS, <span class=\"keyword\">SHOW</span> <span class=\"keyword\">DATABASES</span>, SUPER, <span class=\"keyword\">LOCK</span> <span class=\"keyword\">TABLES</span>, <span class=\"keyword\">REPLICATION</span> <span class=\"keyword\">CLIENT</span>, <span class=\"keyword\">SHOW</span> <span class=\"keyword\">VIEW</span>, <span class=\"keyword\">EVENT</span> <span class=\"keyword\">ON</span> *.* <span class=\"keyword\">TO</span> <span class=\"string\">'backuper'</span>@<span class=\"string\">'localhost'</span>;</span><br><span class=\"line\"><span class=\"keyword\">FLUSH</span> <span class=\"keyword\">PRIVILEGES</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">// 开启慢查询日志</span><br><span class=\"line\">```bash </span><br><span class=\"line\">sudo vim /etc/my.cnf</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># slow_query_log</span></span><br><span class=\"line\">slow_query_log=on</span><br><span class=\"line\">slow-query-log-file=/var/log/mysql/slow.log <span class=\"comment\"># 保证此文件属于mysql用户，mysql组，并可写权限</span></span><br><span class=\"line\">long_query_time=1 <span class=\"comment\"># 超过1秒写入慢查询日志</span></span><br><span class=\"line\">log-queries-not-using-indexes</span><br><span class=\"line\">    </span><br><span class=\"line\">// 查看是否开启mysql慢查询日志</span><br><span class=\"line\">&gt;mysql show variables like \"slow_query_log\";</span><br><span class=\"line\"></span><br><span class=\"line\">// 设置密码过期时间</span><br><span class=\"line\"><span class=\"keyword\">SET</span> <span class=\"keyword\">GLOBAL</span> default_password_lifetime = <span class=\"number\">0</span>;  // 全局用户永不过期</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span> <span class=\"string\">'root'</span>@<span class=\"string\">'localhost'</span> <span class=\"keyword\">PASSWORD</span> <span class=\"keyword\">EXPIRE</span> <span class=\"keyword\">NEVER</span>;  // 单个用户用户过期</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span> <span class=\"string\">'root'</span>@<span class=\"string\">'localhost'</span> <span class=\"keyword\">PASSWORD</span> <span class=\"keyword\">EXPIRE</span> <span class=\"built_in\">INTERVAL</span> <span class=\"number\">90</span> <span class=\"keyword\">DAY</span>;  // 单个用户</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"window服务器下自动备份\"><a href=\"#window服务器下自动备份\" class=\"headerlink\" title=\"window服务器下自动备份\"></a>window服务器下自动备份</h4><h5 id=\"编写脚本\"><a href=\"#编写脚本\" class=\"headerlink\" title=\"编写脚本\"></a>编写脚本</h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rem *******************************Code Start*****************************</span><br><span class=\"line\">@<span class=\"built_in\">echo</span> off</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"built_in\">set</span> <span class=\"string\">\"Ymd=%date:~,4%%date:~5,2%%date:~8,2%\"</span></span><br><span class=\"line\">mysqldump --opt -u root --password=abcdefg database &gt; F:\\FTP\\BackupMysql\\database_%Ymd%.sql</span><br><span class=\"line\">@<span class=\"built_in\">echo</span> on</span><br><span class=\"line\">rem *******************************Code End*****************************</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"定时任务\"><a href=\"#定时任务\" class=\"headerlink\" title=\"定时任务\"></a>定时任务</h5><p>注意在操作中填写脚本并在起始于写入脚本所在盘符E:\\</p>\n<h5 id=\"删除mysql\"><a href=\"#删除mysql\" class=\"headerlink\" title=\"删除mysql\"></a>删除mysql</h5><blockquote>\n<p>在服务里找到mysql服务，停止使用<br>控制面板中卸载mysql 注册表文件删除： HKEY_LOCAL_MACHINE/SYSTEM/ControlSet001/Services/Eventlog/Application/MySQL 目录删除; HKEY_LOCAL_MACHINE/SYSTEM/ControlSet002/Services/Eventlog/Application/MySQL 目录删除; HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/Services/Eventlog/Application/MySQL 目录删除; 在硬盘和注册表中搜索mysql并删除掉</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"安装mysql\"><a href=\"#安装mysql\" class=\"headerlink\" title=\"安装mysql\"></a>安装mysql</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ubuntu16.04</span><br><span class=\"line\">sudo apt-get install mysql-server</span><br><span class=\"line\">sudo apt install mysql-client  # 服务器端不需要</span><br><span class=\"line\">mysql_secure_installation</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"查看mysql版本信息\"><a href=\"#查看mysql版本信息\" class=\"headerlink\" title=\"查看mysql版本信息\"></a>查看mysql版本信息</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql --version  </span><br><span class=\"line\"><span class=\"meta\">mysql&gt;</span> show variables like '%version_%';</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"数据库创建备份导入命令\"><a href=\"#数据库创建备份导入命令\" class=\"headerlink\" title=\"数据库创建备份导入命令\"></a>数据库创建备份导入命令</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 创建数据库  </span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">DATABASE</span> <span class=\"string\">`test`</span> <span class=\"keyword\">DEFAULT</span> <span class=\"built_in\">CHARACTER</span> <span class=\"keyword\">SET</span> utf8 <span class=\"keyword\">COLLATE</span> utf8_general_ci;  </span><br><span class=\"line\"></span><br><span class=\"line\">// 删除数据库  </span><br><span class=\"line\"> <span class=\"keyword\">DROP</span> <span class=\"keyword\">DATABASE</span> <span class=\"keyword\">IF</span> <span class=\"keyword\">EXISTS</span> <span class=\"string\">`test`</span>; </span><br><span class=\"line\"></span><br><span class=\"line\">// 创建表  </span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">test</span>(<span class=\"keyword\">name</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">32</span>) <span class=\"keyword\">not</span> <span class=\"literal\">null</span>,<span class=\"keyword\">password</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">64</span>) <span class=\"keyword\">not</span> <span class=\"literal\">null</span>)<span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">charset</span>=utf8;  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 重置自增字段</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`tableName`</span> AUTO_INCREMENT = <span class=\"number\">1</span>; </span><br><span class=\"line\">或者</span><br><span class=\"line\"><span class=\"keyword\">truncate</span> tableName; </span><br><span class=\"line\"></span><br><span class=\"line\">// 删除表</span><br><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">test</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">// 删除表内容，保留表结构  </span><br><span class=\"line\">mysql&gt; TRUNCATE TABLE `tabel_name`;</span><br><span class=\"line\">    </span><br><span class=\"line\">// 删除表并重置主键，不会留下日志，相当于删除表并重建    </span><br><span class=\"line\"><span class=\"keyword\">TRUNCATE</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`animal_cell_attribute`</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 导出一个数据库    </span><br><span class=\"line\">mysqldump -u 用户名 -p 数据库名 &gt; 导出的文件名.sql   </span><br><span class=\"line\">mysqldump -u root -p uscnerp &gt; uscnerp.sql    </span><br><span class=\"line\">Enter password:  </span><br><span class=\"line\">    </span><br><span class=\"line\">// 导出一张表</span><br><span class=\"line\">mysqldump -u 用户名 -p 数据库名 表名 &gt; 导出的文件名.sql  </span><br><span class=\"line\">mysqldump -u root -p animal animal_service &gt; animal_service.sql</span><br><span class=\"line\">Enter password: **********  </span><br><span class=\"line\">    </span><br><span class=\"line\">// 导出多个数据库</span><br><span class=\"line\">mysqldump  -uroot -p --databases test mysql #空格分隔</span><br><span class=\"line\">    </span><br><span class=\"line\">// 导出到excel表格</span><br><span class=\"line\">mysql   -uroot   -p   -e   \"select   *   from   test.table2 \"   &gt;   d:a.xsl</span><br></pre></td></tr></table></figure>\n\n\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 导入数据库  </span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt;use 数据库  </span><br><span class=\"line\">mysql&gt;set names utf8; （先确认编码，如果不设置可能会出现乱码，注意不是UTF-8）   </span><br><span class=\"line\">mysql&gt;source d:\\wcnc_db.sql</span><br></pre></td></tr></table></figure>\n\n\n<h4 id=\"查看表\"><a href=\"#查看表\" class=\"headerlink\" title=\"查看表\"></a>查看表</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 查看表结构</span><br><span class=\"line\"><span class=\"keyword\">show</span> <span class=\"keyword\">create</span> <span class=\"keyword\">table</span> 表名;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"配置用户权限\"><a href=\"#配置用户权限\" class=\"headerlink\" title=\"配置用户权限\"></a>配置用户权限</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 重置root密码并查看所有用户权限</span></span><br><span class=\"line\"> mysql&gt; use mysql;</span><br><span class=\"line\">Database changed</span><br><span class=\"line\">mysql&gt; UPDATE user SET Password = PASSWORD('newpassword') WHERE user = 'root';</span><br><span class=\"line\">Query OK, 3 rows affected (0.02 sec)</span><br><span class=\"line\">Rows matched: 3  Changed: 3  Warnings: 0</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SELECT Host,User,Password FROM mysql.user;</span><br><span class=\"line\">+<span class=\"comment\">-----------+--------+-------------------------------------------+</span></span><br><span class=\"line\">| Host      | User   | Password                                  |</span><br><span class=\"line\">+<span class=\"comment\">-----------+--------+-------------------------------------------+</span></span><br><span class=\"line\">| localhost | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |</span><br><span class=\"line\">| 127.0.0.1 | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |</span><br><span class=\"line\">| ::1       | root   | *2ED3112AFECE04CEE0AA42619AB00D4498BA3342 |</span><br><span class=\"line\">| localhost |        |                                           |</span><br><span class=\"line\">| localhost | animal | *CC87B1E39E699B64E0B80741B5D1991BC5BE57AC |</span><br><span class=\"line\">+<span class=\"comment\">-----------+--------+-------------------------------------------+</span></span><br><span class=\"line\">5 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">// 查看全部用户</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">DISTINCT</span> <span class=\"keyword\">CONCAT</span>(<span class=\"string\">'User: '''</span>,<span class=\"keyword\">user</span>,<span class=\"string\">'''@'''</span>,host,<span class=\"string\">''';'</span>) <span class=\"keyword\">AS</span> <span class=\"keyword\">query</span> <span class=\"keyword\">FROM</span> mysql.user;</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">// 创建用户</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">USER</span> username@localhost <span class=\"keyword\">IDENTIFIED</span> <span class=\"keyword\">BY</span> <span class=\"string\">'password'</span>;</span><br><span class=\"line\">&gt; username:用户名  </span><br><span class=\"line\">&gt; @localhost：表示用户只能在本地访问  </span><br><span class=\"line\">&gt; password:密码</span><br><span class=\"line\"></span><br><span class=\"line\">// 配置权限</span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">SELECT</span>,<span class=\"keyword\">INSERT</span>,<span class=\"keyword\">UPDATE</span> <span class=\"keyword\">ON</span> database.* <span class=\"keyword\">TO</span> username@localhost <span class=\"keyword\">IDENTIFIED</span> <span class=\"keyword\">BY</span> <span class=\"string\">'password'</span>;  </span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">ALL</span> <span class=\"keyword\">PRIVILEGES</span> <span class=\"keyword\">ON</span> *.* <span class=\"keyword\">TO</span> <span class=\"keyword\">user</span>;@localhost </span><br><span class=\"line\">// <span class=\"keyword\">GRANT</span> 权限名称 <span class=\"keyword\">ON</span> 数据库.数据表 <span class=\"keyword\">TO</span> 用户名@访问地址 <span class=\"keyword\">IDENTIFIED</span> <span class=\"keyword\">BY</span> <span class=\"string\">'密码'</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">// 刷新权限列表</span><br><span class=\"line\"><span class=\"keyword\">flush</span> <span class=\"keyword\">privileges</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">// 配置备份用户权限</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">USER</span> <span class=\"string\">'backuper'</span>@<span class=\"string\">'localhost'</span> <span class=\"keyword\">IDENTIFIED</span> <span class=\"keyword\">BY</span> <span class=\"string\">'PASSWORD'</span>;</span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">SELECT</span>, RELOAD, PROCESS, <span class=\"keyword\">SHOW</span> <span class=\"keyword\">DATABASES</span>, SUPER, <span class=\"keyword\">LOCK</span> <span class=\"keyword\">TABLES</span>, <span class=\"keyword\">REPLICATION</span> <span class=\"keyword\">CLIENT</span>, <span class=\"keyword\">SHOW</span> <span class=\"keyword\">VIEW</span>, <span class=\"keyword\">EVENT</span> <span class=\"keyword\">ON</span> *.* <span class=\"keyword\">TO</span> <span class=\"string\">'backuper'</span>@<span class=\"string\">'localhost'</span>;</span><br><span class=\"line\"><span class=\"keyword\">FLUSH</span> <span class=\"keyword\">PRIVILEGES</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">// 开启慢查询日志</span><br><span class=\"line\">```bash </span><br><span class=\"line\">sudo vim /etc/my.cnf</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># slow_query_log</span></span><br><span class=\"line\">slow_query_log=on</span><br><span class=\"line\">slow-query-log-file=/var/log/mysql/slow.log <span class=\"comment\"># 保证此文件属于mysql用户，mysql组，并可写权限</span></span><br><span class=\"line\">long_query_time=1 <span class=\"comment\"># 超过1秒写入慢查询日志</span></span><br><span class=\"line\">log-queries-not-using-indexes</span><br><span class=\"line\">    </span><br><span class=\"line\">// 查看是否开启mysql慢查询日志</span><br><span class=\"line\">&gt;mysql show variables like \"slow_query_log\";</span><br><span class=\"line\"></span><br><span class=\"line\">// 设置密码过期时间</span><br><span class=\"line\"><span class=\"keyword\">SET</span> <span class=\"keyword\">GLOBAL</span> default_password_lifetime = <span class=\"number\">0</span>;  // 全局用户永不过期</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span> <span class=\"string\">'root'</span>@<span class=\"string\">'localhost'</span> <span class=\"keyword\">PASSWORD</span> <span class=\"keyword\">EXPIRE</span> <span class=\"keyword\">NEVER</span>;  // 单个用户用户过期</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span> <span class=\"string\">'root'</span>@<span class=\"string\">'localhost'</span> <span class=\"keyword\">PASSWORD</span> <span class=\"keyword\">EXPIRE</span> <span class=\"built_in\">INTERVAL</span> <span class=\"number\">90</span> <span class=\"keyword\">DAY</span>;  // 单个用户</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"window服务器下自动备份\"><a href=\"#window服务器下自动备份\" class=\"headerlink\" title=\"window服务器下自动备份\"></a>window服务器下自动备份</h4><h5 id=\"编写脚本\"><a href=\"#编写脚本\" class=\"headerlink\" title=\"编写脚本\"></a>编写脚本</h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rem *******************************Code Start*****************************</span><br><span class=\"line\">@<span class=\"built_in\">echo</span> off</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"built_in\">set</span> <span class=\"string\">\"Ymd=%date:~,4%%date:~5,2%%date:~8,2%\"</span></span><br><span class=\"line\">mysqldump --opt -u root --password=abcdefg database &gt; F:\\FTP\\BackupMysql\\database_%Ymd%.sql</span><br><span class=\"line\">@<span class=\"built_in\">echo</span> on</span><br><span class=\"line\">rem *******************************Code End*****************************</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"定时任务\"><a href=\"#定时任务\" class=\"headerlink\" title=\"定时任务\"></a>定时任务</h5><p>注意在操作中填写脚本并在起始于写入脚本所在盘符E:\\</p>\n<h5 id=\"删除mysql\"><a href=\"#删除mysql\" class=\"headerlink\" title=\"删除mysql\"></a>删除mysql</h5><blockquote>\n<p>在服务里找到mysql服务，停止使用<br>控制面板中卸载mysql 注册表文件删除： HKEY_LOCAL_MACHINE/SYSTEM/ControlSet001/Services/Eventlog/Application/MySQL 目录删除; HKEY_LOCAL_MACHINE/SYSTEM/ControlSet002/Services/Eventlog/Application/MySQL 目录删除; HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/Services/Eventlog/Application/MySQL 目录删除; 在硬盘和注册表中搜索mysql并删除掉</p>\n</blockquote>\n"},{"title":"ubuntu16.04安装及使用SVN","url":"570.html","id":"570","comments":0,"date":"2018-10-09T10:21:49.000Z","_content":"\n#### 服务器端安装\n\n[官方推荐](https://help.ubuntu.com/lts/serverguide/subversion.html.en/)\n\n    # 安装包\n    sudo apt install subversion apache2 libapache2-svn\n    # 创建目录及两个svn项目\n    mkdir svn\n    svnadmin create svn/doneself-app\n    svnadmin create svn/doneself-web\n    # 多个项目公用一个权限文件\n    cp -rf svn/doneself/conf/passwd snv/\n    cp -rf svn/doneself/conf/authz snv/\n    \n\n    # 编辑每个项目的配置文件\n    vim svn/doneself/conf/svnserve.conf\n    [general]   \n    # 匿名用户没有权限\n    anon-access = none\n    # 验证用户写权限\n    auth-access = write\n    # 账号密码文件路径\n    password-db = ../../passwd \n    # 权限文件路径\n    authz-db = ../../authz\n    \n\n    # 编写账号密码文件\n    vim svn/passwd\n    [users] \n    ui = ui  # 注意空格\n    \n\n    # 编写组和权限文件\n    vim svn/\n    [groups]\n    ui = ui  \n    [doneself-app:/]  \n    ui = wr\n    \n\n#### 启动svn服务器\n\n    # 启动,默认端口号3690\n    sudo svnserve -d -r /home/svn\n    # 结束\n    sudo pkill svnserve","source":"_posts/ubuntu16.04安装及使用SVN.md","raw":"---\ntitle: ubuntu16.04安装及使用SVN\nurl: 570.html\nid: 570\ncomments: false\ncategories:\n  - 办公\n  - 后端\n  - 运维\ndate: 2018-10-09 18:21:49\ntags:\n---\n\n#### 服务器端安装\n\n[官方推荐](https://help.ubuntu.com/lts/serverguide/subversion.html.en/)\n\n    # 安装包\n    sudo apt install subversion apache2 libapache2-svn\n    # 创建目录及两个svn项目\n    mkdir svn\n    svnadmin create svn/doneself-app\n    svnadmin create svn/doneself-web\n    # 多个项目公用一个权限文件\n    cp -rf svn/doneself/conf/passwd snv/\n    cp -rf svn/doneself/conf/authz snv/\n    \n\n    # 编辑每个项目的配置文件\n    vim svn/doneself/conf/svnserve.conf\n    [general]   \n    # 匿名用户没有权限\n    anon-access = none\n    # 验证用户写权限\n    auth-access = write\n    # 账号密码文件路径\n    password-db = ../../passwd \n    # 权限文件路径\n    authz-db = ../../authz\n    \n\n    # 编写账号密码文件\n    vim svn/passwd\n    [users] \n    ui = ui  # 注意空格\n    \n\n    # 编写组和权限文件\n    vim svn/\n    [groups]\n    ui = ui  \n    [doneself-app:/]  \n    ui = wr\n    \n\n#### 启动svn服务器\n\n    # 启动,默认端口号3690\n    sudo svnserve -d -r /home/svn\n    # 结束\n    sudo pkill svnserve","slug":"ubuntu16.04安装及使用SVN","published":1,"updated":"2019-07-23T05:51:43.850Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5og002t9ka4sp1rcwn4","content":"<h4 id=\"服务器端安装\"><a href=\"#服务器端安装\" class=\"headerlink\" title=\"服务器端安装\"></a>服务器端安装</h4><p><a href=\"https://help.ubuntu.com/lts/serverguide/subversion.html.en/\" target=\"_blank\" rel=\"noopener\">官方推荐</a></p>\n<pre><code># 安装包\nsudo apt install subversion apache2 libapache2-svn\n# 创建目录及两个svn项目\nmkdir svn\nsvnadmin create svn/doneself-app\nsvnadmin create svn/doneself-web\n# 多个项目公用一个权限文件\ncp -rf svn/doneself/conf/passwd snv/\ncp -rf svn/doneself/conf/authz snv/\n\n\n# 编辑每个项目的配置文件\nvim svn/doneself/conf/svnserve.conf\n[general]   \n# 匿名用户没有权限\nanon-access = none\n# 验证用户写权限\nauth-access = write\n# 账号密码文件路径\npassword-db = ../../passwd \n# 权限文件路径\nauthz-db = ../../authz\n\n\n# 编写账号密码文件\nvim svn/passwd\n[users] \nui = ui  # 注意空格\n\n\n# 编写组和权限文件\nvim svn/\n[groups]\nui = ui  \n[doneself-app:/]  \nui = wr</code></pre><h4 id=\"启动svn服务器\"><a href=\"#启动svn服务器\" class=\"headerlink\" title=\"启动svn服务器\"></a>启动svn服务器</h4><pre><code># 启动,默认端口号3690\nsudo svnserve -d -r /home/svn\n# 结束\nsudo pkill svnserve</code></pre>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"服务器端安装\"><a href=\"#服务器端安装\" class=\"headerlink\" title=\"服务器端安装\"></a>服务器端安装</h4><p><a href=\"https://help.ubuntu.com/lts/serverguide/subversion.html.en/\" target=\"_blank\" rel=\"noopener\">官方推荐</a></p>\n<pre><code># 安装包\nsudo apt install subversion apache2 libapache2-svn\n# 创建目录及两个svn项目\nmkdir svn\nsvnadmin create svn/doneself-app\nsvnadmin create svn/doneself-web\n# 多个项目公用一个权限文件\ncp -rf svn/doneself/conf/passwd snv/\ncp -rf svn/doneself/conf/authz snv/\n\n\n# 编辑每个项目的配置文件\nvim svn/doneself/conf/svnserve.conf\n[general]   \n# 匿名用户没有权限\nanon-access = none\n# 验证用户写权限\nauth-access = write\n# 账号密码文件路径\npassword-db = ../../passwd \n# 权限文件路径\nauthz-db = ../../authz\n\n\n# 编写账号密码文件\nvim svn/passwd\n[users] \nui = ui  # 注意空格\n\n\n# 编写组和权限文件\nvim svn/\n[groups]\nui = ui  \n[doneself-app:/]  \nui = wr</code></pre><h4 id=\"启动svn服务器\"><a href=\"#启动svn服务器\" class=\"headerlink\" title=\"启动svn服务器\"></a>启动svn服务器</h4><pre><code># 启动,默认端口号3690\nsudo svnserve -d -r /home/svn\n# 结束\nsudo pkill svnserve</code></pre>"},{"title":"ubuntu配置Gitlab服务","url":"178.html","id":"178","comments":0,"date":"2017-06-19T06:18:48.000Z","_content":"#### 安装\n```bash\n# 安装相关服务 postfix为邮件服务\nsudo apt-get install curl openssh-server ca-certificates postfix\n# 安装gitlab服务包\ncurl -sS https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash\nsudo apt-get install gitlab-ce\n```\n\n#### 配置\n```bash\n# 配置服务\nsudo vim /etc/gitlab/gitlab.rb\n\n## GitLab URL\n##! URL on which GitLab will be reachable.\n##! For more details on configuring external_url see:\n##! https://docs.gitlab.com/omnibus/settings/configuration.html#configuring-the-external-url-for-gitlab\nexternal_url 'http:/192.168.0.19:1500'    # 地址\n\n.\n.\n.\n# 邮件基本设置\n### Email Settings\ngitlab_rails['gitlab_email_enabled'] = true\ngitlab_rails['gitlab_email_from'] = 'admin@uscnk.com'\ngitlab_rails['gitlab_email_display_name'] = 'Gitlab'\ngitlab_rails['gitlab_email_reply_to'] = 'admin@uscnk.com'\ngitlab_rails['gitlab_email_subject_suffix'] = 'Gitlab'\n\n.\n.\n.\n### GitLab email server settings\n###! Docs: https://docs.gitlab.com/omnibus/settings/smtp.html\n###! **Use smtp instead of sendmail/postfix.**\n\n# gitlab_rails['smtp_enable'] = true\n# gitlab_rails['smtp_address'] = \"smtp.server\"\n# gitlab_rails['smtp_port'] = 465\n# gitlab_rails['smtp_user_name'] = \"smtp user\"\n# gitlab_rails['smtp_password'] = \"smtp password\"\n# gitlab_rails['smtp_domain'] = \"example.com\"\n# gitlab_rails['smtp_authentication'] = \"login\"\n# gitlab_rails['smtp_enable_starttls_auto'] = true\n# gitlab_rails['smtp_tls'] = false\n\n# 邮件服务地址\n# QQ exmail (腾讯企业邮箱)\ngitlab_rails['smtp_enable'] = true\ngitlab_rails['smtp_address'] = \"smtp.exmail.qq.com\"\ngitlab_rails['smtp_port'] = 465\ngitlab_rails['smtp_user_name'] = \"admin@uscnk.com\"\ngitlab_rails['smtp_password'] = \"xxxxxxxxx\"\ngitlab_rails['smtp_authentication'] = \"login\"\ngitlab_rails['smtp_enable_starttls_auto'] = true\ngitlab_rails['smtp_tls'] = true\ngitlab_rails['gitlab_email_from'] = 'admin@uscnk.com'\n\n\n# nginx基本设置\n################################################################################\n## GitLab Nginx\n##! Docs: https://docs.gitlab.com/omnibus/settings/nginx.html\n################################################################################\n\nnginx['listen_addresses'] = ['192.168.0.19']\nnginx['losten_port'] = 1500\n\n```\n\n#### 启动\n```bash\n# 重启服务\nsudo gitlab-ctl reconfigure\n# 重启邮件服务\nsudo /etc/init.d/postfix restart\n# 访问\nhttp://192.168.0.19:1500\nUsername: root\nPassword: 5iveL!fe\n\n```\n#### github与gitlab共存\n```bash\n# github账户邮箱， 将id_rsa改名成id_rsa_github\nssh-keygen -t rsa -C \"xxxxx@gmail.com\"\n# gitlab公司邮箱， 将id_rsa改名成id_rsa_gitlab\nssh-keygen -t rsa -C \"xxxxxx@work.com\"\n# 添加私钥\nssh-add ~/.ssh/id_rsa_github\nssh-add ~/.ssh/id_rsa_gitlab\n\n\n#在 ~/.ssh 目录下新建一个config文件\ntouch config\nchmod 755 conifg\n\n\n# 并添加以下内容\n# gitlab\nHost github.com\n    HostName github.com\n    PreferredAuthentications publickey\n    IdentityFile ~/.ssh/id_rsa_github\n# github\nHost gitlib.com\n    HostName gitlib.com\n    PreferredAuthentications publickey\n    IdentityFile ~/.ssh/id_rsa_gitlab\n\n\n# 将id_rsa_github.pab内容添加到github中\n# 测试结果\nssh -T git@github.com\n# 将id_rsa_gitlab.pab内容添加到gitlab中\n\n\n\ncd ~/mytest\n# 在github中测试\ngit remote add github https://github.com/zhcshine/mytest.git\ngit push -u github master\n# 在gitlab中测试\ngit remote add gitlab http://192.168.0.19:1500/zhcshine/mytest.git\ngit push -u gitlab master\n\n```","source":"_posts/ubuntu配置Gitlab服务.md","raw":"---\ntitle: ubuntu配置Gitlab服务\nurl: 178.html\nid: 178\ncomments: false\ncategories:\n  - 运维\ndate: 2017-06-19 14:18:48\ntags:\n---\n#### 安装\n```bash\n# 安装相关服务 postfix为邮件服务\nsudo apt-get install curl openssh-server ca-certificates postfix\n# 安装gitlab服务包\ncurl -sS https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash\nsudo apt-get install gitlab-ce\n```\n\n#### 配置\n```bash\n# 配置服务\nsudo vim /etc/gitlab/gitlab.rb\n\n## GitLab URL\n##! URL on which GitLab will be reachable.\n##! For more details on configuring external_url see:\n##! https://docs.gitlab.com/omnibus/settings/configuration.html#configuring-the-external-url-for-gitlab\nexternal_url 'http:/192.168.0.19:1500'    # 地址\n\n.\n.\n.\n# 邮件基本设置\n### Email Settings\ngitlab_rails['gitlab_email_enabled'] = true\ngitlab_rails['gitlab_email_from'] = 'admin@uscnk.com'\ngitlab_rails['gitlab_email_display_name'] = 'Gitlab'\ngitlab_rails['gitlab_email_reply_to'] = 'admin@uscnk.com'\ngitlab_rails['gitlab_email_subject_suffix'] = 'Gitlab'\n\n.\n.\n.\n### GitLab email server settings\n###! Docs: https://docs.gitlab.com/omnibus/settings/smtp.html\n###! **Use smtp instead of sendmail/postfix.**\n\n# gitlab_rails['smtp_enable'] = true\n# gitlab_rails['smtp_address'] = \"smtp.server\"\n# gitlab_rails['smtp_port'] = 465\n# gitlab_rails['smtp_user_name'] = \"smtp user\"\n# gitlab_rails['smtp_password'] = \"smtp password\"\n# gitlab_rails['smtp_domain'] = \"example.com\"\n# gitlab_rails['smtp_authentication'] = \"login\"\n# gitlab_rails['smtp_enable_starttls_auto'] = true\n# gitlab_rails['smtp_tls'] = false\n\n# 邮件服务地址\n# QQ exmail (腾讯企业邮箱)\ngitlab_rails['smtp_enable'] = true\ngitlab_rails['smtp_address'] = \"smtp.exmail.qq.com\"\ngitlab_rails['smtp_port'] = 465\ngitlab_rails['smtp_user_name'] = \"admin@uscnk.com\"\ngitlab_rails['smtp_password'] = \"xxxxxxxxx\"\ngitlab_rails['smtp_authentication'] = \"login\"\ngitlab_rails['smtp_enable_starttls_auto'] = true\ngitlab_rails['smtp_tls'] = true\ngitlab_rails['gitlab_email_from'] = 'admin@uscnk.com'\n\n\n# nginx基本设置\n################################################################################\n## GitLab Nginx\n##! Docs: https://docs.gitlab.com/omnibus/settings/nginx.html\n################################################################################\n\nnginx['listen_addresses'] = ['192.168.0.19']\nnginx['losten_port'] = 1500\n\n```\n\n#### 启动\n```bash\n# 重启服务\nsudo gitlab-ctl reconfigure\n# 重启邮件服务\nsudo /etc/init.d/postfix restart\n# 访问\nhttp://192.168.0.19:1500\nUsername: root\nPassword: 5iveL!fe\n\n```\n#### github与gitlab共存\n```bash\n# github账户邮箱， 将id_rsa改名成id_rsa_github\nssh-keygen -t rsa -C \"xxxxx@gmail.com\"\n# gitlab公司邮箱， 将id_rsa改名成id_rsa_gitlab\nssh-keygen -t rsa -C \"xxxxxx@work.com\"\n# 添加私钥\nssh-add ~/.ssh/id_rsa_github\nssh-add ~/.ssh/id_rsa_gitlab\n\n\n#在 ~/.ssh 目录下新建一个config文件\ntouch config\nchmod 755 conifg\n\n\n# 并添加以下内容\n# gitlab\nHost github.com\n    HostName github.com\n    PreferredAuthentications publickey\n    IdentityFile ~/.ssh/id_rsa_github\n# github\nHost gitlib.com\n    HostName gitlib.com\n    PreferredAuthentications publickey\n    IdentityFile ~/.ssh/id_rsa_gitlab\n\n\n# 将id_rsa_github.pab内容添加到github中\n# 测试结果\nssh -T git@github.com\n# 将id_rsa_gitlab.pab内容添加到gitlab中\n\n\n\ncd ~/mytest\n# 在github中测试\ngit remote add github https://github.com/zhcshine/mytest.git\ngit push -u github master\n# 在gitlab中测试\ngit remote add gitlab http://192.168.0.19:1500/zhcshine/mytest.git\ngit push -u gitlab master\n\n```","slug":"ubuntu配置Gitlab服务","published":1,"updated":"2019-07-23T10:59:09.597Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5oh002x9ka4e7hg8gnd","content":"<h4 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装相关服务 postfix为邮件服务</span></span><br><span class=\"line\">sudo apt-get install curl openssh-server ca-certificates postfix</span><br><span class=\"line\"><span class=\"comment\"># 安装gitlab服务包</span></span><br><span class=\"line\">curl -sS https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash</span><br><span class=\"line\">sudo apt-get install gitlab-ce</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 配置服务</span></span><br><span class=\"line\">sudo vim /etc/gitlab/gitlab.rb</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## GitLab URL</span></span><br><span class=\"line\"><span class=\"comment\">##! URL on which GitLab will be reachable.</span></span><br><span class=\"line\"><span class=\"comment\">##! For more details on configuring external_url see:</span></span><br><span class=\"line\"><span class=\"comment\">##! https://docs.gitlab.com/omnibus/settings/configuration.html#configuring-the-external-url-for-gitlab</span></span><br><span class=\"line\">external_url <span class=\"string\">'http:/192.168.0.19:1500'</span>    <span class=\"comment\"># 地址</span></span><br><span class=\"line\"></span><br><span class=\"line\">.</span><br><span class=\"line\">.</span><br><span class=\"line\">.</span><br><span class=\"line\"><span class=\"comment\"># 邮件基本设置</span></span><br><span class=\"line\"><span class=\"comment\">### Email Settings</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'gitlab_email_enabled'</span>] = <span class=\"literal\">true</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'gitlab_email_from'</span>] = <span class=\"string\">'admin@uscnk.com'</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'gitlab_email_display_name'</span>] = <span class=\"string\">'Gitlab'</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'gitlab_email_reply_to'</span>] = <span class=\"string\">'admin@uscnk.com'</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'gitlab_email_subject_suffix'</span>] = <span class=\"string\">'Gitlab'</span></span><br><span class=\"line\"></span><br><span class=\"line\">.</span><br><span class=\"line\">.</span><br><span class=\"line\">.</span><br><span class=\"line\"><span class=\"comment\">### GitLab email server settings</span></span><br><span class=\"line\"><span class=\"comment\">###! Docs: https://docs.gitlab.com/omnibus/settings/smtp.html</span></span><br><span class=\"line\"><span class=\"comment\">###! **Use smtp instead of sendmail/postfix.**</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_enable'] = true</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_address'] = \"smtp.server\"</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_port'] = 465</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_user_name'] = \"smtp user\"</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_password'] = \"smtp password\"</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_domain'] = \"example.com\"</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_authentication'] = \"login\"</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_enable_starttls_auto'] = true</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_tls'] = false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 邮件服务地址</span></span><br><span class=\"line\"><span class=\"comment\"># QQ exmail (腾讯企业邮箱)</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_enable'</span>] = <span class=\"literal\">true</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_address'</span>] = <span class=\"string\">\"smtp.exmail.qq.com\"</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_port'</span>] = 465</span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_user_name'</span>] = <span class=\"string\">\"admin@uscnk.com\"</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_password'</span>] = <span class=\"string\">\"xxxxxxxxx\"</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_authentication'</span>] = <span class=\"string\">\"login\"</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_enable_starttls_auto'</span>] = <span class=\"literal\">true</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_tls'</span>] = <span class=\"literal\">true</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'gitlab_email_from'</span>] = <span class=\"string\">'admin@uscnk.com'</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># nginx基本设置</span></span><br><span class=\"line\"><span class=\"comment\">################################################################################</span></span><br><span class=\"line\"><span class=\"comment\">## GitLab Nginx</span></span><br><span class=\"line\"><span class=\"comment\">##! Docs: https://docs.gitlab.com/omnibus/settings/nginx.html</span></span><br><span class=\"line\"><span class=\"comment\">################################################################################</span></span><br><span class=\"line\"></span><br><span class=\"line\">nginx[<span class=\"string\">'listen_addresses'</span>] = [<span class=\"string\">'192.168.0.19'</span>]</span><br><span class=\"line\">nginx[<span class=\"string\">'losten_port'</span>] = 1500</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"启动\"><a href=\"#启动\" class=\"headerlink\" title=\"启动\"></a>启动</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 重启服务</span></span><br><span class=\"line\">sudo gitlab-ctl reconfigure</span><br><span class=\"line\"><span class=\"comment\"># 重启邮件服务</span></span><br><span class=\"line\">sudo /etc/init.d/postfix restart</span><br><span class=\"line\"><span class=\"comment\"># 访问</span></span><br><span class=\"line\">http://192.168.0.19:1500</span><br><span class=\"line\">Username: root</span><br><span class=\"line\">Password: 5iveL!fe</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"github与gitlab共存\"><a href=\"#github与gitlab共存\" class=\"headerlink\" title=\"github与gitlab共存\"></a>github与gitlab共存</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># github账户邮箱， 将id_rsa改名成id_rsa_github</span></span><br><span class=\"line\">ssh-keygen -t rsa -C <span class=\"string\">\"xxxxx@gmail.com\"</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab公司邮箱， 将id_rsa改名成id_rsa_gitlab</span></span><br><span class=\"line\">ssh-keygen -t rsa -C <span class=\"string\">\"xxxxxx@work.com\"</span></span><br><span class=\"line\"><span class=\"comment\"># 添加私钥</span></span><br><span class=\"line\">ssh-add ~/.ssh/id_rsa_github</span><br><span class=\"line\">ssh-add ~/.ssh/id_rsa_gitlab</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#在 ~/.ssh 目录下新建一个config文件</span></span><br><span class=\"line\">touch config</span><br><span class=\"line\">chmod 755 conifg</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 并添加以下内容</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab</span></span><br><span class=\"line\">Host github.com</span><br><span class=\"line\">    HostName github.com</span><br><span class=\"line\">    PreferredAuthentications publickey</span><br><span class=\"line\">    IdentityFile ~/.ssh/id_rsa_github</span><br><span class=\"line\"><span class=\"comment\"># github</span></span><br><span class=\"line\">Host gitlib.com</span><br><span class=\"line\">    HostName gitlib.com</span><br><span class=\"line\">    PreferredAuthentications publickey</span><br><span class=\"line\">    IdentityFile ~/.ssh/id_rsa_gitlab</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将id_rsa_github.pab内容添加到github中</span></span><br><span class=\"line\"><span class=\"comment\"># 测试结果</span></span><br><span class=\"line\">ssh -T git@github.com</span><br><span class=\"line\"><span class=\"comment\"># 将id_rsa_gitlab.pab内容添加到gitlab中</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">cd</span> ~/mytest</span><br><span class=\"line\"><span class=\"comment\"># 在github中测试</span></span><br><span class=\"line\">git remote add github https://github.com/zhcshine/mytest.git</span><br><span class=\"line\">git push -u github master</span><br><span class=\"line\"><span class=\"comment\"># 在gitlab中测试</span></span><br><span class=\"line\">git remote add gitlab http://192.168.0.19:1500/zhcshine/mytest.git</span><br><span class=\"line\">git push -u gitlab master</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装相关服务 postfix为邮件服务</span></span><br><span class=\"line\">sudo apt-get install curl openssh-server ca-certificates postfix</span><br><span class=\"line\"><span class=\"comment\"># 安装gitlab服务包</span></span><br><span class=\"line\">curl -sS https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash</span><br><span class=\"line\">sudo apt-get install gitlab-ce</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 配置服务</span></span><br><span class=\"line\">sudo vim /etc/gitlab/gitlab.rb</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## GitLab URL</span></span><br><span class=\"line\"><span class=\"comment\">##! URL on which GitLab will be reachable.</span></span><br><span class=\"line\"><span class=\"comment\">##! For more details on configuring external_url see:</span></span><br><span class=\"line\"><span class=\"comment\">##! https://docs.gitlab.com/omnibus/settings/configuration.html#configuring-the-external-url-for-gitlab</span></span><br><span class=\"line\">external_url <span class=\"string\">'http:/192.168.0.19:1500'</span>    <span class=\"comment\"># 地址</span></span><br><span class=\"line\"></span><br><span class=\"line\">.</span><br><span class=\"line\">.</span><br><span class=\"line\">.</span><br><span class=\"line\"><span class=\"comment\"># 邮件基本设置</span></span><br><span class=\"line\"><span class=\"comment\">### Email Settings</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'gitlab_email_enabled'</span>] = <span class=\"literal\">true</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'gitlab_email_from'</span>] = <span class=\"string\">'admin@uscnk.com'</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'gitlab_email_display_name'</span>] = <span class=\"string\">'Gitlab'</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'gitlab_email_reply_to'</span>] = <span class=\"string\">'admin@uscnk.com'</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'gitlab_email_subject_suffix'</span>] = <span class=\"string\">'Gitlab'</span></span><br><span class=\"line\"></span><br><span class=\"line\">.</span><br><span class=\"line\">.</span><br><span class=\"line\">.</span><br><span class=\"line\"><span class=\"comment\">### GitLab email server settings</span></span><br><span class=\"line\"><span class=\"comment\">###! Docs: https://docs.gitlab.com/omnibus/settings/smtp.html</span></span><br><span class=\"line\"><span class=\"comment\">###! **Use smtp instead of sendmail/postfix.**</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_enable'] = true</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_address'] = \"smtp.server\"</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_port'] = 465</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_user_name'] = \"smtp user\"</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_password'] = \"smtp password\"</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_domain'] = \"example.com\"</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_authentication'] = \"login\"</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_enable_starttls_auto'] = true</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab_rails['smtp_tls'] = false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 邮件服务地址</span></span><br><span class=\"line\"><span class=\"comment\"># QQ exmail (腾讯企业邮箱)</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_enable'</span>] = <span class=\"literal\">true</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_address'</span>] = <span class=\"string\">\"smtp.exmail.qq.com\"</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_port'</span>] = 465</span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_user_name'</span>] = <span class=\"string\">\"admin@uscnk.com\"</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_password'</span>] = <span class=\"string\">\"xxxxxxxxx\"</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_authentication'</span>] = <span class=\"string\">\"login\"</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_enable_starttls_auto'</span>] = <span class=\"literal\">true</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'smtp_tls'</span>] = <span class=\"literal\">true</span></span><br><span class=\"line\">gitlab_rails[<span class=\"string\">'gitlab_email_from'</span>] = <span class=\"string\">'admin@uscnk.com'</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># nginx基本设置</span></span><br><span class=\"line\"><span class=\"comment\">################################################################################</span></span><br><span class=\"line\"><span class=\"comment\">## GitLab Nginx</span></span><br><span class=\"line\"><span class=\"comment\">##! Docs: https://docs.gitlab.com/omnibus/settings/nginx.html</span></span><br><span class=\"line\"><span class=\"comment\">################################################################################</span></span><br><span class=\"line\"></span><br><span class=\"line\">nginx[<span class=\"string\">'listen_addresses'</span>] = [<span class=\"string\">'192.168.0.19'</span>]</span><br><span class=\"line\">nginx[<span class=\"string\">'losten_port'</span>] = 1500</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"启动\"><a href=\"#启动\" class=\"headerlink\" title=\"启动\"></a>启动</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 重启服务</span></span><br><span class=\"line\">sudo gitlab-ctl reconfigure</span><br><span class=\"line\"><span class=\"comment\"># 重启邮件服务</span></span><br><span class=\"line\">sudo /etc/init.d/postfix restart</span><br><span class=\"line\"><span class=\"comment\"># 访问</span></span><br><span class=\"line\">http://192.168.0.19:1500</span><br><span class=\"line\">Username: root</span><br><span class=\"line\">Password: 5iveL!fe</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"github与gitlab共存\"><a href=\"#github与gitlab共存\" class=\"headerlink\" title=\"github与gitlab共存\"></a>github与gitlab共存</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># github账户邮箱， 将id_rsa改名成id_rsa_github</span></span><br><span class=\"line\">ssh-keygen -t rsa -C <span class=\"string\">\"xxxxx@gmail.com\"</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab公司邮箱， 将id_rsa改名成id_rsa_gitlab</span></span><br><span class=\"line\">ssh-keygen -t rsa -C <span class=\"string\">\"xxxxxx@work.com\"</span></span><br><span class=\"line\"><span class=\"comment\"># 添加私钥</span></span><br><span class=\"line\">ssh-add ~/.ssh/id_rsa_github</span><br><span class=\"line\">ssh-add ~/.ssh/id_rsa_gitlab</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#在 ~/.ssh 目录下新建一个config文件</span></span><br><span class=\"line\">touch config</span><br><span class=\"line\">chmod 755 conifg</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 并添加以下内容</span></span><br><span class=\"line\"><span class=\"comment\"># gitlab</span></span><br><span class=\"line\">Host github.com</span><br><span class=\"line\">    HostName github.com</span><br><span class=\"line\">    PreferredAuthentications publickey</span><br><span class=\"line\">    IdentityFile ~/.ssh/id_rsa_github</span><br><span class=\"line\"><span class=\"comment\"># github</span></span><br><span class=\"line\">Host gitlib.com</span><br><span class=\"line\">    HostName gitlib.com</span><br><span class=\"line\">    PreferredAuthentications publickey</span><br><span class=\"line\">    IdentityFile ~/.ssh/id_rsa_gitlab</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将id_rsa_github.pab内容添加到github中</span></span><br><span class=\"line\"><span class=\"comment\"># 测试结果</span></span><br><span class=\"line\">ssh -T git@github.com</span><br><span class=\"line\"><span class=\"comment\"># 将id_rsa_gitlab.pab内容添加到gitlab中</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">cd</span> ~/mytest</span><br><span class=\"line\"><span class=\"comment\"># 在github中测试</span></span><br><span class=\"line\">git remote add github https://github.com/zhcshine/mytest.git</span><br><span class=\"line\">git push -u github master</span><br><span class=\"line\"><span class=\"comment\"># 在gitlab中测试</span></span><br><span class=\"line\">git remote add gitlab http://192.168.0.19:1500/zhcshine/mytest.git</span><br><span class=\"line\">git push -u gitlab master</span><br></pre></td></tr></table></figure>"},{"title":"linux环境nginx/php-fpm权限问题","url":"576.html","id":"576","comments":0,"date":"2018-11-10T05:10:28.000Z","_content":"\n#### 当前用户hanchang, nginx用户nginx\n\n    vim /etc/nginx/nginx.conf\n    user hanchang;\n    \n\n    vim /etc/php-fpm.d/www.conf \n    user = hanchang\n    group = nginx\n    listen.owner = hanchang\n    listen.group = nginx\n    listen.mode = 0660\n    \n\n#### 划重点 将当前用户加入nginx用户组\n\n    sudo usermod -a -G nginx hanchang","source":"_posts/linux环境nginx-php-fpm权限问题.md","raw":"---\ntitle: linux环境nginx/php-fpm权限问题\nurl: 576.html\nid: 576\ncomments: false\ncategories:\n  - 运维\ndate: 2018-11-10 13:10:28\ntags:\n---\n\n#### 当前用户hanchang, nginx用户nginx\n\n    vim /etc/nginx/nginx.conf\n    user hanchang;\n    \n\n    vim /etc/php-fpm.d/www.conf \n    user = hanchang\n    group = nginx\n    listen.owner = hanchang\n    listen.group = nginx\n    listen.mode = 0660\n    \n\n#### 划重点 将当前用户加入nginx用户组\n\n    sudo usermod -a -G nginx hanchang","slug":"linux环境nginx-php-fpm权限问题","published":1,"updated":"2019-07-24T01:36:23.340Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5oh00309ka4i24htfsd","content":"<h4 id=\"当前用户hanchang-nginx用户nginx\"><a href=\"#当前用户hanchang-nginx用户nginx\" class=\"headerlink\" title=\"当前用户hanchang, nginx用户nginx\"></a>当前用户hanchang, nginx用户nginx</h4><pre><code>vim /etc/nginx/nginx.conf\nuser hanchang;\n\n\nvim /etc/php-fpm.d/www.conf \nuser = hanchang\ngroup = nginx\nlisten.owner = hanchang\nlisten.group = nginx\nlisten.mode = 0660</code></pre><h4 id=\"划重点-将当前用户加入nginx用户组\"><a href=\"#划重点-将当前用户加入nginx用户组\" class=\"headerlink\" title=\"划重点 将当前用户加入nginx用户组\"></a>划重点 将当前用户加入nginx用户组</h4><pre><code>sudo usermod -a -G nginx hanchang</code></pre>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"当前用户hanchang-nginx用户nginx\"><a href=\"#当前用户hanchang-nginx用户nginx\" class=\"headerlink\" title=\"当前用户hanchang, nginx用户nginx\"></a>当前用户hanchang, nginx用户nginx</h4><pre><code>vim /etc/nginx/nginx.conf\nuser hanchang;\n\n\nvim /etc/php-fpm.d/www.conf \nuser = hanchang\ngroup = nginx\nlisten.owner = hanchang\nlisten.group = nginx\nlisten.mode = 0660</code></pre><h4 id=\"划重点-将当前用户加入nginx用户组\"><a href=\"#划重点-将当前用户加入nginx用户组\" class=\"headerlink\" title=\"划重点 将当前用户加入nginx用户组\"></a>划重点 将当前用户加入nginx用户组</h4><pre><code>sudo usermod -a -G nginx hanchang</code></pre>"},{"title":"unittest单元测试","url":"118.html","id":"118","comments":0,"date":"2016-11-30T03:13:19.000Z","_content":"\n#### unittest基础使用方法\n\n    # -*- coding:utf-8 -*-\n    # calculator.py\n    # 需要测试的类\n    class Count:\n    \n        def __init__(self, a, b):\n            self.a = int(a)\n            self.b = int(b)\n    \n        def add(self):\n            return self.a + self.b\n    \n    \n\n    # -*- coding: utf-8 -*-\n    # test.py 测试类\n    from calculator import Count\n    import unittest\n    class TestCount(unittest.TestCase):\n        def setUp(self):\n            print 'test start'\n    \n        def test_add(self):\n            j = Count(2,3)\n            self.assertEqual(j.add(), 5)\n    \n        def test_add2(self):\n            j = Count(41, 76)\n            self.assertEqual(j.add(), 115, 'not equal')\n    \n        def tearDown(self):\n            print 'test end'\n    \n    \n    if __name__ == '__main__':\n        # 测试全部方法\n        # unittest.main()\n        # 构造测试集\n        suite = unittest.TestSuite()\n        # 指定测试方法\n        suite.addTest(TestCount('test_add2'))\n        # 执行测试\n        runner = unittest.TextTestRunner()\n        runner.run(suite)\n    \n    \n\n#### 自动识别测试用例\n\n    # -*- coding:utf-8 -*-\n    # calculator.py\n    # 需要测试的类\n    class Count:\n    \n        def __init__(self, a, b):\n            self.a = int(a)\n            self.b = int(b)\n    \n        def add(self):\n            return self.a + self.b\n    \n        def sub(self):\n            return self.a - self.b\n    \n\n    # -*- coding: utf-8 -*-\n    # testadd.py 测试类\n    from calculator import Count\n    import unittest\n    class TestAdd(unittest.TestCase):\n        def setUp(self):\n            print 'test add start'\n    \n        def test_add(self):\n            j = Count(2,3)\n            self.assertEqual(j.add(), 5)\n    \n        def test_add2(self):\n            j = Count(41, 76)\n            self.assertEqual(j.add(), 115, 'not equal')\n    \n        def tearDown(self):\n            print 'test add end'\n    \n    \n    if __name__ == '__main__':\n        # 测试全部方法\n        unittest.main()\n    \n\n    # -*- coding: utf-8 -*-\n    # testsub.py 测试类\n    from calculator import Count\n    import unittest\n    \n    \n    class TestSub(unittest.TestCase):\n        def setUp(self):\n            print 'test sub start'\n    \n        def test_sub(self):\n            j = Count(2,3)\n            self.assertEqual(j.sub(), 5)\n    \n        def test_sub2(self):\n            j = Count(41, 76)\n            self.assertEqual(j.sub(), 115, 'not equal')\n    \n        def tearDown(self):\n            print 'test sub end'\n    \n    \n    if __name__ == '__main__':\n        # 测试全部方法\n        unittest.main()\n    \n\n    # -*- coding: utf-8 -*-\n    # runtest.py\n    import unittest\n    test_dir = './'\n    discover = unittest.defaultTestLoader.discover(test_dir, pattern='test*.py')\n    if __name__ == '__main__':\n        runner = unittest.TextTestRunner()\n        runner.run(discover)\n    \n\n#### 断言方法啊\n\n    # unittest.TestCase.assertEqual(a, b, msg=None)   a == b\n    # unittest.TestCase.assertNotEqual(a, b) a !=b  \n    # unittest.TestCase.assertTrue(x)   x is True\n    # unittest.TestCase.assertFalse(x)  x is False\n    # unittest.TestCase.assertIs(a, b)  x is b\n    # unittest.TestCase.assertIsNot(a, b)  a is not b\n    # unittest.TestCase.assertIsNotNone(x)  x is not None\n    # unittest.TestCase.assertIn(a, b)  a in b\n    # unittest.TestCase.assertNotIn(a, b) a not in b\n    # unittest.TestCase.assertNotIsInstance(a, b) isinstance(a,b)\n    # unittest.TestCase.assertNotIsInstance(a, b) not isinstance(a,b)\n    \n\n#### 跳过测试与预期失败\n\n    # -*- coding: utf-8 -*-\n    # test.py\n    import unittest\n    \n    class MyTest(unittest.TestCase):\n    \n        def setUp(self):\n            pass\n        def tearDown(self):\n            pass\n    \n        @unittest.skip(u'直接跳过测试')\n        def test_skip(self):\n            print 'test aaa'\n    \n        @unittest.skipIf(3 > 2, u'条件满足时跳过测试')\n        def test_skip_if(self):\n            print 'test bbb'\n    \n        @unittest.skipUnless(3 > 2, u'条件满足时执行测试')\n        def test_skip_unless(self):\n            print 'test ccc'\n    \n        # 不管测试成功与否，都标记为失败\n        @unittest.expectedFailure\n        def test_expected_failure(self):\n            print 'test ddd'\n            self.assertEqual(2, 3)\n    \n    if __name__ == '__main__':\n        unittest.main()","source":"_posts/unittest单元测试.md","raw":"---\ntitle: unittest单元测试\ntags:\n  - python\nurl: 118.html\nid: 118\ncomments: false\ncategories:\n  - 后端\ndate: 2016-11-30 11:13:19\n---\n\n#### unittest基础使用方法\n\n    # -*- coding:utf-8 -*-\n    # calculator.py\n    # 需要测试的类\n    class Count:\n    \n        def __init__(self, a, b):\n            self.a = int(a)\n            self.b = int(b)\n    \n        def add(self):\n            return self.a + self.b\n    \n    \n\n    # -*- coding: utf-8 -*-\n    # test.py 测试类\n    from calculator import Count\n    import unittest\n    class TestCount(unittest.TestCase):\n        def setUp(self):\n            print 'test start'\n    \n        def test_add(self):\n            j = Count(2,3)\n            self.assertEqual(j.add(), 5)\n    \n        def test_add2(self):\n            j = Count(41, 76)\n            self.assertEqual(j.add(), 115, 'not equal')\n    \n        def tearDown(self):\n            print 'test end'\n    \n    \n    if __name__ == '__main__':\n        # 测试全部方法\n        # unittest.main()\n        # 构造测试集\n        suite = unittest.TestSuite()\n        # 指定测试方法\n        suite.addTest(TestCount('test_add2'))\n        # 执行测试\n        runner = unittest.TextTestRunner()\n        runner.run(suite)\n    \n    \n\n#### 自动识别测试用例\n\n    # -*- coding:utf-8 -*-\n    # calculator.py\n    # 需要测试的类\n    class Count:\n    \n        def __init__(self, a, b):\n            self.a = int(a)\n            self.b = int(b)\n    \n        def add(self):\n            return self.a + self.b\n    \n        def sub(self):\n            return self.a - self.b\n    \n\n    # -*- coding: utf-8 -*-\n    # testadd.py 测试类\n    from calculator import Count\n    import unittest\n    class TestAdd(unittest.TestCase):\n        def setUp(self):\n            print 'test add start'\n    \n        def test_add(self):\n            j = Count(2,3)\n            self.assertEqual(j.add(), 5)\n    \n        def test_add2(self):\n            j = Count(41, 76)\n            self.assertEqual(j.add(), 115, 'not equal')\n    \n        def tearDown(self):\n            print 'test add end'\n    \n    \n    if __name__ == '__main__':\n        # 测试全部方法\n        unittest.main()\n    \n\n    # -*- coding: utf-8 -*-\n    # testsub.py 测试类\n    from calculator import Count\n    import unittest\n    \n    \n    class TestSub(unittest.TestCase):\n        def setUp(self):\n            print 'test sub start'\n    \n        def test_sub(self):\n            j = Count(2,3)\n            self.assertEqual(j.sub(), 5)\n    \n        def test_sub2(self):\n            j = Count(41, 76)\n            self.assertEqual(j.sub(), 115, 'not equal')\n    \n        def tearDown(self):\n            print 'test sub end'\n    \n    \n    if __name__ == '__main__':\n        # 测试全部方法\n        unittest.main()\n    \n\n    # -*- coding: utf-8 -*-\n    # runtest.py\n    import unittest\n    test_dir = './'\n    discover = unittest.defaultTestLoader.discover(test_dir, pattern='test*.py')\n    if __name__ == '__main__':\n        runner = unittest.TextTestRunner()\n        runner.run(discover)\n    \n\n#### 断言方法啊\n\n    # unittest.TestCase.assertEqual(a, b, msg=None)   a == b\n    # unittest.TestCase.assertNotEqual(a, b) a !=b  \n    # unittest.TestCase.assertTrue(x)   x is True\n    # unittest.TestCase.assertFalse(x)  x is False\n    # unittest.TestCase.assertIs(a, b)  x is b\n    # unittest.TestCase.assertIsNot(a, b)  a is not b\n    # unittest.TestCase.assertIsNotNone(x)  x is not None\n    # unittest.TestCase.assertIn(a, b)  a in b\n    # unittest.TestCase.assertNotIn(a, b) a not in b\n    # unittest.TestCase.assertNotIsInstance(a, b) isinstance(a,b)\n    # unittest.TestCase.assertNotIsInstance(a, b) not isinstance(a,b)\n    \n\n#### 跳过测试与预期失败\n\n    # -*- coding: utf-8 -*-\n    # test.py\n    import unittest\n    \n    class MyTest(unittest.TestCase):\n    \n        def setUp(self):\n            pass\n        def tearDown(self):\n            pass\n    \n        @unittest.skip(u'直接跳过测试')\n        def test_skip(self):\n            print 'test aaa'\n    \n        @unittest.skipIf(3 > 2, u'条件满足时跳过测试')\n        def test_skip_if(self):\n            print 'test bbb'\n    \n        @unittest.skipUnless(3 > 2, u'条件满足时执行测试')\n        def test_skip_unless(self):\n            print 'test ccc'\n    \n        # 不管测试成功与否，都标记为失败\n        @unittest.expectedFailure\n        def test_expected_failure(self):\n            print 'test ddd'\n            self.assertEqual(2, 3)\n    \n    if __name__ == '__main__':\n        unittest.main()","slug":"unittest单元测试","published":1,"updated":"2019-07-24T01:35:07.600Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5oi00349ka4dip2p8c1","content":"<h4 id=\"unittest基础使用方法\"><a href=\"#unittest基础使用方法\" class=\"headerlink\" title=\"unittest基础使用方法\"></a>unittest基础使用方法</h4><pre><code># -*- coding:utf-8 -*-\n# calculator.py\n# 需要测试的类\nclass Count:\n\n    def __init__(self, a, b):\n        self.a = int(a)\n        self.b = int(b)\n\n    def add(self):\n        return self.a + self.b\n\n\n\n# -*- coding: utf-8 -*-\n# test.py 测试类\nfrom calculator import Count\nimport unittest\nclass TestCount(unittest.TestCase):\n    def setUp(self):\n        print &apos;test start&apos;\n\n    def test_add(self):\n        j = Count(2,3)\n        self.assertEqual(j.add(), 5)\n\n    def test_add2(self):\n        j = Count(41, 76)\n        self.assertEqual(j.add(), 115, &apos;not equal&apos;)\n\n    def tearDown(self):\n        print &apos;test end&apos;\n\n\nif __name__ == &apos;__main__&apos;:\n    # 测试全部方法\n    # unittest.main()\n    # 构造测试集\n    suite = unittest.TestSuite()\n    # 指定测试方法\n    suite.addTest(TestCount(&apos;test_add2&apos;))\n    # 执行测试\n    runner = unittest.TextTestRunner()\n    runner.run(suite)</code></pre><h4 id=\"自动识别测试用例\"><a href=\"#自动识别测试用例\" class=\"headerlink\" title=\"自动识别测试用例\"></a>自动识别测试用例</h4><pre><code># -*- coding:utf-8 -*-\n# calculator.py\n# 需要测试的类\nclass Count:\n\n    def __init__(self, a, b):\n        self.a = int(a)\n        self.b = int(b)\n\n    def add(self):\n        return self.a + self.b\n\n    def sub(self):\n        return self.a - self.b\n\n\n# -*- coding: utf-8 -*-\n# testadd.py 测试类\nfrom calculator import Count\nimport unittest\nclass TestAdd(unittest.TestCase):\n    def setUp(self):\n        print &apos;test add start&apos;\n\n    def test_add(self):\n        j = Count(2,3)\n        self.assertEqual(j.add(), 5)\n\n    def test_add2(self):\n        j = Count(41, 76)\n        self.assertEqual(j.add(), 115, &apos;not equal&apos;)\n\n    def tearDown(self):\n        print &apos;test add end&apos;\n\n\nif __name__ == &apos;__main__&apos;:\n    # 测试全部方法\n    unittest.main()\n\n\n# -*- coding: utf-8 -*-\n# testsub.py 测试类\nfrom calculator import Count\nimport unittest\n\n\nclass TestSub(unittest.TestCase):\n    def setUp(self):\n        print &apos;test sub start&apos;\n\n    def test_sub(self):\n        j = Count(2,3)\n        self.assertEqual(j.sub(), 5)\n\n    def test_sub2(self):\n        j = Count(41, 76)\n        self.assertEqual(j.sub(), 115, &apos;not equal&apos;)\n\n    def tearDown(self):\n        print &apos;test sub end&apos;\n\n\nif __name__ == &apos;__main__&apos;:\n    # 测试全部方法\n    unittest.main()\n\n\n# -*- coding: utf-8 -*-\n# runtest.py\nimport unittest\ntest_dir = &apos;./&apos;\ndiscover = unittest.defaultTestLoader.discover(test_dir, pattern=&apos;test*.py&apos;)\nif __name__ == &apos;__main__&apos;:\n    runner = unittest.TextTestRunner()\n    runner.run(discover)</code></pre><h4 id=\"断言方法啊\"><a href=\"#断言方法啊\" class=\"headerlink\" title=\"断言方法啊\"></a>断言方法啊</h4><pre><code># unittest.TestCase.assertEqual(a, b, msg=None)   a == b\n# unittest.TestCase.assertNotEqual(a, b) a !=b  \n# unittest.TestCase.assertTrue(x)   x is True\n# unittest.TestCase.assertFalse(x)  x is False\n# unittest.TestCase.assertIs(a, b)  x is b\n# unittest.TestCase.assertIsNot(a, b)  a is not b\n# unittest.TestCase.assertIsNotNone(x)  x is not None\n# unittest.TestCase.assertIn(a, b)  a in b\n# unittest.TestCase.assertNotIn(a, b) a not in b\n# unittest.TestCase.assertNotIsInstance(a, b) isinstance(a,b)\n# unittest.TestCase.assertNotIsInstance(a, b) not isinstance(a,b)</code></pre><h4 id=\"跳过测试与预期失败\"><a href=\"#跳过测试与预期失败\" class=\"headerlink\" title=\"跳过测试与预期失败\"></a>跳过测试与预期失败</h4><pre><code># -*- coding: utf-8 -*-\n# test.py\nimport unittest\n\nclass MyTest(unittest.TestCase):\n\n    def setUp(self):\n        pass\n    def tearDown(self):\n        pass\n\n    @unittest.skip(u&apos;直接跳过测试&apos;)\n    def test_skip(self):\n        print &apos;test aaa&apos;\n\n    @unittest.skipIf(3 &gt; 2, u&apos;条件满足时跳过测试&apos;)\n    def test_skip_if(self):\n        print &apos;test bbb&apos;\n\n    @unittest.skipUnless(3 &gt; 2, u&apos;条件满足时执行测试&apos;)\n    def test_skip_unless(self):\n        print &apos;test ccc&apos;\n\n    # 不管测试成功与否，都标记为失败\n    @unittest.expectedFailure\n    def test_expected_failure(self):\n        print &apos;test ddd&apos;\n        self.assertEqual(2, 3)\n\nif __name__ == &apos;__main__&apos;:\n    unittest.main()</code></pre>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"unittest基础使用方法\"><a href=\"#unittest基础使用方法\" class=\"headerlink\" title=\"unittest基础使用方法\"></a>unittest基础使用方法</h4><pre><code># -*- coding:utf-8 -*-\n# calculator.py\n# 需要测试的类\nclass Count:\n\n    def __init__(self, a, b):\n        self.a = int(a)\n        self.b = int(b)\n\n    def add(self):\n        return self.a + self.b\n\n\n\n# -*- coding: utf-8 -*-\n# test.py 测试类\nfrom calculator import Count\nimport unittest\nclass TestCount(unittest.TestCase):\n    def setUp(self):\n        print &apos;test start&apos;\n\n    def test_add(self):\n        j = Count(2,3)\n        self.assertEqual(j.add(), 5)\n\n    def test_add2(self):\n        j = Count(41, 76)\n        self.assertEqual(j.add(), 115, &apos;not equal&apos;)\n\n    def tearDown(self):\n        print &apos;test end&apos;\n\n\nif __name__ == &apos;__main__&apos;:\n    # 测试全部方法\n    # unittest.main()\n    # 构造测试集\n    suite = unittest.TestSuite()\n    # 指定测试方法\n    suite.addTest(TestCount(&apos;test_add2&apos;))\n    # 执行测试\n    runner = unittest.TextTestRunner()\n    runner.run(suite)</code></pre><h4 id=\"自动识别测试用例\"><a href=\"#自动识别测试用例\" class=\"headerlink\" title=\"自动识别测试用例\"></a>自动识别测试用例</h4><pre><code># -*- coding:utf-8 -*-\n# calculator.py\n# 需要测试的类\nclass Count:\n\n    def __init__(self, a, b):\n        self.a = int(a)\n        self.b = int(b)\n\n    def add(self):\n        return self.a + self.b\n\n    def sub(self):\n        return self.a - self.b\n\n\n# -*- coding: utf-8 -*-\n# testadd.py 测试类\nfrom calculator import Count\nimport unittest\nclass TestAdd(unittest.TestCase):\n    def setUp(self):\n        print &apos;test add start&apos;\n\n    def test_add(self):\n        j = Count(2,3)\n        self.assertEqual(j.add(), 5)\n\n    def test_add2(self):\n        j = Count(41, 76)\n        self.assertEqual(j.add(), 115, &apos;not equal&apos;)\n\n    def tearDown(self):\n        print &apos;test add end&apos;\n\n\nif __name__ == &apos;__main__&apos;:\n    # 测试全部方法\n    unittest.main()\n\n\n# -*- coding: utf-8 -*-\n# testsub.py 测试类\nfrom calculator import Count\nimport unittest\n\n\nclass TestSub(unittest.TestCase):\n    def setUp(self):\n        print &apos;test sub start&apos;\n\n    def test_sub(self):\n        j = Count(2,3)\n        self.assertEqual(j.sub(), 5)\n\n    def test_sub2(self):\n        j = Count(41, 76)\n        self.assertEqual(j.sub(), 115, &apos;not equal&apos;)\n\n    def tearDown(self):\n        print &apos;test sub end&apos;\n\n\nif __name__ == &apos;__main__&apos;:\n    # 测试全部方法\n    unittest.main()\n\n\n# -*- coding: utf-8 -*-\n# runtest.py\nimport unittest\ntest_dir = &apos;./&apos;\ndiscover = unittest.defaultTestLoader.discover(test_dir, pattern=&apos;test*.py&apos;)\nif __name__ == &apos;__main__&apos;:\n    runner = unittest.TextTestRunner()\n    runner.run(discover)</code></pre><h4 id=\"断言方法啊\"><a href=\"#断言方法啊\" class=\"headerlink\" title=\"断言方法啊\"></a>断言方法啊</h4><pre><code># unittest.TestCase.assertEqual(a, b, msg=None)   a == b\n# unittest.TestCase.assertNotEqual(a, b) a !=b  \n# unittest.TestCase.assertTrue(x)   x is True\n# unittest.TestCase.assertFalse(x)  x is False\n# unittest.TestCase.assertIs(a, b)  x is b\n# unittest.TestCase.assertIsNot(a, b)  a is not b\n# unittest.TestCase.assertIsNotNone(x)  x is not None\n# unittest.TestCase.assertIn(a, b)  a in b\n# unittest.TestCase.assertNotIn(a, b) a not in b\n# unittest.TestCase.assertNotIsInstance(a, b) isinstance(a,b)\n# unittest.TestCase.assertNotIsInstance(a, b) not isinstance(a,b)</code></pre><h4 id=\"跳过测试与预期失败\"><a href=\"#跳过测试与预期失败\" class=\"headerlink\" title=\"跳过测试与预期失败\"></a>跳过测试与预期失败</h4><pre><code># -*- coding: utf-8 -*-\n# test.py\nimport unittest\n\nclass MyTest(unittest.TestCase):\n\n    def setUp(self):\n        pass\n    def tearDown(self):\n        pass\n\n    @unittest.skip(u&apos;直接跳过测试&apos;)\n    def test_skip(self):\n        print &apos;test aaa&apos;\n\n    @unittest.skipIf(3 &gt; 2, u&apos;条件满足时跳过测试&apos;)\n    def test_skip_if(self):\n        print &apos;test bbb&apos;\n\n    @unittest.skipUnless(3 &gt; 2, u&apos;条件满足时执行测试&apos;)\n    def test_skip_unless(self):\n        print &apos;test ccc&apos;\n\n    # 不管测试成功与否，都标记为失败\n    @unittest.expectedFailure\n    def test_expected_failure(self):\n        print &apos;test ddd&apos;\n        self.assertEqual(2, 3)\n\nif __name__ == &apos;__main__&apos;:\n    unittest.main()</code></pre>"},{"title":"windowsserver服务器基础设置","url":"76.html","id":"76","comments":0,"date":"2016-11-09T08:04:17.000Z","_content":"\n### 远程连接\n\n禁止administrators组远程连接\n\n> 运行gpedit.msc  \n> 计算机配置->windows设置->安全设置->本地策略->用户权限分配->通过终端服务允许登录  \n> 将Administrators账号删除掉,保留Remote Desktop Users\n\n创建新的用户\n\n> 本地用户和组->用户右键->新用户->输入用户名，设置密码 添加Administrators组，Remote Desktop Users组\n\n限制登陆次数\n\n> 计算机配置->windows设置->安全设置->账户策略->账户锁定策略”，“账户锁定阈值”设置为 20后，系统会自动设置锁定时间和计数器\n\n3389端口修改\n\n> 修改注册表，是不是需要修改？\n\n超过2个远程连接处理办法及规避方法\n\n    mstsc /console /v:10.10.10.10:3389\n    \n\n> 开始－管理工具－终端服务配置－服务器配置－限制每个用户使用一个会话\n\n### 防火墙\n\n开启防火墙\n\n> 控制面板>防火墙>开启  \n> 例外里勾选远程桌面,保证服务器可以正常连接  \n> 其他情况就在添加端口里添加即可\n\n### FTP\n\n开启ftp\n\n> 在控制面板的添加/删除程序——Windows组件向导——应用程序服务器——Internet信息服务(IIS)中选中“文件传输协议(FTP)服务”。  \n> 需要文件夹AMD64 设置一个ftp用户ftpuser  \n> 在ftp设置中关掉允许匿名连接  \n> 主目录中本地路径为E:\\\\FTP  \n> 不要勾选写入权限  \n> 默认ftp站点新建虚拟目录ftpuser 路径E:\\\\FTP\\\\ftpuser  \n> 在防火墙上开启20，21端口 在ftp客户端选择port主动模式，主动模式不需要服务器开启其他端口","source":"_posts/windowsserver服务器基础设置.md","raw":"---\ntitle: windowsserver服务器基础设置\ntags:\n  - windows\nurl: 76.html\nid: 76\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-09 16:04:17\n---\n\n### 远程连接\n\n禁止administrators组远程连接\n\n> 运行gpedit.msc  \n> 计算机配置->windows设置->安全设置->本地策略->用户权限分配->通过终端服务允许登录  \n> 将Administrators账号删除掉,保留Remote Desktop Users\n\n创建新的用户\n\n> 本地用户和组->用户右键->新用户->输入用户名，设置密码 添加Administrators组，Remote Desktop Users组\n\n限制登陆次数\n\n> 计算机配置->windows设置->安全设置->账户策略->账户锁定策略”，“账户锁定阈值”设置为 20后，系统会自动设置锁定时间和计数器\n\n3389端口修改\n\n> 修改注册表，是不是需要修改？\n\n超过2个远程连接处理办法及规避方法\n\n    mstsc /console /v:10.10.10.10:3389\n    \n\n> 开始－管理工具－终端服务配置－服务器配置－限制每个用户使用一个会话\n\n### 防火墙\n\n开启防火墙\n\n> 控制面板>防火墙>开启  \n> 例外里勾选远程桌面,保证服务器可以正常连接  \n> 其他情况就在添加端口里添加即可\n\n### FTP\n\n开启ftp\n\n> 在控制面板的添加/删除程序——Windows组件向导——应用程序服务器——Internet信息服务(IIS)中选中“文件传输协议(FTP)服务”。  \n> 需要文件夹AMD64 设置一个ftp用户ftpuser  \n> 在ftp设置中关掉允许匿名连接  \n> 主目录中本地路径为E:\\\\FTP  \n> 不要勾选写入权限  \n> 默认ftp站点新建虚拟目录ftpuser 路径E:\\\\FTP\\\\ftpuser  \n> 在防火墙上开启20，21端口 在ftp客户端选择port主动模式，主动模式不需要服务器开启其他端口","slug":"windowsserver服务器基础设置","published":1,"updated":"2019-07-24T01:36:42.606Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5oj00379ka4jc79sz30","content":"<h3 id=\"远程连接\"><a href=\"#远程连接\" class=\"headerlink\" title=\"远程连接\"></a>远程连接</h3><p>禁止administrators组远程连接</p>\n<blockquote>\n<p>运行gpedit.msc<br>计算机配置-&gt;windows设置-&gt;安全设置-&gt;本地策略-&gt;用户权限分配-&gt;通过终端服务允许登录<br>将Administrators账号删除掉,保留Remote Desktop Users</p>\n</blockquote>\n<p>创建新的用户</p>\n<blockquote>\n<p>本地用户和组-&gt;用户右键-&gt;新用户-&gt;输入用户名，设置密码 添加Administrators组，Remote Desktop Users组</p>\n</blockquote>\n<p>限制登陆次数</p>\n<blockquote>\n<p>计算机配置-&gt;windows设置-&gt;安全设置-&gt;账户策略-&gt;账户锁定策略”，“账户锁定阈值”设置为 20后，系统会自动设置锁定时间和计数器</p>\n</blockquote>\n<p>3389端口修改</p>\n<blockquote>\n<p>修改注册表，是不是需要修改？</p>\n</blockquote>\n<p>超过2个远程连接处理办法及规避方法</p>\n<pre><code>mstsc /console /v:10.10.10.10:3389</code></pre><blockquote>\n<p>开始－管理工具－终端服务配置－服务器配置－限制每个用户使用一个会话</p>\n</blockquote>\n<h3 id=\"防火墙\"><a href=\"#防火墙\" class=\"headerlink\" title=\"防火墙\"></a>防火墙</h3><p>开启防火墙</p>\n<blockquote>\n<p>控制面板&gt;防火墙&gt;开启<br>例外里勾选远程桌面,保证服务器可以正常连接<br>其他情况就在添加端口里添加即可</p>\n</blockquote>\n<h3 id=\"FTP\"><a href=\"#FTP\" class=\"headerlink\" title=\"FTP\"></a>FTP</h3><p>开启ftp</p>\n<blockquote>\n<p>在控制面板的添加/删除程序——Windows组件向导——应用程序服务器——Internet信息服务(IIS)中选中“文件传输协议(FTP)服务”。<br>需要文件夹AMD64 设置一个ftp用户ftpuser<br>在ftp设置中关掉允许匿名连接<br>主目录中本地路径为E:\\FTP<br>不要勾选写入权限<br>默认ftp站点新建虚拟目录ftpuser 路径E:\\FTP\\ftpuser<br>在防火墙上开启20，21端口 在ftp客户端选择port主动模式，主动模式不需要服务器开启其他端口</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"远程连接\"><a href=\"#远程连接\" class=\"headerlink\" title=\"远程连接\"></a>远程连接</h3><p>禁止administrators组远程连接</p>\n<blockquote>\n<p>运行gpedit.msc<br>计算机配置-&gt;windows设置-&gt;安全设置-&gt;本地策略-&gt;用户权限分配-&gt;通过终端服务允许登录<br>将Administrators账号删除掉,保留Remote Desktop Users</p>\n</blockquote>\n<p>创建新的用户</p>\n<blockquote>\n<p>本地用户和组-&gt;用户右键-&gt;新用户-&gt;输入用户名，设置密码 添加Administrators组，Remote Desktop Users组</p>\n</blockquote>\n<p>限制登陆次数</p>\n<blockquote>\n<p>计算机配置-&gt;windows设置-&gt;安全设置-&gt;账户策略-&gt;账户锁定策略”，“账户锁定阈值”设置为 20后，系统会自动设置锁定时间和计数器</p>\n</blockquote>\n<p>3389端口修改</p>\n<blockquote>\n<p>修改注册表，是不是需要修改？</p>\n</blockquote>\n<p>超过2个远程连接处理办法及规避方法</p>\n<pre><code>mstsc /console /v:10.10.10.10:3389</code></pre><blockquote>\n<p>开始－管理工具－终端服务配置－服务器配置－限制每个用户使用一个会话</p>\n</blockquote>\n<h3 id=\"防火墙\"><a href=\"#防火墙\" class=\"headerlink\" title=\"防火墙\"></a>防火墙</h3><p>开启防火墙</p>\n<blockquote>\n<p>控制面板&gt;防火墙&gt;开启<br>例外里勾选远程桌面,保证服务器可以正常连接<br>其他情况就在添加端口里添加即可</p>\n</blockquote>\n<h3 id=\"FTP\"><a href=\"#FTP\" class=\"headerlink\" title=\"FTP\"></a>FTP</h3><p>开启ftp</p>\n<blockquote>\n<p>在控制面板的添加/删除程序——Windows组件向导——应用程序服务器——Internet信息服务(IIS)中选中“文件传输协议(FTP)服务”。<br>需要文件夹AMD64 设置一个ftp用户ftpuser<br>在ftp设置中关掉允许匿名连接<br>主目录中本地路径为E:\\FTP<br>不要勾选写入权限<br>默认ftp站点新建虚拟目录ftpuser 路径E:\\FTP\\ftpuser<br>在防火墙上开启20，21端口 在ftp客户端选择port主动模式，主动模式不需要服务器开启其他端口</p>\n</blockquote>\n"},{"title":"windows软件运行时错误429,ACTIVEX部件不能创建对象的解决方法","url":"70.html","id":"70","comments":0,"date":"2016-11-09T07:38:56.000Z","_content":"\n### 安装软件出现“ACTIVEX部件不能创建对象”\n\n提示错误\n\n> 中文：“运行时错误429，ActiveX部件不能创建对象”  \n> 英文：\"Run-time error '429' ActiveX componnent can't create object\"\n\n新建文件，将下面代码复制粘贴，文件另存为xxx.bat 运行xxx.bat，重启电脑，OK.\n\n    echo 正在修复，这个过程可能需要几分钟，请稍候…… \n    rundll32.exe advpack.dll /DelNodeRunDLL32 %systemroot%\\System32\\dacui.dll \n    rundll32.exe advpack.dll /DelNodeRunDLL32 %systemroot%\\Catroot\\icatalog.mdb \n    regsvr32 /s comcat.dll \n    regsvr32 /s asctrls.ocx \n    regsvr32 /s oleaut32.dll \n    regsvr32 /s shdocvw.dll /I \n    regsvr32 /s shdocvw.dll \n    regsvr32 /s browseui.dll \n    regsvr32 /s browseui.dll /I \n    regsvr32 /s msrating.dll \n    regsvr32 /s mlang.dll \n    regsvr32 /s hlink.dll \n    regsvr32 /s mshtml.dll \n    regsvr32 /s mshtmled.dll \n    regsvr32 /s urlmon.dll \n    regsvr32 /s plugin.ocx \n    regsvr32 /s sendmail.dll \n    regsvr32 /s mshtml.dll /i \n    regsvr32 /s scrobj.dll \n    regsvr32 /s corpol.dll \n    regsvr32 /s jscrīpt.dll \n    regsvr32 /s msxml.dll \n    regsvr32 /s imgutil.dll \n    regsvr32 /s cryptext.dll \n    regsvr32 /s inseng.dll \n    regsvr32 /s iesetup.dll /i \n    regsvr32 /s cryptdlg.dll \n    regsvr32 /s actxprxy.dll \n    regsvr32 /s dispex.dll \n    regsvr32 /s occache.dll \n    regsvr32 /s iepeers.dll \n    regsvr32 /s urlmon.dll /i \n    regsvr32 /s cdfview.dll \n    regsvr32 /s webcheck.dll \n    regsvr32 /s mobsync.dll \n    regsvr32 /s pngfilt.dll \n    regsvr32 /s licmgr10.dll \n    regsvr32 /s hhctrl.ocx \n    regsvr32 /s inetcfg.dll \n    regsvr32 /s trialoc.dll \n    regsvr32 /s tdc.ocx \n    regsvr32 /s MSR2C.DLL \n    regsvr32 /s msident.dll \n    regsvr32 /s msieftp.dll \n    regsvr32 /s xmsconf.ocx \n    regsvr32 /s ils.dll \n    regsvr32 /s msoeacct.dll \n    regsvr32 /s wab32.dll \n    regsvr32 /s wabimp.dll \n    regsvr32 /s wabfind.dll \n    regsvr32 /s oemiglib.dll \n    regsvr32 /s directdb.dll \n    regsvr32 /s inetcomm.dll \n    regsvr32 /s msoe.dll \n    regsvr32 /s oeimport.dll \n    regsvr32 /s msdxm.ocx \n    regsvr32 /s dxmasf.dll \n    regsvr32 /s laprxy.dll \n    regsvr32 /s l3codecx.ax \n    regsvr32 /s acelpdec.ax \n    regsvr32 /s mpg4ds32.ax \n    regsvr32 /s danim.dll \n    regsvr32 /s Daxctle.ocx \n    regsvr32 /s lmrt.dll \n    regsvr32 /s datime.dll \n    regsvr32 /s dxtrans.dll \n    regsvr32 /s dxtmsft.dll \n    regsvr32 /s wshom.ocx \n    regsvr32 /s wshext.dll \n    regsvr32 /s vbscrīpt.dll \n    regsvr32 /s scrrun.dll mstinit.exe /setup \n    regsvr32 /s msnsspc.dll /SspcCreateSspiReg \n    regsvr32 /s msapsspc.dll /SspcCreateSspiReg \n    echo. \n    echo. \n    echo 修复成功！任意键退出！ \n    pause>nul","source":"_posts/windows软件运行时错误429,ACTIVEX部件不能创建对象的解决方法.md","raw":"---\ntitle: windows软件运行时错误429,ACTIVEX部件不能创建对象的解决方法\nurl: 70.html\nid: 70\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-09 15:38:56\ntags:\n---\n\n### 安装软件出现“ACTIVEX部件不能创建对象”\n\n提示错误\n\n> 中文：“运行时错误429，ActiveX部件不能创建对象”  \n> 英文：\"Run-time error '429' ActiveX componnent can't create object\"\n\n新建文件，将下面代码复制粘贴，文件另存为xxx.bat 运行xxx.bat，重启电脑，OK.\n\n    echo 正在修复，这个过程可能需要几分钟，请稍候…… \n    rundll32.exe advpack.dll /DelNodeRunDLL32 %systemroot%\\System32\\dacui.dll \n    rundll32.exe advpack.dll /DelNodeRunDLL32 %systemroot%\\Catroot\\icatalog.mdb \n    regsvr32 /s comcat.dll \n    regsvr32 /s asctrls.ocx \n    regsvr32 /s oleaut32.dll \n    regsvr32 /s shdocvw.dll /I \n    regsvr32 /s shdocvw.dll \n    regsvr32 /s browseui.dll \n    regsvr32 /s browseui.dll /I \n    regsvr32 /s msrating.dll \n    regsvr32 /s mlang.dll \n    regsvr32 /s hlink.dll \n    regsvr32 /s mshtml.dll \n    regsvr32 /s mshtmled.dll \n    regsvr32 /s urlmon.dll \n    regsvr32 /s plugin.ocx \n    regsvr32 /s sendmail.dll \n    regsvr32 /s mshtml.dll /i \n    regsvr32 /s scrobj.dll \n    regsvr32 /s corpol.dll \n    regsvr32 /s jscrīpt.dll \n    regsvr32 /s msxml.dll \n    regsvr32 /s imgutil.dll \n    regsvr32 /s cryptext.dll \n    regsvr32 /s inseng.dll \n    regsvr32 /s iesetup.dll /i \n    regsvr32 /s cryptdlg.dll \n    regsvr32 /s actxprxy.dll \n    regsvr32 /s dispex.dll \n    regsvr32 /s occache.dll \n    regsvr32 /s iepeers.dll \n    regsvr32 /s urlmon.dll /i \n    regsvr32 /s cdfview.dll \n    regsvr32 /s webcheck.dll \n    regsvr32 /s mobsync.dll \n    regsvr32 /s pngfilt.dll \n    regsvr32 /s licmgr10.dll \n    regsvr32 /s hhctrl.ocx \n    regsvr32 /s inetcfg.dll \n    regsvr32 /s trialoc.dll \n    regsvr32 /s tdc.ocx \n    regsvr32 /s MSR2C.DLL \n    regsvr32 /s msident.dll \n    regsvr32 /s msieftp.dll \n    regsvr32 /s xmsconf.ocx \n    regsvr32 /s ils.dll \n    regsvr32 /s msoeacct.dll \n    regsvr32 /s wab32.dll \n    regsvr32 /s wabimp.dll \n    regsvr32 /s wabfind.dll \n    regsvr32 /s oemiglib.dll \n    regsvr32 /s directdb.dll \n    regsvr32 /s inetcomm.dll \n    regsvr32 /s msoe.dll \n    regsvr32 /s oeimport.dll \n    regsvr32 /s msdxm.ocx \n    regsvr32 /s dxmasf.dll \n    regsvr32 /s laprxy.dll \n    regsvr32 /s l3codecx.ax \n    regsvr32 /s acelpdec.ax \n    regsvr32 /s mpg4ds32.ax \n    regsvr32 /s danim.dll \n    regsvr32 /s Daxctle.ocx \n    regsvr32 /s lmrt.dll \n    regsvr32 /s datime.dll \n    regsvr32 /s dxtrans.dll \n    regsvr32 /s dxtmsft.dll \n    regsvr32 /s wshom.ocx \n    regsvr32 /s wshext.dll \n    regsvr32 /s vbscrīpt.dll \n    regsvr32 /s scrrun.dll mstinit.exe /setup \n    regsvr32 /s msnsspc.dll /SspcCreateSspiReg \n    regsvr32 /s msapsspc.dll /SspcCreateSspiReg \n    echo. \n    echo. \n    echo 修复成功！任意键退出！ \n    pause>nul","slug":"windows软件运行时错误429,ACTIVEX部件不能创建对象的解决方法","published":1,"updated":"2019-07-24T01:35:20.850Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5ok003a9ka4l4xd80od","content":"<h3 id=\"安装软件出现“ACTIVEX部件不能创建对象”\"><a href=\"#安装软件出现“ACTIVEX部件不能创建对象”\" class=\"headerlink\" title=\"安装软件出现“ACTIVEX部件不能创建对象”\"></a>安装软件出现“ACTIVEX部件不能创建对象”</h3><p>提示错误</p>\n<blockquote>\n<p>中文：“运行时错误429，ActiveX部件不能创建对象”<br>英文：”Run-time error ‘429’ ActiveX componnent can’t create object”</p>\n</blockquote>\n<p>新建文件，将下面代码复制粘贴，文件另存为xxx.bat 运行xxx.bat，重启电脑，OK.</p>\n<pre><code>echo 正在修复，这个过程可能需要几分钟，请稍候…… \nrundll32.exe advpack.dll /DelNodeRunDLL32 %systemroot%\\System32\\dacui.dll \nrundll32.exe advpack.dll /DelNodeRunDLL32 %systemroot%\\Catroot\\icatalog.mdb \nregsvr32 /s comcat.dll \nregsvr32 /s asctrls.ocx \nregsvr32 /s oleaut32.dll \nregsvr32 /s shdocvw.dll /I \nregsvr32 /s shdocvw.dll \nregsvr32 /s browseui.dll \nregsvr32 /s browseui.dll /I \nregsvr32 /s msrating.dll \nregsvr32 /s mlang.dll \nregsvr32 /s hlink.dll \nregsvr32 /s mshtml.dll \nregsvr32 /s mshtmled.dll \nregsvr32 /s urlmon.dll \nregsvr32 /s plugin.ocx \nregsvr32 /s sendmail.dll \nregsvr32 /s mshtml.dll /i \nregsvr32 /s scrobj.dll \nregsvr32 /s corpol.dll \nregsvr32 /s jscrīpt.dll \nregsvr32 /s msxml.dll \nregsvr32 /s imgutil.dll \nregsvr32 /s cryptext.dll \nregsvr32 /s inseng.dll \nregsvr32 /s iesetup.dll /i \nregsvr32 /s cryptdlg.dll \nregsvr32 /s actxprxy.dll \nregsvr32 /s dispex.dll \nregsvr32 /s occache.dll \nregsvr32 /s iepeers.dll \nregsvr32 /s urlmon.dll /i \nregsvr32 /s cdfview.dll \nregsvr32 /s webcheck.dll \nregsvr32 /s mobsync.dll \nregsvr32 /s pngfilt.dll \nregsvr32 /s licmgr10.dll \nregsvr32 /s hhctrl.ocx \nregsvr32 /s inetcfg.dll \nregsvr32 /s trialoc.dll \nregsvr32 /s tdc.ocx \nregsvr32 /s MSR2C.DLL \nregsvr32 /s msident.dll \nregsvr32 /s msieftp.dll \nregsvr32 /s xmsconf.ocx \nregsvr32 /s ils.dll \nregsvr32 /s msoeacct.dll \nregsvr32 /s wab32.dll \nregsvr32 /s wabimp.dll \nregsvr32 /s wabfind.dll \nregsvr32 /s oemiglib.dll \nregsvr32 /s directdb.dll \nregsvr32 /s inetcomm.dll \nregsvr32 /s msoe.dll \nregsvr32 /s oeimport.dll \nregsvr32 /s msdxm.ocx \nregsvr32 /s dxmasf.dll \nregsvr32 /s laprxy.dll \nregsvr32 /s l3codecx.ax \nregsvr32 /s acelpdec.ax \nregsvr32 /s mpg4ds32.ax \nregsvr32 /s danim.dll \nregsvr32 /s Daxctle.ocx \nregsvr32 /s lmrt.dll \nregsvr32 /s datime.dll \nregsvr32 /s dxtrans.dll \nregsvr32 /s dxtmsft.dll \nregsvr32 /s wshom.ocx \nregsvr32 /s wshext.dll \nregsvr32 /s vbscrīpt.dll \nregsvr32 /s scrrun.dll mstinit.exe /setup \nregsvr32 /s msnsspc.dll /SspcCreateSspiReg \nregsvr32 /s msapsspc.dll /SspcCreateSspiReg \necho. \necho. \necho 修复成功！任意键退出！ \npause&gt;nul</code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"安装软件出现“ACTIVEX部件不能创建对象”\"><a href=\"#安装软件出现“ACTIVEX部件不能创建对象”\" class=\"headerlink\" title=\"安装软件出现“ACTIVEX部件不能创建对象”\"></a>安装软件出现“ACTIVEX部件不能创建对象”</h3><p>提示错误</p>\n<blockquote>\n<p>中文：“运行时错误429，ActiveX部件不能创建对象”<br>英文：”Run-time error ‘429’ ActiveX componnent can’t create object”</p>\n</blockquote>\n<p>新建文件，将下面代码复制粘贴，文件另存为xxx.bat 运行xxx.bat，重启电脑，OK.</p>\n<pre><code>echo 正在修复，这个过程可能需要几分钟，请稍候…… \nrundll32.exe advpack.dll /DelNodeRunDLL32 %systemroot%\\System32\\dacui.dll \nrundll32.exe advpack.dll /DelNodeRunDLL32 %systemroot%\\Catroot\\icatalog.mdb \nregsvr32 /s comcat.dll \nregsvr32 /s asctrls.ocx \nregsvr32 /s oleaut32.dll \nregsvr32 /s shdocvw.dll /I \nregsvr32 /s shdocvw.dll \nregsvr32 /s browseui.dll \nregsvr32 /s browseui.dll /I \nregsvr32 /s msrating.dll \nregsvr32 /s mlang.dll \nregsvr32 /s hlink.dll \nregsvr32 /s mshtml.dll \nregsvr32 /s mshtmled.dll \nregsvr32 /s urlmon.dll \nregsvr32 /s plugin.ocx \nregsvr32 /s sendmail.dll \nregsvr32 /s mshtml.dll /i \nregsvr32 /s scrobj.dll \nregsvr32 /s corpol.dll \nregsvr32 /s jscrīpt.dll \nregsvr32 /s msxml.dll \nregsvr32 /s imgutil.dll \nregsvr32 /s cryptext.dll \nregsvr32 /s inseng.dll \nregsvr32 /s iesetup.dll /i \nregsvr32 /s cryptdlg.dll \nregsvr32 /s actxprxy.dll \nregsvr32 /s dispex.dll \nregsvr32 /s occache.dll \nregsvr32 /s iepeers.dll \nregsvr32 /s urlmon.dll /i \nregsvr32 /s cdfview.dll \nregsvr32 /s webcheck.dll \nregsvr32 /s mobsync.dll \nregsvr32 /s pngfilt.dll \nregsvr32 /s licmgr10.dll \nregsvr32 /s hhctrl.ocx \nregsvr32 /s inetcfg.dll \nregsvr32 /s trialoc.dll \nregsvr32 /s tdc.ocx \nregsvr32 /s MSR2C.DLL \nregsvr32 /s msident.dll \nregsvr32 /s msieftp.dll \nregsvr32 /s xmsconf.ocx \nregsvr32 /s ils.dll \nregsvr32 /s msoeacct.dll \nregsvr32 /s wab32.dll \nregsvr32 /s wabimp.dll \nregsvr32 /s wabfind.dll \nregsvr32 /s oemiglib.dll \nregsvr32 /s directdb.dll \nregsvr32 /s inetcomm.dll \nregsvr32 /s msoe.dll \nregsvr32 /s oeimport.dll \nregsvr32 /s msdxm.ocx \nregsvr32 /s dxmasf.dll \nregsvr32 /s laprxy.dll \nregsvr32 /s l3codecx.ax \nregsvr32 /s acelpdec.ax \nregsvr32 /s mpg4ds32.ax \nregsvr32 /s danim.dll \nregsvr32 /s Daxctle.ocx \nregsvr32 /s lmrt.dll \nregsvr32 /s datime.dll \nregsvr32 /s dxtrans.dll \nregsvr32 /s dxtmsft.dll \nregsvr32 /s wshom.ocx \nregsvr32 /s wshext.dll \nregsvr32 /s vbscrīpt.dll \nregsvr32 /s scrrun.dll mstinit.exe /setup \nregsvr32 /s msnsspc.dll /SspcCreateSspiReg \nregsvr32 /s msapsspc.dll /SspcCreateSspiReg \necho. \necho. \necho 修复成功！任意键退出！ \npause&gt;nul</code></pre>"},{"title":"zabbix入门基础","url":"615.html","id":"615","comments":0,"date":"2018-11-16T09:40:04.000Z","_content":"\n#### 安装服务器端\n\n[官方](https://www.zabbix.com/download) 1\\. 根据实际情况选择数据库 2. 根据实际情况选择操作系统\n\n#### 汉化\n\n![](/wp-content/uploads/2018/11/2018-11-16-17-36-53屏幕截图.png) 错误提示\n\n> You are not able to choose some of the languages, because locales for them are not installed on the web server.\n\n    # 选中zh-CN UTF-8\n    sudo dpkg-reconfigure locales\n    sudo service apache2 restart\n    \n\n#### 安装客户端\n\n[官方](https://www.zabbix.com/documentation/3.2/manual/installation/install_from_packages/agent_installation) [参考](https://tecadmin.net/install-zabbix-agent-on-centos-rhel/)\n\n#### 设置邮件报警\n\nMedia types ![](/wp-content/uploads/2018/11/zabbix-email.png) ![](/wp-content/uploads/2018/11/zabbix-email-1.png)\n\n#### 交换分区错误问题\n\n    Lack of free swap space\n    \n\n现在的云主机默认没有交换分区 Configuration->Templates->Template OS Linux->Triggers->Lack of free swap space on {HOST.NAME}->Expression\n\n    {Template OS Linux:system.swap.size[,pfree].last(0)}<50改成\n    {Template OS Linux:system.swap.size[,pfree].last(0)}<50 and {Template OS Linux:system.swap.size[,free].last(0)}<>0","source":"_posts/zabbix入门基础.md","raw":"---\ntitle: zabbix入门基础\nurl: 615.html\nid: 615\ncomments: false\ncategories:\n  - 后端\ndate: 2018-11-16 17:40:04\ntags:\n---\n\n#### 安装服务器端\n\n[官方](https://www.zabbix.com/download) 1\\. 根据实际情况选择数据库 2. 根据实际情况选择操作系统\n\n#### 汉化\n\n![](/wp-content/uploads/2018/11/2018-11-16-17-36-53屏幕截图.png) 错误提示\n\n> You are not able to choose some of the languages, because locales for them are not installed on the web server.\n\n    # 选中zh-CN UTF-8\n    sudo dpkg-reconfigure locales\n    sudo service apache2 restart\n    \n\n#### 安装客户端\n\n[官方](https://www.zabbix.com/documentation/3.2/manual/installation/install_from_packages/agent_installation) [参考](https://tecadmin.net/install-zabbix-agent-on-centos-rhel/)\n\n#### 设置邮件报警\n\nMedia types ![](/wp-content/uploads/2018/11/zabbix-email.png) ![](/wp-content/uploads/2018/11/zabbix-email-1.png)\n\n#### 交换分区错误问题\n\n    Lack of free swap space\n    \n\n现在的云主机默认没有交换分区 Configuration->Templates->Template OS Linux->Triggers->Lack of free swap space on {HOST.NAME}->Expression\n\n    {Template OS Linux:system.swap.size[,pfree].last(0)}<50改成\n    {Template OS Linux:system.swap.size[,pfree].last(0)}<50 and {Template OS Linux:system.swap.size[,free].last(0)}<>0","slug":"zabbix入门基础","published":1,"updated":"2019-07-24T01:36:10.136Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5ol003e9ka42oj83xxs","content":"<h4 id=\"安装服务器端\"><a href=\"#安装服务器端\" class=\"headerlink\" title=\"安装服务器端\"></a>安装服务器端</h4><p><a href=\"https://www.zabbix.com/download\" target=\"_blank\" rel=\"noopener\">官方</a> 1. 根据实际情况选择数据库 2. 根据实际情况选择操作系统</p>\n<h4 id=\"汉化\"><a href=\"#汉化\" class=\"headerlink\" title=\"汉化\"></a>汉化</h4><p><img src=\"/wp-content/uploads/2018/11/2018-11-16-17-36-53%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png\" alt> 错误提示</p>\n<blockquote>\n<p>You are not able to choose some of the languages, because locales for them are not installed on the web server.</p>\n</blockquote>\n<pre><code># 选中zh-CN UTF-8\nsudo dpkg-reconfigure locales\nsudo service apache2 restart</code></pre><h4 id=\"安装客户端\"><a href=\"#安装客户端\" class=\"headerlink\" title=\"安装客户端\"></a>安装客户端</h4><p><a href=\"https://www.zabbix.com/documentation/3.2/manual/installation/install_from_packages/agent_installation\" target=\"_blank\" rel=\"noopener\">官方</a> <a href=\"https://tecadmin.net/install-zabbix-agent-on-centos-rhel/\" target=\"_blank\" rel=\"noopener\">参考</a></p>\n<h4 id=\"设置邮件报警\"><a href=\"#设置邮件报警\" class=\"headerlink\" title=\"设置邮件报警\"></a>设置邮件报警</h4><p>Media types <img src=\"/wp-content/uploads/2018/11/zabbix-email.png\" alt> <img src=\"/wp-content/uploads/2018/11/zabbix-email-1.png\" alt></p>\n<h4 id=\"交换分区错误问题\"><a href=\"#交换分区错误问题\" class=\"headerlink\" title=\"交换分区错误问题\"></a>交换分区错误问题</h4><pre><code>Lack of free swap space</code></pre><p>现在的云主机默认没有交换分区 Configuration-&gt;Templates-&gt;Template OS Linux-&gt;Triggers-&gt;Lack of free swap space on {HOST.NAME}-&gt;Expression</p>\n<pre><code>{Template OS Linux:system.swap.size[,pfree].last(0)}&lt;50改成\n{Template OS Linux:system.swap.size[,pfree].last(0)}&lt;50 and {Template OS Linux:system.swap.size[,free].last(0)}&lt;&gt;0</code></pre>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"安装服务器端\"><a href=\"#安装服务器端\" class=\"headerlink\" title=\"安装服务器端\"></a>安装服务器端</h4><p><a href=\"https://www.zabbix.com/download\" target=\"_blank\" rel=\"noopener\">官方</a> 1. 根据实际情况选择数据库 2. 根据实际情况选择操作系统</p>\n<h4 id=\"汉化\"><a href=\"#汉化\" class=\"headerlink\" title=\"汉化\"></a>汉化</h4><p><img src=\"/wp-content/uploads/2018/11/2018-11-16-17-36-53%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png\" alt> 错误提示</p>\n<blockquote>\n<p>You are not able to choose some of the languages, because locales for them are not installed on the web server.</p>\n</blockquote>\n<pre><code># 选中zh-CN UTF-8\nsudo dpkg-reconfigure locales\nsudo service apache2 restart</code></pre><h4 id=\"安装客户端\"><a href=\"#安装客户端\" class=\"headerlink\" title=\"安装客户端\"></a>安装客户端</h4><p><a href=\"https://www.zabbix.com/documentation/3.2/manual/installation/install_from_packages/agent_installation\" target=\"_blank\" rel=\"noopener\">官方</a> <a href=\"https://tecadmin.net/install-zabbix-agent-on-centos-rhel/\" target=\"_blank\" rel=\"noopener\">参考</a></p>\n<h4 id=\"设置邮件报警\"><a href=\"#设置邮件报警\" class=\"headerlink\" title=\"设置邮件报警\"></a>设置邮件报警</h4><p>Media types <img src=\"/wp-content/uploads/2018/11/zabbix-email.png\" alt> <img src=\"/wp-content/uploads/2018/11/zabbix-email-1.png\" alt></p>\n<h4 id=\"交换分区错误问题\"><a href=\"#交换分区错误问题\" class=\"headerlink\" title=\"交换分区错误问题\"></a>交换分区错误问题</h4><pre><code>Lack of free swap space</code></pre><p>现在的云主机默认没有交换分区 Configuration-&gt;Templates-&gt;Template OS Linux-&gt;Triggers-&gt;Lack of free swap space on {HOST.NAME}-&gt;Expression</p>\n<pre><code>{Template OS Linux:system.swap.size[,pfree].last(0)}&lt;50改成\n{Template OS Linux:system.swap.size[,pfree].last(0)}&lt;50 and {Template OS Linux:system.swap.size[,free].last(0)}&lt;&gt;0</code></pre>"},{"title":"wireshark抓包基础","url":"56.html","id":"56","comments":0,"date":"2016-11-09T07:09:21.000Z","_content":"\n### nmap安装\n\n    sudo apt-get install nmap\n    \n\n### Zenmap图形GUI安装\n\n    sudo apt-get install Zenmap\n    \n\n### 扫描主机\n\n    nmap -T4 -A -v 192.168.1.3/16\n    \n\n其中-A选项用于使用进攻性（Aggressive）方式扫描；-T4指定扫描过程使用的时序（Timing），总有6个级别（0-5），级别越高，扫描速度越快，但也容易被防火墙或IDS检测并屏蔽掉，在网络通讯状况良好的情况推荐使用T4；-v表示显示冗余（verbosity）信息，在扫描过程中显示扫描的细节，从而让用户了解当前的扫描状态。  \n/32 表示扫描 192.168.1.3  \n/24 表示扫描 192.168.1.0-192.168.1.255  \n/16 表示扫描 192.168.0.0-192.168.255.255  \n/8  \n/1  \n参考[cird](https://zh.wikipedia.org/wiki/%E6%97%A0%E7%B1%BB%E5%88%AB%E5%9F%9F%E9%97%B4%E8%B7%AF%E7%94%B1)\n\n### Nmap所识别的6个端口状态。\n\nopen(开放的) 应用程序正在该端口接收TCP 连接或者UDP报文。发现这一点常常是端口扫描 的主要目标。安全意识强的人们知道每个开放的端口 都是攻击的入口。攻击者或者入侵测试者想要发现开放的端口。 而管理员则试图关闭它们或者用防火墙保护它们以免妨碍了合法用户。 非安全扫描可能对开放的端口也感兴趣，因为它们显示了网络上那些服务可供使用。 closed(关闭的) 关闭的端口对于Nmap也是可访问的(它接受Nmap的探测报文并作出响应)， 但没有应用程序在其上监听。 它们可以显示该IP地址上(主机发现，或者ping扫描)的主机正在运行up 也对部分操作系统探测有所帮助。 因为关闭的关口是可访问的，也许过会儿值得再扫描一下，可能一些又开放了。 系统管理员可能会考虑用防火墙封锁这样的端口。 那样他们就会被显示为被过滤的状态，下面讨论。 filtered(被过滤的) 由于包过滤阻止探测报文到达端口， Nmap无法确定该端口是否开放。过滤可能来自专业的防火墙设备，路由器规则 或者主机上的软件防火墙。这样的端口让攻击者感觉很挫折，因为它们几乎不提供 任何信息。有时候它们响应ICMP错误消息如类型3代码13 (无法到达目标: 通信被管理员禁止)，但更普遍的是过滤器只是丢弃探测帧， 不做任何响应。 这迫使Nmap重试若干次以访万一探测包是由于网络阻塞丢弃的。 这使得扫描速度明显变慢。 unfiltered(未被过滤的) 未被过滤状态意味着端口可访问，但Nmap不能确定它是开放还是关闭。 只有用于映射防火墙规则集的ACK扫描才会把端口分类到这种状态。 用其它类型的扫描如窗口扫描，SYN扫描，或者FIN扫描来扫描未被过滤的端口可以帮助确定 端口是否开放。 open|filtered(开放或者被过滤的) 当无法确定端口是开放还是被过滤的，Nmap就把该端口划分成 这种状态。开放的端口不响应就是一个例子。没有响应也可能意味着报文过滤器丢弃 了探测报文或者它引发的任何响应。因此Nmap无法确定该端口是开放的还是被过滤的。 UDP，IP协议， FIN，Null，和Xmas扫描可能把端口归入此类。 closed|filtered(关闭或者被过滤的) 该状态用于Nmap不能确定端口是关闭的还是被过滤的。 它只可能出现在IPID Idle扫描中。\n\n### 监视指定网络接口的数据包tcpdump\n\n如果不指定网卡，默认tcpdump只会监视第一个网络接口，一般是eth0，\n\n    tcpdump -i eth0\n    \n\n### 路由追踪traceroute\n\nlinux\n\n    sudo apt-get install traceroute  \n    traceroute hostname\n    \n\nwindow\n\n    tracert hostname\n    \n\n### ubuntu开启和关闭混杂模式\n\n``` ifconfig eth0 promisc # 设置eth0为混杂模式。 ifconfig eth0 -promisc # 取消它的混杂模式\n\n    ifconfig参数详解\n    \n\n字段含义说明： eth0/eth1： 分别表示第一块网卡和第二块网卡； lo： 表示回环测试接口，注意，这个虚拟的interface一定要存在！ usb0： 表示USB接口的网卡； Linkencap： 表示位于OSI物理层的名称，即连接类型Ethernet（以太网） HWaddr： 表示网卡的硬件地址，即MAC地址 inetaddr ： 表示网卡IP； Bcast： 表示广播(broadcast ) 的地址； Mask： 表示子网掩码； UP： 表示网卡开启状态； BROADCAST： 表示支持广播； MULTICAST： 表示网卡混杂模式； RUNNING： 表示网卡的网线被接上； MULTICAST： 表示支持组播； MTU： 表示MaximumTrasmission Unit 最大传输单元(字节)，即此接口一次所能传输的最大封包； Metric： 表示路由度量值，缺省值是0； RX： 表示网络由激活到目前为止接收的数据包； TX： 表示网络由激活到目前为止发送的数据包； collisions： 表示网络信号冲突的情况； txqueuelen： 表示传输缓冲区长度大小； Memory： 表示占用内存范围。\n\n    ### 安装wireshark\n    \n\nsudo apt-get install wireshark\n\n    wireshark捕获过滤器  \n    \n\nsrc 192.168.0.10 && port 80 源地址192.168.0.10和端口为80相关  \nhost 192.160.0.1 和主机192.168.0.1相关  \nsrc host 192.168.0.1  \nport 8080  \n!port 8080  \ndst port 80  \nicmp  \n!ip6\n\n    wireshark显示过滤器  \n    \n\n!tcp  \nip.addr == 192.168.0.1  \nframe.len <= 128  \ntcp.port == 23 || tcp.port == 21  \nsmtp || pop || imap  \nip.addr == 192.168.0.1 or ip.addr == 192.168.0.2\n\n操作符 ==, !=, >, <, >=. <=\n========================\n\n操作符 and, or, xor(有且仅有1个满足), not\n===============================","source":"_posts/wireshark抓包基础.md","raw":"---\ntitle: wireshark抓包基础\nurl: 56.html\nid: 56\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-09 15:09:21\ntags:\n---\n\n### nmap安装\n\n    sudo apt-get install nmap\n    \n\n### Zenmap图形GUI安装\n\n    sudo apt-get install Zenmap\n    \n\n### 扫描主机\n\n    nmap -T4 -A -v 192.168.1.3/16\n    \n\n其中-A选项用于使用进攻性（Aggressive）方式扫描；-T4指定扫描过程使用的时序（Timing），总有6个级别（0-5），级别越高，扫描速度越快，但也容易被防火墙或IDS检测并屏蔽掉，在网络通讯状况良好的情况推荐使用T4；-v表示显示冗余（verbosity）信息，在扫描过程中显示扫描的细节，从而让用户了解当前的扫描状态。  \n/32 表示扫描 192.168.1.3  \n/24 表示扫描 192.168.1.0-192.168.1.255  \n/16 表示扫描 192.168.0.0-192.168.255.255  \n/8  \n/1  \n参考[cird](https://zh.wikipedia.org/wiki/%E6%97%A0%E7%B1%BB%E5%88%AB%E5%9F%9F%E9%97%B4%E8%B7%AF%E7%94%B1)\n\n### Nmap所识别的6个端口状态。\n\nopen(开放的) 应用程序正在该端口接收TCP 连接或者UDP报文。发现这一点常常是端口扫描 的主要目标。安全意识强的人们知道每个开放的端口 都是攻击的入口。攻击者或者入侵测试者想要发现开放的端口。 而管理员则试图关闭它们或者用防火墙保护它们以免妨碍了合法用户。 非安全扫描可能对开放的端口也感兴趣，因为它们显示了网络上那些服务可供使用。 closed(关闭的) 关闭的端口对于Nmap也是可访问的(它接受Nmap的探测报文并作出响应)， 但没有应用程序在其上监听。 它们可以显示该IP地址上(主机发现，或者ping扫描)的主机正在运行up 也对部分操作系统探测有所帮助。 因为关闭的关口是可访问的，也许过会儿值得再扫描一下，可能一些又开放了。 系统管理员可能会考虑用防火墙封锁这样的端口。 那样他们就会被显示为被过滤的状态，下面讨论。 filtered(被过滤的) 由于包过滤阻止探测报文到达端口， Nmap无法确定该端口是否开放。过滤可能来自专业的防火墙设备，路由器规则 或者主机上的软件防火墙。这样的端口让攻击者感觉很挫折，因为它们几乎不提供 任何信息。有时候它们响应ICMP错误消息如类型3代码13 (无法到达目标: 通信被管理员禁止)，但更普遍的是过滤器只是丢弃探测帧， 不做任何响应。 这迫使Nmap重试若干次以访万一探测包是由于网络阻塞丢弃的。 这使得扫描速度明显变慢。 unfiltered(未被过滤的) 未被过滤状态意味着端口可访问，但Nmap不能确定它是开放还是关闭。 只有用于映射防火墙规则集的ACK扫描才会把端口分类到这种状态。 用其它类型的扫描如窗口扫描，SYN扫描，或者FIN扫描来扫描未被过滤的端口可以帮助确定 端口是否开放。 open|filtered(开放或者被过滤的) 当无法确定端口是开放还是被过滤的，Nmap就把该端口划分成 这种状态。开放的端口不响应就是一个例子。没有响应也可能意味着报文过滤器丢弃 了探测报文或者它引发的任何响应。因此Nmap无法确定该端口是开放的还是被过滤的。 UDP，IP协议， FIN，Null，和Xmas扫描可能把端口归入此类。 closed|filtered(关闭或者被过滤的) 该状态用于Nmap不能确定端口是关闭的还是被过滤的。 它只可能出现在IPID Idle扫描中。\n\n### 监视指定网络接口的数据包tcpdump\n\n如果不指定网卡，默认tcpdump只会监视第一个网络接口，一般是eth0，\n\n    tcpdump -i eth0\n    \n\n### 路由追踪traceroute\n\nlinux\n\n    sudo apt-get install traceroute  \n    traceroute hostname\n    \n\nwindow\n\n    tracert hostname\n    \n\n### ubuntu开启和关闭混杂模式\n\n``` ifconfig eth0 promisc # 设置eth0为混杂模式。 ifconfig eth0 -promisc # 取消它的混杂模式\n\n    ifconfig参数详解\n    \n\n字段含义说明： eth0/eth1： 分别表示第一块网卡和第二块网卡； lo： 表示回环测试接口，注意，这个虚拟的interface一定要存在！ usb0： 表示USB接口的网卡； Linkencap： 表示位于OSI物理层的名称，即连接类型Ethernet（以太网） HWaddr： 表示网卡的硬件地址，即MAC地址 inetaddr ： 表示网卡IP； Bcast： 表示广播(broadcast ) 的地址； Mask： 表示子网掩码； UP： 表示网卡开启状态； BROADCAST： 表示支持广播； MULTICAST： 表示网卡混杂模式； RUNNING： 表示网卡的网线被接上； MULTICAST： 表示支持组播； MTU： 表示MaximumTrasmission Unit 最大传输单元(字节)，即此接口一次所能传输的最大封包； Metric： 表示路由度量值，缺省值是0； RX： 表示网络由激活到目前为止接收的数据包； TX： 表示网络由激活到目前为止发送的数据包； collisions： 表示网络信号冲突的情况； txqueuelen： 表示传输缓冲区长度大小； Memory： 表示占用内存范围。\n\n    ### 安装wireshark\n    \n\nsudo apt-get install wireshark\n\n    wireshark捕获过滤器  \n    \n\nsrc 192.168.0.10 && port 80 源地址192.168.0.10和端口为80相关  \nhost 192.160.0.1 和主机192.168.0.1相关  \nsrc host 192.168.0.1  \nport 8080  \n!port 8080  \ndst port 80  \nicmp  \n!ip6\n\n    wireshark显示过滤器  \n    \n\n!tcp  \nip.addr == 192.168.0.1  \nframe.len <= 128  \ntcp.port == 23 || tcp.port == 21  \nsmtp || pop || imap  \nip.addr == 192.168.0.1 or ip.addr == 192.168.0.2\n\n操作符 ==, !=, >, <, >=. <=\n========================\n\n操作符 and, or, xor(有且仅有1个满足), not\n===============================","slug":"wireshark抓包基础","published":1,"updated":"2019-07-24T01:35:45.666Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5om003g9ka4k4e292ff","content":"<h3 id=\"nmap安装\"><a href=\"#nmap安装\" class=\"headerlink\" title=\"nmap安装\"></a>nmap安装</h3><pre><code>sudo apt-get install nmap</code></pre><h3 id=\"Zenmap图形GUI安装\"><a href=\"#Zenmap图形GUI安装\" class=\"headerlink\" title=\"Zenmap图形GUI安装\"></a>Zenmap图形GUI安装</h3><pre><code>sudo apt-get install Zenmap</code></pre><h3 id=\"扫描主机\"><a href=\"#扫描主机\" class=\"headerlink\" title=\"扫描主机\"></a>扫描主机</h3><pre><code>nmap -T4 -A -v 192.168.1.3/16</code></pre><p>其中-A选项用于使用进攻性（Aggressive）方式扫描；-T4指定扫描过程使用的时序（Timing），总有6个级别（0-5），级别越高，扫描速度越快，但也容易被防火墙或IDS检测并屏蔽掉，在网络通讯状况良好的情况推荐使用T4；-v表示显示冗余（verbosity）信息，在扫描过程中显示扫描的细节，从而让用户了解当前的扫描状态。<br>/32 表示扫描 192.168.1.3<br>/24 表示扫描 192.168.1.0-192.168.1.255<br>/16 表示扫描 192.168.0.0-192.168.255.255<br>/8<br>/1<br>参考<a href=\"https://zh.wikipedia.org/wiki/%E6%97%A0%E7%B1%BB%E5%88%AB%E5%9F%9F%E9%97%B4%E8%B7%AF%E7%94%B1\" target=\"_blank\" rel=\"noopener\">cird</a></p>\n<h3 id=\"Nmap所识别的6个端口状态。\"><a href=\"#Nmap所识别的6个端口状态。\" class=\"headerlink\" title=\"Nmap所识别的6个端口状态。\"></a>Nmap所识别的6个端口状态。</h3><p>open(开放的) 应用程序正在该端口接收TCP 连接或者UDP报文。发现这一点常常是端口扫描 的主要目标。安全意识强的人们知道每个开放的端口 都是攻击的入口。攻击者或者入侵测试者想要发现开放的端口。 而管理员则试图关闭它们或者用防火墙保护它们以免妨碍了合法用户。 非安全扫描可能对开放的端口也感兴趣，因为它们显示了网络上那些服务可供使用。 closed(关闭的) 关闭的端口对于Nmap也是可访问的(它接受Nmap的探测报文并作出响应)， 但没有应用程序在其上监听。 它们可以显示该IP地址上(主机发现，或者ping扫描)的主机正在运行up 也对部分操作系统探测有所帮助。 因为关闭的关口是可访问的，也许过会儿值得再扫描一下，可能一些又开放了。 系统管理员可能会考虑用防火墙封锁这样的端口。 那样他们就会被显示为被过滤的状态，下面讨论。 filtered(被过滤的) 由于包过滤阻止探测报文到达端口， Nmap无法确定该端口是否开放。过滤可能来自专业的防火墙设备，路由器规则 或者主机上的软件防火墙。这样的端口让攻击者感觉很挫折，因为它们几乎不提供 任何信息。有时候它们响应ICMP错误消息如类型3代码13 (无法到达目标: 通信被管理员禁止)，但更普遍的是过滤器只是丢弃探测帧， 不做任何响应。 这迫使Nmap重试若干次以访万一探测包是由于网络阻塞丢弃的。 这使得扫描速度明显变慢。 unfiltered(未被过滤的) 未被过滤状态意味着端口可访问，但Nmap不能确定它是开放还是关闭。 只有用于映射防火墙规则集的ACK扫描才会把端口分类到这种状态。 用其它类型的扫描如窗口扫描，SYN扫描，或者FIN扫描来扫描未被过滤的端口可以帮助确定 端口是否开放。 open|filtered(开放或者被过滤的) 当无法确定端口是开放还是被过滤的，Nmap就把该端口划分成 这种状态。开放的端口不响应就是一个例子。没有响应也可能意味着报文过滤器丢弃 了探测报文或者它引发的任何响应。因此Nmap无法确定该端口是开放的还是被过滤的。 UDP，IP协议， FIN，Null，和Xmas扫描可能把端口归入此类。 closed|filtered(关闭或者被过滤的) 该状态用于Nmap不能确定端口是关闭的还是被过滤的。 它只可能出现在IPID Idle扫描中。</p>\n<h3 id=\"监视指定网络接口的数据包tcpdump\"><a href=\"#监视指定网络接口的数据包tcpdump\" class=\"headerlink\" title=\"监视指定网络接口的数据包tcpdump\"></a>监视指定网络接口的数据包tcpdump</h3><p>如果不指定网卡，默认tcpdump只会监视第一个网络接口，一般是eth0，</p>\n<pre><code>tcpdump -i eth0</code></pre><h3 id=\"路由追踪traceroute\"><a href=\"#路由追踪traceroute\" class=\"headerlink\" title=\"路由追踪traceroute\"></a>路由追踪traceroute</h3><p>linux</p>\n<pre><code>sudo apt-get install traceroute  \ntraceroute hostname</code></pre><p>window</p>\n<pre><code>tracert hostname</code></pre><h3 id=\"ubuntu开启和关闭混杂模式\"><a href=\"#ubuntu开启和关闭混杂模式\" class=\"headerlink\" title=\"ubuntu开启和关闭混杂模式\"></a>ubuntu开启和关闭混杂模式</h3><p>``` ifconfig eth0 promisc # 设置eth0为混杂模式。 ifconfig eth0 -promisc # 取消它的混杂模式</p>\n<pre><code>ifconfig参数详解</code></pre><p>字段含义说明： eth0/eth1： 分别表示第一块网卡和第二块网卡； lo： 表示回环测试接口，注意，这个虚拟的interface一定要存在！ usb0： 表示USB接口的网卡； Linkencap： 表示位于OSI物理层的名称，即连接类型Ethernet（以太网） HWaddr： 表示网卡的硬件地址，即MAC地址 inetaddr ： 表示网卡IP； Bcast： 表示广播(broadcast ) 的地址； Mask： 表示子网掩码； UP： 表示网卡开启状态； BROADCAST： 表示支持广播； MULTICAST： 表示网卡混杂模式； RUNNING： 表示网卡的网线被接上； MULTICAST： 表示支持组播； MTU： 表示MaximumTrasmission Unit 最大传输单元(字节)，即此接口一次所能传输的最大封包； Metric： 表示路由度量值，缺省值是0； RX： 表示网络由激活到目前为止接收的数据包； TX： 表示网络由激活到目前为止发送的数据包； collisions： 表示网络信号冲突的情况； txqueuelen： 表示传输缓冲区长度大小； Memory： 表示占用内存范围。</p>\n<pre><code>### 安装wireshark</code></pre><p>sudo apt-get install wireshark</p>\n<pre><code>wireshark捕获过滤器  </code></pre><p>src 192.168.0.10 &amp;&amp; port 80 源地址192.168.0.10和端口为80相关<br>host 192.160.0.1 和主机192.168.0.1相关<br>src host 192.168.0.1<br>port 8080<br>!port 8080<br>dst port 80<br>icmp<br>!ip6</p>\n<pre><code>wireshark显示过滤器  </code></pre><p>!tcp<br>ip.addr == 192.168.0.1<br>frame.len &lt;= 128<br>tcp.port == 23 || tcp.port == 21<br>smtp || pop || imap<br>ip.addr == 192.168.0.1 or ip.addr == 192.168.0.2</p>\n<h1 id=\"操作符-gt-lt-gt-lt\"><a href=\"#操作符-gt-lt-gt-lt\" class=\"headerlink\" title=\"操作符 ==, !=, &gt;, &lt;, &gt;=. &lt;=\"></a>操作符 ==, !=, &gt;, &lt;, &gt;=. &lt;=</h1><h1 id=\"操作符-and-or-xor-有且仅有1个满足-not\"><a href=\"#操作符-and-or-xor-有且仅有1个满足-not\" class=\"headerlink\" title=\"操作符 and, or, xor(有且仅有1个满足), not\"></a>操作符 and, or, xor(有且仅有1个满足), not</h1>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"nmap安装\"><a href=\"#nmap安装\" class=\"headerlink\" title=\"nmap安装\"></a>nmap安装</h3><pre><code>sudo apt-get install nmap</code></pre><h3 id=\"Zenmap图形GUI安装\"><a href=\"#Zenmap图形GUI安装\" class=\"headerlink\" title=\"Zenmap图形GUI安装\"></a>Zenmap图形GUI安装</h3><pre><code>sudo apt-get install Zenmap</code></pre><h3 id=\"扫描主机\"><a href=\"#扫描主机\" class=\"headerlink\" title=\"扫描主机\"></a>扫描主机</h3><pre><code>nmap -T4 -A -v 192.168.1.3/16</code></pre><p>其中-A选项用于使用进攻性（Aggressive）方式扫描；-T4指定扫描过程使用的时序（Timing），总有6个级别（0-5），级别越高，扫描速度越快，但也容易被防火墙或IDS检测并屏蔽掉，在网络通讯状况良好的情况推荐使用T4；-v表示显示冗余（verbosity）信息，在扫描过程中显示扫描的细节，从而让用户了解当前的扫描状态。<br>/32 表示扫描 192.168.1.3<br>/24 表示扫描 192.168.1.0-192.168.1.255<br>/16 表示扫描 192.168.0.0-192.168.255.255<br>/8<br>/1<br>参考<a href=\"https://zh.wikipedia.org/wiki/%E6%97%A0%E7%B1%BB%E5%88%AB%E5%9F%9F%E9%97%B4%E8%B7%AF%E7%94%B1\" target=\"_blank\" rel=\"noopener\">cird</a></p>\n<h3 id=\"Nmap所识别的6个端口状态。\"><a href=\"#Nmap所识别的6个端口状态。\" class=\"headerlink\" title=\"Nmap所识别的6个端口状态。\"></a>Nmap所识别的6个端口状态。</h3><p>open(开放的) 应用程序正在该端口接收TCP 连接或者UDP报文。发现这一点常常是端口扫描 的主要目标。安全意识强的人们知道每个开放的端口 都是攻击的入口。攻击者或者入侵测试者想要发现开放的端口。 而管理员则试图关闭它们或者用防火墙保护它们以免妨碍了合法用户。 非安全扫描可能对开放的端口也感兴趣，因为它们显示了网络上那些服务可供使用。 closed(关闭的) 关闭的端口对于Nmap也是可访问的(它接受Nmap的探测报文并作出响应)， 但没有应用程序在其上监听。 它们可以显示该IP地址上(主机发现，或者ping扫描)的主机正在运行up 也对部分操作系统探测有所帮助。 因为关闭的关口是可访问的，也许过会儿值得再扫描一下，可能一些又开放了。 系统管理员可能会考虑用防火墙封锁这样的端口。 那样他们就会被显示为被过滤的状态，下面讨论。 filtered(被过滤的) 由于包过滤阻止探测报文到达端口， Nmap无法确定该端口是否开放。过滤可能来自专业的防火墙设备，路由器规则 或者主机上的软件防火墙。这样的端口让攻击者感觉很挫折，因为它们几乎不提供 任何信息。有时候它们响应ICMP错误消息如类型3代码13 (无法到达目标: 通信被管理员禁止)，但更普遍的是过滤器只是丢弃探测帧， 不做任何响应。 这迫使Nmap重试若干次以访万一探测包是由于网络阻塞丢弃的。 这使得扫描速度明显变慢。 unfiltered(未被过滤的) 未被过滤状态意味着端口可访问，但Nmap不能确定它是开放还是关闭。 只有用于映射防火墙规则集的ACK扫描才会把端口分类到这种状态。 用其它类型的扫描如窗口扫描，SYN扫描，或者FIN扫描来扫描未被过滤的端口可以帮助确定 端口是否开放。 open|filtered(开放或者被过滤的) 当无法确定端口是开放还是被过滤的，Nmap就把该端口划分成 这种状态。开放的端口不响应就是一个例子。没有响应也可能意味着报文过滤器丢弃 了探测报文或者它引发的任何响应。因此Nmap无法确定该端口是开放的还是被过滤的。 UDP，IP协议， FIN，Null，和Xmas扫描可能把端口归入此类。 closed|filtered(关闭或者被过滤的) 该状态用于Nmap不能确定端口是关闭的还是被过滤的。 它只可能出现在IPID Idle扫描中。</p>\n<h3 id=\"监视指定网络接口的数据包tcpdump\"><a href=\"#监视指定网络接口的数据包tcpdump\" class=\"headerlink\" title=\"监视指定网络接口的数据包tcpdump\"></a>监视指定网络接口的数据包tcpdump</h3><p>如果不指定网卡，默认tcpdump只会监视第一个网络接口，一般是eth0，</p>\n<pre><code>tcpdump -i eth0</code></pre><h3 id=\"路由追踪traceroute\"><a href=\"#路由追踪traceroute\" class=\"headerlink\" title=\"路由追踪traceroute\"></a>路由追踪traceroute</h3><p>linux</p>\n<pre><code>sudo apt-get install traceroute  \ntraceroute hostname</code></pre><p>window</p>\n<pre><code>tracert hostname</code></pre><h3 id=\"ubuntu开启和关闭混杂模式\"><a href=\"#ubuntu开启和关闭混杂模式\" class=\"headerlink\" title=\"ubuntu开启和关闭混杂模式\"></a>ubuntu开启和关闭混杂模式</h3><p>``` ifconfig eth0 promisc # 设置eth0为混杂模式。 ifconfig eth0 -promisc # 取消它的混杂模式</p>\n<pre><code>ifconfig参数详解</code></pre><p>字段含义说明： eth0/eth1： 分别表示第一块网卡和第二块网卡； lo： 表示回环测试接口，注意，这个虚拟的interface一定要存在！ usb0： 表示USB接口的网卡； Linkencap： 表示位于OSI物理层的名称，即连接类型Ethernet（以太网） HWaddr： 表示网卡的硬件地址，即MAC地址 inetaddr ： 表示网卡IP； Bcast： 表示广播(broadcast ) 的地址； Mask： 表示子网掩码； UP： 表示网卡开启状态； BROADCAST： 表示支持广播； MULTICAST： 表示网卡混杂模式； RUNNING： 表示网卡的网线被接上； MULTICAST： 表示支持组播； MTU： 表示MaximumTrasmission Unit 最大传输单元(字节)，即此接口一次所能传输的最大封包； Metric： 表示路由度量值，缺省值是0； RX： 表示网络由激活到目前为止接收的数据包； TX： 表示网络由激活到目前为止发送的数据包； collisions： 表示网络信号冲突的情况； txqueuelen： 表示传输缓冲区长度大小； Memory： 表示占用内存范围。</p>\n<pre><code>### 安装wireshark</code></pre><p>sudo apt-get install wireshark</p>\n<pre><code>wireshark捕获过滤器  </code></pre><p>src 192.168.0.10 &amp;&amp; port 80 源地址192.168.0.10和端口为80相关<br>host 192.160.0.1 和主机192.168.0.1相关<br>src host 192.168.0.1<br>port 8080<br>!port 8080<br>dst port 80<br>icmp<br>!ip6</p>\n<pre><code>wireshark显示过滤器  </code></pre><p>!tcp<br>ip.addr == 192.168.0.1<br>frame.len &lt;= 128<br>tcp.port == 23 || tcp.port == 21<br>smtp || pop || imap<br>ip.addr == 192.168.0.1 or ip.addr == 192.168.0.2</p>\n<h1 id=\"操作符-gt-lt-gt-lt\"><a href=\"#操作符-gt-lt-gt-lt\" class=\"headerlink\" title=\"操作符 ==, !=, &gt;, &lt;, &gt;=. &lt;=\"></a>操作符 ==, !=, &gt;, &lt;, &gt;=. &lt;=</h1><h1 id=\"操作符-and-or-xor-有且仅有1个满足-not\"><a href=\"#操作符-and-or-xor-有且仅有1个满足-not\" class=\"headerlink\" title=\"操作符 and, or, xor(有且仅有1个满足), not\"></a>操作符 and, or, xor(有且仅有1个满足), not</h1>"},{"title":"局域网部分电脑不能连接网络,局域网共享文件夹,打印机等情况","url":"24.html","id":"24","comments":0,"date":"2016-11-09T01:54:26.000Z","_content":"\n### 问题反应\n\n今天公司出现网络故障，有2个部门全部不能连接网络。\n\n### 正常问题\n\n> 一台电脑不能上网，找该台电脑的问题  \n> 一部门电脑不能上网，找该部门交换机  \n> 多部门电脑不能上网，找主交换机问题  \n> 全部不能上网，拿电脑直连路由\n\n### 问题分析\n\n公司主交换机A  \n部门分交换机B  \n测试电脑C  \n部门不能上网故障，正常情况应该是A模块出现问题。于是重启A，仍然有一个部门故障。  \n重启B，不能解决问题。  \n将C与B直连的线路连接到C，C正常。  \nA,B问题都排除，那么问题在哪？  \n继续尝试，B上只连接C，正常。B上连接该部门全部电脑，故障。  \n找到那条会导致故障的线路，换掉网线，OK.  \n确认问题原因居然是**_网线！_**\n\n### 结论\n\n子交换机上的网线问题会影响主交换。\n\n### 共享打印机安装出现0x00000709\n\n解决办法：重启打印机服务器的Print Spooler服务，重启本地计算机\n\n### 账号密码问题\n\n局域网有xp电脑可以正常访问共享电脑，排序账号密码问题。\n\n### 共享设置问题\n\nxp系统访问正常，win7系统访问显示“帐号密码错误”。于是想到共享设置问题。\n\n> 开始=>  \n> 运行=>  \n> gpedit.msc=>  \n> 本地计算机策略=>  \n> 计算机配置=>  \n> Windows设置=>  \n> 安全设置=>  \n> 本地策略=>  \n> 安全选项=>  \n> 网络安全：LAN管理器身份验证级别=>  \n> 发送LM & NTLM响应\n\n但是之前win7是可以正常访问的，所以该项设置是正确的。\n\n### 时间设置问题\n\n于是询问是什么时候不能访问的，告之电脑蓝屏重启后。那么原因自然是蓝屏导致共享电脑设置的时间出现错误。\n\n> 如果win7的系统时间和访问的共享文件夹的创建时间间隔太长的话，会出现此现象。这是win7的安全机制造成的。  \n> 将共享电脑时间设置为当前时间即可","source":"_posts/局域网部分电脑不能连接网络,局域网共享文件夹,打印机等情况.md","raw":"---\ntitle: 局域网部分电脑不能连接网络,局域网共享文件夹,打印机等情况\ntags:\n  - windows\nurl: 24.html\nid: 24\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-09 09:54:26\n---\n\n### 问题反应\n\n今天公司出现网络故障，有2个部门全部不能连接网络。\n\n### 正常问题\n\n> 一台电脑不能上网，找该台电脑的问题  \n> 一部门电脑不能上网，找该部门交换机  \n> 多部门电脑不能上网，找主交换机问题  \n> 全部不能上网，拿电脑直连路由\n\n### 问题分析\n\n公司主交换机A  \n部门分交换机B  \n测试电脑C  \n部门不能上网故障，正常情况应该是A模块出现问题。于是重启A，仍然有一个部门故障。  \n重启B，不能解决问题。  \n将C与B直连的线路连接到C，C正常。  \nA,B问题都排除，那么问题在哪？  \n继续尝试，B上只连接C，正常。B上连接该部门全部电脑，故障。  \n找到那条会导致故障的线路，换掉网线，OK.  \n确认问题原因居然是**_网线！_**\n\n### 结论\n\n子交换机上的网线问题会影响主交换。\n\n### 共享打印机安装出现0x00000709\n\n解决办法：重启打印机服务器的Print Spooler服务，重启本地计算机\n\n### 账号密码问题\n\n局域网有xp电脑可以正常访问共享电脑，排序账号密码问题。\n\n### 共享设置问题\n\nxp系统访问正常，win7系统访问显示“帐号密码错误”。于是想到共享设置问题。\n\n> 开始=>  \n> 运行=>  \n> gpedit.msc=>  \n> 本地计算机策略=>  \n> 计算机配置=>  \n> Windows设置=>  \n> 安全设置=>  \n> 本地策略=>  \n> 安全选项=>  \n> 网络安全：LAN管理器身份验证级别=>  \n> 发送LM & NTLM响应\n\n但是之前win7是可以正常访问的，所以该项设置是正确的。\n\n### 时间设置问题\n\n于是询问是什么时候不能访问的，告之电脑蓝屏重启后。那么原因自然是蓝屏导致共享电脑设置的时间出现错误。\n\n> 如果win7的系统时间和访问的共享文件夹的创建时间间隔太长的话，会出现此现象。这是win7的安全机制造成的。  \n> 将共享电脑时间设置为当前时间即可","slug":"局域网部分电脑不能连接网络,局域网共享文件夹,打印机等情况","published":1,"updated":"2019-07-23T06:50:41.023Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5om003i9ka4n6n5ykwa","content":"<h3 id=\"问题反应\"><a href=\"#问题反应\" class=\"headerlink\" title=\"问题反应\"></a>问题反应</h3><p>今天公司出现网络故障，有2个部门全部不能连接网络。</p>\n<h3 id=\"正常问题\"><a href=\"#正常问题\" class=\"headerlink\" title=\"正常问题\"></a>正常问题</h3><blockquote>\n<p>一台电脑不能上网，找该台电脑的问题<br>一部门电脑不能上网，找该部门交换机<br>多部门电脑不能上网，找主交换机问题<br>全部不能上网，拿电脑直连路由</p>\n</blockquote>\n<h3 id=\"问题分析\"><a href=\"#问题分析\" class=\"headerlink\" title=\"问题分析\"></a>问题分析</h3><p>公司主交换机A<br>部门分交换机B<br>测试电脑C<br>部门不能上网故障，正常情况应该是A模块出现问题。于是重启A，仍然有一个部门故障。<br>重启B，不能解决问题。<br>将C与B直连的线路连接到C，C正常。<br>A,B问题都排除，那么问题在哪？<br>继续尝试，B上只连接C，正常。B上连接该部门全部电脑，故障。<br>找到那条会导致故障的线路，换掉网线，OK.<br>确认问题原因居然是<strong><em>网线！</em></strong></p>\n<h3 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论\"></a>结论</h3><p>子交换机上的网线问题会影响主交换。</p>\n<h3 id=\"共享打印机安装出现0x00000709\"><a href=\"#共享打印机安装出现0x00000709\" class=\"headerlink\" title=\"共享打印机安装出现0x00000709\"></a>共享打印机安装出现0x00000709</h3><p>解决办法：重启打印机服务器的Print Spooler服务，重启本地计算机</p>\n<h3 id=\"账号密码问题\"><a href=\"#账号密码问题\" class=\"headerlink\" title=\"账号密码问题\"></a>账号密码问题</h3><p>局域网有xp电脑可以正常访问共享电脑，排序账号密码问题。</p>\n<h3 id=\"共享设置问题\"><a href=\"#共享设置问题\" class=\"headerlink\" title=\"共享设置问题\"></a>共享设置问题</h3><p>xp系统访问正常，win7系统访问显示“帐号密码错误”。于是想到共享设置问题。</p>\n<blockquote>\n<p>开始=&gt;<br>运行=&gt;<br>gpedit.msc=&gt;<br>本地计算机策略=&gt;<br>计算机配置=&gt;<br>Windows设置=&gt;<br>安全设置=&gt;<br>本地策略=&gt;<br>安全选项=&gt;<br>网络安全：LAN管理器身份验证级别=&gt;<br>发送LM &amp; NTLM响应</p>\n</blockquote>\n<p>但是之前win7是可以正常访问的，所以该项设置是正确的。</p>\n<h3 id=\"时间设置问题\"><a href=\"#时间设置问题\" class=\"headerlink\" title=\"时间设置问题\"></a>时间设置问题</h3><p>于是询问是什么时候不能访问的，告之电脑蓝屏重启后。那么原因自然是蓝屏导致共享电脑设置的时间出现错误。</p>\n<blockquote>\n<p>如果win7的系统时间和访问的共享文件夹的创建时间间隔太长的话，会出现此现象。这是win7的安全机制造成的。<br>将共享电脑时间设置为当前时间即可</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"问题反应\"><a href=\"#问题反应\" class=\"headerlink\" title=\"问题反应\"></a>问题反应</h3><p>今天公司出现网络故障，有2个部门全部不能连接网络。</p>\n<h3 id=\"正常问题\"><a href=\"#正常问题\" class=\"headerlink\" title=\"正常问题\"></a>正常问题</h3><blockquote>\n<p>一台电脑不能上网，找该台电脑的问题<br>一部门电脑不能上网，找该部门交换机<br>多部门电脑不能上网，找主交换机问题<br>全部不能上网，拿电脑直连路由</p>\n</blockquote>\n<h3 id=\"问题分析\"><a href=\"#问题分析\" class=\"headerlink\" title=\"问题分析\"></a>问题分析</h3><p>公司主交换机A<br>部门分交换机B<br>测试电脑C<br>部门不能上网故障，正常情况应该是A模块出现问题。于是重启A，仍然有一个部门故障。<br>重启B，不能解决问题。<br>将C与B直连的线路连接到C，C正常。<br>A,B问题都排除，那么问题在哪？<br>继续尝试，B上只连接C，正常。B上连接该部门全部电脑，故障。<br>找到那条会导致故障的线路，换掉网线，OK.<br>确认问题原因居然是<strong><em>网线！</em></strong></p>\n<h3 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论\"></a>结论</h3><p>子交换机上的网线问题会影响主交换。</p>\n<h3 id=\"共享打印机安装出现0x00000709\"><a href=\"#共享打印机安装出现0x00000709\" class=\"headerlink\" title=\"共享打印机安装出现0x00000709\"></a>共享打印机安装出现0x00000709</h3><p>解决办法：重启打印机服务器的Print Spooler服务，重启本地计算机</p>\n<h3 id=\"账号密码问题\"><a href=\"#账号密码问题\" class=\"headerlink\" title=\"账号密码问题\"></a>账号密码问题</h3><p>局域网有xp电脑可以正常访问共享电脑，排序账号密码问题。</p>\n<h3 id=\"共享设置问题\"><a href=\"#共享设置问题\" class=\"headerlink\" title=\"共享设置问题\"></a>共享设置问题</h3><p>xp系统访问正常，win7系统访问显示“帐号密码错误”。于是想到共享设置问题。</p>\n<blockquote>\n<p>开始=&gt;<br>运行=&gt;<br>gpedit.msc=&gt;<br>本地计算机策略=&gt;<br>计算机配置=&gt;<br>Windows设置=&gt;<br>安全设置=&gt;<br>本地策略=&gt;<br>安全选项=&gt;<br>网络安全：LAN管理器身份验证级别=&gt;<br>发送LM &amp; NTLM响应</p>\n</blockquote>\n<p>但是之前win7是可以正常访问的，所以该项设置是正确的。</p>\n<h3 id=\"时间设置问题\"><a href=\"#时间设置问题\" class=\"headerlink\" title=\"时间设置问题\"></a>时间设置问题</h3><p>于是询问是什么时候不能访问的，告之电脑蓝屏重启后。那么原因自然是蓝屏导致共享电脑设置的时间出现错误。</p>\n<blockquote>\n<p>如果win7的系统时间和访问的共享文件夹的创建时间间隔太长的话，会出现此现象。这是win7的安全机制造成的。<br>将共享电脑时间设置为当前时间即可</p>\n</blockquote>\n"},{"title":"ubuntu本地配置SSL","url":"199.html","id":"199","comments":0,"date":"2017-11-07T03:25:08.000Z","_content":"\n    # 安装相关模块\n    sudo a2enmod ssl   //启用ssl模块\n    sudo apt-get install openssl  //安装openssl\n    \n\n    # 创建证书\n    openssl genrsa -des3 -out server.key 1024  //创建CA签名(不使用密码去除-des3选项)\n    openssl req -new -key server.key -out server.csr  //创建CSR(Certificate Signing Request)\n    openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt  //自己签发证书\n    sudo cp server.crt /etc/ssl/certs\n    sudo cp server.key /etc/ssl/private\n    \n\n    # 修改虚拟主机信息\n    在<VirtualHost *:80>段中，DocumentRoot一行的下方加入内容：\n    SSLEngine On\n    SSLOptions +StrictRequire\n    SSLCertificateFile /etc/ssl/certs/server.crt\n    SSLCertificateKeyFile /etc/ssl/private/server.key\n    端口修改为：443，即<VirtualHost *:443>(ssl的端口)\n    \n\n    # 重启apache2\n    sudo /etc/init.d/apache2 force-reload\n    sudo /etc/init.d/apache2 restart","source":"_posts/ubuntu本地配置SSL.md","raw":"---\ntitle: ubuntu本地配置SSL\nurl: 199.html\nid: 199\ncomments: false\ncategories:\n  - 运维\ndate: 2017-11-07 11:25:08\ntags:\n---\n\n    # 安装相关模块\n    sudo a2enmod ssl   //启用ssl模块\n    sudo apt-get install openssl  //安装openssl\n    \n\n    # 创建证书\n    openssl genrsa -des3 -out server.key 1024  //创建CA签名(不使用密码去除-des3选项)\n    openssl req -new -key server.key -out server.csr  //创建CSR(Certificate Signing Request)\n    openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt  //自己签发证书\n    sudo cp server.crt /etc/ssl/certs\n    sudo cp server.key /etc/ssl/private\n    \n\n    # 修改虚拟主机信息\n    在<VirtualHost *:80>段中，DocumentRoot一行的下方加入内容：\n    SSLEngine On\n    SSLOptions +StrictRequire\n    SSLCertificateFile /etc/ssl/certs/server.crt\n    SSLCertificateKeyFile /etc/ssl/private/server.key\n    端口修改为：443，即<VirtualHost *:443>(ssl的端口)\n    \n\n    # 重启apache2\n    sudo /etc/init.d/apache2 force-reload\n    sudo /etc/init.d/apache2 restart","slug":"ubuntu本地配置SSL","published":1,"updated":"2019-07-23T05:51:43.847Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5oo003l9ka45vuvlkxt","content":"<pre><code># 安装相关模块\nsudo a2enmod ssl   //启用ssl模块\nsudo apt-get install openssl  //安装openssl\n\n\n# 创建证书\nopenssl genrsa -des3 -out server.key 1024  //创建CA签名(不使用密码去除-des3选项)\nopenssl req -new -key server.key -out server.csr  //创建CSR(Certificate Signing Request)\nopenssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt  //自己签发证书\nsudo cp server.crt /etc/ssl/certs\nsudo cp server.key /etc/ssl/private\n\n\n# 修改虚拟主机信息\n在&lt;VirtualHost *:80&gt;段中，DocumentRoot一行的下方加入内容：\nSSLEngine On\nSSLOptions +StrictRequire\nSSLCertificateFile /etc/ssl/certs/server.crt\nSSLCertificateKeyFile /etc/ssl/private/server.key\n端口修改为：443，即&lt;VirtualHost *:443&gt;(ssl的端口)\n\n\n# 重启apache2\nsudo /etc/init.d/apache2 force-reload\nsudo /etc/init.d/apache2 restart</code></pre>","site":{"data":{}},"excerpt":"","more":"<pre><code># 安装相关模块\nsudo a2enmod ssl   //启用ssl模块\nsudo apt-get install openssl  //安装openssl\n\n\n# 创建证书\nopenssl genrsa -des3 -out server.key 1024  //创建CA签名(不使用密码去除-des3选项)\nopenssl req -new -key server.key -out server.csr  //创建CSR(Certificate Signing Request)\nopenssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt  //自己签发证书\nsudo cp server.crt /etc/ssl/certs\nsudo cp server.key /etc/ssl/private\n\n\n# 修改虚拟主机信息\n在&lt;VirtualHost *:80&gt;段中，DocumentRoot一行的下方加入内容：\nSSLEngine On\nSSLOptions +StrictRequire\nSSLCertificateFile /etc/ssl/certs/server.crt\nSSLCertificateKeyFile /etc/ssl/private/server.key\n端口修改为：443，即&lt;VirtualHost *:443&gt;(ssl的端口)\n\n\n# 重启apache2\nsudo /etc/init.d/apache2 force-reload\nsudo /etc/init.d/apache2 restart</code></pre>"},{"title":"vue.js","url":"566.html","id":"566","comments":0,"date":"2018-09-26T09:32:56.000Z","_content":"\n#### 安装nodejs\n\n    # 安装nodejs\n    # https://nodejs.org/en/download/package-manager/#debian-and-ubuntu-based-linux-distributions\n    curl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -\n    sudo apt-get install -y nodejs\n    # 安装cnpm\n    sudo npm install -g cnpm\n    \n\n#### 安装vue-cli\n\n    sudo cnpm install -g vue-cli\n    \n\n#### 创建项目\n\n    vue init webpack your-project\n     cnpm install\n     npm run dev  # 启动项目","source":"_posts/vuejs.md","raw":"---\ntitle: vue.js\nurl: 566.html\nid: 566\ncomments: false\ncategories:\n  - 前端\ndate: 2018-09-26 17:32:56\ntags:\n---\n\n#### 安装nodejs\n\n    # 安装nodejs\n    # https://nodejs.org/en/download/package-manager/#debian-and-ubuntu-based-linux-distributions\n    curl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -\n    sudo apt-get install -y nodejs\n    # 安装cnpm\n    sudo npm install -g cnpm\n    \n\n#### 安装vue-cli\n\n    sudo cnpm install -g vue-cli\n    \n\n#### 创建项目\n\n    vue init webpack your-project\n     cnpm install\n     npm run dev  # 启动项目","slug":"vuejs","published":1,"updated":"2019-07-23T05:51:43.850Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5op003o9ka4zma2xrav","content":"<h4 id=\"安装nodejs\"><a href=\"#安装nodejs\" class=\"headerlink\" title=\"安装nodejs\"></a>安装nodejs</h4><pre><code># 安装nodejs\n# https://nodejs.org/en/download/package-manager/#debian-and-ubuntu-based-linux-distributions\ncurl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -\nsudo apt-get install -y nodejs\n# 安装cnpm\nsudo npm install -g cnpm</code></pre><h4 id=\"安装vue-cli\"><a href=\"#安装vue-cli\" class=\"headerlink\" title=\"安装vue-cli\"></a>安装vue-cli</h4><pre><code>sudo cnpm install -g vue-cli</code></pre><h4 id=\"创建项目\"><a href=\"#创建项目\" class=\"headerlink\" title=\"创建项目\"></a>创建项目</h4><pre><code>vue init webpack your-project\n cnpm install\n npm run dev  # 启动项目</code></pre>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"安装nodejs\"><a href=\"#安装nodejs\" class=\"headerlink\" title=\"安装nodejs\"></a>安装nodejs</h4><pre><code># 安装nodejs\n# https://nodejs.org/en/download/package-manager/#debian-and-ubuntu-based-linux-distributions\ncurl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -\nsudo apt-get install -y nodejs\n# 安装cnpm\nsudo npm install -g cnpm</code></pre><h4 id=\"安装vue-cli\"><a href=\"#安装vue-cli\" class=\"headerlink\" title=\"安装vue-cli\"></a>安装vue-cli</h4><pre><code>sudo cnpm install -g vue-cli</code></pre><h4 id=\"创建项目\"><a href=\"#创建项目\" class=\"headerlink\" title=\"创建项目\"></a>创建项目</h4><pre><code>vue init webpack your-project\n cnpm install\n npm run dev  # 启动项目</code></pre>"},{"title":"微信本地开发及线上环境搭建","url":"496.html","id":"496","comments":0,"date":"2018-01-29T09:25:48.000Z","_content":"\n#### 微信开发者中心\n\nhttps://open.weixin.qq.com 1. 注册线上账号，开发者资质认证 2. 注册本地账号，开发者资质认证\n\n#### 网站应用\n\n1.  添加相关信息，并盖章认证，添加授权回调域example.com\n2.  认证通过后获取AppId, AppSecret\n\n#### 公众号应用\n\n#### 本地环境配置\n\n1.  将回调的url www.example.com 添加到host文件中","source":"_posts/微信本地开发及线上环境搭建.md","raw":"---\ntitle: 微信本地开发及线上环境搭建\ntags:\n  - 微信\nurl: 496.html\nid: 496\ncomments: false\ncategories:\n  - 后端\n  - 运维\ndate: 2018-01-29 17:25:48\n---\n\n#### 微信开发者中心\n\nhttps://open.weixin.qq.com 1. 注册线上账号，开发者资质认证 2. 注册本地账号，开发者资质认证\n\n#### 网站应用\n\n1.  添加相关信息，并盖章认证，添加授权回调域example.com\n2.  认证通过后获取AppId, AppSecret\n\n#### 公众号应用\n\n#### 本地环境配置\n\n1.  将回调的url www.example.com 添加到host文件中","slug":"微信本地开发及线上环境搭建","published":1,"updated":"2019-07-23T05:51:43.847Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5oq003q9ka4188vcr41","content":"<h4 id=\"微信开发者中心\"><a href=\"#微信开发者中心\" class=\"headerlink\" title=\"微信开发者中心\"></a>微信开发者中心</h4><p><a href=\"https://open.weixin.qq.com\" target=\"_blank\" rel=\"noopener\">https://open.weixin.qq.com</a> 1. 注册线上账号，开发者资质认证 2. 注册本地账号，开发者资质认证</p>\n<h4 id=\"网站应用\"><a href=\"#网站应用\" class=\"headerlink\" title=\"网站应用\"></a>网站应用</h4><ol>\n<li>添加相关信息，并盖章认证，添加授权回调域example.com</li>\n<li>认证通过后获取AppId, AppSecret</li>\n</ol>\n<h4 id=\"公众号应用\"><a href=\"#公众号应用\" class=\"headerlink\" title=\"公众号应用\"></a>公众号应用</h4><h4 id=\"本地环境配置\"><a href=\"#本地环境配置\" class=\"headerlink\" title=\"本地环境配置\"></a>本地环境配置</h4><ol>\n<li>将回调的url <a href=\"http://www.example.com\" target=\"_blank\" rel=\"noopener\">www.example.com</a> 添加到host文件中</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"微信开发者中心\"><a href=\"#微信开发者中心\" class=\"headerlink\" title=\"微信开发者中心\"></a>微信开发者中心</h4><p><a href=\"https://open.weixin.qq.com\" target=\"_blank\" rel=\"noopener\">https://open.weixin.qq.com</a> 1. 注册线上账号，开发者资质认证 2. 注册本地账号，开发者资质认证</p>\n<h4 id=\"网站应用\"><a href=\"#网站应用\" class=\"headerlink\" title=\"网站应用\"></a>网站应用</h4><ol>\n<li>添加相关信息，并盖章认证，添加授权回调域example.com</li>\n<li>认证通过后获取AppId, AppSecret</li>\n</ol>\n<h4 id=\"公众号应用\"><a href=\"#公众号应用\" class=\"headerlink\" title=\"公众号应用\"></a>公众号应用</h4><h4 id=\"本地环境配置\"><a href=\"#本地环境配置\" class=\"headerlink\" title=\"本地环境配置\"></a>本地环境配置</h4><ol>\n<li>将回调的url <a href=\"http://www.example.com\" target=\"_blank\" rel=\"noopener\">www.example.com</a> 添加到host文件中</li>\n</ol>\n"},{"title":"最新在linux/ubuntu中安装qq的办法","url":"258.html","id":"258","comments":0,"date":"2017-11-22T01:49:34.000Z","_content":"\n通过docker镜像文件的方式安装qq 1, 首先需要在主机上安装docker 2, 下载镜像文件 https://hub.docker.com/r/bestwu/qq/\n\n    sudo docker pull bestwu/qq # 速度慢可以换镜像源\n    \n\n3, 编辑启动脚本\n\n    vim qq.sh\n    sudo docker run -d --name qq --device /dev/snd --net=host \\\n    -v /tmp/.X11-unix:/tmp/.X11-unix \\\n    -v /home/YOURUSERNAME/TencentFiles:/TencentFiles \\ # 此处数据卷的目录填写自己的目录\n    -e DISPLAY=unix$DISPLAY \\\n    -e XMODIFIERS=@im=fcitx \\\n    -e QT_IM_MODULE=fcitx \\\n    -e GTK_IM_MODULE=fcitx \\\n    -e AUDIO_GID=63 \\\n    -e GID=1000 \\\n    -e UID=1000 \\\n    bestwu/qq:latest # 此处版本自行选择，作者提供了im (QQ) light,latest (QQLight) office (TIM)三个版本\n    \n\n4, 启动脚本\n\n    ./qq.sh\n    \n\n5, 感谢作者提供的镜像，本镜像基于深度操作系统.","source":"_posts/最新在linux-ubuntu中安装qq的办法.md","raw":"---\ntitle: 最新在linux/ubuntu中安装qq的办法\nurl: 258.html\nid: 258\ncomments: false\ncategories:\n  - 办公\n  - 运维\ndate: 2017-11-22 09:49:34\ntags:\n---\n\n通过docker镜像文件的方式安装qq 1, 首先需要在主机上安装docker 2, 下载镜像文件 https://hub.docker.com/r/bestwu/qq/\n\n    sudo docker pull bestwu/qq # 速度慢可以换镜像源\n    \n\n3, 编辑启动脚本\n\n    vim qq.sh\n    sudo docker run -d --name qq --device /dev/snd --net=host \\\n    -v /tmp/.X11-unix:/tmp/.X11-unix \\\n    -v /home/YOURUSERNAME/TencentFiles:/TencentFiles \\ # 此处数据卷的目录填写自己的目录\n    -e DISPLAY=unix$DISPLAY \\\n    -e XMODIFIERS=@im=fcitx \\\n    -e QT_IM_MODULE=fcitx \\\n    -e GTK_IM_MODULE=fcitx \\\n    -e AUDIO_GID=63 \\\n    -e GID=1000 \\\n    -e UID=1000 \\\n    bestwu/qq:latest # 此处版本自行选择，作者提供了im (QQ) light,latest (QQLight) office (TIM)三个版本\n    \n\n4, 启动脚本\n\n    ./qq.sh\n    \n\n5, 感谢作者提供的镜像，本镜像基于深度操作系统.","slug":"最新在linux-ubuntu中安装qq的办法","published":1,"updated":"2019-07-23T05:51:43.847Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5oq003s9ka4yfc07ecd","content":"<p>通过docker镜像文件的方式安装qq 1, 首先需要在主机上安装docker 2, 下载镜像文件 <a href=\"https://hub.docker.com/r/bestwu/qq/\" target=\"_blank\" rel=\"noopener\">https://hub.docker.com/r/bestwu/qq/</a></p>\n<pre><code>sudo docker pull bestwu/qq # 速度慢可以换镜像源</code></pre><p>3, 编辑启动脚本</p>\n<pre><code>vim qq.sh\nsudo docker run -d --name qq --device /dev/snd --net=host \\\n-v /tmp/.X11-unix:/tmp/.X11-unix \\\n-v /home/YOURUSERNAME/TencentFiles:/TencentFiles \\ # 此处数据卷的目录填写自己的目录\n-e DISPLAY=unix$DISPLAY \\\n-e XMODIFIERS=@im=fcitx \\\n-e QT_IM_MODULE=fcitx \\\n-e GTK_IM_MODULE=fcitx \\\n-e AUDIO_GID=63 \\\n-e GID=1000 \\\n-e UID=1000 \\\nbestwu/qq:latest # 此处版本自行选择，作者提供了im (QQ) light,latest (QQLight) office (TIM)三个版本</code></pre><p>4, 启动脚本</p>\n<pre><code>./qq.sh</code></pre><p>5, 感谢作者提供的镜像，本镜像基于深度操作系统.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>通过docker镜像文件的方式安装qq 1, 首先需要在主机上安装docker 2, 下载镜像文件 <a href=\"https://hub.docker.com/r/bestwu/qq/\" target=\"_blank\" rel=\"noopener\">https://hub.docker.com/r/bestwu/qq/</a></p>\n<pre><code>sudo docker pull bestwu/qq # 速度慢可以换镜像源</code></pre><p>3, 编辑启动脚本</p>\n<pre><code>vim qq.sh\nsudo docker run -d --name qq --device /dev/snd --net=host \\\n-v /tmp/.X11-unix:/tmp/.X11-unix \\\n-v /home/YOURUSERNAME/TencentFiles:/TencentFiles \\ # 此处数据卷的目录填写自己的目录\n-e DISPLAY=unix$DISPLAY \\\n-e XMODIFIERS=@im=fcitx \\\n-e QT_IM_MODULE=fcitx \\\n-e GTK_IM_MODULE=fcitx \\\n-e AUDIO_GID=63 \\\n-e GID=1000 \\\n-e UID=1000 \\\nbestwu/qq:latest # 此处版本自行选择，作者提供了im (QQ) light,latest (QQLight) office (TIM)三个版本</code></pre><p>4, 启动脚本</p>\n<pre><code>./qq.sh</code></pre><p>5, 感谢作者提供的镜像，本镜像基于深度操作系统.</p>\n"},{"title":"硬链接软链接方式","url":"17.html","id":"17","comments":0,"date":"2016-11-08T08:44:53.000Z","_content":"\n### 硬链结和符号链接的区别\n\n硬连接记录的是目标的 inode,符号连接记录的是目标的 path。  \n软连接就像是快捷方式,而硬连接就像是备份!符号连接可以做跨分区的 link；而 硬连接由于 inode 的缘故，只能在本分区中做 link.所以,符号连接的使用频率要高的多。\n\n### 软链接文件\n\n软链接又叫符号链接，这个文件包含了另一个文件的路径名。可以是任意文件或目录，可以链接不同文件系统的文件。和win下的快捷方式差不多。链接文件甚至可以链接不存在的文件，这就产生一般称之为\"断链\"的问题(或曰“现象\")，链接文件甚至可以循环链接自己。类似于编程语言中的递归。 命令格式：\n\n    ln [-s] source_path target_path \n    \n\n### 硬链接文件\n\ninfo ln 命令告诉您，硬链接是已存在文件的另一个名字，硬连接的命令是\n\n    ln -d existfile newfile \n    \n\n硬链接文件有两个限制 1、不允许给目录创建硬链接；  \n2、只有在同一文件系统中的文件之间才能创建链接。  \n对硬链接文件进行读写和删除操作时候，结果和软链接相同。但如果我们删除硬链接文件的源文件，硬链接文件仍然存在，而且保留了愿有的内容。这时，系统就“忘记”了它曾经是硬链接文件。而把他当成一个普通文件。修改其中一个，与其连接的文件同时被修改\n\n### Windows 下创建硬链接，只能适用于 NTFS 文件系统\n\n    fsutil hardlink create NewFileName ExistingFileName\n    \n\n### Windows 下创建软链接\n\nNTFS只支持对目录的软链接，微软把它称作 junction。但是对于文件的软链接，微软也有提供解决方案，那就是快捷方式(Shortcut，.lnk 文件)。不过软链接和快捷方式不是一个层次上的东西，前者是底层文件系统的功能，后者是应用层的功能。Windows 下目录的快捷方式用 dir 看起来是个文件。  \n命令方式\n\n    junction  LinkDirectory ExistingDirectory\n    \n\n例如\n\n    junction d:\\link c:\\winnt\n    \n\n将为c:\\\\winnt 建立一个链接目录 d:\\\\link，C和D分区都要是 NTFS 格式，在资源管理器和 dir 列示中 d:\\\\link 都以目录的面目存在的。d:\\\\link 就像是 c:\\\\winnt 的一个引用一般，删除 d:\\\\link 目录中的内容也就是删除了 c:\\\\winnt 中的内容，但删除 d:\\\\link 本身是不会影响到 c:\\\\winnt 的。\n\n### win7可以使用mklink命令\n\n    λ mklink /?\n    创建符号链接。\n    \n    MKLINK [[/D] | [/H] | [/J]] Link Target\n    \n            /D      创建目录符号链接。默认为文件\n                    符号链接。\n            /H      创建硬链接而非符号链接。\n            /J      创建目录联接。\n            Link    指定新的符号链接名称。\n            Target  指定新链接引用的路径\n                    (相对或绝对)。\n    \n\n其中\\\\D \\\\J区别如下\n\n    E:\\\n    λ mkdir SourceDir\n    E:\\\n    λ mklink /D DTargetDir\\ SourceDir\\\n    为 DTargetDir\\ <<===>> SourceDir\\ 创建的符号链接\n    E:\\\n    λ mklink /J JTargetDir\\ SourceDir\\\n    为 JTargetDir\\ <<===>> SourceDir\\ 创建的联接\n    \n\n![](http://7xq3ry.com1.z0.glb.clouddn.com/20160127111417.png) ![](http://7xq3ry.com1.z0.glb.clouddn.com/20160127111459.png) SourceDir,JTargetDir,DTargetDir 3个文件夹内部修改/增加/删除都会互相影响。  \n复制JTargetDir, 不会出现新的目录，文件夹文件内部复制 ![](http://7xq3ry.com1.z0.glb.clouddn.com/20160127112544.png) 这样复制会影响DTargetDir和SourceDir，慎用！ 复制DTargetDir文件夹会生成一个全新的文件夹，不会被其他文件夹影响，也不能影响其他文件夹。 复制JTargetDir的父级目录不会影响该目录，复制生成的目录下JTargetDir目录会变成独立的文件夹且文件夹内为空 ![](http://7xq3ry.com1.z0.glb.clouddn.com/20160127132448.png) !\\[\\]\\[0.048387699760496616\\] \\[0.048387699760496616\\]: http://7xq3ry.com1.z0.glb.clouddn.com/20160127132633.png 删除JTargetDir,DTargetDir均不影响SourceDir  \n删除SorceDir,会使得JTargetDir和DTargetDir失效 使用mklink /D时需要保证源目录和目标目录在同一个目录下，否则创建成功但不能正常访问\n\n### linux服务器的软硬件链接\n\n软链接可以跨文件系统，硬链接不可以\n\n    ln source target # 硬链接\n    ln -s source target # 软链接\n    \n\n软链接如果跨文件夹，必须使用绝对路径,否则会出现软链接无法访问的情况\n\n    ln -s /var/www/html/Upload/product/manual/en/ /var/www/html/manual","source":"_posts/硬链接软链接方式.md","raw":"---\ntitle: 硬链接软链接方式\ntags:\n  - windows\nurl: 17.html\nid: 17\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-08 16:44:53\n---\n\n### 硬链结和符号链接的区别\n\n硬连接记录的是目标的 inode,符号连接记录的是目标的 path。  \n软连接就像是快捷方式,而硬连接就像是备份!符号连接可以做跨分区的 link；而 硬连接由于 inode 的缘故，只能在本分区中做 link.所以,符号连接的使用频率要高的多。\n\n### 软链接文件\n\n软链接又叫符号链接，这个文件包含了另一个文件的路径名。可以是任意文件或目录，可以链接不同文件系统的文件。和win下的快捷方式差不多。链接文件甚至可以链接不存在的文件，这就产生一般称之为\"断链\"的问题(或曰“现象\")，链接文件甚至可以循环链接自己。类似于编程语言中的递归。 命令格式：\n\n    ln [-s] source_path target_path \n    \n\n### 硬链接文件\n\ninfo ln 命令告诉您，硬链接是已存在文件的另一个名字，硬连接的命令是\n\n    ln -d existfile newfile \n    \n\n硬链接文件有两个限制 1、不允许给目录创建硬链接；  \n2、只有在同一文件系统中的文件之间才能创建链接。  \n对硬链接文件进行读写和删除操作时候，结果和软链接相同。但如果我们删除硬链接文件的源文件，硬链接文件仍然存在，而且保留了愿有的内容。这时，系统就“忘记”了它曾经是硬链接文件。而把他当成一个普通文件。修改其中一个，与其连接的文件同时被修改\n\n### Windows 下创建硬链接，只能适用于 NTFS 文件系统\n\n    fsutil hardlink create NewFileName ExistingFileName\n    \n\n### Windows 下创建软链接\n\nNTFS只支持对目录的软链接，微软把它称作 junction。但是对于文件的软链接，微软也有提供解决方案，那就是快捷方式(Shortcut，.lnk 文件)。不过软链接和快捷方式不是一个层次上的东西，前者是底层文件系统的功能，后者是应用层的功能。Windows 下目录的快捷方式用 dir 看起来是个文件。  \n命令方式\n\n    junction  LinkDirectory ExistingDirectory\n    \n\n例如\n\n    junction d:\\link c:\\winnt\n    \n\n将为c:\\\\winnt 建立一个链接目录 d:\\\\link，C和D分区都要是 NTFS 格式，在资源管理器和 dir 列示中 d:\\\\link 都以目录的面目存在的。d:\\\\link 就像是 c:\\\\winnt 的一个引用一般，删除 d:\\\\link 目录中的内容也就是删除了 c:\\\\winnt 中的内容，但删除 d:\\\\link 本身是不会影响到 c:\\\\winnt 的。\n\n### win7可以使用mklink命令\n\n    λ mklink /?\n    创建符号链接。\n    \n    MKLINK [[/D] | [/H] | [/J]] Link Target\n    \n            /D      创建目录符号链接。默认为文件\n                    符号链接。\n            /H      创建硬链接而非符号链接。\n            /J      创建目录联接。\n            Link    指定新的符号链接名称。\n            Target  指定新链接引用的路径\n                    (相对或绝对)。\n    \n\n其中\\\\D \\\\J区别如下\n\n    E:\\\n    λ mkdir SourceDir\n    E:\\\n    λ mklink /D DTargetDir\\ SourceDir\\\n    为 DTargetDir\\ <<===>> SourceDir\\ 创建的符号链接\n    E:\\\n    λ mklink /J JTargetDir\\ SourceDir\\\n    为 JTargetDir\\ <<===>> SourceDir\\ 创建的联接\n    \n\n![](http://7xq3ry.com1.z0.glb.clouddn.com/20160127111417.png) ![](http://7xq3ry.com1.z0.glb.clouddn.com/20160127111459.png) SourceDir,JTargetDir,DTargetDir 3个文件夹内部修改/增加/删除都会互相影响。  \n复制JTargetDir, 不会出现新的目录，文件夹文件内部复制 ![](http://7xq3ry.com1.z0.glb.clouddn.com/20160127112544.png) 这样复制会影响DTargetDir和SourceDir，慎用！ 复制DTargetDir文件夹会生成一个全新的文件夹，不会被其他文件夹影响，也不能影响其他文件夹。 复制JTargetDir的父级目录不会影响该目录，复制生成的目录下JTargetDir目录会变成独立的文件夹且文件夹内为空 ![](http://7xq3ry.com1.z0.glb.clouddn.com/20160127132448.png) !\\[\\]\\[0.048387699760496616\\] \\[0.048387699760496616\\]: http://7xq3ry.com1.z0.glb.clouddn.com/20160127132633.png 删除JTargetDir,DTargetDir均不影响SourceDir  \n删除SorceDir,会使得JTargetDir和DTargetDir失效 使用mklink /D时需要保证源目录和目标目录在同一个目录下，否则创建成功但不能正常访问\n\n### linux服务器的软硬件链接\n\n软链接可以跨文件系统，硬链接不可以\n\n    ln source target # 硬链接\n    ln -s source target # 软链接\n    \n\n软链接如果跨文件夹，必须使用绝对路径,否则会出现软链接无法访问的情况\n\n    ln -s /var/www/html/Upload/product/manual/en/ /var/www/html/manual","slug":"硬链接软链接方式","published":1,"updated":"2019-07-23T05:51:43.847Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5or003v9ka43py7h2e0","content":"<h3 id=\"硬链结和符号链接的区别\"><a href=\"#硬链结和符号链接的区别\" class=\"headerlink\" title=\"硬链结和符号链接的区别\"></a>硬链结和符号链接的区别</h3><p>硬连接记录的是目标的 inode,符号连接记录的是目标的 path。<br>软连接就像是快捷方式,而硬连接就像是备份!符号连接可以做跨分区的 link；而 硬连接由于 inode 的缘故，只能在本分区中做 link.所以,符号连接的使用频率要高的多。</p>\n<h3 id=\"软链接文件\"><a href=\"#软链接文件\" class=\"headerlink\" title=\"软链接文件\"></a>软链接文件</h3><p>软链接又叫符号链接，这个文件包含了另一个文件的路径名。可以是任意文件或目录，可以链接不同文件系统的文件。和win下的快捷方式差不多。链接文件甚至可以链接不存在的文件，这就产生一般称之为”断链”的问题(或曰“现象”)，链接文件甚至可以循环链接自己。类似于编程语言中的递归。 命令格式：</p>\n<pre><code>ln [-s] source_path target_path </code></pre><h3 id=\"硬链接文件\"><a href=\"#硬链接文件\" class=\"headerlink\" title=\"硬链接文件\"></a>硬链接文件</h3><p>info ln 命令告诉您，硬链接是已存在文件的另一个名字，硬连接的命令是</p>\n<pre><code>ln -d existfile newfile </code></pre><p>硬链接文件有两个限制 1、不允许给目录创建硬链接；<br>2、只有在同一文件系统中的文件之间才能创建链接。<br>对硬链接文件进行读写和删除操作时候，结果和软链接相同。但如果我们删除硬链接文件的源文件，硬链接文件仍然存在，而且保留了愿有的内容。这时，系统就“忘记”了它曾经是硬链接文件。而把他当成一个普通文件。修改其中一个，与其连接的文件同时被修改</p>\n<h3 id=\"Windows-下创建硬链接，只能适用于-NTFS-文件系统\"><a href=\"#Windows-下创建硬链接，只能适用于-NTFS-文件系统\" class=\"headerlink\" title=\"Windows 下创建硬链接，只能适用于 NTFS 文件系统\"></a>Windows 下创建硬链接，只能适用于 NTFS 文件系统</h3><pre><code>fsutil hardlink create NewFileName ExistingFileName</code></pre><h3 id=\"Windows-下创建软链接\"><a href=\"#Windows-下创建软链接\" class=\"headerlink\" title=\"Windows 下创建软链接\"></a>Windows 下创建软链接</h3><p>NTFS只支持对目录的软链接，微软把它称作 junction。但是对于文件的软链接，微软也有提供解决方案，那就是快捷方式(Shortcut，.lnk 文件)。不过软链接和快捷方式不是一个层次上的东西，前者是底层文件系统的功能，后者是应用层的功能。Windows 下目录的快捷方式用 dir 看起来是个文件。<br>命令方式</p>\n<pre><code>junction  LinkDirectory ExistingDirectory</code></pre><p>例如</p>\n<pre><code>junction d:\\link c:\\winnt</code></pre><p>将为c:\\winnt 建立一个链接目录 d:\\link，C和D分区都要是 NTFS 格式，在资源管理器和 dir 列示中 d:\\link 都以目录的面目存在的。d:\\link 就像是 c:\\winnt 的一个引用一般，删除 d:\\link 目录中的内容也就是删除了 c:\\winnt 中的内容，但删除 d:\\link 本身是不会影响到 c:\\winnt 的。</p>\n<h3 id=\"win7可以使用mklink命令\"><a href=\"#win7可以使用mklink命令\" class=\"headerlink\" title=\"win7可以使用mklink命令\"></a>win7可以使用mklink命令</h3><pre><code>λ mklink /?\n创建符号链接。\n\nMKLINK [[/D] | [/H] | [/J]] Link Target\n\n        /D      创建目录符号链接。默认为文件\n                符号链接。\n        /H      创建硬链接而非符号链接。\n        /J      创建目录联接。\n        Link    指定新的符号链接名称。\n        Target  指定新链接引用的路径\n                (相对或绝对)。</code></pre><p>其中\\D \\J区别如下</p>\n<pre><code>E:\\\nλ mkdir SourceDir\nE:\\\nλ mklink /D DTargetDir\\ SourceDir\\\n为 DTargetDir\\ &lt;&lt;===&gt;&gt; SourceDir\\ 创建的符号链接\nE:\\\nλ mklink /J JTargetDir\\ SourceDir\\\n为 JTargetDir\\ &lt;&lt;===&gt;&gt; SourceDir\\ 创建的联接</code></pre><p><img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160127111417.png\" alt> <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160127111459.png\" alt> SourceDir,JTargetDir,DTargetDir 3个文件夹内部修改/增加/删除都会互相影响。<br>复制JTargetDir, 不会出现新的目录，文件夹文件内部复制 <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160127112544.png\" alt> 这样复制会影响DTargetDir和SourceDir，慎用！ 复制DTargetDir文件夹会生成一个全新的文件夹，不会被其他文件夹影响，也不能影响其他文件夹。 复制JTargetDir的父级目录不会影响该目录，复制生成的目录下JTargetDir目录会变成独立的文件夹且文件夹内为空 <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160127132448.png\" alt> ![][0.048387699760496616] [0.048387699760496616]: <a href=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160127132633.png\" target=\"_blank\" rel=\"noopener\">http://7xq3ry.com1.z0.glb.clouddn.com/20160127132633.png</a> 删除JTargetDir,DTargetDir均不影响SourceDir<br>删除SorceDir,会使得JTargetDir和DTargetDir失效 使用mklink /D时需要保证源目录和目标目录在同一个目录下，否则创建成功但不能正常访问</p>\n<h3 id=\"linux服务器的软硬件链接\"><a href=\"#linux服务器的软硬件链接\" class=\"headerlink\" title=\"linux服务器的软硬件链接\"></a>linux服务器的软硬件链接</h3><p>软链接可以跨文件系统，硬链接不可以</p>\n<pre><code>ln source target # 硬链接\nln -s source target # 软链接</code></pre><p>软链接如果跨文件夹，必须使用绝对路径,否则会出现软链接无法访问的情况</p>\n<pre><code>ln -s /var/www/html/Upload/product/manual/en/ /var/www/html/manual</code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"硬链结和符号链接的区别\"><a href=\"#硬链结和符号链接的区别\" class=\"headerlink\" title=\"硬链结和符号链接的区别\"></a>硬链结和符号链接的区别</h3><p>硬连接记录的是目标的 inode,符号连接记录的是目标的 path。<br>软连接就像是快捷方式,而硬连接就像是备份!符号连接可以做跨分区的 link；而 硬连接由于 inode 的缘故，只能在本分区中做 link.所以,符号连接的使用频率要高的多。</p>\n<h3 id=\"软链接文件\"><a href=\"#软链接文件\" class=\"headerlink\" title=\"软链接文件\"></a>软链接文件</h3><p>软链接又叫符号链接，这个文件包含了另一个文件的路径名。可以是任意文件或目录，可以链接不同文件系统的文件。和win下的快捷方式差不多。链接文件甚至可以链接不存在的文件，这就产生一般称之为”断链”的问题(或曰“现象”)，链接文件甚至可以循环链接自己。类似于编程语言中的递归。 命令格式：</p>\n<pre><code>ln [-s] source_path target_path </code></pre><h3 id=\"硬链接文件\"><a href=\"#硬链接文件\" class=\"headerlink\" title=\"硬链接文件\"></a>硬链接文件</h3><p>info ln 命令告诉您，硬链接是已存在文件的另一个名字，硬连接的命令是</p>\n<pre><code>ln -d existfile newfile </code></pre><p>硬链接文件有两个限制 1、不允许给目录创建硬链接；<br>2、只有在同一文件系统中的文件之间才能创建链接。<br>对硬链接文件进行读写和删除操作时候，结果和软链接相同。但如果我们删除硬链接文件的源文件，硬链接文件仍然存在，而且保留了愿有的内容。这时，系统就“忘记”了它曾经是硬链接文件。而把他当成一个普通文件。修改其中一个，与其连接的文件同时被修改</p>\n<h3 id=\"Windows-下创建硬链接，只能适用于-NTFS-文件系统\"><a href=\"#Windows-下创建硬链接，只能适用于-NTFS-文件系统\" class=\"headerlink\" title=\"Windows 下创建硬链接，只能适用于 NTFS 文件系统\"></a>Windows 下创建硬链接，只能适用于 NTFS 文件系统</h3><pre><code>fsutil hardlink create NewFileName ExistingFileName</code></pre><h3 id=\"Windows-下创建软链接\"><a href=\"#Windows-下创建软链接\" class=\"headerlink\" title=\"Windows 下创建软链接\"></a>Windows 下创建软链接</h3><p>NTFS只支持对目录的软链接，微软把它称作 junction。但是对于文件的软链接，微软也有提供解决方案，那就是快捷方式(Shortcut，.lnk 文件)。不过软链接和快捷方式不是一个层次上的东西，前者是底层文件系统的功能，后者是应用层的功能。Windows 下目录的快捷方式用 dir 看起来是个文件。<br>命令方式</p>\n<pre><code>junction  LinkDirectory ExistingDirectory</code></pre><p>例如</p>\n<pre><code>junction d:\\link c:\\winnt</code></pre><p>将为c:\\winnt 建立一个链接目录 d:\\link，C和D分区都要是 NTFS 格式，在资源管理器和 dir 列示中 d:\\link 都以目录的面目存在的。d:\\link 就像是 c:\\winnt 的一个引用一般，删除 d:\\link 目录中的内容也就是删除了 c:\\winnt 中的内容，但删除 d:\\link 本身是不会影响到 c:\\winnt 的。</p>\n<h3 id=\"win7可以使用mklink命令\"><a href=\"#win7可以使用mklink命令\" class=\"headerlink\" title=\"win7可以使用mklink命令\"></a>win7可以使用mklink命令</h3><pre><code>λ mklink /?\n创建符号链接。\n\nMKLINK [[/D] | [/H] | [/J]] Link Target\n\n        /D      创建目录符号链接。默认为文件\n                符号链接。\n        /H      创建硬链接而非符号链接。\n        /J      创建目录联接。\n        Link    指定新的符号链接名称。\n        Target  指定新链接引用的路径\n                (相对或绝对)。</code></pre><p>其中\\D \\J区别如下</p>\n<pre><code>E:\\\nλ mkdir SourceDir\nE:\\\nλ mklink /D DTargetDir\\ SourceDir\\\n为 DTargetDir\\ &lt;&lt;===&gt;&gt; SourceDir\\ 创建的符号链接\nE:\\\nλ mklink /J JTargetDir\\ SourceDir\\\n为 JTargetDir\\ &lt;&lt;===&gt;&gt; SourceDir\\ 创建的联接</code></pre><p><img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160127111417.png\" alt> <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160127111459.png\" alt> SourceDir,JTargetDir,DTargetDir 3个文件夹内部修改/增加/删除都会互相影响。<br>复制JTargetDir, 不会出现新的目录，文件夹文件内部复制 <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160127112544.png\" alt> 这样复制会影响DTargetDir和SourceDir，慎用！ 复制DTargetDir文件夹会生成一个全新的文件夹，不会被其他文件夹影响，也不能影响其他文件夹。 复制JTargetDir的父级目录不会影响该目录，复制生成的目录下JTargetDir目录会变成独立的文件夹且文件夹内为空 <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160127132448.png\" alt> ![][0.048387699760496616] [0.048387699760496616]: <a href=\"http://7xq3ry.com1.z0.glb.clouddn.com/20160127132633.png\" target=\"_blank\" rel=\"noopener\">http://7xq3ry.com1.z0.glb.clouddn.com/20160127132633.png</a> 删除JTargetDir,DTargetDir均不影响SourceDir<br>删除SorceDir,会使得JTargetDir和DTargetDir失效 使用mklink /D时需要保证源目录和目标目录在同一个目录下，否则创建成功但不能正常访问</p>\n<h3 id=\"linux服务器的软硬件链接\"><a href=\"#linux服务器的软硬件链接\" class=\"headerlink\" title=\"linux服务器的软硬件链接\"></a>linux服务器的软硬件链接</h3><p>软链接可以跨文件系统，硬链接不可以</p>\n<pre><code>ln source target # 硬链接\nln -s source target # 软链接</code></pre><p>软链接如果跨文件夹，必须使用绝对路径,否则会出现软链接无法访问的情况</p>\n<pre><code>ln -s /var/www/html/Upload/product/manual/en/ /var/www/html/manual</code></pre>"},{"title":"linux守护进程","date":"2019-07-26T05:43:45.000Z","_content":"\n#### 什么是守护进程？\n\n[守护进程（Daemon Process）](https://zh.wikipedia.org/wiki/%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B)，也就是通常说的 Daemon 进程（精灵进程），是 Linux 中的后台服务进程。它是一个生存期较长的进程，通常独立于控制终端并且周期性地执行某种任务或等待处理某些发生的事件。\n\n守护进程是个特殊的孤儿进程，这种进程脱离终端，为什么要脱离终端呢？之所以脱离于终端是为了避免进程被任何终端所产生的信息所打断，其在执行过程中的信息也不在任何终端上显示。由于在 Linux 中，每一个系统与用户进行交流的界面称为终端，每一个从此终端开始运行的进程都会依附于这个终端，这个终端就称为这些进程的控制终端，当控制终端被关闭时，相应的进程都会自动关闭。\n\nLinux 的大多数服务器就是用守护进程实现的。\n\n#### 守护进程的分类\n\n根据守护进程的启动和管理方式，可以分为独立启动守护进程和超级守护进程两类\n\n**独立启动（stand_alone)**:该类进程启动后就常驻内存，所以会一直占用系统资源。其最大的优点就是它会一直启动，当外界有要求时相应速度较快，像httpd等进程；\n   \n**超级守护进程**：系统启动时由一个统一的守护进程xinet来负责管理一些进程，当相应请求到来时需要通过xinet的转接才可以唤醒被xinet管理的进程。这种进程的优点时最初只有xinet这一守护进程占有系统资源，其他的内部服务并不一直占有系统资源，只有数据包到来时才会被xinet管理员来唤醒。并且我们还可以通过xinet来对它所管理的进程设置一些访问权限，相当于多了一层管理机制。\n如果用两个比喻来形容两类守护进程的话一般会用银行的业务处理窗口来类比：\n   \n**独立启动**：银行里有一种单服务的窗口，像取钱，存钱等窗口，这些窗口边上始终会坐着一个人，如果有人来取钱或存钱，可以直接到相应的窗口去办理，这个处理单一服务的始终存在的人就是独立启动的守护进程；\n\n**超级守护进程**：银行里还有一种窗口，提供综合服务，像汇款，转账，提款等业务；这种窗口附近也始终坐着一个人（xinet），她可能不提供具体的服务，提供具体服务的人在里面闲着聊天啊，喝茶啊，但是当有人来汇款时他会大声喊一句，小王，有人汇款啦，然后里面管汇款的小王会立马跑过来帮忙办完汇款业务。其他的人继续聊天，喝茶。这些负责具体业务的人我们就称之为超级守护进程。当然可能汇款人会有一些规则，可能不能往北京汇款，他就会提早告诉xinet，所以如果有人来汇款想汇往北京的话，管理员就直接告诉他这个我们这里办不到的，于是就根本不会去喊汇款员了，相当于提供了一层管理机制。针对这种窗口还存在多线程和单线程的区别：多线程：将所有用户的要求都提上来，里面的人都别闲着了，都一起干活吧；\n\n**单线程**：大家都排好队了，一个一个来，里面的人同一时间只有一个人在工作。\n\n当然每个守护进程都会监听一个端口（银行窗口），一些常用守护进程的监听端口是固定的，像httpd监听80端口， sshd监听22端口等；我们可以将其理解为责任制，时候等待，有求必应。具体的端口信息可以通过cat /etc/services来查看。\n\n\n#### 查看守护进程\n```shell\nps axj\n```\n> a 表示不仅列当前用户的进程，也列出所有其他用户的进程\n\n> x 表示不仅列有控制终端的进程，也列出所有无控制终端的进程\n\n> j 表示列出与作业控制相关的信息\n```shell\n PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND                                                                                                                                              \n    0     1     1     1 ?           -1 Ss       0  12:00 /sbin/init                                                                                                                                           \n    0     2     0     0 ?           -1 S        0   0:00 [kthreadd]                                                                                                                                           \n    2     3     0     0 ?           -1 I<       0   0:00 [rcu_gp]                                                                                                                                             \n    2     4     0     0 ?           -1 I<       0   0:00 [rcu_par_gp]                                                                                                                                         \n    2     6     0     0 ?           -1 I<       0   0:00 [kworker/0:0H-kblockd]                                                                                                                               \n    2     8     0     0 ?           -1 I<       0   0:00 [mm_percpu_wq]                                                                                                                                       \n    2     9     0     0 ?           -1 S        0   3:28 [ksoftirqd/0]                                                                                                                                        \n    2    10     0     0 ?           -1 I        0  40:58 [rcu_preempt]                                                                                                                                        \n    2    11     0     0 ?           -1 I        0   0:00 [rcu_sched]                                                                                                                                          \n    2    12     0     0 ?           -1 I        0   0:00 [rcu_bh]                                                                                                                                             \n    2    13     0     0 ?           -1 S        0   5:16 [rcuc/0]                                                                                                                                             \n    2    14     0     0 ?           -1 S        0   0:00 [rcub/0]                                                                                                                                             \n```\n从上图可以看出守护进行的一些特点：\n\n> 守护进程基本上都是以超级用户启动（ UID 为 0 ）\n\n> 没有控制终端（ TTY 为 ？）\n\n> 终端进程组 ID 为 -1 （ TPGID 表示终端进程组 ID）\n\n一般情况下，守护进程可以通过以下方式启动：\n\n> 在系统启动时由启动脚本启动，这些启动脚本通常放在 /etc/rc.d 目录下；\n\n> 利用 inetd 超级服务器启动，如 telnet 等；\n\n> 由 cron 定时启动以及在终端用 nohup 启动的进程也是守护进程。\n\n#### 编写守护进程\n\n**屏蔽一些控制终端操作的信号**\n\n这是为了防止守护进行在没有运行起来前，控制终端受到干扰退出或挂起。\n\n```c\nsignal(SIGTTOU,SIG_IGN);   \nsignal(SIGTTIN,SIG_IGN);   \nsignal(SIGTSTP,SIG_IGN);   \nsignal(SIGHUP ,SIG_IGN);\n```\n\n**在后台运行**\n\n这是为避免挂起控制终端将守护进程放入后台执行。方法是在进程中调用 fork() 使父进程终止， 让守护进行在子进程中后台执行。 \n\n```c\nif( pid = fork() ){ // 父进程  \n    exit(0);        //结束父进程，子进程继续  \n}  \n```\n\n**脱离控制终端、登录会话和进程组**\n\nLinux 中的进程与控制终端，登录会话和进程组之间的关系：\n\n进程属于一个进程组，进程组号（GID）就是进程组长的进程号（PID）。登录会话可以包含多个进程组。这些进程组共享一个控制终端。这个控制终端通常是创建进程的 shell 登录终端。 控制终端、登录会话和进程组通常是从父进程继承下来的。我们的目的就是要摆脱它们 ，使之不受它们的影响。因此需要调用 setsid() 使子进程成为新的会话组长，示例代码如下：\n\n```c\nsetsid();\n```\n\nsetsid()调用成功后，进程成为新的会话组长和新的进程组长，并与原来的登录会话和进程组脱离。由于会话过程对控制终端的独占性，进程同时与控制终端脱离。 \n\n**禁止进程重新打开控制终端**\n\n现在，进程已经成为无终端的会话组长，但它可以重新申请打开一个控制终端。可以通过使进程不再成为会话组长来禁止进程重新打开控制终端，采用的方法是再次创建一个子进程，示例代码如下：\n\n```c\nif( pid=fork() ){ // 父进程  \n    exit(0);      // 结束第一子进程，第二子进程继续（第二子进程不再是会话组长）   \n}\n```\n\n**关闭打开的文件描述符**\n\n进程从创建它的父进程那里继承了打开的文件描述符。如不关闭，将会浪费系统资源，造成进程所在的文件系统无法卸下以及引起无法预料的错误。按如下方法关闭它们：\n\n```c\n// NOFILE 为 <sys/param.h> 的宏定义  \n// NOFILE 为文件描述符最大个数，不同系统有不同限制  \nfor(i=0; i< NOFILE; ++i){// 关闭打开的文件描述符  \n    close(i);  \n}\n```\n\n**改变当前工作目录**\n\n进程活动时，其工作目录所在的文件系统不能卸下。一般需要将工作目录改变到根目录。对于需要转储核心，写运行日志的进程将工作目录改变到特定目录如 /tmp。示例代码如下：\n\n```c\nchdir(\"/\");  \n```\n\n**重设文件创建掩模**\n\n进程从创建它的父进程那里继承了文件创建掩模。它可能修改守护进程所创建的文件的存取权限。为防止这一点，将文件创建掩模清除：\n\n```c\numask(0);\n```\n\n**处理 SIGCHLD 信号**\n\n但对于某些进程，特别是服务器进程往往在请求到来时生成子进程处理请求。如果父进程不等待子进程结束，子进程将成为僵尸进程（zombie）从而占用系统资源。如果父进程等待子进程结束，将增加父进程的负担，影响服务器进程的并发性能。在 Linux 下可以简单地将 SIGCHLD 信号的操作设为 SIG_IGN 。\n\n```c\nsignal(SIGCHLD, SIG_IGN);  \n```\n\n这样，内核在子进程结束时不会产生僵尸进程。\n\n代码示例\n```c\n#include<unistd.h>\n#include<signal.h>\n#include<fcntl.h>\n#include<sys/syslog.h>\n#include<sys/param.h>\n#include<sys/types.h>\n#include<sys/stat.h>\n#include<stdio.h>\n#include<stdlib.h>\n#include<time.h>\n#include <string.h>\n\nint init_daemon(void)\n{\n    int i;\n\n    // 1）屏蔽一些控制终端操作的信号  \n    signal(SIGTTOU, SIG_IGN);\n    signal(SIGTTIN, SIG_IGN);\n    signal(SIGTSTP, SIG_IGN);\n    signal(SIGHUP, SIG_IGN);\n\n    // 2）在后台运行 \n    pid_t pid = fork();\n    if(pid < 0) {\n        perror(\"fork\");\n        exit(EXIT_FAILURE); // 进程创建失败\n    }\n    if(pid > 0) {\n        exit(0);    // 退出父进程\n    }\n\n    // 3）脱离控制终端、登录会话和进程组  \n    setsid();\n\n    // 4）禁止进程重新打开控制终端  \n    pid = fork();\n    if(pid < 0) {\n        perror(\"fork\");\n        exit(EXIT_FAILURE);\n    }\n    if (pid > 0) {\n        exit(0);  // 结束第一子进程，第二子进程继续（第二子进程不再是会话组长） \n    }\n\n    // 5）关闭打开的文件描述符  \n    // NOFILE 为 <sys/param.h> 的宏定义  \n    // NOFILE 为文件描述符最大个数，不同系统有不同限制  \n    for(i=0; i<NOFILE; ++i){\n        close(i);\n    }\n\n    // 6）改变当前工作目录  \n    chdir(\"/\");\n\n    // 7）重设文件创建掩模  \n    umask(0);\n\n    // 8）处理 SIGCHLD 信号  \n    signal(SIGCHLD,SIG_IGN);\n\n    return 0;\n}\n\n\n\nint main(int argc, char *argv[]) {\n    init_daemon();\n    char *msg = \"I'm printlg process...\\n\";\n    int msg_len = strlen(msg);\n    int fd = open(\"/tmp/test_printlg.log\", O_RDWR | O_CREAT | O_APPEND, 0666);\n    if(fd < 0) {\n        printf(\"open /tmp/test_printlg.log fail.\\n\");\n        exit(EXIT_FAILURE);\n    }\n    while(1) {\n        // 每隔 3s 输出 msg 到 /tmp/test_printlg.log 文件中\n        write(fd, msg, msg_len);\n        sleep(3);\n    }\n    close(fd);\n    return 0;\n}\n\n```\n\n```shell\n# 编译\n$ gcc -o test1 main.c \n# 运行\n$ sudo ./test1\n# 查看\n$ ps axj | grep test1\n PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND \n21591 31396 31395 31395 ?           -1 R        0   0:03 ./test1\n# 查看结果\n$ vim /tmp/test_printlg.log\n# 杀死守护进程\n$ sudo kill -9 <pid>\n```\n\n#### 守护进程开机自启动\n\nlinux系统启动的顺序\n```shell\n1. BIOS\n2. MBR (boot loader)\n3. kernel loading\n4. init program\n5. initial script (/etc/rc.d/rc.sysinit)\n6. daemon start (/etc/rc.d/rc[0-6].d/*)\n7. local setting (/etc/rc.d/rc.local)\n```\n\n每个系统启动级别的守护进程位置不一致，通常有以下位置\n\n```shell\n/etc/rc.d\n/etc/rc[N].d\n```\n知道了守护进程的位置，就可以把 test1 放在 /etc/rc5.d/ 下，并且还要改名称，因为系统需要根据指定的名称来使用 for 循环来启动或者关闭每个程序，命名规则如下： \n1. S[num][name]：启动守护进程name，例如：```S01test1```\n2. K[num][name]：禁止启动守护进程name，例如：```K01test1```\n\n我们这里肯定要启动了，所以将 ```test1``` 命名为 ```S01test1```：\n```shell\nmv test1 /etc/rc5.d/S01test1\n```\n","source":"_posts/linux守护进程.md","raw":"---\ntitle: linux守护进程\ndate: 2019-07-26 13:43:45\ntags:\n  - linux\n  - 运维\n---\n\n#### 什么是守护进程？\n\n[守护进程（Daemon Process）](https://zh.wikipedia.org/wiki/%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B)，也就是通常说的 Daemon 进程（精灵进程），是 Linux 中的后台服务进程。它是一个生存期较长的进程，通常独立于控制终端并且周期性地执行某种任务或等待处理某些发生的事件。\n\n守护进程是个特殊的孤儿进程，这种进程脱离终端，为什么要脱离终端呢？之所以脱离于终端是为了避免进程被任何终端所产生的信息所打断，其在执行过程中的信息也不在任何终端上显示。由于在 Linux 中，每一个系统与用户进行交流的界面称为终端，每一个从此终端开始运行的进程都会依附于这个终端，这个终端就称为这些进程的控制终端，当控制终端被关闭时，相应的进程都会自动关闭。\n\nLinux 的大多数服务器就是用守护进程实现的。\n\n#### 守护进程的分类\n\n根据守护进程的启动和管理方式，可以分为独立启动守护进程和超级守护进程两类\n\n**独立启动（stand_alone)**:该类进程启动后就常驻内存，所以会一直占用系统资源。其最大的优点就是它会一直启动，当外界有要求时相应速度较快，像httpd等进程；\n   \n**超级守护进程**：系统启动时由一个统一的守护进程xinet来负责管理一些进程，当相应请求到来时需要通过xinet的转接才可以唤醒被xinet管理的进程。这种进程的优点时最初只有xinet这一守护进程占有系统资源，其他的内部服务并不一直占有系统资源，只有数据包到来时才会被xinet管理员来唤醒。并且我们还可以通过xinet来对它所管理的进程设置一些访问权限，相当于多了一层管理机制。\n如果用两个比喻来形容两类守护进程的话一般会用银行的业务处理窗口来类比：\n   \n**独立启动**：银行里有一种单服务的窗口，像取钱，存钱等窗口，这些窗口边上始终会坐着一个人，如果有人来取钱或存钱，可以直接到相应的窗口去办理，这个处理单一服务的始终存在的人就是独立启动的守护进程；\n\n**超级守护进程**：银行里还有一种窗口，提供综合服务，像汇款，转账，提款等业务；这种窗口附近也始终坐着一个人（xinet），她可能不提供具体的服务，提供具体服务的人在里面闲着聊天啊，喝茶啊，但是当有人来汇款时他会大声喊一句，小王，有人汇款啦，然后里面管汇款的小王会立马跑过来帮忙办完汇款业务。其他的人继续聊天，喝茶。这些负责具体业务的人我们就称之为超级守护进程。当然可能汇款人会有一些规则，可能不能往北京汇款，他就会提早告诉xinet，所以如果有人来汇款想汇往北京的话，管理员就直接告诉他这个我们这里办不到的，于是就根本不会去喊汇款员了，相当于提供了一层管理机制。针对这种窗口还存在多线程和单线程的区别：多线程：将所有用户的要求都提上来，里面的人都别闲着了，都一起干活吧；\n\n**单线程**：大家都排好队了，一个一个来，里面的人同一时间只有一个人在工作。\n\n当然每个守护进程都会监听一个端口（银行窗口），一些常用守护进程的监听端口是固定的，像httpd监听80端口， sshd监听22端口等；我们可以将其理解为责任制，时候等待，有求必应。具体的端口信息可以通过cat /etc/services来查看。\n\n\n#### 查看守护进程\n```shell\nps axj\n```\n> a 表示不仅列当前用户的进程，也列出所有其他用户的进程\n\n> x 表示不仅列有控制终端的进程，也列出所有无控制终端的进程\n\n> j 表示列出与作业控制相关的信息\n```shell\n PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND                                                                                                                                              \n    0     1     1     1 ?           -1 Ss       0  12:00 /sbin/init                                                                                                                                           \n    0     2     0     0 ?           -1 S        0   0:00 [kthreadd]                                                                                                                                           \n    2     3     0     0 ?           -1 I<       0   0:00 [rcu_gp]                                                                                                                                             \n    2     4     0     0 ?           -1 I<       0   0:00 [rcu_par_gp]                                                                                                                                         \n    2     6     0     0 ?           -1 I<       0   0:00 [kworker/0:0H-kblockd]                                                                                                                               \n    2     8     0     0 ?           -1 I<       0   0:00 [mm_percpu_wq]                                                                                                                                       \n    2     9     0     0 ?           -1 S        0   3:28 [ksoftirqd/0]                                                                                                                                        \n    2    10     0     0 ?           -1 I        0  40:58 [rcu_preempt]                                                                                                                                        \n    2    11     0     0 ?           -1 I        0   0:00 [rcu_sched]                                                                                                                                          \n    2    12     0     0 ?           -1 I        0   0:00 [rcu_bh]                                                                                                                                             \n    2    13     0     0 ?           -1 S        0   5:16 [rcuc/0]                                                                                                                                             \n    2    14     0     0 ?           -1 S        0   0:00 [rcub/0]                                                                                                                                             \n```\n从上图可以看出守护进行的一些特点：\n\n> 守护进程基本上都是以超级用户启动（ UID 为 0 ）\n\n> 没有控制终端（ TTY 为 ？）\n\n> 终端进程组 ID 为 -1 （ TPGID 表示终端进程组 ID）\n\n一般情况下，守护进程可以通过以下方式启动：\n\n> 在系统启动时由启动脚本启动，这些启动脚本通常放在 /etc/rc.d 目录下；\n\n> 利用 inetd 超级服务器启动，如 telnet 等；\n\n> 由 cron 定时启动以及在终端用 nohup 启动的进程也是守护进程。\n\n#### 编写守护进程\n\n**屏蔽一些控制终端操作的信号**\n\n这是为了防止守护进行在没有运行起来前，控制终端受到干扰退出或挂起。\n\n```c\nsignal(SIGTTOU,SIG_IGN);   \nsignal(SIGTTIN,SIG_IGN);   \nsignal(SIGTSTP,SIG_IGN);   \nsignal(SIGHUP ,SIG_IGN);\n```\n\n**在后台运行**\n\n这是为避免挂起控制终端将守护进程放入后台执行。方法是在进程中调用 fork() 使父进程终止， 让守护进行在子进程中后台执行。 \n\n```c\nif( pid = fork() ){ // 父进程  \n    exit(0);        //结束父进程，子进程继续  \n}  \n```\n\n**脱离控制终端、登录会话和进程组**\n\nLinux 中的进程与控制终端，登录会话和进程组之间的关系：\n\n进程属于一个进程组，进程组号（GID）就是进程组长的进程号（PID）。登录会话可以包含多个进程组。这些进程组共享一个控制终端。这个控制终端通常是创建进程的 shell 登录终端。 控制终端、登录会话和进程组通常是从父进程继承下来的。我们的目的就是要摆脱它们 ，使之不受它们的影响。因此需要调用 setsid() 使子进程成为新的会话组长，示例代码如下：\n\n```c\nsetsid();\n```\n\nsetsid()调用成功后，进程成为新的会话组长和新的进程组长，并与原来的登录会话和进程组脱离。由于会话过程对控制终端的独占性，进程同时与控制终端脱离。 \n\n**禁止进程重新打开控制终端**\n\n现在，进程已经成为无终端的会话组长，但它可以重新申请打开一个控制终端。可以通过使进程不再成为会话组长来禁止进程重新打开控制终端，采用的方法是再次创建一个子进程，示例代码如下：\n\n```c\nif( pid=fork() ){ // 父进程  \n    exit(0);      // 结束第一子进程，第二子进程继续（第二子进程不再是会话组长）   \n}\n```\n\n**关闭打开的文件描述符**\n\n进程从创建它的父进程那里继承了打开的文件描述符。如不关闭，将会浪费系统资源，造成进程所在的文件系统无法卸下以及引起无法预料的错误。按如下方法关闭它们：\n\n```c\n// NOFILE 为 <sys/param.h> 的宏定义  \n// NOFILE 为文件描述符最大个数，不同系统有不同限制  \nfor(i=0; i< NOFILE; ++i){// 关闭打开的文件描述符  \n    close(i);  \n}\n```\n\n**改变当前工作目录**\n\n进程活动时，其工作目录所在的文件系统不能卸下。一般需要将工作目录改变到根目录。对于需要转储核心，写运行日志的进程将工作目录改变到特定目录如 /tmp。示例代码如下：\n\n```c\nchdir(\"/\");  \n```\n\n**重设文件创建掩模**\n\n进程从创建它的父进程那里继承了文件创建掩模。它可能修改守护进程所创建的文件的存取权限。为防止这一点，将文件创建掩模清除：\n\n```c\numask(0);\n```\n\n**处理 SIGCHLD 信号**\n\n但对于某些进程，特别是服务器进程往往在请求到来时生成子进程处理请求。如果父进程不等待子进程结束，子进程将成为僵尸进程（zombie）从而占用系统资源。如果父进程等待子进程结束，将增加父进程的负担，影响服务器进程的并发性能。在 Linux 下可以简单地将 SIGCHLD 信号的操作设为 SIG_IGN 。\n\n```c\nsignal(SIGCHLD, SIG_IGN);  \n```\n\n这样，内核在子进程结束时不会产生僵尸进程。\n\n代码示例\n```c\n#include<unistd.h>\n#include<signal.h>\n#include<fcntl.h>\n#include<sys/syslog.h>\n#include<sys/param.h>\n#include<sys/types.h>\n#include<sys/stat.h>\n#include<stdio.h>\n#include<stdlib.h>\n#include<time.h>\n#include <string.h>\n\nint init_daemon(void)\n{\n    int i;\n\n    // 1）屏蔽一些控制终端操作的信号  \n    signal(SIGTTOU, SIG_IGN);\n    signal(SIGTTIN, SIG_IGN);\n    signal(SIGTSTP, SIG_IGN);\n    signal(SIGHUP, SIG_IGN);\n\n    // 2）在后台运行 \n    pid_t pid = fork();\n    if(pid < 0) {\n        perror(\"fork\");\n        exit(EXIT_FAILURE); // 进程创建失败\n    }\n    if(pid > 0) {\n        exit(0);    // 退出父进程\n    }\n\n    // 3）脱离控制终端、登录会话和进程组  \n    setsid();\n\n    // 4）禁止进程重新打开控制终端  \n    pid = fork();\n    if(pid < 0) {\n        perror(\"fork\");\n        exit(EXIT_FAILURE);\n    }\n    if (pid > 0) {\n        exit(0);  // 结束第一子进程，第二子进程继续（第二子进程不再是会话组长） \n    }\n\n    // 5）关闭打开的文件描述符  \n    // NOFILE 为 <sys/param.h> 的宏定义  \n    // NOFILE 为文件描述符最大个数，不同系统有不同限制  \n    for(i=0; i<NOFILE; ++i){\n        close(i);\n    }\n\n    // 6）改变当前工作目录  \n    chdir(\"/\");\n\n    // 7）重设文件创建掩模  \n    umask(0);\n\n    // 8）处理 SIGCHLD 信号  \n    signal(SIGCHLD,SIG_IGN);\n\n    return 0;\n}\n\n\n\nint main(int argc, char *argv[]) {\n    init_daemon();\n    char *msg = \"I'm printlg process...\\n\";\n    int msg_len = strlen(msg);\n    int fd = open(\"/tmp/test_printlg.log\", O_RDWR | O_CREAT | O_APPEND, 0666);\n    if(fd < 0) {\n        printf(\"open /tmp/test_printlg.log fail.\\n\");\n        exit(EXIT_FAILURE);\n    }\n    while(1) {\n        // 每隔 3s 输出 msg 到 /tmp/test_printlg.log 文件中\n        write(fd, msg, msg_len);\n        sleep(3);\n    }\n    close(fd);\n    return 0;\n}\n\n```\n\n```shell\n# 编译\n$ gcc -o test1 main.c \n# 运行\n$ sudo ./test1\n# 查看\n$ ps axj | grep test1\n PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND \n21591 31396 31395 31395 ?           -1 R        0   0:03 ./test1\n# 查看结果\n$ vim /tmp/test_printlg.log\n# 杀死守护进程\n$ sudo kill -9 <pid>\n```\n\n#### 守护进程开机自启动\n\nlinux系统启动的顺序\n```shell\n1. BIOS\n2. MBR (boot loader)\n3. kernel loading\n4. init program\n5. initial script (/etc/rc.d/rc.sysinit)\n6. daemon start (/etc/rc.d/rc[0-6].d/*)\n7. local setting (/etc/rc.d/rc.local)\n```\n\n每个系统启动级别的守护进程位置不一致，通常有以下位置\n\n```shell\n/etc/rc.d\n/etc/rc[N].d\n```\n知道了守护进程的位置，就可以把 test1 放在 /etc/rc5.d/ 下，并且还要改名称，因为系统需要根据指定的名称来使用 for 循环来启动或者关闭每个程序，命名规则如下： \n1. S[num][name]：启动守护进程name，例如：```S01test1```\n2. K[num][name]：禁止启动守护进程name，例如：```K01test1```\n\n我们这里肯定要启动了，所以将 ```test1``` 命名为 ```S01test1```：\n```shell\nmv test1 /etc/rc5.d/S01test1\n```\n","slug":"linux守护进程","published":1,"updated":"2019-07-26T08:07:02.477Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjyu0a5pt00499ka4vdcbo0h3","content":"<h4 id=\"什么是守护进程？\"><a href=\"#什么是守护进程？\" class=\"headerlink\" title=\"什么是守护进程？\"></a>什么是守护进程？</h4><p><a href=\"https://zh.wikipedia.org/wiki/%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B\" target=\"_blank\" rel=\"noopener\">守护进程（Daemon Process）</a>，也就是通常说的 Daemon 进程（精灵进程），是 Linux 中的后台服务进程。它是一个生存期较长的进程，通常独立于控制终端并且周期性地执行某种任务或等待处理某些发生的事件。</p>\n<p>守护进程是个特殊的孤儿进程，这种进程脱离终端，为什么要脱离终端呢？之所以脱离于终端是为了避免进程被任何终端所产生的信息所打断，其在执行过程中的信息也不在任何终端上显示。由于在 Linux 中，每一个系统与用户进行交流的界面称为终端，每一个从此终端开始运行的进程都会依附于这个终端，这个终端就称为这些进程的控制终端，当控制终端被关闭时，相应的进程都会自动关闭。</p>\n<p>Linux 的大多数服务器就是用守护进程实现的。</p>\n<h4 id=\"守护进程的分类\"><a href=\"#守护进程的分类\" class=\"headerlink\" title=\"守护进程的分类\"></a>守护进程的分类</h4><p>根据守护进程的启动和管理方式，可以分为独立启动守护进程和超级守护进程两类</p>\n<p><strong>独立启动（stand_alone)</strong>:该类进程启动后就常驻内存，所以会一直占用系统资源。其最大的优点就是它会一直启动，当外界有要求时相应速度较快，像httpd等进程；</p>\n<p><strong>超级守护进程</strong>：系统启动时由一个统一的守护进程xinet来负责管理一些进程，当相应请求到来时需要通过xinet的转接才可以唤醒被xinet管理的进程。这种进程的优点时最初只有xinet这一守护进程占有系统资源，其他的内部服务并不一直占有系统资源，只有数据包到来时才会被xinet管理员来唤醒。并且我们还可以通过xinet来对它所管理的进程设置一些访问权限，相当于多了一层管理机制。<br>如果用两个比喻来形容两类守护进程的话一般会用银行的业务处理窗口来类比：</p>\n<p><strong>独立启动</strong>：银行里有一种单服务的窗口，像取钱，存钱等窗口，这些窗口边上始终会坐着一个人，如果有人来取钱或存钱，可以直接到相应的窗口去办理，这个处理单一服务的始终存在的人就是独立启动的守护进程；</p>\n<p><strong>超级守护进程</strong>：银行里还有一种窗口，提供综合服务，像汇款，转账，提款等业务；这种窗口附近也始终坐着一个人（xinet），她可能不提供具体的服务，提供具体服务的人在里面闲着聊天啊，喝茶啊，但是当有人来汇款时他会大声喊一句，小王，有人汇款啦，然后里面管汇款的小王会立马跑过来帮忙办完汇款业务。其他的人继续聊天，喝茶。这些负责具体业务的人我们就称之为超级守护进程。当然可能汇款人会有一些规则，可能不能往北京汇款，他就会提早告诉xinet，所以如果有人来汇款想汇往北京的话，管理员就直接告诉他这个我们这里办不到的，于是就根本不会去喊汇款员了，相当于提供了一层管理机制。针对这种窗口还存在多线程和单线程的区别：多线程：将所有用户的要求都提上来，里面的人都别闲着了，都一起干活吧；</p>\n<p><strong>单线程</strong>：大家都排好队了，一个一个来，里面的人同一时间只有一个人在工作。</p>\n<p>当然每个守护进程都会监听一个端口（银行窗口），一些常用守护进程的监听端口是固定的，像httpd监听80端口， sshd监听22端口等；我们可以将其理解为责任制，时候等待，有求必应。具体的端口信息可以通过cat /etc/services来查看。</p>\n<h4 id=\"查看守护进程\"><a href=\"#查看守护进程\" class=\"headerlink\" title=\"查看守护进程\"></a>查看守护进程</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps axj</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>a 表示不仅列当前用户的进程，也列出所有其他用户的进程</p>\n</blockquote>\n<blockquote>\n<p>x 表示不仅列有控制终端的进程，也列出所有无控制终端的进程</p>\n</blockquote>\n<blockquote>\n<p>j 表示列出与作业控制相关的信息</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND                                                                                                                                              </span><br><span class=\"line\">   0     1     1     1 ?           -1 Ss       0  12:00 /sbin/init                                                                                                                                           </span><br><span class=\"line\">   0     2     0     0 ?           -1 S        0   0:00 [kthreadd]                                                                                                                                           </span><br><span class=\"line\">   2     3     0     0 ?           -1 I&lt;       0   0:00 [rcu_gp]                                                                                                                                             </span><br><span class=\"line\">   2     4     0     0 ?           -1 I&lt;       0   0:00 [rcu_par_gp]                                                                                                                                         </span><br><span class=\"line\">   2     6     0     0 ?           -1 I&lt;       0   0:00 [kworker/0:0H-kblockd]                                                                                                                               </span><br><span class=\"line\">   2     8     0     0 ?           -1 I&lt;       0   0:00 [mm_percpu_wq]                                                                                                                                       </span><br><span class=\"line\">   2     9     0     0 ?           -1 S        0   3:28 [ksoftirqd/0]                                                                                                                                        </span><br><span class=\"line\">   2    10     0     0 ?           -1 I        0  40:58 [rcu_preempt]                                                                                                                                        </span><br><span class=\"line\">   2    11     0     0 ?           -1 I        0   0:00 [rcu_sched]                                                                                                                                          </span><br><span class=\"line\">   2    12     0     0 ?           -1 I        0   0:00 [rcu_bh]                                                                                                                                             </span><br><span class=\"line\">   2    13     0     0 ?           -1 S        0   5:16 [rcuc/0]                                                                                                                                             </span><br><span class=\"line\">   2    14     0     0 ?           -1 S        0   0:00 [rcub/0]</span><br></pre></td></tr></table></figure>\n\n<p>从上图可以看出守护进行的一些特点：</p>\n<blockquote>\n<p>守护进程基本上都是以超级用户启动（ UID 为 0 ）</p>\n</blockquote>\n<blockquote>\n<p>没有控制终端（ TTY 为 ？）</p>\n</blockquote>\n<blockquote>\n<p>终端进程组 ID 为 -1 （ TPGID 表示终端进程组 ID）</p>\n</blockquote>\n<p>一般情况下，守护进程可以通过以下方式启动：</p>\n<blockquote>\n<p>在系统启动时由启动脚本启动，这些启动脚本通常放在 /etc/rc.d 目录下；</p>\n</blockquote>\n<blockquote>\n<p>利用 inetd 超级服务器启动，如 telnet 等；</p>\n</blockquote>\n<blockquote>\n<p>由 cron 定时启动以及在终端用 nohup 启动的进程也是守护进程。</p>\n</blockquote>\n<h4 id=\"编写守护进程\"><a href=\"#编写守护进程\" class=\"headerlink\" title=\"编写守护进程\"></a>编写守护进程</h4><p><strong>屏蔽一些控制终端操作的信号</strong></p>\n<p>这是为了防止守护进行在没有运行起来前，控制终端受到干扰退出或挂起。</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">signal(SIGTTOU,SIG_IGN);   </span><br><span class=\"line\">signal(SIGTTIN,SIG_IGN);   </span><br><span class=\"line\">signal(SIGTSTP,SIG_IGN);   </span><br><span class=\"line\">signal(SIGHUP ,SIG_IGN);</span><br></pre></td></tr></table></figure>\n\n<p><strong>在后台运行</strong></p>\n<p>这是为避免挂起控制终端将守护进程放入后台执行。方法是在进程中调用 fork() 使父进程终止， 让守护进行在子进程中后台执行。 </p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>( pid = fork() )&#123; <span class=\"comment\">// 父进程  </span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);        <span class=\"comment\">//结束父进程，子进程继续  </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>脱离控制终端、登录会话和进程组</strong></p>\n<p>Linux 中的进程与控制终端，登录会话和进程组之间的关系：</p>\n<p>进程属于一个进程组，进程组号（GID）就是进程组长的进程号（PID）。登录会话可以包含多个进程组。这些进程组共享一个控制终端。这个控制终端通常是创建进程的 shell 登录终端。 控制终端、登录会话和进程组通常是从父进程继承下来的。我们的目的就是要摆脱它们 ，使之不受它们的影响。因此需要调用 setsid() 使子进程成为新的会话组长，示例代码如下：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setsid();</span><br></pre></td></tr></table></figure>\n\n<p>setsid()调用成功后，进程成为新的会话组长和新的进程组长，并与原来的登录会话和进程组脱离。由于会话过程对控制终端的独占性，进程同时与控制终端脱离。 </p>\n<p><strong>禁止进程重新打开控制终端</strong></p>\n<p>现在，进程已经成为无终端的会话组长，但它可以重新申请打开一个控制终端。可以通过使进程不再成为会话组长来禁止进程重新打开控制终端，采用的方法是再次创建一个子进程，示例代码如下：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>( pid=fork() )&#123; <span class=\"comment\">// 父进程  </span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);      <span class=\"comment\">// 结束第一子进程，第二子进程继续（第二子进程不再是会话组长）   </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>关闭打开的文件描述符</strong></p>\n<p>进程从创建它的父进程那里继承了打开的文件描述符。如不关闭，将会浪费系统资源，造成进程所在的文件系统无法卸下以及引起无法预料的错误。按如下方法关闭它们：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// NOFILE 为 &lt;sys/param.h&gt; 的宏定义  </span></span><br><span class=\"line\"><span class=\"comment\">// NOFILE 为文件描述符最大个数，不同系统有不同限制  </span></span><br><span class=\"line\"><span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>; i&lt; NOFILE; ++i)&#123;<span class=\"comment\">// 关闭打开的文件描述符  </span></span><br><span class=\"line\">    close(i);  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>改变当前工作目录</strong></p>\n<p>进程活动时，其工作目录所在的文件系统不能卸下。一般需要将工作目录改变到根目录。对于需要转储核心，写运行日志的进程将工作目录改变到特定目录如 /tmp。示例代码如下：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chdir(<span class=\"string\">\"/\"</span>);</span><br></pre></td></tr></table></figure>\n\n<p><strong>重设文件创建掩模</strong></p>\n<p>进程从创建它的父进程那里继承了文件创建掩模。它可能修改守护进程所创建的文件的存取权限。为防止这一点，将文件创建掩模清除：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">umask(<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n\n<p><strong>处理 SIGCHLD 信号</strong></p>\n<p>但对于某些进程，特别是服务器进程往往在请求到来时生成子进程处理请求。如果父进程不等待子进程结束，子进程将成为僵尸进程（zombie）从而占用系统资源。如果父进程等待子进程结束，将增加父进程的负担，影响服务器进程的并发性能。在 Linux 下可以简单地将 SIGCHLD 信号的操作设为 SIG_IGN 。</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">signal(SIGCHLD, SIG_IGN);</span><br></pre></td></tr></table></figure>\n\n<p>这样，内核在子进程结束时不会产生僵尸进程。</p>\n<p>代码示例</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;signal.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;fcntl.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;sys/syslog.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;sys/param.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;sys/types.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;sys/stat.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;time.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">init_daemon</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1）屏蔽一些控制终端操作的信号  </span></span><br><span class=\"line\">    signal(SIGTTOU, SIG_IGN);</span><br><span class=\"line\">    signal(SIGTTIN, SIG_IGN);</span><br><span class=\"line\">    signal(SIGTSTP, SIG_IGN);</span><br><span class=\"line\">    signal(SIGHUP, SIG_IGN);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 2）在后台运行 </span></span><br><span class=\"line\">    <span class=\"keyword\">pid_t</span> pid = fork();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(pid &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        perror(<span class=\"string\">\"fork\"</span>);</span><br><span class=\"line\">        <span class=\"built_in\">exit</span>(EXIT_FAILURE); <span class=\"comment\">// 进程创建失败</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(pid &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);    <span class=\"comment\">// 退出父进程</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 3）脱离控制终端、登录会话和进程组  </span></span><br><span class=\"line\">    setsid();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 4）禁止进程重新打开控制终端  </span></span><br><span class=\"line\">    pid = fork();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(pid &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        perror(<span class=\"string\">\"fork\"</span>);</span><br><span class=\"line\">        <span class=\"built_in\">exit</span>(EXIT_FAILURE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (pid &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);  <span class=\"comment\">// 结束第一子进程，第二子进程继续（第二子进程不再是会话组长） </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 5）关闭打开的文件描述符  </span></span><br><span class=\"line\">    <span class=\"comment\">// NOFILE 为 &lt;sys/param.h&gt; 的宏定义  </span></span><br><span class=\"line\">    <span class=\"comment\">// NOFILE 为文件描述符最大个数，不同系统有不同限制  </span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>; i&lt;NOFILE; ++i)&#123;</span><br><span class=\"line\">        close(i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 6）改变当前工作目录  </span></span><br><span class=\"line\">    chdir(<span class=\"string\">\"/\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 7）重设文件创建掩模  </span></span><br><span class=\"line\">    umask(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 8）处理 SIGCHLD 信号  </span></span><br><span class=\"line\">    signal(SIGCHLD,SIG_IGN);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span> </span>&#123;</span><br><span class=\"line\">    init_daemon();</span><br><span class=\"line\">    <span class=\"keyword\">char</span> *msg = <span class=\"string\">\"I'm printlg process...\\n\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> msg_len = <span class=\"built_in\">strlen</span>(msg);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> fd = open(<span class=\"string\">\"/tmp/test_printlg.log\"</span>, O_RDWR | O_CREAT | O_APPEND, <span class=\"number\">0666</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(fd &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"open /tmp/test_printlg.log fail.\\n\"</span>);</span><br><span class=\"line\">        <span class=\"built_in\">exit</span>(EXIT_FAILURE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 每隔 3s 输出 msg 到 /tmp/test_printlg.log 文件中</span></span><br><span class=\"line\">        write(fd, msg, msg_len);</span><br><span class=\"line\">        sleep(<span class=\"number\">3</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    close(fd);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 编译</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> gcc -o test1 main.c </span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 运行</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo ./test1</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 查看</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ps axj | grep test1</span></span><br><span class=\"line\"> PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND </span><br><span class=\"line\">21591 31396 31395 31395 ?           -1 R        0   0:03 ./test1</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 查看结果</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> vim /tmp/test_printlg.log</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 杀死守护进程</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo <span class=\"built_in\">kill</span> -9 &lt;pid&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"守护进程开机自启动\"><a href=\"#守护进程开机自启动\" class=\"headerlink\" title=\"守护进程开机自启动\"></a>守护进程开机自启动</h4><p>linux系统启动的顺序</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. BIOS</span><br><span class=\"line\">2. MBR (boot loader)</span><br><span class=\"line\">3. kernel loading</span><br><span class=\"line\">4. init program</span><br><span class=\"line\">5. initial script (/etc/rc.d/rc.sysinit)</span><br><span class=\"line\">6. daemon start (/etc/rc.d/rc[0-6].d/*)</span><br><span class=\"line\">7. local setting (/etc/rc.d/rc.local)</span><br></pre></td></tr></table></figure>\n\n<p>每个系统启动级别的守护进程位置不一致，通常有以下位置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/etc/rc.d</span><br><span class=\"line\">/etc/rc[N].d</span><br></pre></td></tr></table></figure>\n\n<p>知道了守护进程的位置，就可以把 test1 放在 /etc/rc5.d/ 下，并且还要改名称，因为系统需要根据指定的名称来使用 for 循环来启动或者关闭每个程序，命名规则如下： </p>\n<ol>\n<li>S[num][name]：启动守护进程name，例如：<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2. K[num][name]：禁止启动守护进程name，例如：```K01test1</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>我们这里肯定要启动了，所以将 <figure class=\"highlight plain\"><figcaption><span>命名为 ```S01test1```：</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">```shell</span><br><span class=\"line\">mv test1 /etc/rc5.d/S01test1</span><br></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"什么是守护进程？\"><a href=\"#什么是守护进程？\" class=\"headerlink\" title=\"什么是守护进程？\"></a>什么是守护进程？</h4><p><a href=\"https://zh.wikipedia.org/wiki/%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B\" target=\"_blank\" rel=\"noopener\">守护进程（Daemon Process）</a>，也就是通常说的 Daemon 进程（精灵进程），是 Linux 中的后台服务进程。它是一个生存期较长的进程，通常独立于控制终端并且周期性地执行某种任务或等待处理某些发生的事件。</p>\n<p>守护进程是个特殊的孤儿进程，这种进程脱离终端，为什么要脱离终端呢？之所以脱离于终端是为了避免进程被任何终端所产生的信息所打断，其在执行过程中的信息也不在任何终端上显示。由于在 Linux 中，每一个系统与用户进行交流的界面称为终端，每一个从此终端开始运行的进程都会依附于这个终端，这个终端就称为这些进程的控制终端，当控制终端被关闭时，相应的进程都会自动关闭。</p>\n<p>Linux 的大多数服务器就是用守护进程实现的。</p>\n<h4 id=\"守护进程的分类\"><a href=\"#守护进程的分类\" class=\"headerlink\" title=\"守护进程的分类\"></a>守护进程的分类</h4><p>根据守护进程的启动和管理方式，可以分为独立启动守护进程和超级守护进程两类</p>\n<p><strong>独立启动（stand_alone)</strong>:该类进程启动后就常驻内存，所以会一直占用系统资源。其最大的优点就是它会一直启动，当外界有要求时相应速度较快，像httpd等进程；</p>\n<p><strong>超级守护进程</strong>：系统启动时由一个统一的守护进程xinet来负责管理一些进程，当相应请求到来时需要通过xinet的转接才可以唤醒被xinet管理的进程。这种进程的优点时最初只有xinet这一守护进程占有系统资源，其他的内部服务并不一直占有系统资源，只有数据包到来时才会被xinet管理员来唤醒。并且我们还可以通过xinet来对它所管理的进程设置一些访问权限，相当于多了一层管理机制。<br>如果用两个比喻来形容两类守护进程的话一般会用银行的业务处理窗口来类比：</p>\n<p><strong>独立启动</strong>：银行里有一种单服务的窗口，像取钱，存钱等窗口，这些窗口边上始终会坐着一个人，如果有人来取钱或存钱，可以直接到相应的窗口去办理，这个处理单一服务的始终存在的人就是独立启动的守护进程；</p>\n<p><strong>超级守护进程</strong>：银行里还有一种窗口，提供综合服务，像汇款，转账，提款等业务；这种窗口附近也始终坐着一个人（xinet），她可能不提供具体的服务，提供具体服务的人在里面闲着聊天啊，喝茶啊，但是当有人来汇款时他会大声喊一句，小王，有人汇款啦，然后里面管汇款的小王会立马跑过来帮忙办完汇款业务。其他的人继续聊天，喝茶。这些负责具体业务的人我们就称之为超级守护进程。当然可能汇款人会有一些规则，可能不能往北京汇款，他就会提早告诉xinet，所以如果有人来汇款想汇往北京的话，管理员就直接告诉他这个我们这里办不到的，于是就根本不会去喊汇款员了，相当于提供了一层管理机制。针对这种窗口还存在多线程和单线程的区别：多线程：将所有用户的要求都提上来，里面的人都别闲着了，都一起干活吧；</p>\n<p><strong>单线程</strong>：大家都排好队了，一个一个来，里面的人同一时间只有一个人在工作。</p>\n<p>当然每个守护进程都会监听一个端口（银行窗口），一些常用守护进程的监听端口是固定的，像httpd监听80端口， sshd监听22端口等；我们可以将其理解为责任制，时候等待，有求必应。具体的端口信息可以通过cat /etc/services来查看。</p>\n<h4 id=\"查看守护进程\"><a href=\"#查看守护进程\" class=\"headerlink\" title=\"查看守护进程\"></a>查看守护进程</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps axj</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>a 表示不仅列当前用户的进程，也列出所有其他用户的进程</p>\n</blockquote>\n<blockquote>\n<p>x 表示不仅列有控制终端的进程，也列出所有无控制终端的进程</p>\n</blockquote>\n<blockquote>\n<p>j 表示列出与作业控制相关的信息</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND                                                                                                                                              </span><br><span class=\"line\">   0     1     1     1 ?           -1 Ss       0  12:00 /sbin/init                                                                                                                                           </span><br><span class=\"line\">   0     2     0     0 ?           -1 S        0   0:00 [kthreadd]                                                                                                                                           </span><br><span class=\"line\">   2     3     0     0 ?           -1 I&lt;       0   0:00 [rcu_gp]                                                                                                                                             </span><br><span class=\"line\">   2     4     0     0 ?           -1 I&lt;       0   0:00 [rcu_par_gp]                                                                                                                                         </span><br><span class=\"line\">   2     6     0     0 ?           -1 I&lt;       0   0:00 [kworker/0:0H-kblockd]                                                                                                                               </span><br><span class=\"line\">   2     8     0     0 ?           -1 I&lt;       0   0:00 [mm_percpu_wq]                                                                                                                                       </span><br><span class=\"line\">   2     9     0     0 ?           -1 S        0   3:28 [ksoftirqd/0]                                                                                                                                        </span><br><span class=\"line\">   2    10     0     0 ?           -1 I        0  40:58 [rcu_preempt]                                                                                                                                        </span><br><span class=\"line\">   2    11     0     0 ?           -1 I        0   0:00 [rcu_sched]                                                                                                                                          </span><br><span class=\"line\">   2    12     0     0 ?           -1 I        0   0:00 [rcu_bh]                                                                                                                                             </span><br><span class=\"line\">   2    13     0     0 ?           -1 S        0   5:16 [rcuc/0]                                                                                                                                             </span><br><span class=\"line\">   2    14     0     0 ?           -1 S        0   0:00 [rcub/0]</span><br></pre></td></tr></table></figure>\n\n<p>从上图可以看出守护进行的一些特点：</p>\n<blockquote>\n<p>守护进程基本上都是以超级用户启动（ UID 为 0 ）</p>\n</blockquote>\n<blockquote>\n<p>没有控制终端（ TTY 为 ？）</p>\n</blockquote>\n<blockquote>\n<p>终端进程组 ID 为 -1 （ TPGID 表示终端进程组 ID）</p>\n</blockquote>\n<p>一般情况下，守护进程可以通过以下方式启动：</p>\n<blockquote>\n<p>在系统启动时由启动脚本启动，这些启动脚本通常放在 /etc/rc.d 目录下；</p>\n</blockquote>\n<blockquote>\n<p>利用 inetd 超级服务器启动，如 telnet 等；</p>\n</blockquote>\n<blockquote>\n<p>由 cron 定时启动以及在终端用 nohup 启动的进程也是守护进程。</p>\n</blockquote>\n<h4 id=\"编写守护进程\"><a href=\"#编写守护进程\" class=\"headerlink\" title=\"编写守护进程\"></a>编写守护进程</h4><p><strong>屏蔽一些控制终端操作的信号</strong></p>\n<p>这是为了防止守护进行在没有运行起来前，控制终端受到干扰退出或挂起。</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">signal(SIGTTOU,SIG_IGN);   </span><br><span class=\"line\">signal(SIGTTIN,SIG_IGN);   </span><br><span class=\"line\">signal(SIGTSTP,SIG_IGN);   </span><br><span class=\"line\">signal(SIGHUP ,SIG_IGN);</span><br></pre></td></tr></table></figure>\n\n<p><strong>在后台运行</strong></p>\n<p>这是为避免挂起控制终端将守护进程放入后台执行。方法是在进程中调用 fork() 使父进程终止， 让守护进行在子进程中后台执行。 </p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>( pid = fork() )&#123; <span class=\"comment\">// 父进程  </span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);        <span class=\"comment\">//结束父进程，子进程继续  </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>脱离控制终端、登录会话和进程组</strong></p>\n<p>Linux 中的进程与控制终端，登录会话和进程组之间的关系：</p>\n<p>进程属于一个进程组，进程组号（GID）就是进程组长的进程号（PID）。登录会话可以包含多个进程组。这些进程组共享一个控制终端。这个控制终端通常是创建进程的 shell 登录终端。 控制终端、登录会话和进程组通常是从父进程继承下来的。我们的目的就是要摆脱它们 ，使之不受它们的影响。因此需要调用 setsid() 使子进程成为新的会话组长，示例代码如下：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setsid();</span><br></pre></td></tr></table></figure>\n\n<p>setsid()调用成功后，进程成为新的会话组长和新的进程组长，并与原来的登录会话和进程组脱离。由于会话过程对控制终端的独占性，进程同时与控制终端脱离。 </p>\n<p><strong>禁止进程重新打开控制终端</strong></p>\n<p>现在，进程已经成为无终端的会话组长，但它可以重新申请打开一个控制终端。可以通过使进程不再成为会话组长来禁止进程重新打开控制终端，采用的方法是再次创建一个子进程，示例代码如下：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>( pid=fork() )&#123; <span class=\"comment\">// 父进程  </span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);      <span class=\"comment\">// 结束第一子进程，第二子进程继续（第二子进程不再是会话组长）   </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>关闭打开的文件描述符</strong></p>\n<p>进程从创建它的父进程那里继承了打开的文件描述符。如不关闭，将会浪费系统资源，造成进程所在的文件系统无法卸下以及引起无法预料的错误。按如下方法关闭它们：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// NOFILE 为 &lt;sys/param.h&gt; 的宏定义  </span></span><br><span class=\"line\"><span class=\"comment\">// NOFILE 为文件描述符最大个数，不同系统有不同限制  </span></span><br><span class=\"line\"><span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>; i&lt; NOFILE; ++i)&#123;<span class=\"comment\">// 关闭打开的文件描述符  </span></span><br><span class=\"line\">    close(i);  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>改变当前工作目录</strong></p>\n<p>进程活动时，其工作目录所在的文件系统不能卸下。一般需要将工作目录改变到根目录。对于需要转储核心，写运行日志的进程将工作目录改变到特定目录如 /tmp。示例代码如下：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chdir(<span class=\"string\">\"/\"</span>);</span><br></pre></td></tr></table></figure>\n\n<p><strong>重设文件创建掩模</strong></p>\n<p>进程从创建它的父进程那里继承了文件创建掩模。它可能修改守护进程所创建的文件的存取权限。为防止这一点，将文件创建掩模清除：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">umask(<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n\n<p><strong>处理 SIGCHLD 信号</strong></p>\n<p>但对于某些进程，特别是服务器进程往往在请求到来时生成子进程处理请求。如果父进程不等待子进程结束，子进程将成为僵尸进程（zombie）从而占用系统资源。如果父进程等待子进程结束，将增加父进程的负担，影响服务器进程的并发性能。在 Linux 下可以简单地将 SIGCHLD 信号的操作设为 SIG_IGN 。</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">signal(SIGCHLD, SIG_IGN);</span><br></pre></td></tr></table></figure>\n\n<p>这样，内核在子进程结束时不会产生僵尸进程。</p>\n<p>代码示例</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;signal.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;fcntl.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;sys/syslog.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;sys/param.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;sys/types.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;sys/stat.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;time.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">init_daemon</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 1）屏蔽一些控制终端操作的信号  </span></span><br><span class=\"line\">    signal(SIGTTOU, SIG_IGN);</span><br><span class=\"line\">    signal(SIGTTIN, SIG_IGN);</span><br><span class=\"line\">    signal(SIGTSTP, SIG_IGN);</span><br><span class=\"line\">    signal(SIGHUP, SIG_IGN);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 2）在后台运行 </span></span><br><span class=\"line\">    <span class=\"keyword\">pid_t</span> pid = fork();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(pid &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        perror(<span class=\"string\">\"fork\"</span>);</span><br><span class=\"line\">        <span class=\"built_in\">exit</span>(EXIT_FAILURE); <span class=\"comment\">// 进程创建失败</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(pid &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);    <span class=\"comment\">// 退出父进程</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 3）脱离控制终端、登录会话和进程组  </span></span><br><span class=\"line\">    setsid();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 4）禁止进程重新打开控制终端  </span></span><br><span class=\"line\">    pid = fork();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(pid &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        perror(<span class=\"string\">\"fork\"</span>);</span><br><span class=\"line\">        <span class=\"built_in\">exit</span>(EXIT_FAILURE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (pid &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);  <span class=\"comment\">// 结束第一子进程，第二子进程继续（第二子进程不再是会话组长） </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 5）关闭打开的文件描述符  </span></span><br><span class=\"line\">    <span class=\"comment\">// NOFILE 为 &lt;sys/param.h&gt; 的宏定义  </span></span><br><span class=\"line\">    <span class=\"comment\">// NOFILE 为文件描述符最大个数，不同系统有不同限制  </span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>; i&lt;NOFILE; ++i)&#123;</span><br><span class=\"line\">        close(i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 6）改变当前工作目录  </span></span><br><span class=\"line\">    chdir(<span class=\"string\">\"/\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 7）重设文件创建掩模  </span></span><br><span class=\"line\">    umask(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 8）处理 SIGCHLD 信号  </span></span><br><span class=\"line\">    signal(SIGCHLD,SIG_IGN);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span> </span>&#123;</span><br><span class=\"line\">    init_daemon();</span><br><span class=\"line\">    <span class=\"keyword\">char</span> *msg = <span class=\"string\">\"I'm printlg process...\\n\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> msg_len = <span class=\"built_in\">strlen</span>(msg);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> fd = open(<span class=\"string\">\"/tmp/test_printlg.log\"</span>, O_RDWR | O_CREAT | O_APPEND, <span class=\"number\">0666</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(fd &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"open /tmp/test_printlg.log fail.\\n\"</span>);</span><br><span class=\"line\">        <span class=\"built_in\">exit</span>(EXIT_FAILURE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 每隔 3s 输出 msg 到 /tmp/test_printlg.log 文件中</span></span><br><span class=\"line\">        write(fd, msg, msg_len);</span><br><span class=\"line\">        sleep(<span class=\"number\">3</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    close(fd);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 编译</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> gcc -o test1 main.c </span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 运行</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo ./test1</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 查看</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ps axj | grep test1</span></span><br><span class=\"line\"> PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND </span><br><span class=\"line\">21591 31396 31395 31395 ?           -1 R        0   0:03 ./test1</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 查看结果</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> vim /tmp/test_printlg.log</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 杀死守护进程</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo <span class=\"built_in\">kill</span> -9 &lt;pid&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"守护进程开机自启动\"><a href=\"#守护进程开机自启动\" class=\"headerlink\" title=\"守护进程开机自启动\"></a>守护进程开机自启动</h4><p>linux系统启动的顺序</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. BIOS</span><br><span class=\"line\">2. MBR (boot loader)</span><br><span class=\"line\">3. kernel loading</span><br><span class=\"line\">4. init program</span><br><span class=\"line\">5. initial script (/etc/rc.d/rc.sysinit)</span><br><span class=\"line\">6. daemon start (/etc/rc.d/rc[0-6].d/*)</span><br><span class=\"line\">7. local setting (/etc/rc.d/rc.local)</span><br></pre></td></tr></table></figure>\n\n<p>每个系统启动级别的守护进程位置不一致，通常有以下位置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/etc/rc.d</span><br><span class=\"line\">/etc/rc[N].d</span><br></pre></td></tr></table></figure>\n\n<p>知道了守护进程的位置，就可以把 test1 放在 /etc/rc5.d/ 下，并且还要改名称，因为系统需要根据指定的名称来使用 for 循环来启动或者关闭每个程序，命名规则如下： </p>\n<ol>\n<li>S[num][name]：启动守护进程name，例如：<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2. K[num][name]：禁止启动守护进程name，例如：```K01test1</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>我们这里肯定要启动了，所以将 <figure class=\"highlight plain\"><figcaption><span>命名为 ```S01test1```：</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">```shell</span><br><span class=\"line\">mv test1 /etc/rc5.d/S01test1</span><br></pre></td></tr></table></figure></p>\n"},{"title":"python从excel导出数据并批量替换word文档内容","url":"26.html","id":"26","comments":0,"date":"2016-11-09T02:07:56.000Z","_content":"\n### 老外的代码\n\n第一个是操作word，第二个是操作excel\n\n    from win32com.client import constants, Dispatch\n    import pythoncom\n    wdStory = 6\n    class WordDocument(object):\n      \"\"\"\n      Some convenience methods for Word documents accessed\n      through COM.\n      \"\"\"\n    \n      def __init__(self, visible=False):\n        self.app = Dispatch(\"Word.Application\")\n        self.app.Visible = visible\n    \n      def new(self, filename=None):\n        \"\"\"\n        Create a new Word document. If 'filename' specified,\n        use the file as a template.\n        \"\"\"\n        self.app.Documents.Add(filename)\n    \n      def open(self, filename):\n        \"\"\"\n        Open an existing Word document for editing.\n        \"\"\"\n        self.app.Documents.Open(filename)\n    \n      def save(self, filename=None):\n        \"\"\"\n        Save the active document. If 'filename' is given,\n        do a Save As.\n        \"\"\"\n        if filename:\n          self.app.ActiveDocument.SaveAs(filename)\n        else:\n          self.app.ActiveDocument.Save()\n    \n      def save_as(self, filename):\n        return self.save(filename)\n    \n      def print_out(self):\n        \"\"\"\n        Print the active document.\n        \"\"\"\n        self.app.Application.PrintOut()\n    \n      def close(self):\n        \"\"\"\n        Close the active document.\n        \"\"\"\n        self.app.ActiveDocument.Close()\n    \n      def quit(self):\n        \"\"\"\n        Quit Word.\n        \"\"\"\n        return self.app.Quit()\n    \n      def find_and_replace(self, find_str, replace_str):\n        \"\"\"\n        Find all occurances of 'find_str' and replace with 'replace_str'\n        in the active document.\n        \"\"\"\n        self.app.Selection.HomeKey(Unit=wdStory)\n        find = self.app.Selection.Find\n        find.Text = find_str\n        while self.app.Selection.Find.Execute():\n          self.app.Selection.TypeText(Text=replace_str)\n    \n\n    from win32com.client import constants, Dispatch\n    import pythoncom\n    import os\n    borderTop = 3\n    borderBottom = 4\n    borderLeft = 1\n    borderRight = 2\n    borderSolid = 1\n    borderDashed = 2\n    borderDotted = 3\n    colorBlack = 1\n    directionUp = -4162\n    directionDown = -4121\n    directionLeft = -4131\n    directionRight = -4152\n    class ExcelDocument(object):\n      \"\"\"\n      Some convenience methods for Excel documents accessed\n      through COM.\n      \"\"\"\n      def __init__(self, visible=False):\n        self.app = Dispatch(\"Excel.Application\")\n        self.app.Visible = visible\n        self.sheet = 1\n      def new(self, filename=None):\n        \"\"\"\n        Create a new Excel workbook. If 'filename' specified,\n        use the file as a template.\n        \"\"\"\n        self.app.Workbooks.Add(filename)\n      def open(self, filename):\n        \"\"\"\n        Open an existing Excel workbook for editing.\n        \"\"\"\n        self.app.Workbooks.Open(filename)\n      def set_sheet(self, sheet):\n        \"\"\"\n        Set the active worksheet.\n        \"\"\"\n        self.sheet = sheet\n      def get_range(self, range):\n        \"\"\"\n        Get a range object for the specified range or single cell.\n        \"\"\"\n        return self.app.ActiveWorkbook.Sheets(self.sheet).Range(range)\n      def set_value(self, cell, value=''):\n        \"\"\"\n        Set the value of 'cell' to 'value'.\n        \"\"\"\n        self.get_range(cell).Value = value\n      def get_value(self, cell):\n        \"\"\"\n        Get the value of 'cell'.\n        \"\"\"\n        value = self.get_range(cell).Value\n        if isinstance(value, tuple):\n          value = [v[0] for v in value]\n        return value\n      def set_border(self, range, side, line_style=borderSolid, color=colorBlack):\n        \"\"\"\n        Set a border on the specified range of cells or single cell.\n        'range' = range of cells or single cell\n        'side' = one of borderTop, borderBottom, borderLeft, borderRight\n        'line_style' = one of borderSolid, borderDashed, borderDotted, others?\n        'color' = one of colorBlack, others?\n        \"\"\"\n        range = self.get_range(range).Borders(side)\n        range.LineStyle = line_style\n        range.Color = color\n      def sort(self, range, key_cell):\n        \"\"\"\n        Sort the specified 'range' of the activeworksheet by the\n        specified 'key_cell'.\n        \"\"\"\n        range.Sort(Key1=self.get_range(key_cell), Order1=1, Header=0, OrderCustom=1, MatchCase=False, Orientation=1)\n      def hide_row(self, row, hide=True):\n        \"\"\"\n        Hide the specified 'row'.\n        Specify hide=False to show the row.\n        \"\"\"\n        self.get_range('a%s' % row).EntireRow.Hidden = hide\n      def hide_column(self, column, hide=True):\n        \"\"\"\n        Hide the specified 'column'.\n        Specify hide=False to show the column.\n        \"\"\"\n        self.get_range('%s1' % column).EntireColumn.Hidden = hide\n      def delete_row(self, row, shift=directionUp):\n        \"\"\"\n        Delete the entire 'row'.\n        \"\"\"\n        self.get_range('a%s' % row).EntireRow.Delete(Shift=shift)\n      def delete_column(self, column, shift=directionLeft):\n        \"\"\"\n        Delete the entire 'column'.\n        \"\"\"\n        self.get_range('%s1' % column).EntireColumn.Delete(Shift=shift)\n      def fit_column(self, column):\n        \"\"\"\n        Resize the specified 'column' to fit all its contents.\n        \"\"\"\n        self.get_range('%s1' % column).EntireColumn.AutoFit()\n      def save(self):\n        \"\"\"\n        Save the active workbook.\n        \"\"\"\n        self.app.ActiveWorkbook.Save()\n      def save_as(self, filename, delete_existing=False):\n        \"\"\"\n        Save the active workbook as a different filename.\n        If 'delete_existing' is specified and the file already\n        exists, it will be deleted before saving.\n        \"\"\"\n        if delete_existing and os.path.exists(filename):\n          os.remove(filename)\n        self.app.ActiveWorkbook.SaveAs(filename)\n      def print_out(self):\n        \"\"\"\n        Print the active workbook.\n        \"\"\"\n        self.app.Application.PrintOut()\n      def close(self):\n        \"\"\"\n        Close the active workbook.\n        \"\"\"\n        self.app.ActiveWorkbook.Close()\n      def quit(self):\n        \"\"\"\n        Quit Excel.\n        \"\"\"\n        return self.app.Quit()\n    \n\n### 基本使用方法\n\n    # -*- encoding: utf8 -*-\n    \n    # 配置项\n    import os\n    import shutil\n    import re\n    import time\n    import win32com\n    from win32com.client import constants\n    import xlrd\n    XlsFile = 'default.xls'                  # 需要的数据\n    OldStrs = ['#CatalogNumber#',\n               '#ProductName#',\n               '#OSpecies#',\n               '#Short#',\n               '#Organism#',\n               '#Fragment#',\n               '#PROTEIN#',\n               '#Tag#'\n               ]\n    \n    # 确认模板类型\n    DefaultFile = raw_input('Want to use ihc.jpg,input \\'Y\\',or input \\'N\\':\\n')\n    if DefaultFile == 'N':\n        DocFile = os.path.abspath('default_noihc.doc')\n        print DocFile\n    elif DefaultFile == 'Y':\n        DocFile = os.path.abspath('default.doc')\n        print DocFile\n    else:\n        raise\n    filepath = 'D:/Py/CreateAntibodyWord/NewFile'    # 生成文件目录\n    \n    \n    # 获取括号内容的正则表达式\n    patt = re.compile(r\"\\((.*?)\\)\", re.I | re.X)\n    \n    # 打开初始化word文档\n    w = win32com.client.Dispatch('Word.Application')\n    w.Visible = 0\n    w.DisplayAlerts = 0\n    \n    # 从excel表格中导入数据\n    \n    data = xlrd.open_workbook(XlsFile) \n    table = data.sheets()[0]\n    nrows = table.nrows\n    \n    # 循环表格中的内容\n    for i in range(1, nrows):\n        try:\n            # 获取新的数据\n            CatalogNumber = table.row_values(i)[0]\n            ProductName = table.row_values(i)[1]\n            OrganismSpecies = table.row_values(i)[2]\n            Tag = table.row_values(i)[3]\n            Fragment = table.row_values(i)[4]\n            Short = patt.findall(ProductName)[0]\n            # 获取对应蛋白的货号\n            ProteinNumber = re.sub(r'^PA', r'RP', CatalogNumber)\n            # Ge多物种没有缩写，用General替代\n            Organism = patt.findall(OrganismSpecies)\n            if len(Organism) > 0:\n                Organism = Organism[0]\n            else:\n                Organism = 'General'\n            # 没有氨基酸片段信息的用原始值替代\n            Fragment = patt.findall(Fragment)\n            if len(Fragment) > 0:\n                Fragment = Fragment[0]\n            else:\n                Fragment = '#Fragment#'\n            NewStrs = [CatalogNumber,\n                       ProductName,\n                       OrganismSpecies,\n                       Short,\n                       Organism,\n                       Fragment,\n                       ProteinNumber,\n                       Tag\n                       ]\n    \n            # 打开复制的文件\n            NewFileName = CatalogNumber + '-e.doc'                                        # 命名新的文件\n            shutil.copyfile(DocFile, filepath + '/' + NewFileName)                        # 复制新的文件\n            CopyFile = os.path.abspath(filepath + '/' + NewFileName)                      # 新的文件目录\n            doc = w.Documents.Open(FileName=CopyFile)                                     # 打开文件\n    \n            # 文本框处理\n            canvas = doc.Shapes[2]\n            canvas.TextFrame.TextRange.Find.Execute(OldStrs[3], False, False, False, False, False, True, 1, True, NewStrs[3], 2)\n            canvas.TextFrame.TextRange.Find.Execute(OldStrs[4], False, False, False, False, False, True, 1, True, NewStrs[4], 2)\n    \n            # 正文文字处理\n            w.Selection.Find.ClearFormatting()\n            w.Selection.Find.Replacement.ClearFormatting()\n            for j in range(len(NewStrs)):\n                w.Selection.Find.Execute(OldStrs[j], False, False, False, False, False, True, 1, True, NewStrs[j], 2)\n    \n            # 获取属性信息并修改,参考https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.builtindocumentproperties(v=vs.120).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1\n            doc.BuiltInDocumentProperties('Title').Value = ProductName\n            doc.BuiltInDocumentProperties('Subject').Value = 'Instruction manual (Catalog No.' + CatalogNumber + ')'\n            doc.BuiltInDocumentProperties('Keywords').Value = ProductName\n            doc.BuiltInDocumentProperties('Category').Value = OrganismSpecies\n    \n            # 保存文件并关闭\n            doc.Save()\n            doc.Close()\n            print CatalogNumber + ' create word success!'\n    \n        # 捕获异常并写入log文件中\n        except Exception, e:\n            print CatalogNumber + ' create word error!'\n            print e\n            errorfile = open(filepath + '/errorlog.txt', 'a')\n            try:\n                errorfile.write(CatalogNumber + ' create word error! ' + time.strftime('%Y-%m-%d %H:%M:%S') + '\\n')\n            except Exception, e:\n                doc.Close()\n                w.Quit()\n                raise e\n            finally:\n                errorfile.close()\n    w.Quit()        \n    \n    \n\n### 替换Word文档属性里的详细信息\n\n            doc.BuiltInDocumentProperties('Title').Value = ProductName\n            doc.BuiltInDocumentProperties('Subject').Value = 'Instruction manual (Catalog No.' + CatalogNumber + ')'\n            doc.BuiltInDocumentProperties('Keywords').Value = ProductName\n            doc.BuiltInDocumentProperties('Category').Value = Ospecies\n    \n\n参考[微软官方说明](http://stackoverflow.com/questions/3022898/python-win32com-automating-word-how-to-replace-text-in-a-text-box)\n\n### 替换Word长文本\n\n使用以下语句替换长文本会报错\"字符串过长\"\n\n    w.Selection.Find.Execute(OldStrs[j], False, False, False, False, False, True, 1, True, NewStrs[j], 2)\n    \n\n使用以下语句\n\n    find = w.Selection.Find\n    find.Text = '#SEQUENCE#'\n    while w.Selection.Find.Execute():\n        w.Selection.TypeText(Text=SEQUENCE)\n    \n\n### 替换Word文本框内容\n\n参考以下代码 [http://stackoverflow.com/](http://stackoverflow.com/questions/3022898/python-win32com-automating-word-how-to-replace-text-in-a-text-box)\n\n    import win32com.client\n    \n    word = win32com.client.Dispatch(\"Word.Application\")\n    canvas = word.ActiveDocument.Shapes[0]\n    for item in canvas.CanvasItems:\n        print item.TextFrame.TextRange.Text\n    \n\n或者\n\n    find = shp.TextFrame.TextRange.Find\n    find.Text = source\n    find.Replacement.Text = target\n    find.Execute(Replace=1, Forward=True)","source":"_posts/python从excel导出数据并批量替换word文档内容.md","raw":"---\ntitle: python从excel导出数据并批量替换word文档内容\ntags:\n  - python\nurl: 26.html\nid: 26\ncomments: false\ncategories:\n  - 办公\n  - 运维\ndate: 2016-11-09 10:07:56\n---\n\n### 老外的代码\n\n第一个是操作word，第二个是操作excel\n\n    from win32com.client import constants, Dispatch\n    import pythoncom\n    wdStory = 6\n    class WordDocument(object):\n      \"\"\"\n      Some convenience methods for Word documents accessed\n      through COM.\n      \"\"\"\n    \n      def __init__(self, visible=False):\n        self.app = Dispatch(\"Word.Application\")\n        self.app.Visible = visible\n    \n      def new(self, filename=None):\n        \"\"\"\n        Create a new Word document. If 'filename' specified,\n        use the file as a template.\n        \"\"\"\n        self.app.Documents.Add(filename)\n    \n      def open(self, filename):\n        \"\"\"\n        Open an existing Word document for editing.\n        \"\"\"\n        self.app.Documents.Open(filename)\n    \n      def save(self, filename=None):\n        \"\"\"\n        Save the active document. If 'filename' is given,\n        do a Save As.\n        \"\"\"\n        if filename:\n          self.app.ActiveDocument.SaveAs(filename)\n        else:\n          self.app.ActiveDocument.Save()\n    \n      def save_as(self, filename):\n        return self.save(filename)\n    \n      def print_out(self):\n        \"\"\"\n        Print the active document.\n        \"\"\"\n        self.app.Application.PrintOut()\n    \n      def close(self):\n        \"\"\"\n        Close the active document.\n        \"\"\"\n        self.app.ActiveDocument.Close()\n    \n      def quit(self):\n        \"\"\"\n        Quit Word.\n        \"\"\"\n        return self.app.Quit()\n    \n      def find_and_replace(self, find_str, replace_str):\n        \"\"\"\n        Find all occurances of 'find_str' and replace with 'replace_str'\n        in the active document.\n        \"\"\"\n        self.app.Selection.HomeKey(Unit=wdStory)\n        find = self.app.Selection.Find\n        find.Text = find_str\n        while self.app.Selection.Find.Execute():\n          self.app.Selection.TypeText(Text=replace_str)\n    \n\n    from win32com.client import constants, Dispatch\n    import pythoncom\n    import os\n    borderTop = 3\n    borderBottom = 4\n    borderLeft = 1\n    borderRight = 2\n    borderSolid = 1\n    borderDashed = 2\n    borderDotted = 3\n    colorBlack = 1\n    directionUp = -4162\n    directionDown = -4121\n    directionLeft = -4131\n    directionRight = -4152\n    class ExcelDocument(object):\n      \"\"\"\n      Some convenience methods for Excel documents accessed\n      through COM.\n      \"\"\"\n      def __init__(self, visible=False):\n        self.app = Dispatch(\"Excel.Application\")\n        self.app.Visible = visible\n        self.sheet = 1\n      def new(self, filename=None):\n        \"\"\"\n        Create a new Excel workbook. If 'filename' specified,\n        use the file as a template.\n        \"\"\"\n        self.app.Workbooks.Add(filename)\n      def open(self, filename):\n        \"\"\"\n        Open an existing Excel workbook for editing.\n        \"\"\"\n        self.app.Workbooks.Open(filename)\n      def set_sheet(self, sheet):\n        \"\"\"\n        Set the active worksheet.\n        \"\"\"\n        self.sheet = sheet\n      def get_range(self, range):\n        \"\"\"\n        Get a range object for the specified range or single cell.\n        \"\"\"\n        return self.app.ActiveWorkbook.Sheets(self.sheet).Range(range)\n      def set_value(self, cell, value=''):\n        \"\"\"\n        Set the value of 'cell' to 'value'.\n        \"\"\"\n        self.get_range(cell).Value = value\n      def get_value(self, cell):\n        \"\"\"\n        Get the value of 'cell'.\n        \"\"\"\n        value = self.get_range(cell).Value\n        if isinstance(value, tuple):\n          value = [v[0] for v in value]\n        return value\n      def set_border(self, range, side, line_style=borderSolid, color=colorBlack):\n        \"\"\"\n        Set a border on the specified range of cells or single cell.\n        'range' = range of cells or single cell\n        'side' = one of borderTop, borderBottom, borderLeft, borderRight\n        'line_style' = one of borderSolid, borderDashed, borderDotted, others?\n        'color' = one of colorBlack, others?\n        \"\"\"\n        range = self.get_range(range).Borders(side)\n        range.LineStyle = line_style\n        range.Color = color\n      def sort(self, range, key_cell):\n        \"\"\"\n        Sort the specified 'range' of the activeworksheet by the\n        specified 'key_cell'.\n        \"\"\"\n        range.Sort(Key1=self.get_range(key_cell), Order1=1, Header=0, OrderCustom=1, MatchCase=False, Orientation=1)\n      def hide_row(self, row, hide=True):\n        \"\"\"\n        Hide the specified 'row'.\n        Specify hide=False to show the row.\n        \"\"\"\n        self.get_range('a%s' % row).EntireRow.Hidden = hide\n      def hide_column(self, column, hide=True):\n        \"\"\"\n        Hide the specified 'column'.\n        Specify hide=False to show the column.\n        \"\"\"\n        self.get_range('%s1' % column).EntireColumn.Hidden = hide\n      def delete_row(self, row, shift=directionUp):\n        \"\"\"\n        Delete the entire 'row'.\n        \"\"\"\n        self.get_range('a%s' % row).EntireRow.Delete(Shift=shift)\n      def delete_column(self, column, shift=directionLeft):\n        \"\"\"\n        Delete the entire 'column'.\n        \"\"\"\n        self.get_range('%s1' % column).EntireColumn.Delete(Shift=shift)\n      def fit_column(self, column):\n        \"\"\"\n        Resize the specified 'column' to fit all its contents.\n        \"\"\"\n        self.get_range('%s1' % column).EntireColumn.AutoFit()\n      def save(self):\n        \"\"\"\n        Save the active workbook.\n        \"\"\"\n        self.app.ActiveWorkbook.Save()\n      def save_as(self, filename, delete_existing=False):\n        \"\"\"\n        Save the active workbook as a different filename.\n        If 'delete_existing' is specified and the file already\n        exists, it will be deleted before saving.\n        \"\"\"\n        if delete_existing and os.path.exists(filename):\n          os.remove(filename)\n        self.app.ActiveWorkbook.SaveAs(filename)\n      def print_out(self):\n        \"\"\"\n        Print the active workbook.\n        \"\"\"\n        self.app.Application.PrintOut()\n      def close(self):\n        \"\"\"\n        Close the active workbook.\n        \"\"\"\n        self.app.ActiveWorkbook.Close()\n      def quit(self):\n        \"\"\"\n        Quit Excel.\n        \"\"\"\n        return self.app.Quit()\n    \n\n### 基本使用方法\n\n    # -*- encoding: utf8 -*-\n    \n    # 配置项\n    import os\n    import shutil\n    import re\n    import time\n    import win32com\n    from win32com.client import constants\n    import xlrd\n    XlsFile = 'default.xls'                  # 需要的数据\n    OldStrs = ['#CatalogNumber#',\n               '#ProductName#',\n               '#OSpecies#',\n               '#Short#',\n               '#Organism#',\n               '#Fragment#',\n               '#PROTEIN#',\n               '#Tag#'\n               ]\n    \n    # 确认模板类型\n    DefaultFile = raw_input('Want to use ihc.jpg,input \\'Y\\',or input \\'N\\':\\n')\n    if DefaultFile == 'N':\n        DocFile = os.path.abspath('default_noihc.doc')\n        print DocFile\n    elif DefaultFile == 'Y':\n        DocFile = os.path.abspath('default.doc')\n        print DocFile\n    else:\n        raise\n    filepath = 'D:/Py/CreateAntibodyWord/NewFile'    # 生成文件目录\n    \n    \n    # 获取括号内容的正则表达式\n    patt = re.compile(r\"\\((.*?)\\)\", re.I | re.X)\n    \n    # 打开初始化word文档\n    w = win32com.client.Dispatch('Word.Application')\n    w.Visible = 0\n    w.DisplayAlerts = 0\n    \n    # 从excel表格中导入数据\n    \n    data = xlrd.open_workbook(XlsFile) \n    table = data.sheets()[0]\n    nrows = table.nrows\n    \n    # 循环表格中的内容\n    for i in range(1, nrows):\n        try:\n            # 获取新的数据\n            CatalogNumber = table.row_values(i)[0]\n            ProductName = table.row_values(i)[1]\n            OrganismSpecies = table.row_values(i)[2]\n            Tag = table.row_values(i)[3]\n            Fragment = table.row_values(i)[4]\n            Short = patt.findall(ProductName)[0]\n            # 获取对应蛋白的货号\n            ProteinNumber = re.sub(r'^PA', r'RP', CatalogNumber)\n            # Ge多物种没有缩写，用General替代\n            Organism = patt.findall(OrganismSpecies)\n            if len(Organism) > 0:\n                Organism = Organism[0]\n            else:\n                Organism = 'General'\n            # 没有氨基酸片段信息的用原始值替代\n            Fragment = patt.findall(Fragment)\n            if len(Fragment) > 0:\n                Fragment = Fragment[0]\n            else:\n                Fragment = '#Fragment#'\n            NewStrs = [CatalogNumber,\n                       ProductName,\n                       OrganismSpecies,\n                       Short,\n                       Organism,\n                       Fragment,\n                       ProteinNumber,\n                       Tag\n                       ]\n    \n            # 打开复制的文件\n            NewFileName = CatalogNumber + '-e.doc'                                        # 命名新的文件\n            shutil.copyfile(DocFile, filepath + '/' + NewFileName)                        # 复制新的文件\n            CopyFile = os.path.abspath(filepath + '/' + NewFileName)                      # 新的文件目录\n            doc = w.Documents.Open(FileName=CopyFile)                                     # 打开文件\n    \n            # 文本框处理\n            canvas = doc.Shapes[2]\n            canvas.TextFrame.TextRange.Find.Execute(OldStrs[3], False, False, False, False, False, True, 1, True, NewStrs[3], 2)\n            canvas.TextFrame.TextRange.Find.Execute(OldStrs[4], False, False, False, False, False, True, 1, True, NewStrs[4], 2)\n    \n            # 正文文字处理\n            w.Selection.Find.ClearFormatting()\n            w.Selection.Find.Replacement.ClearFormatting()\n            for j in range(len(NewStrs)):\n                w.Selection.Find.Execute(OldStrs[j], False, False, False, False, False, True, 1, True, NewStrs[j], 2)\n    \n            # 获取属性信息并修改,参考https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.builtindocumentproperties(v=vs.120).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1\n            doc.BuiltInDocumentProperties('Title').Value = ProductName\n            doc.BuiltInDocumentProperties('Subject').Value = 'Instruction manual (Catalog No.' + CatalogNumber + ')'\n            doc.BuiltInDocumentProperties('Keywords').Value = ProductName\n            doc.BuiltInDocumentProperties('Category').Value = OrganismSpecies\n    \n            # 保存文件并关闭\n            doc.Save()\n            doc.Close()\n            print CatalogNumber + ' create word success!'\n    \n        # 捕获异常并写入log文件中\n        except Exception, e:\n            print CatalogNumber + ' create word error!'\n            print e\n            errorfile = open(filepath + '/errorlog.txt', 'a')\n            try:\n                errorfile.write(CatalogNumber + ' create word error! ' + time.strftime('%Y-%m-%d %H:%M:%S') + '\\n')\n            except Exception, e:\n                doc.Close()\n                w.Quit()\n                raise e\n            finally:\n                errorfile.close()\n    w.Quit()        \n    \n    \n\n### 替换Word文档属性里的详细信息\n\n            doc.BuiltInDocumentProperties('Title').Value = ProductName\n            doc.BuiltInDocumentProperties('Subject').Value = 'Instruction manual (Catalog No.' + CatalogNumber + ')'\n            doc.BuiltInDocumentProperties('Keywords').Value = ProductName\n            doc.BuiltInDocumentProperties('Category').Value = Ospecies\n    \n\n参考[微软官方说明](http://stackoverflow.com/questions/3022898/python-win32com-automating-word-how-to-replace-text-in-a-text-box)\n\n### 替换Word长文本\n\n使用以下语句替换长文本会报错\"字符串过长\"\n\n    w.Selection.Find.Execute(OldStrs[j], False, False, False, False, False, True, 1, True, NewStrs[j], 2)\n    \n\n使用以下语句\n\n    find = w.Selection.Find\n    find.Text = '#SEQUENCE#'\n    while w.Selection.Find.Execute():\n        w.Selection.TypeText(Text=SEQUENCE)\n    \n\n### 替换Word文本框内容\n\n参考以下代码 [http://stackoverflow.com/](http://stackoverflow.com/questions/3022898/python-win32com-automating-word-how-to-replace-text-in-a-text-box)\n\n    import win32com.client\n    \n    word = win32com.client.Dispatch(\"Word.Application\")\n    canvas = word.ActiveDocument.Shapes[0]\n    for item in canvas.CanvasItems:\n        print item.TextFrame.TextRange.Text\n    \n\n或者\n\n    find = shp.TextFrame.TextRange.Find\n    find.Text = source\n    find.Replacement.Text = target\n    find.Execute(Replace=1, Forward=True)","slug":"python从excel导出数据并批量替换word文档内容","published":1,"updated":"2019-07-24T01:37:03.210Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5pv004a9ka4odap3sia","content":"<h3 id=\"老外的代码\"><a href=\"#老外的代码\" class=\"headerlink\" title=\"老外的代码\"></a>老外的代码</h3><p>第一个是操作word，第二个是操作excel</p>\n<pre><code>from win32com.client import constants, Dispatch\nimport pythoncom\nwdStory = 6\nclass WordDocument(object):\n  &quot;&quot;&quot;\n  Some convenience methods for Word documents accessed\n  through COM.\n  &quot;&quot;&quot;\n\n  def __init__(self, visible=False):\n    self.app = Dispatch(&quot;Word.Application&quot;)\n    self.app.Visible = visible\n\n  def new(self, filename=None):\n    &quot;&quot;&quot;\n    Create a new Word document. If &apos;filename&apos; specified,\n    use the file as a template.\n    &quot;&quot;&quot;\n    self.app.Documents.Add(filename)\n\n  def open(self, filename):\n    &quot;&quot;&quot;\n    Open an existing Word document for editing.\n    &quot;&quot;&quot;\n    self.app.Documents.Open(filename)\n\n  def save(self, filename=None):\n    &quot;&quot;&quot;\n    Save the active document. If &apos;filename&apos; is given,\n    do a Save As.\n    &quot;&quot;&quot;\n    if filename:\n      self.app.ActiveDocument.SaveAs(filename)\n    else:\n      self.app.ActiveDocument.Save()\n\n  def save_as(self, filename):\n    return self.save(filename)\n\n  def print_out(self):\n    &quot;&quot;&quot;\n    Print the active document.\n    &quot;&quot;&quot;\n    self.app.Application.PrintOut()\n\n  def close(self):\n    &quot;&quot;&quot;\n    Close the active document.\n    &quot;&quot;&quot;\n    self.app.ActiveDocument.Close()\n\n  def quit(self):\n    &quot;&quot;&quot;\n    Quit Word.\n    &quot;&quot;&quot;\n    return self.app.Quit()\n\n  def find_and_replace(self, find_str, replace_str):\n    &quot;&quot;&quot;\n    Find all occurances of &apos;find_str&apos; and replace with &apos;replace_str&apos;\n    in the active document.\n    &quot;&quot;&quot;\n    self.app.Selection.HomeKey(Unit=wdStory)\n    find = self.app.Selection.Find\n    find.Text = find_str\n    while self.app.Selection.Find.Execute():\n      self.app.Selection.TypeText(Text=replace_str)\n\n\nfrom win32com.client import constants, Dispatch\nimport pythoncom\nimport os\nborderTop = 3\nborderBottom = 4\nborderLeft = 1\nborderRight = 2\nborderSolid = 1\nborderDashed = 2\nborderDotted = 3\ncolorBlack = 1\ndirectionUp = -4162\ndirectionDown = -4121\ndirectionLeft = -4131\ndirectionRight = -4152\nclass ExcelDocument(object):\n  &quot;&quot;&quot;\n  Some convenience methods for Excel documents accessed\n  through COM.\n  &quot;&quot;&quot;\n  def __init__(self, visible=False):\n    self.app = Dispatch(&quot;Excel.Application&quot;)\n    self.app.Visible = visible\n    self.sheet = 1\n  def new(self, filename=None):\n    &quot;&quot;&quot;\n    Create a new Excel workbook. If &apos;filename&apos; specified,\n    use the file as a template.\n    &quot;&quot;&quot;\n    self.app.Workbooks.Add(filename)\n  def open(self, filename):\n    &quot;&quot;&quot;\n    Open an existing Excel workbook for editing.\n    &quot;&quot;&quot;\n    self.app.Workbooks.Open(filename)\n  def set_sheet(self, sheet):\n    &quot;&quot;&quot;\n    Set the active worksheet.\n    &quot;&quot;&quot;\n    self.sheet = sheet\n  def get_range(self, range):\n    &quot;&quot;&quot;\n    Get a range object for the specified range or single cell.\n    &quot;&quot;&quot;\n    return self.app.ActiveWorkbook.Sheets(self.sheet).Range(range)\n  def set_value(self, cell, value=&apos;&apos;):\n    &quot;&quot;&quot;\n    Set the value of &apos;cell&apos; to &apos;value&apos;.\n    &quot;&quot;&quot;\n    self.get_range(cell).Value = value\n  def get_value(self, cell):\n    &quot;&quot;&quot;\n    Get the value of &apos;cell&apos;.\n    &quot;&quot;&quot;\n    value = self.get_range(cell).Value\n    if isinstance(value, tuple):\n      value = [v[0] for v in value]\n    return value\n  def set_border(self, range, side, line_style=borderSolid, color=colorBlack):\n    &quot;&quot;&quot;\n    Set a border on the specified range of cells or single cell.\n    &apos;range&apos; = range of cells or single cell\n    &apos;side&apos; = one of borderTop, borderBottom, borderLeft, borderRight\n    &apos;line_style&apos; = one of borderSolid, borderDashed, borderDotted, others?\n    &apos;color&apos; = one of colorBlack, others?\n    &quot;&quot;&quot;\n    range = self.get_range(range).Borders(side)\n    range.LineStyle = line_style\n    range.Color = color\n  def sort(self, range, key_cell):\n    &quot;&quot;&quot;\n    Sort the specified &apos;range&apos; of the activeworksheet by the\n    specified &apos;key_cell&apos;.\n    &quot;&quot;&quot;\n    range.Sort(Key1=self.get_range(key_cell), Order1=1, Header=0, OrderCustom=1, MatchCase=False, Orientation=1)\n  def hide_row(self, row, hide=True):\n    &quot;&quot;&quot;\n    Hide the specified &apos;row&apos;.\n    Specify hide=False to show the row.\n    &quot;&quot;&quot;\n    self.get_range(&apos;a%s&apos; % row).EntireRow.Hidden = hide\n  def hide_column(self, column, hide=True):\n    &quot;&quot;&quot;\n    Hide the specified &apos;column&apos;.\n    Specify hide=False to show the column.\n    &quot;&quot;&quot;\n    self.get_range(&apos;%s1&apos; % column).EntireColumn.Hidden = hide\n  def delete_row(self, row, shift=directionUp):\n    &quot;&quot;&quot;\n    Delete the entire &apos;row&apos;.\n    &quot;&quot;&quot;\n    self.get_range(&apos;a%s&apos; % row).EntireRow.Delete(Shift=shift)\n  def delete_column(self, column, shift=directionLeft):\n    &quot;&quot;&quot;\n    Delete the entire &apos;column&apos;.\n    &quot;&quot;&quot;\n    self.get_range(&apos;%s1&apos; % column).EntireColumn.Delete(Shift=shift)\n  def fit_column(self, column):\n    &quot;&quot;&quot;\n    Resize the specified &apos;column&apos; to fit all its contents.\n    &quot;&quot;&quot;\n    self.get_range(&apos;%s1&apos; % column).EntireColumn.AutoFit()\n  def save(self):\n    &quot;&quot;&quot;\n    Save the active workbook.\n    &quot;&quot;&quot;\n    self.app.ActiveWorkbook.Save()\n  def save_as(self, filename, delete_existing=False):\n    &quot;&quot;&quot;\n    Save the active workbook as a different filename.\n    If &apos;delete_existing&apos; is specified and the file already\n    exists, it will be deleted before saving.\n    &quot;&quot;&quot;\n    if delete_existing and os.path.exists(filename):\n      os.remove(filename)\n    self.app.ActiveWorkbook.SaveAs(filename)\n  def print_out(self):\n    &quot;&quot;&quot;\n    Print the active workbook.\n    &quot;&quot;&quot;\n    self.app.Application.PrintOut()\n  def close(self):\n    &quot;&quot;&quot;\n    Close the active workbook.\n    &quot;&quot;&quot;\n    self.app.ActiveWorkbook.Close()\n  def quit(self):\n    &quot;&quot;&quot;\n    Quit Excel.\n    &quot;&quot;&quot;\n    return self.app.Quit()</code></pre><h3 id=\"基本使用方法\"><a href=\"#基本使用方法\" class=\"headerlink\" title=\"基本使用方法\"></a>基本使用方法</h3><pre><code># -*- encoding: utf8 -*-\n\n# 配置项\nimport os\nimport shutil\nimport re\nimport time\nimport win32com\nfrom win32com.client import constants\nimport xlrd\nXlsFile = &apos;default.xls&apos;                  # 需要的数据\nOldStrs = [&apos;#CatalogNumber#&apos;,\n           &apos;#ProductName#&apos;,\n           &apos;#OSpecies#&apos;,\n           &apos;#Short#&apos;,\n           &apos;#Organism#&apos;,\n           &apos;#Fragment#&apos;,\n           &apos;#PROTEIN#&apos;,\n           &apos;#Tag#&apos;\n           ]\n\n# 确认模板类型\nDefaultFile = raw_input(&apos;Want to use ihc.jpg,input \\&apos;Y\\&apos;,or input \\&apos;N\\&apos;:\\n&apos;)\nif DefaultFile == &apos;N&apos;:\n    DocFile = os.path.abspath(&apos;default_noihc.doc&apos;)\n    print DocFile\nelif DefaultFile == &apos;Y&apos;:\n    DocFile = os.path.abspath(&apos;default.doc&apos;)\n    print DocFile\nelse:\n    raise\nfilepath = &apos;D:/Py/CreateAntibodyWord/NewFile&apos;    # 生成文件目录\n\n\n# 获取括号内容的正则表达式\npatt = re.compile(r&quot;\\((.*?)\\)&quot;, re.I | re.X)\n\n# 打开初始化word文档\nw = win32com.client.Dispatch(&apos;Word.Application&apos;)\nw.Visible = 0\nw.DisplayAlerts = 0\n\n# 从excel表格中导入数据\n\ndata = xlrd.open_workbook(XlsFile) \ntable = data.sheets()[0]\nnrows = table.nrows\n\n# 循环表格中的内容\nfor i in range(1, nrows):\n    try:\n        # 获取新的数据\n        CatalogNumber = table.row_values(i)[0]\n        ProductName = table.row_values(i)[1]\n        OrganismSpecies = table.row_values(i)[2]\n        Tag = table.row_values(i)[3]\n        Fragment = table.row_values(i)[4]\n        Short = patt.findall(ProductName)[0]\n        # 获取对应蛋白的货号\n        ProteinNumber = re.sub(r&apos;^PA&apos;, r&apos;RP&apos;, CatalogNumber)\n        # Ge多物种没有缩写，用General替代\n        Organism = patt.findall(OrganismSpecies)\n        if len(Organism) &gt; 0:\n            Organism = Organism[0]\n        else:\n            Organism = &apos;General&apos;\n        # 没有氨基酸片段信息的用原始值替代\n        Fragment = patt.findall(Fragment)\n        if len(Fragment) &gt; 0:\n            Fragment = Fragment[0]\n        else:\n            Fragment = &apos;#Fragment#&apos;\n        NewStrs = [CatalogNumber,\n                   ProductName,\n                   OrganismSpecies,\n                   Short,\n                   Organism,\n                   Fragment,\n                   ProteinNumber,\n                   Tag\n                   ]\n\n        # 打开复制的文件\n        NewFileName = CatalogNumber + &apos;-e.doc&apos;                                        # 命名新的文件\n        shutil.copyfile(DocFile, filepath + &apos;/&apos; + NewFileName)                        # 复制新的文件\n        CopyFile = os.path.abspath(filepath + &apos;/&apos; + NewFileName)                      # 新的文件目录\n        doc = w.Documents.Open(FileName=CopyFile)                                     # 打开文件\n\n        # 文本框处理\n        canvas = doc.Shapes[2]\n        canvas.TextFrame.TextRange.Find.Execute(OldStrs[3], False, False, False, False, False, True, 1, True, NewStrs[3], 2)\n        canvas.TextFrame.TextRange.Find.Execute(OldStrs[4], False, False, False, False, False, True, 1, True, NewStrs[4], 2)\n\n        # 正文文字处理\n        w.Selection.Find.ClearFormatting()\n        w.Selection.Find.Replacement.ClearFormatting()\n        for j in range(len(NewStrs)):\n            w.Selection.Find.Execute(OldStrs[j], False, False, False, False, False, True, 1, True, NewStrs[j], 2)\n\n        # 获取属性信息并修改,参考https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.builtindocumentproperties(v=vs.120).aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-1\n        doc.BuiltInDocumentProperties(&apos;Title&apos;).Value = ProductName\n        doc.BuiltInDocumentProperties(&apos;Subject&apos;).Value = &apos;Instruction manual (Catalog No.&apos; + CatalogNumber + &apos;)&apos;\n        doc.BuiltInDocumentProperties(&apos;Keywords&apos;).Value = ProductName\n        doc.BuiltInDocumentProperties(&apos;Category&apos;).Value = OrganismSpecies\n\n        # 保存文件并关闭\n        doc.Save()\n        doc.Close()\n        print CatalogNumber + &apos; create word success!&apos;\n\n    # 捕获异常并写入log文件中\n    except Exception, e:\n        print CatalogNumber + &apos; create word error!&apos;\n        print e\n        errorfile = open(filepath + &apos;/errorlog.txt&apos;, &apos;a&apos;)\n        try:\n            errorfile.write(CatalogNumber + &apos; create word error! &apos; + time.strftime(&apos;%Y-%m-%d %H:%M:%S&apos;) + &apos;\\n&apos;)\n        except Exception, e:\n            doc.Close()\n            w.Quit()\n            raise e\n        finally:\n            errorfile.close()\nw.Quit()        </code></pre><h3 id=\"替换Word文档属性里的详细信息\"><a href=\"#替换Word文档属性里的详细信息\" class=\"headerlink\" title=\"替换Word文档属性里的详细信息\"></a>替换Word文档属性里的详细信息</h3><pre><code>doc.BuiltInDocumentProperties(&apos;Title&apos;).Value = ProductName\ndoc.BuiltInDocumentProperties(&apos;Subject&apos;).Value = &apos;Instruction manual (Catalog No.&apos; + CatalogNumber + &apos;)&apos;\ndoc.BuiltInDocumentProperties(&apos;Keywords&apos;).Value = ProductName\ndoc.BuiltInDocumentProperties(&apos;Category&apos;).Value = Ospecies</code></pre><p>参考<a href=\"http://stackoverflow.com/questions/3022898/python-win32com-automating-word-how-to-replace-text-in-a-text-box\" target=\"_blank\" rel=\"noopener\">微软官方说明</a></p>\n<h3 id=\"替换Word长文本\"><a href=\"#替换Word长文本\" class=\"headerlink\" title=\"替换Word长文本\"></a>替换Word长文本</h3><p>使用以下语句替换长文本会报错”字符串过长”</p>\n<pre><code>w.Selection.Find.Execute(OldStrs[j], False, False, False, False, False, True, 1, True, NewStrs[j], 2)</code></pre><p>使用以下语句</p>\n<pre><code>find = w.Selection.Find\nfind.Text = &apos;#SEQUENCE#&apos;\nwhile w.Selection.Find.Execute():\n    w.Selection.TypeText(Text=SEQUENCE)</code></pre><h3 id=\"替换Word文本框内容\"><a href=\"#替换Word文本框内容\" class=\"headerlink\" title=\"替换Word文本框内容\"></a>替换Word文本框内容</h3><p>参考以下代码 <a href=\"http://stackoverflow.com/questions/3022898/python-win32com-automating-word-how-to-replace-text-in-a-text-box\" target=\"_blank\" rel=\"noopener\">http://stackoverflow.com/</a></p>\n<pre><code>import win32com.client\n\nword = win32com.client.Dispatch(&quot;Word.Application&quot;)\ncanvas = word.ActiveDocument.Shapes[0]\nfor item in canvas.CanvasItems:\n    print item.TextFrame.TextRange.Text</code></pre><p>或者</p>\n<pre><code>find = shp.TextFrame.TextRange.Find\nfind.Text = source\nfind.Replacement.Text = target\nfind.Execute(Replace=1, Forward=True)</code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"老外的代码\"><a href=\"#老外的代码\" class=\"headerlink\" title=\"老外的代码\"></a>老外的代码</h3><p>第一个是操作word，第二个是操作excel</p>\n<pre><code>from win32com.client import constants, Dispatch\nimport pythoncom\nwdStory = 6\nclass WordDocument(object):\n  &quot;&quot;&quot;\n  Some convenience methods for Word documents accessed\n  through COM.\n  &quot;&quot;&quot;\n\n  def __init__(self, visible=False):\n    self.app = Dispatch(&quot;Word.Application&quot;)\n    self.app.Visible = visible\n\n  def new(self, filename=None):\n    &quot;&quot;&quot;\n    Create a new Word document. If &apos;filename&apos; specified,\n    use the file as a template.\n    &quot;&quot;&quot;\n    self.app.Documents.Add(filename)\n\n  def open(self, filename):\n    &quot;&quot;&quot;\n    Open an existing Word document for editing.\n    &quot;&quot;&quot;\n    self.app.Documents.Open(filename)\n\n  def save(self, filename=None):\n    &quot;&quot;&quot;\n    Save the active document. If &apos;filename&apos; is given,\n    do a Save As.\n    &quot;&quot;&quot;\n    if filename:\n      self.app.ActiveDocument.SaveAs(filename)\n    else:\n      self.app.ActiveDocument.Save()\n\n  def save_as(self, filename):\n    return self.save(filename)\n\n  def print_out(self):\n    &quot;&quot;&quot;\n    Print the active document.\n    &quot;&quot;&quot;\n    self.app.Application.PrintOut()\n\n  def close(self):\n    &quot;&quot;&quot;\n    Close the active document.\n    &quot;&quot;&quot;\n    self.app.ActiveDocument.Close()\n\n  def quit(self):\n    &quot;&quot;&quot;\n    Quit Word.\n    &quot;&quot;&quot;\n    return self.app.Quit()\n\n  def find_and_replace(self, find_str, replace_str):\n    &quot;&quot;&quot;\n    Find all occurances of &apos;find_str&apos; and replace with &apos;replace_str&apos;\n    in the active document.\n    &quot;&quot;&quot;\n    self.app.Selection.HomeKey(Unit=wdStory)\n    find = self.app.Selection.Find\n    find.Text = find_str\n    while self.app.Selection.Find.Execute():\n      self.app.Selection.TypeText(Text=replace_str)\n\n\nfrom win32com.client import constants, Dispatch\nimport pythoncom\nimport os\nborderTop = 3\nborderBottom = 4\nborderLeft = 1\nborderRight = 2\nborderSolid = 1\nborderDashed = 2\nborderDotted = 3\ncolorBlack = 1\ndirectionUp = -4162\ndirectionDown = -4121\ndirectionLeft = -4131\ndirectionRight = -4152\nclass ExcelDocument(object):\n  &quot;&quot;&quot;\n  Some convenience methods for Excel documents accessed\n  through COM.\n  &quot;&quot;&quot;\n  def __init__(self, visible=False):\n    self.app = Dispatch(&quot;Excel.Application&quot;)\n    self.app.Visible = visible\n    self.sheet = 1\n  def new(self, filename=None):\n    &quot;&quot;&quot;\n    Create a new Excel workbook. If &apos;filename&apos; specified,\n    use the file as a template.\n    &quot;&quot;&quot;\n    self.app.Workbooks.Add(filename)\n  def open(self, filename):\n    &quot;&quot;&quot;\n    Open an existing Excel workbook for editing.\n    &quot;&quot;&quot;\n    self.app.Workbooks.Open(filename)\n  def set_sheet(self, sheet):\n    &quot;&quot;&quot;\n    Set the active worksheet.\n    &quot;&quot;&quot;\n    self.sheet = sheet\n  def get_range(self, range):\n    &quot;&quot;&quot;\n    Get a range object for the specified range or single cell.\n    &quot;&quot;&quot;\n    return self.app.ActiveWorkbook.Sheets(self.sheet).Range(range)\n  def set_value(self, cell, value=&apos;&apos;):\n    &quot;&quot;&quot;\n    Set the value of &apos;cell&apos; to &apos;value&apos;.\n    &quot;&quot;&quot;\n    self.get_range(cell).Value = value\n  def get_value(self, cell):\n    &quot;&quot;&quot;\n    Get the value of &apos;cell&apos;.\n    &quot;&quot;&quot;\n    value = self.get_range(cell).Value\n    if isinstance(value, tuple):\n      value = [v[0] for v in value]\n    return value\n  def set_border(self, range, side, line_style=borderSolid, color=colorBlack):\n    &quot;&quot;&quot;\n    Set a border on the specified range of cells or single cell.\n    &apos;range&apos; = range of cells or single cell\n    &apos;side&apos; = one of borderTop, borderBottom, borderLeft, borderRight\n    &apos;line_style&apos; = one of borderSolid, borderDashed, borderDotted, others?\n    &apos;color&apos; = one of colorBlack, others?\n    &quot;&quot;&quot;\n    range = self.get_range(range).Borders(side)\n    range.LineStyle = line_style\n    range.Color = color\n  def sort(self, range, key_cell):\n    &quot;&quot;&quot;\n    Sort the specified &apos;range&apos; of the activeworksheet by the\n    specified &apos;key_cell&apos;.\n    &quot;&quot;&quot;\n    range.Sort(Key1=self.get_range(key_cell), Order1=1, Header=0, OrderCustom=1, MatchCase=False, Orientation=1)\n  def hide_row(self, row, hide=True):\n    &quot;&quot;&quot;\n    Hide the specified &apos;row&apos;.\n    Specify hide=False to show the row.\n    &quot;&quot;&quot;\n    self.get_range(&apos;a%s&apos; % row).EntireRow.Hidden = hide\n  def hide_column(self, column, hide=True):\n    &quot;&quot;&quot;\n    Hide the specified &apos;column&apos;.\n    Specify hide=False to show the column.\n    &quot;&quot;&quot;\n    self.get_range(&apos;%s1&apos; % column).EntireColumn.Hidden = hide\n  def delete_row(self, row, shift=directionUp):\n    &quot;&quot;&quot;\n    Delete the entire &apos;row&apos;.\n    &quot;&quot;&quot;\n    self.get_range(&apos;a%s&apos; % row).EntireRow.Delete(Shift=shift)\n  def delete_column(self, column, shift=directionLeft):\n    &quot;&quot;&quot;\n    Delete the entire &apos;column&apos;.\n    &quot;&quot;&quot;\n    self.get_range(&apos;%s1&apos; % column).EntireColumn.Delete(Shift=shift)\n  def fit_column(self, column):\n    &quot;&quot;&quot;\n    Resize the specified &apos;column&apos; to fit all its contents.\n    &quot;&quot;&quot;\n    self.get_range(&apos;%s1&apos; % column).EntireColumn.AutoFit()\n  def save(self):\n    &quot;&quot;&quot;\n    Save the active workbook.\n    &quot;&quot;&quot;\n    self.app.ActiveWorkbook.Save()\n  def save_as(self, filename, delete_existing=False):\n    &quot;&quot;&quot;\n    Save the active workbook as a different filename.\n    If &apos;delete_existing&apos; is specified and the file already\n    exists, it will be deleted before saving.\n    &quot;&quot;&quot;\n    if delete_existing and os.path.exists(filename):\n      os.remove(filename)\n    self.app.ActiveWorkbook.SaveAs(filename)\n  def print_out(self):\n    &quot;&quot;&quot;\n    Print the active workbook.\n    &quot;&quot;&quot;\n    self.app.Application.PrintOut()\n  def close(self):\n    &quot;&quot;&quot;\n    Close the active workbook.\n    &quot;&quot;&quot;\n    self.app.ActiveWorkbook.Close()\n  def quit(self):\n    &quot;&quot;&quot;\n    Quit Excel.\n    &quot;&quot;&quot;\n    return self.app.Quit()</code></pre><h3 id=\"基本使用方法\"><a href=\"#基本使用方法\" class=\"headerlink\" title=\"基本使用方法\"></a>基本使用方法</h3><pre><code># -*- encoding: utf8 -*-\n\n# 配置项\nimport os\nimport shutil\nimport re\nimport time\nimport win32com\nfrom win32com.client import constants\nimport xlrd\nXlsFile = &apos;default.xls&apos;                  # 需要的数据\nOldStrs = [&apos;#CatalogNumber#&apos;,\n           &apos;#ProductName#&apos;,\n           &apos;#OSpecies#&apos;,\n           &apos;#Short#&apos;,\n           &apos;#Organism#&apos;,\n           &apos;#Fragment#&apos;,\n           &apos;#PROTEIN#&apos;,\n           &apos;#Tag#&apos;\n           ]\n\n# 确认模板类型\nDefaultFile = raw_input(&apos;Want to use ihc.jpg,input \\&apos;Y\\&apos;,or input \\&apos;N\\&apos;:\\n&apos;)\nif DefaultFile == &apos;N&apos;:\n    DocFile = os.path.abspath(&apos;default_noihc.doc&apos;)\n    print DocFile\nelif DefaultFile == &apos;Y&apos;:\n    DocFile = os.path.abspath(&apos;default.doc&apos;)\n    print DocFile\nelse:\n    raise\nfilepath = &apos;D:/Py/CreateAntibodyWord/NewFile&apos;    # 生成文件目录\n\n\n# 获取括号内容的正则表达式\npatt = re.compile(r&quot;\\((.*?)\\)&quot;, re.I | re.X)\n\n# 打开初始化word文档\nw = win32com.client.Dispatch(&apos;Word.Application&apos;)\nw.Visible = 0\nw.DisplayAlerts = 0\n\n# 从excel表格中导入数据\n\ndata = xlrd.open_workbook(XlsFile) \ntable = data.sheets()[0]\nnrows = table.nrows\n\n# 循环表格中的内容\nfor i in range(1, nrows):\n    try:\n        # 获取新的数据\n        CatalogNumber = table.row_values(i)[0]\n        ProductName = table.row_values(i)[1]\n        OrganismSpecies = table.row_values(i)[2]\n        Tag = table.row_values(i)[3]\n        Fragment = table.row_values(i)[4]\n        Short = patt.findall(ProductName)[0]\n        # 获取对应蛋白的货号\n        ProteinNumber = re.sub(r&apos;^PA&apos;, r&apos;RP&apos;, CatalogNumber)\n        # Ge多物种没有缩写，用General替代\n        Organism = patt.findall(OrganismSpecies)\n        if len(Organism) &gt; 0:\n            Organism = Organism[0]\n        else:\n            Organism = &apos;General&apos;\n        # 没有氨基酸片段信息的用原始值替代\n        Fragment = patt.findall(Fragment)\n        if len(Fragment) &gt; 0:\n            Fragment = Fragment[0]\n        else:\n            Fragment = &apos;#Fragment#&apos;\n        NewStrs = [CatalogNumber,\n                   ProductName,\n                   OrganismSpecies,\n                   Short,\n                   Organism,\n                   Fragment,\n                   ProteinNumber,\n                   Tag\n                   ]\n\n        # 打开复制的文件\n        NewFileName = CatalogNumber + &apos;-e.doc&apos;                                        # 命名新的文件\n        shutil.copyfile(DocFile, filepath + &apos;/&apos; + NewFileName)                        # 复制新的文件\n        CopyFile = os.path.abspath(filepath + &apos;/&apos; + NewFileName)                      # 新的文件目录\n        doc = w.Documents.Open(FileName=CopyFile)                                     # 打开文件\n\n        # 文本框处理\n        canvas = doc.Shapes[2]\n        canvas.TextFrame.TextRange.Find.Execute(OldStrs[3], False, False, False, False, False, True, 1, True, NewStrs[3], 2)\n        canvas.TextFrame.TextRange.Find.Execute(OldStrs[4], False, False, False, False, False, True, 1, True, NewStrs[4], 2)\n\n        # 正文文字处理\n        w.Selection.Find.ClearFormatting()\n        w.Selection.Find.Replacement.ClearFormatting()\n        for j in range(len(NewStrs)):\n            w.Selection.Find.Execute(OldStrs[j], False, False, False, False, False, True, 1, True, NewStrs[j], 2)\n\n        # 获取属性信息并修改,参考https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.builtindocumentproperties(v=vs.120).aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-1\n        doc.BuiltInDocumentProperties(&apos;Title&apos;).Value = ProductName\n        doc.BuiltInDocumentProperties(&apos;Subject&apos;).Value = &apos;Instruction manual (Catalog No.&apos; + CatalogNumber + &apos;)&apos;\n        doc.BuiltInDocumentProperties(&apos;Keywords&apos;).Value = ProductName\n        doc.BuiltInDocumentProperties(&apos;Category&apos;).Value = OrganismSpecies\n\n        # 保存文件并关闭\n        doc.Save()\n        doc.Close()\n        print CatalogNumber + &apos; create word success!&apos;\n\n    # 捕获异常并写入log文件中\n    except Exception, e:\n        print CatalogNumber + &apos; create word error!&apos;\n        print e\n        errorfile = open(filepath + &apos;/errorlog.txt&apos;, &apos;a&apos;)\n        try:\n            errorfile.write(CatalogNumber + &apos; create word error! &apos; + time.strftime(&apos;%Y-%m-%d %H:%M:%S&apos;) + &apos;\\n&apos;)\n        except Exception, e:\n            doc.Close()\n            w.Quit()\n            raise e\n        finally:\n            errorfile.close()\nw.Quit()        </code></pre><h3 id=\"替换Word文档属性里的详细信息\"><a href=\"#替换Word文档属性里的详细信息\" class=\"headerlink\" title=\"替换Word文档属性里的详细信息\"></a>替换Word文档属性里的详细信息</h3><pre><code>doc.BuiltInDocumentProperties(&apos;Title&apos;).Value = ProductName\ndoc.BuiltInDocumentProperties(&apos;Subject&apos;).Value = &apos;Instruction manual (Catalog No.&apos; + CatalogNumber + &apos;)&apos;\ndoc.BuiltInDocumentProperties(&apos;Keywords&apos;).Value = ProductName\ndoc.BuiltInDocumentProperties(&apos;Category&apos;).Value = Ospecies</code></pre><p>参考<a href=\"http://stackoverflow.com/questions/3022898/python-win32com-automating-word-how-to-replace-text-in-a-text-box\" target=\"_blank\" rel=\"noopener\">微软官方说明</a></p>\n<h3 id=\"替换Word长文本\"><a href=\"#替换Word长文本\" class=\"headerlink\" title=\"替换Word长文本\"></a>替换Word长文本</h3><p>使用以下语句替换长文本会报错”字符串过长”</p>\n<pre><code>w.Selection.Find.Execute(OldStrs[j], False, False, False, False, False, True, 1, True, NewStrs[j], 2)</code></pre><p>使用以下语句</p>\n<pre><code>find = w.Selection.Find\nfind.Text = &apos;#SEQUENCE#&apos;\nwhile w.Selection.Find.Execute():\n    w.Selection.TypeText(Text=SEQUENCE)</code></pre><h3 id=\"替换Word文本框内容\"><a href=\"#替换Word文本框内容\" class=\"headerlink\" title=\"替换Word文本框内容\"></a>替换Word文本框内容</h3><p>参考以下代码 <a href=\"http://stackoverflow.com/questions/3022898/python-win32com-automating-word-how-to-replace-text-in-a-text-box\" target=\"_blank\" rel=\"noopener\">http://stackoverflow.com/</a></p>\n<pre><code>import win32com.client\n\nword = win32com.client.Dispatch(&quot;Word.Application&quot;)\ncanvas = word.ActiveDocument.Shapes[0]\nfor item in canvas.CanvasItems:\n    print item.TextFrame.TextRange.Text</code></pre><p>或者</p>\n<pre><code>find = shp.TextFrame.TextRange.Find\nfind.Text = source\nfind.Replacement.Text = target\nfind.Execute(Replace=1, Forward=True)</code></pre>"},{"title":"selenium入门基础","url":"115.html","id":"115","comments":0,"date":"2016-11-30T01:37:47.000Z","_content":"\n#### 安装及基本操作\n\n    # -*- coding:utf-8 -*-\n    # 环境: ubuntu14.04\n    # pip install seleninum\n    # firefox\n    # https://github.com/mozilla/geckodriver/releases 下载对应版本放在$PATH目录下\n    # google\n    # https://sites.google.com/a/chromium.org/chromedriver/downloads 下载对应版本放在$PATH目录下\n    # http://www.seleniumhq.org/download/    其他浏览器参考\n    # sudo apt-get install phantomjs  安装无界面webkit浏览器引擎\n    from selenium import webdriver\n    from selenium.webdriver.common.by import By\n    \n    driver = webdriver.Firefox()\n    # driver = webdriver.Chrome()\n    # driver =  webdriver.PhantomJS(executable_path='/usr/bin/phantomjs')\n    driver.get('http://www.baidu.com')\n    \n    # 定位元素\n    # 根据id定位\n    find_id = driver.find_element_by_id('wrapper')\n    find_id = driver.find_element(By.ID, 'wrapper')\n    # 根据name属性定位\n    find_name = driver.find_element_by_name('wd')\n    find_name = driver.find_element(By.NAME, 'wd')\n    # 根据class定位\n    find_class = driver.find_element_by_class_name('head_wrapper')\n    find_class = driver.find_element(By.CLASS_NAME, 'head_wrapper')\n    # 根据标签名称定位\n    find_tag = driver.find_element_by_tag_name('div')\n    find_tag = driver.find_element(By.TAG_NAME, 'div')\n    # 根据链接文本定位\n    find_a_text = driver.find_element_by_link_text('hao123')\n    find_a_text = driver.find_element(By.LINK_TEXT, 'hao123')\n    # 根据部分链接文本定位\n    find_a_text = driver.find_element_by_partial_link_text('hao')\n    find_a_text = driver.find_element(By.PARTIAL_LINK_TEXT, 'hao')\n    # 根据绝对位置定位\n    find_x_path = driver.find_elements_by_xpath('/html/body/div')\n    find_x_path = driver.find_element(By.XPATH, '/html/body/div')\n    # 支持层级，属性，逻辑运算符结合使用\n    find_x_path = driver.find_element_by_xpath(\"//input[@id='kw']\")  # // 当前目录下的某个目录下\n    # Css定位\n    find_css = driver.find_elements_by_css_selector('.s_ipt')\n    find_css = driver.find_element(By.CSS_SELECTOR, '.s_ipt')\n    \n    # 设置浏览器宽高\n    driver.set_window_size(480, 800)\n    driver.get('http://www.126.com')\n    # 控制浏览器前进倒退\n    driver.back()\n    driver.forward()\n    # 刷新浏览器(F5)\n    driver.refresh()\n    # 当前页面\n    print driver.current_url()\n    # 元素操作\n    # dom = driver.find_element(By.ID, 'kw')\n    # dom.clear()  # 清除文本\n    # dom.send_keys()  # 模拟键盘输入\n    # dom.click()  # 点击元素\n    # dom.submit()  # 模拟表单提交\n    # dom.size()  # 返回元素的尺寸\n    # dom.text()  # 返回元素的文本\n    # dom.get_attribute(name)  # 返回元素的属性值\n    # dom.is_displayed()  # 设置该元素是否可见\n    \n    # 鼠标操作\n    from selenium.webdriver.common.action_chains import ActionChains\n    driver.get('http://www.baidu.com')\n    # context_click 鼠标右键点击\n    right_click = driver.find_element_by_id('xx')\n    # perform 执行所有ActionChains中存储的动作\n    ActionChains(driver).context_click(right_click).perform()\n    # above 鼠标悬停\n    above = driver.find_element_by_id('xxx')\n    ActionChains(driver).move_to_element(above).perform()\n    # double_click 鼠标双击\n    # drag_and_drop(source, target) 鼠标拖放\n    \n    \n    # 键盘事件\n    from selenium.webdriver.common.keys import Keys\n    find_id.send_keys(Keys.BACK_SPACE) # 删除键\n    find_id.send_keys(Keys.SPACE)  # 空格键\n    find_id.send_keys(Keys.TAB)  # tab键\n    find_id.send_keys(Keys.ESCAPE)  # ESC\n    find_id.send_keys(Keys.ENTER)  # 回车键\n    find_id.send_keys(Keys.CONTROL, 'c')  # 复制\n    find_id.send_keys(Keys.CONTROL, 'v')  # 剪贴\n    find_id.send_keys(Keys.F1) # F1\n    \n    # driver.quit()\n    \n    \n\n#### webdriver原理\n\n    # -*- coding:utf-8 -*-\n    from selenium import webdriver\n    import logging\n    \n    logging.basicConfig(level=logging.DEBUG)\n    driver = webdriver.Firefox()\n    driver.get('http://www.baidu.com')\n    driver.find_element_by_id('kw').send_keys('selenium')\n    driver.find_element_by_id('su').click()\n    driver.quit()\n    \n\n#### 显示等待\n\n    # -*- coding:utf-8 -*-\n    # 显示等待\n    from selenium import webdriver\n    from selenium.webdriver.common.by import By\n    from selenium.webdriver.support.ui import WebDriverWait\n    from selenium.webdriver.support import expected_conditions as EC\n    \n    driver = webdriver.Firefox()\n    driver.get('http://www.baidu.com')\n    # 显示等待\n    # 参数driver： 浏览器驱动\n    # 参数timeout： 最大超时时间，单位秒\n    # 参数poll_frequency： 检测的间隔时间，默认为0.5秒\n    # 参数ignored_exceptions: 超时异常信息，默认为NoSuchElementException\n    # WebDriverWait(driver, timeout, poll_frequency=0.5, ignored_exceptions=None)\n    # until(method, message='') 调用该方法提供的驱动程序作为参数，直到返回True\n    # until_not(method, message='') 调用该方法提供的驱动程序作为参数，直到返回False\n    # EC.title_is 判断当前页面的标题是否是否等于预期\n    # EC.title_contains 判断当前页面的标题是否包含预期的字符串\n    # EC.presence_of_element_located 判断元素是否被加载在DOM树中，并不代表当前元素可见\n    # EC.visibility_of_element_located 判断元素是否可见（可见并非代表元素非隐藏，并且元素的宽和高均不等于0）\n    # EC.visibility_of 与visibility_of_element_located相同，该方法接受的参数为定位后的元素\n    # EC.presence_of_all_elements_located 判断是否至少有一个元素存在与DOM树中\n    # EC.text_to_be_present_in_element 判断某个元素的text是否包含预期的字符串\n    # EC.text_to_be_present_in_element_value 判断某个元素的vaule属性是否包含了预期的字符串\n    # EC.frame_to_be_available_and_switch_to_it 判断该表单是否可以切换进去，如果可以，返回True并switch进去，否则返回false\n    # EC.invisibility_of_element_located 判断某个元素是否不存在于DOM树中或者不可见\n    # EC.element_to_be_clickable 判断某个元素是否可以点击\n    # EC.staleness_of 等到一个元素从DOM树中移除\n    # EC.element_to_be_selected 判断某个元素是否被选中，一般用于下拉菜单\n    # EC.element_selection_state_to_be 判断某个元素的选中状态是否符合预期, 参数为定位后的元素\n    # EC.element_located_selection_state_to_be 判断某个元素的选中状态是否符合预期,该方法接受的参数为定位\n    # EC.alert_is_present 判断页面上是否有alert\n    # driver.find_element_by_id().is_displayed() 判断元素是否可见\n    element = WebDriverWait(driver, 5, 0.5).until(EC.presence_of_element_located((By.ID, 'kw')))\n    element.send_keys('selenium')\n    # driver.quit()\n    \n    \n\n#### 隐式等待\n\n    # -*- coding:utf-8 -*-\n    # 隐式等待\n    from selenium import webdriver\n    from selenium.common.exceptions import NoSuchElementException\n    from time import ctime\n    from time import sleep\n    driver = webdriver.Firefox()\n    # sleep(10)\n    driver.implicitly_wait(10)\n    driver.get('http://www.baidu.com')\n    print ctime()\n    try:\n        driver.find_element_by_id('kw22').send_keys('selenium')\n    except NoSuchElementException as e:\n        print e\n    finally:\n        print ctime()\n    \n\n#### 执行js代码\n\n    # -*- coding:utf-8 -*-\n    # 执行js代码\n    from selenium import webdriver\n    from time import sleep\n    \n    # 访问百度\n    driver = webdriver.Firefox()\n    driver.get('http://www.baidu.com')\n    driver.set_window_size(600, 600)\n    driver.find_element_by_id('kw').send_keys('selenium')\n    driver.find_element_by_id('su').click()\n    sleep(2)\n    \n    js = 'window.scrollTo(100, 450);'\n    driver.execute_script(js)\n    sleep(3)\n    \n    # driver.quit()\n    \n\n#### 处理cookie\n\n    # -*- coding:utf-8 -*-\n    # cookie处理\n    from selenium import webdriver\n    driver = webdriver.Firefox()\n    driver.get('http://www.youdao.com')\n    driver.add_cookie({'name': 'name-a', 'value': 'value-b'})\n    # 获取cookie信息\n    cookies = driver.get_cookies()\n    print cookies\n    for cookie in cookies:\n        print cookie\n        print '{} -> {}'.format(cookie['name'], cookie['value'])\n    driver.quit()\n    \n\n#### 截图\n\n    # -*- coding:utf-8 -*-\n    # 窗口截图\n    from selenium import webdriver\n    from time import sleep\n    \n    # driver = webdriver.Firefox()\n    driver =  webdriver.PhantomJS(executable_path='/usr/bin/phantomjs')\n    driver.get('http://www.baidu.com')\n    \n    driver.find_element_by_id('kw').send_keys('selenium')\n    driver.find_element_by_id('su').click()\n    sleep(2)\n    \n    driver.get_screenshot_as_file('./screen.png')\n    driver.quit()\n    \n\n#### 播放视频\n\n    # -*- coding:utf-8 -*-\n    from selenium import webdriver\n    from time import sleep\n    \n    driver = webdriver.Firefox()\n    driver.get('http://videojs.com')\n    \n    video = driver.find_element_by_xpath('body/Setion[1]/div/video')\n    # 返回播放文件地址\n    url = driver.execute_script('return arguments[0].currentSrc;', video)\n    print url\n    \n    # 播放视频\n    print 'start'\n    driver.execute_script('return arguments[0].play()', video)\n    \n    # 播放15秒\n    sleep(15)\n    \n    # 暂停播放\n    print 'stop'\n    driver.execute_script('arguments[0].pause()', video)\n    \n    # driver.quit()","source":"_posts/selenium入门基础.md","raw":"---\ntitle: selenium入门基础\ntags:\n  - python\nurl: 115.html\nid: 115\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-30 09:37:47\n---\n\n#### 安装及基本操作\n\n    # -*- coding:utf-8 -*-\n    # 环境: ubuntu14.04\n    # pip install seleninum\n    # firefox\n    # https://github.com/mozilla/geckodriver/releases 下载对应版本放在$PATH目录下\n    # google\n    # https://sites.google.com/a/chromium.org/chromedriver/downloads 下载对应版本放在$PATH目录下\n    # http://www.seleniumhq.org/download/    其他浏览器参考\n    # sudo apt-get install phantomjs  安装无界面webkit浏览器引擎\n    from selenium import webdriver\n    from selenium.webdriver.common.by import By\n    \n    driver = webdriver.Firefox()\n    # driver = webdriver.Chrome()\n    # driver =  webdriver.PhantomJS(executable_path='/usr/bin/phantomjs')\n    driver.get('http://www.baidu.com')\n    \n    # 定位元素\n    # 根据id定位\n    find_id = driver.find_element_by_id('wrapper')\n    find_id = driver.find_element(By.ID, 'wrapper')\n    # 根据name属性定位\n    find_name = driver.find_element_by_name('wd')\n    find_name = driver.find_element(By.NAME, 'wd')\n    # 根据class定位\n    find_class = driver.find_element_by_class_name('head_wrapper')\n    find_class = driver.find_element(By.CLASS_NAME, 'head_wrapper')\n    # 根据标签名称定位\n    find_tag = driver.find_element_by_tag_name('div')\n    find_tag = driver.find_element(By.TAG_NAME, 'div')\n    # 根据链接文本定位\n    find_a_text = driver.find_element_by_link_text('hao123')\n    find_a_text = driver.find_element(By.LINK_TEXT, 'hao123')\n    # 根据部分链接文本定位\n    find_a_text = driver.find_element_by_partial_link_text('hao')\n    find_a_text = driver.find_element(By.PARTIAL_LINK_TEXT, 'hao')\n    # 根据绝对位置定位\n    find_x_path = driver.find_elements_by_xpath('/html/body/div')\n    find_x_path = driver.find_element(By.XPATH, '/html/body/div')\n    # 支持层级，属性，逻辑运算符结合使用\n    find_x_path = driver.find_element_by_xpath(\"//input[@id='kw']\")  # // 当前目录下的某个目录下\n    # Css定位\n    find_css = driver.find_elements_by_css_selector('.s_ipt')\n    find_css = driver.find_element(By.CSS_SELECTOR, '.s_ipt')\n    \n    # 设置浏览器宽高\n    driver.set_window_size(480, 800)\n    driver.get('http://www.126.com')\n    # 控制浏览器前进倒退\n    driver.back()\n    driver.forward()\n    # 刷新浏览器(F5)\n    driver.refresh()\n    # 当前页面\n    print driver.current_url()\n    # 元素操作\n    # dom = driver.find_element(By.ID, 'kw')\n    # dom.clear()  # 清除文本\n    # dom.send_keys()  # 模拟键盘输入\n    # dom.click()  # 点击元素\n    # dom.submit()  # 模拟表单提交\n    # dom.size()  # 返回元素的尺寸\n    # dom.text()  # 返回元素的文本\n    # dom.get_attribute(name)  # 返回元素的属性值\n    # dom.is_displayed()  # 设置该元素是否可见\n    \n    # 鼠标操作\n    from selenium.webdriver.common.action_chains import ActionChains\n    driver.get('http://www.baidu.com')\n    # context_click 鼠标右键点击\n    right_click = driver.find_element_by_id('xx')\n    # perform 执行所有ActionChains中存储的动作\n    ActionChains(driver).context_click(right_click).perform()\n    # above 鼠标悬停\n    above = driver.find_element_by_id('xxx')\n    ActionChains(driver).move_to_element(above).perform()\n    # double_click 鼠标双击\n    # drag_and_drop(source, target) 鼠标拖放\n    \n    \n    # 键盘事件\n    from selenium.webdriver.common.keys import Keys\n    find_id.send_keys(Keys.BACK_SPACE) # 删除键\n    find_id.send_keys(Keys.SPACE)  # 空格键\n    find_id.send_keys(Keys.TAB)  # tab键\n    find_id.send_keys(Keys.ESCAPE)  # ESC\n    find_id.send_keys(Keys.ENTER)  # 回车键\n    find_id.send_keys(Keys.CONTROL, 'c')  # 复制\n    find_id.send_keys(Keys.CONTROL, 'v')  # 剪贴\n    find_id.send_keys(Keys.F1) # F1\n    \n    # driver.quit()\n    \n    \n\n#### webdriver原理\n\n    # -*- coding:utf-8 -*-\n    from selenium import webdriver\n    import logging\n    \n    logging.basicConfig(level=logging.DEBUG)\n    driver = webdriver.Firefox()\n    driver.get('http://www.baidu.com')\n    driver.find_element_by_id('kw').send_keys('selenium')\n    driver.find_element_by_id('su').click()\n    driver.quit()\n    \n\n#### 显示等待\n\n    # -*- coding:utf-8 -*-\n    # 显示等待\n    from selenium import webdriver\n    from selenium.webdriver.common.by import By\n    from selenium.webdriver.support.ui import WebDriverWait\n    from selenium.webdriver.support import expected_conditions as EC\n    \n    driver = webdriver.Firefox()\n    driver.get('http://www.baidu.com')\n    # 显示等待\n    # 参数driver： 浏览器驱动\n    # 参数timeout： 最大超时时间，单位秒\n    # 参数poll_frequency： 检测的间隔时间，默认为0.5秒\n    # 参数ignored_exceptions: 超时异常信息，默认为NoSuchElementException\n    # WebDriverWait(driver, timeout, poll_frequency=0.5, ignored_exceptions=None)\n    # until(method, message='') 调用该方法提供的驱动程序作为参数，直到返回True\n    # until_not(method, message='') 调用该方法提供的驱动程序作为参数，直到返回False\n    # EC.title_is 判断当前页面的标题是否是否等于预期\n    # EC.title_contains 判断当前页面的标题是否包含预期的字符串\n    # EC.presence_of_element_located 判断元素是否被加载在DOM树中，并不代表当前元素可见\n    # EC.visibility_of_element_located 判断元素是否可见（可见并非代表元素非隐藏，并且元素的宽和高均不等于0）\n    # EC.visibility_of 与visibility_of_element_located相同，该方法接受的参数为定位后的元素\n    # EC.presence_of_all_elements_located 判断是否至少有一个元素存在与DOM树中\n    # EC.text_to_be_present_in_element 判断某个元素的text是否包含预期的字符串\n    # EC.text_to_be_present_in_element_value 判断某个元素的vaule属性是否包含了预期的字符串\n    # EC.frame_to_be_available_and_switch_to_it 判断该表单是否可以切换进去，如果可以，返回True并switch进去，否则返回false\n    # EC.invisibility_of_element_located 判断某个元素是否不存在于DOM树中或者不可见\n    # EC.element_to_be_clickable 判断某个元素是否可以点击\n    # EC.staleness_of 等到一个元素从DOM树中移除\n    # EC.element_to_be_selected 判断某个元素是否被选中，一般用于下拉菜单\n    # EC.element_selection_state_to_be 判断某个元素的选中状态是否符合预期, 参数为定位后的元素\n    # EC.element_located_selection_state_to_be 判断某个元素的选中状态是否符合预期,该方法接受的参数为定位\n    # EC.alert_is_present 判断页面上是否有alert\n    # driver.find_element_by_id().is_displayed() 判断元素是否可见\n    element = WebDriverWait(driver, 5, 0.5).until(EC.presence_of_element_located((By.ID, 'kw')))\n    element.send_keys('selenium')\n    # driver.quit()\n    \n    \n\n#### 隐式等待\n\n    # -*- coding:utf-8 -*-\n    # 隐式等待\n    from selenium import webdriver\n    from selenium.common.exceptions import NoSuchElementException\n    from time import ctime\n    from time import sleep\n    driver = webdriver.Firefox()\n    # sleep(10)\n    driver.implicitly_wait(10)\n    driver.get('http://www.baidu.com')\n    print ctime()\n    try:\n        driver.find_element_by_id('kw22').send_keys('selenium')\n    except NoSuchElementException as e:\n        print e\n    finally:\n        print ctime()\n    \n\n#### 执行js代码\n\n    # -*- coding:utf-8 -*-\n    # 执行js代码\n    from selenium import webdriver\n    from time import sleep\n    \n    # 访问百度\n    driver = webdriver.Firefox()\n    driver.get('http://www.baidu.com')\n    driver.set_window_size(600, 600)\n    driver.find_element_by_id('kw').send_keys('selenium')\n    driver.find_element_by_id('su').click()\n    sleep(2)\n    \n    js = 'window.scrollTo(100, 450);'\n    driver.execute_script(js)\n    sleep(3)\n    \n    # driver.quit()\n    \n\n#### 处理cookie\n\n    # -*- coding:utf-8 -*-\n    # cookie处理\n    from selenium import webdriver\n    driver = webdriver.Firefox()\n    driver.get('http://www.youdao.com')\n    driver.add_cookie({'name': 'name-a', 'value': 'value-b'})\n    # 获取cookie信息\n    cookies = driver.get_cookies()\n    print cookies\n    for cookie in cookies:\n        print cookie\n        print '{} -> {}'.format(cookie['name'], cookie['value'])\n    driver.quit()\n    \n\n#### 截图\n\n    # -*- coding:utf-8 -*-\n    # 窗口截图\n    from selenium import webdriver\n    from time import sleep\n    \n    # driver = webdriver.Firefox()\n    driver =  webdriver.PhantomJS(executable_path='/usr/bin/phantomjs')\n    driver.get('http://www.baidu.com')\n    \n    driver.find_element_by_id('kw').send_keys('selenium')\n    driver.find_element_by_id('su').click()\n    sleep(2)\n    \n    driver.get_screenshot_as_file('./screen.png')\n    driver.quit()\n    \n\n#### 播放视频\n\n    # -*- coding:utf-8 -*-\n    from selenium import webdriver\n    from time import sleep\n    \n    driver = webdriver.Firefox()\n    driver.get('http://videojs.com')\n    \n    video = driver.find_element_by_xpath('body/Setion[1]/div/video')\n    # 返回播放文件地址\n    url = driver.execute_script('return arguments[0].currentSrc;', video)\n    print url\n    \n    # 播放视频\n    print 'start'\n    driver.execute_script('return arguments[0].play()', video)\n    \n    # 播放15秒\n    sleep(15)\n    \n    # 暂停播放\n    print 'stop'\n    driver.execute_script('arguments[0].pause()', video)\n    \n    # driver.quit()","slug":"selenium入门基础","published":1,"updated":"2019-07-24T01:33:56.506Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5pw004c9ka4iovf3h9n","content":"<h4 id=\"安装及基本操作\"><a href=\"#安装及基本操作\" class=\"headerlink\" title=\"安装及基本操作\"></a>安装及基本操作</h4><pre><code># -*- coding:utf-8 -*-\n# 环境: ubuntu14.04\n# pip install seleninum\n# firefox\n# https://github.com/mozilla/geckodriver/releases 下载对应版本放在$PATH目录下\n# google\n# https://sites.google.com/a/chromium.org/chromedriver/downloads 下载对应版本放在$PATH目录下\n# http://www.seleniumhq.org/download/    其他浏览器参考\n# sudo apt-get install phantomjs  安装无界面webkit浏览器引擎\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\n\ndriver = webdriver.Firefox()\n# driver = webdriver.Chrome()\n# driver =  webdriver.PhantomJS(executable_path=&apos;/usr/bin/phantomjs&apos;)\ndriver.get(&apos;http://www.baidu.com&apos;)\n\n# 定位元素\n# 根据id定位\nfind_id = driver.find_element_by_id(&apos;wrapper&apos;)\nfind_id = driver.find_element(By.ID, &apos;wrapper&apos;)\n# 根据name属性定位\nfind_name = driver.find_element_by_name(&apos;wd&apos;)\nfind_name = driver.find_element(By.NAME, &apos;wd&apos;)\n# 根据class定位\nfind_class = driver.find_element_by_class_name(&apos;head_wrapper&apos;)\nfind_class = driver.find_element(By.CLASS_NAME, &apos;head_wrapper&apos;)\n# 根据标签名称定位\nfind_tag = driver.find_element_by_tag_name(&apos;div&apos;)\nfind_tag = driver.find_element(By.TAG_NAME, &apos;div&apos;)\n# 根据链接文本定位\nfind_a_text = driver.find_element_by_link_text(&apos;hao123&apos;)\nfind_a_text = driver.find_element(By.LINK_TEXT, &apos;hao123&apos;)\n# 根据部分链接文本定位\nfind_a_text = driver.find_element_by_partial_link_text(&apos;hao&apos;)\nfind_a_text = driver.find_element(By.PARTIAL_LINK_TEXT, &apos;hao&apos;)\n# 根据绝对位置定位\nfind_x_path = driver.find_elements_by_xpath(&apos;/html/body/div&apos;)\nfind_x_path = driver.find_element(By.XPATH, &apos;/html/body/div&apos;)\n# 支持层级，属性，逻辑运算符结合使用\nfind_x_path = driver.find_element_by_xpath(&quot;//input[@id=&apos;kw&apos;]&quot;)  # // 当前目录下的某个目录下\n# Css定位\nfind_css = driver.find_elements_by_css_selector(&apos;.s_ipt&apos;)\nfind_css = driver.find_element(By.CSS_SELECTOR, &apos;.s_ipt&apos;)\n\n# 设置浏览器宽高\ndriver.set_window_size(480, 800)\ndriver.get(&apos;http://www.126.com&apos;)\n# 控制浏览器前进倒退\ndriver.back()\ndriver.forward()\n# 刷新浏览器(F5)\ndriver.refresh()\n# 当前页面\nprint driver.current_url()\n# 元素操作\n# dom = driver.find_element(By.ID, &apos;kw&apos;)\n# dom.clear()  # 清除文本\n# dom.send_keys()  # 模拟键盘输入\n# dom.click()  # 点击元素\n# dom.submit()  # 模拟表单提交\n# dom.size()  # 返回元素的尺寸\n# dom.text()  # 返回元素的文本\n# dom.get_attribute(name)  # 返回元素的属性值\n# dom.is_displayed()  # 设置该元素是否可见\n\n# 鼠标操作\nfrom selenium.webdriver.common.action_chains import ActionChains\ndriver.get(&apos;http://www.baidu.com&apos;)\n# context_click 鼠标右键点击\nright_click = driver.find_element_by_id(&apos;xx&apos;)\n# perform 执行所有ActionChains中存储的动作\nActionChains(driver).context_click(right_click).perform()\n# above 鼠标悬停\nabove = driver.find_element_by_id(&apos;xxx&apos;)\nActionChains(driver).move_to_element(above).perform()\n# double_click 鼠标双击\n# drag_and_drop(source, target) 鼠标拖放\n\n\n# 键盘事件\nfrom selenium.webdriver.common.keys import Keys\nfind_id.send_keys(Keys.BACK_SPACE) # 删除键\nfind_id.send_keys(Keys.SPACE)  # 空格键\nfind_id.send_keys(Keys.TAB)  # tab键\nfind_id.send_keys(Keys.ESCAPE)  # ESC\nfind_id.send_keys(Keys.ENTER)  # 回车键\nfind_id.send_keys(Keys.CONTROL, &apos;c&apos;)  # 复制\nfind_id.send_keys(Keys.CONTROL, &apos;v&apos;)  # 剪贴\nfind_id.send_keys(Keys.F1) # F1\n\n# driver.quit()</code></pre><h4 id=\"webdriver原理\"><a href=\"#webdriver原理\" class=\"headerlink\" title=\"webdriver原理\"></a>webdriver原理</h4><pre><code># -*- coding:utf-8 -*-\nfrom selenium import webdriver\nimport logging\n\nlogging.basicConfig(level=logging.DEBUG)\ndriver = webdriver.Firefox()\ndriver.get(&apos;http://www.baidu.com&apos;)\ndriver.find_element_by_id(&apos;kw&apos;).send_keys(&apos;selenium&apos;)\ndriver.find_element_by_id(&apos;su&apos;).click()\ndriver.quit()</code></pre><h4 id=\"显示等待\"><a href=\"#显示等待\" class=\"headerlink\" title=\"显示等待\"></a>显示等待</h4><pre><code># -*- coding:utf-8 -*-\n# 显示等待\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.support.ui import WebDriverWait\nfrom selenium.webdriver.support import expected_conditions as EC\n\ndriver = webdriver.Firefox()\ndriver.get(&apos;http://www.baidu.com&apos;)\n# 显示等待\n# 参数driver： 浏览器驱动\n# 参数timeout： 最大超时时间，单位秒\n# 参数poll_frequency： 检测的间隔时间，默认为0.5秒\n# 参数ignored_exceptions: 超时异常信息，默认为NoSuchElementException\n# WebDriverWait(driver, timeout, poll_frequency=0.5, ignored_exceptions=None)\n# until(method, message=&apos;&apos;) 调用该方法提供的驱动程序作为参数，直到返回True\n# until_not(method, message=&apos;&apos;) 调用该方法提供的驱动程序作为参数，直到返回False\n# EC.title_is 判断当前页面的标题是否是否等于预期\n# EC.title_contains 判断当前页面的标题是否包含预期的字符串\n# EC.presence_of_element_located 判断元素是否被加载在DOM树中，并不代表当前元素可见\n# EC.visibility_of_element_located 判断元素是否可见（可见并非代表元素非隐藏，并且元素的宽和高均不等于0）\n# EC.visibility_of 与visibility_of_element_located相同，该方法接受的参数为定位后的元素\n# EC.presence_of_all_elements_located 判断是否至少有一个元素存在与DOM树中\n# EC.text_to_be_present_in_element 判断某个元素的text是否包含预期的字符串\n# EC.text_to_be_present_in_element_value 判断某个元素的vaule属性是否包含了预期的字符串\n# EC.frame_to_be_available_and_switch_to_it 判断该表单是否可以切换进去，如果可以，返回True并switch进去，否则返回false\n# EC.invisibility_of_element_located 判断某个元素是否不存在于DOM树中或者不可见\n# EC.element_to_be_clickable 判断某个元素是否可以点击\n# EC.staleness_of 等到一个元素从DOM树中移除\n# EC.element_to_be_selected 判断某个元素是否被选中，一般用于下拉菜单\n# EC.element_selection_state_to_be 判断某个元素的选中状态是否符合预期, 参数为定位后的元素\n# EC.element_located_selection_state_to_be 判断某个元素的选中状态是否符合预期,该方法接受的参数为定位\n# EC.alert_is_present 判断页面上是否有alert\n# driver.find_element_by_id().is_displayed() 判断元素是否可见\nelement = WebDriverWait(driver, 5, 0.5).until(EC.presence_of_element_located((By.ID, &apos;kw&apos;)))\nelement.send_keys(&apos;selenium&apos;)\n# driver.quit()</code></pre><h4 id=\"隐式等待\"><a href=\"#隐式等待\" class=\"headerlink\" title=\"隐式等待\"></a>隐式等待</h4><pre><code># -*- coding:utf-8 -*-\n# 隐式等待\nfrom selenium import webdriver\nfrom selenium.common.exceptions import NoSuchElementException\nfrom time import ctime\nfrom time import sleep\ndriver = webdriver.Firefox()\n# sleep(10)\ndriver.implicitly_wait(10)\ndriver.get(&apos;http://www.baidu.com&apos;)\nprint ctime()\ntry:\n    driver.find_element_by_id(&apos;kw22&apos;).send_keys(&apos;selenium&apos;)\nexcept NoSuchElementException as e:\n    print e\nfinally:\n    print ctime()</code></pre><h4 id=\"执行js代码\"><a href=\"#执行js代码\" class=\"headerlink\" title=\"执行js代码\"></a>执行js代码</h4><pre><code># -*- coding:utf-8 -*-\n# 执行js代码\nfrom selenium import webdriver\nfrom time import sleep\n\n# 访问百度\ndriver = webdriver.Firefox()\ndriver.get(&apos;http://www.baidu.com&apos;)\ndriver.set_window_size(600, 600)\ndriver.find_element_by_id(&apos;kw&apos;).send_keys(&apos;selenium&apos;)\ndriver.find_element_by_id(&apos;su&apos;).click()\nsleep(2)\n\njs = &apos;window.scrollTo(100, 450);&apos;\ndriver.execute_script(js)\nsleep(3)\n\n# driver.quit()</code></pre><h4 id=\"处理cookie\"><a href=\"#处理cookie\" class=\"headerlink\" title=\"处理cookie\"></a>处理cookie</h4><pre><code># -*- coding:utf-8 -*-\n# cookie处理\nfrom selenium import webdriver\ndriver = webdriver.Firefox()\ndriver.get(&apos;http://www.youdao.com&apos;)\ndriver.add_cookie({&apos;name&apos;: &apos;name-a&apos;, &apos;value&apos;: &apos;value-b&apos;})\n# 获取cookie信息\ncookies = driver.get_cookies()\nprint cookies\nfor cookie in cookies:\n    print cookie\n    print &apos;{} -&gt; {}&apos;.format(cookie[&apos;name&apos;], cookie[&apos;value&apos;])\ndriver.quit()</code></pre><h4 id=\"截图\"><a href=\"#截图\" class=\"headerlink\" title=\"截图\"></a>截图</h4><pre><code># -*- coding:utf-8 -*-\n# 窗口截图\nfrom selenium import webdriver\nfrom time import sleep\n\n# driver = webdriver.Firefox()\ndriver =  webdriver.PhantomJS(executable_path=&apos;/usr/bin/phantomjs&apos;)\ndriver.get(&apos;http://www.baidu.com&apos;)\n\ndriver.find_element_by_id(&apos;kw&apos;).send_keys(&apos;selenium&apos;)\ndriver.find_element_by_id(&apos;su&apos;).click()\nsleep(2)\n\ndriver.get_screenshot_as_file(&apos;./screen.png&apos;)\ndriver.quit()</code></pre><h4 id=\"播放视频\"><a href=\"#播放视频\" class=\"headerlink\" title=\"播放视频\"></a>播放视频</h4><pre><code># -*- coding:utf-8 -*-\nfrom selenium import webdriver\nfrom time import sleep\n\ndriver = webdriver.Firefox()\ndriver.get(&apos;http://videojs.com&apos;)\n\nvideo = driver.find_element_by_xpath(&apos;body/Setion[1]/div/video&apos;)\n# 返回播放文件地址\nurl = driver.execute_script(&apos;return arguments[0].currentSrc;&apos;, video)\nprint url\n\n# 播放视频\nprint &apos;start&apos;\ndriver.execute_script(&apos;return arguments[0].play()&apos;, video)\n\n# 播放15秒\nsleep(15)\n\n# 暂停播放\nprint &apos;stop&apos;\ndriver.execute_script(&apos;arguments[0].pause()&apos;, video)\n\n# driver.quit()</code></pre>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"安装及基本操作\"><a href=\"#安装及基本操作\" class=\"headerlink\" title=\"安装及基本操作\"></a>安装及基本操作</h4><pre><code># -*- coding:utf-8 -*-\n# 环境: ubuntu14.04\n# pip install seleninum\n# firefox\n# https://github.com/mozilla/geckodriver/releases 下载对应版本放在$PATH目录下\n# google\n# https://sites.google.com/a/chromium.org/chromedriver/downloads 下载对应版本放在$PATH目录下\n# http://www.seleniumhq.org/download/    其他浏览器参考\n# sudo apt-get install phantomjs  安装无界面webkit浏览器引擎\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\n\ndriver = webdriver.Firefox()\n# driver = webdriver.Chrome()\n# driver =  webdriver.PhantomJS(executable_path=&apos;/usr/bin/phantomjs&apos;)\ndriver.get(&apos;http://www.baidu.com&apos;)\n\n# 定位元素\n# 根据id定位\nfind_id = driver.find_element_by_id(&apos;wrapper&apos;)\nfind_id = driver.find_element(By.ID, &apos;wrapper&apos;)\n# 根据name属性定位\nfind_name = driver.find_element_by_name(&apos;wd&apos;)\nfind_name = driver.find_element(By.NAME, &apos;wd&apos;)\n# 根据class定位\nfind_class = driver.find_element_by_class_name(&apos;head_wrapper&apos;)\nfind_class = driver.find_element(By.CLASS_NAME, &apos;head_wrapper&apos;)\n# 根据标签名称定位\nfind_tag = driver.find_element_by_tag_name(&apos;div&apos;)\nfind_tag = driver.find_element(By.TAG_NAME, &apos;div&apos;)\n# 根据链接文本定位\nfind_a_text = driver.find_element_by_link_text(&apos;hao123&apos;)\nfind_a_text = driver.find_element(By.LINK_TEXT, &apos;hao123&apos;)\n# 根据部分链接文本定位\nfind_a_text = driver.find_element_by_partial_link_text(&apos;hao&apos;)\nfind_a_text = driver.find_element(By.PARTIAL_LINK_TEXT, &apos;hao&apos;)\n# 根据绝对位置定位\nfind_x_path = driver.find_elements_by_xpath(&apos;/html/body/div&apos;)\nfind_x_path = driver.find_element(By.XPATH, &apos;/html/body/div&apos;)\n# 支持层级，属性，逻辑运算符结合使用\nfind_x_path = driver.find_element_by_xpath(&quot;//input[@id=&apos;kw&apos;]&quot;)  # // 当前目录下的某个目录下\n# Css定位\nfind_css = driver.find_elements_by_css_selector(&apos;.s_ipt&apos;)\nfind_css = driver.find_element(By.CSS_SELECTOR, &apos;.s_ipt&apos;)\n\n# 设置浏览器宽高\ndriver.set_window_size(480, 800)\ndriver.get(&apos;http://www.126.com&apos;)\n# 控制浏览器前进倒退\ndriver.back()\ndriver.forward()\n# 刷新浏览器(F5)\ndriver.refresh()\n# 当前页面\nprint driver.current_url()\n# 元素操作\n# dom = driver.find_element(By.ID, &apos;kw&apos;)\n# dom.clear()  # 清除文本\n# dom.send_keys()  # 模拟键盘输入\n# dom.click()  # 点击元素\n# dom.submit()  # 模拟表单提交\n# dom.size()  # 返回元素的尺寸\n# dom.text()  # 返回元素的文本\n# dom.get_attribute(name)  # 返回元素的属性值\n# dom.is_displayed()  # 设置该元素是否可见\n\n# 鼠标操作\nfrom selenium.webdriver.common.action_chains import ActionChains\ndriver.get(&apos;http://www.baidu.com&apos;)\n# context_click 鼠标右键点击\nright_click = driver.find_element_by_id(&apos;xx&apos;)\n# perform 执行所有ActionChains中存储的动作\nActionChains(driver).context_click(right_click).perform()\n# above 鼠标悬停\nabove = driver.find_element_by_id(&apos;xxx&apos;)\nActionChains(driver).move_to_element(above).perform()\n# double_click 鼠标双击\n# drag_and_drop(source, target) 鼠标拖放\n\n\n# 键盘事件\nfrom selenium.webdriver.common.keys import Keys\nfind_id.send_keys(Keys.BACK_SPACE) # 删除键\nfind_id.send_keys(Keys.SPACE)  # 空格键\nfind_id.send_keys(Keys.TAB)  # tab键\nfind_id.send_keys(Keys.ESCAPE)  # ESC\nfind_id.send_keys(Keys.ENTER)  # 回车键\nfind_id.send_keys(Keys.CONTROL, &apos;c&apos;)  # 复制\nfind_id.send_keys(Keys.CONTROL, &apos;v&apos;)  # 剪贴\nfind_id.send_keys(Keys.F1) # F1\n\n# driver.quit()</code></pre><h4 id=\"webdriver原理\"><a href=\"#webdriver原理\" class=\"headerlink\" title=\"webdriver原理\"></a>webdriver原理</h4><pre><code># -*- coding:utf-8 -*-\nfrom selenium import webdriver\nimport logging\n\nlogging.basicConfig(level=logging.DEBUG)\ndriver = webdriver.Firefox()\ndriver.get(&apos;http://www.baidu.com&apos;)\ndriver.find_element_by_id(&apos;kw&apos;).send_keys(&apos;selenium&apos;)\ndriver.find_element_by_id(&apos;su&apos;).click()\ndriver.quit()</code></pre><h4 id=\"显示等待\"><a href=\"#显示等待\" class=\"headerlink\" title=\"显示等待\"></a>显示等待</h4><pre><code># -*- coding:utf-8 -*-\n# 显示等待\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.support.ui import WebDriverWait\nfrom selenium.webdriver.support import expected_conditions as EC\n\ndriver = webdriver.Firefox()\ndriver.get(&apos;http://www.baidu.com&apos;)\n# 显示等待\n# 参数driver： 浏览器驱动\n# 参数timeout： 最大超时时间，单位秒\n# 参数poll_frequency： 检测的间隔时间，默认为0.5秒\n# 参数ignored_exceptions: 超时异常信息，默认为NoSuchElementException\n# WebDriverWait(driver, timeout, poll_frequency=0.5, ignored_exceptions=None)\n# until(method, message=&apos;&apos;) 调用该方法提供的驱动程序作为参数，直到返回True\n# until_not(method, message=&apos;&apos;) 调用该方法提供的驱动程序作为参数，直到返回False\n# EC.title_is 判断当前页面的标题是否是否等于预期\n# EC.title_contains 判断当前页面的标题是否包含预期的字符串\n# EC.presence_of_element_located 判断元素是否被加载在DOM树中，并不代表当前元素可见\n# EC.visibility_of_element_located 判断元素是否可见（可见并非代表元素非隐藏，并且元素的宽和高均不等于0）\n# EC.visibility_of 与visibility_of_element_located相同，该方法接受的参数为定位后的元素\n# EC.presence_of_all_elements_located 判断是否至少有一个元素存在与DOM树中\n# EC.text_to_be_present_in_element 判断某个元素的text是否包含预期的字符串\n# EC.text_to_be_present_in_element_value 判断某个元素的vaule属性是否包含了预期的字符串\n# EC.frame_to_be_available_and_switch_to_it 判断该表单是否可以切换进去，如果可以，返回True并switch进去，否则返回false\n# EC.invisibility_of_element_located 判断某个元素是否不存在于DOM树中或者不可见\n# EC.element_to_be_clickable 判断某个元素是否可以点击\n# EC.staleness_of 等到一个元素从DOM树中移除\n# EC.element_to_be_selected 判断某个元素是否被选中，一般用于下拉菜单\n# EC.element_selection_state_to_be 判断某个元素的选中状态是否符合预期, 参数为定位后的元素\n# EC.element_located_selection_state_to_be 判断某个元素的选中状态是否符合预期,该方法接受的参数为定位\n# EC.alert_is_present 判断页面上是否有alert\n# driver.find_element_by_id().is_displayed() 判断元素是否可见\nelement = WebDriverWait(driver, 5, 0.5).until(EC.presence_of_element_located((By.ID, &apos;kw&apos;)))\nelement.send_keys(&apos;selenium&apos;)\n# driver.quit()</code></pre><h4 id=\"隐式等待\"><a href=\"#隐式等待\" class=\"headerlink\" title=\"隐式等待\"></a>隐式等待</h4><pre><code># -*- coding:utf-8 -*-\n# 隐式等待\nfrom selenium import webdriver\nfrom selenium.common.exceptions import NoSuchElementException\nfrom time import ctime\nfrom time import sleep\ndriver = webdriver.Firefox()\n# sleep(10)\ndriver.implicitly_wait(10)\ndriver.get(&apos;http://www.baidu.com&apos;)\nprint ctime()\ntry:\n    driver.find_element_by_id(&apos;kw22&apos;).send_keys(&apos;selenium&apos;)\nexcept NoSuchElementException as e:\n    print e\nfinally:\n    print ctime()</code></pre><h4 id=\"执行js代码\"><a href=\"#执行js代码\" class=\"headerlink\" title=\"执行js代码\"></a>执行js代码</h4><pre><code># -*- coding:utf-8 -*-\n# 执行js代码\nfrom selenium import webdriver\nfrom time import sleep\n\n# 访问百度\ndriver = webdriver.Firefox()\ndriver.get(&apos;http://www.baidu.com&apos;)\ndriver.set_window_size(600, 600)\ndriver.find_element_by_id(&apos;kw&apos;).send_keys(&apos;selenium&apos;)\ndriver.find_element_by_id(&apos;su&apos;).click()\nsleep(2)\n\njs = &apos;window.scrollTo(100, 450);&apos;\ndriver.execute_script(js)\nsleep(3)\n\n# driver.quit()</code></pre><h4 id=\"处理cookie\"><a href=\"#处理cookie\" class=\"headerlink\" title=\"处理cookie\"></a>处理cookie</h4><pre><code># -*- coding:utf-8 -*-\n# cookie处理\nfrom selenium import webdriver\ndriver = webdriver.Firefox()\ndriver.get(&apos;http://www.youdao.com&apos;)\ndriver.add_cookie({&apos;name&apos;: &apos;name-a&apos;, &apos;value&apos;: &apos;value-b&apos;})\n# 获取cookie信息\ncookies = driver.get_cookies()\nprint cookies\nfor cookie in cookies:\n    print cookie\n    print &apos;{} -&gt; {}&apos;.format(cookie[&apos;name&apos;], cookie[&apos;value&apos;])\ndriver.quit()</code></pre><h4 id=\"截图\"><a href=\"#截图\" class=\"headerlink\" title=\"截图\"></a>截图</h4><pre><code># -*- coding:utf-8 -*-\n# 窗口截图\nfrom selenium import webdriver\nfrom time import sleep\n\n# driver = webdriver.Firefox()\ndriver =  webdriver.PhantomJS(executable_path=&apos;/usr/bin/phantomjs&apos;)\ndriver.get(&apos;http://www.baidu.com&apos;)\n\ndriver.find_element_by_id(&apos;kw&apos;).send_keys(&apos;selenium&apos;)\ndriver.find_element_by_id(&apos;su&apos;).click()\nsleep(2)\n\ndriver.get_screenshot_as_file(&apos;./screen.png&apos;)\ndriver.quit()</code></pre><h4 id=\"播放视频\"><a href=\"#播放视频\" class=\"headerlink\" title=\"播放视频\"></a>播放视频</h4><pre><code># -*- coding:utf-8 -*-\nfrom selenium import webdriver\nfrom time import sleep\n\ndriver = webdriver.Firefox()\ndriver.get(&apos;http://videojs.com&apos;)\n\nvideo = driver.find_element_by_xpath(&apos;body/Setion[1]/div/video&apos;)\n# 返回播放文件地址\nurl = driver.execute_script(&apos;return arguments[0].currentSrc;&apos;, video)\nprint url\n\n# 播放视频\nprint &apos;start&apos;\ndriver.execute_script(&apos;return arguments[0].play()&apos;, video)\n\n# 播放15秒\nsleep(15)\n\n# 暂停播放\nprint &apos;stop&apos;\ndriver.execute_script(&apos;arguments[0].pause()&apos;, video)\n\n# driver.quit()</code></pre>"},{"title":"rsync同步web服务器","url":"39.html","id":"39","comments":0,"date":"2016-11-09T03:05:34.000Z","_content":"\n### 测试环境\n\n服务端安装 WIN2008R2 ip:192.168.0.160  \n客户端安装 WIN2003 ip:192.168.0.206\n\n### 程序下载\n\n新版已经开始收费，这里使用旧版4.0.5,百度网盘下载http://pan.baidu.com/s/1kTNyk1h\n\n### 服务端安装\n\n![](http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync.png) 一路直接下一步，这里会创建一个用户，创建的默认密码可以不需要修改，直接下一步。 ![](http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync1.png) 创建的用户 ![](http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync2.png) 创建的服务改为自动启动\n\n### 客户端安装\n\n一路下一步直到完成。\n\n### 配置服务端\n\n    use chroot = false\n    # 不验证用户密码\n    strict modes = false\n    lock file = rsyncd.lock \n    hosts allow = 192.168.0.206\n    max connections = 5\n    # 默认端口\n    port = 873\n    \n    # 指定匿名访问\n    uid = 0\n    gid = 0\n    \n    \n    log file = rsyncd.log\n    \n    # Module definitions\n    # Remember cygwin naming conventions : c:\\work becomes /cygdrive/c/work\n    \n    [web]\n    path = /cygdrive/C/WEB\n    # 下面两行是配置用户名密码的\n    # auth users = dbbackuper\n    # secrets file = /cygdrive/e/Setting/Rsync/rsync_db.ps\n    # 只允许客户端下载，不允许客户端上传\n    read only = true\n    transfer logging = yes\n    \n\n防火墙设置允许配置的端口通过  \n查看端口配置是否错误\n\n    telnet 192.168.0.160 873  \n    @RSYNCD: 30.0\n    \n\n服务器端配置测试文件目录 ![](http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync3.png) 其中targetDir为联接文件\n\n    C:\\>mklink /J WEB\\targetDir\\ source\\\n    为 WEB\\targetDir\\ <<===>> source\\ 创建的联接\n    \n\n### 配置客户端\n\n在安装目录下使用如下命令\n\n    C:\\Program Files\\cwRsync\\bin>rsync --port=873 -vzrtopg --progress --delete 192.168.0.160::web /cygdrive/C/WEB\n    receiving incremental file list\n    skipping non-regular file \"targetDir\"\n    ./\n    TEST4/\n    test3/\n    \n    sent 39 bytes  received 163 bytes  134.67 bytes/sec\n    total size is 19  speedup is 0.09\n    \n\n查看客户端文件目录\n\n    test3\n    TEST4\n    \n\n提示skipping non-regular file 'targetDir'忽略软链接解决办法  \n参数-L:--copy-links 像对待常规文件一样处理软链结\n\n    C:\\Program Files\\cwRsync\\bin>rsync --port=873 -vzrtopgL --progress --delete 192.\n    168.0.160::web /cygdrive/C/WEB\n    receiving incremental file list\n    deleting test5/adda.txt\n    deleting test5/\n    ./\n    TEST4/\n    targetDir/\n    targetDir/HAFA/\n    targetDir/pdf/\n    targetDir/pdf/TARGE.txt\n               0 100%    0.00kB/s    0:00:00 (xfer#1, to-check=1/8)\n    test3/\n    \n    sent 70 bytes  received 272 bytes  97.71 bytes/sec\n    total size is 0  speedup is 0.00\n    \n\n### 实现客户端定时任务\n\n1，要添加环境变量到系统中  \n2，上传脚本文件到客户端sync_client.bat\n\n    rsync --port=873 -vzrtopgL --progress --delete 192.168.0.160::web /cygdrive/C/WEB\n    \n\n3,在系统中添加定时任务，并指定更新时间\n\n### 具体参数详解\n\nrsync参数的具体解释如下： -v, --verbose 详细模式输出  \n-q, --quiet 精简输出模式  \n-c, --checksum 打开校验开关，强制对文件传输进行校验  \n-a, --archive 归档模式，表示以递归方式传输文件，并保持所有文件属性，等于-rlptgoD  \n-r, --recursive 对子目录以递归模式处理  \n-R, --relative 使用相对路径信息  \n-b, --backup 创建备份，也就是对于目的已经存在有同样的文件名时，将老的文件重新命名为~filename。可以使用--suffix选项来指定不同的备份文件前缀。  \n--backup-dir 将备份文件(如~filename)存放在在目录下。  \n-suffix=SUFFIX 定义备份文件前缀  \n-u, --update 仅仅进行更新，也就是跳过所有已经存在于DST，并且文件时间晚于要备份的文件。(不覆盖更新的文件)  \n-l, --links 保留软链结  \n-L, --copy-links 想对待常规文件一样处理软链结  \n--copy-unsafe-links 仅仅拷贝指向SRC路径目录树以外的链结  \n--safe-links 忽略指向SRC路径目录树以外的链结  \n-H, --hard-links 保留硬链结  \n-p, --perms 保持文件权限  \n-o, --owner 保持文件属主信息  \n-g, --group 保持文件属组信息  \n-D, --devices 保持设备文件信息  \n-t, --times 保持文件时间信息  \n-S, --sparse 对稀疏文件进行特殊处理以节省DST的空间  \n-n, --dry-run现实哪些文件将被传输  \n-W, --whole-file 拷贝文件，不进行增量检测  \n-x, --one-file-system 不要跨越文件系统边界  \n-B, --block-size=SIZE 检验算法使用的块尺寸，默认是700字节  \n-e, --rsh=COMMAND 指定使用rsh、ssh方式进行数据同步  \n--rsync-path=PATH 指定远程服务器上的rsync命令所在路径信息  \n-C, --cvs-exclude 使用和CVS一样的方法自动忽略文件，用来排除那些不希望传输的文件  \n--existing 仅仅更新那些已经存在于DST的文件，而不备份那些新创建的文件  \n--delete 删除那些DST中SRC没有的文件  \n--delete-excluded 同样删除接收端那些被该选项指定排除的文件  \n--delete-after 传输结束以后再删除  \n--ignore-errors 及时出现IO错误也进行删除  \n--max-delete=NUM 最多删除NUM个文件  \n--partial 保留那些因故没有完全传输的文件，以是加快随后的再次传输  \n--force 强制删除目录，即使不为空  \n--numeric-ids 不将数字的用户和组ID匹配为用户名和组名  \n--timeout=TIME IP超时时间，单位为秒  \n-I, --ignore-times 不跳过那些有同样的时间和长度的文件  \n--size-only 当决定是否要备份文件时，仅仅察看文件大小而不考虑文件时间  \n--modify-window=NUM 决定文件是否时间相同时使用的时间戳窗口，默认为0  \n-T --temp-dir=DIR 在DIR中创建临时文件  \n--compare-dest=DIR 同样比较DIR中的文件来决定是否需要备份  \n-P 等同于 --partial  \n--progress 显示备份过程  \n-z, --compress 对备份的文件在传输时进行压缩处理  \n--exclude=PATTERN 指定排除不需要传输的文件模式  \n--include=PATTERN 指定不排除而需要传输的文件模式  \n--exclude-from=FILE 排除FILE中指定模式的文件  \n--include-from=FILE 不排除FILE指定模式匹配的文件  \n--version 打印版本信息  \n--address 绑定到特定的地址  \n--config=FILE 指定其他的配置文件，不使用默认的rsyncd.conf文件  \n--port=PORT 指定其他的rsync服务端口  \n--blocking-io 对远程shell使用阻塞IO  \n-stats 给出某些文件的传输状态  \n--progress 在传输时现实传输过程  \n--log-format=formAT 指定日志文件格式  \n--password-file=FILE 从FILE中得到密码  \n--bwlimit=KBPS 限制I/O带宽，KBytes per second  \n-h, --help 显示帮助信息\n\n### 部分错误的解决办法\n\n1.'rsync' 不是内部或外部命令，也不是可运行的程序或批处理文件。  \n加环境变量 path = C:\\\\Program Files (x86)\\\\cwRsync\\\\bin 2.rsync: failed to connect to 192.168.1.82: Connection timed out (116) rsync error: error in socket IO (code 10) at clientserver.c(122) \\[Receiver=3.0.7\\]  \n网络通畅，服务器端允许访问端口 873 3.@ERROR: invalid uid nobody  \nrsync error: error starting client-server protocol (code 5) at main.c(1506) \\[Receiver=3.0.7\\]  \n指定uid gid  \nuid = 0  \ngid = 0 4.@ERROR: chdir failed  \nrsync error: error starting client-server protocol (code 5) at main.c(1506) \\[Receiver=3.0.7\\]  \npath目录配置的正确，得存在  \n解决：服务器端同步目录没有权限，cwrsync默认用户是Svcwrsync。为同步目录添加用户Svcwrsync权限。  \n也可以通过 菜单--cwRsyncServer--02. Prep a Dir for Upload 配置目录权限 除完全控制和特殊权限外的所有权限 5.@ERROR: auth failed on module test  \nrsync error: error starting client-server protocol (code 5) at main.c(1506) \\[Receiver=3.0.7\\]  \n客户端设置  \na.在命令上要指定好用户名  \nb.密码文件只写密码  \nrsyncd.secrets文件  \nrsyncpass  \nc.用户名密码都要正确 6.Unexpected local arg: /cygdrive/d/rsyncBackup  \nIf arg is a remote file/dir, prefix it with a colon (:).  \nrsync error: syntax or usage error (code 1) at main.c(1218) \\[Receiver=3.0.7\\]  \n不一定是这个路径有问题，可能是--password-file路径中有空格，服务器端没问题，客户端好像不行 7.password file must be owned by root when running as root  \ncontinuing without password file  \nPassword:  \n设置密码访问权限chown.exe可从服务器端拷贝过来  \nchmod -c 600 /cygdrive/c/etc/rsyncd.secrets  \nchown administrator /cygdrive/c/etc/rsyncd.secrets  \n服务器端不设也可以 8.当出现rsync: chown “” failed: Invalid argument (22)错误时，是因为参数中有o，即保留文件的owner信息，而window服务端无法完成chown操作，解决办法是去掉参数o。另外有些可能还会出现rsync: chgrp “” failed: Invalid argument (22)，原因类似，只要去掉参数中的g即可。","source":"_posts/rsync同步web服务器.md","raw":"---\ntitle: rsync同步web服务器\ntags:\n  - windows\nurl: 39.html\nid: 39\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-09 11:05:34\n---\n\n### 测试环境\n\n服务端安装 WIN2008R2 ip:192.168.0.160  \n客户端安装 WIN2003 ip:192.168.0.206\n\n### 程序下载\n\n新版已经开始收费，这里使用旧版4.0.5,百度网盘下载http://pan.baidu.com/s/1kTNyk1h\n\n### 服务端安装\n\n![](http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync.png) 一路直接下一步，这里会创建一个用户，创建的默认密码可以不需要修改，直接下一步。 ![](http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync1.png) 创建的用户 ![](http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync2.png) 创建的服务改为自动启动\n\n### 客户端安装\n\n一路下一步直到完成。\n\n### 配置服务端\n\n    use chroot = false\n    # 不验证用户密码\n    strict modes = false\n    lock file = rsyncd.lock \n    hosts allow = 192.168.0.206\n    max connections = 5\n    # 默认端口\n    port = 873\n    \n    # 指定匿名访问\n    uid = 0\n    gid = 0\n    \n    \n    log file = rsyncd.log\n    \n    # Module definitions\n    # Remember cygwin naming conventions : c:\\work becomes /cygdrive/c/work\n    \n    [web]\n    path = /cygdrive/C/WEB\n    # 下面两行是配置用户名密码的\n    # auth users = dbbackuper\n    # secrets file = /cygdrive/e/Setting/Rsync/rsync_db.ps\n    # 只允许客户端下载，不允许客户端上传\n    read only = true\n    transfer logging = yes\n    \n\n防火墙设置允许配置的端口通过  \n查看端口配置是否错误\n\n    telnet 192.168.0.160 873  \n    @RSYNCD: 30.0\n    \n\n服务器端配置测试文件目录 ![](http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync3.png) 其中targetDir为联接文件\n\n    C:\\>mklink /J WEB\\targetDir\\ source\\\n    为 WEB\\targetDir\\ <<===>> source\\ 创建的联接\n    \n\n### 配置客户端\n\n在安装目录下使用如下命令\n\n    C:\\Program Files\\cwRsync\\bin>rsync --port=873 -vzrtopg --progress --delete 192.168.0.160::web /cygdrive/C/WEB\n    receiving incremental file list\n    skipping non-regular file \"targetDir\"\n    ./\n    TEST4/\n    test3/\n    \n    sent 39 bytes  received 163 bytes  134.67 bytes/sec\n    total size is 19  speedup is 0.09\n    \n\n查看客户端文件目录\n\n    test3\n    TEST4\n    \n\n提示skipping non-regular file 'targetDir'忽略软链接解决办法  \n参数-L:--copy-links 像对待常规文件一样处理软链结\n\n    C:\\Program Files\\cwRsync\\bin>rsync --port=873 -vzrtopgL --progress --delete 192.\n    168.0.160::web /cygdrive/C/WEB\n    receiving incremental file list\n    deleting test5/adda.txt\n    deleting test5/\n    ./\n    TEST4/\n    targetDir/\n    targetDir/HAFA/\n    targetDir/pdf/\n    targetDir/pdf/TARGE.txt\n               0 100%    0.00kB/s    0:00:00 (xfer#1, to-check=1/8)\n    test3/\n    \n    sent 70 bytes  received 272 bytes  97.71 bytes/sec\n    total size is 0  speedup is 0.00\n    \n\n### 实现客户端定时任务\n\n1，要添加环境变量到系统中  \n2，上传脚本文件到客户端sync_client.bat\n\n    rsync --port=873 -vzrtopgL --progress --delete 192.168.0.160::web /cygdrive/C/WEB\n    \n\n3,在系统中添加定时任务，并指定更新时间\n\n### 具体参数详解\n\nrsync参数的具体解释如下： -v, --verbose 详细模式输出  \n-q, --quiet 精简输出模式  \n-c, --checksum 打开校验开关，强制对文件传输进行校验  \n-a, --archive 归档模式，表示以递归方式传输文件，并保持所有文件属性，等于-rlptgoD  \n-r, --recursive 对子目录以递归模式处理  \n-R, --relative 使用相对路径信息  \n-b, --backup 创建备份，也就是对于目的已经存在有同样的文件名时，将老的文件重新命名为~filename。可以使用--suffix选项来指定不同的备份文件前缀。  \n--backup-dir 将备份文件(如~filename)存放在在目录下。  \n-suffix=SUFFIX 定义备份文件前缀  \n-u, --update 仅仅进行更新，也就是跳过所有已经存在于DST，并且文件时间晚于要备份的文件。(不覆盖更新的文件)  \n-l, --links 保留软链结  \n-L, --copy-links 想对待常规文件一样处理软链结  \n--copy-unsafe-links 仅仅拷贝指向SRC路径目录树以外的链结  \n--safe-links 忽略指向SRC路径目录树以外的链结  \n-H, --hard-links 保留硬链结  \n-p, --perms 保持文件权限  \n-o, --owner 保持文件属主信息  \n-g, --group 保持文件属组信息  \n-D, --devices 保持设备文件信息  \n-t, --times 保持文件时间信息  \n-S, --sparse 对稀疏文件进行特殊处理以节省DST的空间  \n-n, --dry-run现实哪些文件将被传输  \n-W, --whole-file 拷贝文件，不进行增量检测  \n-x, --one-file-system 不要跨越文件系统边界  \n-B, --block-size=SIZE 检验算法使用的块尺寸，默认是700字节  \n-e, --rsh=COMMAND 指定使用rsh、ssh方式进行数据同步  \n--rsync-path=PATH 指定远程服务器上的rsync命令所在路径信息  \n-C, --cvs-exclude 使用和CVS一样的方法自动忽略文件，用来排除那些不希望传输的文件  \n--existing 仅仅更新那些已经存在于DST的文件，而不备份那些新创建的文件  \n--delete 删除那些DST中SRC没有的文件  \n--delete-excluded 同样删除接收端那些被该选项指定排除的文件  \n--delete-after 传输结束以后再删除  \n--ignore-errors 及时出现IO错误也进行删除  \n--max-delete=NUM 最多删除NUM个文件  \n--partial 保留那些因故没有完全传输的文件，以是加快随后的再次传输  \n--force 强制删除目录，即使不为空  \n--numeric-ids 不将数字的用户和组ID匹配为用户名和组名  \n--timeout=TIME IP超时时间，单位为秒  \n-I, --ignore-times 不跳过那些有同样的时间和长度的文件  \n--size-only 当决定是否要备份文件时，仅仅察看文件大小而不考虑文件时间  \n--modify-window=NUM 决定文件是否时间相同时使用的时间戳窗口，默认为0  \n-T --temp-dir=DIR 在DIR中创建临时文件  \n--compare-dest=DIR 同样比较DIR中的文件来决定是否需要备份  \n-P 等同于 --partial  \n--progress 显示备份过程  \n-z, --compress 对备份的文件在传输时进行压缩处理  \n--exclude=PATTERN 指定排除不需要传输的文件模式  \n--include=PATTERN 指定不排除而需要传输的文件模式  \n--exclude-from=FILE 排除FILE中指定模式的文件  \n--include-from=FILE 不排除FILE指定模式匹配的文件  \n--version 打印版本信息  \n--address 绑定到特定的地址  \n--config=FILE 指定其他的配置文件，不使用默认的rsyncd.conf文件  \n--port=PORT 指定其他的rsync服务端口  \n--blocking-io 对远程shell使用阻塞IO  \n-stats 给出某些文件的传输状态  \n--progress 在传输时现实传输过程  \n--log-format=formAT 指定日志文件格式  \n--password-file=FILE 从FILE中得到密码  \n--bwlimit=KBPS 限制I/O带宽，KBytes per second  \n-h, --help 显示帮助信息\n\n### 部分错误的解决办法\n\n1.'rsync' 不是内部或外部命令，也不是可运行的程序或批处理文件。  \n加环境变量 path = C:\\\\Program Files (x86)\\\\cwRsync\\\\bin 2.rsync: failed to connect to 192.168.1.82: Connection timed out (116) rsync error: error in socket IO (code 10) at clientserver.c(122) \\[Receiver=3.0.7\\]  \n网络通畅，服务器端允许访问端口 873 3.@ERROR: invalid uid nobody  \nrsync error: error starting client-server protocol (code 5) at main.c(1506) \\[Receiver=3.0.7\\]  \n指定uid gid  \nuid = 0  \ngid = 0 4.@ERROR: chdir failed  \nrsync error: error starting client-server protocol (code 5) at main.c(1506) \\[Receiver=3.0.7\\]  \npath目录配置的正确，得存在  \n解决：服务器端同步目录没有权限，cwrsync默认用户是Svcwrsync。为同步目录添加用户Svcwrsync权限。  \n也可以通过 菜单--cwRsyncServer--02. Prep a Dir for Upload 配置目录权限 除完全控制和特殊权限外的所有权限 5.@ERROR: auth failed on module test  \nrsync error: error starting client-server protocol (code 5) at main.c(1506) \\[Receiver=3.0.7\\]  \n客户端设置  \na.在命令上要指定好用户名  \nb.密码文件只写密码  \nrsyncd.secrets文件  \nrsyncpass  \nc.用户名密码都要正确 6.Unexpected local arg: /cygdrive/d/rsyncBackup  \nIf arg is a remote file/dir, prefix it with a colon (:).  \nrsync error: syntax or usage error (code 1) at main.c(1218) \\[Receiver=3.0.7\\]  \n不一定是这个路径有问题，可能是--password-file路径中有空格，服务器端没问题，客户端好像不行 7.password file must be owned by root when running as root  \ncontinuing without password file  \nPassword:  \n设置密码访问权限chown.exe可从服务器端拷贝过来  \nchmod -c 600 /cygdrive/c/etc/rsyncd.secrets  \nchown administrator /cygdrive/c/etc/rsyncd.secrets  \n服务器端不设也可以 8.当出现rsync: chown “” failed: Invalid argument (22)错误时，是因为参数中有o，即保留文件的owner信息，而window服务端无法完成chown操作，解决办法是去掉参数o。另外有些可能还会出现rsync: chgrp “” failed: Invalid argument (22)，原因类似，只要去掉参数中的g即可。","slug":"rsync同步web服务器","published":1,"updated":"2019-07-24T01:33:42.843Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5px004e9ka46n45qwdg","content":"<h3 id=\"测试环境\"><a href=\"#测试环境\" class=\"headerlink\" title=\"测试环境\"></a>测试环境</h3><p>服务端安装 WIN2008R2 ip:192.168.0.160<br>客户端安装 WIN2003 ip:192.168.0.206</p>\n<h3 id=\"程序下载\"><a href=\"#程序下载\" class=\"headerlink\" title=\"程序下载\"></a>程序下载</h3><p>新版已经开始收费，这里使用旧版4.0.5,百度网盘下载<a href=\"http://pan.baidu.com/s/1kTNyk1h\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1kTNyk1h</a></p>\n<h3 id=\"服务端安装\"><a href=\"#服务端安装\" class=\"headerlink\" title=\"服务端安装\"></a>服务端安装</h3><p><img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync.png\" alt> 一路直接下一步，这里会创建一个用户，创建的默认密码可以不需要修改，直接下一步。 <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync1.png\" alt> 创建的用户 <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync2.png\" alt> 创建的服务改为自动启动</p>\n<h3 id=\"客户端安装\"><a href=\"#客户端安装\" class=\"headerlink\" title=\"客户端安装\"></a>客户端安装</h3><p>一路下一步直到完成。</p>\n<h3 id=\"配置服务端\"><a href=\"#配置服务端\" class=\"headerlink\" title=\"配置服务端\"></a>配置服务端</h3><pre><code>use chroot = false\n# 不验证用户密码\nstrict modes = false\nlock file = rsyncd.lock \nhosts allow = 192.168.0.206\nmax connections = 5\n# 默认端口\nport = 873\n\n# 指定匿名访问\nuid = 0\ngid = 0\n\n\nlog file = rsyncd.log\n\n# Module definitions\n# Remember cygwin naming conventions : c:\\work becomes /cygdrive/c/work\n\n[web]\npath = /cygdrive/C/WEB\n# 下面两行是配置用户名密码的\n# auth users = dbbackuper\n# secrets file = /cygdrive/e/Setting/Rsync/rsync_db.ps\n# 只允许客户端下载，不允许客户端上传\nread only = true\ntransfer logging = yes</code></pre><p>防火墙设置允许配置的端口通过<br>查看端口配置是否错误</p>\n<pre><code>telnet 192.168.0.160 873  \n@RSYNCD: 30.0</code></pre><p>服务器端配置测试文件目录 <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync3.png\" alt> 其中targetDir为联接文件</p>\n<pre><code>C:\\&gt;mklink /J WEB\\targetDir\\ source\\\n为 WEB\\targetDir\\ &lt;&lt;===&gt;&gt; source\\ 创建的联接</code></pre><h3 id=\"配置客户端\"><a href=\"#配置客户端\" class=\"headerlink\" title=\"配置客户端\"></a>配置客户端</h3><p>在安装目录下使用如下命令</p>\n<pre><code>C:\\Program Files\\cwRsync\\bin&gt;rsync --port=873 -vzrtopg --progress --delete 192.168.0.160::web /cygdrive/C/WEB\nreceiving incremental file list\nskipping non-regular file &quot;targetDir&quot;\n./\nTEST4/\ntest3/\n\nsent 39 bytes  received 163 bytes  134.67 bytes/sec\ntotal size is 19  speedup is 0.09</code></pre><p>查看客户端文件目录</p>\n<pre><code>test3\nTEST4</code></pre><p>提示skipping non-regular file ‘targetDir’忽略软链接解决办法<br>参数-L:–copy-links 像对待常规文件一样处理软链结</p>\n<pre><code>C:\\Program Files\\cwRsync\\bin&gt;rsync --port=873 -vzrtopgL --progress --delete 192.\n168.0.160::web /cygdrive/C/WEB\nreceiving incremental file list\ndeleting test5/adda.txt\ndeleting test5/\n./\nTEST4/\ntargetDir/\ntargetDir/HAFA/\ntargetDir/pdf/\ntargetDir/pdf/TARGE.txt\n           0 100%    0.00kB/s    0:00:00 (xfer#1, to-check=1/8)\ntest3/\n\nsent 70 bytes  received 272 bytes  97.71 bytes/sec\ntotal size is 0  speedup is 0.00</code></pre><h3 id=\"实现客户端定时任务\"><a href=\"#实现客户端定时任务\" class=\"headerlink\" title=\"实现客户端定时任务\"></a>实现客户端定时任务</h3><p>1，要添加环境变量到系统中<br>2，上传脚本文件到客户端sync_client.bat</p>\n<pre><code>rsync --port=873 -vzrtopgL --progress --delete 192.168.0.160::web /cygdrive/C/WEB</code></pre><p>3,在系统中添加定时任务，并指定更新时间</p>\n<h3 id=\"具体参数详解\"><a href=\"#具体参数详解\" class=\"headerlink\" title=\"具体参数详解\"></a>具体参数详解</h3><p>rsync参数的具体解释如下： -v, –verbose 详细模式输出<br>-q, –quiet 精简输出模式<br>-c, –checksum 打开校验开关，强制对文件传输进行校验<br>-a, –archive 归档模式，表示以递归方式传输文件，并保持所有文件属性，等于-rlptgoD<br>-r, –recursive 对子目录以递归模式处理<br>-R, –relative 使用相对路径信息<br>-b, –backup 创建备份，也就是对于目的已经存在有同样的文件名时，将老的文件重新命名为<del>filename。可以使用–suffix选项来指定不同的备份文件前缀。<br>–backup-dir 将备份文件(如</del>filename)存放在在目录下。<br>-suffix=SUFFIX 定义备份文件前缀<br>-u, –update 仅仅进行更新，也就是跳过所有已经存在于DST，并且文件时间晚于要备份的文件。(不覆盖更新的文件)<br>-l, –links 保留软链结<br>-L, –copy-links 想对待常规文件一样处理软链结<br>–copy-unsafe-links 仅仅拷贝指向SRC路径目录树以外的链结<br>–safe-links 忽略指向SRC路径目录树以外的链结<br>-H, –hard-links 保留硬链结<br>-p, –perms 保持文件权限<br>-o, –owner 保持文件属主信息<br>-g, –group 保持文件属组信息<br>-D, –devices 保持设备文件信息<br>-t, –times 保持文件时间信息<br>-S, –sparse 对稀疏文件进行特殊处理以节省DST的空间<br>-n, –dry-run现实哪些文件将被传输<br>-W, –whole-file 拷贝文件，不进行增量检测<br>-x, –one-file-system 不要跨越文件系统边界<br>-B, –block-size=SIZE 检验算法使用的块尺寸，默认是700字节<br>-e, –rsh=COMMAND 指定使用rsh、ssh方式进行数据同步<br>–rsync-path=PATH 指定远程服务器上的rsync命令所在路径信息<br>-C, –cvs-exclude 使用和CVS一样的方法自动忽略文件，用来排除那些不希望传输的文件<br>–existing 仅仅更新那些已经存在于DST的文件，而不备份那些新创建的文件<br>–delete 删除那些DST中SRC没有的文件<br>–delete-excluded 同样删除接收端那些被该选项指定排除的文件<br>–delete-after 传输结束以后再删除<br>–ignore-errors 及时出现IO错误也进行删除<br>–max-delete=NUM 最多删除NUM个文件<br>–partial 保留那些因故没有完全传输的文件，以是加快随后的再次传输<br>–force 强制删除目录，即使不为空<br>–numeric-ids 不将数字的用户和组ID匹配为用户名和组名<br>–timeout=TIME IP超时时间，单位为秒<br>-I, –ignore-times 不跳过那些有同样的时间和长度的文件<br>–size-only 当决定是否要备份文件时，仅仅察看文件大小而不考虑文件时间<br>–modify-window=NUM 决定文件是否时间相同时使用的时间戳窗口，默认为0<br>-T –temp-dir=DIR 在DIR中创建临时文件<br>–compare-dest=DIR 同样比较DIR中的文件来决定是否需要备份<br>-P 等同于 –partial<br>–progress 显示备份过程<br>-z, –compress 对备份的文件在传输时进行压缩处理<br>–exclude=PATTERN 指定排除不需要传输的文件模式<br>–include=PATTERN 指定不排除而需要传输的文件模式<br>–exclude-from=FILE 排除FILE中指定模式的文件<br>–include-from=FILE 不排除FILE指定模式匹配的文件<br>–version 打印版本信息<br>–address 绑定到特定的地址<br>–config=FILE 指定其他的配置文件，不使用默认的rsyncd.conf文件<br>–port=PORT 指定其他的rsync服务端口<br>–blocking-io 对远程shell使用阻塞IO<br>-stats 给出某些文件的传输状态<br>–progress 在传输时现实传输过程<br>–log-format=formAT 指定日志文件格式<br>–password-file=FILE 从FILE中得到密码<br>–bwlimit=KBPS 限制I/O带宽，KBytes per second<br>-h, –help 显示帮助信息</p>\n<h3 id=\"部分错误的解决办法\"><a href=\"#部分错误的解决办法\" class=\"headerlink\" title=\"部分错误的解决办法\"></a>部分错误的解决办法</h3><p>1.’rsync’ 不是内部或外部命令，也不是可运行的程序或批处理文件。<br>加环境变量 path = C:\\Program Files (x86)\\cwRsync\\bin 2.rsync: failed to connect to 192.168.1.82: Connection timed out (116) rsync error: error in socket IO (code 10) at clientserver.c(122) [Receiver=3.0.7]<br>网络通畅，服务器端允许访问端口 873 3.@ERROR: invalid uid nobody<br>rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]<br>指定uid gid<br>uid = 0<br>gid = 0 4.@ERROR: chdir failed<br>rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]<br>path目录配置的正确，得存在<br>解决：服务器端同步目录没有权限，cwrsync默认用户是Svcwrsync。为同步目录添加用户Svcwrsync权限。<br>也可以通过 菜单–cwRsyncServer–02. Prep a Dir for Upload 配置目录权限 除完全控制和特殊权限外的所有权限 5.@ERROR: auth failed on module test<br>rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]<br>客户端设置<br>a.在命令上要指定好用户名<br>b.密码文件只写密码<br>rsyncd.secrets文件<br>rsyncpass<br>c.用户名密码都要正确 6.Unexpected local arg: /cygdrive/d/rsyncBackup<br>If arg is a remote file/dir, prefix it with a colon (:).<br>rsync error: syntax or usage error (code 1) at main.c(1218) [Receiver=3.0.7]<br>不一定是这个路径有问题，可能是–password-file路径中有空格，服务器端没问题，客户端好像不行 7.password file must be owned by root when running as root<br>continuing without password file<br>Password:<br>设置密码访问权限chown.exe可从服务器端拷贝过来<br>chmod -c 600 /cygdrive/c/etc/rsyncd.secrets<br>chown administrator /cygdrive/c/etc/rsyncd.secrets<br>服务器端不设也可以 8.当出现rsync: chown “” failed: Invalid argument (22)错误时，是因为参数中有o，即保留文件的owner信息，而window服务端无法完成chown操作，解决办法是去掉参数o。另外有些可能还会出现rsync: chgrp “” failed: Invalid argument (22)，原因类似，只要去掉参数中的g即可。</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"测试环境\"><a href=\"#测试环境\" class=\"headerlink\" title=\"测试环境\"></a>测试环境</h3><p>服务端安装 WIN2008R2 ip:192.168.0.160<br>客户端安装 WIN2003 ip:192.168.0.206</p>\n<h3 id=\"程序下载\"><a href=\"#程序下载\" class=\"headerlink\" title=\"程序下载\"></a>程序下载</h3><p>新版已经开始收费，这里使用旧版4.0.5,百度网盘下载<a href=\"http://pan.baidu.com/s/1kTNyk1h\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1kTNyk1h</a></p>\n<h3 id=\"服务端安装\"><a href=\"#服务端安装\" class=\"headerlink\" title=\"服务端安装\"></a>服务端安装</h3><p><img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync.png\" alt> 一路直接下一步，这里会创建一个用户，创建的默认密码可以不需要修改，直接下一步。 <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync1.png\" alt> 创建的用户 <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync2.png\" alt> 创建的服务改为自动启动</p>\n<h3 id=\"客户端安装\"><a href=\"#客户端安装\" class=\"headerlink\" title=\"客户端安装\"></a>客户端安装</h3><p>一路下一步直到完成。</p>\n<h3 id=\"配置服务端\"><a href=\"#配置服务端\" class=\"headerlink\" title=\"配置服务端\"></a>配置服务端</h3><pre><code>use chroot = false\n# 不验证用户密码\nstrict modes = false\nlock file = rsyncd.lock \nhosts allow = 192.168.0.206\nmax connections = 5\n# 默认端口\nport = 873\n\n# 指定匿名访问\nuid = 0\ngid = 0\n\n\nlog file = rsyncd.log\n\n# Module definitions\n# Remember cygwin naming conventions : c:\\work becomes /cygdrive/c/work\n\n[web]\npath = /cygdrive/C/WEB\n# 下面两行是配置用户名密码的\n# auth users = dbbackuper\n# secrets file = /cygdrive/e/Setting/Rsync/rsync_db.ps\n# 只允许客户端下载，不允许客户端上传\nread only = true\ntransfer logging = yes</code></pre><p>防火墙设置允许配置的端口通过<br>查看端口配置是否错误</p>\n<pre><code>telnet 192.168.0.160 873  \n@RSYNCD: 30.0</code></pre><p>服务器端配置测试文件目录 <img src=\"http://7xq3ry.com1.z0.glb.clouddn.com/cwrsync3.png\" alt> 其中targetDir为联接文件</p>\n<pre><code>C:\\&gt;mklink /J WEB\\targetDir\\ source\\\n为 WEB\\targetDir\\ &lt;&lt;===&gt;&gt; source\\ 创建的联接</code></pre><h3 id=\"配置客户端\"><a href=\"#配置客户端\" class=\"headerlink\" title=\"配置客户端\"></a>配置客户端</h3><p>在安装目录下使用如下命令</p>\n<pre><code>C:\\Program Files\\cwRsync\\bin&gt;rsync --port=873 -vzrtopg --progress --delete 192.168.0.160::web /cygdrive/C/WEB\nreceiving incremental file list\nskipping non-regular file &quot;targetDir&quot;\n./\nTEST4/\ntest3/\n\nsent 39 bytes  received 163 bytes  134.67 bytes/sec\ntotal size is 19  speedup is 0.09</code></pre><p>查看客户端文件目录</p>\n<pre><code>test3\nTEST4</code></pre><p>提示skipping non-regular file ‘targetDir’忽略软链接解决办法<br>参数-L:–copy-links 像对待常规文件一样处理软链结</p>\n<pre><code>C:\\Program Files\\cwRsync\\bin&gt;rsync --port=873 -vzrtopgL --progress --delete 192.\n168.0.160::web /cygdrive/C/WEB\nreceiving incremental file list\ndeleting test5/adda.txt\ndeleting test5/\n./\nTEST4/\ntargetDir/\ntargetDir/HAFA/\ntargetDir/pdf/\ntargetDir/pdf/TARGE.txt\n           0 100%    0.00kB/s    0:00:00 (xfer#1, to-check=1/8)\ntest3/\n\nsent 70 bytes  received 272 bytes  97.71 bytes/sec\ntotal size is 0  speedup is 0.00</code></pre><h3 id=\"实现客户端定时任务\"><a href=\"#实现客户端定时任务\" class=\"headerlink\" title=\"实现客户端定时任务\"></a>实现客户端定时任务</h3><p>1，要添加环境变量到系统中<br>2，上传脚本文件到客户端sync_client.bat</p>\n<pre><code>rsync --port=873 -vzrtopgL --progress --delete 192.168.0.160::web /cygdrive/C/WEB</code></pre><p>3,在系统中添加定时任务，并指定更新时间</p>\n<h3 id=\"具体参数详解\"><a href=\"#具体参数详解\" class=\"headerlink\" title=\"具体参数详解\"></a>具体参数详解</h3><p>rsync参数的具体解释如下： -v, –verbose 详细模式输出<br>-q, –quiet 精简输出模式<br>-c, –checksum 打开校验开关，强制对文件传输进行校验<br>-a, –archive 归档模式，表示以递归方式传输文件，并保持所有文件属性，等于-rlptgoD<br>-r, –recursive 对子目录以递归模式处理<br>-R, –relative 使用相对路径信息<br>-b, –backup 创建备份，也就是对于目的已经存在有同样的文件名时，将老的文件重新命名为<del>filename。可以使用–suffix选项来指定不同的备份文件前缀。<br>–backup-dir 将备份文件(如</del>filename)存放在在目录下。<br>-suffix=SUFFIX 定义备份文件前缀<br>-u, –update 仅仅进行更新，也就是跳过所有已经存在于DST，并且文件时间晚于要备份的文件。(不覆盖更新的文件)<br>-l, –links 保留软链结<br>-L, –copy-links 想对待常规文件一样处理软链结<br>–copy-unsafe-links 仅仅拷贝指向SRC路径目录树以外的链结<br>–safe-links 忽略指向SRC路径目录树以外的链结<br>-H, –hard-links 保留硬链结<br>-p, –perms 保持文件权限<br>-o, –owner 保持文件属主信息<br>-g, –group 保持文件属组信息<br>-D, –devices 保持设备文件信息<br>-t, –times 保持文件时间信息<br>-S, –sparse 对稀疏文件进行特殊处理以节省DST的空间<br>-n, –dry-run现实哪些文件将被传输<br>-W, –whole-file 拷贝文件，不进行增量检测<br>-x, –one-file-system 不要跨越文件系统边界<br>-B, –block-size=SIZE 检验算法使用的块尺寸，默认是700字节<br>-e, –rsh=COMMAND 指定使用rsh、ssh方式进行数据同步<br>–rsync-path=PATH 指定远程服务器上的rsync命令所在路径信息<br>-C, –cvs-exclude 使用和CVS一样的方法自动忽略文件，用来排除那些不希望传输的文件<br>–existing 仅仅更新那些已经存在于DST的文件，而不备份那些新创建的文件<br>–delete 删除那些DST中SRC没有的文件<br>–delete-excluded 同样删除接收端那些被该选项指定排除的文件<br>–delete-after 传输结束以后再删除<br>–ignore-errors 及时出现IO错误也进行删除<br>–max-delete=NUM 最多删除NUM个文件<br>–partial 保留那些因故没有完全传输的文件，以是加快随后的再次传输<br>–force 强制删除目录，即使不为空<br>–numeric-ids 不将数字的用户和组ID匹配为用户名和组名<br>–timeout=TIME IP超时时间，单位为秒<br>-I, –ignore-times 不跳过那些有同样的时间和长度的文件<br>–size-only 当决定是否要备份文件时，仅仅察看文件大小而不考虑文件时间<br>–modify-window=NUM 决定文件是否时间相同时使用的时间戳窗口，默认为0<br>-T –temp-dir=DIR 在DIR中创建临时文件<br>–compare-dest=DIR 同样比较DIR中的文件来决定是否需要备份<br>-P 等同于 –partial<br>–progress 显示备份过程<br>-z, –compress 对备份的文件在传输时进行压缩处理<br>–exclude=PATTERN 指定排除不需要传输的文件模式<br>–include=PATTERN 指定不排除而需要传输的文件模式<br>–exclude-from=FILE 排除FILE中指定模式的文件<br>–include-from=FILE 不排除FILE指定模式匹配的文件<br>–version 打印版本信息<br>–address 绑定到特定的地址<br>–config=FILE 指定其他的配置文件，不使用默认的rsyncd.conf文件<br>–port=PORT 指定其他的rsync服务端口<br>–blocking-io 对远程shell使用阻塞IO<br>-stats 给出某些文件的传输状态<br>–progress 在传输时现实传输过程<br>–log-format=formAT 指定日志文件格式<br>–password-file=FILE 从FILE中得到密码<br>–bwlimit=KBPS 限制I/O带宽，KBytes per second<br>-h, –help 显示帮助信息</p>\n<h3 id=\"部分错误的解决办法\"><a href=\"#部分错误的解决办法\" class=\"headerlink\" title=\"部分错误的解决办法\"></a>部分错误的解决办法</h3><p>1.’rsync’ 不是内部或外部命令，也不是可运行的程序或批处理文件。<br>加环境变量 path = C:\\Program Files (x86)\\cwRsync\\bin 2.rsync: failed to connect to 192.168.1.82: Connection timed out (116) rsync error: error in socket IO (code 10) at clientserver.c(122) [Receiver=3.0.7]<br>网络通畅，服务器端允许访问端口 873 3.@ERROR: invalid uid nobody<br>rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]<br>指定uid gid<br>uid = 0<br>gid = 0 4.@ERROR: chdir failed<br>rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]<br>path目录配置的正确，得存在<br>解决：服务器端同步目录没有权限，cwrsync默认用户是Svcwrsync。为同步目录添加用户Svcwrsync权限。<br>也可以通过 菜单–cwRsyncServer–02. Prep a Dir for Upload 配置目录权限 除完全控制和特殊权限外的所有权限 5.@ERROR: auth failed on module test<br>rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]<br>客户端设置<br>a.在命令上要指定好用户名<br>b.密码文件只写密码<br>rsyncd.secrets文件<br>rsyncpass<br>c.用户名密码都要正确 6.Unexpected local arg: /cygdrive/d/rsyncBackup<br>If arg is a remote file/dir, prefix it with a colon (:).<br>rsync error: syntax or usage error (code 1) at main.c(1218) [Receiver=3.0.7]<br>不一定是这个路径有问题，可能是–password-file路径中有空格，服务器端没问题，客户端好像不行 7.password file must be owned by root when running as root<br>continuing without password file<br>Password:<br>设置密码访问权限chown.exe可从服务器端拷贝过来<br>chmod -c 600 /cygdrive/c/etc/rsyncd.secrets<br>chown administrator /cygdrive/c/etc/rsyncd.secrets<br>服务器端不设也可以 8.当出现rsync: chown “” failed: Invalid argument (22)错误时，是因为参数中有o，即保留文件的owner信息，而window服务端无法完成chown操作，解决办法是去掉参数o。另外有些可能还会出现rsync: chgrp “” failed: Invalid argument (22)，原因类似，只要去掉参数中的g即可。</p>\n"},{"title":"Linux开发环境常用软件","url":"36.html","id":"36","comments":0,"date":"2016-11-09T02:58:19.000Z","_content":"\n#### 显示电脑硬件信息\n\n    $ sudo add-apt-repository ppa:dawidd0811/neofetch\n    $ sudo apt-get update\n    $ sudo apt-get install neofetch\n    neofetch\n    \n\n#### 安装独立显卡驱动\n\nhttps://blog.csdn.net/ghw15221836342/article/details/79571559\n\n    # 驱动版本查询   https://www.nvidia.com/Download/index.aspx?lang=en-us\n    # 安装\n    sudo add-apt-repository ppa:graphics-drivers/ppa  \n    sudo apt-get update  \n    sudo apt-get install nvidia-390 #此处要根据上面查询到的版本适当更改\n    sudo apt-get install mesa-common-dev  \n    sudo apt-get install freeglut3-de\n    # 测试\n    nvidia-smi  #若出现电脑GPU列表，即安装成功\n    或者\n    nvidia-settings #显示你的显卡信息\n    ````\n    \n    \n    #### Chrome浏览器\n    下载地址 [百度云盘](http://pan.baidu.com/s/1hq0Nom4)\n    \n    #### 配置SS\n    \n\n安装\n==\n\napt-get install python-pip pip install s\\_h\\_a\\_d\\_o\\_w\\_s\\_o\\_c\\_k\\_s\n\n启动\n==\n\nsslocal -s server\\_ip -p server\\_port -l 1080 -k password -t 600 -m aes-256-cfb\n\n简写\n==\n\nsslocal -s ip -p port -k \"password\"\n\n    开机启动配置  \n    在/home下新建文件ss.sh脚本\n    \n\n#!/bin/bash #文件名:ss.sh sslocal -s ip -p port -k \"password\"\n\n    编辑开机启动文件\n    \n\nsudo vim /etc/rc.local ```\n\n    # 最后加入以下内容\n    nohup bash /home/ss.sh>/home/ss.txt &\n    \n\n代理设置\n\n    service： 127.0.0.1\n    port ： 1080\n    type： socks5\n    \n\n#### 配置proxychains\n\n    # 安装\n    sudo apt install proxychains\n    sudo vim /etc/proxychains.conf\n    ~ socks5 127.0.0.1 1080  # 最后一行加入socks代理\n    # 测试\n    proxychains wget https://www.google.com\n    \n\n#### wine qq（现在推荐docker安装qq）\n\n安装wine1.7以上版本  \n安装WineQQ7.8-20151109-Longene.deb版本  \n下载[网盘](https://pan.baidu.com/s/1bpLn0vl)\n\n#### elinks 纯文本浏览器\n\n    sudo apt-get install elinks   # 安装\n    \n\n    elinks www.zhuohc.com  # 使用\n    \n\n#### unzip / zip\n\n解决中文乱码\n\n    unzip -O CP936 xxx.zip\n    \n\n解压到指定目录\n\n    unzip -O xxx.zip -d xxx/\n    \n\n压缩文件\n\n    zip -r yasuo.zip abc.txt dir1\n    \n\n#### wps office办公\n\n显示字体确实错误 [下载字体](https://pan.baidu.com/s/1bpLn0vl)  \n将字体复制到linux字体中\n\n    sudo cp * /usr/share/fonts\n    \n\n生成字体索引信息\n\n    sudo mkfontscale\n    \n    sudo mkfontdir\n    \n\n更新字体缓存\n\n    sudo fc-cache\n    \n\n中文无法输入\n\n    $ vi /usr/bin/wps  # word文档\n    \n\n    #!/bin/bash\n    export XMODIFIERS=\"@im=fcitx\"  # 添加的内容  \n    export QT_IM_MODULE=\"fcitx\"     # 添加的内容    \n    gOpt=\n    #gOptExt=-multiply\n    gTemplateExt=(\"wpt\" \"dot\" \"dotx\")\n    \n\n    $ vi /usr/bin/et   # excel表格\n    \n\n    #!/bin/bash\n    export XMODIFIERS=\"@im=fcitx\"  # 添加的内容  \n    export QT_IM_MODULE=\"fcitx\"  # 添加的内容  \n    gOpt=\n    #gOptExt=-multiply\n    \n\n#### 输入法\n\n系统自带或者sougou输入法 ， 倬彼昊天系列皮肤\n\n#### 截屏\n\n系统设置>键盘>自定义快捷键>+>  \n名称填screenshot  \n命令\n\n    gnome-screenshot -a\n    \n\n在disabled修改快捷键\n\n#### 下载\n\n安装uget\n\n    sudo add-apt-repository ppa:plushuang-tw/uget-stable \n    sudo apt-get update \n    sudo apt-get install uget\n    \n\n安装aria2\n\n    sudo add-apt-repository ppa:t-tujikawa/ppa \n    sudo apt-get update \n    sudo apt-get install aria2\n    \n\n在uget gui里编辑插件，选择aria2\n\n#### 美化监视工具\n\n     sudo apt-get install conky  \n     sudo add-apt-repository ppa:teejee2008/ppa\n     sudo apt-get update\n     sudo apt-get install conky-manager\n     ```\n     显示桌面会自动隐藏conky的bug解决办法:  \n     编辑配置文件\n     ```\n     # own_window_type normal\n    own_window_type desktop\n    \n\n\\#### 快速搜索文件\n\n    sudo add-apt-repository ppa:synapse-core/testing\n    sudo apt-get update\n    sudo apt-get install synapse  \n    \n\n#### 卸载synapse\n\n    sudo apt-get remove synapse\n    \n\n#### 移除PPA\n\n    sudo apt-get install ppa-purge\n    sudo ppa-purge ppa:synapse-core/testing\n    \n\n#### 安装oh-my-zsh\n\n    # https://github.com/robbyrussell/oh-my-zsh\n    $ sudo apt-get install git\n    $ sudo apt-get install zsh\n    $ sh -c \"$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)\"\n    $ chsh -s /bin/zsh # 更改默认bash\n    //或:\n    $ chsh -s `which zsh`\n    $ sudo reboot\n    \n\n#### terminator 终端管理软件\n\n安装\n\n    sudo add-apt-repository ppa:gnome-terminator\n    sudo apt-get update\n    sudo apt-get install terminator\n    \n\n基本设置方法\n\n> 右键点击终端任意区域，选择首选项\n\n设置[solarized](https://github.com/ghuntley/terminator-solarized)配色（[参考](http://blog.codinglabs.org/articles/getting-started-with-ubuntu.html)）\n\n    cd ~/.config/terminator  \n    vim config\n    \n\n覆盖以下内容\n\n    [global_config]\n        title_transmit_bg_color = \"#d30102\"\n        focus = system\n        suppress_multiple_term_dialog = True\n    [keybindings]\n    [profiles]\n        [[default]]\n            palette = \"#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3\"\n            copy_on_selection = True\n            background_image = None\n            background_darkness = 0.95\n            background_type = transparent\n            use_system_font = False\n            cursor_color = \"#eee8d5\"\n            foreground_color = \"#839496\"\n            show_titlebar = False\n            font = Monospace 11\n            background_color = \"#002b36\"\n        [[solarized-dark]]\n            palette = \"#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3\"\n            background_color = \"#002b36\"\n            background_image = None\n            cursor_color = \"#eee8d5\"\n            foreground_color = \"#839496\"\n        [[solarized-light]]\n            palette = \"#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3\"\n            background_color = \"#fdf6e3\"\n            background_image = None\n            cursor_color = \"#002b36\"\n            foreground_color = \"#657b83\"\n    [layouts]\n        [[default]]\n            [[[child1]]]\n                type = Terminal\n                parent = window0\n                profile = default\n            [[[window0]]]\n                type = Window\n                parent = \"\"\n    [plugins]\n    \n\n以上配置后会修改配色方案，但是没有bright色  \n[dircolors-solarized](https://github.com/seebi/dircolors-solarized)项目提供了适合于solarized的dircolors配色方案，只要选择合适的方案使用就可以了。\n\n    curl https://raw.github.com/seebi/dircolors-solarized/master/dircolors.ansi-dark > ~/.dircolors\n    \n\n然后在~/.bashrc中加入如下配置：\n\n    # enable color support of ls and also add handy aliases\n    if [ -x /usr/bin/dircolors ]; then\n        test -r ~/.dircolors && eval \"$(dircolors -b ~/.dircolors)\" || eval \"$(dircolors -b)\"\n        alias ls='ls --color=auto'\n        #alias dir='dir --color=auto'\n        #alias vdir='vdir --color=auto'\n    \n        alias grep='grep --color=auto'\n        alias fgrep='fgrep --color=auto'\n        alias egrep='egrep --color=auto'\n    fi\n    \n    # some more ls aliases\n    alias ll='ls -alF'\n    alias la='ls -A'\n    alias l='ls -CF'\n    \n\n执行\n\n    source ~/.bashrc\n    \n\n#### tmux配合terminator使用\n\n安装\n\n    sudo apt-get install tmux\n    \n\n配置\n\n    touch .tmux.conf\n    \n\n配置内容和使用方法\n\n    # 设置前缀为Ctrl + x\n    set -g prefix C-x\n    # 解除Ctrl+b 与前缀的对应关系\n    unbind C-b\n    # 将r 设置为加载配置文件，并显示\"reloaded!\"信息\n    bind r source-file ~/.tmux.conf \\; display \"Reloaded!\"\n    \n    \n    \n    # copy-mode 将快捷键设置为vi 模式\n    setw -g mode-keys vi\n    \n    # tmux-powerline设置\n    set-option -g status on\n    set-option -g status-interval 2\n    set-option -g status-utf8 on\n    set-option -g status-justify \"centre\"\n    set-option -g status-left-length 60\n    set-option -g status-right-length 90\n    set-option -g status-left \"#(~/.tmux/tmux-powerline/powerline.sh left)\"\n    set-option -g status-right \"#(~/.tmux/tmux-powerline/powerline.sh right)\"\n    # 将窗口列表换成 powerline的风格\n    set-window-option -g window-status-current-format \"#[fg=colour235, bg=colour27]⮀#[fg=colour255, bg=colour27] #I ⮁ #W #[fg=colour27, bg=colour235]⮀\"\n    # 设置默认bash\n    set-option -g default-shell /bin/zsh\n    \n    \n    ########## 复制模式  ##########\n    \n    # copy mode 复制模式\n    # 'prefix +  [ '进入复制模式\n    # 按space 开始复制\n    # Enter退出复制模式\n    \n\n需要安装powerline插件\n\n    https://github.com/erikw/tmux-powerline\n    \n\n显示日期的星期\n\n    vim data_day.sh\n     # date +\"%a\"改成大写\n     date +\"%A\"\n    \n\npowerline字体安装查看 http://powerline.readthedocs.io/en/latest/installation/linux.html 在terminator配置自动启动turm\n\n    首选项->配置>命令>自定义命令  \n     ([[ -f \"$TMUX\" ]] && tmux -2 -S $TMUX) || (TMUX=\"\" tmux -2)\n    \n\n自动部署多窗口任务\n\n    touch ~/development.start\n    chmod +x development.start\n    \n\n    tmux has-session -t development\n    if [ $? != 0 ]\n    then\n        tmux new-session -s development -n editor -d\n        tmux send-keys -t development 'vim' C-m\n        tmux split-window -v -t development\n        tmux select-layout -t development main-horizontal\n        tmux new-window -n bash -t development\n        tmux new-window -n ssh -t development\n        tmux new-window -n mysql -t development\n        tmux new-window -n front-end -t development\n        tmux select-window -t development:1\n    fi\n    tmux attach -t development\n    \n\n执行文件\n\n    ~/development.start\n    \n\n#### Visual Studio Code\n\n通过官方PPA来安装Ubuntu Make\n\n    sudo add-apt-repository ppa:ubuntu-desktop/ubuntu-make\n    sudo apt-get update\n    sudo apt-get install ubuntu-make\n    \n\n安装Ubuntu Make完后，接着使用下列命令安装Visual Studio Code\n\n    umake web visual-studio-code\n    \n\n卸载命令\n\n    umake web visual-studio-code --remove\n    \n\n#### wine\n\n卸载wineqq\n\n    sudo dpkg -l | grep qq  # 找到安装包名称   \n    sudo dpkg -r wine-qq7.8-longeneteam # 卸载\n    \n\n#### curl http请求\n\n    curl \"http://www.baidu.com\" # 如果这里的URL指向的是一个文件或者一幅图都可以直接下载到本地  \n    curl -i \"http://www.baidu.com\" # 显示全部信息  \n    curl -l \"http://www.baidu.com\" # 只显示头部信息  \n    curl -v \"http://www.baidu.com\" # 显示get请求全过程解析    \n    curl -d \"param1=value1¶m2=value2\" \"http://www.baidu.com\" # post请求  \n    \n\n#### 安卓虚拟机genymotion\n\n前提必须安装virtualBox  \n下载地址: https://www.genymotion.com/download/  \n需要先注册,下载后执行\n\n    chmod +x genymotion-2.2.2_x64.bin\n    ./genymotion-2.2.2_x64.bin -d /home/user\n    \n\n执行home/user/genymotion/genymotion\n\n#### 安装为知笔记\n\n简易版本\n\n    http://ppa.launchpad.net/wiznote-team/ppa/ubuntu/pool/main/w/wiznote/\n    \n\n编译安装\n\n    http://www.wiz.cn/compile-client.html\n    \n\nchrome安装扩展\n\n    https://chrome.google.com/webstore/detail/wiznote-web-clipper/jfanfpmalehkemdiiebjljddhgojhfab/related?hl=zh-CN\n    \n\n#### 安装系统状态指示器\n\n    sudo add-apt-repository ppa:indicator-multiload/stable-daily\n    \n    sudo apt-get update\n    \n    sudo apt-get install indicator-multiload\n    \n\n#### 安装albert搜索框\n\n    sudo add-apt-repository ppa:noobslab/macbuntu\n    sudo apt-get update\n    sudo apt-get install albert\n    设置快捷键Ctrl+/ 样式NUMIX\n    \n\n#### 下载特殊文件\n\n    sudo apt-get install ktorrent\n    sudo apt-get install amule","source":"_posts/linux开发环境常用软件.md","raw":"---\ntitle: Linux开发环境常用软件\ntags:\n  - linux\n  - ubuntu\nurl: 36.html\nid: 36\ncomments: false\ncategories:\n  - 办公\n  - 运维\ndate: 2016-11-09 10:58:19\n---\n\n#### 显示电脑硬件信息\n\n    $ sudo add-apt-repository ppa:dawidd0811/neofetch\n    $ sudo apt-get update\n    $ sudo apt-get install neofetch\n    neofetch\n    \n\n#### 安装独立显卡驱动\n\nhttps://blog.csdn.net/ghw15221836342/article/details/79571559\n\n    # 驱动版本查询   https://www.nvidia.com/Download/index.aspx?lang=en-us\n    # 安装\n    sudo add-apt-repository ppa:graphics-drivers/ppa  \n    sudo apt-get update  \n    sudo apt-get install nvidia-390 #此处要根据上面查询到的版本适当更改\n    sudo apt-get install mesa-common-dev  \n    sudo apt-get install freeglut3-de\n    # 测试\n    nvidia-smi  #若出现电脑GPU列表，即安装成功\n    或者\n    nvidia-settings #显示你的显卡信息\n    ````\n    \n    \n    #### Chrome浏览器\n    下载地址 [百度云盘](http://pan.baidu.com/s/1hq0Nom4)\n    \n    #### 配置SS\n    \n\n安装\n==\n\napt-get install python-pip pip install s\\_h\\_a\\_d\\_o\\_w\\_s\\_o\\_c\\_k\\_s\n\n启动\n==\n\nsslocal -s server\\_ip -p server\\_port -l 1080 -k password -t 600 -m aes-256-cfb\n\n简写\n==\n\nsslocal -s ip -p port -k \"password\"\n\n    开机启动配置  \n    在/home下新建文件ss.sh脚本\n    \n\n#!/bin/bash #文件名:ss.sh sslocal -s ip -p port -k \"password\"\n\n    编辑开机启动文件\n    \n\nsudo vim /etc/rc.local ```\n\n    # 最后加入以下内容\n    nohup bash /home/ss.sh>/home/ss.txt &\n    \n\n代理设置\n\n    service： 127.0.0.1\n    port ： 1080\n    type： socks5\n    \n\n#### 配置proxychains\n\n    # 安装\n    sudo apt install proxychains\n    sudo vim /etc/proxychains.conf\n    ~ socks5 127.0.0.1 1080  # 最后一行加入socks代理\n    # 测试\n    proxychains wget https://www.google.com\n    \n\n#### wine qq（现在推荐docker安装qq）\n\n安装wine1.7以上版本  \n安装WineQQ7.8-20151109-Longene.deb版本  \n下载[网盘](https://pan.baidu.com/s/1bpLn0vl)\n\n#### elinks 纯文本浏览器\n\n    sudo apt-get install elinks   # 安装\n    \n\n    elinks www.zhuohc.com  # 使用\n    \n\n#### unzip / zip\n\n解决中文乱码\n\n    unzip -O CP936 xxx.zip\n    \n\n解压到指定目录\n\n    unzip -O xxx.zip -d xxx/\n    \n\n压缩文件\n\n    zip -r yasuo.zip abc.txt dir1\n    \n\n#### wps office办公\n\n显示字体确实错误 [下载字体](https://pan.baidu.com/s/1bpLn0vl)  \n将字体复制到linux字体中\n\n    sudo cp * /usr/share/fonts\n    \n\n生成字体索引信息\n\n    sudo mkfontscale\n    \n    sudo mkfontdir\n    \n\n更新字体缓存\n\n    sudo fc-cache\n    \n\n中文无法输入\n\n    $ vi /usr/bin/wps  # word文档\n    \n\n    #!/bin/bash\n    export XMODIFIERS=\"@im=fcitx\"  # 添加的内容  \n    export QT_IM_MODULE=\"fcitx\"     # 添加的内容    \n    gOpt=\n    #gOptExt=-multiply\n    gTemplateExt=(\"wpt\" \"dot\" \"dotx\")\n    \n\n    $ vi /usr/bin/et   # excel表格\n    \n\n    #!/bin/bash\n    export XMODIFIERS=\"@im=fcitx\"  # 添加的内容  \n    export QT_IM_MODULE=\"fcitx\"  # 添加的内容  \n    gOpt=\n    #gOptExt=-multiply\n    \n\n#### 输入法\n\n系统自带或者sougou输入法 ， 倬彼昊天系列皮肤\n\n#### 截屏\n\n系统设置>键盘>自定义快捷键>+>  \n名称填screenshot  \n命令\n\n    gnome-screenshot -a\n    \n\n在disabled修改快捷键\n\n#### 下载\n\n安装uget\n\n    sudo add-apt-repository ppa:plushuang-tw/uget-stable \n    sudo apt-get update \n    sudo apt-get install uget\n    \n\n安装aria2\n\n    sudo add-apt-repository ppa:t-tujikawa/ppa \n    sudo apt-get update \n    sudo apt-get install aria2\n    \n\n在uget gui里编辑插件，选择aria2\n\n#### 美化监视工具\n\n     sudo apt-get install conky  \n     sudo add-apt-repository ppa:teejee2008/ppa\n     sudo apt-get update\n     sudo apt-get install conky-manager\n     ```\n     显示桌面会自动隐藏conky的bug解决办法:  \n     编辑配置文件\n     ```\n     # own_window_type normal\n    own_window_type desktop\n    \n\n\\#### 快速搜索文件\n\n    sudo add-apt-repository ppa:synapse-core/testing\n    sudo apt-get update\n    sudo apt-get install synapse  \n    \n\n#### 卸载synapse\n\n    sudo apt-get remove synapse\n    \n\n#### 移除PPA\n\n    sudo apt-get install ppa-purge\n    sudo ppa-purge ppa:synapse-core/testing\n    \n\n#### 安装oh-my-zsh\n\n    # https://github.com/robbyrussell/oh-my-zsh\n    $ sudo apt-get install git\n    $ sudo apt-get install zsh\n    $ sh -c \"$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)\"\n    $ chsh -s /bin/zsh # 更改默认bash\n    //或:\n    $ chsh -s `which zsh`\n    $ sudo reboot\n    \n\n#### terminator 终端管理软件\n\n安装\n\n    sudo add-apt-repository ppa:gnome-terminator\n    sudo apt-get update\n    sudo apt-get install terminator\n    \n\n基本设置方法\n\n> 右键点击终端任意区域，选择首选项\n\n设置[solarized](https://github.com/ghuntley/terminator-solarized)配色（[参考](http://blog.codinglabs.org/articles/getting-started-with-ubuntu.html)）\n\n    cd ~/.config/terminator  \n    vim config\n    \n\n覆盖以下内容\n\n    [global_config]\n        title_transmit_bg_color = \"#d30102\"\n        focus = system\n        suppress_multiple_term_dialog = True\n    [keybindings]\n    [profiles]\n        [[default]]\n            palette = \"#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3\"\n            copy_on_selection = True\n            background_image = None\n            background_darkness = 0.95\n            background_type = transparent\n            use_system_font = False\n            cursor_color = \"#eee8d5\"\n            foreground_color = \"#839496\"\n            show_titlebar = False\n            font = Monospace 11\n            background_color = \"#002b36\"\n        [[solarized-dark]]\n            palette = \"#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3\"\n            background_color = \"#002b36\"\n            background_image = None\n            cursor_color = \"#eee8d5\"\n            foreground_color = \"#839496\"\n        [[solarized-light]]\n            palette = \"#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3\"\n            background_color = \"#fdf6e3\"\n            background_image = None\n            cursor_color = \"#002b36\"\n            foreground_color = \"#657b83\"\n    [layouts]\n        [[default]]\n            [[[child1]]]\n                type = Terminal\n                parent = window0\n                profile = default\n            [[[window0]]]\n                type = Window\n                parent = \"\"\n    [plugins]\n    \n\n以上配置后会修改配色方案，但是没有bright色  \n[dircolors-solarized](https://github.com/seebi/dircolors-solarized)项目提供了适合于solarized的dircolors配色方案，只要选择合适的方案使用就可以了。\n\n    curl https://raw.github.com/seebi/dircolors-solarized/master/dircolors.ansi-dark > ~/.dircolors\n    \n\n然后在~/.bashrc中加入如下配置：\n\n    # enable color support of ls and also add handy aliases\n    if [ -x /usr/bin/dircolors ]; then\n        test -r ~/.dircolors && eval \"$(dircolors -b ~/.dircolors)\" || eval \"$(dircolors -b)\"\n        alias ls='ls --color=auto'\n        #alias dir='dir --color=auto'\n        #alias vdir='vdir --color=auto'\n    \n        alias grep='grep --color=auto'\n        alias fgrep='fgrep --color=auto'\n        alias egrep='egrep --color=auto'\n    fi\n    \n    # some more ls aliases\n    alias ll='ls -alF'\n    alias la='ls -A'\n    alias l='ls -CF'\n    \n\n执行\n\n    source ~/.bashrc\n    \n\n#### tmux配合terminator使用\n\n安装\n\n    sudo apt-get install tmux\n    \n\n配置\n\n    touch .tmux.conf\n    \n\n配置内容和使用方法\n\n    # 设置前缀为Ctrl + x\n    set -g prefix C-x\n    # 解除Ctrl+b 与前缀的对应关系\n    unbind C-b\n    # 将r 设置为加载配置文件，并显示\"reloaded!\"信息\n    bind r source-file ~/.tmux.conf \\; display \"Reloaded!\"\n    \n    \n    \n    # copy-mode 将快捷键设置为vi 模式\n    setw -g mode-keys vi\n    \n    # tmux-powerline设置\n    set-option -g status on\n    set-option -g status-interval 2\n    set-option -g status-utf8 on\n    set-option -g status-justify \"centre\"\n    set-option -g status-left-length 60\n    set-option -g status-right-length 90\n    set-option -g status-left \"#(~/.tmux/tmux-powerline/powerline.sh left)\"\n    set-option -g status-right \"#(~/.tmux/tmux-powerline/powerline.sh right)\"\n    # 将窗口列表换成 powerline的风格\n    set-window-option -g window-status-current-format \"#[fg=colour235, bg=colour27]⮀#[fg=colour255, bg=colour27] #I ⮁ #W #[fg=colour27, bg=colour235]⮀\"\n    # 设置默认bash\n    set-option -g default-shell /bin/zsh\n    \n    \n    ########## 复制模式  ##########\n    \n    # copy mode 复制模式\n    # 'prefix +  [ '进入复制模式\n    # 按space 开始复制\n    # Enter退出复制模式\n    \n\n需要安装powerline插件\n\n    https://github.com/erikw/tmux-powerline\n    \n\n显示日期的星期\n\n    vim data_day.sh\n     # date +\"%a\"改成大写\n     date +\"%A\"\n    \n\npowerline字体安装查看 http://powerline.readthedocs.io/en/latest/installation/linux.html 在terminator配置自动启动turm\n\n    首选项->配置>命令>自定义命令  \n     ([[ -f \"$TMUX\" ]] && tmux -2 -S $TMUX) || (TMUX=\"\" tmux -2)\n    \n\n自动部署多窗口任务\n\n    touch ~/development.start\n    chmod +x development.start\n    \n\n    tmux has-session -t development\n    if [ $? != 0 ]\n    then\n        tmux new-session -s development -n editor -d\n        tmux send-keys -t development 'vim' C-m\n        tmux split-window -v -t development\n        tmux select-layout -t development main-horizontal\n        tmux new-window -n bash -t development\n        tmux new-window -n ssh -t development\n        tmux new-window -n mysql -t development\n        tmux new-window -n front-end -t development\n        tmux select-window -t development:1\n    fi\n    tmux attach -t development\n    \n\n执行文件\n\n    ~/development.start\n    \n\n#### Visual Studio Code\n\n通过官方PPA来安装Ubuntu Make\n\n    sudo add-apt-repository ppa:ubuntu-desktop/ubuntu-make\n    sudo apt-get update\n    sudo apt-get install ubuntu-make\n    \n\n安装Ubuntu Make完后，接着使用下列命令安装Visual Studio Code\n\n    umake web visual-studio-code\n    \n\n卸载命令\n\n    umake web visual-studio-code --remove\n    \n\n#### wine\n\n卸载wineqq\n\n    sudo dpkg -l | grep qq  # 找到安装包名称   \n    sudo dpkg -r wine-qq7.8-longeneteam # 卸载\n    \n\n#### curl http请求\n\n    curl \"http://www.baidu.com\" # 如果这里的URL指向的是一个文件或者一幅图都可以直接下载到本地  \n    curl -i \"http://www.baidu.com\" # 显示全部信息  \n    curl -l \"http://www.baidu.com\" # 只显示头部信息  \n    curl -v \"http://www.baidu.com\" # 显示get请求全过程解析    \n    curl -d \"param1=value1¶m2=value2\" \"http://www.baidu.com\" # post请求  \n    \n\n#### 安卓虚拟机genymotion\n\n前提必须安装virtualBox  \n下载地址: https://www.genymotion.com/download/  \n需要先注册,下载后执行\n\n    chmod +x genymotion-2.2.2_x64.bin\n    ./genymotion-2.2.2_x64.bin -d /home/user\n    \n\n执行home/user/genymotion/genymotion\n\n#### 安装为知笔记\n\n简易版本\n\n    http://ppa.launchpad.net/wiznote-team/ppa/ubuntu/pool/main/w/wiznote/\n    \n\n编译安装\n\n    http://www.wiz.cn/compile-client.html\n    \n\nchrome安装扩展\n\n    https://chrome.google.com/webstore/detail/wiznote-web-clipper/jfanfpmalehkemdiiebjljddhgojhfab/related?hl=zh-CN\n    \n\n#### 安装系统状态指示器\n\n    sudo add-apt-repository ppa:indicator-multiload/stable-daily\n    \n    sudo apt-get update\n    \n    sudo apt-get install indicator-multiload\n    \n\n#### 安装albert搜索框\n\n    sudo add-apt-repository ppa:noobslab/macbuntu\n    sudo apt-get update\n    sudo apt-get install albert\n    设置快捷键Ctrl+/ 样式NUMIX\n    \n\n#### 下载特殊文件\n\n    sudo apt-get install ktorrent\n    sudo apt-get install amule","slug":"linux开发环境常用软件","published":1,"updated":"2019-07-23T05:51:43.847Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5py004g9ka47srf7u61","content":"<h4 id=\"显示电脑硬件信息\"><a href=\"#显示电脑硬件信息\" class=\"headerlink\" title=\"显示电脑硬件信息\"></a>显示电脑硬件信息</h4><pre><code>$ sudo add-apt-repository ppa:dawidd0811/neofetch\n$ sudo apt-get update\n$ sudo apt-get install neofetch\nneofetch</code></pre><h4 id=\"安装独立显卡驱动\"><a href=\"#安装独立显卡驱动\" class=\"headerlink\" title=\"安装独立显卡驱动\"></a>安装独立显卡驱动</h4><p><a href=\"https://blog.csdn.net/ghw15221836342/article/details/79571559\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/ghw15221836342/article/details/79571559</a></p>\n<pre><code># 驱动版本查询   https://www.nvidia.com/Download/index.aspx?lang=en-us\n# 安装\nsudo add-apt-repository ppa:graphics-drivers/ppa  \nsudo apt-get update  \nsudo apt-get install nvidia-390 #此处要根据上面查询到的版本适当更改\nsudo apt-get install mesa-common-dev  \nsudo apt-get install freeglut3-de\n# 测试\nnvidia-smi  #若出现电脑GPU列表，即安装成功\n或者\nnvidia-settings #显示你的显卡信息\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    #### Chrome浏览器</span><br><span class=\"line\">    下载地址 [百度云盘](http://pan.baidu.com/s/1hq0Nom4)</span><br><span class=\"line\">    </span><br><span class=\"line\">    #### 配置SS</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">安装</span><br><span class=\"line\">==</span><br><span class=\"line\"></span><br><span class=\"line\">apt-get install python-pip pip install s\\_h\\_a\\_d\\_o\\_w\\_s\\_o\\_c\\_k\\_s</span><br><span class=\"line\"></span><br><span class=\"line\">启动</span><br><span class=\"line\">==</span><br><span class=\"line\"></span><br><span class=\"line\">sslocal -s server\\_ip -p server\\_port -l 1080 -k password -t 600 -m aes-256-cfb</span><br><span class=\"line\"></span><br><span class=\"line\">简写</span><br><span class=\"line\">==</span><br><span class=\"line\"></span><br><span class=\"line\">sslocal -s ip -p port -k &quot;password&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">    开机启动配置  </span><br><span class=\"line\">    在/home下新建文件ss.sh脚本</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">#!/bin/bash #文件名:ss.sh sslocal -s ip -p port -k &quot;password&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">    编辑开机启动文件</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">sudo vim /etc/rc.local</span><br></pre></td></tr></table></figure>\n\n# 最后加入以下内容\nnohup bash /home/ss.sh&gt;/home/ss.txt &amp;</code></pre><p>代理设置</p>\n<pre><code>service： 127.0.0.1\nport ： 1080\ntype： socks5</code></pre><h4 id=\"配置proxychains\"><a href=\"#配置proxychains\" class=\"headerlink\" title=\"配置proxychains\"></a>配置proxychains</h4><pre><code># 安装\nsudo apt install proxychains\nsudo vim /etc/proxychains.conf\n~ socks5 127.0.0.1 1080  # 最后一行加入socks代理\n# 测试\nproxychains wget https://www.google.com</code></pre><h4 id=\"wine-qq（现在推荐docker安装qq）\"><a href=\"#wine-qq（现在推荐docker安装qq）\" class=\"headerlink\" title=\"wine qq（现在推荐docker安装qq）\"></a>wine qq（现在推荐docker安装qq）</h4><p>安装wine1.7以上版本<br>安装WineQQ7.8-20151109-Longene.deb版本<br>下载<a href=\"https://pan.baidu.com/s/1bpLn0vl\" target=\"_blank\" rel=\"noopener\">网盘</a></p>\n<h4 id=\"elinks-纯文本浏览器\"><a href=\"#elinks-纯文本浏览器\" class=\"headerlink\" title=\"elinks 纯文本浏览器\"></a>elinks 纯文本浏览器</h4><pre><code>sudo apt-get install elinks   # 安装\n\n\nelinks www.zhuohc.com  # 使用</code></pre><h4 id=\"unzip-zip\"><a href=\"#unzip-zip\" class=\"headerlink\" title=\"unzip / zip\"></a>unzip / zip</h4><p>解决中文乱码</p>\n<pre><code>unzip -O CP936 xxx.zip</code></pre><p>解压到指定目录</p>\n<pre><code>unzip -O xxx.zip -d xxx/</code></pre><p>压缩文件</p>\n<pre><code>zip -r yasuo.zip abc.txt dir1</code></pre><h4 id=\"wps-office办公\"><a href=\"#wps-office办公\" class=\"headerlink\" title=\"wps office办公\"></a>wps office办公</h4><p>显示字体确实错误 <a href=\"https://pan.baidu.com/s/1bpLn0vl\" target=\"_blank\" rel=\"noopener\">下载字体</a><br>将字体复制到linux字体中</p>\n<pre><code>sudo cp * /usr/share/fonts</code></pre><p>生成字体索引信息</p>\n<pre><code>sudo mkfontscale\n\nsudo mkfontdir</code></pre><p>更新字体缓存</p>\n<pre><code>sudo fc-cache</code></pre><p>中文无法输入</p>\n<pre><code>$ vi /usr/bin/wps  # word文档\n\n\n#!/bin/bash\nexport XMODIFIERS=&quot;@im=fcitx&quot;  # 添加的内容  \nexport QT_IM_MODULE=&quot;fcitx&quot;     # 添加的内容    \ngOpt=\n#gOptExt=-multiply\ngTemplateExt=(&quot;wpt&quot; &quot;dot&quot; &quot;dotx&quot;)\n\n\n$ vi /usr/bin/et   # excel表格\n\n\n#!/bin/bash\nexport XMODIFIERS=&quot;@im=fcitx&quot;  # 添加的内容  \nexport QT_IM_MODULE=&quot;fcitx&quot;  # 添加的内容  \ngOpt=\n#gOptExt=-multiply</code></pre><h4 id=\"输入法\"><a href=\"#输入法\" class=\"headerlink\" title=\"输入法\"></a>输入法</h4><p>系统自带或者sougou输入法 ， 倬彼昊天系列皮肤</p>\n<h4 id=\"截屏\"><a href=\"#截屏\" class=\"headerlink\" title=\"截屏\"></a>截屏</h4><p>系统设置&gt;键盘&gt;自定义快捷键&gt;+&gt;<br>名称填screenshot<br>命令</p>\n<pre><code>gnome-screenshot -a</code></pre><p>在disabled修改快捷键</p>\n<h4 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h4><p>安装uget</p>\n<pre><code>sudo add-apt-repository ppa:plushuang-tw/uget-stable \nsudo apt-get update \nsudo apt-get install uget</code></pre><p>安装aria2</p>\n<pre><code>sudo add-apt-repository ppa:t-tujikawa/ppa \nsudo apt-get update \nsudo apt-get install aria2</code></pre><p>在uget gui里编辑插件，选择aria2</p>\n<h4 id=\"美化监视工具\"><a href=\"#美化监视工具\" class=\"headerlink\" title=\"美化监视工具\"></a>美化监视工具</h4><pre><code> sudo apt-get install conky  \n sudo add-apt-repository ppa:teejee2008/ppa\n sudo apt-get update\n sudo apt-get install conky-manager\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">显示桌面会自动隐藏conky的bug解决办法:  </span><br><span class=\"line\">编辑配置文件</span><br></pre></td></tr></table></figure>\n\n # own_window_type normal\nown_window_type desktop</code></pre><p>#### 快速搜索文件</p>\n<pre><code>sudo add-apt-repository ppa:synapse-core/testing\nsudo apt-get update\nsudo apt-get install synapse  </code></pre><h4 id=\"卸载synapse\"><a href=\"#卸载synapse\" class=\"headerlink\" title=\"卸载synapse\"></a>卸载synapse</h4><pre><code>sudo apt-get remove synapse</code></pre><h4 id=\"移除PPA\"><a href=\"#移除PPA\" class=\"headerlink\" title=\"移除PPA\"></a>移除PPA</h4><pre><code>sudo apt-get install ppa-purge\nsudo ppa-purge ppa:synapse-core/testing</code></pre><h4 id=\"安装oh-my-zsh\"><a href=\"#安装oh-my-zsh\" class=\"headerlink\" title=\"安装oh-my-zsh\"></a>安装oh-my-zsh</h4><pre><code># https://github.com/robbyrussell/oh-my-zsh\n$ sudo apt-get install git\n$ sudo apt-get install zsh\n$ sh -c &quot;$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;\n$ chsh -s /bin/zsh # 更改默认bash\n//或:\n$ chsh -s `which zsh`\n$ sudo reboot</code></pre><h4 id=\"terminator-终端管理软件\"><a href=\"#terminator-终端管理软件\" class=\"headerlink\" title=\"terminator 终端管理软件\"></a>terminator 终端管理软件</h4><p>安装</p>\n<pre><code>sudo add-apt-repository ppa:gnome-terminator\nsudo apt-get update\nsudo apt-get install terminator</code></pre><p>基本设置方法</p>\n<blockquote>\n<p>右键点击终端任意区域，选择首选项</p>\n</blockquote>\n<p>设置<a href=\"https://github.com/ghuntley/terminator-solarized\" target=\"_blank\" rel=\"noopener\">solarized</a>配色（<a href=\"http://blog.codinglabs.org/articles/getting-started-with-ubuntu.html\" target=\"_blank\" rel=\"noopener\">参考</a>）</p>\n<pre><code>cd ~/.config/terminator  \nvim config</code></pre><p>覆盖以下内容</p>\n<pre><code>[global_config]\n    title_transmit_bg_color = &quot;#d30102&quot;\n    focus = system\n    suppress_multiple_term_dialog = True\n[keybindings]\n[profiles]\n    [[default]]\n        palette = &quot;#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3&quot;\n        copy_on_selection = True\n        background_image = None\n        background_darkness = 0.95\n        background_type = transparent\n        use_system_font = False\n        cursor_color = &quot;#eee8d5&quot;\n        foreground_color = &quot;#839496&quot;\n        show_titlebar = False\n        font = Monospace 11\n        background_color = &quot;#002b36&quot;\n    [[solarized-dark]]\n        palette = &quot;#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3&quot;\n        background_color = &quot;#002b36&quot;\n        background_image = None\n        cursor_color = &quot;#eee8d5&quot;\n        foreground_color = &quot;#839496&quot;\n    [[solarized-light]]\n        palette = &quot;#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3&quot;\n        background_color = &quot;#fdf6e3&quot;\n        background_image = None\n        cursor_color = &quot;#002b36&quot;\n        foreground_color = &quot;#657b83&quot;\n[layouts]\n    [[default]]\n        [[[child1]]]\n            type = Terminal\n            parent = window0\n            profile = default\n        [[[window0]]]\n            type = Window\n            parent = &quot;&quot;\n[plugins]</code></pre><p>以上配置后会修改配色方案，但是没有bright色<br><a href=\"https://github.com/seebi/dircolors-solarized\" target=\"_blank\" rel=\"noopener\">dircolors-solarized</a>项目提供了适合于solarized的dircolors配色方案，只要选择合适的方案使用就可以了。</p>\n<pre><code>curl https://raw.github.com/seebi/dircolors-solarized/master/dircolors.ansi-dark &gt; ~/.dircolors</code></pre><p>然后在~/.bashrc中加入如下配置：</p>\n<pre><code># enable color support of ls and also add handy aliases\nif [ -x /usr/bin/dircolors ]; then\n    test -r ~/.dircolors &amp;&amp; eval &quot;$(dircolors -b ~/.dircolors)&quot; || eval &quot;$(dircolors -b)&quot;\n    alias ls=&apos;ls --color=auto&apos;\n    #alias dir=&apos;dir --color=auto&apos;\n    #alias vdir=&apos;vdir --color=auto&apos;\n\n    alias grep=&apos;grep --color=auto&apos;\n    alias fgrep=&apos;fgrep --color=auto&apos;\n    alias egrep=&apos;egrep --color=auto&apos;\nfi\n\n# some more ls aliases\nalias ll=&apos;ls -alF&apos;\nalias la=&apos;ls -A&apos;\nalias l=&apos;ls -CF&apos;</code></pre><p>执行</p>\n<pre><code>source ~/.bashrc</code></pre><h4 id=\"tmux配合terminator使用\"><a href=\"#tmux配合terminator使用\" class=\"headerlink\" title=\"tmux配合terminator使用\"></a>tmux配合terminator使用</h4><p>安装</p>\n<pre><code>sudo apt-get install tmux</code></pre><p>配置</p>\n<pre><code>touch .tmux.conf</code></pre><p>配置内容和使用方法</p>\n<pre><code># 设置前缀为Ctrl + x\nset -g prefix C-x\n# 解除Ctrl+b 与前缀的对应关系\nunbind C-b\n# 将r 设置为加载配置文件，并显示&quot;reloaded!&quot;信息\nbind r source-file ~/.tmux.conf \\; display &quot;Reloaded!&quot;\n\n\n\n# copy-mode 将快捷键设置为vi 模式\nsetw -g mode-keys vi\n\n# tmux-powerline设置\nset-option -g status on\nset-option -g status-interval 2\nset-option -g status-utf8 on\nset-option -g status-justify &quot;centre&quot;\nset-option -g status-left-length 60\nset-option -g status-right-length 90\nset-option -g status-left &quot;#(~/.tmux/tmux-powerline/powerline.sh left)&quot;\nset-option -g status-right &quot;#(~/.tmux/tmux-powerline/powerline.sh right)&quot;\n# 将窗口列表换成 powerline的风格\nset-window-option -g window-status-current-format &quot;#[fg=colour235, bg=colour27]⮀#[fg=colour255, bg=colour27] #I ⮁ #W #[fg=colour27, bg=colour235]⮀&quot;\n# 设置默认bash\nset-option -g default-shell /bin/zsh\n\n\n########## 复制模式  ##########\n\n# copy mode 复制模式\n# &apos;prefix +  [ &apos;进入复制模式\n# 按space 开始复制\n# Enter退出复制模式</code></pre><p>需要安装powerline插件</p>\n<pre><code>https://github.com/erikw/tmux-powerline</code></pre><p>显示日期的星期</p>\n<pre><code>vim data_day.sh\n # date +&quot;%a&quot;改成大写\n date +&quot;%A&quot;</code></pre><p>powerline字体安装查看 <a href=\"http://powerline.readthedocs.io/en/latest/installation/linux.html\" target=\"_blank\" rel=\"noopener\">http://powerline.readthedocs.io/en/latest/installation/linux.html</a> 在terminator配置自动启动turm</p>\n<pre><code>首选项-&gt;配置&gt;命令&gt;自定义命令  \n ([[ -f &quot;$TMUX&quot; ]] &amp;&amp; tmux -2 -S $TMUX) || (TMUX=&quot;&quot; tmux -2)</code></pre><p>自动部署多窗口任务</p>\n<pre><code>touch ~/development.start\nchmod +x development.start\n\n\ntmux has-session -t development\nif [ $? != 0 ]\nthen\n    tmux new-session -s development -n editor -d\n    tmux send-keys -t development &apos;vim&apos; C-m\n    tmux split-window -v -t development\n    tmux select-layout -t development main-horizontal\n    tmux new-window -n bash -t development\n    tmux new-window -n ssh -t development\n    tmux new-window -n mysql -t development\n    tmux new-window -n front-end -t development\n    tmux select-window -t development:1\nfi\ntmux attach -t development</code></pre><p>执行文件</p>\n<pre><code>~/development.start</code></pre><h4 id=\"Visual-Studio-Code\"><a href=\"#Visual-Studio-Code\" class=\"headerlink\" title=\"Visual Studio Code\"></a>Visual Studio Code</h4><p>通过官方PPA来安装Ubuntu Make</p>\n<pre><code>sudo add-apt-repository ppa:ubuntu-desktop/ubuntu-make\nsudo apt-get update\nsudo apt-get install ubuntu-make</code></pre><p>安装Ubuntu Make完后，接着使用下列命令安装Visual Studio Code</p>\n<pre><code>umake web visual-studio-code</code></pre><p>卸载命令</p>\n<pre><code>umake web visual-studio-code --remove</code></pre><h4 id=\"wine\"><a href=\"#wine\" class=\"headerlink\" title=\"wine\"></a>wine</h4><p>卸载wineqq</p>\n<pre><code>sudo dpkg -l | grep qq  # 找到安装包名称   \nsudo dpkg -r wine-qq7.8-longeneteam # 卸载</code></pre><h4 id=\"curl-http请求\"><a href=\"#curl-http请求\" class=\"headerlink\" title=\"curl http请求\"></a>curl http请求</h4><pre><code>curl &quot;http://www.baidu.com&quot; # 如果这里的URL指向的是一个文件或者一幅图都可以直接下载到本地  \ncurl -i &quot;http://www.baidu.com&quot; # 显示全部信息  \ncurl -l &quot;http://www.baidu.com&quot; # 只显示头部信息  \ncurl -v &quot;http://www.baidu.com&quot; # 显示get请求全过程解析    \ncurl -d &quot;param1=value1¶m2=value2&quot; &quot;http://www.baidu.com&quot; # post请求  </code></pre><h4 id=\"安卓虚拟机genymotion\"><a href=\"#安卓虚拟机genymotion\" class=\"headerlink\" title=\"安卓虚拟机genymotion\"></a>安卓虚拟机genymotion</h4><p>前提必须安装virtualBox<br>下载地址: <a href=\"https://www.genymotion.com/download/\" target=\"_blank\" rel=\"noopener\">https://www.genymotion.com/download/</a><br>需要先注册,下载后执行</p>\n<pre><code>chmod +x genymotion-2.2.2_x64.bin\n./genymotion-2.2.2_x64.bin -d /home/user</code></pre><p>执行home/user/genymotion/genymotion</p>\n<h4 id=\"安装为知笔记\"><a href=\"#安装为知笔记\" class=\"headerlink\" title=\"安装为知笔记\"></a>安装为知笔记</h4><p>简易版本</p>\n<pre><code>http://ppa.launchpad.net/wiznote-team/ppa/ubuntu/pool/main/w/wiznote/</code></pre><p>编译安装</p>\n<pre><code>http://www.wiz.cn/compile-client.html</code></pre><p>chrome安装扩展</p>\n<pre><code>https://chrome.google.com/webstore/detail/wiznote-web-clipper/jfanfpmalehkemdiiebjljddhgojhfab/related?hl=zh-CN</code></pre><h4 id=\"安装系统状态指示器\"><a href=\"#安装系统状态指示器\" class=\"headerlink\" title=\"安装系统状态指示器\"></a>安装系统状态指示器</h4><pre><code>sudo add-apt-repository ppa:indicator-multiload/stable-daily\n\nsudo apt-get update\n\nsudo apt-get install indicator-multiload</code></pre><h4 id=\"安装albert搜索框\"><a href=\"#安装albert搜索框\" class=\"headerlink\" title=\"安装albert搜索框\"></a>安装albert搜索框</h4><pre><code>sudo add-apt-repository ppa:noobslab/macbuntu\nsudo apt-get update\nsudo apt-get install albert\n设置快捷键Ctrl+/ 样式NUMIX</code></pre><h4 id=\"下载特殊文件\"><a href=\"#下载特殊文件\" class=\"headerlink\" title=\"下载特殊文件\"></a>下载特殊文件</h4><pre><code>sudo apt-get install ktorrent\nsudo apt-get install amule</code></pre>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"显示电脑硬件信息\"><a href=\"#显示电脑硬件信息\" class=\"headerlink\" title=\"显示电脑硬件信息\"></a>显示电脑硬件信息</h4><pre><code>$ sudo add-apt-repository ppa:dawidd0811/neofetch\n$ sudo apt-get update\n$ sudo apt-get install neofetch\nneofetch</code></pre><h4 id=\"安装独立显卡驱动\"><a href=\"#安装独立显卡驱动\" class=\"headerlink\" title=\"安装独立显卡驱动\"></a>安装独立显卡驱动</h4><p><a href=\"https://blog.csdn.net/ghw15221836342/article/details/79571559\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/ghw15221836342/article/details/79571559</a></p>\n<pre><code># 驱动版本查询   https://www.nvidia.com/Download/index.aspx?lang=en-us\n# 安装\nsudo add-apt-repository ppa:graphics-drivers/ppa  \nsudo apt-get update  \nsudo apt-get install nvidia-390 #此处要根据上面查询到的版本适当更改\nsudo apt-get install mesa-common-dev  \nsudo apt-get install freeglut3-de\n# 测试\nnvidia-smi  #若出现电脑GPU列表，即安装成功\n或者\nnvidia-settings #显示你的显卡信息\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    #### Chrome浏览器</span><br><span class=\"line\">    下载地址 [百度云盘](http://pan.baidu.com/s/1hq0Nom4)</span><br><span class=\"line\">    </span><br><span class=\"line\">    #### 配置SS</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">安装</span><br><span class=\"line\">==</span><br><span class=\"line\"></span><br><span class=\"line\">apt-get install python-pip pip install s\\_h\\_a\\_d\\_o\\_w\\_s\\_o\\_c\\_k\\_s</span><br><span class=\"line\"></span><br><span class=\"line\">启动</span><br><span class=\"line\">==</span><br><span class=\"line\"></span><br><span class=\"line\">sslocal -s server\\_ip -p server\\_port -l 1080 -k password -t 600 -m aes-256-cfb</span><br><span class=\"line\"></span><br><span class=\"line\">简写</span><br><span class=\"line\">==</span><br><span class=\"line\"></span><br><span class=\"line\">sslocal -s ip -p port -k &quot;password&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">    开机启动配置  </span><br><span class=\"line\">    在/home下新建文件ss.sh脚本</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">#!/bin/bash #文件名:ss.sh sslocal -s ip -p port -k &quot;password&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">    编辑开机启动文件</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">sudo vim /etc/rc.local</span><br></pre></td></tr></table></figure>\n\n# 最后加入以下内容\nnohup bash /home/ss.sh&gt;/home/ss.txt &amp;</code></pre><p>代理设置</p>\n<pre><code>service： 127.0.0.1\nport ： 1080\ntype： socks5</code></pre><h4 id=\"配置proxychains\"><a href=\"#配置proxychains\" class=\"headerlink\" title=\"配置proxychains\"></a>配置proxychains</h4><pre><code># 安装\nsudo apt install proxychains\nsudo vim /etc/proxychains.conf\n~ socks5 127.0.0.1 1080  # 最后一行加入socks代理\n# 测试\nproxychains wget https://www.google.com</code></pre><h4 id=\"wine-qq（现在推荐docker安装qq）\"><a href=\"#wine-qq（现在推荐docker安装qq）\" class=\"headerlink\" title=\"wine qq（现在推荐docker安装qq）\"></a>wine qq（现在推荐docker安装qq）</h4><p>安装wine1.7以上版本<br>安装WineQQ7.8-20151109-Longene.deb版本<br>下载<a href=\"https://pan.baidu.com/s/1bpLn0vl\" target=\"_blank\" rel=\"noopener\">网盘</a></p>\n<h4 id=\"elinks-纯文本浏览器\"><a href=\"#elinks-纯文本浏览器\" class=\"headerlink\" title=\"elinks 纯文本浏览器\"></a>elinks 纯文本浏览器</h4><pre><code>sudo apt-get install elinks   # 安装\n\n\nelinks www.zhuohc.com  # 使用</code></pre><h4 id=\"unzip-zip\"><a href=\"#unzip-zip\" class=\"headerlink\" title=\"unzip / zip\"></a>unzip / zip</h4><p>解决中文乱码</p>\n<pre><code>unzip -O CP936 xxx.zip</code></pre><p>解压到指定目录</p>\n<pre><code>unzip -O xxx.zip -d xxx/</code></pre><p>压缩文件</p>\n<pre><code>zip -r yasuo.zip abc.txt dir1</code></pre><h4 id=\"wps-office办公\"><a href=\"#wps-office办公\" class=\"headerlink\" title=\"wps office办公\"></a>wps office办公</h4><p>显示字体确实错误 <a href=\"https://pan.baidu.com/s/1bpLn0vl\" target=\"_blank\" rel=\"noopener\">下载字体</a><br>将字体复制到linux字体中</p>\n<pre><code>sudo cp * /usr/share/fonts</code></pre><p>生成字体索引信息</p>\n<pre><code>sudo mkfontscale\n\nsudo mkfontdir</code></pre><p>更新字体缓存</p>\n<pre><code>sudo fc-cache</code></pre><p>中文无法输入</p>\n<pre><code>$ vi /usr/bin/wps  # word文档\n\n\n#!/bin/bash\nexport XMODIFIERS=&quot;@im=fcitx&quot;  # 添加的内容  \nexport QT_IM_MODULE=&quot;fcitx&quot;     # 添加的内容    \ngOpt=\n#gOptExt=-multiply\ngTemplateExt=(&quot;wpt&quot; &quot;dot&quot; &quot;dotx&quot;)\n\n\n$ vi /usr/bin/et   # excel表格\n\n\n#!/bin/bash\nexport XMODIFIERS=&quot;@im=fcitx&quot;  # 添加的内容  \nexport QT_IM_MODULE=&quot;fcitx&quot;  # 添加的内容  \ngOpt=\n#gOptExt=-multiply</code></pre><h4 id=\"输入法\"><a href=\"#输入法\" class=\"headerlink\" title=\"输入法\"></a>输入法</h4><p>系统自带或者sougou输入法 ， 倬彼昊天系列皮肤</p>\n<h4 id=\"截屏\"><a href=\"#截屏\" class=\"headerlink\" title=\"截屏\"></a>截屏</h4><p>系统设置&gt;键盘&gt;自定义快捷键&gt;+&gt;<br>名称填screenshot<br>命令</p>\n<pre><code>gnome-screenshot -a</code></pre><p>在disabled修改快捷键</p>\n<h4 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h4><p>安装uget</p>\n<pre><code>sudo add-apt-repository ppa:plushuang-tw/uget-stable \nsudo apt-get update \nsudo apt-get install uget</code></pre><p>安装aria2</p>\n<pre><code>sudo add-apt-repository ppa:t-tujikawa/ppa \nsudo apt-get update \nsudo apt-get install aria2</code></pre><p>在uget gui里编辑插件，选择aria2</p>\n<h4 id=\"美化监视工具\"><a href=\"#美化监视工具\" class=\"headerlink\" title=\"美化监视工具\"></a>美化监视工具</h4><pre><code> sudo apt-get install conky  \n sudo add-apt-repository ppa:teejee2008/ppa\n sudo apt-get update\n sudo apt-get install conky-manager\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">显示桌面会自动隐藏conky的bug解决办法:  </span><br><span class=\"line\">编辑配置文件</span><br></pre></td></tr></table></figure>\n\n # own_window_type normal\nown_window_type desktop</code></pre><p>#### 快速搜索文件</p>\n<pre><code>sudo add-apt-repository ppa:synapse-core/testing\nsudo apt-get update\nsudo apt-get install synapse  </code></pre><h4 id=\"卸载synapse\"><a href=\"#卸载synapse\" class=\"headerlink\" title=\"卸载synapse\"></a>卸载synapse</h4><pre><code>sudo apt-get remove synapse</code></pre><h4 id=\"移除PPA\"><a href=\"#移除PPA\" class=\"headerlink\" title=\"移除PPA\"></a>移除PPA</h4><pre><code>sudo apt-get install ppa-purge\nsudo ppa-purge ppa:synapse-core/testing</code></pre><h4 id=\"安装oh-my-zsh\"><a href=\"#安装oh-my-zsh\" class=\"headerlink\" title=\"安装oh-my-zsh\"></a>安装oh-my-zsh</h4><pre><code># https://github.com/robbyrussell/oh-my-zsh\n$ sudo apt-get install git\n$ sudo apt-get install zsh\n$ sh -c &quot;$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;\n$ chsh -s /bin/zsh # 更改默认bash\n//或:\n$ chsh -s `which zsh`\n$ sudo reboot</code></pre><h4 id=\"terminator-终端管理软件\"><a href=\"#terminator-终端管理软件\" class=\"headerlink\" title=\"terminator 终端管理软件\"></a>terminator 终端管理软件</h4><p>安装</p>\n<pre><code>sudo add-apt-repository ppa:gnome-terminator\nsudo apt-get update\nsudo apt-get install terminator</code></pre><p>基本设置方法</p>\n<blockquote>\n<p>右键点击终端任意区域，选择首选项</p>\n</blockquote>\n<p>设置<a href=\"https://github.com/ghuntley/terminator-solarized\" target=\"_blank\" rel=\"noopener\">solarized</a>配色（<a href=\"http://blog.codinglabs.org/articles/getting-started-with-ubuntu.html\" target=\"_blank\" rel=\"noopener\">参考</a>）</p>\n<pre><code>cd ~/.config/terminator  \nvim config</code></pre><p>覆盖以下内容</p>\n<pre><code>[global_config]\n    title_transmit_bg_color = &quot;#d30102&quot;\n    focus = system\n    suppress_multiple_term_dialog = True\n[keybindings]\n[profiles]\n    [[default]]\n        palette = &quot;#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3&quot;\n        copy_on_selection = True\n        background_image = None\n        background_darkness = 0.95\n        background_type = transparent\n        use_system_font = False\n        cursor_color = &quot;#eee8d5&quot;\n        foreground_color = &quot;#839496&quot;\n        show_titlebar = False\n        font = Monospace 11\n        background_color = &quot;#002b36&quot;\n    [[solarized-dark]]\n        palette = &quot;#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3&quot;\n        background_color = &quot;#002b36&quot;\n        background_image = None\n        cursor_color = &quot;#eee8d5&quot;\n        foreground_color = &quot;#839496&quot;\n    [[solarized-light]]\n        palette = &quot;#073642:#dc322f:#859900:#b58900:#268bd2:#d33682:#2aa198:#eee8d5:#002b36:#cb4b16:#586e75:#657b83:#839496:#6c71c4:#93a1a1:#fdf6e3&quot;\n        background_color = &quot;#fdf6e3&quot;\n        background_image = None\n        cursor_color = &quot;#002b36&quot;\n        foreground_color = &quot;#657b83&quot;\n[layouts]\n    [[default]]\n        [[[child1]]]\n            type = Terminal\n            parent = window0\n            profile = default\n        [[[window0]]]\n            type = Window\n            parent = &quot;&quot;\n[plugins]</code></pre><p>以上配置后会修改配色方案，但是没有bright色<br><a href=\"https://github.com/seebi/dircolors-solarized\" target=\"_blank\" rel=\"noopener\">dircolors-solarized</a>项目提供了适合于solarized的dircolors配色方案，只要选择合适的方案使用就可以了。</p>\n<pre><code>curl https://raw.github.com/seebi/dircolors-solarized/master/dircolors.ansi-dark &gt; ~/.dircolors</code></pre><p>然后在~/.bashrc中加入如下配置：</p>\n<pre><code># enable color support of ls and also add handy aliases\nif [ -x /usr/bin/dircolors ]; then\n    test -r ~/.dircolors &amp;&amp; eval &quot;$(dircolors -b ~/.dircolors)&quot; || eval &quot;$(dircolors -b)&quot;\n    alias ls=&apos;ls --color=auto&apos;\n    #alias dir=&apos;dir --color=auto&apos;\n    #alias vdir=&apos;vdir --color=auto&apos;\n\n    alias grep=&apos;grep --color=auto&apos;\n    alias fgrep=&apos;fgrep --color=auto&apos;\n    alias egrep=&apos;egrep --color=auto&apos;\nfi\n\n# some more ls aliases\nalias ll=&apos;ls -alF&apos;\nalias la=&apos;ls -A&apos;\nalias l=&apos;ls -CF&apos;</code></pre><p>执行</p>\n<pre><code>source ~/.bashrc</code></pre><h4 id=\"tmux配合terminator使用\"><a href=\"#tmux配合terminator使用\" class=\"headerlink\" title=\"tmux配合terminator使用\"></a>tmux配合terminator使用</h4><p>安装</p>\n<pre><code>sudo apt-get install tmux</code></pre><p>配置</p>\n<pre><code>touch .tmux.conf</code></pre><p>配置内容和使用方法</p>\n<pre><code># 设置前缀为Ctrl + x\nset -g prefix C-x\n# 解除Ctrl+b 与前缀的对应关系\nunbind C-b\n# 将r 设置为加载配置文件，并显示&quot;reloaded!&quot;信息\nbind r source-file ~/.tmux.conf \\; display &quot;Reloaded!&quot;\n\n\n\n# copy-mode 将快捷键设置为vi 模式\nsetw -g mode-keys vi\n\n# tmux-powerline设置\nset-option -g status on\nset-option -g status-interval 2\nset-option -g status-utf8 on\nset-option -g status-justify &quot;centre&quot;\nset-option -g status-left-length 60\nset-option -g status-right-length 90\nset-option -g status-left &quot;#(~/.tmux/tmux-powerline/powerline.sh left)&quot;\nset-option -g status-right &quot;#(~/.tmux/tmux-powerline/powerline.sh right)&quot;\n# 将窗口列表换成 powerline的风格\nset-window-option -g window-status-current-format &quot;#[fg=colour235, bg=colour27]⮀#[fg=colour255, bg=colour27] #I ⮁ #W #[fg=colour27, bg=colour235]⮀&quot;\n# 设置默认bash\nset-option -g default-shell /bin/zsh\n\n\n########## 复制模式  ##########\n\n# copy mode 复制模式\n# &apos;prefix +  [ &apos;进入复制模式\n# 按space 开始复制\n# Enter退出复制模式</code></pre><p>需要安装powerline插件</p>\n<pre><code>https://github.com/erikw/tmux-powerline</code></pre><p>显示日期的星期</p>\n<pre><code>vim data_day.sh\n # date +&quot;%a&quot;改成大写\n date +&quot;%A&quot;</code></pre><p>powerline字体安装查看 <a href=\"http://powerline.readthedocs.io/en/latest/installation/linux.html\" target=\"_blank\" rel=\"noopener\">http://powerline.readthedocs.io/en/latest/installation/linux.html</a> 在terminator配置自动启动turm</p>\n<pre><code>首选项-&gt;配置&gt;命令&gt;自定义命令  \n ([[ -f &quot;$TMUX&quot; ]] &amp;&amp; tmux -2 -S $TMUX) || (TMUX=&quot;&quot; tmux -2)</code></pre><p>自动部署多窗口任务</p>\n<pre><code>touch ~/development.start\nchmod +x development.start\n\n\ntmux has-session -t development\nif [ $? != 0 ]\nthen\n    tmux new-session -s development -n editor -d\n    tmux send-keys -t development &apos;vim&apos; C-m\n    tmux split-window -v -t development\n    tmux select-layout -t development main-horizontal\n    tmux new-window -n bash -t development\n    tmux new-window -n ssh -t development\n    tmux new-window -n mysql -t development\n    tmux new-window -n front-end -t development\n    tmux select-window -t development:1\nfi\ntmux attach -t development</code></pre><p>执行文件</p>\n<pre><code>~/development.start</code></pre><h4 id=\"Visual-Studio-Code\"><a href=\"#Visual-Studio-Code\" class=\"headerlink\" title=\"Visual Studio Code\"></a>Visual Studio Code</h4><p>通过官方PPA来安装Ubuntu Make</p>\n<pre><code>sudo add-apt-repository ppa:ubuntu-desktop/ubuntu-make\nsudo apt-get update\nsudo apt-get install ubuntu-make</code></pre><p>安装Ubuntu Make完后，接着使用下列命令安装Visual Studio Code</p>\n<pre><code>umake web visual-studio-code</code></pre><p>卸载命令</p>\n<pre><code>umake web visual-studio-code --remove</code></pre><h4 id=\"wine\"><a href=\"#wine\" class=\"headerlink\" title=\"wine\"></a>wine</h4><p>卸载wineqq</p>\n<pre><code>sudo dpkg -l | grep qq  # 找到安装包名称   \nsudo dpkg -r wine-qq7.8-longeneteam # 卸载</code></pre><h4 id=\"curl-http请求\"><a href=\"#curl-http请求\" class=\"headerlink\" title=\"curl http请求\"></a>curl http请求</h4><pre><code>curl &quot;http://www.baidu.com&quot; # 如果这里的URL指向的是一个文件或者一幅图都可以直接下载到本地  \ncurl -i &quot;http://www.baidu.com&quot; # 显示全部信息  \ncurl -l &quot;http://www.baidu.com&quot; # 只显示头部信息  \ncurl -v &quot;http://www.baidu.com&quot; # 显示get请求全过程解析    \ncurl -d &quot;param1=value1¶m2=value2&quot; &quot;http://www.baidu.com&quot; # post请求  </code></pre><h4 id=\"安卓虚拟机genymotion\"><a href=\"#安卓虚拟机genymotion\" class=\"headerlink\" title=\"安卓虚拟机genymotion\"></a>安卓虚拟机genymotion</h4><p>前提必须安装virtualBox<br>下载地址: <a href=\"https://www.genymotion.com/download/\" target=\"_blank\" rel=\"noopener\">https://www.genymotion.com/download/</a><br>需要先注册,下载后执行</p>\n<pre><code>chmod +x genymotion-2.2.2_x64.bin\n./genymotion-2.2.2_x64.bin -d /home/user</code></pre><p>执行home/user/genymotion/genymotion</p>\n<h4 id=\"安装为知笔记\"><a href=\"#安装为知笔记\" class=\"headerlink\" title=\"安装为知笔记\"></a>安装为知笔记</h4><p>简易版本</p>\n<pre><code>http://ppa.launchpad.net/wiznote-team/ppa/ubuntu/pool/main/w/wiznote/</code></pre><p>编译安装</p>\n<pre><code>http://www.wiz.cn/compile-client.html</code></pre><p>chrome安装扩展</p>\n<pre><code>https://chrome.google.com/webstore/detail/wiznote-web-clipper/jfanfpmalehkemdiiebjljddhgojhfab/related?hl=zh-CN</code></pre><h4 id=\"安装系统状态指示器\"><a href=\"#安装系统状态指示器\" class=\"headerlink\" title=\"安装系统状态指示器\"></a>安装系统状态指示器</h4><pre><code>sudo add-apt-repository ppa:indicator-multiload/stable-daily\n\nsudo apt-get update\n\nsudo apt-get install indicator-multiload</code></pre><h4 id=\"安装albert搜索框\"><a href=\"#安装albert搜索框\" class=\"headerlink\" title=\"安装albert搜索框\"></a>安装albert搜索框</h4><pre><code>sudo add-apt-repository ppa:noobslab/macbuntu\nsudo apt-get update\nsudo apt-get install albert\n设置快捷键Ctrl+/ 样式NUMIX</code></pre><h4 id=\"下载特殊文件\"><a href=\"#下载特殊文件\" class=\"headerlink\" title=\"下载特殊文件\"></a>下载特殊文件</h4><pre><code>sudo apt-get install ktorrent\nsudo apt-get install amule</code></pre>"},{"title":"Ubuntu14.04服务器基础配置","url":"95.html","id":"95","comments":0,"date":"2016-11-10T02:49:23.000Z","_content":"\n#### 登陆ssh\n\n    ssh root@ipaddress \n    password:\n    \n\n#### 首次登陆出现的错误\n\n    perl: warning: Setting locale failed.\n    perl: warning: Please check that your locale settings:\n    \n\n    # 安装 localepurge 管理语言文件\n    sudo apt-get install localepurge\n    # 或者之后自行配置\n    sudo dpkg-reconfigure localepurge\n    # 生成自己需要的语言\n    sudo locale-gen zh_CN.UTF-8 en_US.UTF-8\n    # 打印结果\n    locale\n    # ssh连接时候指定语言\n    LC_ALL=en_US.UTF-8 ssh <host>\n    \n\n#### 创建用户\n\n    adduser hanchang\n    password:\n    retry password:\n    \n\n#### 将用户添加到sudo用户组\n\n错误提示\n\n    username is not in the sudoers file.\n    \n\n    su -\n    password：\n    chmod u+w /etc/sudoers   # 添加文件写权限\n    root ALL=(ALL) ALL 下面添加以下代码\n    hanchang ALL=(ALL) NOPASSWD: ALL\n    :wq 退出\n    chmod u-w /etc/sudoers  # 取消文件写权限\n    \n\n修改root密码\n\n    sudo passwd\n    password:\n    retry password:\n    \n\n#### 禁止root用户远程登陆ssh\n\n    cd /e   tc/ssh/\n    sudo vim sshd_config\n    PermitRootLogin yes改成PermitRootLogin no\n    service sshd restart    或者 /etc/init.d/sshd restart（ssh服务器重启）\n    \n\n#### 指定IP地址登陆\n\n    vim  /etc/hosts.allow\n    sshd:192.168.220.164:allow  # 最后添加\n    \n    vim /etc/hosts.deny\n    sshd:ALL #最后添加\n    \n\n#### 避免sshd连接超时\n\n修改客户端\n\n    sudo vim /etc/ssh/ssh_config\n    # 添加\n    ServerAliveInterval 30   # 每30秒向服务器发起心跳\n    ServerAliveCountMax 6 # 允许6次无响应\n    \n\n或者修改服务器端\n\n    # 打开\n    sudo vim /etc/ssh/sshd_config\n    # 添加\n    ClientAliveInterval 30\n    ClientAliveCountMax 6\n    \n\n#### 流量监控\n\n    # 安装监控软件\n    sudo apt-get install vnstat\n    \n\n    # 安装好后运行以下命令初始化数据库\n    # eth0可以通过ifconfig查看\n    sudo vnstat -u -i eth1\n    \n\n    # 修改配置文件\n    sudo vim /etc/vnstat.conf\n    Interface \"eth1\" #此处修改需要监控的网卡\n    \n\n    # 启动守护进程\n    sudo /etc/init.d/vnstat start\n    # 默认开机启动\n    sudo update-rc.d vnstat enable\n    \n\n#### 查看是否安装iptables\n\n    iptables: /sbin/iptables /usr/share/iptables /usr/share/man/man8/iptables.8.gz #表示已经安装iptables\n    apt-get install iptables #如果默认没有安装，请运行此命令安装防火墙\n    \n\n编辑iptables配置文件\n\n    sudo vi /etc/iptables.rules\n    *filter\n    :INPUT DROP [0:0]\n    :FORWARD ACCEPT [0:0]\n    :OUTPUT ACCEPT [0:0]\n    :syn-flood - [0:0]\n    -A INPUT -i lo -j ACCEPT\n    -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 20 -j ACCEPT\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 21 -j ACCEPT\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 443 -j ACCEPT\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT\n    -A INPUT -p icmp -m limit --limit 100/sec --limit-burst 100 -j ACCEPT\n    -A INPUT -p icmp -m limit --limit 1/s --limit-burst 10 -j ACCEPT\n    -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,ACK SYN -j syn-flood\n    -A INPUT -j REJECT --reject-with icmp-host-prohibited\n    -A syn-flood -p tcp -m limit --limit 3/sec --limit-burst 6 -j RETURN\n    -A syn-flood -j REJECT --reject-with icmp-port-unreachable\n    COMMIT\n    \n\n    # sudo iptables-restore < /etc/iptables.rules #使防火墙规则生效，重启主机执行此命令\n    \n\n    # 重启主机会使以上配置失效，以下内容为如何配置开机自动启动防火墙\n    # vi /etc/network/if-pre-up.d/iptables #创建文件，添加以下内容，使防火墙开机启动\n    #!/bin/bash\n    iptables-restore < /etc/iptables.rules\n    \n\n    # chmod +x /etc/network/if-pre-up.d/iptables #添加执行权限\n    # sudo iptables -L -n查看规则是否生效.\n    \n\n#### 挂载新的硬盘\n\n    fdisk -l\n    如果出现\n    Disk /dev/sdb doesn't contain a valid partition table\n    说明没有分区,需要处理\n    fdisk /dev/sdb\n    Command (m for help):  m为查看选项，这里我们输入n表示创建一个新的分区\n    选中默认，在分区大小中填写分区大小 +500G\n    \n\n第二步：使新创建的分区在系统中立即生效 root#partprobe 第三步：格式化新创建的分区\n\n    mkfs.ext3 /dev/hdb1\n    \n\n第四步：使新创建的分区挂载/mnt/ssd_one 目录下\n\n    mount /dev/hda1 /mnt/rhce01\n    \n\n查看已经挂载的信息\n\n    sudo vim /etc/mtab\n    \n\n第五步：开机自动挂载\n\n    sudo vim /etc/fstab\n    # 底部添加\n    /dev/sdb1              /mnt/hdd_one              ext3    defaults        0 0\n    \n\n查看现在的硬盘信息\n\n    root@m1095:~# df -hl\n    Filesystem      Size  Used Avail Use% Mounted on\n    udev             12G  4.0K   12G   1% /dev\n    tmpfs           2.4G  632K  2.4G   1% /run\n    /dev/sda2        71G  1.2G   66G   2% /\n    none            4.0K     0  4.0K   0% /sys/fs/cgroup\n    none            5.0M     0  5.0M   0% /run/lock\n    none             12G     0   12G   0% /run/shm\n    none            100M     0  100M   0% /run/user\n    /dev/sda1       226M   35M  175M  17% /boot\n    /dev/sdb1       493G   70M  467G   1% /mnt/hdd_one\n    \n\n#### ftp服务器搭建\n\n    sudo apt-get install vsftpd\n    \n\n编辑配置文件\n\n    sudo vim /etc/vsftpd.conf\n    \n\n    anonymous_enable=NO   # 禁止匿名用户\n    local_enable=YES   # 允许本地用户\n    write_enable=YES # 允许写入\n    chroot_local_user=YES  # 登陆用户被限制在自己的home目录下\n    allow_writeable_chroot=YES # 配合chroot_local_user=YES使用\n    # 当chroot_local_user=YES表示chroot_list为可以访问其他目录的用户\n    # 当chroot_local_user=NO表示chroot_list为不可以访问其他目录的用户，\n    # chroot_list_enable=YES  \n    # chroot_list_file=/etc/vsftpd.chroot_list\n    \n    # 以下内容为添加内容\n    # 设置为YES表示开启用户登陆过滤，设置为NO表示不开启用户过滤，所有用户都可以访问\n    userlist_enable=YES\n    # 在userlist_enable=YES的前提下，设置是否阻扯user_list文件中的用户登录FTP服务器\n    # YES表示user_list为黑名单，在文件中的用户不能访问，不在文件中的用户可以访问\n    # NO表示user_list 为白名单，在文件中的用户可以访问，不在文件中的用户不能访问\n    userlist_deny=YES\n    \n\n    sudo vim /etc/vsftpd.user_list\n    添加root到文件中\n    \n\n出现500 OOPS: vsftpd: refusing to run with writable root inside chroot()错误的时候 原因：chroot设置为yes的时候，需要取消ftp根目录的写权限\n\n    #### 在配置文件中添加此设置\n    allow_writeable_chroot=YES \n    \n\n#### 开启防火墙后vsftpd连接错误处理\n\n载入以下2个模块\n\n    sudo modprobe ip_nat_ftp\n    sudo modprobe ip_conntrack_ftp\n    \n\n    sudo vi /etc/modules\n    \n    # Add these lines:\n    ip_nat_ftp\n    ip_conntrack_ftp\n    \n\n重启vsftpd服务\n\n#### 安装lamp服务\n\n安装apache\n\n    sudo apt-get install apache2\n    # 将用户添加到apache用户组中\n    sudo usermod -a -G www-data username # www-data 为apache用户组名，username为登陆用户名\n    # apache2安装rewrite\n    sudo a2enmod rewrite\n    sudo service apache2 restart\n    # 删除显示的版本信息\n    ServerTokens Prod\n    ServerSignature Off \n    \n\n配置虚拟主机\n\n    sudo vim /etc/apache.2/apache2.conf\n    # 添加以下内容\n    <Directory /home/zhc/www/>\n            Options FollowSymLinks　#　不要加Index\n            AllowOverride All\n            Require all granted\n    </Directory>\n    \n\n安装mysql\n\n    sudo apt-get install mysql-server php5-mysql\n    ＃配置mysql\n    sudo mysql_secure_installation\n    \n\n查看mysql是否开启慢查询日志\n\n    mysql> show variables like '%slow%';\n    +---------------------------+---------------------------------------+\n    | Variable_name             | Value                                 |\n    +---------------------------+---------------------------------------+\n    | log_slow_admin_statements | OFF                                   |\n    | log_slow_slave_statements | OFF                                   |\n    | slow_launch_time          | 2                                     |\n    | slow_query_log            | OFF                                   |\n    | slow_query_log_file       | /var/lib/mysql/NC-PH-1551-49-slow.log |\n    +---------------------------+---------------------------------------+\n    5 rows in set (0.00 sec)\n    \n\n    #开启慢查询\n    mysql> set global log_slow_queries  = 'ON';\n    mysql> show variables like '%slow%';\n    \n\n    #开启常规查询\n    vim /etc/myql/mysql.conf.d/mysqld.conf\n    general_log_file        = /var/log/mysql/mysql.log\n    general_log             = 1\n    #开启错误查询\n    log_error = /var/log/mysql/error.log\n    #　防止innodb ibdata1文件过大\n    innodb_file_per_table=1　\n    \n\n安装php\n\n    sudo apt-get install php5 libapache2-mod-php5 php5-mcrypt\n    #ubuntu16.04安装方法\n    # Add the PPA\n    apt-get install software-properties-common #如果提示没有 add-apt-repository，需要执行此命令安装\n    sudo add-apt-repository ppa:ondrej/php\n    # If you get add-apt-repository: command not found run the following command first :\n    sudo apt-get install software-properties-common\n    sudo apt-get update\n    sudo apt-get install php5.6\n    sudo apt-get install php5.6-*\n    \n\n配置php\n\n    vim /etc/php/5.6/apache/php.ini\n    expose_php = Off # 隐藏php版本信息\n    \n\n#### 静态文件同步\n\n定时任务 crontab -e # 编辑当前用户的定时任务 crontab -u hanchang -e # 编辑指定用户的定时任务\n\n    # m h  dom mon dow   command\n    # 分钟 小时 日期 月份 星期 命令\n    0 0 * * * /bin/sh /home/hanchang/www/scripts/rsyncHK.sh","source":"_posts/ubuntu14.04服务器基础配置.md","raw":"---\ntitle: Ubuntu14.04服务器基础配置\ntags:\n  - ubuntu\nurl: 95.html\nid: 95\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-10 10:49:23\n---\n\n#### 登陆ssh\n\n    ssh root@ipaddress \n    password:\n    \n\n#### 首次登陆出现的错误\n\n    perl: warning: Setting locale failed.\n    perl: warning: Please check that your locale settings:\n    \n\n    # 安装 localepurge 管理语言文件\n    sudo apt-get install localepurge\n    # 或者之后自行配置\n    sudo dpkg-reconfigure localepurge\n    # 生成自己需要的语言\n    sudo locale-gen zh_CN.UTF-8 en_US.UTF-8\n    # 打印结果\n    locale\n    # ssh连接时候指定语言\n    LC_ALL=en_US.UTF-8 ssh <host>\n    \n\n#### 创建用户\n\n    adduser hanchang\n    password:\n    retry password:\n    \n\n#### 将用户添加到sudo用户组\n\n错误提示\n\n    username is not in the sudoers file.\n    \n\n    su -\n    password：\n    chmod u+w /etc/sudoers   # 添加文件写权限\n    root ALL=(ALL) ALL 下面添加以下代码\n    hanchang ALL=(ALL) NOPASSWD: ALL\n    :wq 退出\n    chmod u-w /etc/sudoers  # 取消文件写权限\n    \n\n修改root密码\n\n    sudo passwd\n    password:\n    retry password:\n    \n\n#### 禁止root用户远程登陆ssh\n\n    cd /e   tc/ssh/\n    sudo vim sshd_config\n    PermitRootLogin yes改成PermitRootLogin no\n    service sshd restart    或者 /etc/init.d/sshd restart（ssh服务器重启）\n    \n\n#### 指定IP地址登陆\n\n    vim  /etc/hosts.allow\n    sshd:192.168.220.164:allow  # 最后添加\n    \n    vim /etc/hosts.deny\n    sshd:ALL #最后添加\n    \n\n#### 避免sshd连接超时\n\n修改客户端\n\n    sudo vim /etc/ssh/ssh_config\n    # 添加\n    ServerAliveInterval 30   # 每30秒向服务器发起心跳\n    ServerAliveCountMax 6 # 允许6次无响应\n    \n\n或者修改服务器端\n\n    # 打开\n    sudo vim /etc/ssh/sshd_config\n    # 添加\n    ClientAliveInterval 30\n    ClientAliveCountMax 6\n    \n\n#### 流量监控\n\n    # 安装监控软件\n    sudo apt-get install vnstat\n    \n\n    # 安装好后运行以下命令初始化数据库\n    # eth0可以通过ifconfig查看\n    sudo vnstat -u -i eth1\n    \n\n    # 修改配置文件\n    sudo vim /etc/vnstat.conf\n    Interface \"eth1\" #此处修改需要监控的网卡\n    \n\n    # 启动守护进程\n    sudo /etc/init.d/vnstat start\n    # 默认开机启动\n    sudo update-rc.d vnstat enable\n    \n\n#### 查看是否安装iptables\n\n    iptables: /sbin/iptables /usr/share/iptables /usr/share/man/man8/iptables.8.gz #表示已经安装iptables\n    apt-get install iptables #如果默认没有安装，请运行此命令安装防火墙\n    \n\n编辑iptables配置文件\n\n    sudo vi /etc/iptables.rules\n    *filter\n    :INPUT DROP [0:0]\n    :FORWARD ACCEPT [0:0]\n    :OUTPUT ACCEPT [0:0]\n    :syn-flood - [0:0]\n    -A INPUT -i lo -j ACCEPT\n    -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 20 -j ACCEPT\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 21 -j ACCEPT\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 443 -j ACCEPT\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT\n    -A INPUT -p icmp -m limit --limit 100/sec --limit-burst 100 -j ACCEPT\n    -A INPUT -p icmp -m limit --limit 1/s --limit-burst 10 -j ACCEPT\n    -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,ACK SYN -j syn-flood\n    -A INPUT -j REJECT --reject-with icmp-host-prohibited\n    -A syn-flood -p tcp -m limit --limit 3/sec --limit-burst 6 -j RETURN\n    -A syn-flood -j REJECT --reject-with icmp-port-unreachable\n    COMMIT\n    \n\n    # sudo iptables-restore < /etc/iptables.rules #使防火墙规则生效，重启主机执行此命令\n    \n\n    # 重启主机会使以上配置失效，以下内容为如何配置开机自动启动防火墙\n    # vi /etc/network/if-pre-up.d/iptables #创建文件，添加以下内容，使防火墙开机启动\n    #!/bin/bash\n    iptables-restore < /etc/iptables.rules\n    \n\n    # chmod +x /etc/network/if-pre-up.d/iptables #添加执行权限\n    # sudo iptables -L -n查看规则是否生效.\n    \n\n#### 挂载新的硬盘\n\n    fdisk -l\n    如果出现\n    Disk /dev/sdb doesn't contain a valid partition table\n    说明没有分区,需要处理\n    fdisk /dev/sdb\n    Command (m for help):  m为查看选项，这里我们输入n表示创建一个新的分区\n    选中默认，在分区大小中填写分区大小 +500G\n    \n\n第二步：使新创建的分区在系统中立即生效 root#partprobe 第三步：格式化新创建的分区\n\n    mkfs.ext3 /dev/hdb1\n    \n\n第四步：使新创建的分区挂载/mnt/ssd_one 目录下\n\n    mount /dev/hda1 /mnt/rhce01\n    \n\n查看已经挂载的信息\n\n    sudo vim /etc/mtab\n    \n\n第五步：开机自动挂载\n\n    sudo vim /etc/fstab\n    # 底部添加\n    /dev/sdb1              /mnt/hdd_one              ext3    defaults        0 0\n    \n\n查看现在的硬盘信息\n\n    root@m1095:~# df -hl\n    Filesystem      Size  Used Avail Use% Mounted on\n    udev             12G  4.0K   12G   1% /dev\n    tmpfs           2.4G  632K  2.4G   1% /run\n    /dev/sda2        71G  1.2G   66G   2% /\n    none            4.0K     0  4.0K   0% /sys/fs/cgroup\n    none            5.0M     0  5.0M   0% /run/lock\n    none             12G     0   12G   0% /run/shm\n    none            100M     0  100M   0% /run/user\n    /dev/sda1       226M   35M  175M  17% /boot\n    /dev/sdb1       493G   70M  467G   1% /mnt/hdd_one\n    \n\n#### ftp服务器搭建\n\n    sudo apt-get install vsftpd\n    \n\n编辑配置文件\n\n    sudo vim /etc/vsftpd.conf\n    \n\n    anonymous_enable=NO   # 禁止匿名用户\n    local_enable=YES   # 允许本地用户\n    write_enable=YES # 允许写入\n    chroot_local_user=YES  # 登陆用户被限制在自己的home目录下\n    allow_writeable_chroot=YES # 配合chroot_local_user=YES使用\n    # 当chroot_local_user=YES表示chroot_list为可以访问其他目录的用户\n    # 当chroot_local_user=NO表示chroot_list为不可以访问其他目录的用户，\n    # chroot_list_enable=YES  \n    # chroot_list_file=/etc/vsftpd.chroot_list\n    \n    # 以下内容为添加内容\n    # 设置为YES表示开启用户登陆过滤，设置为NO表示不开启用户过滤，所有用户都可以访问\n    userlist_enable=YES\n    # 在userlist_enable=YES的前提下，设置是否阻扯user_list文件中的用户登录FTP服务器\n    # YES表示user_list为黑名单，在文件中的用户不能访问，不在文件中的用户可以访问\n    # NO表示user_list 为白名单，在文件中的用户可以访问，不在文件中的用户不能访问\n    userlist_deny=YES\n    \n\n    sudo vim /etc/vsftpd.user_list\n    添加root到文件中\n    \n\n出现500 OOPS: vsftpd: refusing to run with writable root inside chroot()错误的时候 原因：chroot设置为yes的时候，需要取消ftp根目录的写权限\n\n    #### 在配置文件中添加此设置\n    allow_writeable_chroot=YES \n    \n\n#### 开启防火墙后vsftpd连接错误处理\n\n载入以下2个模块\n\n    sudo modprobe ip_nat_ftp\n    sudo modprobe ip_conntrack_ftp\n    \n\n    sudo vi /etc/modules\n    \n    # Add these lines:\n    ip_nat_ftp\n    ip_conntrack_ftp\n    \n\n重启vsftpd服务\n\n#### 安装lamp服务\n\n安装apache\n\n    sudo apt-get install apache2\n    # 将用户添加到apache用户组中\n    sudo usermod -a -G www-data username # www-data 为apache用户组名，username为登陆用户名\n    # apache2安装rewrite\n    sudo a2enmod rewrite\n    sudo service apache2 restart\n    # 删除显示的版本信息\n    ServerTokens Prod\n    ServerSignature Off \n    \n\n配置虚拟主机\n\n    sudo vim /etc/apache.2/apache2.conf\n    # 添加以下内容\n    <Directory /home/zhc/www/>\n            Options FollowSymLinks　#　不要加Index\n            AllowOverride All\n            Require all granted\n    </Directory>\n    \n\n安装mysql\n\n    sudo apt-get install mysql-server php5-mysql\n    ＃配置mysql\n    sudo mysql_secure_installation\n    \n\n查看mysql是否开启慢查询日志\n\n    mysql> show variables like '%slow%';\n    +---------------------------+---------------------------------------+\n    | Variable_name             | Value                                 |\n    +---------------------------+---------------------------------------+\n    | log_slow_admin_statements | OFF                                   |\n    | log_slow_slave_statements | OFF                                   |\n    | slow_launch_time          | 2                                     |\n    | slow_query_log            | OFF                                   |\n    | slow_query_log_file       | /var/lib/mysql/NC-PH-1551-49-slow.log |\n    +---------------------------+---------------------------------------+\n    5 rows in set (0.00 sec)\n    \n\n    #开启慢查询\n    mysql> set global log_slow_queries  = 'ON';\n    mysql> show variables like '%slow%';\n    \n\n    #开启常规查询\n    vim /etc/myql/mysql.conf.d/mysqld.conf\n    general_log_file        = /var/log/mysql/mysql.log\n    general_log             = 1\n    #开启错误查询\n    log_error = /var/log/mysql/error.log\n    #　防止innodb ibdata1文件过大\n    innodb_file_per_table=1　\n    \n\n安装php\n\n    sudo apt-get install php5 libapache2-mod-php5 php5-mcrypt\n    #ubuntu16.04安装方法\n    # Add the PPA\n    apt-get install software-properties-common #如果提示没有 add-apt-repository，需要执行此命令安装\n    sudo add-apt-repository ppa:ondrej/php\n    # If you get add-apt-repository: command not found run the following command first :\n    sudo apt-get install software-properties-common\n    sudo apt-get update\n    sudo apt-get install php5.6\n    sudo apt-get install php5.6-*\n    \n\n配置php\n\n    vim /etc/php/5.6/apache/php.ini\n    expose_php = Off # 隐藏php版本信息\n    \n\n#### 静态文件同步\n\n定时任务 crontab -e # 编辑当前用户的定时任务 crontab -u hanchang -e # 编辑指定用户的定时任务\n\n    # m h  dom mon dow   command\n    # 分钟 小时 日期 月份 星期 命令\n    0 0 * * * /bin/sh /home/hanchang/www/scripts/rsyncHK.sh","slug":"ubuntu14.04服务器基础配置","published":1,"updated":"2019-07-23T05:51:43.847Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5py004j9ka4kigurotu","content":"<h4 id=\"登陆ssh\"><a href=\"#登陆ssh\" class=\"headerlink\" title=\"登陆ssh\"></a>登陆ssh</h4><pre><code>ssh root@ipaddress \npassword:</code></pre><h4 id=\"首次登陆出现的错误\"><a href=\"#首次登陆出现的错误\" class=\"headerlink\" title=\"首次登陆出现的错误\"></a>首次登陆出现的错误</h4><pre><code>perl: warning: Setting locale failed.\nperl: warning: Please check that your locale settings:\n\n\n# 安装 localepurge 管理语言文件\nsudo apt-get install localepurge\n# 或者之后自行配置\nsudo dpkg-reconfigure localepurge\n# 生成自己需要的语言\nsudo locale-gen zh_CN.UTF-8 en_US.UTF-8\n# 打印结果\nlocale\n# ssh连接时候指定语言\nLC_ALL=en_US.UTF-8 ssh &lt;host&gt;</code></pre><h4 id=\"创建用户\"><a href=\"#创建用户\" class=\"headerlink\" title=\"创建用户\"></a>创建用户</h4><pre><code>adduser hanchang\npassword:\nretry password:</code></pre><h4 id=\"将用户添加到sudo用户组\"><a href=\"#将用户添加到sudo用户组\" class=\"headerlink\" title=\"将用户添加到sudo用户组\"></a>将用户添加到sudo用户组</h4><p>错误提示</p>\n<pre><code>username is not in the sudoers file.\n\n\nsu -\npassword：\nchmod u+w /etc/sudoers   # 添加文件写权限\nroot ALL=(ALL) ALL 下面添加以下代码\nhanchang ALL=(ALL) NOPASSWD: ALL\n:wq 退出\nchmod u-w /etc/sudoers  # 取消文件写权限</code></pre><p>修改root密码</p>\n<pre><code>sudo passwd\npassword:\nretry password:</code></pre><h4 id=\"禁止root用户远程登陆ssh\"><a href=\"#禁止root用户远程登陆ssh\" class=\"headerlink\" title=\"禁止root用户远程登陆ssh\"></a>禁止root用户远程登陆ssh</h4><pre><code>cd /e   tc/ssh/\nsudo vim sshd_config\nPermitRootLogin yes改成PermitRootLogin no\nservice sshd restart    或者 /etc/init.d/sshd restart（ssh服务器重启）</code></pre><h4 id=\"指定IP地址登陆\"><a href=\"#指定IP地址登陆\" class=\"headerlink\" title=\"指定IP地址登陆\"></a>指定IP地址登陆</h4><pre><code>vim  /etc/hosts.allow\nsshd:192.168.220.164:allow  # 最后添加\n\nvim /etc/hosts.deny\nsshd:ALL #最后添加</code></pre><h4 id=\"避免sshd连接超时\"><a href=\"#避免sshd连接超时\" class=\"headerlink\" title=\"避免sshd连接超时\"></a>避免sshd连接超时</h4><p>修改客户端</p>\n<pre><code>sudo vim /etc/ssh/ssh_config\n# 添加\nServerAliveInterval 30   # 每30秒向服务器发起心跳\nServerAliveCountMax 6 # 允许6次无响应</code></pre><p>或者修改服务器端</p>\n<pre><code># 打开\nsudo vim /etc/ssh/sshd_config\n# 添加\nClientAliveInterval 30\nClientAliveCountMax 6</code></pre><h4 id=\"流量监控\"><a href=\"#流量监控\" class=\"headerlink\" title=\"流量监控\"></a>流量监控</h4><pre><code># 安装监控软件\nsudo apt-get install vnstat\n\n\n# 安装好后运行以下命令初始化数据库\n# eth0可以通过ifconfig查看\nsudo vnstat -u -i eth1\n\n\n# 修改配置文件\nsudo vim /etc/vnstat.conf\nInterface &quot;eth1&quot; #此处修改需要监控的网卡\n\n\n# 启动守护进程\nsudo /etc/init.d/vnstat start\n# 默认开机启动\nsudo update-rc.d vnstat enable</code></pre><h4 id=\"查看是否安装iptables\"><a href=\"#查看是否安装iptables\" class=\"headerlink\" title=\"查看是否安装iptables\"></a>查看是否安装iptables</h4><pre><code>iptables: /sbin/iptables /usr/share/iptables /usr/share/man/man8/iptables.8.gz #表示已经安装iptables\napt-get install iptables #如果默认没有安装，请运行此命令安装防火墙</code></pre><p>编辑iptables配置文件</p>\n<pre><code>sudo vi /etc/iptables.rules\n*filter\n:INPUT DROP [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n:syn-flood - [0:0]\n-A INPUT -i lo -j ACCEPT\n-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 20 -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 21 -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 443 -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT\n-A INPUT -p icmp -m limit --limit 100/sec --limit-burst 100 -j ACCEPT\n-A INPUT -p icmp -m limit --limit 1/s --limit-burst 10 -j ACCEPT\n-A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,ACK SYN -j syn-flood\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n-A syn-flood -p tcp -m limit --limit 3/sec --limit-burst 6 -j RETURN\n-A syn-flood -j REJECT --reject-with icmp-port-unreachable\nCOMMIT\n\n\n# sudo iptables-restore &lt; /etc/iptables.rules #使防火墙规则生效，重启主机执行此命令\n\n\n# 重启主机会使以上配置失效，以下内容为如何配置开机自动启动防火墙\n# vi /etc/network/if-pre-up.d/iptables #创建文件，添加以下内容，使防火墙开机启动\n#!/bin/bash\niptables-restore &lt; /etc/iptables.rules\n\n\n# chmod +x /etc/network/if-pre-up.d/iptables #添加执行权限\n# sudo iptables -L -n查看规则是否生效.</code></pre><h4 id=\"挂载新的硬盘\"><a href=\"#挂载新的硬盘\" class=\"headerlink\" title=\"挂载新的硬盘\"></a>挂载新的硬盘</h4><pre><code>fdisk -l\n如果出现\nDisk /dev/sdb doesn&apos;t contain a valid partition table\n说明没有分区,需要处理\nfdisk /dev/sdb\nCommand (m for help):  m为查看选项，这里我们输入n表示创建一个新的分区\n选中默认，在分区大小中填写分区大小 +500G</code></pre><p>第二步：使新创建的分区在系统中立即生效 root#partprobe 第三步：格式化新创建的分区</p>\n<pre><code>mkfs.ext3 /dev/hdb1</code></pre><p>第四步：使新创建的分区挂载/mnt/ssd_one 目录下</p>\n<pre><code>mount /dev/hda1 /mnt/rhce01</code></pre><p>查看已经挂载的信息</p>\n<pre><code>sudo vim /etc/mtab</code></pre><p>第五步：开机自动挂载</p>\n<pre><code>sudo vim /etc/fstab\n# 底部添加\n/dev/sdb1              /mnt/hdd_one              ext3    defaults        0 0</code></pre><p>查看现在的硬盘信息</p>\n<pre><code>root@m1095:~# df -hl\nFilesystem      Size  Used Avail Use% Mounted on\nudev             12G  4.0K   12G   1% /dev\ntmpfs           2.4G  632K  2.4G   1% /run\n/dev/sda2        71G  1.2G   66G   2% /\nnone            4.0K     0  4.0K   0% /sys/fs/cgroup\nnone            5.0M     0  5.0M   0% /run/lock\nnone             12G     0   12G   0% /run/shm\nnone            100M     0  100M   0% /run/user\n/dev/sda1       226M   35M  175M  17% /boot\n/dev/sdb1       493G   70M  467G   1% /mnt/hdd_one</code></pre><h4 id=\"ftp服务器搭建\"><a href=\"#ftp服务器搭建\" class=\"headerlink\" title=\"ftp服务器搭建\"></a>ftp服务器搭建</h4><pre><code>sudo apt-get install vsftpd</code></pre><p>编辑配置文件</p>\n<pre><code>sudo vim /etc/vsftpd.conf\n\n\nanonymous_enable=NO   # 禁止匿名用户\nlocal_enable=YES   # 允许本地用户\nwrite_enable=YES # 允许写入\nchroot_local_user=YES  # 登陆用户被限制在自己的home目录下\nallow_writeable_chroot=YES # 配合chroot_local_user=YES使用\n# 当chroot_local_user=YES表示chroot_list为可以访问其他目录的用户\n# 当chroot_local_user=NO表示chroot_list为不可以访问其他目录的用户，\n# chroot_list_enable=YES  \n# chroot_list_file=/etc/vsftpd.chroot_list\n\n# 以下内容为添加内容\n# 设置为YES表示开启用户登陆过滤，设置为NO表示不开启用户过滤，所有用户都可以访问\nuserlist_enable=YES\n# 在userlist_enable=YES的前提下，设置是否阻扯user_list文件中的用户登录FTP服务器\n# YES表示user_list为黑名单，在文件中的用户不能访问，不在文件中的用户可以访问\n# NO表示user_list 为白名单，在文件中的用户可以访问，不在文件中的用户不能访问\nuserlist_deny=YES\n\n\nsudo vim /etc/vsftpd.user_list\n添加root到文件中</code></pre><p>出现500 OOPS: vsftpd: refusing to run with writable root inside chroot()错误的时候 原因：chroot设置为yes的时候，需要取消ftp根目录的写权限</p>\n<pre><code>#### 在配置文件中添加此设置\nallow_writeable_chroot=YES </code></pre><h4 id=\"开启防火墙后vsftpd连接错误处理\"><a href=\"#开启防火墙后vsftpd连接错误处理\" class=\"headerlink\" title=\"开启防火墙后vsftpd连接错误处理\"></a>开启防火墙后vsftpd连接错误处理</h4><p>载入以下2个模块</p>\n<pre><code>sudo modprobe ip_nat_ftp\nsudo modprobe ip_conntrack_ftp\n\n\nsudo vi /etc/modules\n\n# Add these lines:\nip_nat_ftp\nip_conntrack_ftp</code></pre><p>重启vsftpd服务</p>\n<h4 id=\"安装lamp服务\"><a href=\"#安装lamp服务\" class=\"headerlink\" title=\"安装lamp服务\"></a>安装lamp服务</h4><p>安装apache</p>\n<pre><code>sudo apt-get install apache2\n# 将用户添加到apache用户组中\nsudo usermod -a -G www-data username # www-data 为apache用户组名，username为登陆用户名\n# apache2安装rewrite\nsudo a2enmod rewrite\nsudo service apache2 restart\n# 删除显示的版本信息\nServerTokens Prod\nServerSignature Off </code></pre><p>配置虚拟主机</p>\n<pre><code>sudo vim /etc/apache.2/apache2.conf\n# 添加以下内容\n&lt;Directory /home/zhc/www/&gt;\n        Options FollowSymLinks　#　不要加Index\n        AllowOverride All\n        Require all granted\n&lt;/Directory&gt;</code></pre><p>安装mysql</p>\n<pre><code>sudo apt-get install mysql-server php5-mysql\n＃配置mysql\nsudo mysql_secure_installation</code></pre><p>查看mysql是否开启慢查询日志</p>\n<pre><code>mysql&gt; show variables like &apos;%slow%&apos;;\n+---------------------------+---------------------------------------+\n| Variable_name             | Value                                 |\n+---------------------------+---------------------------------------+\n| log_slow_admin_statements | OFF                                   |\n| log_slow_slave_statements | OFF                                   |\n| slow_launch_time          | 2                                     |\n| slow_query_log            | OFF                                   |\n| slow_query_log_file       | /var/lib/mysql/NC-PH-1551-49-slow.log |\n+---------------------------+---------------------------------------+\n5 rows in set (0.00 sec)\n\n\n#开启慢查询\nmysql&gt; set global log_slow_queries  = &apos;ON&apos;;\nmysql&gt; show variables like &apos;%slow%&apos;;\n\n\n#开启常规查询\nvim /etc/myql/mysql.conf.d/mysqld.conf\ngeneral_log_file        = /var/log/mysql/mysql.log\ngeneral_log             = 1\n#开启错误查询\nlog_error = /var/log/mysql/error.log\n#　防止innodb ibdata1文件过大\ninnodb_file_per_table=1　</code></pre><p>安装php</p>\n<pre><code>sudo apt-get install php5 libapache2-mod-php5 php5-mcrypt\n#ubuntu16.04安装方法\n# Add the PPA\napt-get install software-properties-common #如果提示没有 add-apt-repository，需要执行此命令安装\nsudo add-apt-repository ppa:ondrej/php\n# If you get add-apt-repository: command not found run the following command first :\nsudo apt-get install software-properties-common\nsudo apt-get update\nsudo apt-get install php5.6\nsudo apt-get install php5.6-*</code></pre><p>配置php</p>\n<pre><code>vim /etc/php/5.6/apache/php.ini\nexpose_php = Off # 隐藏php版本信息</code></pre><h4 id=\"静态文件同步\"><a href=\"#静态文件同步\" class=\"headerlink\" title=\"静态文件同步\"></a>静态文件同步</h4><p>定时任务 crontab -e # 编辑当前用户的定时任务 crontab -u hanchang -e # 编辑指定用户的定时任务</p>\n<pre><code># m h  dom mon dow   command\n# 分钟 小时 日期 月份 星期 命令\n0 0 * * * /bin/sh /home/hanchang/www/scripts/rsyncHK.sh</code></pre>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"登陆ssh\"><a href=\"#登陆ssh\" class=\"headerlink\" title=\"登陆ssh\"></a>登陆ssh</h4><pre><code>ssh root@ipaddress \npassword:</code></pre><h4 id=\"首次登陆出现的错误\"><a href=\"#首次登陆出现的错误\" class=\"headerlink\" title=\"首次登陆出现的错误\"></a>首次登陆出现的错误</h4><pre><code>perl: warning: Setting locale failed.\nperl: warning: Please check that your locale settings:\n\n\n# 安装 localepurge 管理语言文件\nsudo apt-get install localepurge\n# 或者之后自行配置\nsudo dpkg-reconfigure localepurge\n# 生成自己需要的语言\nsudo locale-gen zh_CN.UTF-8 en_US.UTF-8\n# 打印结果\nlocale\n# ssh连接时候指定语言\nLC_ALL=en_US.UTF-8 ssh &lt;host&gt;</code></pre><h4 id=\"创建用户\"><a href=\"#创建用户\" class=\"headerlink\" title=\"创建用户\"></a>创建用户</h4><pre><code>adduser hanchang\npassword:\nretry password:</code></pre><h4 id=\"将用户添加到sudo用户组\"><a href=\"#将用户添加到sudo用户组\" class=\"headerlink\" title=\"将用户添加到sudo用户组\"></a>将用户添加到sudo用户组</h4><p>错误提示</p>\n<pre><code>username is not in the sudoers file.\n\n\nsu -\npassword：\nchmod u+w /etc/sudoers   # 添加文件写权限\nroot ALL=(ALL) ALL 下面添加以下代码\nhanchang ALL=(ALL) NOPASSWD: ALL\n:wq 退出\nchmod u-w /etc/sudoers  # 取消文件写权限</code></pre><p>修改root密码</p>\n<pre><code>sudo passwd\npassword:\nretry password:</code></pre><h4 id=\"禁止root用户远程登陆ssh\"><a href=\"#禁止root用户远程登陆ssh\" class=\"headerlink\" title=\"禁止root用户远程登陆ssh\"></a>禁止root用户远程登陆ssh</h4><pre><code>cd /e   tc/ssh/\nsudo vim sshd_config\nPermitRootLogin yes改成PermitRootLogin no\nservice sshd restart    或者 /etc/init.d/sshd restart（ssh服务器重启）</code></pre><h4 id=\"指定IP地址登陆\"><a href=\"#指定IP地址登陆\" class=\"headerlink\" title=\"指定IP地址登陆\"></a>指定IP地址登陆</h4><pre><code>vim  /etc/hosts.allow\nsshd:192.168.220.164:allow  # 最后添加\n\nvim /etc/hosts.deny\nsshd:ALL #最后添加</code></pre><h4 id=\"避免sshd连接超时\"><a href=\"#避免sshd连接超时\" class=\"headerlink\" title=\"避免sshd连接超时\"></a>避免sshd连接超时</h4><p>修改客户端</p>\n<pre><code>sudo vim /etc/ssh/ssh_config\n# 添加\nServerAliveInterval 30   # 每30秒向服务器发起心跳\nServerAliveCountMax 6 # 允许6次无响应</code></pre><p>或者修改服务器端</p>\n<pre><code># 打开\nsudo vim /etc/ssh/sshd_config\n# 添加\nClientAliveInterval 30\nClientAliveCountMax 6</code></pre><h4 id=\"流量监控\"><a href=\"#流量监控\" class=\"headerlink\" title=\"流量监控\"></a>流量监控</h4><pre><code># 安装监控软件\nsudo apt-get install vnstat\n\n\n# 安装好后运行以下命令初始化数据库\n# eth0可以通过ifconfig查看\nsudo vnstat -u -i eth1\n\n\n# 修改配置文件\nsudo vim /etc/vnstat.conf\nInterface &quot;eth1&quot; #此处修改需要监控的网卡\n\n\n# 启动守护进程\nsudo /etc/init.d/vnstat start\n# 默认开机启动\nsudo update-rc.d vnstat enable</code></pre><h4 id=\"查看是否安装iptables\"><a href=\"#查看是否安装iptables\" class=\"headerlink\" title=\"查看是否安装iptables\"></a>查看是否安装iptables</h4><pre><code>iptables: /sbin/iptables /usr/share/iptables /usr/share/man/man8/iptables.8.gz #表示已经安装iptables\napt-get install iptables #如果默认没有安装，请运行此命令安装防火墙</code></pre><p>编辑iptables配置文件</p>\n<pre><code>sudo vi /etc/iptables.rules\n*filter\n:INPUT DROP [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n:syn-flood - [0:0]\n-A INPUT -i lo -j ACCEPT\n-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 20 -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 21 -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 443 -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT\n-A INPUT -p icmp -m limit --limit 100/sec --limit-burst 100 -j ACCEPT\n-A INPUT -p icmp -m limit --limit 1/s --limit-burst 10 -j ACCEPT\n-A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,ACK SYN -j syn-flood\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n-A syn-flood -p tcp -m limit --limit 3/sec --limit-burst 6 -j RETURN\n-A syn-flood -j REJECT --reject-with icmp-port-unreachable\nCOMMIT\n\n\n# sudo iptables-restore &lt; /etc/iptables.rules #使防火墙规则生效，重启主机执行此命令\n\n\n# 重启主机会使以上配置失效，以下内容为如何配置开机自动启动防火墙\n# vi /etc/network/if-pre-up.d/iptables #创建文件，添加以下内容，使防火墙开机启动\n#!/bin/bash\niptables-restore &lt; /etc/iptables.rules\n\n\n# chmod +x /etc/network/if-pre-up.d/iptables #添加执行权限\n# sudo iptables -L -n查看规则是否生效.</code></pre><h4 id=\"挂载新的硬盘\"><a href=\"#挂载新的硬盘\" class=\"headerlink\" title=\"挂载新的硬盘\"></a>挂载新的硬盘</h4><pre><code>fdisk -l\n如果出现\nDisk /dev/sdb doesn&apos;t contain a valid partition table\n说明没有分区,需要处理\nfdisk /dev/sdb\nCommand (m for help):  m为查看选项，这里我们输入n表示创建一个新的分区\n选中默认，在分区大小中填写分区大小 +500G</code></pre><p>第二步：使新创建的分区在系统中立即生效 root#partprobe 第三步：格式化新创建的分区</p>\n<pre><code>mkfs.ext3 /dev/hdb1</code></pre><p>第四步：使新创建的分区挂载/mnt/ssd_one 目录下</p>\n<pre><code>mount /dev/hda1 /mnt/rhce01</code></pre><p>查看已经挂载的信息</p>\n<pre><code>sudo vim /etc/mtab</code></pre><p>第五步：开机自动挂载</p>\n<pre><code>sudo vim /etc/fstab\n# 底部添加\n/dev/sdb1              /mnt/hdd_one              ext3    defaults        0 0</code></pre><p>查看现在的硬盘信息</p>\n<pre><code>root@m1095:~# df -hl\nFilesystem      Size  Used Avail Use% Mounted on\nudev             12G  4.0K   12G   1% /dev\ntmpfs           2.4G  632K  2.4G   1% /run\n/dev/sda2        71G  1.2G   66G   2% /\nnone            4.0K     0  4.0K   0% /sys/fs/cgroup\nnone            5.0M     0  5.0M   0% /run/lock\nnone             12G     0   12G   0% /run/shm\nnone            100M     0  100M   0% /run/user\n/dev/sda1       226M   35M  175M  17% /boot\n/dev/sdb1       493G   70M  467G   1% /mnt/hdd_one</code></pre><h4 id=\"ftp服务器搭建\"><a href=\"#ftp服务器搭建\" class=\"headerlink\" title=\"ftp服务器搭建\"></a>ftp服务器搭建</h4><pre><code>sudo apt-get install vsftpd</code></pre><p>编辑配置文件</p>\n<pre><code>sudo vim /etc/vsftpd.conf\n\n\nanonymous_enable=NO   # 禁止匿名用户\nlocal_enable=YES   # 允许本地用户\nwrite_enable=YES # 允许写入\nchroot_local_user=YES  # 登陆用户被限制在自己的home目录下\nallow_writeable_chroot=YES # 配合chroot_local_user=YES使用\n# 当chroot_local_user=YES表示chroot_list为可以访问其他目录的用户\n# 当chroot_local_user=NO表示chroot_list为不可以访问其他目录的用户，\n# chroot_list_enable=YES  \n# chroot_list_file=/etc/vsftpd.chroot_list\n\n# 以下内容为添加内容\n# 设置为YES表示开启用户登陆过滤，设置为NO表示不开启用户过滤，所有用户都可以访问\nuserlist_enable=YES\n# 在userlist_enable=YES的前提下，设置是否阻扯user_list文件中的用户登录FTP服务器\n# YES表示user_list为黑名单，在文件中的用户不能访问，不在文件中的用户可以访问\n# NO表示user_list 为白名单，在文件中的用户可以访问，不在文件中的用户不能访问\nuserlist_deny=YES\n\n\nsudo vim /etc/vsftpd.user_list\n添加root到文件中</code></pre><p>出现500 OOPS: vsftpd: refusing to run with writable root inside chroot()错误的时候 原因：chroot设置为yes的时候，需要取消ftp根目录的写权限</p>\n<pre><code>#### 在配置文件中添加此设置\nallow_writeable_chroot=YES </code></pre><h4 id=\"开启防火墙后vsftpd连接错误处理\"><a href=\"#开启防火墙后vsftpd连接错误处理\" class=\"headerlink\" title=\"开启防火墙后vsftpd连接错误处理\"></a>开启防火墙后vsftpd连接错误处理</h4><p>载入以下2个模块</p>\n<pre><code>sudo modprobe ip_nat_ftp\nsudo modprobe ip_conntrack_ftp\n\n\nsudo vi /etc/modules\n\n# Add these lines:\nip_nat_ftp\nip_conntrack_ftp</code></pre><p>重启vsftpd服务</p>\n<h4 id=\"安装lamp服务\"><a href=\"#安装lamp服务\" class=\"headerlink\" title=\"安装lamp服务\"></a>安装lamp服务</h4><p>安装apache</p>\n<pre><code>sudo apt-get install apache2\n# 将用户添加到apache用户组中\nsudo usermod -a -G www-data username # www-data 为apache用户组名，username为登陆用户名\n# apache2安装rewrite\nsudo a2enmod rewrite\nsudo service apache2 restart\n# 删除显示的版本信息\nServerTokens Prod\nServerSignature Off </code></pre><p>配置虚拟主机</p>\n<pre><code>sudo vim /etc/apache.2/apache2.conf\n# 添加以下内容\n&lt;Directory /home/zhc/www/&gt;\n        Options FollowSymLinks　#　不要加Index\n        AllowOverride All\n        Require all granted\n&lt;/Directory&gt;</code></pre><p>安装mysql</p>\n<pre><code>sudo apt-get install mysql-server php5-mysql\n＃配置mysql\nsudo mysql_secure_installation</code></pre><p>查看mysql是否开启慢查询日志</p>\n<pre><code>mysql&gt; show variables like &apos;%slow%&apos;;\n+---------------------------+---------------------------------------+\n| Variable_name             | Value                                 |\n+---------------------------+---------------------------------------+\n| log_slow_admin_statements | OFF                                   |\n| log_slow_slave_statements | OFF                                   |\n| slow_launch_time          | 2                                     |\n| slow_query_log            | OFF                                   |\n| slow_query_log_file       | /var/lib/mysql/NC-PH-1551-49-slow.log |\n+---------------------------+---------------------------------------+\n5 rows in set (0.00 sec)\n\n\n#开启慢查询\nmysql&gt; set global log_slow_queries  = &apos;ON&apos;;\nmysql&gt; show variables like &apos;%slow%&apos;;\n\n\n#开启常规查询\nvim /etc/myql/mysql.conf.d/mysqld.conf\ngeneral_log_file        = /var/log/mysql/mysql.log\ngeneral_log             = 1\n#开启错误查询\nlog_error = /var/log/mysql/error.log\n#　防止innodb ibdata1文件过大\ninnodb_file_per_table=1　</code></pre><p>安装php</p>\n<pre><code>sudo apt-get install php5 libapache2-mod-php5 php5-mcrypt\n#ubuntu16.04安装方法\n# Add the PPA\napt-get install software-properties-common #如果提示没有 add-apt-repository，需要执行此命令安装\nsudo add-apt-repository ppa:ondrej/php\n# If you get add-apt-repository: command not found run the following command first :\nsudo apt-get install software-properties-common\nsudo apt-get update\nsudo apt-get install php5.6\nsudo apt-get install php5.6-*</code></pre><p>配置php</p>\n<pre><code>vim /etc/php/5.6/apache/php.ini\nexpose_php = Off # 隐藏php版本信息</code></pre><h4 id=\"静态文件同步\"><a href=\"#静态文件同步\" class=\"headerlink\" title=\"静态文件同步\"></a>静态文件同步</h4><p>定时任务 crontab -e # 编辑当前用户的定时任务 crontab -u hanchang -e # 编辑指定用户的定时任务</p>\n<pre><code># m h  dom mon dow   command\n# 分钟 小时 日期 月份 星期 命令\n0 0 * * * /bin/sh /home/hanchang/www/scripts/rsyncHK.sh</code></pre>"},{"title":"window常用软件","url":"21.html","id":"21","comments":0,"date":"2016-11-08T09:04:39.000Z","_content":"\n### 压缩软件7-zip\n\n终端命令(需要将安装目录添加到环境变量)\n\n> 7z a file.zip filefold #添加文件压缩  \n> 7z e file.zip filefold #释放文件解压\n\n### 电脑清理ccleaner\n\n电脑清理工具：清理注册表，系统垃圾文件 下载地址 [http://pan.baidu.com/s/1c0G34re](http://pan.baidu.com/s/1c0G34re)  \n断网后注册，可用注册码\n\n> 注册名： R J. van der Linden  \n> 注册码：CBEW-ZZJA-84DT-VZQG-SRJC  \n> 注册名：Registered User  \n> 注册码：CBB4-FJN4-EPC6-G5P6-QT4C\n\n### 卸载软件Total Uninstall\n\n电脑清理工具：卸载软件  \n破解版v6.16.0下载地址[http://pan.baidu.com/s/1mgwAta4](http://pan.baidu.com/s/1mgwAta4)\n\n### 驱动管理工具DriverDownloader\n\n下载地址 [http://pan.baidu.com/s/1qW9tPF2](http://pan.baidu.com/s/1qW9tPF2)  \n需要使用代理更新驱动，在Settings设置(前提是设置了代理上网)\n\n> proxy 127.0.0.1  \n> port 1080\n\n注册码\n\n> DF12-2RM2-JDPE-1009\n\n如果提示its usage limit 将1009改成逐渐+1，改成1010，1011等等等等\n\n### 下载工具IDM(Internet Download Manager)6.25版\n\n下载地址  \n[官网](http://www.internetdownloadmanager.com/download.html)  \n[官网下载版](http://pan.baidu.com/s/1c0Be5Bq)  \n[破解版](http://pan.baidu.com/s/1eQfmv8e)  \n注册码(断网注册)\n\n    DBNJC-D4R59-YPAGA-T3S1Q  #已经失效  \n    F9TZ9-P6IGF-SME74-2WP21  \n    CJA0S-K6CO4-R4NPJ-EKNRK  \n    F9TZ9-P6IGF-SME74-2WP21  \n    CJA0S-K6CO4-R4NPJ-EKNRK  \n    N0Z90-KJTTW-7TZO4-I27A1  \n    629U7-XLT5H-6SCGJ-2CENZ  \n    XONF7-PMUOL-HU7P4-D1QQX  \n    N0Z90-KJTTW-7TZO4-I27A1  \n    L67GT-CE6TR-DFT1D-XWVCM \n    \n\n或者使用host修改办法  \nhost文件添加\n\n    127.0.0.1 registeridm.com\n    127.0.0.1 www.registeridm.com\n    127.0.0.1 www.internetdownloadmanager.com\n    \n\n打开IDM，注册，注册码如下：\n\n    OS5HG-K90NH-SXOGT-7JYEZ\n    R2C1T-O0KQO-JAVU2-4MMYP\n    M2A16-47AAW-6NLYP-V1E0J\n    IZO7M-360FW-QY1XP-AWLPN\n    46YFS-S9G7H-QZFWI-QQBQB\n    TUTR2-I2NHO-GQBC6-ZECWH\n    \n\n### 终端管理工具Cmder\n\n下载地址[官方](http://cmder.net/)\n\n### 文件图片批量处理软件\n\nBulk Rename Utility  \n下载地址[官方](http://www.bulkrenameutility.co.uk/Main_Intro.php)[云盘](http://pan.baidu.com/s/1sjpaa1R)\n\n### 文件资源管理器Total Commander\n\n[破解版下载](http://pan.baidu.com/s/1dEvQm5b)  \n快捷键\n\n> F3——查看文件  \n> F4——编辑文件  \n> F5——拷贝文件  \n> F6——重命名、移动文件  \n> F7——新建文件夹  \n> F8——删除文件、文件夹  \n> F10——菜单条激活开关  \n> ALT  \n> Alt+F1——改变左边窗口的驱动器  \n> Alt+F2——改变右边窗口的驱动器  \n> Alt+Shift+F3——使用内部查看程序浏览文件  \n> Alt+F5——压缩文件/文件夹  \n> Alt+Shift+F5——压缩文件/文件夹，并删除原文件/文件夹  \n> Alt+F7——查找文件/文件夹  \n> Alt+F9——文件解压缩  \n> Alt+left/right——切换至上次进入的前一个/后一个文件夹  \n> Alt+down——显示历史访问地址列表  \n> SHIFT  \n> Shift+F4——用外部编辑器（UltraEdit）创建新文件  \n> Shift+F5——复制（重命名）文件/文件夹到当前文件夹  \n> Shift+Ctrl+F5——创建所选对象的快捷方式  \n> Shift+F6——重命名文件/文件夹  \n> Shift+ESC——Total Commander最小化  \n> NUM  \n> NUM + ——选择属性相同的一组文件  \n> NUM — ——清除所选文件中属性相同的一组文件  \n> NUM * ——反向选择  \n> NUM / ——恢复选择  \n> CTRL+NUM + ——全部选择  \n> CTRL+NUM - ——清除全部选择  \n> Alt+NUM + ——选择与当前光标选中的文件扩展名相同的一组文件  \n> CTRL  \n> Ctrl+PgUP——回上一级目录  \n> Ctrl+left/right——在左边/右边文件窗口中显示当前文件夹列表  \n> CTRL+/——返回根目录  \n> CTRL+SHIFT+F1——缩略图视图（图片预览）  \n> CTRL+F2——显示文件/文件夹详细资料  \n> CTRL+F3——以名称排序  \n> CTRL+F4——以扩展名排序  \n> CTRL+F5——以文件的创建时间排序  \n> CTRL+F6——以文件的大小排序  \n> CTRL+F8——显示目录结构  \n> CTRL+F9——打印当前光标处的文件  \n> CTRL+F10——显示所有文件  \n> CTRL+F11——显示所有可执行文件/隐藏非执行文件  \n> CTRL+ENTER——将当前文件名复制到TC的命令行  \n> CTRL+SHIFT+ENTER——将当前完整路径及文件名复制到TC的命令行  \n> CTRL+D——打开常用文件夹列表（可作书签用）  \n> CTRL+F——连接到FTP服务器  \n> CTRL+SHIFT+F——断开与FTP服务器的连接  \n> CTRL+Q——打开/关闭快速查看  \n> CTRL+U——切换左右文件窗口显示内容  \n> CTRL+W——关闭当前目录标签  \n> CTRL+SHIFT+W——关闭所有目录标签  \n> CTRL+Y——清空命令行输入框并置光标于命令行  \n> ESC——清空命令行输入框并置光标于文件窗口  \n> INSERT——选择文件/目录  \n> SPACE——选择文件/目录  \n> SHIFT+ENTER——  \n> 1.当命令行输入框有字符串命令：运行命令行的字符串命令  \n> 2.当光标位于压缩文件用相应的压缩工具打开压缩文件  \n> 3.位于压缩文件内：将所选中的文件解到临时文件目录，并试图将其做压缩文件的解压处理  \n> ALT+ENTER——显示所选文件属性  \n> Total Commander常用快捷键  \n> 显示编辑文件：  \n> F3：这个恐怕是使用程度最高的快捷键了，专门用来查看文件。需要说明的是，默认安装的TC 5.5版只能查看文本及一些关联的影像文件，图片只支持BMP等很少的种类。如需要查看更多类型的文件，还需要安装插件。  \n> Ctrl + Q：快速预览。  \n> F4：主要用来编辑文本文件。可以设置外部程序来编辑文本(我设置的是Editplus)。  \n> Shift + F4： 新建文本文件，调用记事本编辑（自定义编辑器）。  \n> Ctrl + Z： 编辑文件/文件夹的说明。  \n> Ctlt + Enter：查看文件或文件夹属性。  \n> 空格键：选择或取消选择文件，如在文件夹按下，则计算该文件夹占用空间。  \n> Shift + 空格： 选中光标所在，不计算文件夹的容量。  \n> Alt + Shift + Enter：计算当前窗格下所有文件夹的占用空间，设置后再点击顶栏的“大小”可使文件夹参与排序，迅速找到占用空间最大的文件夹。  \n> Ctrl+Shift+Enter获取光标所在处文件/文件夹的绝对路径并显示在命令行里。 操作复制文件  \n> F5：复制文件，这个也是最常用的快捷键之一。TC分为左、右两个窗口，我们把光标选中的文件拷贝到另一个窗口。另外，TC也支持以鼠标拖拽方式复制文件，两者哪个更方便完全由你的个人喜好决定。  \n> Shift + F5： 同目录复制  \n> F6：移动文件，将光标选中的文件移动到另一个窗口。  \n> shift+Ins TC中的块拷贝  \n> SHIFT + F6 重命名文件（F2修改版）  \n> Ctrl + M： 批量更改文件名。  \n> 空格 选择文件/文件夹(如同 INSERT)。如果光标处文件夹还未选中，按空格键后，计算其占用空间（含子文件夹）并用字节数代替\n> \n> （详细资料显示方式下）。通过 '配置' \\- '选项' \\- '操作' \\- '用空格键选择' 可禁用该特性。 右键长按 在NC风格下这是调用 Windows 风格下的右键菜单  \n> Shift + F10——显示关联试菜单，类似于鼠标右键的效果  \n> 新建  \n> SHIFT + F4 新建文本文件，加载到编辑器(自定义）  \n> F7：新建一个或多层文件夹。可以像DOS那样新建多层的目录，比如c:/file/a/b/c 删除  \n> F8 / Del：删除文件。与Windows一样，按住Shift + Delete，则直接删除而不放到回收站中。  \n> 搜索定位  \n> Alt + Ctrl + 任意字母 或 Alt+任意字母 或 任意字母 ：快速定位文件 \\[菜单：配置--选项--快速搜索 中设置\\]  \n> Alt + F7：搜索。有了TC之后，我再没用过Windows系统自带的搜索。TC的搜索简单，而且速度快，功能全，非常好用。  \n> Ctrl + D：常用文件夹列表。按下会弹出浮动窗口，能够快速跳转到设定好的文件夹中。(非常好用）  \n> ctrl + s: 快速搜索只显示所选文件  \n> Alt + ↓：历史文件夹列表，可以快速回溯到你曾经到过的某个文件夹。  \n> Alt + ← 或 →：快速后退或前进历史目录。  \n> Tab： 左右窗口间切换。  \n> Alt + Tab： 窗口标签间切换。  \n> 空格键：选择或取消选择文件，如在文件夹按下，则计算该文件夹占用空间。  \n> _(小键盘星号键)：反向选择。  \n> +(小键盘加号键)：选择全部或指定类型的文件。  \n> -(小键盘加号键)：取消选择全部或指定类型的文件。  \n> Ctrl + A：全选当前窗口所有文件。与Windows资源管理器不同，按下此快捷键并不选中文件夹。  \n> Shift + ↓ 和 Shift + ↑：选择或取消选择文件或文件夹。  \n> Ctrl+↑： 在当前窗口的新标签中打开光标处文件夹  \n> Ctrl+↓： 在对面窗口的新标签中打开光标处文件夹  \n> Ctrl + ←/→：如果光标在窗格顶部，将左/右窗格的显示内容调整为一样的；如果光标所在处是一个文件夹，在左/右窗格打开此文件夹；如果光标所在处是一个压缩文件，在左/右窗格打开此文件。  \n> Ctrl + num_ 锁定/解锁当前标签。  \n> ALT+F1 改变左侧窗口的驱动器  \n> ALT+F2 改变右侧窗口的驱动器  \n> 压缩文件  \n> Alt + F5：压缩选中的文件。按下回车，生成后的压缩包将会出现另一个目的窗口中。  \n> Alt + F6 解压缩文件  \n> 显示方式  \n> Ctrl + B： 显示当前文件夹及子文件夹下的所有文件。  \n> Ctrl + R： 刷新  \n> Ctrl + F1-8、10-12 不同方式在窗口显示文件列表\n\n### 翻译软件 灵格斯\n\n下载地址[http://www.lingoes.cn/](http://www.lingoes.cn/)\n\n### CorelDRAWX7破解版\n\n下载地址\\[百度网盘\\]（http://pan.baidu.com/s/1ntVwlgH）  \n断网注册\n\n### XMIND7破解版\n\n下载地址[百度网盘](http://pan.baidu.com/s/1i3OdeVr)","source":"_posts/window常用软件.md","raw":"---\ntitle: window常用软件\ntags:\n  - windows\nurl: 21.html\nid: 21\ncomments: false\ncategories:\n  - 办公\ndate: 2016-11-08 17:04:39\n---\n\n### 压缩软件7-zip\n\n终端命令(需要将安装目录添加到环境变量)\n\n> 7z a file.zip filefold #添加文件压缩  \n> 7z e file.zip filefold #释放文件解压\n\n### 电脑清理ccleaner\n\n电脑清理工具：清理注册表，系统垃圾文件 下载地址 [http://pan.baidu.com/s/1c0G34re](http://pan.baidu.com/s/1c0G34re)  \n断网后注册，可用注册码\n\n> 注册名： R J. van der Linden  \n> 注册码：CBEW-ZZJA-84DT-VZQG-SRJC  \n> 注册名：Registered User  \n> 注册码：CBB4-FJN4-EPC6-G5P6-QT4C\n\n### 卸载软件Total Uninstall\n\n电脑清理工具：卸载软件  \n破解版v6.16.0下载地址[http://pan.baidu.com/s/1mgwAta4](http://pan.baidu.com/s/1mgwAta4)\n\n### 驱动管理工具DriverDownloader\n\n下载地址 [http://pan.baidu.com/s/1qW9tPF2](http://pan.baidu.com/s/1qW9tPF2)  \n需要使用代理更新驱动，在Settings设置(前提是设置了代理上网)\n\n> proxy 127.0.0.1  \n> port 1080\n\n注册码\n\n> DF12-2RM2-JDPE-1009\n\n如果提示its usage limit 将1009改成逐渐+1，改成1010，1011等等等等\n\n### 下载工具IDM(Internet Download Manager)6.25版\n\n下载地址  \n[官网](http://www.internetdownloadmanager.com/download.html)  \n[官网下载版](http://pan.baidu.com/s/1c0Be5Bq)  \n[破解版](http://pan.baidu.com/s/1eQfmv8e)  \n注册码(断网注册)\n\n    DBNJC-D4R59-YPAGA-T3S1Q  #已经失效  \n    F9TZ9-P6IGF-SME74-2WP21  \n    CJA0S-K6CO4-R4NPJ-EKNRK  \n    F9TZ9-P6IGF-SME74-2WP21  \n    CJA0S-K6CO4-R4NPJ-EKNRK  \n    N0Z90-KJTTW-7TZO4-I27A1  \n    629U7-XLT5H-6SCGJ-2CENZ  \n    XONF7-PMUOL-HU7P4-D1QQX  \n    N0Z90-KJTTW-7TZO4-I27A1  \n    L67GT-CE6TR-DFT1D-XWVCM \n    \n\n或者使用host修改办法  \nhost文件添加\n\n    127.0.0.1 registeridm.com\n    127.0.0.1 www.registeridm.com\n    127.0.0.1 www.internetdownloadmanager.com\n    \n\n打开IDM，注册，注册码如下：\n\n    OS5HG-K90NH-SXOGT-7JYEZ\n    R2C1T-O0KQO-JAVU2-4MMYP\n    M2A16-47AAW-6NLYP-V1E0J\n    IZO7M-360FW-QY1XP-AWLPN\n    46YFS-S9G7H-QZFWI-QQBQB\n    TUTR2-I2NHO-GQBC6-ZECWH\n    \n\n### 终端管理工具Cmder\n\n下载地址[官方](http://cmder.net/)\n\n### 文件图片批量处理软件\n\nBulk Rename Utility  \n下载地址[官方](http://www.bulkrenameutility.co.uk/Main_Intro.php)[云盘](http://pan.baidu.com/s/1sjpaa1R)\n\n### 文件资源管理器Total Commander\n\n[破解版下载](http://pan.baidu.com/s/1dEvQm5b)  \n快捷键\n\n> F3——查看文件  \n> F4——编辑文件  \n> F5——拷贝文件  \n> F6——重命名、移动文件  \n> F7——新建文件夹  \n> F8——删除文件、文件夹  \n> F10——菜单条激活开关  \n> ALT  \n> Alt+F1——改变左边窗口的驱动器  \n> Alt+F2——改变右边窗口的驱动器  \n> Alt+Shift+F3——使用内部查看程序浏览文件  \n> Alt+F5——压缩文件/文件夹  \n> Alt+Shift+F5——压缩文件/文件夹，并删除原文件/文件夹  \n> Alt+F7——查找文件/文件夹  \n> Alt+F9——文件解压缩  \n> Alt+left/right——切换至上次进入的前一个/后一个文件夹  \n> Alt+down——显示历史访问地址列表  \n> SHIFT  \n> Shift+F4——用外部编辑器（UltraEdit）创建新文件  \n> Shift+F5——复制（重命名）文件/文件夹到当前文件夹  \n> Shift+Ctrl+F5——创建所选对象的快捷方式  \n> Shift+F6——重命名文件/文件夹  \n> Shift+ESC——Total Commander最小化  \n> NUM  \n> NUM + ——选择属性相同的一组文件  \n> NUM — ——清除所选文件中属性相同的一组文件  \n> NUM * ——反向选择  \n> NUM / ——恢复选择  \n> CTRL+NUM + ——全部选择  \n> CTRL+NUM - ——清除全部选择  \n> Alt+NUM + ——选择与当前光标选中的文件扩展名相同的一组文件  \n> CTRL  \n> Ctrl+PgUP——回上一级目录  \n> Ctrl+left/right——在左边/右边文件窗口中显示当前文件夹列表  \n> CTRL+/——返回根目录  \n> CTRL+SHIFT+F1——缩略图视图（图片预览）  \n> CTRL+F2——显示文件/文件夹详细资料  \n> CTRL+F3——以名称排序  \n> CTRL+F4——以扩展名排序  \n> CTRL+F5——以文件的创建时间排序  \n> CTRL+F6——以文件的大小排序  \n> CTRL+F8——显示目录结构  \n> CTRL+F9——打印当前光标处的文件  \n> CTRL+F10——显示所有文件  \n> CTRL+F11——显示所有可执行文件/隐藏非执行文件  \n> CTRL+ENTER——将当前文件名复制到TC的命令行  \n> CTRL+SHIFT+ENTER——将当前完整路径及文件名复制到TC的命令行  \n> CTRL+D——打开常用文件夹列表（可作书签用）  \n> CTRL+F——连接到FTP服务器  \n> CTRL+SHIFT+F——断开与FTP服务器的连接  \n> CTRL+Q——打开/关闭快速查看  \n> CTRL+U——切换左右文件窗口显示内容  \n> CTRL+W——关闭当前目录标签  \n> CTRL+SHIFT+W——关闭所有目录标签  \n> CTRL+Y——清空命令行输入框并置光标于命令行  \n> ESC——清空命令行输入框并置光标于文件窗口  \n> INSERT——选择文件/目录  \n> SPACE——选择文件/目录  \n> SHIFT+ENTER——  \n> 1.当命令行输入框有字符串命令：运行命令行的字符串命令  \n> 2.当光标位于压缩文件用相应的压缩工具打开压缩文件  \n> 3.位于压缩文件内：将所选中的文件解到临时文件目录，并试图将其做压缩文件的解压处理  \n> ALT+ENTER——显示所选文件属性  \n> Total Commander常用快捷键  \n> 显示编辑文件：  \n> F3：这个恐怕是使用程度最高的快捷键了，专门用来查看文件。需要说明的是，默认安装的TC 5.5版只能查看文本及一些关联的影像文件，图片只支持BMP等很少的种类。如需要查看更多类型的文件，还需要安装插件。  \n> Ctrl + Q：快速预览。  \n> F4：主要用来编辑文本文件。可以设置外部程序来编辑文本(我设置的是Editplus)。  \n> Shift + F4： 新建文本文件，调用记事本编辑（自定义编辑器）。  \n> Ctrl + Z： 编辑文件/文件夹的说明。  \n> Ctlt + Enter：查看文件或文件夹属性。  \n> 空格键：选择或取消选择文件，如在文件夹按下，则计算该文件夹占用空间。  \n> Shift + 空格： 选中光标所在，不计算文件夹的容量。  \n> Alt + Shift + Enter：计算当前窗格下所有文件夹的占用空间，设置后再点击顶栏的“大小”可使文件夹参与排序，迅速找到占用空间最大的文件夹。  \n> Ctrl+Shift+Enter获取光标所在处文件/文件夹的绝对路径并显示在命令行里。 操作复制文件  \n> F5：复制文件，这个也是最常用的快捷键之一。TC分为左、右两个窗口，我们把光标选中的文件拷贝到另一个窗口。另外，TC也支持以鼠标拖拽方式复制文件，两者哪个更方便完全由你的个人喜好决定。  \n> Shift + F5： 同目录复制  \n> F6：移动文件，将光标选中的文件移动到另一个窗口。  \n> shift+Ins TC中的块拷贝  \n> SHIFT + F6 重命名文件（F2修改版）  \n> Ctrl + M： 批量更改文件名。  \n> 空格 选择文件/文件夹(如同 INSERT)。如果光标处文件夹还未选中，按空格键后，计算其占用空间（含子文件夹）并用字节数代替\n> \n> （详细资料显示方式下）。通过 '配置' \\- '选项' \\- '操作' \\- '用空格键选择' 可禁用该特性。 右键长按 在NC风格下这是调用 Windows 风格下的右键菜单  \n> Shift + F10——显示关联试菜单，类似于鼠标右键的效果  \n> 新建  \n> SHIFT + F4 新建文本文件，加载到编辑器(自定义）  \n> F7：新建一个或多层文件夹。可以像DOS那样新建多层的目录，比如c:/file/a/b/c 删除  \n> F8 / Del：删除文件。与Windows一样，按住Shift + Delete，则直接删除而不放到回收站中。  \n> 搜索定位  \n> Alt + Ctrl + 任意字母 或 Alt+任意字母 或 任意字母 ：快速定位文件 \\[菜单：配置--选项--快速搜索 中设置\\]  \n> Alt + F7：搜索。有了TC之后，我再没用过Windows系统自带的搜索。TC的搜索简单，而且速度快，功能全，非常好用。  \n> Ctrl + D：常用文件夹列表。按下会弹出浮动窗口，能够快速跳转到设定好的文件夹中。(非常好用）  \n> ctrl + s: 快速搜索只显示所选文件  \n> Alt + ↓：历史文件夹列表，可以快速回溯到你曾经到过的某个文件夹。  \n> Alt + ← 或 →：快速后退或前进历史目录。  \n> Tab： 左右窗口间切换。  \n> Alt + Tab： 窗口标签间切换。  \n> 空格键：选择或取消选择文件，如在文件夹按下，则计算该文件夹占用空间。  \n> _(小键盘星号键)：反向选择。  \n> +(小键盘加号键)：选择全部或指定类型的文件。  \n> -(小键盘加号键)：取消选择全部或指定类型的文件。  \n> Ctrl + A：全选当前窗口所有文件。与Windows资源管理器不同，按下此快捷键并不选中文件夹。  \n> Shift + ↓ 和 Shift + ↑：选择或取消选择文件或文件夹。  \n> Ctrl+↑： 在当前窗口的新标签中打开光标处文件夹  \n> Ctrl+↓： 在对面窗口的新标签中打开光标处文件夹  \n> Ctrl + ←/→：如果光标在窗格顶部，将左/右窗格的显示内容调整为一样的；如果光标所在处是一个文件夹，在左/右窗格打开此文件夹；如果光标所在处是一个压缩文件，在左/右窗格打开此文件。  \n> Ctrl + num_ 锁定/解锁当前标签。  \n> ALT+F1 改变左侧窗口的驱动器  \n> ALT+F2 改变右侧窗口的驱动器  \n> 压缩文件  \n> Alt + F5：压缩选中的文件。按下回车，生成后的压缩包将会出现另一个目的窗口中。  \n> Alt + F6 解压缩文件  \n> 显示方式  \n> Ctrl + B： 显示当前文件夹及子文件夹下的所有文件。  \n> Ctrl + R： 刷新  \n> Ctrl + F1-8、10-12 不同方式在窗口显示文件列表\n\n### 翻译软件 灵格斯\n\n下载地址[http://www.lingoes.cn/](http://www.lingoes.cn/)\n\n### CorelDRAWX7破解版\n\n下载地址\\[百度网盘\\]（http://pan.baidu.com/s/1ntVwlgH）  \n断网注册\n\n### XMIND7破解版\n\n下载地址[百度网盘](http://pan.baidu.com/s/1i3OdeVr)","slug":"window常用软件","published":1,"updated":"2019-07-24T01:35:34.620Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5pz004n9ka4y866c03x","content":"<h3 id=\"压缩软件7-zip\"><a href=\"#压缩软件7-zip\" class=\"headerlink\" title=\"压缩软件7-zip\"></a>压缩软件7-zip</h3><p>终端命令(需要将安装目录添加到环境变量)</p>\n<blockquote>\n<p>7z a file.zip filefold #添加文件压缩<br>7z e file.zip filefold #释放文件解压</p>\n</blockquote>\n<h3 id=\"电脑清理ccleaner\"><a href=\"#电脑清理ccleaner\" class=\"headerlink\" title=\"电脑清理ccleaner\"></a>电脑清理ccleaner</h3><p>电脑清理工具：清理注册表，系统垃圾文件 下载地址 <a href=\"http://pan.baidu.com/s/1c0G34re\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1c0G34re</a><br>断网后注册，可用注册码</p>\n<blockquote>\n<p>注册名： R J. van der Linden<br>注册码：CBEW-ZZJA-84DT-VZQG-SRJC<br>注册名：Registered User<br>注册码：CBB4-FJN4-EPC6-G5P6-QT4C</p>\n</blockquote>\n<h3 id=\"卸载软件Total-Uninstall\"><a href=\"#卸载软件Total-Uninstall\" class=\"headerlink\" title=\"卸载软件Total Uninstall\"></a>卸载软件Total Uninstall</h3><p>电脑清理工具：卸载软件<br>破解版v6.16.0下载地址<a href=\"http://pan.baidu.com/s/1mgwAta4\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1mgwAta4</a></p>\n<h3 id=\"驱动管理工具DriverDownloader\"><a href=\"#驱动管理工具DriverDownloader\" class=\"headerlink\" title=\"驱动管理工具DriverDownloader\"></a>驱动管理工具DriverDownloader</h3><p>下载地址 <a href=\"http://pan.baidu.com/s/1qW9tPF2\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1qW9tPF2</a><br>需要使用代理更新驱动，在Settings设置(前提是设置了代理上网)</p>\n<blockquote>\n<p>proxy 127.0.0.1<br>port 1080</p>\n</blockquote>\n<p>注册码</p>\n<blockquote>\n<p>DF12-2RM2-JDPE-1009</p>\n</blockquote>\n<p>如果提示its usage limit 将1009改成逐渐+1，改成1010，1011等等等等</p>\n<h3 id=\"下载工具IDM-Internet-Download-Manager-6-25版\"><a href=\"#下载工具IDM-Internet-Download-Manager-6-25版\" class=\"headerlink\" title=\"下载工具IDM(Internet Download Manager)6.25版\"></a>下载工具IDM(Internet Download Manager)6.25版</h3><p>下载地址<br><a href=\"http://www.internetdownloadmanager.com/download.html\" target=\"_blank\" rel=\"noopener\">官网</a><br><a href=\"http://pan.baidu.com/s/1c0Be5Bq\" target=\"_blank\" rel=\"noopener\">官网下载版</a><br><a href=\"http://pan.baidu.com/s/1eQfmv8e\" target=\"_blank\" rel=\"noopener\">破解版</a><br>注册码(断网注册)</p>\n<pre><code>DBNJC-D4R59-YPAGA-T3S1Q  #已经失效  \nF9TZ9-P6IGF-SME74-2WP21  \nCJA0S-K6CO4-R4NPJ-EKNRK  \nF9TZ9-P6IGF-SME74-2WP21  \nCJA0S-K6CO4-R4NPJ-EKNRK  \nN0Z90-KJTTW-7TZO4-I27A1  \n629U7-XLT5H-6SCGJ-2CENZ  \nXONF7-PMUOL-HU7P4-D1QQX  \nN0Z90-KJTTW-7TZO4-I27A1  \nL67GT-CE6TR-DFT1D-XWVCM </code></pre><p>或者使用host修改办法<br>host文件添加</p>\n<pre><code>127.0.0.1 registeridm.com\n127.0.0.1 www.registeridm.com\n127.0.0.1 www.internetdownloadmanager.com</code></pre><p>打开IDM，注册，注册码如下：</p>\n<pre><code>OS5HG-K90NH-SXOGT-7JYEZ\nR2C1T-O0KQO-JAVU2-4MMYP\nM2A16-47AAW-6NLYP-V1E0J\nIZO7M-360FW-QY1XP-AWLPN\n46YFS-S9G7H-QZFWI-QQBQB\nTUTR2-I2NHO-GQBC6-ZECWH</code></pre><h3 id=\"终端管理工具Cmder\"><a href=\"#终端管理工具Cmder\" class=\"headerlink\" title=\"终端管理工具Cmder\"></a>终端管理工具Cmder</h3><p>下载地址<a href=\"http://cmder.net/\" target=\"_blank\" rel=\"noopener\">官方</a></p>\n<h3 id=\"文件图片批量处理软件\"><a href=\"#文件图片批量处理软件\" class=\"headerlink\" title=\"文件图片批量处理软件\"></a>文件图片批量处理软件</h3><p>Bulk Rename Utility<br>下载地址<a href=\"http://www.bulkrenameutility.co.uk/Main_Intro.php\" target=\"_blank\" rel=\"noopener\">官方</a><a href=\"http://pan.baidu.com/s/1sjpaa1R\" target=\"_blank\" rel=\"noopener\">云盘</a></p>\n<h3 id=\"文件资源管理器Total-Commander\"><a href=\"#文件资源管理器Total-Commander\" class=\"headerlink\" title=\"文件资源管理器Total Commander\"></a>文件资源管理器Total Commander</h3><p><a href=\"http://pan.baidu.com/s/1dEvQm5b\" target=\"_blank\" rel=\"noopener\">破解版下载</a><br>快捷键</p>\n<blockquote>\n<p>F3——查看文件<br>F4——编辑文件<br>F5——拷贝文件<br>F6——重命名、移动文件<br>F7——新建文件夹<br>F8——删除文件、文件夹<br>F10——菜单条激活开关<br>ALT<br>Alt+F1——改变左边窗口的驱动器<br>Alt+F2——改变右边窗口的驱动器<br>Alt+Shift+F3——使用内部查看程序浏览文件<br>Alt+F5——压缩文件/文件夹<br>Alt+Shift+F5——压缩文件/文件夹，并删除原文件/文件夹<br>Alt+F7——查找文件/文件夹<br>Alt+F9——文件解压缩<br>Alt+left/right——切换至上次进入的前一个/后一个文件夹<br>Alt+down——显示历史访问地址列表<br>SHIFT<br>Shift+F4——用外部编辑器（UltraEdit）创建新文件<br>Shift+F5——复制（重命名）文件/文件夹到当前文件夹<br>Shift+Ctrl+F5——创建所选对象的快捷方式<br>Shift+F6——重命名文件/文件夹<br>Shift+ESC——Total Commander最小化<br>NUM<br>NUM + ——选择属性相同的一组文件<br>NUM — ——清除所选文件中属性相同的一组文件<br>NUM * ——反向选择<br>NUM / ——恢复选择<br>CTRL+NUM + ——全部选择<br>CTRL+NUM - ——清除全部选择<br>Alt+NUM + ——选择与当前光标选中的文件扩展名相同的一组文件<br>CTRL<br>Ctrl+PgUP——回上一级目录<br>Ctrl+left/right——在左边/右边文件窗口中显示当前文件夹列表<br>CTRL+/——返回根目录<br>CTRL+SHIFT+F1——缩略图视图（图片预览）<br>CTRL+F2——显示文件/文件夹详细资料<br>CTRL+F3——以名称排序<br>CTRL+F4——以扩展名排序<br>CTRL+F5——以文件的创建时间排序<br>CTRL+F6——以文件的大小排序<br>CTRL+F8——显示目录结构<br>CTRL+F9——打印当前光标处的文件<br>CTRL+F10——显示所有文件<br>CTRL+F11——显示所有可执行文件/隐藏非执行文件<br>CTRL+ENTER——将当前文件名复制到TC的命令行<br>CTRL+SHIFT+ENTER——将当前完整路径及文件名复制到TC的命令行<br>CTRL+D——打开常用文件夹列表（可作书签用）<br>CTRL+F——连接到FTP服务器<br>CTRL+SHIFT+F——断开与FTP服务器的连接<br>CTRL+Q——打开/关闭快速查看<br>CTRL+U——切换左右文件窗口显示内容<br>CTRL+W——关闭当前目录标签<br>CTRL+SHIFT+W——关闭所有目录标签<br>CTRL+Y——清空命令行输入框并置光标于命令行<br>ESC——清空命令行输入框并置光标于文件窗口<br>INSERT——选择文件/目录<br>SPACE——选择文件/目录<br>SHIFT+ENTER——<br>1.当命令行输入框有字符串命令：运行命令行的字符串命令<br>2.当光标位于压缩文件用相应的压缩工具打开压缩文件<br>3.位于压缩文件内：将所选中的文件解到临时文件目录，并试图将其做压缩文件的解压处理<br>ALT+ENTER——显示所选文件属性<br>Total Commander常用快捷键<br>显示编辑文件：<br>F3：这个恐怕是使用程度最高的快捷键了，专门用来查看文件。需要说明的是，默认安装的TC 5.5版只能查看文本及一些关联的影像文件，图片只支持BMP等很少的种类。如需要查看更多类型的文件，还需要安装插件。<br>Ctrl + Q：快速预览。<br>F4：主要用来编辑文本文件。可以设置外部程序来编辑文本(我设置的是Editplus)。<br>Shift + F4： 新建文本文件，调用记事本编辑（自定义编辑器）。<br>Ctrl + Z： 编辑文件/文件夹的说明。<br>Ctlt + Enter：查看文件或文件夹属性。<br>空格键：选择或取消选择文件，如在文件夹按下，则计算该文件夹占用空间。<br>Shift + 空格： 选中光标所在，不计算文件夹的容量。<br>Alt + Shift + Enter：计算当前窗格下所有文件夹的占用空间，设置后再点击顶栏的“大小”可使文件夹参与排序，迅速找到占用空间最大的文件夹。<br>Ctrl+Shift+Enter获取光标所在处文件/文件夹的绝对路径并显示在命令行里。 操作复制文件<br>F5：复制文件，这个也是最常用的快捷键之一。TC分为左、右两个窗口，我们把光标选中的文件拷贝到另一个窗口。另外，TC也支持以鼠标拖拽方式复制文件，两者哪个更方便完全由你的个人喜好决定。<br>Shift + F5： 同目录复制<br>F6：移动文件，将光标选中的文件移动到另一个窗口。<br>shift+Ins TC中的块拷贝<br>SHIFT + F6 重命名文件（F2修改版）<br>Ctrl + M： 批量更改文件名。<br>空格 选择文件/文件夹(如同 INSERT)。如果光标处文件夹还未选中，按空格键后，计算其占用空间（含子文件夹）并用字节数代替</p>\n<p>（详细资料显示方式下）。通过 ‘配置’ - ‘选项’ - ‘操作’ - ‘用空格键选择’ 可禁用该特性。 右键长按 在NC风格下这是调用 Windows 风格下的右键菜单<br>Shift + F10——显示关联试菜单，类似于鼠标右键的效果<br>新建<br>SHIFT + F4 新建文本文件，加载到编辑器(自定义）<br>F7：新建一个或多层文件夹。可以像DOS那样新建多层的目录，比如c:/file/a/b/c 删除<br>F8 / Del：删除文件。与Windows一样，按住Shift + Delete，则直接删除而不放到回收站中。<br>搜索定位<br>Alt + Ctrl + 任意字母 或 Alt+任意字母 或 任意字母 ：快速定位文件 [菜单：配置–选项–快速搜索 中设置]<br>Alt + F7：搜索。有了TC之后，我再没用过Windows系统自带的搜索。TC的搜索简单，而且速度快，功能全，非常好用。<br>Ctrl + D：常用文件夹列表。按下会弹出浮动窗口，能够快速跳转到设定好的文件夹中。(非常好用）<br>ctrl + s: 快速搜索只显示所选文件<br>Alt + ↓：历史文件夹列表，可以快速回溯到你曾经到过的某个文件夹。<br>Alt + ← 或 →：快速后退或前进历史目录。<br>Tab： 左右窗口间切换。<br>Alt + Tab： 窗口标签间切换。<br>空格键：选择或取消选择文件，如在文件夹按下，则计算该文件夹占用空间。<br><em>(小键盘星号键)：反向选择。<br>+(小键盘加号键)：选择全部或指定类型的文件。<br>-(小键盘加号键)：取消选择全部或指定类型的文件。<br>Ctrl + A：全选当前窗口所有文件。与Windows资源管理器不同，按下此快捷键并不选中文件夹。<br>Shift + ↓ 和 Shift + ↑：选择或取消选择文件或文件夹。<br>Ctrl+↑： 在当前窗口的新标签中打开光标处文件夹<br>Ctrl+↓： 在对面窗口的新标签中打开光标处文件夹<br>Ctrl + ←/→：如果光标在窗格顶部，将左/右窗格的显示内容调整为一样的；如果光标所在处是一个文件夹，在左/右窗格打开此文件夹；如果光标所在处是一个压缩文件，在左/右窗格打开此文件。<br>Ctrl + num</em> 锁定/解锁当前标签。<br>ALT+F1 改变左侧窗口的驱动器<br>ALT+F2 改变右侧窗口的驱动器<br>压缩文件<br>Alt + F5：压缩选中的文件。按下回车，生成后的压缩包将会出现另一个目的窗口中。<br>Alt + F6 解压缩文件<br>显示方式<br>Ctrl + B： 显示当前文件夹及子文件夹下的所有文件。<br>Ctrl + R： 刷新<br>Ctrl + F1-8、10-12 不同方式在窗口显示文件列表</p>\n</blockquote>\n<h3 id=\"翻译软件-灵格斯\"><a href=\"#翻译软件-灵格斯\" class=\"headerlink\" title=\"翻译软件 灵格斯\"></a>翻译软件 灵格斯</h3><p>下载地址<a href=\"http://www.lingoes.cn/\" target=\"_blank\" rel=\"noopener\">http://www.lingoes.cn/</a></p>\n<h3 id=\"CorelDRAWX7破解版\"><a href=\"#CorelDRAWX7破解版\" class=\"headerlink\" title=\"CorelDRAWX7破解版\"></a>CorelDRAWX7破解版</h3><p>下载地址[百度网盘]（<a href=\"http://pan.baidu.com/s/1ntVwlgH）\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1ntVwlgH）</a><br>断网注册</p>\n<h3 id=\"XMIND7破解版\"><a href=\"#XMIND7破解版\" class=\"headerlink\" title=\"XMIND7破解版\"></a>XMIND7破解版</h3><p>下载地址<a href=\"http://pan.baidu.com/s/1i3OdeVr\" target=\"_blank\" rel=\"noopener\">百度网盘</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"压缩软件7-zip\"><a href=\"#压缩软件7-zip\" class=\"headerlink\" title=\"压缩软件7-zip\"></a>压缩软件7-zip</h3><p>终端命令(需要将安装目录添加到环境变量)</p>\n<blockquote>\n<p>7z a file.zip filefold #添加文件压缩<br>7z e file.zip filefold #释放文件解压</p>\n</blockquote>\n<h3 id=\"电脑清理ccleaner\"><a href=\"#电脑清理ccleaner\" class=\"headerlink\" title=\"电脑清理ccleaner\"></a>电脑清理ccleaner</h3><p>电脑清理工具：清理注册表，系统垃圾文件 下载地址 <a href=\"http://pan.baidu.com/s/1c0G34re\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1c0G34re</a><br>断网后注册，可用注册码</p>\n<blockquote>\n<p>注册名： R J. van der Linden<br>注册码：CBEW-ZZJA-84DT-VZQG-SRJC<br>注册名：Registered User<br>注册码：CBB4-FJN4-EPC6-G5P6-QT4C</p>\n</blockquote>\n<h3 id=\"卸载软件Total-Uninstall\"><a href=\"#卸载软件Total-Uninstall\" class=\"headerlink\" title=\"卸载软件Total Uninstall\"></a>卸载软件Total Uninstall</h3><p>电脑清理工具：卸载软件<br>破解版v6.16.0下载地址<a href=\"http://pan.baidu.com/s/1mgwAta4\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1mgwAta4</a></p>\n<h3 id=\"驱动管理工具DriverDownloader\"><a href=\"#驱动管理工具DriverDownloader\" class=\"headerlink\" title=\"驱动管理工具DriverDownloader\"></a>驱动管理工具DriverDownloader</h3><p>下载地址 <a href=\"http://pan.baidu.com/s/1qW9tPF2\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1qW9tPF2</a><br>需要使用代理更新驱动，在Settings设置(前提是设置了代理上网)</p>\n<blockquote>\n<p>proxy 127.0.0.1<br>port 1080</p>\n</blockquote>\n<p>注册码</p>\n<blockquote>\n<p>DF12-2RM2-JDPE-1009</p>\n</blockquote>\n<p>如果提示its usage limit 将1009改成逐渐+1，改成1010，1011等等等等</p>\n<h3 id=\"下载工具IDM-Internet-Download-Manager-6-25版\"><a href=\"#下载工具IDM-Internet-Download-Manager-6-25版\" class=\"headerlink\" title=\"下载工具IDM(Internet Download Manager)6.25版\"></a>下载工具IDM(Internet Download Manager)6.25版</h3><p>下载地址<br><a href=\"http://www.internetdownloadmanager.com/download.html\" target=\"_blank\" rel=\"noopener\">官网</a><br><a href=\"http://pan.baidu.com/s/1c0Be5Bq\" target=\"_blank\" rel=\"noopener\">官网下载版</a><br><a href=\"http://pan.baidu.com/s/1eQfmv8e\" target=\"_blank\" rel=\"noopener\">破解版</a><br>注册码(断网注册)</p>\n<pre><code>DBNJC-D4R59-YPAGA-T3S1Q  #已经失效  \nF9TZ9-P6IGF-SME74-2WP21  \nCJA0S-K6CO4-R4NPJ-EKNRK  \nF9TZ9-P6IGF-SME74-2WP21  \nCJA0S-K6CO4-R4NPJ-EKNRK  \nN0Z90-KJTTW-7TZO4-I27A1  \n629U7-XLT5H-6SCGJ-2CENZ  \nXONF7-PMUOL-HU7P4-D1QQX  \nN0Z90-KJTTW-7TZO4-I27A1  \nL67GT-CE6TR-DFT1D-XWVCM </code></pre><p>或者使用host修改办法<br>host文件添加</p>\n<pre><code>127.0.0.1 registeridm.com\n127.0.0.1 www.registeridm.com\n127.0.0.1 www.internetdownloadmanager.com</code></pre><p>打开IDM，注册，注册码如下：</p>\n<pre><code>OS5HG-K90NH-SXOGT-7JYEZ\nR2C1T-O0KQO-JAVU2-4MMYP\nM2A16-47AAW-6NLYP-V1E0J\nIZO7M-360FW-QY1XP-AWLPN\n46YFS-S9G7H-QZFWI-QQBQB\nTUTR2-I2NHO-GQBC6-ZECWH</code></pre><h3 id=\"终端管理工具Cmder\"><a href=\"#终端管理工具Cmder\" class=\"headerlink\" title=\"终端管理工具Cmder\"></a>终端管理工具Cmder</h3><p>下载地址<a href=\"http://cmder.net/\" target=\"_blank\" rel=\"noopener\">官方</a></p>\n<h3 id=\"文件图片批量处理软件\"><a href=\"#文件图片批量处理软件\" class=\"headerlink\" title=\"文件图片批量处理软件\"></a>文件图片批量处理软件</h3><p>Bulk Rename Utility<br>下载地址<a href=\"http://www.bulkrenameutility.co.uk/Main_Intro.php\" target=\"_blank\" rel=\"noopener\">官方</a><a href=\"http://pan.baidu.com/s/1sjpaa1R\" target=\"_blank\" rel=\"noopener\">云盘</a></p>\n<h3 id=\"文件资源管理器Total-Commander\"><a href=\"#文件资源管理器Total-Commander\" class=\"headerlink\" title=\"文件资源管理器Total Commander\"></a>文件资源管理器Total Commander</h3><p><a href=\"http://pan.baidu.com/s/1dEvQm5b\" target=\"_blank\" rel=\"noopener\">破解版下载</a><br>快捷键</p>\n<blockquote>\n<p>F3——查看文件<br>F4——编辑文件<br>F5——拷贝文件<br>F6——重命名、移动文件<br>F7——新建文件夹<br>F8——删除文件、文件夹<br>F10——菜单条激活开关<br>ALT<br>Alt+F1——改变左边窗口的驱动器<br>Alt+F2——改变右边窗口的驱动器<br>Alt+Shift+F3——使用内部查看程序浏览文件<br>Alt+F5——压缩文件/文件夹<br>Alt+Shift+F5——压缩文件/文件夹，并删除原文件/文件夹<br>Alt+F7——查找文件/文件夹<br>Alt+F9——文件解压缩<br>Alt+left/right——切换至上次进入的前一个/后一个文件夹<br>Alt+down——显示历史访问地址列表<br>SHIFT<br>Shift+F4——用外部编辑器（UltraEdit）创建新文件<br>Shift+F5——复制（重命名）文件/文件夹到当前文件夹<br>Shift+Ctrl+F5——创建所选对象的快捷方式<br>Shift+F6——重命名文件/文件夹<br>Shift+ESC——Total Commander最小化<br>NUM<br>NUM + ——选择属性相同的一组文件<br>NUM — ——清除所选文件中属性相同的一组文件<br>NUM * ——反向选择<br>NUM / ——恢复选择<br>CTRL+NUM + ——全部选择<br>CTRL+NUM - ——清除全部选择<br>Alt+NUM + ——选择与当前光标选中的文件扩展名相同的一组文件<br>CTRL<br>Ctrl+PgUP——回上一级目录<br>Ctrl+left/right——在左边/右边文件窗口中显示当前文件夹列表<br>CTRL+/——返回根目录<br>CTRL+SHIFT+F1——缩略图视图（图片预览）<br>CTRL+F2——显示文件/文件夹详细资料<br>CTRL+F3——以名称排序<br>CTRL+F4——以扩展名排序<br>CTRL+F5——以文件的创建时间排序<br>CTRL+F6——以文件的大小排序<br>CTRL+F8——显示目录结构<br>CTRL+F9——打印当前光标处的文件<br>CTRL+F10——显示所有文件<br>CTRL+F11——显示所有可执行文件/隐藏非执行文件<br>CTRL+ENTER——将当前文件名复制到TC的命令行<br>CTRL+SHIFT+ENTER——将当前完整路径及文件名复制到TC的命令行<br>CTRL+D——打开常用文件夹列表（可作书签用）<br>CTRL+F——连接到FTP服务器<br>CTRL+SHIFT+F——断开与FTP服务器的连接<br>CTRL+Q——打开/关闭快速查看<br>CTRL+U——切换左右文件窗口显示内容<br>CTRL+W——关闭当前目录标签<br>CTRL+SHIFT+W——关闭所有目录标签<br>CTRL+Y——清空命令行输入框并置光标于命令行<br>ESC——清空命令行输入框并置光标于文件窗口<br>INSERT——选择文件/目录<br>SPACE——选择文件/目录<br>SHIFT+ENTER——<br>1.当命令行输入框有字符串命令：运行命令行的字符串命令<br>2.当光标位于压缩文件用相应的压缩工具打开压缩文件<br>3.位于压缩文件内：将所选中的文件解到临时文件目录，并试图将其做压缩文件的解压处理<br>ALT+ENTER——显示所选文件属性<br>Total Commander常用快捷键<br>显示编辑文件：<br>F3：这个恐怕是使用程度最高的快捷键了，专门用来查看文件。需要说明的是，默认安装的TC 5.5版只能查看文本及一些关联的影像文件，图片只支持BMP等很少的种类。如需要查看更多类型的文件，还需要安装插件。<br>Ctrl + Q：快速预览。<br>F4：主要用来编辑文本文件。可以设置外部程序来编辑文本(我设置的是Editplus)。<br>Shift + F4： 新建文本文件，调用记事本编辑（自定义编辑器）。<br>Ctrl + Z： 编辑文件/文件夹的说明。<br>Ctlt + Enter：查看文件或文件夹属性。<br>空格键：选择或取消选择文件，如在文件夹按下，则计算该文件夹占用空间。<br>Shift + 空格： 选中光标所在，不计算文件夹的容量。<br>Alt + Shift + Enter：计算当前窗格下所有文件夹的占用空间，设置后再点击顶栏的“大小”可使文件夹参与排序，迅速找到占用空间最大的文件夹。<br>Ctrl+Shift+Enter获取光标所在处文件/文件夹的绝对路径并显示在命令行里。 操作复制文件<br>F5：复制文件，这个也是最常用的快捷键之一。TC分为左、右两个窗口，我们把光标选中的文件拷贝到另一个窗口。另外，TC也支持以鼠标拖拽方式复制文件，两者哪个更方便完全由你的个人喜好决定。<br>Shift + F5： 同目录复制<br>F6：移动文件，将光标选中的文件移动到另一个窗口。<br>shift+Ins TC中的块拷贝<br>SHIFT + F6 重命名文件（F2修改版）<br>Ctrl + M： 批量更改文件名。<br>空格 选择文件/文件夹(如同 INSERT)。如果光标处文件夹还未选中，按空格键后，计算其占用空间（含子文件夹）并用字节数代替</p>\n<p>（详细资料显示方式下）。通过 ‘配置’ - ‘选项’ - ‘操作’ - ‘用空格键选择’ 可禁用该特性。 右键长按 在NC风格下这是调用 Windows 风格下的右键菜单<br>Shift + F10——显示关联试菜单，类似于鼠标右键的效果<br>新建<br>SHIFT + F4 新建文本文件，加载到编辑器(自定义）<br>F7：新建一个或多层文件夹。可以像DOS那样新建多层的目录，比如c:/file/a/b/c 删除<br>F8 / Del：删除文件。与Windows一样，按住Shift + Delete，则直接删除而不放到回收站中。<br>搜索定位<br>Alt + Ctrl + 任意字母 或 Alt+任意字母 或 任意字母 ：快速定位文件 [菜单：配置–选项–快速搜索 中设置]<br>Alt + F7：搜索。有了TC之后，我再没用过Windows系统自带的搜索。TC的搜索简单，而且速度快，功能全，非常好用。<br>Ctrl + D：常用文件夹列表。按下会弹出浮动窗口，能够快速跳转到设定好的文件夹中。(非常好用）<br>ctrl + s: 快速搜索只显示所选文件<br>Alt + ↓：历史文件夹列表，可以快速回溯到你曾经到过的某个文件夹。<br>Alt + ← 或 →：快速后退或前进历史目录。<br>Tab： 左右窗口间切换。<br>Alt + Tab： 窗口标签间切换。<br>空格键：选择或取消选择文件，如在文件夹按下，则计算该文件夹占用空间。<br><em>(小键盘星号键)：反向选择。<br>+(小键盘加号键)：选择全部或指定类型的文件。<br>-(小键盘加号键)：取消选择全部或指定类型的文件。<br>Ctrl + A：全选当前窗口所有文件。与Windows资源管理器不同，按下此快捷键并不选中文件夹。<br>Shift + ↓ 和 Shift + ↑：选择或取消选择文件或文件夹。<br>Ctrl+↑： 在当前窗口的新标签中打开光标处文件夹<br>Ctrl+↓： 在对面窗口的新标签中打开光标处文件夹<br>Ctrl + ←/→：如果光标在窗格顶部，将左/右窗格的显示内容调整为一样的；如果光标所在处是一个文件夹，在左/右窗格打开此文件夹；如果光标所在处是一个压缩文件，在左/右窗格打开此文件。<br>Ctrl + num</em> 锁定/解锁当前标签。<br>ALT+F1 改变左侧窗口的驱动器<br>ALT+F2 改变右侧窗口的驱动器<br>压缩文件<br>Alt + F5：压缩选中的文件。按下回车，生成后的压缩包将会出现另一个目的窗口中。<br>Alt + F6 解压缩文件<br>显示方式<br>Ctrl + B： 显示当前文件夹及子文件夹下的所有文件。<br>Ctrl + R： 刷新<br>Ctrl + F1-8、10-12 不同方式在窗口显示文件列表</p>\n</blockquote>\n<h3 id=\"翻译软件-灵格斯\"><a href=\"#翻译软件-灵格斯\" class=\"headerlink\" title=\"翻译软件 灵格斯\"></a>翻译软件 灵格斯</h3><p>下载地址<a href=\"http://www.lingoes.cn/\" target=\"_blank\" rel=\"noopener\">http://www.lingoes.cn/</a></p>\n<h3 id=\"CorelDRAWX7破解版\"><a href=\"#CorelDRAWX7破解版\" class=\"headerlink\" title=\"CorelDRAWX7破解版\"></a>CorelDRAWX7破解版</h3><p>下载地址[百度网盘]（<a href=\"http://pan.baidu.com/s/1ntVwlgH）\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1ntVwlgH）</a><br>断网注册</p>\n<h3 id=\"XMIND7破解版\"><a href=\"#XMIND7破解版\" class=\"headerlink\" title=\"XMIND7破解版\"></a>XMIND7破解版</h3><p>下载地址<a href=\"http://pan.baidu.com/s/1i3OdeVr\" target=\"_blank\" rel=\"noopener\">百度网盘</a></p>\n"},{"title":"ubuntu16.04安装及使用docker(一)","url":"245.html","id":"245","comments":0,"date":"2017-11-20T03:45:42.000Z","_content":"\n### 删除旧版本\n\n    sudo apt-get remove docker docker-engine docker.io\n    \n\n### 安装\n\n    $ sudo apt-get update\n    # 安装依赖\n    $ sudo apt-get install  apt-transport-https ca-certificates curl software-properties-common\n    # 添加官方key\n    $ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\n    # 查找key\n    $ sudo apt-key fingerprint 0EBFCD88\n    pub   4096R/0EBFCD88 2017-02-22\n          Key fingerprint = 9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88\n    uid                  Docker Release (CE deb) <docker@docker.com>\n    sub   4096R/F273FCD8 2017-02-22\n    # 获取资源\n    sudo add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\"\n    # 查找合适的版本\n    $ apt-cache madison docker-ce\n    docker-ce | 17.09.0~ce-0~ubuntu | https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages\n    # 安装\n    $ sudo apt-get install docker-ce=<VERSION>\n    # 打印安装结果\n    $ sudo docker version\n    Client:\n     Version:      17.09.0-ce\n     API version:  1.32\n     Go version:   go1.8.3\n     Git commit:   afdb6d4\n     Built:        Tue Sep 26 22:42:18 2017\n     OS/Arch:      linux/amd64\n    \n    Server:\n     Version:      17.09.0-ce\n     API version:  1.32 (minimum version 1.12)\n     Go version:   go1.8.3\n     Git commit:   afdb6d4\n     Built:        Tue Sep 26 22:40:56 2017\n     OS/Arch:      linux/amd64\n     Experimental: false\n    \n    \n\n### 将用户加入docker用户组，这样不需要输入sudo\n\n    1. sudo cat /etc/group | grep docker \n    2. 如果不存在docker组，可以添加sudo groupadd docker \n    3. 添加当前用户到docker组，sudo usermod -aG  docker $USER \n    4. 重启docker服务,sudo systemctl restart docker \n    5. 如果权限不够，sudo chmod a+rw /var/run/docker.sock　\n    6. sudo chown -R $USER ~/.docker\n    \n\n### 启动测试\n\n    $ sudo  docker run hello-world\n    Unable to find image 'hello-world:latest' locally\n    \n    latest: Pulling from library/hello-world\n    9a0669468bf7: Pull complete\n    Digest: sha256:0e06ef5e1945a718b02a8c319e15bae44f47039005530bc617a5d071190ed3fc\n    Status: Downloaded newer image for hello-world:latest\n    \n    Hello from Docker!\n    This message shows that your installation appears to be working correctly.\n    \n    To generate this message, Docker took the following steps:\n     1. The Docker client contacted the Docker daemon.\n     2. The Docker daemon pulled the \"hello-world\" image from the Docker Hub.\n     3. The Docker daemon created a new container from that image which runs the\n        executable that produces the output you are currently reading.\n     4. The Docker daemon streamed that output to the Docker client, which sent it\n        to your terminal.\n    \n    To try something more ambitious, you can run an Ubuntu container with:\n     $ docker run -it ubuntu bash\n    \n    Share images, automate workflows, and more with a free Docker ID:\n     https://cloud.docker.com/\n    \n    For more examples and ideas, visit:\n     https://docs.docker.com/engine/userguide/\n    \n\n### 更换镜像源\n\n    # 可以修改 /etc/docker/daemon.json 文件并添加上 registry-mirrors 键值,没有就创建一个\n    \n    {\n      \"registry-mirrors\": [\"https://registry.docker-cn.com\"]\n    }\n    \n\n### 安装ctop查看容器状态\n\n    # https://github.com/bcicen/ctop\n    $ sudo wget https://github.com/bcicen/ctop/releases/download/v0.6.1/ctop-0.6.1-linux-amd64 -O /usr/local/bin/ctop\n    $ sudo chmod +x /usr/local/bin/ctop\n    \n\n### 第一个实例\n\n    # 第一次使用会下载debian的镜像文件\n    $ sudo docker run debian echo 'hello world'\n    > Unable to find image 'debian' locally\n    > ......\n    \n\n    # -i -t 表示进行交互会话\n    $ sudo docker run -i -t debian /user/bash\n    root@622ac5689680:/#  echo 'hello world'\n    > hello world\n    root@622ac5689680:/# exit\n    > exit\n    \n\n    # 基本命令\n    $ sudo docker run -h container -i -t debian /bin/bash #-h表示主机名称\n    $ sudo docker ps  # 查看当前运行的主机\n    $ sudo docker ps -a # 查看全部的主机\n    $sudo docker events  # 查看守护进程\n    $ sudo docker inspect HOST_NAME 　# 查看HOST_NAME的信息\n    $ sudo docker port HOST_NAME # 查看端口映射信息\n    $ sudo docker diff HOST_NAME　# 查看更改的信息\n    $ sudo docker logs HOST_NAME   # 打印log信息\n    $ sudo docker rm HOST_NAME  # 删除\n    $ sudo docker pull redis  # 拉取镜像\n    $ sudo docker create redis # 创建容器\n    $ sudo docker start zen_brown # 开启容器（kitematic是绿色波浪线）\n    $ sudo docker stop zen_brown # 停止容器（kitematic是灰色直线）\n    $ sudo docker pause zen_brown  # 暂停容器kitematic是灰色波浪线）\n    $ sudo docker commit zen_brown # 将容器变成镜像\n    $ sudo docker run redis /bin/bash\n    $ sudo docker attach zen_brown # 查看容器内进程\n    $ sudo docker cp # 在容器和主机之间复制内容\n    $ sudo docker exec # 在容器中运行命令\n    $ sudo docker kill # 容器立即退出\n    \n\n### 创建dockerfile镜像\n\n    # 创建项目\n    $ mkdir cowsay\n    $ cd cowsay\n    $ vim Dockerfile\n    ~ FROM debian:wheezy\n    ~ RUN apt-get update && apt-get install -y cowsay fortune\n    ~ :wq\n    # 创建\n    $ sudo docker build -t test/cowsay-dockerfile . \n    > Sending build content to Docker .....\n    > ....\n    # 运行\n    $ sudo docker run test/cowsay-dockerfile /usr/games/cowsay 'Moo'\n    \n\n    # 使用entrypoint指令\n    $ vim Dockerfile\n    ~ FROM debian:wheezy\n    ~ RUN apt-get update && apt-get install -y cowsay fortune\n    ~ ENTRYPOINTER [\"/usr/games/cowsay\"]\n    ~ :wq \n    # 创建\n    $ sudo docker build -t test/cowsay-dockerfile . \n    > Sending build content to Docker .....\n    > ....\n    # 运行\n    $ sudo docker run test/cowsay-dockerfile  'Moo'\n    \n\n    # 使用脚本解决entrypoint\n    $ vim entrypoint.sh\n    ~ #! /bin/bash\n    ~ if [ $# -eq 0 ]; then\n    ~      /usr/games/fortune | /usr/games/cowsay\n    ~  else\n    ~     /usr/games/cowsay \"$@\"\n    ~   fi\n    ~ :wq\n    $ chmod +x entrypoint.sh\n    $ vim Dockerfile\n    ~ FROM debian:wheezy\n    ~ RUN apt-get update && apt-get install -y cowsay fortune\n    ~ COPY entrypoint.sh /\n    ~ ENTRYPOINTER [\"/entrypoint.sh\"]\n    ~ :wq \n    # 创建\n    $ sudo docker build -t test/cowsay-dockerfile . \n    > Sending build content to Docker .....\n    > ....\n    # 运行\n    $ sudo docker run test/cowsay-dockerfile 'Moo'\n    \n\n### 使用在线仓库\n\n在线注册地址：　https://cloud.docker.com\n\n    # 登陆\n    $ sudo docker login\n    $ username:\n    $ password:\n    # 填写作者信息\n    $ vim Dockerfile\n    ~ FROM debian:wheezy\n    ~ MAINTAINER username <username@mail.com>\n    ~ RUN apt-get update && apt-get install -y cowsay fortune\n    ~ COPY entrypoint.sh /\n    ~ ENTRYPOINTER [\"/entrypoint.sh\"]\n    ~ :wq \n    # 创建\n    $ sudo docker build -t username/cowsay-dockerfile . \n    > Sending build content to Docker .....\n    > ....\n    # 运行\n    $ sudo docker run username/cowsay-dockerfile  'Moo'\n    # 上传\n    $ sudo docker push \n    \n\n### 容器连接\n\n    $ sudo docker run --name myredis -d redis # -d表示后台运行\n    ~ a1696406326aaaa6c28931e886b8dd664d191b083de4aed464d584b4720d57b1\n    $ docker run --rm -it --link myredis:redis redis /bin/bash\n    > root@9c914447f5e1:/data# redis-cli -h redis -p 6379\n    > redis:6379> ping\n    > PONG\n    > redis:6379> set \"abc\" 123\n    > OK\n    > redis:6379> get \"abc\"\n    > \"123\"\n    > redis:6379> exit\n    > root@9c914447f5e1:/data# exit\n    > exit\n    \n\n### 容器的备份\n\n    # 查看所有的容器\n    $ docker ps -a\n    CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES\n    a1696406326a        redis               \"docker-entrypoint...\"   13 minutes ago      Up 13 minutes       6379/tcp            myredis\n    # 备份指定的id\n    $ docker commit -p a1696406326a redis-backup\n    # 查看镜像\n    $ docker images\n    REPOSITORY                   TAG                 IMAGE ID            CREATED             SIZE\n    redis-backup                 latest              fb9d896b3a39        11 seconds ago      107MB\n    # 上传镜像(docker login && docker push)\n    # 或者打包\n    $ docker save -o ./redis-backup.tar redis-backup\n    # 恢复容器\n    $ docker pull ****\n    # 或者使用包\n    $ docker load -i ./redis-backup.tar\n    \n\n### 让docker容器连接互联网\n\n    # -p 8000:80 表示将主机的8000端口转发至容器的80端口\n    $ docker run -d -p 8000:80 nginx \n    \n    # 容器互联\n    $ docker run -d --name myredis redis\n    $ docker run --link myredis:redis debian env  # --link 目标容器:目标容器在主容器内的简称\n    ~ PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n    ~ HOSTNAME=69df45e6f92d\n    ~ REDIS_PORT=tcp://172.17.0.2:6379\n    ~ REDIS_PORT_6379_TCP=tcp://172.17.0.2:6379\n    ~ REDIS_PORT_6379_TCP_ADDR=172.17.0.2\n    ~ REDIS_PORT_6379_TCP_PORT=6379\n    ~ REDIS_PORT_6379_TCP_PROTO=tcp\n    ~ REDIS_NAME=/stupefied_chandrasekhar/redis\n    ~ REDIS_ENV_GOSU_VERSION=1.10\n    ~ REDIS_ENV_REDIS_VERSION=4.0.2\n    ~ REDIS_ENV_REDIS_DOWNLOAD_URL=http://download.redis.io/releases/redis-4.0.2.tar.gz\n    ~ REDIS_ENV_REDIS_DOWNLOAD_SHA=b1a0915dbc91b979d06df1977fe594c3fa9b189f1f3d38743a2948c9f7634813\n    ~ HOME=/root\n    \n\n### 数据卷\n\n    #  -v指定数据卷\n    $ docker run -it --name container-test -h container -v /ddata debian /bin/bash\n    # 查看数据卷在本机的位置\n    $ docker inspect -f { {.Mounts}} container-test  \n    [{volume 4687a1d9a80dff56d951f14704a8125f1b642b50c78dac63d3a02a42ff05ffb9 /var/lib/docker/volumes/4687a1d9a80dff56d951f14704a8125f1b642b50c78dac63d3a02a42ff05ffb9/_data /ddata local  true }]\n    # 可以在本机中添加文件并在容器中查看修改结果\n    \n\n    ### 在dockerfile中设置数据卷\n    FROM debian:wheezy\n    RUN useradd foo\n    # VOLUME /ddata # 此处添加无效果，因为touch chown是在一个临时容器内的数据卷中执行的\n    RUN touch /data/x\n    RUN CHOWN -R foo:foo /data\n    # VOLUME /ddata # 此处添加可以\n    \n\n    # docker run -v 指定到特定数据卷\n    $ docker run -v /home/adrian/data:./data debian ls /data\n    \n\n    # 数据容器\n    $ docker run --name dbdata postgres echo 'data-only container for postage' # 创建一个postgreSQL的容器\n    # 使用--volumes-from参数，使其他容器也可以使用这个数据卷\n    $ docker run -d --volumes-from dbdata --name db1 postgres\n    \n\n### 如何在开发中使用docker,以python flask为例\n\n    # 创建项目\n    $ tree identidock\n    .\n    ├── app\n    │   └── identidock.py\n    └── Dockerfile\n    \n\n    # 编辑flask文件\n    $ vim app/identidock.py\n    from flask import Flask\n    app = Flask(__name__)\n    \n    @app.route('/')\n    def hello_world():\n        return 'hello world'\n    \n    if __name__ == '__main__':\n        app.run(debug=True, host='0.0.0.0')\n    \n\n    # 编辑dockerfile文件\n    $ vim Dockerfile\n    FROM python:3.4\n    \n    RUN pip install Flask==0.10.1\n    WORKDIR /app\n    COPY app /app\n    CMD [\"python\", \"identidock.py\"]\n    \n\n    # 创建镜像并使用容器\n    $ docker build -t identidock .\n    ...\n    $ docker run -d -p 5000:5000 identidock # 后台运行并将主机的5000端口转发到docker\n    $ curl localhost:5000\n    ~ hello world\n    \n    # 将开发的代码目录挂载到docker上，这样就不必每次更改代码都需要重新bulid一次．\n    $ docker run -d -p 5000:5000 -v \"$PWD\"/app:/app identidock  # -v \"$PWD\"/app:/app把位于主机的./app目录挂载到容器内，覆盖容器/app目录下的内容\n    # 可以修改app目录下的文件查看改动情况\n    \n    # 以wsgi服务器运行flask并且修改设置用户\n    $ vim Dockerfile\n    FROM python:3.4\n    \n    RUN groupadd -r uwsgi && useradd -r -g uwsgi uwsgi # 创建用户组和用户\n    RUN pip install Flask==0.10.1 uWSGI==2.0.8\n    WORKDIR /app\n    COPY app /app\n    \n    EXPOSE 9090 9191  # 声明主机和其他容器可以访问的端口号\n    USER uwsgi #使用用户运行以下代码，默认docker是以root用户运行的，不安全\n    CMD [\"uwsgi\", \"--http\", \"0.0.0.0:9090\", \"--wsgi-file\", \"/app/identidock.py\", \"--callable\", \"app\", \"--stats\", \"0.0.0.0:9191\"]\n    \n\n### 使用配置文件配置开发环境和生产环境\n\n    # 创建脚本文件cmd.sh\n    $ tree\n    .\n    ├── app\n    │   └── identidock.py\n    ├── cmd.sh\n    └── Dockerfile\n    \n    $ vim cmd.sh\n    #! /bin/bash\n    set -e\n    \n    if [ \"$ENV\" = 'DEV' ]; then\n      echo \"Running Development Server\"\n      exec python \"identidock.py\"\n    else\n      echo \"Running Production Server\"\n      exec uwsgi --http 0.0.0.0:9090 --wsgi-file /app/identidock.py --callable app --stats 0.0.0.0:9191\n    fi\n    \n    $ chmod +x cmd.sh\n    $ vim Dockerfile\n    FROM python:3.4\n    \n    RUN groupadd -r uwsgi && useradd -r -g uwsgi uwsgi\n    RUN pip install Flask==0.10.1 uWSGI==2.0.8\n    WORKDIR /app\n    COPY app /app\n    COPY cmd.sh /\n    \n    EXPOSE 9090 9191\n    USER uwsgi\n    CMD [\"/cmd.sh\"]\n    \n    $ docker build -t identidock .\n    $ docker run -e \"ENV=DEV\" -p 5000:5000 identidock # 开发环境\n    $ docker run -d -P identidock\n    \n\n### 使用compose自动化安装创建运行docker环境\n\n    # 安装环境\n    # https://docs.docker.com/compose/install/\n    $ sudo curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose\n    $ sudo chmod +x /usr/local/bin/docker-compose\n    $ docker-compose --version\n    \n\n    # 配置文件\n    tree\n    .\n    ├── app\n    │   └── identidock.py\n    ├── cmd.sh\n    ├── docker-compose.yml\n    └── Dockerfile\n    # 编辑docker-compose文件\n    $ vim docker-compose.yml\n    identidock:\n      build: .\n      ports:\n        - \"5000:5000\"\n      environment:\n        ENV: DEV\n      volumes:\n        - ./app:/app\n    ~                    \n    \n\n    # 使用方法\n    $ docker-compose up # 如果有镜像则直接运行，如果没有镜像则先build\n    $ docker-compose build # 重新构建镜像\n    $ docker-compose ps 获取由compose管理的容器状态\n    $ docker-compose logs 输出日志\n    $ docker-stop 停止容器，但不会删除他们","source":"_posts/ubuntu16.04安装及使用docker(一).md","raw":"---\ntitle: ubuntu16.04安装及使用docker(一)\nurl: 245.html\nid: 245\ncomments: false\ncategories:\n  - 后端\n  - 运维\ndate: 2017-11-20 11:45:42\ntags:\n---\n\n### 删除旧版本\n\n    sudo apt-get remove docker docker-engine docker.io\n    \n\n### 安装\n\n    $ sudo apt-get update\n    # 安装依赖\n    $ sudo apt-get install  apt-transport-https ca-certificates curl software-properties-common\n    # 添加官方key\n    $ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\n    # 查找key\n    $ sudo apt-key fingerprint 0EBFCD88\n    pub   4096R/0EBFCD88 2017-02-22\n          Key fingerprint = 9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88\n    uid                  Docker Release (CE deb) <docker@docker.com>\n    sub   4096R/F273FCD8 2017-02-22\n    # 获取资源\n    sudo add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\"\n    # 查找合适的版本\n    $ apt-cache madison docker-ce\n    docker-ce | 17.09.0~ce-0~ubuntu | https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages\n    # 安装\n    $ sudo apt-get install docker-ce=<VERSION>\n    # 打印安装结果\n    $ sudo docker version\n    Client:\n     Version:      17.09.0-ce\n     API version:  1.32\n     Go version:   go1.8.3\n     Git commit:   afdb6d4\n     Built:        Tue Sep 26 22:42:18 2017\n     OS/Arch:      linux/amd64\n    \n    Server:\n     Version:      17.09.0-ce\n     API version:  1.32 (minimum version 1.12)\n     Go version:   go1.8.3\n     Git commit:   afdb6d4\n     Built:        Tue Sep 26 22:40:56 2017\n     OS/Arch:      linux/amd64\n     Experimental: false\n    \n    \n\n### 将用户加入docker用户组，这样不需要输入sudo\n\n    1. sudo cat /etc/group | grep docker \n    2. 如果不存在docker组，可以添加sudo groupadd docker \n    3. 添加当前用户到docker组，sudo usermod -aG  docker $USER \n    4. 重启docker服务,sudo systemctl restart docker \n    5. 如果权限不够，sudo chmod a+rw /var/run/docker.sock　\n    6. sudo chown -R $USER ~/.docker\n    \n\n### 启动测试\n\n    $ sudo  docker run hello-world\n    Unable to find image 'hello-world:latest' locally\n    \n    latest: Pulling from library/hello-world\n    9a0669468bf7: Pull complete\n    Digest: sha256:0e06ef5e1945a718b02a8c319e15bae44f47039005530bc617a5d071190ed3fc\n    Status: Downloaded newer image for hello-world:latest\n    \n    Hello from Docker!\n    This message shows that your installation appears to be working correctly.\n    \n    To generate this message, Docker took the following steps:\n     1. The Docker client contacted the Docker daemon.\n     2. The Docker daemon pulled the \"hello-world\" image from the Docker Hub.\n     3. The Docker daemon created a new container from that image which runs the\n        executable that produces the output you are currently reading.\n     4. The Docker daemon streamed that output to the Docker client, which sent it\n        to your terminal.\n    \n    To try something more ambitious, you can run an Ubuntu container with:\n     $ docker run -it ubuntu bash\n    \n    Share images, automate workflows, and more with a free Docker ID:\n     https://cloud.docker.com/\n    \n    For more examples and ideas, visit:\n     https://docs.docker.com/engine/userguide/\n    \n\n### 更换镜像源\n\n    # 可以修改 /etc/docker/daemon.json 文件并添加上 registry-mirrors 键值,没有就创建一个\n    \n    {\n      \"registry-mirrors\": [\"https://registry.docker-cn.com\"]\n    }\n    \n\n### 安装ctop查看容器状态\n\n    # https://github.com/bcicen/ctop\n    $ sudo wget https://github.com/bcicen/ctop/releases/download/v0.6.1/ctop-0.6.1-linux-amd64 -O /usr/local/bin/ctop\n    $ sudo chmod +x /usr/local/bin/ctop\n    \n\n### 第一个实例\n\n    # 第一次使用会下载debian的镜像文件\n    $ sudo docker run debian echo 'hello world'\n    > Unable to find image 'debian' locally\n    > ......\n    \n\n    # -i -t 表示进行交互会话\n    $ sudo docker run -i -t debian /user/bash\n    root@622ac5689680:/#  echo 'hello world'\n    > hello world\n    root@622ac5689680:/# exit\n    > exit\n    \n\n    # 基本命令\n    $ sudo docker run -h container -i -t debian /bin/bash #-h表示主机名称\n    $ sudo docker ps  # 查看当前运行的主机\n    $ sudo docker ps -a # 查看全部的主机\n    $sudo docker events  # 查看守护进程\n    $ sudo docker inspect HOST_NAME 　# 查看HOST_NAME的信息\n    $ sudo docker port HOST_NAME # 查看端口映射信息\n    $ sudo docker diff HOST_NAME　# 查看更改的信息\n    $ sudo docker logs HOST_NAME   # 打印log信息\n    $ sudo docker rm HOST_NAME  # 删除\n    $ sudo docker pull redis  # 拉取镜像\n    $ sudo docker create redis # 创建容器\n    $ sudo docker start zen_brown # 开启容器（kitematic是绿色波浪线）\n    $ sudo docker stop zen_brown # 停止容器（kitematic是灰色直线）\n    $ sudo docker pause zen_brown  # 暂停容器kitematic是灰色波浪线）\n    $ sudo docker commit zen_brown # 将容器变成镜像\n    $ sudo docker run redis /bin/bash\n    $ sudo docker attach zen_brown # 查看容器内进程\n    $ sudo docker cp # 在容器和主机之间复制内容\n    $ sudo docker exec # 在容器中运行命令\n    $ sudo docker kill # 容器立即退出\n    \n\n### 创建dockerfile镜像\n\n    # 创建项目\n    $ mkdir cowsay\n    $ cd cowsay\n    $ vim Dockerfile\n    ~ FROM debian:wheezy\n    ~ RUN apt-get update && apt-get install -y cowsay fortune\n    ~ :wq\n    # 创建\n    $ sudo docker build -t test/cowsay-dockerfile . \n    > Sending build content to Docker .....\n    > ....\n    # 运行\n    $ sudo docker run test/cowsay-dockerfile /usr/games/cowsay 'Moo'\n    \n\n    # 使用entrypoint指令\n    $ vim Dockerfile\n    ~ FROM debian:wheezy\n    ~ RUN apt-get update && apt-get install -y cowsay fortune\n    ~ ENTRYPOINTER [\"/usr/games/cowsay\"]\n    ~ :wq \n    # 创建\n    $ sudo docker build -t test/cowsay-dockerfile . \n    > Sending build content to Docker .....\n    > ....\n    # 运行\n    $ sudo docker run test/cowsay-dockerfile  'Moo'\n    \n\n    # 使用脚本解决entrypoint\n    $ vim entrypoint.sh\n    ~ #! /bin/bash\n    ~ if [ $# -eq 0 ]; then\n    ~      /usr/games/fortune | /usr/games/cowsay\n    ~  else\n    ~     /usr/games/cowsay \"$@\"\n    ~   fi\n    ~ :wq\n    $ chmod +x entrypoint.sh\n    $ vim Dockerfile\n    ~ FROM debian:wheezy\n    ~ RUN apt-get update && apt-get install -y cowsay fortune\n    ~ COPY entrypoint.sh /\n    ~ ENTRYPOINTER [\"/entrypoint.sh\"]\n    ~ :wq \n    # 创建\n    $ sudo docker build -t test/cowsay-dockerfile . \n    > Sending build content to Docker .....\n    > ....\n    # 运行\n    $ sudo docker run test/cowsay-dockerfile 'Moo'\n    \n\n### 使用在线仓库\n\n在线注册地址：　https://cloud.docker.com\n\n    # 登陆\n    $ sudo docker login\n    $ username:\n    $ password:\n    # 填写作者信息\n    $ vim Dockerfile\n    ~ FROM debian:wheezy\n    ~ MAINTAINER username <username@mail.com>\n    ~ RUN apt-get update && apt-get install -y cowsay fortune\n    ~ COPY entrypoint.sh /\n    ~ ENTRYPOINTER [\"/entrypoint.sh\"]\n    ~ :wq \n    # 创建\n    $ sudo docker build -t username/cowsay-dockerfile . \n    > Sending build content to Docker .....\n    > ....\n    # 运行\n    $ sudo docker run username/cowsay-dockerfile  'Moo'\n    # 上传\n    $ sudo docker push \n    \n\n### 容器连接\n\n    $ sudo docker run --name myredis -d redis # -d表示后台运行\n    ~ a1696406326aaaa6c28931e886b8dd664d191b083de4aed464d584b4720d57b1\n    $ docker run --rm -it --link myredis:redis redis /bin/bash\n    > root@9c914447f5e1:/data# redis-cli -h redis -p 6379\n    > redis:6379> ping\n    > PONG\n    > redis:6379> set \"abc\" 123\n    > OK\n    > redis:6379> get \"abc\"\n    > \"123\"\n    > redis:6379> exit\n    > root@9c914447f5e1:/data# exit\n    > exit\n    \n\n### 容器的备份\n\n    # 查看所有的容器\n    $ docker ps -a\n    CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES\n    a1696406326a        redis               \"docker-entrypoint...\"   13 minutes ago      Up 13 minutes       6379/tcp            myredis\n    # 备份指定的id\n    $ docker commit -p a1696406326a redis-backup\n    # 查看镜像\n    $ docker images\n    REPOSITORY                   TAG                 IMAGE ID            CREATED             SIZE\n    redis-backup                 latest              fb9d896b3a39        11 seconds ago      107MB\n    # 上传镜像(docker login && docker push)\n    # 或者打包\n    $ docker save -o ./redis-backup.tar redis-backup\n    # 恢复容器\n    $ docker pull ****\n    # 或者使用包\n    $ docker load -i ./redis-backup.tar\n    \n\n### 让docker容器连接互联网\n\n    # -p 8000:80 表示将主机的8000端口转发至容器的80端口\n    $ docker run -d -p 8000:80 nginx \n    \n    # 容器互联\n    $ docker run -d --name myredis redis\n    $ docker run --link myredis:redis debian env  # --link 目标容器:目标容器在主容器内的简称\n    ~ PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n    ~ HOSTNAME=69df45e6f92d\n    ~ REDIS_PORT=tcp://172.17.0.2:6379\n    ~ REDIS_PORT_6379_TCP=tcp://172.17.0.2:6379\n    ~ REDIS_PORT_6379_TCP_ADDR=172.17.0.2\n    ~ REDIS_PORT_6379_TCP_PORT=6379\n    ~ REDIS_PORT_6379_TCP_PROTO=tcp\n    ~ REDIS_NAME=/stupefied_chandrasekhar/redis\n    ~ REDIS_ENV_GOSU_VERSION=1.10\n    ~ REDIS_ENV_REDIS_VERSION=4.0.2\n    ~ REDIS_ENV_REDIS_DOWNLOAD_URL=http://download.redis.io/releases/redis-4.0.2.tar.gz\n    ~ REDIS_ENV_REDIS_DOWNLOAD_SHA=b1a0915dbc91b979d06df1977fe594c3fa9b189f1f3d38743a2948c9f7634813\n    ~ HOME=/root\n    \n\n### 数据卷\n\n    #  -v指定数据卷\n    $ docker run -it --name container-test -h container -v /ddata debian /bin/bash\n    # 查看数据卷在本机的位置\n    $ docker inspect -f { {.Mounts}} container-test  \n    [{volume 4687a1d9a80dff56d951f14704a8125f1b642b50c78dac63d3a02a42ff05ffb9 /var/lib/docker/volumes/4687a1d9a80dff56d951f14704a8125f1b642b50c78dac63d3a02a42ff05ffb9/_data /ddata local  true }]\n    # 可以在本机中添加文件并在容器中查看修改结果\n    \n\n    ### 在dockerfile中设置数据卷\n    FROM debian:wheezy\n    RUN useradd foo\n    # VOLUME /ddata # 此处添加无效果，因为touch chown是在一个临时容器内的数据卷中执行的\n    RUN touch /data/x\n    RUN CHOWN -R foo:foo /data\n    # VOLUME /ddata # 此处添加可以\n    \n\n    # docker run -v 指定到特定数据卷\n    $ docker run -v /home/adrian/data:./data debian ls /data\n    \n\n    # 数据容器\n    $ docker run --name dbdata postgres echo 'data-only container for postage' # 创建一个postgreSQL的容器\n    # 使用--volumes-from参数，使其他容器也可以使用这个数据卷\n    $ docker run -d --volumes-from dbdata --name db1 postgres\n    \n\n### 如何在开发中使用docker,以python flask为例\n\n    # 创建项目\n    $ tree identidock\n    .\n    ├── app\n    │   └── identidock.py\n    └── Dockerfile\n    \n\n    # 编辑flask文件\n    $ vim app/identidock.py\n    from flask import Flask\n    app = Flask(__name__)\n    \n    @app.route('/')\n    def hello_world():\n        return 'hello world'\n    \n    if __name__ == '__main__':\n        app.run(debug=True, host='0.0.0.0')\n    \n\n    # 编辑dockerfile文件\n    $ vim Dockerfile\n    FROM python:3.4\n    \n    RUN pip install Flask==0.10.1\n    WORKDIR /app\n    COPY app /app\n    CMD [\"python\", \"identidock.py\"]\n    \n\n    # 创建镜像并使用容器\n    $ docker build -t identidock .\n    ...\n    $ docker run -d -p 5000:5000 identidock # 后台运行并将主机的5000端口转发到docker\n    $ curl localhost:5000\n    ~ hello world\n    \n    # 将开发的代码目录挂载到docker上，这样就不必每次更改代码都需要重新bulid一次．\n    $ docker run -d -p 5000:5000 -v \"$PWD\"/app:/app identidock  # -v \"$PWD\"/app:/app把位于主机的./app目录挂载到容器内，覆盖容器/app目录下的内容\n    # 可以修改app目录下的文件查看改动情况\n    \n    # 以wsgi服务器运行flask并且修改设置用户\n    $ vim Dockerfile\n    FROM python:3.4\n    \n    RUN groupadd -r uwsgi && useradd -r -g uwsgi uwsgi # 创建用户组和用户\n    RUN pip install Flask==0.10.1 uWSGI==2.0.8\n    WORKDIR /app\n    COPY app /app\n    \n    EXPOSE 9090 9191  # 声明主机和其他容器可以访问的端口号\n    USER uwsgi #使用用户运行以下代码，默认docker是以root用户运行的，不安全\n    CMD [\"uwsgi\", \"--http\", \"0.0.0.0:9090\", \"--wsgi-file\", \"/app/identidock.py\", \"--callable\", \"app\", \"--stats\", \"0.0.0.0:9191\"]\n    \n\n### 使用配置文件配置开发环境和生产环境\n\n    # 创建脚本文件cmd.sh\n    $ tree\n    .\n    ├── app\n    │   └── identidock.py\n    ├── cmd.sh\n    └── Dockerfile\n    \n    $ vim cmd.sh\n    #! /bin/bash\n    set -e\n    \n    if [ \"$ENV\" = 'DEV' ]; then\n      echo \"Running Development Server\"\n      exec python \"identidock.py\"\n    else\n      echo \"Running Production Server\"\n      exec uwsgi --http 0.0.0.0:9090 --wsgi-file /app/identidock.py --callable app --stats 0.0.0.0:9191\n    fi\n    \n    $ chmod +x cmd.sh\n    $ vim Dockerfile\n    FROM python:3.4\n    \n    RUN groupadd -r uwsgi && useradd -r -g uwsgi uwsgi\n    RUN pip install Flask==0.10.1 uWSGI==2.0.8\n    WORKDIR /app\n    COPY app /app\n    COPY cmd.sh /\n    \n    EXPOSE 9090 9191\n    USER uwsgi\n    CMD [\"/cmd.sh\"]\n    \n    $ docker build -t identidock .\n    $ docker run -e \"ENV=DEV\" -p 5000:5000 identidock # 开发环境\n    $ docker run -d -P identidock\n    \n\n### 使用compose自动化安装创建运行docker环境\n\n    # 安装环境\n    # https://docs.docker.com/compose/install/\n    $ sudo curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose\n    $ sudo chmod +x /usr/local/bin/docker-compose\n    $ docker-compose --version\n    \n\n    # 配置文件\n    tree\n    .\n    ├── app\n    │   └── identidock.py\n    ├── cmd.sh\n    ├── docker-compose.yml\n    └── Dockerfile\n    # 编辑docker-compose文件\n    $ vim docker-compose.yml\n    identidock:\n      build: .\n      ports:\n        - \"5000:5000\"\n      environment:\n        ENV: DEV\n      volumes:\n        - ./app:/app\n    ~                    \n    \n\n    # 使用方法\n    $ docker-compose up # 如果有镜像则直接运行，如果没有镜像则先build\n    $ docker-compose build # 重新构建镜像\n    $ docker-compose ps 获取由compose管理的容器状态\n    $ docker-compose logs 输出日志\n    $ docker-stop 停止容器，但不会删除他们","slug":"ubuntu16.04安装及使用docker(一)","published":1,"updated":"2019-07-23T05:51:43.847Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5q0004q9ka4rtmyky6c","content":"<h3 id=\"删除旧版本\"><a href=\"#删除旧版本\" class=\"headerlink\" title=\"删除旧版本\"></a>删除旧版本</h3><pre><code>sudo apt-get remove docker docker-engine docker.io</code></pre><h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><pre><code>$ sudo apt-get update\n# 安装依赖\n$ sudo apt-get install  apt-transport-https ca-certificates curl software-properties-common\n# 添加官方key\n$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\n# 查找key\n$ sudo apt-key fingerprint 0EBFCD88\npub   4096R/0EBFCD88 2017-02-22\n      Key fingerprint = 9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88\nuid                  Docker Release (CE deb) &lt;docker@docker.com&gt;\nsub   4096R/F273FCD8 2017-02-22\n# 获取资源\nsudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot;\n# 查找合适的版本\n$ apt-cache madison docker-ce\ndocker-ce | 17.09.0~ce-0~ubuntu | https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages\n# 安装\n$ sudo apt-get install docker-ce=&lt;VERSION&gt;\n# 打印安装结果\n$ sudo docker version\nClient:\n Version:      17.09.0-ce\n API version:  1.32\n Go version:   go1.8.3\n Git commit:   afdb6d4\n Built:        Tue Sep 26 22:42:18 2017\n OS/Arch:      linux/amd64\n\nServer:\n Version:      17.09.0-ce\n API version:  1.32 (minimum version 1.12)\n Go version:   go1.8.3\n Git commit:   afdb6d4\n Built:        Tue Sep 26 22:40:56 2017\n OS/Arch:      linux/amd64\n Experimental: false</code></pre><h3 id=\"将用户加入docker用户组，这样不需要输入sudo\"><a href=\"#将用户加入docker用户组，这样不需要输入sudo\" class=\"headerlink\" title=\"将用户加入docker用户组，这样不需要输入sudo\"></a>将用户加入docker用户组，这样不需要输入sudo</h3><pre><code>1. sudo cat /etc/group | grep docker \n2. 如果不存在docker组，可以添加sudo groupadd docker \n3. 添加当前用户到docker组，sudo usermod -aG  docker $USER \n4. 重启docker服务,sudo systemctl restart docker \n5. 如果权限不够，sudo chmod a+rw /var/run/docker.sock　\n6. sudo chown -R $USER ~/.docker</code></pre><h3 id=\"启动测试\"><a href=\"#启动测试\" class=\"headerlink\" title=\"启动测试\"></a>启动测试</h3><pre><code>$ sudo  docker run hello-world\nUnable to find image &apos;hello-world:latest&apos; locally\n\nlatest: Pulling from library/hello-world\n9a0669468bf7: Pull complete\nDigest: sha256:0e06ef5e1945a718b02a8c319e15bae44f47039005530bc617a5d071190ed3fc\nStatus: Downloaded newer image for hello-world:latest\n\nHello from Docker!\nThis message shows that your installation appears to be working correctly.\n\nTo generate this message, Docker took the following steps:\n 1. The Docker client contacted the Docker daemon.\n 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.\n 3. The Docker daemon created a new container from that image which runs the\n    executable that produces the output you are currently reading.\n 4. The Docker daemon streamed that output to the Docker client, which sent it\n    to your terminal.\n\nTo try something more ambitious, you can run an Ubuntu container with:\n $ docker run -it ubuntu bash\n\nShare images, automate workflows, and more with a free Docker ID:\n https://cloud.docker.com/\n\nFor more examples and ideas, visit:\n https://docs.docker.com/engine/userguide/</code></pre><h3 id=\"更换镜像源\"><a href=\"#更换镜像源\" class=\"headerlink\" title=\"更换镜像源\"></a>更换镜像源</h3><pre><code># 可以修改 /etc/docker/daemon.json 文件并添加上 registry-mirrors 键值,没有就创建一个\n\n{\n  &quot;registry-mirrors&quot;: [&quot;https://registry.docker-cn.com&quot;]\n}</code></pre><h3 id=\"安装ctop查看容器状态\"><a href=\"#安装ctop查看容器状态\" class=\"headerlink\" title=\"安装ctop查看容器状态\"></a>安装ctop查看容器状态</h3><pre><code># https://github.com/bcicen/ctop\n$ sudo wget https://github.com/bcicen/ctop/releases/download/v0.6.1/ctop-0.6.1-linux-amd64 -O /usr/local/bin/ctop\n$ sudo chmod +x /usr/local/bin/ctop</code></pre><h3 id=\"第一个实例\"><a href=\"#第一个实例\" class=\"headerlink\" title=\"第一个实例\"></a>第一个实例</h3><pre><code># 第一次使用会下载debian的镜像文件\n$ sudo docker run debian echo &apos;hello world&apos;\n&gt; Unable to find image &apos;debian&apos; locally\n&gt; ......\n\n\n# -i -t 表示进行交互会话\n$ sudo docker run -i -t debian /user/bash\nroot@622ac5689680:/#  echo &apos;hello world&apos;\n&gt; hello world\nroot@622ac5689680:/# exit\n&gt; exit\n\n\n# 基本命令\n$ sudo docker run -h container -i -t debian /bin/bash #-h表示主机名称\n$ sudo docker ps  # 查看当前运行的主机\n$ sudo docker ps -a # 查看全部的主机\n$sudo docker events  # 查看守护进程\n$ sudo docker inspect HOST_NAME 　# 查看HOST_NAME的信息\n$ sudo docker port HOST_NAME # 查看端口映射信息\n$ sudo docker diff HOST_NAME　# 查看更改的信息\n$ sudo docker logs HOST_NAME   # 打印log信息\n$ sudo docker rm HOST_NAME  # 删除\n$ sudo docker pull redis  # 拉取镜像\n$ sudo docker create redis # 创建容器\n$ sudo docker start zen_brown # 开启容器（kitematic是绿色波浪线）\n$ sudo docker stop zen_brown # 停止容器（kitematic是灰色直线）\n$ sudo docker pause zen_brown  # 暂停容器kitematic是灰色波浪线）\n$ sudo docker commit zen_brown # 将容器变成镜像\n$ sudo docker run redis /bin/bash\n$ sudo docker attach zen_brown # 查看容器内进程\n$ sudo docker cp # 在容器和主机之间复制内容\n$ sudo docker exec # 在容器中运行命令\n$ sudo docker kill # 容器立即退出</code></pre><h3 id=\"创建dockerfile镜像\"><a href=\"#创建dockerfile镜像\" class=\"headerlink\" title=\"创建dockerfile镜像\"></a>创建dockerfile镜像</h3><pre><code># 创建项目\n$ mkdir cowsay\n$ cd cowsay\n$ vim Dockerfile\n~ FROM debian:wheezy\n~ RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune\n~ :wq\n# 创建\n$ sudo docker build -t test/cowsay-dockerfile . \n&gt; Sending build content to Docker .....\n&gt; ....\n# 运行\n$ sudo docker run test/cowsay-dockerfile /usr/games/cowsay &apos;Moo&apos;\n\n\n# 使用entrypoint指令\n$ vim Dockerfile\n~ FROM debian:wheezy\n~ RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune\n~ ENTRYPOINTER [&quot;/usr/games/cowsay&quot;]\n~ :wq \n# 创建\n$ sudo docker build -t test/cowsay-dockerfile . \n&gt; Sending build content to Docker .....\n&gt; ....\n# 运行\n$ sudo docker run test/cowsay-dockerfile  &apos;Moo&apos;\n\n\n# 使用脚本解决entrypoint\n$ vim entrypoint.sh\n~ #! /bin/bash\n~ if [ $# -eq 0 ]; then\n~      /usr/games/fortune | /usr/games/cowsay\n~  else\n~     /usr/games/cowsay &quot;$@&quot;\n~   fi\n~ :wq\n$ chmod +x entrypoint.sh\n$ vim Dockerfile\n~ FROM debian:wheezy\n~ RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune\n~ COPY entrypoint.sh /\n~ ENTRYPOINTER [&quot;/entrypoint.sh&quot;]\n~ :wq \n# 创建\n$ sudo docker build -t test/cowsay-dockerfile . \n&gt; Sending build content to Docker .....\n&gt; ....\n# 运行\n$ sudo docker run test/cowsay-dockerfile &apos;Moo&apos;</code></pre><h3 id=\"使用在线仓库\"><a href=\"#使用在线仓库\" class=\"headerlink\" title=\"使用在线仓库\"></a>使用在线仓库</h3><p>在线注册地址：　<a href=\"https://cloud.docker.com\" target=\"_blank\" rel=\"noopener\">https://cloud.docker.com</a></p>\n<pre><code># 登陆\n$ sudo docker login\n$ username:\n$ password:\n# 填写作者信息\n$ vim Dockerfile\n~ FROM debian:wheezy\n~ MAINTAINER username &lt;username@mail.com&gt;\n~ RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune\n~ COPY entrypoint.sh /\n~ ENTRYPOINTER [&quot;/entrypoint.sh&quot;]\n~ :wq \n# 创建\n$ sudo docker build -t username/cowsay-dockerfile . \n&gt; Sending build content to Docker .....\n&gt; ....\n# 运行\n$ sudo docker run username/cowsay-dockerfile  &apos;Moo&apos;\n# 上传\n$ sudo docker push </code></pre><h3 id=\"容器连接\"><a href=\"#容器连接\" class=\"headerlink\" title=\"容器连接\"></a>容器连接</h3><pre><code>$ sudo docker run --name myredis -d redis # -d表示后台运行\n~ a1696406326aaaa6c28931e886b8dd664d191b083de4aed464d584b4720d57b1\n$ docker run --rm -it --link myredis:redis redis /bin/bash\n&gt; root@9c914447f5e1:/data# redis-cli -h redis -p 6379\n&gt; redis:6379&gt; ping\n&gt; PONG\n&gt; redis:6379&gt; set &quot;abc&quot; 123\n&gt; OK\n&gt; redis:6379&gt; get &quot;abc&quot;\n&gt; &quot;123&quot;\n&gt; redis:6379&gt; exit\n&gt; root@9c914447f5e1:/data# exit\n&gt; exit</code></pre><h3 id=\"容器的备份\"><a href=\"#容器的备份\" class=\"headerlink\" title=\"容器的备份\"></a>容器的备份</h3><pre><code># 查看所有的容器\n$ docker ps -a\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES\na1696406326a        redis               &quot;docker-entrypoint...&quot;   13 minutes ago      Up 13 minutes       6379/tcp            myredis\n# 备份指定的id\n$ docker commit -p a1696406326a redis-backup\n# 查看镜像\n$ docker images\nREPOSITORY                   TAG                 IMAGE ID            CREATED             SIZE\nredis-backup                 latest              fb9d896b3a39        11 seconds ago      107MB\n# 上传镜像(docker login &amp;&amp; docker push)\n# 或者打包\n$ docker save -o ./redis-backup.tar redis-backup\n# 恢复容器\n$ docker pull ****\n# 或者使用包\n$ docker load -i ./redis-backup.tar</code></pre><h3 id=\"让docker容器连接互联网\"><a href=\"#让docker容器连接互联网\" class=\"headerlink\" title=\"让docker容器连接互联网\"></a>让docker容器连接互联网</h3><pre><code># -p 8000:80 表示将主机的8000端口转发至容器的80端口\n$ docker run -d -p 8000:80 nginx \n\n# 容器互联\n$ docker run -d --name myredis redis\n$ docker run --link myredis:redis debian env  # --link 目标容器:目标容器在主容器内的简称\n~ PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n~ HOSTNAME=69df45e6f92d\n~ REDIS_PORT=tcp://172.17.0.2:6379\n~ REDIS_PORT_6379_TCP=tcp://172.17.0.2:6379\n~ REDIS_PORT_6379_TCP_ADDR=172.17.0.2\n~ REDIS_PORT_6379_TCP_PORT=6379\n~ REDIS_PORT_6379_TCP_PROTO=tcp\n~ REDIS_NAME=/stupefied_chandrasekhar/redis\n~ REDIS_ENV_GOSU_VERSION=1.10\n~ REDIS_ENV_REDIS_VERSION=4.0.2\n~ REDIS_ENV_REDIS_DOWNLOAD_URL=http://download.redis.io/releases/redis-4.0.2.tar.gz\n~ REDIS_ENV_REDIS_DOWNLOAD_SHA=b1a0915dbc91b979d06df1977fe594c3fa9b189f1f3d38743a2948c9f7634813\n~ HOME=/root</code></pre><h3 id=\"数据卷\"><a href=\"#数据卷\" class=\"headerlink\" title=\"数据卷\"></a>数据卷</h3><pre><code>#  -v指定数据卷\n$ docker run -it --name container-test -h container -v /ddata debian /bin/bash\n# 查看数据卷在本机的位置\n$ docker inspect -f { {.Mounts}} container-test  \n[{volume 4687a1d9a80dff56d951f14704a8125f1b642b50c78dac63d3a02a42ff05ffb9 /var/lib/docker/volumes/4687a1d9a80dff56d951f14704a8125f1b642b50c78dac63d3a02a42ff05ffb9/_data /ddata local  true }]\n# 可以在本机中添加文件并在容器中查看修改结果\n\n\n### 在dockerfile中设置数据卷\nFROM debian:wheezy\nRUN useradd foo\n# VOLUME /ddata # 此处添加无效果，因为touch chown是在一个临时容器内的数据卷中执行的\nRUN touch /data/x\nRUN CHOWN -R foo:foo /data\n# VOLUME /ddata # 此处添加可以\n\n\n# docker run -v 指定到特定数据卷\n$ docker run -v /home/adrian/data:./data debian ls /data\n\n\n# 数据容器\n$ docker run --name dbdata postgres echo &apos;data-only container for postage&apos; # 创建一个postgreSQL的容器\n# 使用--volumes-from参数，使其他容器也可以使用这个数据卷\n$ docker run -d --volumes-from dbdata --name db1 postgres</code></pre><h3 id=\"如何在开发中使用docker-以python-flask为例\"><a href=\"#如何在开发中使用docker-以python-flask为例\" class=\"headerlink\" title=\"如何在开发中使用docker,以python flask为例\"></a>如何在开发中使用docker,以python flask为例</h3><pre><code># 创建项目\n$ tree identidock\n.\n├── app\n│   └── identidock.py\n└── Dockerfile\n\n\n# 编辑flask文件\n$ vim app/identidock.py\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route(&apos;/&apos;)\ndef hello_world():\n    return &apos;hello world&apos;\n\nif __name__ == &apos;__main__&apos;:\n    app.run(debug=True, host=&apos;0.0.0.0&apos;)\n\n\n# 编辑dockerfile文件\n$ vim Dockerfile\nFROM python:3.4\n\nRUN pip install Flask==0.10.1\nWORKDIR /app\nCOPY app /app\nCMD [&quot;python&quot;, &quot;identidock.py&quot;]\n\n\n# 创建镜像并使用容器\n$ docker build -t identidock .\n...\n$ docker run -d -p 5000:5000 identidock # 后台运行并将主机的5000端口转发到docker\n$ curl localhost:5000\n~ hello world\n\n# 将开发的代码目录挂载到docker上，这样就不必每次更改代码都需要重新bulid一次．\n$ docker run -d -p 5000:5000 -v &quot;$PWD&quot;/app:/app identidock  # -v &quot;$PWD&quot;/app:/app把位于主机的./app目录挂载到容器内，覆盖容器/app目录下的内容\n# 可以修改app目录下的文件查看改动情况\n\n# 以wsgi服务器运行flask并且修改设置用户\n$ vim Dockerfile\nFROM python:3.4\n\nRUN groupadd -r uwsgi &amp;&amp; useradd -r -g uwsgi uwsgi # 创建用户组和用户\nRUN pip install Flask==0.10.1 uWSGI==2.0.8\nWORKDIR /app\nCOPY app /app\n\nEXPOSE 9090 9191  # 声明主机和其他容器可以访问的端口号\nUSER uwsgi #使用用户运行以下代码，默认docker是以root用户运行的，不安全\nCMD [&quot;uwsgi&quot;, &quot;--http&quot;, &quot;0.0.0.0:9090&quot;, &quot;--wsgi-file&quot;, &quot;/app/identidock.py&quot;, &quot;--callable&quot;, &quot;app&quot;, &quot;--stats&quot;, &quot;0.0.0.0:9191&quot;]</code></pre><h3 id=\"使用配置文件配置开发环境和生产环境\"><a href=\"#使用配置文件配置开发环境和生产环境\" class=\"headerlink\" title=\"使用配置文件配置开发环境和生产环境\"></a>使用配置文件配置开发环境和生产环境</h3><pre><code># 创建脚本文件cmd.sh\n$ tree\n.\n├── app\n│   └── identidock.py\n├── cmd.sh\n└── Dockerfile\n\n$ vim cmd.sh\n#! /bin/bash\nset -e\n\nif [ &quot;$ENV&quot; = &apos;DEV&apos; ]; then\n  echo &quot;Running Development Server&quot;\n  exec python &quot;identidock.py&quot;\nelse\n  echo &quot;Running Production Server&quot;\n  exec uwsgi --http 0.0.0.0:9090 --wsgi-file /app/identidock.py --callable app --stats 0.0.0.0:9191\nfi\n\n$ chmod +x cmd.sh\n$ vim Dockerfile\nFROM python:3.4\n\nRUN groupadd -r uwsgi &amp;&amp; useradd -r -g uwsgi uwsgi\nRUN pip install Flask==0.10.1 uWSGI==2.0.8\nWORKDIR /app\nCOPY app /app\nCOPY cmd.sh /\n\nEXPOSE 9090 9191\nUSER uwsgi\nCMD [&quot;/cmd.sh&quot;]\n\n$ docker build -t identidock .\n$ docker run -e &quot;ENV=DEV&quot; -p 5000:5000 identidock # 开发环境\n$ docker run -d -P identidock</code></pre><h3 id=\"使用compose自动化安装创建运行docker环境\"><a href=\"#使用compose自动化安装创建运行docker环境\" class=\"headerlink\" title=\"使用compose自动化安装创建运行docker环境\"></a>使用compose自动化安装创建运行docker环境</h3><pre><code># 安装环境\n# https://docs.docker.com/compose/install/\n$ sudo curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose\n$ sudo chmod +x /usr/local/bin/docker-compose\n$ docker-compose --version\n\n\n# 配置文件\ntree\n.\n├── app\n│   └── identidock.py\n├── cmd.sh\n├── docker-compose.yml\n└── Dockerfile\n# 编辑docker-compose文件\n$ vim docker-compose.yml\nidentidock:\n  build: .\n  ports:\n    - &quot;5000:5000&quot;\n  environment:\n    ENV: DEV\n  volumes:\n    - ./app:/app\n~                    \n\n\n# 使用方法\n$ docker-compose up # 如果有镜像则直接运行，如果没有镜像则先build\n$ docker-compose build # 重新构建镜像\n$ docker-compose ps 获取由compose管理的容器状态\n$ docker-compose logs 输出日志\n$ docker-stop 停止容器，但不会删除他们</code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"删除旧版本\"><a href=\"#删除旧版本\" class=\"headerlink\" title=\"删除旧版本\"></a>删除旧版本</h3><pre><code>sudo apt-get remove docker docker-engine docker.io</code></pre><h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><pre><code>$ sudo apt-get update\n# 安装依赖\n$ sudo apt-get install  apt-transport-https ca-certificates curl software-properties-common\n# 添加官方key\n$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\n# 查找key\n$ sudo apt-key fingerprint 0EBFCD88\npub   4096R/0EBFCD88 2017-02-22\n      Key fingerprint = 9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88\nuid                  Docker Release (CE deb) &lt;docker@docker.com&gt;\nsub   4096R/F273FCD8 2017-02-22\n# 获取资源\nsudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot;\n# 查找合适的版本\n$ apt-cache madison docker-ce\ndocker-ce | 17.09.0~ce-0~ubuntu | https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages\n# 安装\n$ sudo apt-get install docker-ce=&lt;VERSION&gt;\n# 打印安装结果\n$ sudo docker version\nClient:\n Version:      17.09.0-ce\n API version:  1.32\n Go version:   go1.8.3\n Git commit:   afdb6d4\n Built:        Tue Sep 26 22:42:18 2017\n OS/Arch:      linux/amd64\n\nServer:\n Version:      17.09.0-ce\n API version:  1.32 (minimum version 1.12)\n Go version:   go1.8.3\n Git commit:   afdb6d4\n Built:        Tue Sep 26 22:40:56 2017\n OS/Arch:      linux/amd64\n Experimental: false</code></pre><h3 id=\"将用户加入docker用户组，这样不需要输入sudo\"><a href=\"#将用户加入docker用户组，这样不需要输入sudo\" class=\"headerlink\" title=\"将用户加入docker用户组，这样不需要输入sudo\"></a>将用户加入docker用户组，这样不需要输入sudo</h3><pre><code>1. sudo cat /etc/group | grep docker \n2. 如果不存在docker组，可以添加sudo groupadd docker \n3. 添加当前用户到docker组，sudo usermod -aG  docker $USER \n4. 重启docker服务,sudo systemctl restart docker \n5. 如果权限不够，sudo chmod a+rw /var/run/docker.sock　\n6. sudo chown -R $USER ~/.docker</code></pre><h3 id=\"启动测试\"><a href=\"#启动测试\" class=\"headerlink\" title=\"启动测试\"></a>启动测试</h3><pre><code>$ sudo  docker run hello-world\nUnable to find image &apos;hello-world:latest&apos; locally\n\nlatest: Pulling from library/hello-world\n9a0669468bf7: Pull complete\nDigest: sha256:0e06ef5e1945a718b02a8c319e15bae44f47039005530bc617a5d071190ed3fc\nStatus: Downloaded newer image for hello-world:latest\n\nHello from Docker!\nThis message shows that your installation appears to be working correctly.\n\nTo generate this message, Docker took the following steps:\n 1. The Docker client contacted the Docker daemon.\n 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.\n 3. The Docker daemon created a new container from that image which runs the\n    executable that produces the output you are currently reading.\n 4. The Docker daemon streamed that output to the Docker client, which sent it\n    to your terminal.\n\nTo try something more ambitious, you can run an Ubuntu container with:\n $ docker run -it ubuntu bash\n\nShare images, automate workflows, and more with a free Docker ID:\n https://cloud.docker.com/\n\nFor more examples and ideas, visit:\n https://docs.docker.com/engine/userguide/</code></pre><h3 id=\"更换镜像源\"><a href=\"#更换镜像源\" class=\"headerlink\" title=\"更换镜像源\"></a>更换镜像源</h3><pre><code># 可以修改 /etc/docker/daemon.json 文件并添加上 registry-mirrors 键值,没有就创建一个\n\n{\n  &quot;registry-mirrors&quot;: [&quot;https://registry.docker-cn.com&quot;]\n}</code></pre><h3 id=\"安装ctop查看容器状态\"><a href=\"#安装ctop查看容器状态\" class=\"headerlink\" title=\"安装ctop查看容器状态\"></a>安装ctop查看容器状态</h3><pre><code># https://github.com/bcicen/ctop\n$ sudo wget https://github.com/bcicen/ctop/releases/download/v0.6.1/ctop-0.6.1-linux-amd64 -O /usr/local/bin/ctop\n$ sudo chmod +x /usr/local/bin/ctop</code></pre><h3 id=\"第一个实例\"><a href=\"#第一个实例\" class=\"headerlink\" title=\"第一个实例\"></a>第一个实例</h3><pre><code># 第一次使用会下载debian的镜像文件\n$ sudo docker run debian echo &apos;hello world&apos;\n&gt; Unable to find image &apos;debian&apos; locally\n&gt; ......\n\n\n# -i -t 表示进行交互会话\n$ sudo docker run -i -t debian /user/bash\nroot@622ac5689680:/#  echo &apos;hello world&apos;\n&gt; hello world\nroot@622ac5689680:/# exit\n&gt; exit\n\n\n# 基本命令\n$ sudo docker run -h container -i -t debian /bin/bash #-h表示主机名称\n$ sudo docker ps  # 查看当前运行的主机\n$ sudo docker ps -a # 查看全部的主机\n$sudo docker events  # 查看守护进程\n$ sudo docker inspect HOST_NAME 　# 查看HOST_NAME的信息\n$ sudo docker port HOST_NAME # 查看端口映射信息\n$ sudo docker diff HOST_NAME　# 查看更改的信息\n$ sudo docker logs HOST_NAME   # 打印log信息\n$ sudo docker rm HOST_NAME  # 删除\n$ sudo docker pull redis  # 拉取镜像\n$ sudo docker create redis # 创建容器\n$ sudo docker start zen_brown # 开启容器（kitematic是绿色波浪线）\n$ sudo docker stop zen_brown # 停止容器（kitematic是灰色直线）\n$ sudo docker pause zen_brown  # 暂停容器kitematic是灰色波浪线）\n$ sudo docker commit zen_brown # 将容器变成镜像\n$ sudo docker run redis /bin/bash\n$ sudo docker attach zen_brown # 查看容器内进程\n$ sudo docker cp # 在容器和主机之间复制内容\n$ sudo docker exec # 在容器中运行命令\n$ sudo docker kill # 容器立即退出</code></pre><h3 id=\"创建dockerfile镜像\"><a href=\"#创建dockerfile镜像\" class=\"headerlink\" title=\"创建dockerfile镜像\"></a>创建dockerfile镜像</h3><pre><code># 创建项目\n$ mkdir cowsay\n$ cd cowsay\n$ vim Dockerfile\n~ FROM debian:wheezy\n~ RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune\n~ :wq\n# 创建\n$ sudo docker build -t test/cowsay-dockerfile . \n&gt; Sending build content to Docker .....\n&gt; ....\n# 运行\n$ sudo docker run test/cowsay-dockerfile /usr/games/cowsay &apos;Moo&apos;\n\n\n# 使用entrypoint指令\n$ vim Dockerfile\n~ FROM debian:wheezy\n~ RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune\n~ ENTRYPOINTER [&quot;/usr/games/cowsay&quot;]\n~ :wq \n# 创建\n$ sudo docker build -t test/cowsay-dockerfile . \n&gt; Sending build content to Docker .....\n&gt; ....\n# 运行\n$ sudo docker run test/cowsay-dockerfile  &apos;Moo&apos;\n\n\n# 使用脚本解决entrypoint\n$ vim entrypoint.sh\n~ #! /bin/bash\n~ if [ $# -eq 0 ]; then\n~      /usr/games/fortune | /usr/games/cowsay\n~  else\n~     /usr/games/cowsay &quot;$@&quot;\n~   fi\n~ :wq\n$ chmod +x entrypoint.sh\n$ vim Dockerfile\n~ FROM debian:wheezy\n~ RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune\n~ COPY entrypoint.sh /\n~ ENTRYPOINTER [&quot;/entrypoint.sh&quot;]\n~ :wq \n# 创建\n$ sudo docker build -t test/cowsay-dockerfile . \n&gt; Sending build content to Docker .....\n&gt; ....\n# 运行\n$ sudo docker run test/cowsay-dockerfile &apos;Moo&apos;</code></pre><h3 id=\"使用在线仓库\"><a href=\"#使用在线仓库\" class=\"headerlink\" title=\"使用在线仓库\"></a>使用在线仓库</h3><p>在线注册地址：　<a href=\"https://cloud.docker.com\" target=\"_blank\" rel=\"noopener\">https://cloud.docker.com</a></p>\n<pre><code># 登陆\n$ sudo docker login\n$ username:\n$ password:\n# 填写作者信息\n$ vim Dockerfile\n~ FROM debian:wheezy\n~ MAINTAINER username &lt;username@mail.com&gt;\n~ RUN apt-get update &amp;&amp; apt-get install -y cowsay fortune\n~ COPY entrypoint.sh /\n~ ENTRYPOINTER [&quot;/entrypoint.sh&quot;]\n~ :wq \n# 创建\n$ sudo docker build -t username/cowsay-dockerfile . \n&gt; Sending build content to Docker .....\n&gt; ....\n# 运行\n$ sudo docker run username/cowsay-dockerfile  &apos;Moo&apos;\n# 上传\n$ sudo docker push </code></pre><h3 id=\"容器连接\"><a href=\"#容器连接\" class=\"headerlink\" title=\"容器连接\"></a>容器连接</h3><pre><code>$ sudo docker run --name myredis -d redis # -d表示后台运行\n~ a1696406326aaaa6c28931e886b8dd664d191b083de4aed464d584b4720d57b1\n$ docker run --rm -it --link myredis:redis redis /bin/bash\n&gt; root@9c914447f5e1:/data# redis-cli -h redis -p 6379\n&gt; redis:6379&gt; ping\n&gt; PONG\n&gt; redis:6379&gt; set &quot;abc&quot; 123\n&gt; OK\n&gt; redis:6379&gt; get &quot;abc&quot;\n&gt; &quot;123&quot;\n&gt; redis:6379&gt; exit\n&gt; root@9c914447f5e1:/data# exit\n&gt; exit</code></pre><h3 id=\"容器的备份\"><a href=\"#容器的备份\" class=\"headerlink\" title=\"容器的备份\"></a>容器的备份</h3><pre><code># 查看所有的容器\n$ docker ps -a\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES\na1696406326a        redis               &quot;docker-entrypoint...&quot;   13 minutes ago      Up 13 minutes       6379/tcp            myredis\n# 备份指定的id\n$ docker commit -p a1696406326a redis-backup\n# 查看镜像\n$ docker images\nREPOSITORY                   TAG                 IMAGE ID            CREATED             SIZE\nredis-backup                 latest              fb9d896b3a39        11 seconds ago      107MB\n# 上传镜像(docker login &amp;&amp; docker push)\n# 或者打包\n$ docker save -o ./redis-backup.tar redis-backup\n# 恢复容器\n$ docker pull ****\n# 或者使用包\n$ docker load -i ./redis-backup.tar</code></pre><h3 id=\"让docker容器连接互联网\"><a href=\"#让docker容器连接互联网\" class=\"headerlink\" title=\"让docker容器连接互联网\"></a>让docker容器连接互联网</h3><pre><code># -p 8000:80 表示将主机的8000端口转发至容器的80端口\n$ docker run -d -p 8000:80 nginx \n\n# 容器互联\n$ docker run -d --name myredis redis\n$ docker run --link myredis:redis debian env  # --link 目标容器:目标容器在主容器内的简称\n~ PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n~ HOSTNAME=69df45e6f92d\n~ REDIS_PORT=tcp://172.17.0.2:6379\n~ REDIS_PORT_6379_TCP=tcp://172.17.0.2:6379\n~ REDIS_PORT_6379_TCP_ADDR=172.17.0.2\n~ REDIS_PORT_6379_TCP_PORT=6379\n~ REDIS_PORT_6379_TCP_PROTO=tcp\n~ REDIS_NAME=/stupefied_chandrasekhar/redis\n~ REDIS_ENV_GOSU_VERSION=1.10\n~ REDIS_ENV_REDIS_VERSION=4.0.2\n~ REDIS_ENV_REDIS_DOWNLOAD_URL=http://download.redis.io/releases/redis-4.0.2.tar.gz\n~ REDIS_ENV_REDIS_DOWNLOAD_SHA=b1a0915dbc91b979d06df1977fe594c3fa9b189f1f3d38743a2948c9f7634813\n~ HOME=/root</code></pre><h3 id=\"数据卷\"><a href=\"#数据卷\" class=\"headerlink\" title=\"数据卷\"></a>数据卷</h3><pre><code>#  -v指定数据卷\n$ docker run -it --name container-test -h container -v /ddata debian /bin/bash\n# 查看数据卷在本机的位置\n$ docker inspect -f { {.Mounts}} container-test  \n[{volume 4687a1d9a80dff56d951f14704a8125f1b642b50c78dac63d3a02a42ff05ffb9 /var/lib/docker/volumes/4687a1d9a80dff56d951f14704a8125f1b642b50c78dac63d3a02a42ff05ffb9/_data /ddata local  true }]\n# 可以在本机中添加文件并在容器中查看修改结果\n\n\n### 在dockerfile中设置数据卷\nFROM debian:wheezy\nRUN useradd foo\n# VOLUME /ddata # 此处添加无效果，因为touch chown是在一个临时容器内的数据卷中执行的\nRUN touch /data/x\nRUN CHOWN -R foo:foo /data\n# VOLUME /ddata # 此处添加可以\n\n\n# docker run -v 指定到特定数据卷\n$ docker run -v /home/adrian/data:./data debian ls /data\n\n\n# 数据容器\n$ docker run --name dbdata postgres echo &apos;data-only container for postage&apos; # 创建一个postgreSQL的容器\n# 使用--volumes-from参数，使其他容器也可以使用这个数据卷\n$ docker run -d --volumes-from dbdata --name db1 postgres</code></pre><h3 id=\"如何在开发中使用docker-以python-flask为例\"><a href=\"#如何在开发中使用docker-以python-flask为例\" class=\"headerlink\" title=\"如何在开发中使用docker,以python flask为例\"></a>如何在开发中使用docker,以python flask为例</h3><pre><code># 创建项目\n$ tree identidock\n.\n├── app\n│   └── identidock.py\n└── Dockerfile\n\n\n# 编辑flask文件\n$ vim app/identidock.py\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route(&apos;/&apos;)\ndef hello_world():\n    return &apos;hello world&apos;\n\nif __name__ == &apos;__main__&apos;:\n    app.run(debug=True, host=&apos;0.0.0.0&apos;)\n\n\n# 编辑dockerfile文件\n$ vim Dockerfile\nFROM python:3.4\n\nRUN pip install Flask==0.10.1\nWORKDIR /app\nCOPY app /app\nCMD [&quot;python&quot;, &quot;identidock.py&quot;]\n\n\n# 创建镜像并使用容器\n$ docker build -t identidock .\n...\n$ docker run -d -p 5000:5000 identidock # 后台运行并将主机的5000端口转发到docker\n$ curl localhost:5000\n~ hello world\n\n# 将开发的代码目录挂载到docker上，这样就不必每次更改代码都需要重新bulid一次．\n$ docker run -d -p 5000:5000 -v &quot;$PWD&quot;/app:/app identidock  # -v &quot;$PWD&quot;/app:/app把位于主机的./app目录挂载到容器内，覆盖容器/app目录下的内容\n# 可以修改app目录下的文件查看改动情况\n\n# 以wsgi服务器运行flask并且修改设置用户\n$ vim Dockerfile\nFROM python:3.4\n\nRUN groupadd -r uwsgi &amp;&amp; useradd -r -g uwsgi uwsgi # 创建用户组和用户\nRUN pip install Flask==0.10.1 uWSGI==2.0.8\nWORKDIR /app\nCOPY app /app\n\nEXPOSE 9090 9191  # 声明主机和其他容器可以访问的端口号\nUSER uwsgi #使用用户运行以下代码，默认docker是以root用户运行的，不安全\nCMD [&quot;uwsgi&quot;, &quot;--http&quot;, &quot;0.0.0.0:9090&quot;, &quot;--wsgi-file&quot;, &quot;/app/identidock.py&quot;, &quot;--callable&quot;, &quot;app&quot;, &quot;--stats&quot;, &quot;0.0.0.0:9191&quot;]</code></pre><h3 id=\"使用配置文件配置开发环境和生产环境\"><a href=\"#使用配置文件配置开发环境和生产环境\" class=\"headerlink\" title=\"使用配置文件配置开发环境和生产环境\"></a>使用配置文件配置开发环境和生产环境</h3><pre><code># 创建脚本文件cmd.sh\n$ tree\n.\n├── app\n│   └── identidock.py\n├── cmd.sh\n└── Dockerfile\n\n$ vim cmd.sh\n#! /bin/bash\nset -e\n\nif [ &quot;$ENV&quot; = &apos;DEV&apos; ]; then\n  echo &quot;Running Development Server&quot;\n  exec python &quot;identidock.py&quot;\nelse\n  echo &quot;Running Production Server&quot;\n  exec uwsgi --http 0.0.0.0:9090 --wsgi-file /app/identidock.py --callable app --stats 0.0.0.0:9191\nfi\n\n$ chmod +x cmd.sh\n$ vim Dockerfile\nFROM python:3.4\n\nRUN groupadd -r uwsgi &amp;&amp; useradd -r -g uwsgi uwsgi\nRUN pip install Flask==0.10.1 uWSGI==2.0.8\nWORKDIR /app\nCOPY app /app\nCOPY cmd.sh /\n\nEXPOSE 9090 9191\nUSER uwsgi\nCMD [&quot;/cmd.sh&quot;]\n\n$ docker build -t identidock .\n$ docker run -e &quot;ENV=DEV&quot; -p 5000:5000 identidock # 开发环境\n$ docker run -d -P identidock</code></pre><h3 id=\"使用compose自动化安装创建运行docker环境\"><a href=\"#使用compose自动化安装创建运行docker环境\" class=\"headerlink\" title=\"使用compose自动化安装创建运行docker环境\"></a>使用compose自动化安装创建运行docker环境</h3><pre><code># 安装环境\n# https://docs.docker.com/compose/install/\n$ sudo curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose\n$ sudo chmod +x /usr/local/bin/docker-compose\n$ docker-compose --version\n\n\n# 配置文件\ntree\n.\n├── app\n│   └── identidock.py\n├── cmd.sh\n├── docker-compose.yml\n└── Dockerfile\n# 编辑docker-compose文件\n$ vim docker-compose.yml\nidentidock:\n  build: .\n  ports:\n    - &quot;5000:5000&quot;\n  environment:\n    ENV: DEV\n  volumes:\n    - ./app:/app\n~                    \n\n\n# 使用方法\n$ docker-compose up # 如果有镜像则直接运行，如果没有镜像则先build\n$ docker-compose build # 重新构建镜像\n$ docker-compose ps 获取由compose管理的容器状态\n$ docker-compose logs 输出日志\n$ docker-stop 停止容器，但不会删除他们</code></pre>"},{"title":"centos7服务器基础配置","url":"90.html","id":"90","comments":0,"date":"2016-11-10T02:29:42.000Z","_content":"\n### 查看当前版本\n\n    cat /proc/version \n    cat /etc/redhat-release\n    Centos Linux release 7.2.1511 (Core)\n    \n\n### 修改root密码\n\n    > passwd root\n    > 输入密码\n    \n\n### 配置网络\n\ncentos网络配置地址 /etc/sysconfig/network Centos设置主机名和网络配置  \n/etc/sysconfig/network-scripts/ifcfg-eth0针对特定的网卡进行设置  \n/etc/resolv.conf设置DNS  \n/etc/hosts设置指定的域名解析地址  \n当前使用的是虚拟机网桥模式\n\n    cd /etc/sysconfig/network-scripts/\n    vi ifcfg-enp0s23\n    # 最后添加内容\n    IPADDR=192.168.0.160  # ip地址\n    NETMASK=255.255.255.0 # 掩码\n    GATEWAY=192.168.0.1 # 网关地址\n    DNS1=202.103.24.68 # DNS地址\n    # 修改内容\n    ONBOOT=yes # 启动时网络接口有效\n    BOOTPROTO=none # dhcp改成none dhcp自动获取，static固定，none手动\n    \n\n    # 启动网卡\n    sudo ifup eth0s23\n    sudo systemctl restart network\n    \n\n安装网络查看工具\n\n    yum install net-tools\n    \n\ncentos默认的命令是\n\n    ip addr\n    \n\n### 开机需要启动的5个服务\n\n    sshd远程登陆, \n    network网络,\n    rsyslog日志相关,\n    crond定时任务,\n    sysstat检测系统性能\n    \n\n### 创建用户\n\n    su\n    # 输入密码\n    useradd test\n    passwd test\n    # 输入密码\n    # 确认密码\n    su test # 切换成普通用户\n    \n\n将test用户加入到sudoers用\n\n    #visudo命令 # 相当于直接编辑 /etc/sudoers,但用命令方式更安全,推荐\n    su\n    cd /etc\n    chmod 777 sudoers\n    root    ALL=(ALL)       ALL\n    test    ALL=(ALL)       ALL  # 新添加的\n    chmod 440 sudoers   # 权限改成440，必须，否则会报错\n    \n\n### 配置ssh\n\n安装ssh\n\n    yum -y install  openssh*\n    \n\n    service sshd start    \n    \n\n### ssh连接\n\n    ssh test@192.168.0.160 # 默认22端口\n    ssh -p 2222 test@192.168.0.160 # 修改端口后\n    \n\n禁止root用户远程ssh连接\n\n    vi /etc/ssh/sshd_congif \n    # 最后添加\n    # 禁止root远程登陆  \n    PermitRootLogin no\n    \n\n### 关闭SELINUX\n\n修改/etc/selinux/config 文件  \n将SELINUX=enforcing改为SELINUX=disabled  \nsetenforce 0 ##设置SELinux 成为permissive模式,临时关闭或者及时起效\n\n### centos开启防火墙\n\n    systemctl mask firewalld\n    systemctl stop firewalld\n    yum install iptables-services # 如果下面命令报错，则需要安装\n    systemctl enable iptables\n    systemctl start iptables\n    systemctl enable ip6tables\n    systemctl start ip6tables\n    \n\n防火墙开机启动\n\n    systemctl enable iptables\n    systemctl disable iptables\n    \n\n    # 查看开机运行的服务\n    systemctl list-unit-files --type=service\n    \n\n防火墙是否放行ssh端口22\n\n    cd /etc/sysconfig/\n    vi iptables\n    \n\n在commit前添加以下内容，并注释文件开头信息\n\n    # sample configuration for iptables service\n    # you can edit this manually or use system-config-firewall\n    # please do not ask us to add additional ports/services to this default configuration\n    *filter\n    # :INPUT ACCEPT [0:0]\n    # :FORWARD ACCEPT [0:0]\n    # :OUTPUT ACCEPT [0:0]\n    # -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n    # -A INPUT -p icmp -j ACCEPT\n    # -A INPUT -i lo -j ACCEPT\n    # -A INPUT -j REJECT --reject-with icmp-host-prohibited\n    # -A FORWARD -j REJECT --reject-with icmp-host-prohibited\n    \n    \n    \n    \n    \n    # 安全设置-防止扫描包\n    # NONE 包(所有标识bit都没有设置)主要是扫描类的数据包\n    -A INPUT -p tcp --tcp-flags ALL NONE -j DROP\n    # 防止sync-flood 攻击\n    -A INPUT -p tcp ! --syn -m state --state NEW -j DROP\n    # ALL包（所有的标注bit都被设置了）也是网络扫描的数据包\n    -A INPUT -p tcp --tcp-flags ALL ALL -j DROP\n    \n    # 开放对应端口\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT\n    \n    # 缺省设置\n    :INPUT DROP [0:0]\n    :FORWARD ACCEPT [0:0]\n    :OUTPUT ACCEPT [0:0]\n    # 许所有从服务器端发起的连接，由此返回的响应数据应该是允许的,yum操作等\n    -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n    -A INPUT -p icmp -j ACCEPT\n    # 接受主机localhost的任意请求\n    -A INPUT -i lo -j ACCEPT\n    -A INPUT -j REJECT --reject-with icmp-host-prohibited\n    -A FORWARD -j REJECT --reject-with icmp-host-prohibited\n    \n    COMMIT\n    \n    \n    \n\n### ftp\n\n安装及启动\n\n    yum install vsftpd\n    systemctl start vsftpd\n    systemctl enable vsftpd\n    \n\n更新防火墙，放行20， 21端口，如果用了代理上传，需要添加被动模式的端口号  \n修改配置项目\n\n    vi /etc/vsftpd/vsftpd.conf\n    \n    anonymous_enable=No # YES改成No,禁止匿名用户\n    listen=YES # No改成Yes 开启监听\n    # listen_ipv6=YES  # 此行需要注释掉\n    tcp_wrappers=YES   # 默认应该就是YES\n    \n    # 在/etc/vsftpd.chroot_list文件中列出的用户，可以切换到其他目录；\n    # 未在/etc/vsftpd/chroot_list文件中列出的用户，不能切换到其他目录。\n    # 需要创建/etc/vsftpd/chroot_list文件\n    chroot_local_user=YES\n    chroot_list_enable=YES  \n    # (default follows) \n    chroot_list_file=/etc/vsftpd/chroot_list\n    \n    # 防止500oops错误 \n    allow_writeable_chroot=YES \n    # 被动模式端口号\n    pasv_min_port=30000  \n    pasv_max_port=31000    \n    \n    \n    \n\n只允许指定ip登陆\n\n    vi /etc/hosts.allow\n    最后添加\n    vsftpd:192.168.0.19:allow\n    vsftpd:all:deny\n    \n\n添加虚拟用户\n\n    useradd -g ftp -d /var/ftp/ftpuser -s /sbin/nologin ftpuser \n    passwd ftpuser\n    cd /etc/vsftpd/\n    touch chroot_list\n    vi chroot_list\n    ftpuser # 将用户名称添加到chroot_list里\n    \n\n### LAMP安装\n\napache\n\n    yum install httpd # 安装apache2\n    systemctl enable httpd.service\n    systemctl enable httpd.service\n    \n\nmysql5.6\n\n    # 安装rpm包\n    rpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm\n    # 查看可以安装的资源\n    yum repolist enabled | grep \"mysql.*-community.*\"\n    # 安装\n    yum install mysql-community-server\n    systemctl start mysqld\n    systemctl enable mysqld\n    mysql_secure_installation # 设置密码等\n    \n\nphp5.4\n\n    yum install php\n    yum install php-gd php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-snmp php-soap curl curl-devel php-mysql php-devel\n    \n\nphp5.6或者其他\n\n    yum -y install epel-release\n    wget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n    wget https://centos7.iuscommunity.org/ius-release.rpm\n    rpm -Uvh ius-release*.rpm\n    yum -y update\n    yum -y install php56u php56u-opcache php56u-xml php56u-mcrypt php56u-gd php56u-devel php56u-mysql php56u-intl php56u-mbstring php56u-bcmath\n    \n\n### LAMP配置\n\napache允许php脚本\n\n    vi /etc/httpd/conf/httpd.conf\n    AddType application/x-compress .Z\n    AddType application/x-gzip .gz .tgz\n    AddType application/x-httpd-php .php  # 新添加内容\n    \n\napache虚拟主机\n\n    cd /etc/httpd/conf.d\n    vi vhost.conf\n    \n\n    <VirtualHost *:121>\n    ServerName phpmyadmin.com\n    ServerAlias www.phpmyadmin.com\n    DocumentRoot /var/www/html/phpMyAdmin/\n    ErrorLog /var/www/web_log/phpMyAdmin.www_error.log # 开启日志需要创建web_log文件夹，否则会报错\n    CustomLog /var/www/web_log/phpMyAdmin.www_access.log common\n    </VirtualHost>\n    <Directory \"/var/www/html/phpMyAdmin/\">\n        Options FollowSymLinks\n        AllowOverride All\n        Require all granted\n    </Directory>\n    \n    \n    <VirtualHost *:108>\n    ServerName hkmain.com\n    ServerAlias www.kmain.com\n    DocumentRoot /var/www/html/NEW/\n    ErrorLog /var/www/web_log/NEW.www_error.log\n    CustomLog /var/www/web_log/NEW.www_access.log common\n    </VirtualHost>\n    <Directory \"/var/www/html/NEW/\">\n        Options FollowSymLinks\n        AllowOverride All\n        Require all granted\n    </Directory>\n    \n    \n\napache加载的模块查看\n\n    apachectl -M | sort\n    \n\n网站目录权限配置\n\n    chown -R apache:apache WEB_FOLD\n    chmod 750 WEB_FOLD\n    cd WEB_FOLD\n    find -type d -exec chmod 750 {} \\;\n    find -not -type d -exec chmod 640 {} \\;\n    find . -name \"Runtime\" -type d -exec chmod -R 770 {} \\;\n    \n\n### LNMP安装与配置\n\n参考链接 https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mysql-php-lemp-stack-on-centos-7 nginx安装(apache二选一)\n\n    # 安装pcre库，使nginx支持rewrite\n    sudo yum install pcre pcre-devel -y\n    sudo yum install nginx\n    sudo systemctl start nginx.service\n    # 设置开机启动\n    sudo systemctl enable nginx.service\n    \n\nmysql5.6\n\n    # 安装rpm包\n    rpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm\n    # 查看可以安装的资源\n    yum repolist enabled | grep \"mysql.*-community.*\"\n    # 安装\n    yum install mysql-community-server\n    systemctl start mysqld\n    systemctl enable mysqld\n    mysql_secure_installation # 设置密码等\n    \n\nphp安装\n\n    yum -y install epel-release\n    sudo yum install php php-mysql php-fpm\n    sudo yum install php-pecl-memcache\n    \n\n配置\n\n    vim /etc/php.ini\n    #cgi.fix_poathinfo=1改成\n    cgi.fix_pathinfo=0\n    \n\n    vim /etc/php-php.d/www.conf\n    # 第一处修改\n    listen = /var/run/php-fpm/php-fpm.sock\n    # 第二处修改\n    listen.owner = nobody\n    listen.group = nobody\n    # 第三处修改\n    user = nginx\n    group = nginx\n    \n\n    # 重启\n    sudo systemctl start php-fpm\n    sudo systemctl enable php-fpm\n    \n\n    # 安装xcahe\n    sudo yum -y install php-xcache xcache-admin\n    # 如果失败请用下面的方法\n    # xcahe\n    wget https://kojipkgs.fedoraproject.org//packages/php-xcache/3.1.1/1.el7/x86_64/php-xcache-3.1.1-1.el7.x86_64.rpm\n    # 图形化管理\n    wget https://kojipkgs.fedoraproject.org//packages/php-xcache/3.1.1/1.el7/noarch/xcache-admin-3.1.1-1.el7.noarch.rpm\n    \n\n#配置nginx sudo vi /etc/nginx/conf.d/default.conf server { listen 80; server\\_name server\\_domain\\_name\\_or_IP; # 注意位置，在括号外 root /usr/share/nginx/html; index index.php index.html index.htm;\n\n    location / {\n        try_files $uri $uri/ =404;\n    }\n    error_page 404 /404.html;\n    error_page 500 502 503 504 /50x.html;\n    location = /50x.html {\n        root /usr/share/nginx/html;\n    }\n        # 下面是配置fpm\n    location ~ \\.php$ {\n        try_files $uri =404;\n        fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock; (这个值从php-fpm复制来)\n        fastcgi_index index.php;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        include fastcgi_params;\n    }\n    \n\n}\n\n    # 测试\n    sudo vi /usr/share/nginx/html/info.php\n    <?php echo phpinfo();>\n    sudo systemctl restart php-fpm\n    sudo systemctl restart nginx\n    \n\n### 安装imagemagick\n\n    yum install php-pear gcc\n    yum install ImageMagick ImageMagick-devel ImageMagick-perl\n    pecl install imagick # 直接回车\n    echo extension=imagick.so >> /etc/php.ini # 添加php扩展\n    systemctl restart httpd\n    \n\n### mysql主从复制主服务器配置\n\n    vi /etc/my.cnf\n    [mysqld] \n    server-id=1     # 配一个唯一的ID编号，1至32  \n    log-bin=mysql-bin  # 二进制文件存放路径  \n    binlog-do-db=test1  # 需要同步的数据库名  \n    binlog-ignore-db=test2  # 不需要同步的数据库名 \n    \n\n其他参考mysql主从复制\n\n### rsycn数据同步\n\n    yum install rsync # 安装，默认端口873  \n    systemctl start rsyncd\n    systemctl enable rsyncd\n    \n    \n\n    vim rsync.conf# 日志文件位置，启动rsync后自动产生这个文件，无需提前创建\n    log file = /var/log/rsyncd.log\n    # pid文件的存放位置\n    pidfile = /var/run/rsyncd.pid\n    # 支持max connections参数的锁文件\n    lock file = /var/run/rsync.lock\n    # 用户认证配置文件，里面保存用户名称和密码，后面会创建这个文件\n    secrets file = /etc/rsync.pass\n    # rsync启动时欢迎信息页面文件位置（文件内容自定义\n    # motd file = /etc/rsyncd.Motd\n    #\n    \n    # 设置rsync运行权限为root\n    # uid = root\n    # 设置rsync运行权限为root\n    # gid = root\n    # 匿名用户\n    uid = 0\n    gid = 0\n    # 默认端口\n    port = 873\n    # 默认为true，修改为no，增加对目录文件软连接的备份\n    use chroot = no\n    # 设置rsync服务端文件为读写权限\n    read only = yes\n    # 不显示rsync服务端资源列表\n    list = no\n    # 最大连接数\n    max connections = 200\n    # 设置超时时间\n    timeout = 600\n    # 不验证用户密码\n    strict modes = false\n    # 执行数据同步的用户名，可以设置多个，用英文状态下逗号隔开\n    # auth users = test\n    # 允许进行数据同步的客户端IP地址，可以设置多个，用英文状态下逗号隔开\n    hosts allow = 192.168.0.206, 192.168.0.118\n    # 禁止数据同步的客户端IP地址，可以设置多个，用英文状态下逗号隔开\n    # hosts deny = 192.168.21.254\n    \n    # 自定义名称\n    [web]\n    # rsync服务端数据目录路径\n    path = /var/www/html/HKMAIN_NEW/Upload/product/manual/cn/\n    #\n    # 模块名称与自定义名称相同\n    comment = web\n    \n    [webe]\n    path = /var/www/html/HKMAIN_NEW/Upload/product/manual/en/\n    comment = webe\n    \n\n### centos7.2安装nfs服务器端\n\n    # 服务器端安装及配置\n    # 安装命令\n    sudo yum install nfs-utils rpcbind\n    # 查看是否安装成功\n    $ rpm -aq nfs-utils rpcbind\n    rpcbind-0.2.0-38.el7.x86_64\n    nfs-utils-1.3.0-0.33.el7_3.x86_64\n    # 启动rpcbind\n    sudo systemctl restart rpcbind\n    # 查看状态\n    systemctl status rpcbind\n    # 开机启动\n    sudo systemctl enable rpcbind\n    # 查看是否开机启动\n    systemctl is-enabled rpcbind # enable表示开机启动，disable表示不开机启动\n    # 启动及开机启动nfs服务\n    sudo systemctl restart nfs\n    sudo systemctl enable nfs\n    #配置nfs服务\n    vim /etc/exports\n    /readonly 192.168.0.160(insecure,ro,no_root_squash) # 指定ip地址，只读\n    /rwsync 192.168.0.0/24(insecure,rw,sync,no_root_squash) # 指定ip地址段，读写\n    # 加载配置文件\n    sudo exportfs -rv\n    # 查看nfs服务器本地挂载情况\n    $ showmount -e localhost\n    Export list for localhost:\n    /rwsync   192.168.0.0/24\n    /readonly 192.168.0.160\n    # 重启服务\n    sudo systemctl restart nfs\n    \n    \n    # 客户端安装配置\n    sudo yum install nfs-utils rpcbind\n    # 只需启动rpc服务\n    sudo systemctl restart rpcbind\n    sudo systemctl enable rpcbind\n    # 查看可以挂载服务器端的目录\n    showmount -e 192.168.0.206\n    Export list for 192.168.0.206:\n    /rwsync   192.168.0.0/24\n    /readonly 192.168.0.160\n    # 挂载\n    sudo mount -t nfs 192.168.0.206:/readonly /mnt/readonly\n    sudo mount -t nfs 192.168.0.206:/rwsync /mnt/rwsync\n    # 查看挂载结果\n    df -h\n    \n    \n    \n\n### centos7.2安装python3.5\n\n    # 安装编译环境\n    yum install openssl-devel bzip2-devel expat-devel gdbm-devel readline-devel sqlite-devel\n    # 下载文件\n    wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tgz\n    # 解压\n    tar -zxvf Python-3.6.6.tgz\n    # 编译安装\n    cd Python-3.5.1\n    ./configure --prefix=/usr/local/python3\n    make && make install\n    # 创建软连接\n    sudo ln -s /usr/local/python3/bin/python3 /usr/bin/python3\n    python3 --version\n    sudo ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3 \n    pip3 --version\n    \n    # 添加pip源\n    vim ~/.pip/pip.conf\n    [global]\n    trusted-host =  mirrors.aliyun.com\n    index-url = https://mirrors.aliyun.com/pypi/simple\n    \n    ### 安装虚拟环境\n    sudo pip3 uninstall virtualenv\n    sudo ln -s /usr/local/python3/bin/virtualenv /usr/bin/virtualenv \n    \n    ### 创建虚拟环境\n    virtualenv --no-site-packages -p python3 .env\n    source ./.env/bin/activate\n    \n\n### centos7.2安装node8\n\n    # 参考文件 https://nodejs.org/en/download/package-manager/\n    On RHEL, CentOS or Fedora, for Node.js v8 LTS:\n    \n    curl --silent --location https://rpm.nodesource.com/setup_8.x | sudo bash -\n    Alternatively for Node.js 10:\n    \n    curl --silent --location https://rpm.nodesource.com/setup_10.x | sudo bash -\n    Then install:\n    sudo yum -y install nodejs\n    \n    \n    # 安装cnpm\n    npm install -g cnpm --registry=https://registry.npm.taobao.org\n    \n\n### centos6.8安装nginx\n\n    # 安装pcre库，使nginx支持rewrite\n    yum install pcre pcre-devel -y\n    # 安装openssl，https服务需要使用\n    yum install openssl openssl-devel -y\n    # 安装 gzip 类库\n    yum -y install zlib zlib-devel\n    # 安装编译程序\n    yum -y install make gcc gcc-c++ ncurses-devel\n    # 创建用户\n    useradd nginx -s /sbin/nologin -M\n    # 下载源码\n    wget -q https://nginx.org/download/nginx-1.6.3.tar.gz \n    tar -zxvf nginx-1.6.3.tar.gz\n    cd nginx-1.6.3\n    ./configure --user=nginx --group=nginx --prefix=/usr/local/nginx --with-http_ssl_module --with-http_stub_status_module --with-pcre\n    make\n    make install\n    \n\n    # 启动nginx\n    /usr/local/nginx/sbin/nginx\n    # 停止nginx\n    /usr/local/nginx/sbin/nginx -s quit\n    # 重新加载配置文件\n    /usr/local/nginx/sbin/nginx -s reload        \n    # 测试你的配置文件是否有误\n    /usr/local/nginx/sbin/nginx -t       \n    # 查看nginx对应的端口\n     lsof -i :80\n    \n\n### centos6.8安装mysql5.7\n\n    # yum源直接安装的是mysql5.1版本，抛弃\n    # 先检查是否有旧版本\n    rpm -qa | grep mysql\n    # 删除旧版本\n    sudo yum -y remove mysql-xx-xx\n    wget https://dev.mysql.com/get/mysql57-community-release-el6-10.noarch.rpm\n    sudo yum install mysql57-community-release-el6-10.noarch.rpm\n    sudo yum install mysql-community-server\n    \n\n### centos7.2 源码安装nginx\n\n    # 安装pcre库，使nginx支持rewrite\n    yum install pcre pcre-devel -y\n    # 安装openssl，https服务需要使用\n    yum install openssl openssl-devel -y\n    # 安装 gzip 类库\n    yum -y install zlib zlib-devel\n    # 安装编译程序\n    yum -y install make gcc gcc-c++ ncurses-devel\n    # 创建用户\n    useradd nginx -s /sbin/nologin -M\n    # 下载源码\n    wget -q https://nginx.org/download/nginx-1.12.1.tar.gz \n    tar -zxvf nginx-1.12.1.tar.gz\n    cd nginx-1.12.1\n    ./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_gunzip_module --with-http_gzip_static_module --with-threads --with-file-aio --with-ipv6 --with-http_v2_module --with-cc-opt='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=native'\n    make\n    make install\n    \n\n    # 创建链接\n    sudo ln -s /usr/local/nginx/bin/nginx /usr/bin/nginx\n    # 启动nginx\n    /usr/local/nginx/sbin/nginx\n    # 停止nginx\n    /usr/local/nginx/sbin/nginx -s quit\n    # 重新加载配置文件\n    /usr/local/nginx/sbin/nginx -s reload        \n    # 测试你的配置文件是否有误\n    /usr/local/nginx/sbin/nginx -t       \n    # 查看nginx对应的端口\n     lsof -i :80\n    \n    \n\n### centos7.2安装php7\n\n    # 加源\n    sudo yum install epel-release yum-utils\n    sudo yum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm\n    # 选择remi\n    sudo yum-config-manager --enable remi-php70\n    sudo yum-config-manager --enable remi-php71\n    sudo yum-config-manager --enable remi-php72\n    # 安装相关扩展\n    sudo yum-config-manager --enable remi-php70\n    sudo yum install php php-common php-opcache php-mcrypt php-cli php-gd php-curl php-mysql\n    # 安装 PHP FPM \n    sudo yum install php-fpm\n    sudo systemctl enable php-fpm\n    sudo systemctl start php-fpm\n    # 配置\n    sudo vim /etc/php-fpm.d/www.conf\n    user = nginx\n    group = nginx\n    \n\n    # 配置nginx虚拟server\n    server {\n    \n        # . . . other code\n    \n        location ~ \\.php$ {\n            try_files $uri =404;\n            # fastcgi_pass unix:/run/php-fpm/www.sock;\n                    fastcgi_pass 127.0.0.1:9000;\n            fastcgi_index index.php;\n            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n            include fastcgi_params;\n        }\n    }\n    \n\n### centos7.2安装redis\n\n    $ sudo yum install redis\n    $ sudo systemctl enable redis\n    $ sudo systemctl start redis\n    # 查看版本号\n    $ redis-server --version\n    \n\n    # 使用方法 http://www.zhuohc.com/articles/redis%E5%9F%BA%E7%A1%80/\n    \n\n[centos7.2安装使用docker](/articles/centos7-2安装及使用docker/) [centos7.2安装使用sentry](/articles/centos7-2安装使用sentry/) [centos7.2安装使用rabbitMQ](/articles/centos7-2使用rabbitmq/) [centos7.2安装使用postgresql](/articles/postgresql常见命令/)\n\n#### centos7.2安装supervisor\n安装\n```shell\n$ sudo yum install -y supervisor\n$ systemctl enable supervisord # 开机自启动\n$ systemctl start supervisord # 启动supervisord服务\n$ systemctl status supervisord # 查看supervisord服务状态\n$ ps -ef|grep supervisord # 查看是否存在supervisord进程\n```\n配置\n```shell\n# 设置web访问\n[inet_http_server]\nport=*:9001                                                  \nusername=username\npassword=password \n[include]                                                                                   │(.env-api) ➜  supervisord.d sudo vim doneself-api.ini                 \nfiles = supervisord.d/*.ini   # 配置文件地址\n```\n```shell\n$ vim xxx.ini\n[program:doneself-api-uwsgi]\ncommand = /home/doneself/code/web/.env-api/bin/uwsgi --ini /home/doneself/code/web/api/uwsgi.ini\nautostart = true\nautorestart = true\nstopsignal= QUIT\nuser= doneself\nredirect_stderr=false\nstdout_logfile = /home/doneself/code/web/api/log/uwsgi_stdout.log\nstderr_logfile = /home/doneself/code/web/api/log/uwsgi_stderr.log\n```\n[其他信息](http://supervisord.org/)","source":"_posts/centos7服务器基础配置.md","raw":"---\ntitle: centos7服务器基础配置\ntags:\n  - linux\nurl: 90.html\nid: 90\ncomments: false\ncategories:\n  - 运维\ndate: 2016-11-10 10:29:42\n---\n\n### 查看当前版本\n\n    cat /proc/version \n    cat /etc/redhat-release\n    Centos Linux release 7.2.1511 (Core)\n    \n\n### 修改root密码\n\n    > passwd root\n    > 输入密码\n    \n\n### 配置网络\n\ncentos网络配置地址 /etc/sysconfig/network Centos设置主机名和网络配置  \n/etc/sysconfig/network-scripts/ifcfg-eth0针对特定的网卡进行设置  \n/etc/resolv.conf设置DNS  \n/etc/hosts设置指定的域名解析地址  \n当前使用的是虚拟机网桥模式\n\n    cd /etc/sysconfig/network-scripts/\n    vi ifcfg-enp0s23\n    # 最后添加内容\n    IPADDR=192.168.0.160  # ip地址\n    NETMASK=255.255.255.0 # 掩码\n    GATEWAY=192.168.0.1 # 网关地址\n    DNS1=202.103.24.68 # DNS地址\n    # 修改内容\n    ONBOOT=yes # 启动时网络接口有效\n    BOOTPROTO=none # dhcp改成none dhcp自动获取，static固定，none手动\n    \n\n    # 启动网卡\n    sudo ifup eth0s23\n    sudo systemctl restart network\n    \n\n安装网络查看工具\n\n    yum install net-tools\n    \n\ncentos默认的命令是\n\n    ip addr\n    \n\n### 开机需要启动的5个服务\n\n    sshd远程登陆, \n    network网络,\n    rsyslog日志相关,\n    crond定时任务,\n    sysstat检测系统性能\n    \n\n### 创建用户\n\n    su\n    # 输入密码\n    useradd test\n    passwd test\n    # 输入密码\n    # 确认密码\n    su test # 切换成普通用户\n    \n\n将test用户加入到sudoers用\n\n    #visudo命令 # 相当于直接编辑 /etc/sudoers,但用命令方式更安全,推荐\n    su\n    cd /etc\n    chmod 777 sudoers\n    root    ALL=(ALL)       ALL\n    test    ALL=(ALL)       ALL  # 新添加的\n    chmod 440 sudoers   # 权限改成440，必须，否则会报错\n    \n\n### 配置ssh\n\n安装ssh\n\n    yum -y install  openssh*\n    \n\n    service sshd start    \n    \n\n### ssh连接\n\n    ssh test@192.168.0.160 # 默认22端口\n    ssh -p 2222 test@192.168.0.160 # 修改端口后\n    \n\n禁止root用户远程ssh连接\n\n    vi /etc/ssh/sshd_congif \n    # 最后添加\n    # 禁止root远程登陆  \n    PermitRootLogin no\n    \n\n### 关闭SELINUX\n\n修改/etc/selinux/config 文件  \n将SELINUX=enforcing改为SELINUX=disabled  \nsetenforce 0 ##设置SELinux 成为permissive模式,临时关闭或者及时起效\n\n### centos开启防火墙\n\n    systemctl mask firewalld\n    systemctl stop firewalld\n    yum install iptables-services # 如果下面命令报错，则需要安装\n    systemctl enable iptables\n    systemctl start iptables\n    systemctl enable ip6tables\n    systemctl start ip6tables\n    \n\n防火墙开机启动\n\n    systemctl enable iptables\n    systemctl disable iptables\n    \n\n    # 查看开机运行的服务\n    systemctl list-unit-files --type=service\n    \n\n防火墙是否放行ssh端口22\n\n    cd /etc/sysconfig/\n    vi iptables\n    \n\n在commit前添加以下内容，并注释文件开头信息\n\n    # sample configuration for iptables service\n    # you can edit this manually or use system-config-firewall\n    # please do not ask us to add additional ports/services to this default configuration\n    *filter\n    # :INPUT ACCEPT [0:0]\n    # :FORWARD ACCEPT [0:0]\n    # :OUTPUT ACCEPT [0:0]\n    # -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n    # -A INPUT -p icmp -j ACCEPT\n    # -A INPUT -i lo -j ACCEPT\n    # -A INPUT -j REJECT --reject-with icmp-host-prohibited\n    # -A FORWARD -j REJECT --reject-with icmp-host-prohibited\n    \n    \n    \n    \n    \n    # 安全设置-防止扫描包\n    # NONE 包(所有标识bit都没有设置)主要是扫描类的数据包\n    -A INPUT -p tcp --tcp-flags ALL NONE -j DROP\n    # 防止sync-flood 攻击\n    -A INPUT -p tcp ! --syn -m state --state NEW -j DROP\n    # ALL包（所有的标注bit都被设置了）也是网络扫描的数据包\n    -A INPUT -p tcp --tcp-flags ALL ALL -j DROP\n    \n    # 开放对应端口\n    -A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT\n    \n    # 缺省设置\n    :INPUT DROP [0:0]\n    :FORWARD ACCEPT [0:0]\n    :OUTPUT ACCEPT [0:0]\n    # 许所有从服务器端发起的连接，由此返回的响应数据应该是允许的,yum操作等\n    -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n    -A INPUT -p icmp -j ACCEPT\n    # 接受主机localhost的任意请求\n    -A INPUT -i lo -j ACCEPT\n    -A INPUT -j REJECT --reject-with icmp-host-prohibited\n    -A FORWARD -j REJECT --reject-with icmp-host-prohibited\n    \n    COMMIT\n    \n    \n    \n\n### ftp\n\n安装及启动\n\n    yum install vsftpd\n    systemctl start vsftpd\n    systemctl enable vsftpd\n    \n\n更新防火墙，放行20， 21端口，如果用了代理上传，需要添加被动模式的端口号  \n修改配置项目\n\n    vi /etc/vsftpd/vsftpd.conf\n    \n    anonymous_enable=No # YES改成No,禁止匿名用户\n    listen=YES # No改成Yes 开启监听\n    # listen_ipv6=YES  # 此行需要注释掉\n    tcp_wrappers=YES   # 默认应该就是YES\n    \n    # 在/etc/vsftpd.chroot_list文件中列出的用户，可以切换到其他目录；\n    # 未在/etc/vsftpd/chroot_list文件中列出的用户，不能切换到其他目录。\n    # 需要创建/etc/vsftpd/chroot_list文件\n    chroot_local_user=YES\n    chroot_list_enable=YES  \n    # (default follows) \n    chroot_list_file=/etc/vsftpd/chroot_list\n    \n    # 防止500oops错误 \n    allow_writeable_chroot=YES \n    # 被动模式端口号\n    pasv_min_port=30000  \n    pasv_max_port=31000    \n    \n    \n    \n\n只允许指定ip登陆\n\n    vi /etc/hosts.allow\n    最后添加\n    vsftpd:192.168.0.19:allow\n    vsftpd:all:deny\n    \n\n添加虚拟用户\n\n    useradd -g ftp -d /var/ftp/ftpuser -s /sbin/nologin ftpuser \n    passwd ftpuser\n    cd /etc/vsftpd/\n    touch chroot_list\n    vi chroot_list\n    ftpuser # 将用户名称添加到chroot_list里\n    \n\n### LAMP安装\n\napache\n\n    yum install httpd # 安装apache2\n    systemctl enable httpd.service\n    systemctl enable httpd.service\n    \n\nmysql5.6\n\n    # 安装rpm包\n    rpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm\n    # 查看可以安装的资源\n    yum repolist enabled | grep \"mysql.*-community.*\"\n    # 安装\n    yum install mysql-community-server\n    systemctl start mysqld\n    systemctl enable mysqld\n    mysql_secure_installation # 设置密码等\n    \n\nphp5.4\n\n    yum install php\n    yum install php-gd php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-snmp php-soap curl curl-devel php-mysql php-devel\n    \n\nphp5.6或者其他\n\n    yum -y install epel-release\n    wget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n    wget https://centos7.iuscommunity.org/ius-release.rpm\n    rpm -Uvh ius-release*.rpm\n    yum -y update\n    yum -y install php56u php56u-opcache php56u-xml php56u-mcrypt php56u-gd php56u-devel php56u-mysql php56u-intl php56u-mbstring php56u-bcmath\n    \n\n### LAMP配置\n\napache允许php脚本\n\n    vi /etc/httpd/conf/httpd.conf\n    AddType application/x-compress .Z\n    AddType application/x-gzip .gz .tgz\n    AddType application/x-httpd-php .php  # 新添加内容\n    \n\napache虚拟主机\n\n    cd /etc/httpd/conf.d\n    vi vhost.conf\n    \n\n    <VirtualHost *:121>\n    ServerName phpmyadmin.com\n    ServerAlias www.phpmyadmin.com\n    DocumentRoot /var/www/html/phpMyAdmin/\n    ErrorLog /var/www/web_log/phpMyAdmin.www_error.log # 开启日志需要创建web_log文件夹，否则会报错\n    CustomLog /var/www/web_log/phpMyAdmin.www_access.log common\n    </VirtualHost>\n    <Directory \"/var/www/html/phpMyAdmin/\">\n        Options FollowSymLinks\n        AllowOverride All\n        Require all granted\n    </Directory>\n    \n    \n    <VirtualHost *:108>\n    ServerName hkmain.com\n    ServerAlias www.kmain.com\n    DocumentRoot /var/www/html/NEW/\n    ErrorLog /var/www/web_log/NEW.www_error.log\n    CustomLog /var/www/web_log/NEW.www_access.log common\n    </VirtualHost>\n    <Directory \"/var/www/html/NEW/\">\n        Options FollowSymLinks\n        AllowOverride All\n        Require all granted\n    </Directory>\n    \n    \n\napache加载的模块查看\n\n    apachectl -M | sort\n    \n\n网站目录权限配置\n\n    chown -R apache:apache WEB_FOLD\n    chmod 750 WEB_FOLD\n    cd WEB_FOLD\n    find -type d -exec chmod 750 {} \\;\n    find -not -type d -exec chmod 640 {} \\;\n    find . -name \"Runtime\" -type d -exec chmod -R 770 {} \\;\n    \n\n### LNMP安装与配置\n\n参考链接 https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mysql-php-lemp-stack-on-centos-7 nginx安装(apache二选一)\n\n    # 安装pcre库，使nginx支持rewrite\n    sudo yum install pcre pcre-devel -y\n    sudo yum install nginx\n    sudo systemctl start nginx.service\n    # 设置开机启动\n    sudo systemctl enable nginx.service\n    \n\nmysql5.6\n\n    # 安装rpm包\n    rpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm\n    # 查看可以安装的资源\n    yum repolist enabled | grep \"mysql.*-community.*\"\n    # 安装\n    yum install mysql-community-server\n    systemctl start mysqld\n    systemctl enable mysqld\n    mysql_secure_installation # 设置密码等\n    \n\nphp安装\n\n    yum -y install epel-release\n    sudo yum install php php-mysql php-fpm\n    sudo yum install php-pecl-memcache\n    \n\n配置\n\n    vim /etc/php.ini\n    #cgi.fix_poathinfo=1改成\n    cgi.fix_pathinfo=0\n    \n\n    vim /etc/php-php.d/www.conf\n    # 第一处修改\n    listen = /var/run/php-fpm/php-fpm.sock\n    # 第二处修改\n    listen.owner = nobody\n    listen.group = nobody\n    # 第三处修改\n    user = nginx\n    group = nginx\n    \n\n    # 重启\n    sudo systemctl start php-fpm\n    sudo systemctl enable php-fpm\n    \n\n    # 安装xcahe\n    sudo yum -y install php-xcache xcache-admin\n    # 如果失败请用下面的方法\n    # xcahe\n    wget https://kojipkgs.fedoraproject.org//packages/php-xcache/3.1.1/1.el7/x86_64/php-xcache-3.1.1-1.el7.x86_64.rpm\n    # 图形化管理\n    wget https://kojipkgs.fedoraproject.org//packages/php-xcache/3.1.1/1.el7/noarch/xcache-admin-3.1.1-1.el7.noarch.rpm\n    \n\n#配置nginx sudo vi /etc/nginx/conf.d/default.conf server { listen 80; server\\_name server\\_domain\\_name\\_or_IP; # 注意位置，在括号外 root /usr/share/nginx/html; index index.php index.html index.htm;\n\n    location / {\n        try_files $uri $uri/ =404;\n    }\n    error_page 404 /404.html;\n    error_page 500 502 503 504 /50x.html;\n    location = /50x.html {\n        root /usr/share/nginx/html;\n    }\n        # 下面是配置fpm\n    location ~ \\.php$ {\n        try_files $uri =404;\n        fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock; (这个值从php-fpm复制来)\n        fastcgi_index index.php;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        include fastcgi_params;\n    }\n    \n\n}\n\n    # 测试\n    sudo vi /usr/share/nginx/html/info.php\n    <?php echo phpinfo();>\n    sudo systemctl restart php-fpm\n    sudo systemctl restart nginx\n    \n\n### 安装imagemagick\n\n    yum install php-pear gcc\n    yum install ImageMagick ImageMagick-devel ImageMagick-perl\n    pecl install imagick # 直接回车\n    echo extension=imagick.so >> /etc/php.ini # 添加php扩展\n    systemctl restart httpd\n    \n\n### mysql主从复制主服务器配置\n\n    vi /etc/my.cnf\n    [mysqld] \n    server-id=1     # 配一个唯一的ID编号，1至32  \n    log-bin=mysql-bin  # 二进制文件存放路径  \n    binlog-do-db=test1  # 需要同步的数据库名  \n    binlog-ignore-db=test2  # 不需要同步的数据库名 \n    \n\n其他参考mysql主从复制\n\n### rsycn数据同步\n\n    yum install rsync # 安装，默认端口873  \n    systemctl start rsyncd\n    systemctl enable rsyncd\n    \n    \n\n    vim rsync.conf# 日志文件位置，启动rsync后自动产生这个文件，无需提前创建\n    log file = /var/log/rsyncd.log\n    # pid文件的存放位置\n    pidfile = /var/run/rsyncd.pid\n    # 支持max connections参数的锁文件\n    lock file = /var/run/rsync.lock\n    # 用户认证配置文件，里面保存用户名称和密码，后面会创建这个文件\n    secrets file = /etc/rsync.pass\n    # rsync启动时欢迎信息页面文件位置（文件内容自定义\n    # motd file = /etc/rsyncd.Motd\n    #\n    \n    # 设置rsync运行权限为root\n    # uid = root\n    # 设置rsync运行权限为root\n    # gid = root\n    # 匿名用户\n    uid = 0\n    gid = 0\n    # 默认端口\n    port = 873\n    # 默认为true，修改为no，增加对目录文件软连接的备份\n    use chroot = no\n    # 设置rsync服务端文件为读写权限\n    read only = yes\n    # 不显示rsync服务端资源列表\n    list = no\n    # 最大连接数\n    max connections = 200\n    # 设置超时时间\n    timeout = 600\n    # 不验证用户密码\n    strict modes = false\n    # 执行数据同步的用户名，可以设置多个，用英文状态下逗号隔开\n    # auth users = test\n    # 允许进行数据同步的客户端IP地址，可以设置多个，用英文状态下逗号隔开\n    hosts allow = 192.168.0.206, 192.168.0.118\n    # 禁止数据同步的客户端IP地址，可以设置多个，用英文状态下逗号隔开\n    # hosts deny = 192.168.21.254\n    \n    # 自定义名称\n    [web]\n    # rsync服务端数据目录路径\n    path = /var/www/html/HKMAIN_NEW/Upload/product/manual/cn/\n    #\n    # 模块名称与自定义名称相同\n    comment = web\n    \n    [webe]\n    path = /var/www/html/HKMAIN_NEW/Upload/product/manual/en/\n    comment = webe\n    \n\n### centos7.2安装nfs服务器端\n\n    # 服务器端安装及配置\n    # 安装命令\n    sudo yum install nfs-utils rpcbind\n    # 查看是否安装成功\n    $ rpm -aq nfs-utils rpcbind\n    rpcbind-0.2.0-38.el7.x86_64\n    nfs-utils-1.3.0-0.33.el7_3.x86_64\n    # 启动rpcbind\n    sudo systemctl restart rpcbind\n    # 查看状态\n    systemctl status rpcbind\n    # 开机启动\n    sudo systemctl enable rpcbind\n    # 查看是否开机启动\n    systemctl is-enabled rpcbind # enable表示开机启动，disable表示不开机启动\n    # 启动及开机启动nfs服务\n    sudo systemctl restart nfs\n    sudo systemctl enable nfs\n    #配置nfs服务\n    vim /etc/exports\n    /readonly 192.168.0.160(insecure,ro,no_root_squash) # 指定ip地址，只读\n    /rwsync 192.168.0.0/24(insecure,rw,sync,no_root_squash) # 指定ip地址段，读写\n    # 加载配置文件\n    sudo exportfs -rv\n    # 查看nfs服务器本地挂载情况\n    $ showmount -e localhost\n    Export list for localhost:\n    /rwsync   192.168.0.0/24\n    /readonly 192.168.0.160\n    # 重启服务\n    sudo systemctl restart nfs\n    \n    \n    # 客户端安装配置\n    sudo yum install nfs-utils rpcbind\n    # 只需启动rpc服务\n    sudo systemctl restart rpcbind\n    sudo systemctl enable rpcbind\n    # 查看可以挂载服务器端的目录\n    showmount -e 192.168.0.206\n    Export list for 192.168.0.206:\n    /rwsync   192.168.0.0/24\n    /readonly 192.168.0.160\n    # 挂载\n    sudo mount -t nfs 192.168.0.206:/readonly /mnt/readonly\n    sudo mount -t nfs 192.168.0.206:/rwsync /mnt/rwsync\n    # 查看挂载结果\n    df -h\n    \n    \n    \n\n### centos7.2安装python3.5\n\n    # 安装编译环境\n    yum install openssl-devel bzip2-devel expat-devel gdbm-devel readline-devel sqlite-devel\n    # 下载文件\n    wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tgz\n    # 解压\n    tar -zxvf Python-3.6.6.tgz\n    # 编译安装\n    cd Python-3.5.1\n    ./configure --prefix=/usr/local/python3\n    make && make install\n    # 创建软连接\n    sudo ln -s /usr/local/python3/bin/python3 /usr/bin/python3\n    python3 --version\n    sudo ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3 \n    pip3 --version\n    \n    # 添加pip源\n    vim ~/.pip/pip.conf\n    [global]\n    trusted-host =  mirrors.aliyun.com\n    index-url = https://mirrors.aliyun.com/pypi/simple\n    \n    ### 安装虚拟环境\n    sudo pip3 uninstall virtualenv\n    sudo ln -s /usr/local/python3/bin/virtualenv /usr/bin/virtualenv \n    \n    ### 创建虚拟环境\n    virtualenv --no-site-packages -p python3 .env\n    source ./.env/bin/activate\n    \n\n### centos7.2安装node8\n\n    # 参考文件 https://nodejs.org/en/download/package-manager/\n    On RHEL, CentOS or Fedora, for Node.js v8 LTS:\n    \n    curl --silent --location https://rpm.nodesource.com/setup_8.x | sudo bash -\n    Alternatively for Node.js 10:\n    \n    curl --silent --location https://rpm.nodesource.com/setup_10.x | sudo bash -\n    Then install:\n    sudo yum -y install nodejs\n    \n    \n    # 安装cnpm\n    npm install -g cnpm --registry=https://registry.npm.taobao.org\n    \n\n### centos6.8安装nginx\n\n    # 安装pcre库，使nginx支持rewrite\n    yum install pcre pcre-devel -y\n    # 安装openssl，https服务需要使用\n    yum install openssl openssl-devel -y\n    # 安装 gzip 类库\n    yum -y install zlib zlib-devel\n    # 安装编译程序\n    yum -y install make gcc gcc-c++ ncurses-devel\n    # 创建用户\n    useradd nginx -s /sbin/nologin -M\n    # 下载源码\n    wget -q https://nginx.org/download/nginx-1.6.3.tar.gz \n    tar -zxvf nginx-1.6.3.tar.gz\n    cd nginx-1.6.3\n    ./configure --user=nginx --group=nginx --prefix=/usr/local/nginx --with-http_ssl_module --with-http_stub_status_module --with-pcre\n    make\n    make install\n    \n\n    # 启动nginx\n    /usr/local/nginx/sbin/nginx\n    # 停止nginx\n    /usr/local/nginx/sbin/nginx -s quit\n    # 重新加载配置文件\n    /usr/local/nginx/sbin/nginx -s reload        \n    # 测试你的配置文件是否有误\n    /usr/local/nginx/sbin/nginx -t       \n    # 查看nginx对应的端口\n     lsof -i :80\n    \n\n### centos6.8安装mysql5.7\n\n    # yum源直接安装的是mysql5.1版本，抛弃\n    # 先检查是否有旧版本\n    rpm -qa | grep mysql\n    # 删除旧版本\n    sudo yum -y remove mysql-xx-xx\n    wget https://dev.mysql.com/get/mysql57-community-release-el6-10.noarch.rpm\n    sudo yum install mysql57-community-release-el6-10.noarch.rpm\n    sudo yum install mysql-community-server\n    \n\n### centos7.2 源码安装nginx\n\n    # 安装pcre库，使nginx支持rewrite\n    yum install pcre pcre-devel -y\n    # 安装openssl，https服务需要使用\n    yum install openssl openssl-devel -y\n    # 安装 gzip 类库\n    yum -y install zlib zlib-devel\n    # 安装编译程序\n    yum -y install make gcc gcc-c++ ncurses-devel\n    # 创建用户\n    useradd nginx -s /sbin/nologin -M\n    # 下载源码\n    wget -q https://nginx.org/download/nginx-1.12.1.tar.gz \n    tar -zxvf nginx-1.12.1.tar.gz\n    cd nginx-1.12.1\n    ./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_gunzip_module --with-http_gzip_static_module --with-threads --with-file-aio --with-ipv6 --with-http_v2_module --with-cc-opt='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=native'\n    make\n    make install\n    \n\n    # 创建链接\n    sudo ln -s /usr/local/nginx/bin/nginx /usr/bin/nginx\n    # 启动nginx\n    /usr/local/nginx/sbin/nginx\n    # 停止nginx\n    /usr/local/nginx/sbin/nginx -s quit\n    # 重新加载配置文件\n    /usr/local/nginx/sbin/nginx -s reload        \n    # 测试你的配置文件是否有误\n    /usr/local/nginx/sbin/nginx -t       \n    # 查看nginx对应的端口\n     lsof -i :80\n    \n    \n\n### centos7.2安装php7\n\n    # 加源\n    sudo yum install epel-release yum-utils\n    sudo yum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm\n    # 选择remi\n    sudo yum-config-manager --enable remi-php70\n    sudo yum-config-manager --enable remi-php71\n    sudo yum-config-manager --enable remi-php72\n    # 安装相关扩展\n    sudo yum-config-manager --enable remi-php70\n    sudo yum install php php-common php-opcache php-mcrypt php-cli php-gd php-curl php-mysql\n    # 安装 PHP FPM \n    sudo yum install php-fpm\n    sudo systemctl enable php-fpm\n    sudo systemctl start php-fpm\n    # 配置\n    sudo vim /etc/php-fpm.d/www.conf\n    user = nginx\n    group = nginx\n    \n\n    # 配置nginx虚拟server\n    server {\n    \n        # . . . other code\n    \n        location ~ \\.php$ {\n            try_files $uri =404;\n            # fastcgi_pass unix:/run/php-fpm/www.sock;\n                    fastcgi_pass 127.0.0.1:9000;\n            fastcgi_index index.php;\n            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n            include fastcgi_params;\n        }\n    }\n    \n\n### centos7.2安装redis\n\n    $ sudo yum install redis\n    $ sudo systemctl enable redis\n    $ sudo systemctl start redis\n    # 查看版本号\n    $ redis-server --version\n    \n\n    # 使用方法 http://www.zhuohc.com/articles/redis%E5%9F%BA%E7%A1%80/\n    \n\n[centos7.2安装使用docker](/articles/centos7-2安装及使用docker/) [centos7.2安装使用sentry](/articles/centos7-2安装使用sentry/) [centos7.2安装使用rabbitMQ](/articles/centos7-2使用rabbitmq/) [centos7.2安装使用postgresql](/articles/postgresql常见命令/)\n\n#### centos7.2安装supervisor\n安装\n```shell\n$ sudo yum install -y supervisor\n$ systemctl enable supervisord # 开机自启动\n$ systemctl start supervisord # 启动supervisord服务\n$ systemctl status supervisord # 查看supervisord服务状态\n$ ps -ef|grep supervisord # 查看是否存在supervisord进程\n```\n配置\n```shell\n# 设置web访问\n[inet_http_server]\nport=*:9001                                                  \nusername=username\npassword=password \n[include]                                                                                   │(.env-api) ➜  supervisord.d sudo vim doneself-api.ini                 \nfiles = supervisord.d/*.ini   # 配置文件地址\n```\n```shell\n$ vim xxx.ini\n[program:doneself-api-uwsgi]\ncommand = /home/doneself/code/web/.env-api/bin/uwsgi --ini /home/doneself/code/web/api/uwsgi.ini\nautostart = true\nautorestart = true\nstopsignal= QUIT\nuser= doneself\nredirect_stderr=false\nstdout_logfile = /home/doneself/code/web/api/log/uwsgi_stdout.log\nstderr_logfile = /home/doneself/code/web/api/log/uwsgi_stderr.log\n```\n[其他信息](http://supervisord.org/)","slug":"centos7服务器基础配置","published":1,"updated":"2019-08-02T11:08:10.459Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5qa00539ka401o66dzi","content":"<h3 id=\"查看当前版本\"><a href=\"#查看当前版本\" class=\"headerlink\" title=\"查看当前版本\"></a>查看当前版本</h3><pre><code>cat /proc/version \ncat /etc/redhat-release\nCentos Linux release 7.2.1511 (Core)</code></pre><h3 id=\"修改root密码\"><a href=\"#修改root密码\" class=\"headerlink\" title=\"修改root密码\"></a>修改root密码</h3><pre><code>&gt; passwd root\n&gt; 输入密码</code></pre><h3 id=\"配置网络\"><a href=\"#配置网络\" class=\"headerlink\" title=\"配置网络\"></a>配置网络</h3><p>centos网络配置地址 /etc/sysconfig/network Centos设置主机名和网络配置<br>/etc/sysconfig/network-scripts/ifcfg-eth0针对特定的网卡进行设置<br>/etc/resolv.conf设置DNS<br>/etc/hosts设置指定的域名解析地址<br>当前使用的是虚拟机网桥模式</p>\n<pre><code>cd /etc/sysconfig/network-scripts/\nvi ifcfg-enp0s23\n# 最后添加内容\nIPADDR=192.168.0.160  # ip地址\nNETMASK=255.255.255.0 # 掩码\nGATEWAY=192.168.0.1 # 网关地址\nDNS1=202.103.24.68 # DNS地址\n# 修改内容\nONBOOT=yes # 启动时网络接口有效\nBOOTPROTO=none # dhcp改成none dhcp自动获取，static固定，none手动\n\n\n# 启动网卡\nsudo ifup eth0s23\nsudo systemctl restart network</code></pre><p>安装网络查看工具</p>\n<pre><code>yum install net-tools</code></pre><p>centos默认的命令是</p>\n<pre><code>ip addr</code></pre><h3 id=\"开机需要启动的5个服务\"><a href=\"#开机需要启动的5个服务\" class=\"headerlink\" title=\"开机需要启动的5个服务\"></a>开机需要启动的5个服务</h3><pre><code>sshd远程登陆, \nnetwork网络,\nrsyslog日志相关,\ncrond定时任务,\nsysstat检测系统性能</code></pre><h3 id=\"创建用户\"><a href=\"#创建用户\" class=\"headerlink\" title=\"创建用户\"></a>创建用户</h3><pre><code>su\n# 输入密码\nuseradd test\npasswd test\n# 输入密码\n# 确认密码\nsu test # 切换成普通用户</code></pre><p>将test用户加入到sudoers用</p>\n<pre><code>#visudo命令 # 相当于直接编辑 /etc/sudoers,但用命令方式更安全,推荐\nsu\ncd /etc\nchmod 777 sudoers\nroot    ALL=(ALL)       ALL\ntest    ALL=(ALL)       ALL  # 新添加的\nchmod 440 sudoers   # 权限改成440，必须，否则会报错</code></pre><h3 id=\"配置ssh\"><a href=\"#配置ssh\" class=\"headerlink\" title=\"配置ssh\"></a>配置ssh</h3><p>安装ssh</p>\n<pre><code>yum -y install  openssh*\n\n\nservice sshd start    </code></pre><h3 id=\"ssh连接\"><a href=\"#ssh连接\" class=\"headerlink\" title=\"ssh连接\"></a>ssh连接</h3><pre><code>ssh test@192.168.0.160 # 默认22端口\nssh -p 2222 test@192.168.0.160 # 修改端口后</code></pre><p>禁止root用户远程ssh连接</p>\n<pre><code>vi /etc/ssh/sshd_congif \n# 最后添加\n# 禁止root远程登陆  \nPermitRootLogin no</code></pre><h3 id=\"关闭SELINUX\"><a href=\"#关闭SELINUX\" class=\"headerlink\" title=\"关闭SELINUX\"></a>关闭SELINUX</h3><p>修改/etc/selinux/config 文件<br>将SELINUX=enforcing改为SELINUX=disabled<br>setenforce 0 ##设置SELinux 成为permissive模式,临时关闭或者及时起效</p>\n<h3 id=\"centos开启防火墙\"><a href=\"#centos开启防火墙\" class=\"headerlink\" title=\"centos开启防火墙\"></a>centos开启防火墙</h3><pre><code>systemctl mask firewalld\nsystemctl stop firewalld\nyum install iptables-services # 如果下面命令报错，则需要安装\nsystemctl enable iptables\nsystemctl start iptables\nsystemctl enable ip6tables\nsystemctl start ip6tables</code></pre><p>防火墙开机启动</p>\n<pre><code>systemctl enable iptables\nsystemctl disable iptables\n\n\n# 查看开机运行的服务\nsystemctl list-unit-files --type=service</code></pre><p>防火墙是否放行ssh端口22</p>\n<pre><code>cd /etc/sysconfig/\nvi iptables</code></pre><p>在commit前添加以下内容，并注释文件开头信息</p>\n<pre><code># sample configuration for iptables service\n# you can edit this manually or use system-config-firewall\n# please do not ask us to add additional ports/services to this default configuration\n*filter\n# :INPUT ACCEPT [0:0]\n# :FORWARD ACCEPT [0:0]\n# :OUTPUT ACCEPT [0:0]\n# -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n# -A INPUT -p icmp -j ACCEPT\n# -A INPUT -i lo -j ACCEPT\n# -A INPUT -j REJECT --reject-with icmp-host-prohibited\n# -A FORWARD -j REJECT --reject-with icmp-host-prohibited\n\n\n\n\n\n# 安全设置-防止扫描包\n# NONE 包(所有标识bit都没有设置)主要是扫描类的数据包\n-A INPUT -p tcp --tcp-flags ALL NONE -j DROP\n# 防止sync-flood 攻击\n-A INPUT -p tcp ! --syn -m state --state NEW -j DROP\n# ALL包（所有的标注bit都被设置了）也是网络扫描的数据包\n-A INPUT -p tcp --tcp-flags ALL ALL -j DROP\n\n# 开放对应端口\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT\n\n# 缺省设置\n:INPUT DROP [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n# 许所有从服务器端发起的连接，由此返回的响应数据应该是允许的,yum操作等\n-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n-A INPUT -p icmp -j ACCEPT\n# 接受主机localhost的任意请求\n-A INPUT -i lo -j ACCEPT\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n-A FORWARD -j REJECT --reject-with icmp-host-prohibited\n\nCOMMIT</code></pre><h3 id=\"ftp\"><a href=\"#ftp\" class=\"headerlink\" title=\"ftp\"></a>ftp</h3><p>安装及启动</p>\n<pre><code>yum install vsftpd\nsystemctl start vsftpd\nsystemctl enable vsftpd</code></pre><p>更新防火墙，放行20， 21端口，如果用了代理上传，需要添加被动模式的端口号<br>修改配置项目</p>\n<pre><code>vi /etc/vsftpd/vsftpd.conf\n\nanonymous_enable=No # YES改成No,禁止匿名用户\nlisten=YES # No改成Yes 开启监听\n# listen_ipv6=YES  # 此行需要注释掉\ntcp_wrappers=YES   # 默认应该就是YES\n\n# 在/etc/vsftpd.chroot_list文件中列出的用户，可以切换到其他目录；\n# 未在/etc/vsftpd/chroot_list文件中列出的用户，不能切换到其他目录。\n# 需要创建/etc/vsftpd/chroot_list文件\nchroot_local_user=YES\nchroot_list_enable=YES  \n# (default follows) \nchroot_list_file=/etc/vsftpd/chroot_list\n\n# 防止500oops错误 \nallow_writeable_chroot=YES \n# 被动模式端口号\npasv_min_port=30000  \npasv_max_port=31000    </code></pre><p>只允许指定ip登陆</p>\n<pre><code>vi /etc/hosts.allow\n最后添加\nvsftpd:192.168.0.19:allow\nvsftpd:all:deny</code></pre><p>添加虚拟用户</p>\n<pre><code>useradd -g ftp -d /var/ftp/ftpuser -s /sbin/nologin ftpuser \npasswd ftpuser\ncd /etc/vsftpd/\ntouch chroot_list\nvi chroot_list\nftpuser # 将用户名称添加到chroot_list里</code></pre><h3 id=\"LAMP安装\"><a href=\"#LAMP安装\" class=\"headerlink\" title=\"LAMP安装\"></a>LAMP安装</h3><p>apache</p>\n<pre><code>yum install httpd # 安装apache2\nsystemctl enable httpd.service\nsystemctl enable httpd.service</code></pre><p>mysql5.6</p>\n<pre><code># 安装rpm包\nrpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm\n# 查看可以安装的资源\nyum repolist enabled | grep &quot;mysql.*-community.*&quot;\n# 安装\nyum install mysql-community-server\nsystemctl start mysqld\nsystemctl enable mysqld\nmysql_secure_installation # 设置密码等</code></pre><p>php5.4</p>\n<pre><code>yum install php\nyum install php-gd php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-snmp php-soap curl curl-devel php-mysql php-devel</code></pre><p>php5.6或者其他</p>\n<pre><code>yum -y install epel-release\nwget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\nwget https://centos7.iuscommunity.org/ius-release.rpm\nrpm -Uvh ius-release*.rpm\nyum -y update\nyum -y install php56u php56u-opcache php56u-xml php56u-mcrypt php56u-gd php56u-devel php56u-mysql php56u-intl php56u-mbstring php56u-bcmath</code></pre><h3 id=\"LAMP配置\"><a href=\"#LAMP配置\" class=\"headerlink\" title=\"LAMP配置\"></a>LAMP配置</h3><p>apache允许php脚本</p>\n<pre><code>vi /etc/httpd/conf/httpd.conf\nAddType application/x-compress .Z\nAddType application/x-gzip .gz .tgz\nAddType application/x-httpd-php .php  # 新添加内容</code></pre><p>apache虚拟主机</p>\n<pre><code>cd /etc/httpd/conf.d\nvi vhost.conf\n\n\n&lt;VirtualHost *:121&gt;\nServerName phpmyadmin.com\nServerAlias www.phpmyadmin.com\nDocumentRoot /var/www/html/phpMyAdmin/\nErrorLog /var/www/web_log/phpMyAdmin.www_error.log # 开启日志需要创建web_log文件夹，否则会报错\nCustomLog /var/www/web_log/phpMyAdmin.www_access.log common\n&lt;/VirtualHost&gt;\n&lt;Directory &quot;/var/www/html/phpMyAdmin/&quot;&gt;\n    Options FollowSymLinks\n    AllowOverride All\n    Require all granted\n&lt;/Directory&gt;\n\n\n&lt;VirtualHost *:108&gt;\nServerName hkmain.com\nServerAlias www.kmain.com\nDocumentRoot /var/www/html/NEW/\nErrorLog /var/www/web_log/NEW.www_error.log\nCustomLog /var/www/web_log/NEW.www_access.log common\n&lt;/VirtualHost&gt;\n&lt;Directory &quot;/var/www/html/NEW/&quot;&gt;\n    Options FollowSymLinks\n    AllowOverride All\n    Require all granted\n&lt;/Directory&gt;</code></pre><p>apache加载的模块查看</p>\n<pre><code>apachectl -M | sort</code></pre><p>网站目录权限配置</p>\n<pre><code>chown -R apache:apache WEB_FOLD\nchmod 750 WEB_FOLD\ncd WEB_FOLD\nfind -type d -exec chmod 750 {} \\;\nfind -not -type d -exec chmod 640 {} \\;\nfind . -name &quot;Runtime&quot; -type d -exec chmod -R 770 {} \\;</code></pre><h3 id=\"LNMP安装与配置\"><a href=\"#LNMP安装与配置\" class=\"headerlink\" title=\"LNMP安装与配置\"></a>LNMP安装与配置</h3><p>参考链接 <a href=\"https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mysql-php-lemp-stack-on-centos-7\" target=\"_blank\" rel=\"noopener\">https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mysql-php-lemp-stack-on-centos-7</a> nginx安装(apache二选一)</p>\n<pre><code># 安装pcre库，使nginx支持rewrite\nsudo yum install pcre pcre-devel -y\nsudo yum install nginx\nsudo systemctl start nginx.service\n# 设置开机启动\nsudo systemctl enable nginx.service</code></pre><p>mysql5.6</p>\n<pre><code># 安装rpm包\nrpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm\n# 查看可以安装的资源\nyum repolist enabled | grep &quot;mysql.*-community.*&quot;\n# 安装\nyum install mysql-community-server\nsystemctl start mysqld\nsystemctl enable mysqld\nmysql_secure_installation # 设置密码等</code></pre><p>php安装</p>\n<pre><code>yum -y install epel-release\nsudo yum install php php-mysql php-fpm\nsudo yum install php-pecl-memcache</code></pre><p>配置</p>\n<pre><code>vim /etc/php.ini\n#cgi.fix_poathinfo=1改成\ncgi.fix_pathinfo=0\n\n\nvim /etc/php-php.d/www.conf\n# 第一处修改\nlisten = /var/run/php-fpm/php-fpm.sock\n# 第二处修改\nlisten.owner = nobody\nlisten.group = nobody\n# 第三处修改\nuser = nginx\ngroup = nginx\n\n\n# 重启\nsudo systemctl start php-fpm\nsudo systemctl enable php-fpm\n\n\n# 安装xcahe\nsudo yum -y install php-xcache xcache-admin\n# 如果失败请用下面的方法\n# xcahe\nwget https://kojipkgs.fedoraproject.org//packages/php-xcache/3.1.1/1.el7/x86_64/php-xcache-3.1.1-1.el7.x86_64.rpm\n# 图形化管理\nwget https://kojipkgs.fedoraproject.org//packages/php-xcache/3.1.1/1.el7/noarch/xcache-admin-3.1.1-1.el7.noarch.rpm</code></pre><p>#配置nginx sudo vi /etc/nginx/conf.d/default.conf server { listen 80; server_name server_domain_name_or_IP; # 注意位置，在括号外 root /usr/share/nginx/html; index index.php index.html index.htm;</p>\n<pre><code>location / {\n    try_files $uri $uri/ =404;\n}\nerror_page 404 /404.html;\nerror_page 500 502 503 504 /50x.html;\nlocation = /50x.html {\n    root /usr/share/nginx/html;\n}\n    # 下面是配置fpm\nlocation ~ \\.php$ {\n    try_files $uri =404;\n    fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock; (这个值从php-fpm复制来)\n    fastcgi_index index.php;\n    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n    include fastcgi_params;\n}</code></pre><p>}</p>\n<pre><code># 测试\nsudo vi /usr/share/nginx/html/info.php\n&lt;?php echo phpinfo();&gt;\nsudo systemctl restart php-fpm\nsudo systemctl restart nginx</code></pre><h3 id=\"安装imagemagick\"><a href=\"#安装imagemagick\" class=\"headerlink\" title=\"安装imagemagick\"></a>安装imagemagick</h3><pre><code>yum install php-pear gcc\nyum install ImageMagick ImageMagick-devel ImageMagick-perl\npecl install imagick # 直接回车\necho extension=imagick.so &gt;&gt; /etc/php.ini # 添加php扩展\nsystemctl restart httpd</code></pre><h3 id=\"mysql主从复制主服务器配置\"><a href=\"#mysql主从复制主服务器配置\" class=\"headerlink\" title=\"mysql主从复制主服务器配置\"></a>mysql主从复制主服务器配置</h3><pre><code>vi /etc/my.cnf\n[mysqld] \nserver-id=1     # 配一个唯一的ID编号，1至32  \nlog-bin=mysql-bin  # 二进制文件存放路径  \nbinlog-do-db=test1  # 需要同步的数据库名  \nbinlog-ignore-db=test2  # 不需要同步的数据库名 </code></pre><p>其他参考mysql主从复制</p>\n<h3 id=\"rsycn数据同步\"><a href=\"#rsycn数据同步\" class=\"headerlink\" title=\"rsycn数据同步\"></a>rsycn数据同步</h3><pre><code>yum install rsync # 安装，默认端口873  \nsystemctl start rsyncd\nsystemctl enable rsyncd\n\n\n\nvim rsync.conf# 日志文件位置，启动rsync后自动产生这个文件，无需提前创建\nlog file = /var/log/rsyncd.log\n# pid文件的存放位置\npidfile = /var/run/rsyncd.pid\n# 支持max connections参数的锁文件\nlock file = /var/run/rsync.lock\n# 用户认证配置文件，里面保存用户名称和密码，后面会创建这个文件\nsecrets file = /etc/rsync.pass\n# rsync启动时欢迎信息页面文件位置（文件内容自定义\n# motd file = /etc/rsyncd.Motd\n#\n\n# 设置rsync运行权限为root\n# uid = root\n# 设置rsync运行权限为root\n# gid = root\n# 匿名用户\nuid = 0\ngid = 0\n# 默认端口\nport = 873\n# 默认为true，修改为no，增加对目录文件软连接的备份\nuse chroot = no\n# 设置rsync服务端文件为读写权限\nread only = yes\n# 不显示rsync服务端资源列表\nlist = no\n# 最大连接数\nmax connections = 200\n# 设置超时时间\ntimeout = 600\n# 不验证用户密码\nstrict modes = false\n# 执行数据同步的用户名，可以设置多个，用英文状态下逗号隔开\n# auth users = test\n# 允许进行数据同步的客户端IP地址，可以设置多个，用英文状态下逗号隔开\nhosts allow = 192.168.0.206, 192.168.0.118\n# 禁止数据同步的客户端IP地址，可以设置多个，用英文状态下逗号隔开\n# hosts deny = 192.168.21.254\n\n# 自定义名称\n[web]\n# rsync服务端数据目录路径\npath = /var/www/html/HKMAIN_NEW/Upload/product/manual/cn/\n#\n# 模块名称与自定义名称相同\ncomment = web\n\n[webe]\npath = /var/www/html/HKMAIN_NEW/Upload/product/manual/en/\ncomment = webe</code></pre><h3 id=\"centos7-2安装nfs服务器端\"><a href=\"#centos7-2安装nfs服务器端\" class=\"headerlink\" title=\"centos7.2安装nfs服务器端\"></a>centos7.2安装nfs服务器端</h3><pre><code># 服务器端安装及配置\n# 安装命令\nsudo yum install nfs-utils rpcbind\n# 查看是否安装成功\n$ rpm -aq nfs-utils rpcbind\nrpcbind-0.2.0-38.el7.x86_64\nnfs-utils-1.3.0-0.33.el7_3.x86_64\n# 启动rpcbind\nsudo systemctl restart rpcbind\n# 查看状态\nsystemctl status rpcbind\n# 开机启动\nsudo systemctl enable rpcbind\n# 查看是否开机启动\nsystemctl is-enabled rpcbind # enable表示开机启动，disable表示不开机启动\n# 启动及开机启动nfs服务\nsudo systemctl restart nfs\nsudo systemctl enable nfs\n#配置nfs服务\nvim /etc/exports\n/readonly 192.168.0.160(insecure,ro,no_root_squash) # 指定ip地址，只读\n/rwsync 192.168.0.0/24(insecure,rw,sync,no_root_squash) # 指定ip地址段，读写\n# 加载配置文件\nsudo exportfs -rv\n# 查看nfs服务器本地挂载情况\n$ showmount -e localhost\nExport list for localhost:\n/rwsync   192.168.0.0/24\n/readonly 192.168.0.160\n# 重启服务\nsudo systemctl restart nfs\n\n\n# 客户端安装配置\nsudo yum install nfs-utils rpcbind\n# 只需启动rpc服务\nsudo systemctl restart rpcbind\nsudo systemctl enable rpcbind\n# 查看可以挂载服务器端的目录\nshowmount -e 192.168.0.206\nExport list for 192.168.0.206:\n/rwsync   192.168.0.0/24\n/readonly 192.168.0.160\n# 挂载\nsudo mount -t nfs 192.168.0.206:/readonly /mnt/readonly\nsudo mount -t nfs 192.168.0.206:/rwsync /mnt/rwsync\n# 查看挂载结果\ndf -h</code></pre><h3 id=\"centos7-2安装python3-5\"><a href=\"#centos7-2安装python3-5\" class=\"headerlink\" title=\"centos7.2安装python3.5\"></a>centos7.2安装python3.5</h3><pre><code># 安装编译环境\nyum install openssl-devel bzip2-devel expat-devel gdbm-devel readline-devel sqlite-devel\n# 下载文件\nwget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tgz\n# 解压\ntar -zxvf Python-3.6.6.tgz\n# 编译安装\ncd Python-3.5.1\n./configure --prefix=/usr/local/python3\nmake &amp;&amp; make install\n# 创建软连接\nsudo ln -s /usr/local/python3/bin/python3 /usr/bin/python3\npython3 --version\nsudo ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3 \npip3 --version\n\n# 添加pip源\nvim ~/.pip/pip.conf\n[global]\ntrusted-host =  mirrors.aliyun.com\nindex-url = https://mirrors.aliyun.com/pypi/simple\n\n### 安装虚拟环境\nsudo pip3 uninstall virtualenv\nsudo ln -s /usr/local/python3/bin/virtualenv /usr/bin/virtualenv \n\n### 创建虚拟环境\nvirtualenv --no-site-packages -p python3 .env\nsource ./.env/bin/activate</code></pre><h3 id=\"centos7-2安装node8\"><a href=\"#centos7-2安装node8\" class=\"headerlink\" title=\"centos7.2安装node8\"></a>centos7.2安装node8</h3><pre><code># 参考文件 https://nodejs.org/en/download/package-manager/\nOn RHEL, CentOS or Fedora, for Node.js v8 LTS:\n\ncurl --silent --location https://rpm.nodesource.com/setup_8.x | sudo bash -\nAlternatively for Node.js 10:\n\ncurl --silent --location https://rpm.nodesource.com/setup_10.x | sudo bash -\nThen install:\nsudo yum -y install nodejs\n\n\n# 安装cnpm\nnpm install -g cnpm --registry=https://registry.npm.taobao.org</code></pre><h3 id=\"centos6-8安装nginx\"><a href=\"#centos6-8安装nginx\" class=\"headerlink\" title=\"centos6.8安装nginx\"></a>centos6.8安装nginx</h3><pre><code># 安装pcre库，使nginx支持rewrite\nyum install pcre pcre-devel -y\n# 安装openssl，https服务需要使用\nyum install openssl openssl-devel -y\n# 安装 gzip 类库\nyum -y install zlib zlib-devel\n# 安装编译程序\nyum -y install make gcc gcc-c++ ncurses-devel\n# 创建用户\nuseradd nginx -s /sbin/nologin -M\n# 下载源码\nwget -q https://nginx.org/download/nginx-1.6.3.tar.gz \ntar -zxvf nginx-1.6.3.tar.gz\ncd nginx-1.6.3\n./configure --user=nginx --group=nginx --prefix=/usr/local/nginx --with-http_ssl_module --with-http_stub_status_module --with-pcre\nmake\nmake install\n\n\n# 启动nginx\n/usr/local/nginx/sbin/nginx\n# 停止nginx\n/usr/local/nginx/sbin/nginx -s quit\n# 重新加载配置文件\n/usr/local/nginx/sbin/nginx -s reload        \n# 测试你的配置文件是否有误\n/usr/local/nginx/sbin/nginx -t       \n# 查看nginx对应的端口\n lsof -i :80</code></pre><h3 id=\"centos6-8安装mysql5-7\"><a href=\"#centos6-8安装mysql5-7\" class=\"headerlink\" title=\"centos6.8安装mysql5.7\"></a>centos6.8安装mysql5.7</h3><pre><code># yum源直接安装的是mysql5.1版本，抛弃\n# 先检查是否有旧版本\nrpm -qa | grep mysql\n# 删除旧版本\nsudo yum -y remove mysql-xx-xx\nwget https://dev.mysql.com/get/mysql57-community-release-el6-10.noarch.rpm\nsudo yum install mysql57-community-release-el6-10.noarch.rpm\nsudo yum install mysql-community-server</code></pre><h3 id=\"centos7-2-源码安装nginx\"><a href=\"#centos7-2-源码安装nginx\" class=\"headerlink\" title=\"centos7.2 源码安装nginx\"></a>centos7.2 源码安装nginx</h3><pre><code># 安装pcre库，使nginx支持rewrite\nyum install pcre pcre-devel -y\n# 安装openssl，https服务需要使用\nyum install openssl openssl-devel -y\n# 安装 gzip 类库\nyum -y install zlib zlib-devel\n# 安装编译程序\nyum -y install make gcc gcc-c++ ncurses-devel\n# 创建用户\nuseradd nginx -s /sbin/nologin -M\n# 下载源码\nwget -q https://nginx.org/download/nginx-1.12.1.tar.gz \ntar -zxvf nginx-1.12.1.tar.gz\ncd nginx-1.12.1\n./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_gunzip_module --with-http_gzip_static_module --with-threads --with-file-aio --with-ipv6 --with-http_v2_module --with-cc-opt=&apos;-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=native&apos;\nmake\nmake install\n\n\n# 创建链接\nsudo ln -s /usr/local/nginx/bin/nginx /usr/bin/nginx\n# 启动nginx\n/usr/local/nginx/sbin/nginx\n# 停止nginx\n/usr/local/nginx/sbin/nginx -s quit\n# 重新加载配置文件\n/usr/local/nginx/sbin/nginx -s reload        \n# 测试你的配置文件是否有误\n/usr/local/nginx/sbin/nginx -t       \n# 查看nginx对应的端口\n lsof -i :80</code></pre><h3 id=\"centos7-2安装php7\"><a href=\"#centos7-2安装php7\" class=\"headerlink\" title=\"centos7.2安装php7\"></a>centos7.2安装php7</h3><pre><code># 加源\nsudo yum install epel-release yum-utils\nsudo yum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm\n# 选择remi\nsudo yum-config-manager --enable remi-php70\nsudo yum-config-manager --enable remi-php71\nsudo yum-config-manager --enable remi-php72\n# 安装相关扩展\nsudo yum-config-manager --enable remi-php70\nsudo yum install php php-common php-opcache php-mcrypt php-cli php-gd php-curl php-mysql\n# 安装 PHP FPM \nsudo yum install php-fpm\nsudo systemctl enable php-fpm\nsudo systemctl start php-fpm\n# 配置\nsudo vim /etc/php-fpm.d/www.conf\nuser = nginx\ngroup = nginx\n\n\n# 配置nginx虚拟server\nserver {\n\n    # . . . other code\n\n    location ~ \\.php$ {\n        try_files $uri =404;\n        # fastcgi_pass unix:/run/php-fpm/www.sock;\n                fastcgi_pass 127.0.0.1:9000;\n        fastcgi_index index.php;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        include fastcgi_params;\n    }\n}</code></pre><h3 id=\"centos7-2安装redis\"><a href=\"#centos7-2安装redis\" class=\"headerlink\" title=\"centos7.2安装redis\"></a>centos7.2安装redis</h3><pre><code>$ sudo yum install redis\n$ sudo systemctl enable redis\n$ sudo systemctl start redis\n# 查看版本号\n$ redis-server --version\n\n\n# 使用方法 http://www.zhuohc.com/articles/redis%E5%9F%BA%E7%A1%80/</code></pre><p><a href=\"/articles/centos7-2安装及使用docker/\">centos7.2安装使用docker</a> <a href=\"/articles/centos7-2安装使用sentry/\">centos7.2安装使用sentry</a> <a href=\"/articles/centos7-2使用rabbitmq/\">centos7.2安装使用rabbitMQ</a> <a href=\"/articles/postgresql常见命令/\">centos7.2安装使用postgresql</a></p>\n<h4 id=\"centos7-2安装supervisor\"><a href=\"#centos7-2安装supervisor\" class=\"headerlink\" title=\"centos7.2安装supervisor\"></a>centos7.2安装supervisor</h4><p>安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo yum install -y supervisor</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> systemctl <span class=\"built_in\">enable</span> supervisord <span class=\"comment\"># 开机自启动</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> systemctl start supervisord <span class=\"comment\"># 启动supervisord服务</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> systemctl status supervisord <span class=\"comment\"># 查看supervisord服务状态</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ps -ef|grep supervisord <span class=\"comment\"># 查看是否存在supervisord进程</span></span></span><br></pre></td></tr></table></figure>\n\n<p>配置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 设置web访问</span></span><br><span class=\"line\">[inet_http_server]</span><br><span class=\"line\">port=*:9001                                                  </span><br><span class=\"line\">username=username</span><br><span class=\"line\">password=password </span><br><span class=\"line\">[include]                                                                                   │(.env-api) ➜  supervisord.d sudo vim doneself-api.ini                 </span><br><span class=\"line\">files = supervisord.d/*.ini   # 配置文件地址</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> vim xxx.ini</span></span><br><span class=\"line\">[program:doneself-api-uwsgi]</span><br><span class=\"line\">command = /home/doneself/code/web/.env-api/bin/uwsgi --ini /home/doneself/code/web/api/uwsgi.ini</span><br><span class=\"line\">autostart = true</span><br><span class=\"line\">autorestart = true</span><br><span class=\"line\">stopsignal= QUIT</span><br><span class=\"line\">user= doneself</span><br><span class=\"line\">redirect_stderr=false</span><br><span class=\"line\">stdout_logfile = /home/doneself/code/web/api/log/uwsgi_stdout.log</span><br><span class=\"line\">stderr_logfile = /home/doneself/code/web/api/log/uwsgi_stderr.log</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"http://supervisord.org/\" target=\"_blank\" rel=\"noopener\">其他信息</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"查看当前版本\"><a href=\"#查看当前版本\" class=\"headerlink\" title=\"查看当前版本\"></a>查看当前版本</h3><pre><code>cat /proc/version \ncat /etc/redhat-release\nCentos Linux release 7.2.1511 (Core)</code></pre><h3 id=\"修改root密码\"><a href=\"#修改root密码\" class=\"headerlink\" title=\"修改root密码\"></a>修改root密码</h3><pre><code>&gt; passwd root\n&gt; 输入密码</code></pre><h3 id=\"配置网络\"><a href=\"#配置网络\" class=\"headerlink\" title=\"配置网络\"></a>配置网络</h3><p>centos网络配置地址 /etc/sysconfig/network Centos设置主机名和网络配置<br>/etc/sysconfig/network-scripts/ifcfg-eth0针对特定的网卡进行设置<br>/etc/resolv.conf设置DNS<br>/etc/hosts设置指定的域名解析地址<br>当前使用的是虚拟机网桥模式</p>\n<pre><code>cd /etc/sysconfig/network-scripts/\nvi ifcfg-enp0s23\n# 最后添加内容\nIPADDR=192.168.0.160  # ip地址\nNETMASK=255.255.255.0 # 掩码\nGATEWAY=192.168.0.1 # 网关地址\nDNS1=202.103.24.68 # DNS地址\n# 修改内容\nONBOOT=yes # 启动时网络接口有效\nBOOTPROTO=none # dhcp改成none dhcp自动获取，static固定，none手动\n\n\n# 启动网卡\nsudo ifup eth0s23\nsudo systemctl restart network</code></pre><p>安装网络查看工具</p>\n<pre><code>yum install net-tools</code></pre><p>centos默认的命令是</p>\n<pre><code>ip addr</code></pre><h3 id=\"开机需要启动的5个服务\"><a href=\"#开机需要启动的5个服务\" class=\"headerlink\" title=\"开机需要启动的5个服务\"></a>开机需要启动的5个服务</h3><pre><code>sshd远程登陆, \nnetwork网络,\nrsyslog日志相关,\ncrond定时任务,\nsysstat检测系统性能</code></pre><h3 id=\"创建用户\"><a href=\"#创建用户\" class=\"headerlink\" title=\"创建用户\"></a>创建用户</h3><pre><code>su\n# 输入密码\nuseradd test\npasswd test\n# 输入密码\n# 确认密码\nsu test # 切换成普通用户</code></pre><p>将test用户加入到sudoers用</p>\n<pre><code>#visudo命令 # 相当于直接编辑 /etc/sudoers,但用命令方式更安全,推荐\nsu\ncd /etc\nchmod 777 sudoers\nroot    ALL=(ALL)       ALL\ntest    ALL=(ALL)       ALL  # 新添加的\nchmod 440 sudoers   # 权限改成440，必须，否则会报错</code></pre><h3 id=\"配置ssh\"><a href=\"#配置ssh\" class=\"headerlink\" title=\"配置ssh\"></a>配置ssh</h3><p>安装ssh</p>\n<pre><code>yum -y install  openssh*\n\n\nservice sshd start    </code></pre><h3 id=\"ssh连接\"><a href=\"#ssh连接\" class=\"headerlink\" title=\"ssh连接\"></a>ssh连接</h3><pre><code>ssh test@192.168.0.160 # 默认22端口\nssh -p 2222 test@192.168.0.160 # 修改端口后</code></pre><p>禁止root用户远程ssh连接</p>\n<pre><code>vi /etc/ssh/sshd_congif \n# 最后添加\n# 禁止root远程登陆  \nPermitRootLogin no</code></pre><h3 id=\"关闭SELINUX\"><a href=\"#关闭SELINUX\" class=\"headerlink\" title=\"关闭SELINUX\"></a>关闭SELINUX</h3><p>修改/etc/selinux/config 文件<br>将SELINUX=enforcing改为SELINUX=disabled<br>setenforce 0 ##设置SELinux 成为permissive模式,临时关闭或者及时起效</p>\n<h3 id=\"centos开启防火墙\"><a href=\"#centos开启防火墙\" class=\"headerlink\" title=\"centos开启防火墙\"></a>centos开启防火墙</h3><pre><code>systemctl mask firewalld\nsystemctl stop firewalld\nyum install iptables-services # 如果下面命令报错，则需要安装\nsystemctl enable iptables\nsystemctl start iptables\nsystemctl enable ip6tables\nsystemctl start ip6tables</code></pre><p>防火墙开机启动</p>\n<pre><code>systemctl enable iptables\nsystemctl disable iptables\n\n\n# 查看开机运行的服务\nsystemctl list-unit-files --type=service</code></pre><p>防火墙是否放行ssh端口22</p>\n<pre><code>cd /etc/sysconfig/\nvi iptables</code></pre><p>在commit前添加以下内容，并注释文件开头信息</p>\n<pre><code># sample configuration for iptables service\n# you can edit this manually or use system-config-firewall\n# please do not ask us to add additional ports/services to this default configuration\n*filter\n# :INPUT ACCEPT [0:0]\n# :FORWARD ACCEPT [0:0]\n# :OUTPUT ACCEPT [0:0]\n# -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n# -A INPUT -p icmp -j ACCEPT\n# -A INPUT -i lo -j ACCEPT\n# -A INPUT -j REJECT --reject-with icmp-host-prohibited\n# -A FORWARD -j REJECT --reject-with icmp-host-prohibited\n\n\n\n\n\n# 安全设置-防止扫描包\n# NONE 包(所有标识bit都没有设置)主要是扫描类的数据包\n-A INPUT -p tcp --tcp-flags ALL NONE -j DROP\n# 防止sync-flood 攻击\n-A INPUT -p tcp ! --syn -m state --state NEW -j DROP\n# ALL包（所有的标注bit都被设置了）也是网络扫描的数据包\n-A INPUT -p tcp --tcp-flags ALL ALL -j DROP\n\n# 开放对应端口\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT\n\n# 缺省设置\n:INPUT DROP [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n# 许所有从服务器端发起的连接，由此返回的响应数据应该是允许的,yum操作等\n-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n-A INPUT -p icmp -j ACCEPT\n# 接受主机localhost的任意请求\n-A INPUT -i lo -j ACCEPT\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n-A FORWARD -j REJECT --reject-with icmp-host-prohibited\n\nCOMMIT</code></pre><h3 id=\"ftp\"><a href=\"#ftp\" class=\"headerlink\" title=\"ftp\"></a>ftp</h3><p>安装及启动</p>\n<pre><code>yum install vsftpd\nsystemctl start vsftpd\nsystemctl enable vsftpd</code></pre><p>更新防火墙，放行20， 21端口，如果用了代理上传，需要添加被动模式的端口号<br>修改配置项目</p>\n<pre><code>vi /etc/vsftpd/vsftpd.conf\n\nanonymous_enable=No # YES改成No,禁止匿名用户\nlisten=YES # No改成Yes 开启监听\n# listen_ipv6=YES  # 此行需要注释掉\ntcp_wrappers=YES   # 默认应该就是YES\n\n# 在/etc/vsftpd.chroot_list文件中列出的用户，可以切换到其他目录；\n# 未在/etc/vsftpd/chroot_list文件中列出的用户，不能切换到其他目录。\n# 需要创建/etc/vsftpd/chroot_list文件\nchroot_local_user=YES\nchroot_list_enable=YES  \n# (default follows) \nchroot_list_file=/etc/vsftpd/chroot_list\n\n# 防止500oops错误 \nallow_writeable_chroot=YES \n# 被动模式端口号\npasv_min_port=30000  \npasv_max_port=31000    </code></pre><p>只允许指定ip登陆</p>\n<pre><code>vi /etc/hosts.allow\n最后添加\nvsftpd:192.168.0.19:allow\nvsftpd:all:deny</code></pre><p>添加虚拟用户</p>\n<pre><code>useradd -g ftp -d /var/ftp/ftpuser -s /sbin/nologin ftpuser \npasswd ftpuser\ncd /etc/vsftpd/\ntouch chroot_list\nvi chroot_list\nftpuser # 将用户名称添加到chroot_list里</code></pre><h3 id=\"LAMP安装\"><a href=\"#LAMP安装\" class=\"headerlink\" title=\"LAMP安装\"></a>LAMP安装</h3><p>apache</p>\n<pre><code>yum install httpd # 安装apache2\nsystemctl enable httpd.service\nsystemctl enable httpd.service</code></pre><p>mysql5.6</p>\n<pre><code># 安装rpm包\nrpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm\n# 查看可以安装的资源\nyum repolist enabled | grep &quot;mysql.*-community.*&quot;\n# 安装\nyum install mysql-community-server\nsystemctl start mysqld\nsystemctl enable mysqld\nmysql_secure_installation # 设置密码等</code></pre><p>php5.4</p>\n<pre><code>yum install php\nyum install php-gd php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-snmp php-soap curl curl-devel php-mysql php-devel</code></pre><p>php5.6或者其他</p>\n<pre><code>yum -y install epel-release\nwget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\nwget https://centos7.iuscommunity.org/ius-release.rpm\nrpm -Uvh ius-release*.rpm\nyum -y update\nyum -y install php56u php56u-opcache php56u-xml php56u-mcrypt php56u-gd php56u-devel php56u-mysql php56u-intl php56u-mbstring php56u-bcmath</code></pre><h3 id=\"LAMP配置\"><a href=\"#LAMP配置\" class=\"headerlink\" title=\"LAMP配置\"></a>LAMP配置</h3><p>apache允许php脚本</p>\n<pre><code>vi /etc/httpd/conf/httpd.conf\nAddType application/x-compress .Z\nAddType application/x-gzip .gz .tgz\nAddType application/x-httpd-php .php  # 新添加内容</code></pre><p>apache虚拟主机</p>\n<pre><code>cd /etc/httpd/conf.d\nvi vhost.conf\n\n\n&lt;VirtualHost *:121&gt;\nServerName phpmyadmin.com\nServerAlias www.phpmyadmin.com\nDocumentRoot /var/www/html/phpMyAdmin/\nErrorLog /var/www/web_log/phpMyAdmin.www_error.log # 开启日志需要创建web_log文件夹，否则会报错\nCustomLog /var/www/web_log/phpMyAdmin.www_access.log common\n&lt;/VirtualHost&gt;\n&lt;Directory &quot;/var/www/html/phpMyAdmin/&quot;&gt;\n    Options FollowSymLinks\n    AllowOverride All\n    Require all granted\n&lt;/Directory&gt;\n\n\n&lt;VirtualHost *:108&gt;\nServerName hkmain.com\nServerAlias www.kmain.com\nDocumentRoot /var/www/html/NEW/\nErrorLog /var/www/web_log/NEW.www_error.log\nCustomLog /var/www/web_log/NEW.www_access.log common\n&lt;/VirtualHost&gt;\n&lt;Directory &quot;/var/www/html/NEW/&quot;&gt;\n    Options FollowSymLinks\n    AllowOverride All\n    Require all granted\n&lt;/Directory&gt;</code></pre><p>apache加载的模块查看</p>\n<pre><code>apachectl -M | sort</code></pre><p>网站目录权限配置</p>\n<pre><code>chown -R apache:apache WEB_FOLD\nchmod 750 WEB_FOLD\ncd WEB_FOLD\nfind -type d -exec chmod 750 {} \\;\nfind -not -type d -exec chmod 640 {} \\;\nfind . -name &quot;Runtime&quot; -type d -exec chmod -R 770 {} \\;</code></pre><h3 id=\"LNMP安装与配置\"><a href=\"#LNMP安装与配置\" class=\"headerlink\" title=\"LNMP安装与配置\"></a>LNMP安装与配置</h3><p>参考链接 <a href=\"https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mysql-php-lemp-stack-on-centos-7\" target=\"_blank\" rel=\"noopener\">https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mysql-php-lemp-stack-on-centos-7</a> nginx安装(apache二选一)</p>\n<pre><code># 安装pcre库，使nginx支持rewrite\nsudo yum install pcre pcre-devel -y\nsudo yum install nginx\nsudo systemctl start nginx.service\n# 设置开机启动\nsudo systemctl enable nginx.service</code></pre><p>mysql5.6</p>\n<pre><code># 安装rpm包\nrpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm\n# 查看可以安装的资源\nyum repolist enabled | grep &quot;mysql.*-community.*&quot;\n# 安装\nyum install mysql-community-server\nsystemctl start mysqld\nsystemctl enable mysqld\nmysql_secure_installation # 设置密码等</code></pre><p>php安装</p>\n<pre><code>yum -y install epel-release\nsudo yum install php php-mysql php-fpm\nsudo yum install php-pecl-memcache</code></pre><p>配置</p>\n<pre><code>vim /etc/php.ini\n#cgi.fix_poathinfo=1改成\ncgi.fix_pathinfo=0\n\n\nvim /etc/php-php.d/www.conf\n# 第一处修改\nlisten = /var/run/php-fpm/php-fpm.sock\n# 第二处修改\nlisten.owner = nobody\nlisten.group = nobody\n# 第三处修改\nuser = nginx\ngroup = nginx\n\n\n# 重启\nsudo systemctl start php-fpm\nsudo systemctl enable php-fpm\n\n\n# 安装xcahe\nsudo yum -y install php-xcache xcache-admin\n# 如果失败请用下面的方法\n# xcahe\nwget https://kojipkgs.fedoraproject.org//packages/php-xcache/3.1.1/1.el7/x86_64/php-xcache-3.1.1-1.el7.x86_64.rpm\n# 图形化管理\nwget https://kojipkgs.fedoraproject.org//packages/php-xcache/3.1.1/1.el7/noarch/xcache-admin-3.1.1-1.el7.noarch.rpm</code></pre><p>#配置nginx sudo vi /etc/nginx/conf.d/default.conf server { listen 80; server_name server_domain_name_or_IP; # 注意位置，在括号外 root /usr/share/nginx/html; index index.php index.html index.htm;</p>\n<pre><code>location / {\n    try_files $uri $uri/ =404;\n}\nerror_page 404 /404.html;\nerror_page 500 502 503 504 /50x.html;\nlocation = /50x.html {\n    root /usr/share/nginx/html;\n}\n    # 下面是配置fpm\nlocation ~ \\.php$ {\n    try_files $uri =404;\n    fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock; (这个值从php-fpm复制来)\n    fastcgi_index index.php;\n    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n    include fastcgi_params;\n}</code></pre><p>}</p>\n<pre><code># 测试\nsudo vi /usr/share/nginx/html/info.php\n&lt;?php echo phpinfo();&gt;\nsudo systemctl restart php-fpm\nsudo systemctl restart nginx</code></pre><h3 id=\"安装imagemagick\"><a href=\"#安装imagemagick\" class=\"headerlink\" title=\"安装imagemagick\"></a>安装imagemagick</h3><pre><code>yum install php-pear gcc\nyum install ImageMagick ImageMagick-devel ImageMagick-perl\npecl install imagick # 直接回车\necho extension=imagick.so &gt;&gt; /etc/php.ini # 添加php扩展\nsystemctl restart httpd</code></pre><h3 id=\"mysql主从复制主服务器配置\"><a href=\"#mysql主从复制主服务器配置\" class=\"headerlink\" title=\"mysql主从复制主服务器配置\"></a>mysql主从复制主服务器配置</h3><pre><code>vi /etc/my.cnf\n[mysqld] \nserver-id=1     # 配一个唯一的ID编号，1至32  \nlog-bin=mysql-bin  # 二进制文件存放路径  \nbinlog-do-db=test1  # 需要同步的数据库名  \nbinlog-ignore-db=test2  # 不需要同步的数据库名 </code></pre><p>其他参考mysql主从复制</p>\n<h3 id=\"rsycn数据同步\"><a href=\"#rsycn数据同步\" class=\"headerlink\" title=\"rsycn数据同步\"></a>rsycn数据同步</h3><pre><code>yum install rsync # 安装，默认端口873  \nsystemctl start rsyncd\nsystemctl enable rsyncd\n\n\n\nvim rsync.conf# 日志文件位置，启动rsync后自动产生这个文件，无需提前创建\nlog file = /var/log/rsyncd.log\n# pid文件的存放位置\npidfile = /var/run/rsyncd.pid\n# 支持max connections参数的锁文件\nlock file = /var/run/rsync.lock\n# 用户认证配置文件，里面保存用户名称和密码，后面会创建这个文件\nsecrets file = /etc/rsync.pass\n# rsync启动时欢迎信息页面文件位置（文件内容自定义\n# motd file = /etc/rsyncd.Motd\n#\n\n# 设置rsync运行权限为root\n# uid = root\n# 设置rsync运行权限为root\n# gid = root\n# 匿名用户\nuid = 0\ngid = 0\n# 默认端口\nport = 873\n# 默认为true，修改为no，增加对目录文件软连接的备份\nuse chroot = no\n# 设置rsync服务端文件为读写权限\nread only = yes\n# 不显示rsync服务端资源列表\nlist = no\n# 最大连接数\nmax connections = 200\n# 设置超时时间\ntimeout = 600\n# 不验证用户密码\nstrict modes = false\n# 执行数据同步的用户名，可以设置多个，用英文状态下逗号隔开\n# auth users = test\n# 允许进行数据同步的客户端IP地址，可以设置多个，用英文状态下逗号隔开\nhosts allow = 192.168.0.206, 192.168.0.118\n# 禁止数据同步的客户端IP地址，可以设置多个，用英文状态下逗号隔开\n# hosts deny = 192.168.21.254\n\n# 自定义名称\n[web]\n# rsync服务端数据目录路径\npath = /var/www/html/HKMAIN_NEW/Upload/product/manual/cn/\n#\n# 模块名称与自定义名称相同\ncomment = web\n\n[webe]\npath = /var/www/html/HKMAIN_NEW/Upload/product/manual/en/\ncomment = webe</code></pre><h3 id=\"centos7-2安装nfs服务器端\"><a href=\"#centos7-2安装nfs服务器端\" class=\"headerlink\" title=\"centos7.2安装nfs服务器端\"></a>centos7.2安装nfs服务器端</h3><pre><code># 服务器端安装及配置\n# 安装命令\nsudo yum install nfs-utils rpcbind\n# 查看是否安装成功\n$ rpm -aq nfs-utils rpcbind\nrpcbind-0.2.0-38.el7.x86_64\nnfs-utils-1.3.0-0.33.el7_3.x86_64\n# 启动rpcbind\nsudo systemctl restart rpcbind\n# 查看状态\nsystemctl status rpcbind\n# 开机启动\nsudo systemctl enable rpcbind\n# 查看是否开机启动\nsystemctl is-enabled rpcbind # enable表示开机启动，disable表示不开机启动\n# 启动及开机启动nfs服务\nsudo systemctl restart nfs\nsudo systemctl enable nfs\n#配置nfs服务\nvim /etc/exports\n/readonly 192.168.0.160(insecure,ro,no_root_squash) # 指定ip地址，只读\n/rwsync 192.168.0.0/24(insecure,rw,sync,no_root_squash) # 指定ip地址段，读写\n# 加载配置文件\nsudo exportfs -rv\n# 查看nfs服务器本地挂载情况\n$ showmount -e localhost\nExport list for localhost:\n/rwsync   192.168.0.0/24\n/readonly 192.168.0.160\n# 重启服务\nsudo systemctl restart nfs\n\n\n# 客户端安装配置\nsudo yum install nfs-utils rpcbind\n# 只需启动rpc服务\nsudo systemctl restart rpcbind\nsudo systemctl enable rpcbind\n# 查看可以挂载服务器端的目录\nshowmount -e 192.168.0.206\nExport list for 192.168.0.206:\n/rwsync   192.168.0.0/24\n/readonly 192.168.0.160\n# 挂载\nsudo mount -t nfs 192.168.0.206:/readonly /mnt/readonly\nsudo mount -t nfs 192.168.0.206:/rwsync /mnt/rwsync\n# 查看挂载结果\ndf -h</code></pre><h3 id=\"centos7-2安装python3-5\"><a href=\"#centos7-2安装python3-5\" class=\"headerlink\" title=\"centos7.2安装python3.5\"></a>centos7.2安装python3.5</h3><pre><code># 安装编译环境\nyum install openssl-devel bzip2-devel expat-devel gdbm-devel readline-devel sqlite-devel\n# 下载文件\nwget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tgz\n# 解压\ntar -zxvf Python-3.6.6.tgz\n# 编译安装\ncd Python-3.5.1\n./configure --prefix=/usr/local/python3\nmake &amp;&amp; make install\n# 创建软连接\nsudo ln -s /usr/local/python3/bin/python3 /usr/bin/python3\npython3 --version\nsudo ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3 \npip3 --version\n\n# 添加pip源\nvim ~/.pip/pip.conf\n[global]\ntrusted-host =  mirrors.aliyun.com\nindex-url = https://mirrors.aliyun.com/pypi/simple\n\n### 安装虚拟环境\nsudo pip3 uninstall virtualenv\nsudo ln -s /usr/local/python3/bin/virtualenv /usr/bin/virtualenv \n\n### 创建虚拟环境\nvirtualenv --no-site-packages -p python3 .env\nsource ./.env/bin/activate</code></pre><h3 id=\"centos7-2安装node8\"><a href=\"#centos7-2安装node8\" class=\"headerlink\" title=\"centos7.2安装node8\"></a>centos7.2安装node8</h3><pre><code># 参考文件 https://nodejs.org/en/download/package-manager/\nOn RHEL, CentOS or Fedora, for Node.js v8 LTS:\n\ncurl --silent --location https://rpm.nodesource.com/setup_8.x | sudo bash -\nAlternatively for Node.js 10:\n\ncurl --silent --location https://rpm.nodesource.com/setup_10.x | sudo bash -\nThen install:\nsudo yum -y install nodejs\n\n\n# 安装cnpm\nnpm install -g cnpm --registry=https://registry.npm.taobao.org</code></pre><h3 id=\"centos6-8安装nginx\"><a href=\"#centos6-8安装nginx\" class=\"headerlink\" title=\"centos6.8安装nginx\"></a>centos6.8安装nginx</h3><pre><code># 安装pcre库，使nginx支持rewrite\nyum install pcre pcre-devel -y\n# 安装openssl，https服务需要使用\nyum install openssl openssl-devel -y\n# 安装 gzip 类库\nyum -y install zlib zlib-devel\n# 安装编译程序\nyum -y install make gcc gcc-c++ ncurses-devel\n# 创建用户\nuseradd nginx -s /sbin/nologin -M\n# 下载源码\nwget -q https://nginx.org/download/nginx-1.6.3.tar.gz \ntar -zxvf nginx-1.6.3.tar.gz\ncd nginx-1.6.3\n./configure --user=nginx --group=nginx --prefix=/usr/local/nginx --with-http_ssl_module --with-http_stub_status_module --with-pcre\nmake\nmake install\n\n\n# 启动nginx\n/usr/local/nginx/sbin/nginx\n# 停止nginx\n/usr/local/nginx/sbin/nginx -s quit\n# 重新加载配置文件\n/usr/local/nginx/sbin/nginx -s reload        \n# 测试你的配置文件是否有误\n/usr/local/nginx/sbin/nginx -t       \n# 查看nginx对应的端口\n lsof -i :80</code></pre><h3 id=\"centos6-8安装mysql5-7\"><a href=\"#centos6-8安装mysql5-7\" class=\"headerlink\" title=\"centos6.8安装mysql5.7\"></a>centos6.8安装mysql5.7</h3><pre><code># yum源直接安装的是mysql5.1版本，抛弃\n# 先检查是否有旧版本\nrpm -qa | grep mysql\n# 删除旧版本\nsudo yum -y remove mysql-xx-xx\nwget https://dev.mysql.com/get/mysql57-community-release-el6-10.noarch.rpm\nsudo yum install mysql57-community-release-el6-10.noarch.rpm\nsudo yum install mysql-community-server</code></pre><h3 id=\"centos7-2-源码安装nginx\"><a href=\"#centos7-2-源码安装nginx\" class=\"headerlink\" title=\"centos7.2 源码安装nginx\"></a>centos7.2 源码安装nginx</h3><pre><code># 安装pcre库，使nginx支持rewrite\nyum install pcre pcre-devel -y\n# 安装openssl，https服务需要使用\nyum install openssl openssl-devel -y\n# 安装 gzip 类库\nyum -y install zlib zlib-devel\n# 安装编译程序\nyum -y install make gcc gcc-c++ ncurses-devel\n# 创建用户\nuseradd nginx -s /sbin/nologin -M\n# 下载源码\nwget -q https://nginx.org/download/nginx-1.12.1.tar.gz \ntar -zxvf nginx-1.12.1.tar.gz\ncd nginx-1.12.1\n./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_gunzip_module --with-http_gzip_static_module --with-threads --with-file-aio --with-ipv6 --with-http_v2_module --with-cc-opt=&apos;-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=native&apos;\nmake\nmake install\n\n\n# 创建链接\nsudo ln -s /usr/local/nginx/bin/nginx /usr/bin/nginx\n# 启动nginx\n/usr/local/nginx/sbin/nginx\n# 停止nginx\n/usr/local/nginx/sbin/nginx -s quit\n# 重新加载配置文件\n/usr/local/nginx/sbin/nginx -s reload        \n# 测试你的配置文件是否有误\n/usr/local/nginx/sbin/nginx -t       \n# 查看nginx对应的端口\n lsof -i :80</code></pre><h3 id=\"centos7-2安装php7\"><a href=\"#centos7-2安装php7\" class=\"headerlink\" title=\"centos7.2安装php7\"></a>centos7.2安装php7</h3><pre><code># 加源\nsudo yum install epel-release yum-utils\nsudo yum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm\n# 选择remi\nsudo yum-config-manager --enable remi-php70\nsudo yum-config-manager --enable remi-php71\nsudo yum-config-manager --enable remi-php72\n# 安装相关扩展\nsudo yum-config-manager --enable remi-php70\nsudo yum install php php-common php-opcache php-mcrypt php-cli php-gd php-curl php-mysql\n# 安装 PHP FPM \nsudo yum install php-fpm\nsudo systemctl enable php-fpm\nsudo systemctl start php-fpm\n# 配置\nsudo vim /etc/php-fpm.d/www.conf\nuser = nginx\ngroup = nginx\n\n\n# 配置nginx虚拟server\nserver {\n\n    # . . . other code\n\n    location ~ \\.php$ {\n        try_files $uri =404;\n        # fastcgi_pass unix:/run/php-fpm/www.sock;\n                fastcgi_pass 127.0.0.1:9000;\n        fastcgi_index index.php;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        include fastcgi_params;\n    }\n}</code></pre><h3 id=\"centos7-2安装redis\"><a href=\"#centos7-2安装redis\" class=\"headerlink\" title=\"centos7.2安装redis\"></a>centos7.2安装redis</h3><pre><code>$ sudo yum install redis\n$ sudo systemctl enable redis\n$ sudo systemctl start redis\n# 查看版本号\n$ redis-server --version\n\n\n# 使用方法 http://www.zhuohc.com/articles/redis%E5%9F%BA%E7%A1%80/</code></pre><p><a href=\"/articles/centos7-2安装及使用docker/\">centos7.2安装使用docker</a> <a href=\"/articles/centos7-2安装使用sentry/\">centos7.2安装使用sentry</a> <a href=\"/articles/centos7-2使用rabbitmq/\">centos7.2安装使用rabbitMQ</a> <a href=\"/articles/postgresql常见命令/\">centos7.2安装使用postgresql</a></p>\n<h4 id=\"centos7-2安装supervisor\"><a href=\"#centos7-2安装supervisor\" class=\"headerlink\" title=\"centos7.2安装supervisor\"></a>centos7.2安装supervisor</h4><p>安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo yum install -y supervisor</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> systemctl <span class=\"built_in\">enable</span> supervisord <span class=\"comment\"># 开机自启动</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> systemctl start supervisord <span class=\"comment\"># 启动supervisord服务</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> systemctl status supervisord <span class=\"comment\"># 查看supervisord服务状态</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ps -ef|grep supervisord <span class=\"comment\"># 查看是否存在supervisord进程</span></span></span><br></pre></td></tr></table></figure>\n\n<p>配置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 设置web访问</span></span><br><span class=\"line\">[inet_http_server]</span><br><span class=\"line\">port=*:9001                                                  </span><br><span class=\"line\">username=username</span><br><span class=\"line\">password=password </span><br><span class=\"line\">[include]                                                                                   │(.env-api) ➜  supervisord.d sudo vim doneself-api.ini                 </span><br><span class=\"line\">files = supervisord.d/*.ini   # 配置文件地址</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> vim xxx.ini</span></span><br><span class=\"line\">[program:doneself-api-uwsgi]</span><br><span class=\"line\">command = /home/doneself/code/web/.env-api/bin/uwsgi --ini /home/doneself/code/web/api/uwsgi.ini</span><br><span class=\"line\">autostart = true</span><br><span class=\"line\">autorestart = true</span><br><span class=\"line\">stopsignal= QUIT</span><br><span class=\"line\">user= doneself</span><br><span class=\"line\">redirect_stderr=false</span><br><span class=\"line\">stdout_logfile = /home/doneself/code/web/api/log/uwsgi_stdout.log</span><br><span class=\"line\">stderr_logfile = /home/doneself/code/web/api/log/uwsgi_stderr.log</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"http://supervisord.org/\" target=\"_blank\" rel=\"noopener\">其他信息</a></p>\n"},{"title":"pythontkinter入门基础","url":"99.html","id":"99","comments":0,"date":"2016-11-10T02:58:02.000Z","_content":"\npython基础环境\n\n    sudo apt-get install python\n    sudo apt-get install python-pip\n    \n\nTkinter安装\n\n    sudo apt-get install python-tk\n    \n\n配置组件外观\n\n    #!/usr/bin/python\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    root = Tk()\n    # 定义图标\n    if sys.platform == 'win32':\n        root.iconbitmap('favicon.ico')\n    else:\n        icon = PhotoImage(file='phone.gif')\n        root.tk.call('wm', 'iconphoto', root._w, icon)\n    # 定义字体，字号，类型\n    label_font = ('Ubuntu', 20, 'bold underline italic')\n    # 创建组件\n    widget = Label(root, text='Hello,云克隆', padx=100, pady=20)\n    # 配置组件字体\n    widget.config(font=label_font)\n    # 组件宽，高\n    widget.config(height=3, width=20)\n    # 组件背景颜色\n    widget.config(bg='#FF0')\n    # 组件字体颜色\n    widget.config(fg='#F0F')\n    # 组件边框宽度\n    widget.config(bd=3)\n    # 组件边框外形, FLAT扁平, SUNKEN凹陷, RAISED凸起, GROOVE凹槽, SOLID加粗, RIDGE脊状,\n    widget.config(relief=SUNKEN)\n    # 组件鼠标手势, 'gumby', 'watch', 'pencil', 'crdss', hand2\n    widget.config(cursor='gumby')\n    # 组件状态, DISABLE禁用, NORMAL正常, READONLY只读\n    widget.config(state=DISABLED)\n    # 布置组件\n    # expand设置是否可以扩展，fill表示随父组件扩展方向，可以设置BOTH, X, Y\n    # 设置组件padding值\n    # side表示按钮布置窗口的位置\n    widget.pack(expand=True, fill=X, padx=10, pady=50, side=LEFT)\n    root.mainloop()\n    \n\n#### 标准弹出框\n\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from tkMessageBox import *\n    # python3\n    # from Tkinter.messagebox import *\n    def callback():\n        if askyesno('Verify', 'Do you ready want to quit?'):\n            showwarning('Yes', 'Quit not yet')\n        else:\n            showinfo('No', 'Quit has been cancelled')\n    \n    errmsg = 'Sorry, no spam allowed'\n    Button(None, text='Quit', command=callback).pack(fill=X)\n    Button(None, text='spam', command=(lambda: showerror('spam', errmsg))).pack(fill=X)\n    mainloop()\n    \n\n#### 常见弹框\n\n    # gui6.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from tkMessageBox import *\n    from tkFileDialog import *\n    from tkColorChooser import *\n    from tkSimpleDialog import *\n    \n    \n    demos = {\n        'Open': askopenfilename,\n        'Color': askcolor,\n        'Query': lambda: askquestion('Warning', 'You typed \"rm *\"\\nconfirm?'),\n        'Error': lambda: showerror('Error!', 'He is dead'),\n        'Input': lambda: askfloat('Entry', 'Enter credit card number')\n    }\n    \n    \n    class Demo(Frame):\n        def __init__(self, parent=None, **options):\n            Frame.__init__(self, parent, **options)\n            self.pack()\n            Label(self, text='Basic demos').pack()\n            for (key, value) in demos.items():\n                Button(self, text=key, command=value).pack(side=TOP, fill=BOTH)\n    \n    if __name__ == '__main__':\n        Demo().mainloop()\n    自定义弹框\n    \n    # -*- coding: UTF-8 -*-\n    import sys\n    from Tkinter import *\n    makemodal = (len(sys.argv) > 1)\n    \n    def dialog():\n        win = Toplevel()\n        Label(win, text='Hard drive reformatted!').pack()\n        Button(win, text='OK', command=win.destroy).pack()\n        if makemodal:\n            # 获取输入的焦点\n            win.focus_set()\n            # 打开的时候，禁用其他窗口\n            win.grab_set()\n            # 在win销毁之前，继续等待\n            win.wait_window()\n        print 'dialog exit'\n    \n    root = Tk()\n    Button(root, text='popup', command=dialog).pack()\n    root.mainloop()\n    \n\n#### 绑定事件\n\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    \n    \n    def showPosEvent(event):\n        print('Widget=%s, X=%s, Y=%s' % (event.widget, event.x, event.y))\n    \n    \n    def showAllEvent(event):\n        print(event)\n        for attr in dir(event):\n            if not attr.startswith('__'):\n                print(attr, '=>', getattr(event, attr))\n    \n    \n    def onKeyPress(event):\n        print('Got key press: ', event.char)\n    \n    \n    def onArrowKey(event):\n        print('Got up arrow key press')\n    \n    \n    def onReturnKey(event):\n        print('Got return key press')\n    \n    \n    def onLeftClick(event):\n        print('Got left mouse button click: ')\n        showPosEvent(event)\n    \n    \n    def onRightClick(event):\n        print('Got right mouse button click: ')\n        showPosEvent(event)\n    \n    \n    def onMiddleClick(event):\n        print('Got middle mouse button click: ')\n        showPosEvent(event)\n        showAllEvent(event)\n    \n    \n    def onLeftDrag(event):\n        print('Got left mouse drag click: ')\n        showPosEvent(event)\n    \n    \n    def onDoubleLeftClick(event):\n        print('Got double left mouse click: ')\n        showPosEvent(event)\n        tkroot.quit()\n    \n    \n    tkroot = Tk()\n    labelfont = ('courier', 20, 'bold')\n    widget = Label(tkroot, text='Hello bind world')\n    widget.config(bg='red', font=labelfont)\n    widget.config(height=5, width=20)\n    widget.pack(expand=YES, fill=BOTH)\n    # 绑定单击左键\n    widget.bind('<Button-1>', onLeftClick)\n    # 绑定单击右键\n    widget.bind('<Button-3>', onRightClick)\n    # 绑定单击中键\n    widget.bind('<Button-2>', onMiddleClick)\n    # 绑定双击左键\n    widget.bind('<Double-1>', onDoubleLeftClick)\n    # 绑定拖拽 B1表示点击左键，Motion表示拖拽\n    widget.bind('<B1-Motion>', onLeftDrag)\n    # 绑定键盘按键\n    widget.bind('<KeyPress>', onKeyPress)\n    # 绑定按下箭头键\n    widget.bind('<Up>', onArrowKey)\n    # 绑定回车，返回键\n    widget.bind('<Return>', onReturnKey)\n    widget.focus()\n    tkroot.title('CLICK ME')\n    tkroot.mainloop()\n    \n    # <ButtonPress> 按下按钮\n    # <ButtonRelease> 松开按钮\n    # <Motion> 鼠标指针移动\n    # <Configure> 窗口大小，位置改变时候\n    # <Destroy> 销毁窗口\n    # <FocusIn> 获取焦点\n    # <FocusOut> 失去焦点\n    # <Map> 窗口打开\n    # <Unmap> 窗口最小化\n    # <Escape>, <BackSpace>, <Tab> 捕获特点ESC键，回车键，tab键\n    # <Down>, <Up>, <Left>, <Right> 捕获方向键\n    # <B1-Motion> 按下左键并拖拽\n    # <KeyPress-a> 按下按键“a”，大小写敏感\n    \n\n#### 输入框\n\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from quitGui import Quitter\n    \n    fields = 'Name', 'Job', 'Pay'\n    \n    \n    def fetch(entries):\n        for entry in entries:\n            print('Input => %s' % entry.get())  # 获取文本信息\n    \n    \n    def makeform(root, fields):\n        entries = []\n        for field in fields:\n            row = Frame(root)\n            lab = Label(row, width=5, text=field)\n            ent = Entry(row)\n            row.pack(side=TOP, fill=X)\n            lab.pack(side=LEFT)\n            ent.pack(side=RIGHT, expand=YES, fill=X)\n            entries.append(ent)\n        return entries\n    \n    \n    def show(entries, popup):\n        fetch(entries)  # 必须在销毁前取出\n        popup.destroy()  # 如果修改了stmt， order， msgs会随之失败\n    \n    \n    def ask():\n        popup = Toplevel()  # 在模拟对话框窗口中显示表单\n        ents = makeform(popup, fields)\n        Button(popup, text='OK', command=(lambda: show(ents, popup))).pack()\n        popup.grab_set()  # 打开的时候，禁用其他窗口\n        popup.focus_set()  # 获取输入的焦点\n        popup.wait_window()  # 在这里等待销毁\n    \n    \n    if __name__ == '__main__':\n        root = Tk()\n        Button(root, text='Dialog', command=ask).pack()\n        root.mainloop()\n    \n\n#### 复选框\n\n    # gui13.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from gui6 import demos\n    from quitGui import Quitter\n    \n    \n    class Demo(Frame):\n        def __init__(self, parent=None, **options):\n            Frame.__init__(self, parent, **options)\n            self.pack()\n            self.tools()\n            Label(self, text='Ckech demos').pack()\n            self.vars = []\n            for key in demos:\n                var = IntVar()\n                Checkbutton(self, text=key, variable=var, command=demos[key]).pack(side=LEFT)\n                self.vars.append(var)\n    \n        def report(self):\n            for var in self.vars:\n                print(var.get())  # 当前开关设置1或者0\n            print()\n    \n        def tools(self):\n            frm = Frame(self)\n            frm.pack(side=RIGHT)\n            Button(frm, text='State', command=self.report).pack(fill=X)\n            Quitter(frm).pack(fill=X)\n    \n    \n    if __name__ == '__main__':\n        Demo().mainloop()\n    \n    \n\n#### 单选按钮\n\n    #gui14.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from gui6 import demos\n    from quitGui import Quitter\n    \n    \n    class Demo(Frame):\n        def __init__(self, parent=None, **options):\n            Frame.__init__(self, parent, **options)\n            self.pack()\n            Label(self, text='Radio demos').pack(side=TOP)\n            self.var = StringVar()\n            # variable表示单选按钮的变量，相当与html的name标签\n            # value表示单选按钮的变量值，相当与html的value标签\n            for key in demos:\n                Radiobutton(self, text=key, command=self.onPress, variable=self.var, value=key).pack(anchor=NW)\n            self.var.set(key)  # 选中最后一个开始\n            Button(self, text='State', command=self.report).pack(fill=X)\n            Quitter(self).pack(fill=X)\n    \n        def onPress(self):\n            pick = self.var.get()\n            print('you pressed', pick)\n            print('result: ', demos[pick]())  # 按钮使用返回的值\n    \n        def report(self):\n            print(self.var.get())\n    \n    if __name__ == '__main__':\n        Demo().mainloop()\n    \n\n#### 标尺滚动条\n\n    # gui16.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from gui6 import demos\n    from quitGui import Quitter\n    \n    \n    class Demo(Frame):\n        def __init__(self, parent=None, **options):\n            Frame.__init__(self, parent, **options)\n            self.pack()\n            Label(self, text='Scale demos').pack()\n            self.var = IntVar()\n            Scale(self, label='Pick demo number',\n                  command=self.onMove, variable=self.var,\n                  from_=0, to=len(demos)-1).pack()\n            Scale(self, label='Pick demo number',  # 标尺的文本\n                  command=self.onMove,  # 绑定回调\n                  variable=self.var,  # 变量\n                  from_=0,   # 标尺最小值\n                  to=len(demos) - 1,   # 标尺最大值\n                  length = 200,  # 长度\n                  tickinterval = 2,   # 每隔几个单位显示标记单位\n                  showvalue = YES,  # 显示或隐藏标尺滑动条旁边的当前值\n                  orient = 'horizontal'  # 横向展示\n                  ).pack()\n            Quitter(self).pack(side=RIGHT)\n            Button(self, text='Run demo', command=self.onRun).pack(side=LEFT)\n            Button(self, text='State', command=self.report).pack(side=RIGHT)\n    \n        def onMove(self, value):\n            print('in onMove', value)\n    \n        def onRun(self):\n            pos = self.var.get()\n            print('you picked', pos)\n            demo = list(demos.values())[pos]\n            print(demo())\n    \n        def report(self):\n            print(self.var.get())\n    \n    if __name__ == '__main__':\n        print(list(demos.keys()))\n        Demo().mainloop()\n    \n\n#### 创建图片\n\n    # gui17.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    \n    gifdir = './gif/'\n    win = Tk()\n    igm = PhotoImage(file=gifdir + 'logo.png')\n    \n    # 按钮上绑定图片\n    # Button(win, image=igm).pack()\n    # win.mainloop()\n    \n    # 创建画布\n    can = Canvas(win)\n    can.pack(fill=BOTH)\n    can.config(width=igm.width() + 4, height=igm.height() + 4)\n    can.create_image(2,  # x坐标\n                     2,  # y坐标\n                     image=igm, anchor=NW)\n    win.mainloop()\n    \n\n### 按钮随机读取图片\n\n    # gui18.py\n    # -*- coding: UTF-8 -*-\n    from glob import glob\n    from gui13 import *\n    import random\n    \n    gifdir = './gif/'\n    \n    \" 按钮随机读取图片 \"\n    class ButtonPicsDemo(Frame):\n        def __init__(self, gifdir=gifdir, parent=None):\n            Frame.__init__(self, parent)\n            self.pack()\n            self.lbl = Label(self, text='none', bg='blue', fg='red')\n            self.pix = Button(self, text='press me', command=self.draw, bg='white')\n            self.lbl.pack(fill=BOTH)\n            self.pix.pack(pady=10)\n            Demo(self, relief=SUNKEN, bd=2).pack(fill=BOTH)\n            # glob模块， glob方法，返回所有匹配的文件列表\n            files = glob(gifdir + '*.png')\n            self.images = [(x, PhotoImage(file=x)) for x in files]\n            print(files)\n    \n        def draw(self):\n            name, photo = random.choice(self.images)\n            self.lbl.config(text=name)\n            self.pix.config(image=photo)\n    \n    if __name__ == '__main__':\n        if __name__ == '__main__':\n            ButtonPicsDemo().mainloop()\n    \n\n#### 缩略图\n\n    # gui19.py\n    # -*- coding: UTF-8 -*-\n    import os\n    import math\n    import PIL\n    from PIL import Image\n    from Tkinter import *\n    \n    \n    def make_thumbs(img_dir, size=(100, 100), subdir='thumbs'):\n        thumb_dir = os.path.join(img_dir, subdir)\n        if not os.path.exists(thumb_dir):\n            os.mkdir(thumb_dir)\n        thumbs = []\n        for img_file in os.listdir(img_dir):\n            thumb_path = os.path.join(thumb_dir, img_file)\n            if os.path.exists(thumb_path):\n                thumb_obj = PIL.Image.open(thumb_path)\n                thumbs.append((img_file, thumb_obj))\n            else:\n                print('making', thumb_path)\n                img_path = os.path.join(img_dir, img_file)\n                try:\n                    img_obj = PIL.Image.open(img_path)\n                    img_obj.thumbnail(size, PIL.Image.ANTIALIAS)\n                    img_obj.save(thumb_path)\n                    thumbs.append((img_file, img_obj))\n                except Exception, e:\n                    print('skipping: ', img_path)\n                    print e\n        return thumbs\n    \n    \n    class ViewOne(Toplevel):\n        def __init__(self, img_dir, img_file):\n            Toplevel.__init__(self)\n            self.title(img_file)\n            img_path = os.path.join(img_dir, img_file)\n            img_obj = PhotoImage(file=img_path)\n            Label(self, image=img_obj).pack()\n            print(img_path, img_obj.width(), img_obj.height())\n            self.savephoto = img_obj\n    \n    \n    def viewer(img_dir, kind=Toplevel, cols=None):\n        win = kind()\n        win.title('VIEWER: ' + img_dir)\n        thumbs = make_thumbs(img_dir)\n        if not cols:\n            # 固定大小 或者N×N\n            cols = int(math.ceil(math.sqrt(len(thumbs))))\n        savephotos = []\n        while thumbs:\n            thumbs_row, thumbs = thumbs[:cols], thumbs[cols:]\n            row = Frame(win)\n            row.pack(fill=BOTH)\n            for(img_file, img_obj) in thumbs_row:\n                size = max(img_obj.size)\n                photo = PhotoImage(file=os.path.join(img_dir, 'thumbs', img_file))\n                link = Button(row, image=photo)\n            handler = lambda savefile=img_file: ViewOne(img_dir, savefile)\n            link.config(command=handler, width=size, height=size)\n            link.pack(side=LEFT, expand=YES)\n            savephotos.append(photo)\n        Button(win, text='Quit', command=win.quit, bg='beige').pack(fill=X)\n        return win, savephotos\n    \n    if __name__ == '__main__':\n        img_dir = len(sys.argv) > 1 and sys.argv[1] or 'gif'\n        main, save = viewer(img_dir, kind=Tk)\n        main.mainloop()\n    \n\n### 创建基础顶级菜单\n\n    # gui20.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from tkMessageBox import *\n    \n    \n    def not_done():\n        showerror('Not implemented', 'Not yet available')\n    \n    \n    def make_menu(win):\n        top = Menu(win)  # 定义顶级菜单\n        win.config(menu=top)\n        file = Menu(top, tearoff=True)  # 一级菜单 tearoff:设置菜单下的虚线是否显示\n        file.add_command(label='New...', command=not_done, underline=0)\n        file.add_command(label='Open...', command=not_done, underline=0)\n        file.add_command(label='Quit...', command=win.quit,  underline=0)\n        top.add_cascade(label='File', menu=file, underline=0)  # 在顶级菜单中添加一级菜单\n    \n        edit = Menu(top, tearoff=False)  # 一级菜单\n        edit.add_command(label='Cut', command=not_done, underline=0)\n        edit.add_command(label='Paste', command=not_done, underline=0)\n        edit.add_separator()  # 添加下划线\n        top.add_cascade(label='Edit', menu=edit, underline=0)\n    \n        submenu = Menu(edit, tearoff=True)  # 二级菜单\n        submenu.add_command(label='Spam', command=win.quit, underline=0)\n        submenu.add_command(label='Eggs', command=not_done, underline=0)\n        edit.add_cascade(label='Stuff', menu=submenu, underline=0)  # 在一级菜单中添加二级菜单\n    \n    if __name__ == '__main__':\n        root = Tk()\n        root.title('menu_win')\n        make_menu(root)\n        msg = Label(root, text='Window menu basic')\n        msg.pack(expand=YES, fill=BOTH)\n        msg.config(relief=SUNKEN, width=40, height=7, bg='beige')\n        root.mainloop()\n    \n\n#### 创建框架级别菜单\n\n    # gui21.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from tkMessageBox import *\n    \n    \n    def not_done():\n        showerror('Not implemented', 'Not yet available')\n    \n    \n    def make_menu(parent):\n        menu_bar = Frame(parent)\n        menu_bar.pack(side=TOP, fill=X)\n    \n        f_button = Menubutton(menu_bar, text='File', underline=0)\n        f_button.pack(side=LEFT)\n        file = Menu(f_button)\n        file.add_command(label='New...', command=not_done, underline=0)\n        file.add_command(label='Open...', command=not_done, underline=0)\n        file.add_command(label='Quit...', command=parent.quit,  underline=0)\n        f_button.config(menu=file)\n    \n        e_button = Menubutton(menu_bar, text='Edit', underline=0)\n        e_button.pack(side=LEFT)\n        edit = Menu(e_button)\n        edit.add_command(label='Cut', command=not_done, underline=0)\n        edit.add_command(label='Paste', command=not_done, underline=0)\n        edit.add_separator()\n        e_button.config(menu=edit)\n    \n        sub_menu = Menu(edit, tearoff=True)\n        sub_menu.add_command(label='Spam', command=parent.quit, underline=0)\n        sub_menu.add_command(label='Eggs', command=not_done, underline=0)\n        edit.add_cascade(label='Stuff', menu=sub_menu, underline=0)\n        return menu_bar\n    \n    \n    \n    if __name__ == '__main__':\n        root = Tk()\n        root.title('menu_fra')\n        for i in range(2):\n            mnu = make_menu(root)\n            mnu.config(bd=2, relief=RAISED)\n            Label(root, bg='black', height=5, width=25).pack(expand=YES, fill=BOTH)\n        Button(root, text='Bye', command=root.quit).pack()\n        root.mainloop()\n    \n\n#### 图片菜单\n\n    # gui22.py\n    # -*- coding:UTF-8 -*-\n    from Tkinter import *\n    from tkMessageBox import *\n    \n    \n    class NewMenuDemo(Frame):\n        def __init__(self, parent=None):\n            Frame.__init__(self, parent)\n            self.pack(expand=YES, fill=BOTH)\n            self.create_widgets()\n    \n        def create_widgets(self):\n            self.make_menubar()\n            self.make_toolbar()\n            l = Label(self, text='Menu and Toolbar Demo')\n            l.config(relief=SUNKEN, width=40, height=10, bg='white')\n            l.pack(expand=YES, fill=BOTH)\n    \n        def make_toolbar(self, size=(30, 30)):\n            toolbar = Frame(self, cursor='hand2', relief=SUNKEN, bd=2)\n            toolbar.pack(side=BOTTOM, fill=X)\n            Button(toolbar, text='Quit', command=self.quit).pack(side=RIGHT)\n            photo_files = ('at.png', 'bd.png', 'dk.png')\n            self.tool_photo_objs = []\n            for file in photo_files:\n                img = PhotoImage(file='./gif/thumbs/' + file)\n                btn = Button(toolbar, image=img, command=self.greeting)\n                btn.config(bd=5, relief=RIDGE)\n                btn.config(width=size[0], height=size[0])\n                btn.pack(side=LEFT)\n                self.tool_photo_objs.append(img)\n            Button(toolbar, text='Hello', command=self.greeting).pack(side=LEFT)\n    \n        def make_menubar(self):\n            self.menubar = Menu(self.master)\n            self.master.config(menu=self.menubar)\n            self.file_menu()\n            self.edit_menu()\n            self.image_menu()\n    \n        def file_menu(self):\n            pulldown = Menu(self.menubar)\n            pulldown.add_command(label='OPEN...', command=self.notdone)\n            pulldown.add_command(label='QUIT', command=self.quit)\n            self.menubar.add_cascade(label='FILE', underline=0, menu=pulldown)\n    \n        def edit_menu(self):\n            pulldown = Menu(self.menubar)\n            pulldown.add_command(label='PASTE', command=self.notdone)\n            pulldown.add_command(label='SPAM', command=self.greeting)\n            pulldown.add_separator()\n            pulldown.add_command(label='DELETE', command=self.greeting)\n            pulldown.entryconfig(4, state=DISABLED)\n            self.menubar.add_cascade(label='EDIT', underline=0, menu=pulldown)\n    \n        def image_menu(self):\n            photo_files = ('at.png', 'bd.png', 'dk.png')\n            pulldown = Menu(self.menubar)\n            self.photo_objs = []\n            for file in photo_files:\n                img = PhotoImage(file='./gif/' + file)\n                pulldown.add_command(image=img, command=self.notdone)\n                self.photo_objs.append(img)\n            self.menubar.add_cascade(label='IMAGE', underline=0, menu=pulldown)\n    \n        def greeting(self):\n            showinfo('greeting', 'GREETING')\n    \n        def notdone(self):\n            showerror('NOT DONE', 'NOT DONE')\n    \n        def quit(self):\n            if askyesno('Verify quit', 'Sure?'):\n                Frame.quit(self)\n    \n    if __name__ == '__main__':\n        NewMenuDemo().mainloop()\n    \n\n#### 滚动条与列表\n\n    # gui23.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    \n    \n    class ScrolledList(Frame):\n        def __init__(self, options, parent=None):\n            Frame.__init__(self, parent)\n            self.pack(expand=YES, fill=BOTH)\n            self.makeWidgets(options)\n    \n    \n        def handle_list(self, event):\n            index = self.listbox.curselection()  # 鼠标选中的行\n            label = self.listbox.get(index)  # 获取鼠标选中的值\n            self.runCommand(label)  # 打印出值\n    \n    \n        def makeWidgets(self, options):\n            # sbar = Scrollbar(self, orient='horizontal')  # 横向滚动\n            sbar = Scrollbar(self)\n            list = Listbox(self, relief=SUNKEN)\n            sbar.config(command=list.yview)  # 移动滚动条启用回调： 按比例调节列表框的显示，\n            list.config(yscrollcommand=sbar.set)  # 移动列表框启用回调：按比例调节滚动条\n            sbar.pack(side=RIGHT, fill=Y)\n            list.pack(side=LEFT, expand=YES, fill=BOTH)\n            pos = 0\n            for label in options:\n                list.insert(pos, label)\n                pos += 1\n            # selectmode 选择模式SINGLE(单选), BROWSE(默认单选), MULTIPLE(多选), EXTENDED(多选)\n            # 启用多选时， curselection返回列表\n            # 启用单选时， curselection返回字符串\n            list.config(selectmode=EXTENDED, setgrid=1)\n            list.bind('<Double-1>', self.handle_list)\n            self.listbox = list\n    \n        def runCommand(self, selection):\n            print('YOU SELECTED:', selection)\n    \n    \n    if __name__ == '__main__':\n        options = (('Lumberjack-%s' % x) for x in range(20))\n        ScrolledList(options).mainloop()\n    \n\n#### TEXT组件\n\n    gui24.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    \n    \n    class ScrollText(Frame):\n        def __init__(self, parent=None, text='', file=None):\n            Frame.__init__(self, parent)\n            self.pack(expand=YES, fill=BOTH)\n            self.make_widgets()\n            self.set_text(text, file)\n    \n        def make_widgets(self):\n            sbar = Scrollbar(self)\n            text = Text(self, relief=SUNKEN)\n            sbar.config(command=text.yview)\n            text.config(yscrollcommand=sbar.set)\n            sbar.pack(side=RIGHT, fill=Y)\n            text.pack(side=LEFT, expand=YES, fill=BOTH)\n            self.text = text\n    \n        def set_text(self, text='', file=None):\n            if file:\n                text = open(file, 'r').read()\n            # 1.0表示第一行，第0列（行从1开始，列从0开始）\n            # END表示最末一个字符后面第一个位置\n            self.text.delete('1.0', END)  # 删除从第一行第0列开始到最后的字符串，即删除全部\n            self.text.insert('1.0', text)  # 从第一行第0列开始填充数据\n            # mark_set 设置text标志\n            self.text.mark_set(INSERT, '1.0')  # 设置将光标设置在文本开始位置\n            # self.text.mark_set('line_two', '2.2')  # 自定义标志位置 可以用mark_unset取消\n            self.text.focus()\n            # TEXT的tag标签\n            # SEL是内置的标签，表示当前选中的文本\n            # text = self.text.get(SEL_FIRST, SEL_LAST)\n            # text = self.text.get('sel.first', 'sel.last')\n            # self.text.tag_add('alltext', '1.0', END)  # 选中所有文本\n            # self.text.tag_add(SEL, index1, index2)  # 将一定范围内的文本添加到内建的SEL标签\n            # self.text.tag_remove(SEL, '1.0', END)  # 将字符串所有字符从SEL标签中删除\n            # self.text.tag_delete(SEL)  # 删除SEL标签\n            # self.text.tag_add('demo', '1.5', '1.7')\n            # self.text.tag_add('demo', '3.0', '5.7')\n            # self.text.tag_config('demo', background='purple')\n            # self.text.tag_config('demo', fontground='white')\n            # self.text.tag_config('demo', font=('times', 16, 'underline'))\n            # self.text.tag_bind('demo', '<Double-1>', func)\n            # see方法\n            # self.text.see('1.0')  # 滚动到第一行第0列\n            # self.text.see(INSERT)  # 滚动到光标插入处\n            # self.text.see(SEL_FIRST)  # 滚动到选中文本第一个字符串\n        def get_text(self):\n            # -1c 表示往回数一个字符串\n            # +1l 表示往前数一行\n            return self.text.get('1.0', END + '-1c')\n    \n    \n    if __name__ == '__main__':\n        root = Tk()\n        if len(sys.argv) > 1:\n            st = ScrollText(file=sys.argv[1])\n        else:\n            st = ScrollText(text='Words\\ngo here')\n    \n        def show(event):\n            print(repr(st.get_text()))\n    \n        root.bind('<Key-Escape>', show)\n        root.mainloop()\n    \n\n#### 简单的文本编辑器\n\n    # gui25.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from tkSimpleDialog import askstring\n    from tkFileDialog import asksaveasfilename\n    from quitGui import Quitter\n    from gui24 import ScrollText\n    \n    \n    class SimpleEditor(ScrollText):\n        def __init__(self, parent=None, file=None):\n            frm = Frame(parent)\n            frm.pack(fill=X)\n            Button(frm, text='Save', command=self.on_save).pack(side=LEFT)\n            Button(frm, text='Cut', command=self.on_cut).pack(side=LEFT)\n            Button(frm, text='Paste', command=self.on_paste).pack(side=LEFT)\n            Button(frm, text='Find', command=self.on_find).pack(side=LEFT)\n            Quitter(frm).pack(side=LEFT)\n            ScrollText.__init__(self, parent, file=file)\n            self.text.config(font=('courier', 9, 'normal'))\n    \n        def on_save(self):\n            filename = asksaveasfilename()\n            if filename:\n                alltext = self.get_text()\n                open(filename, 'w').write(alltext)\n    \n    \n        def on_cut(self):\n            text = self.text.get(SEL_FIRST, SEL_LAST)\n            self.text.delete(SEL_FIRST, SEL_LAST)\n            self.clipboard_clear()\n            self.clipboard_append(text)\n    \n    \n        def on_paste(self):\n            try:\n                text = self.selection_get(selection='CLIPBOARD')\n                self.text.insert(INSERT, text)\n            except TclError:\n                pass\n    \n    \n        def on_find(self):\n            target = askstring('SimpleEdit', 'Search string?')\n            if target:\n                where = self.text.search(target, INSERT, END)\n                if where:\n                    print(where)\n                    pastit = where + ('+%dc' % len(target))\n                    self.text.tag_remove(SEL, '1.0', END)\n                    self.text.tag_add(SEL, where, pastit)\n                    self.text.mark_set(INSERT, pastit)\n                    self.text.see(INSERT)\n                    self.text.focus()\n    \n    if __name__ == '__main__':\n        if len(sys.argv) > 1:\n            SimpleEditor(file=sys.argv[1]).mainloop()\n        else:\n            SimpleEditor().mainloop()\n    \n\n#### 创建基础画布\n\n    # gui26.py\n    # -*- coding: UTF-8 -*-\n    \n    from Tkinter import *\n    canvas = Canvas(width=525, height=300, bg='white')\n    canvas.pack(expand=YES, fill=BOTH)\n    \n    canvas.create_line(100, 100, 200, 200)\n    canvas.create_line(100, 200, 200, 300)\n    for i in range(1, 20, 2):\n        canvas.create_line(0, i, 50, i)\n    canvas.create_oval(20, 20, 300, 100, width=10, fill='yellow')\n    d = {1:PIESLICE,2:CHORD,3:ARC}\n    for i in d:\n        canvas.create_arc(\n            (10,10 + 60*i,110,110 + 60*i),\n            style=d[i],   #指定样式\n            start=30,     #指定起始角度\n            extent=30     #指定角度偏移量\n            )\n    canvas.create_arc(0, 0, 100, 200, fill='black')\n    canvas.create_rectangle(200, 200, 300, 300, width=5, fill='red')\n    canvas.create_line(0, 300, 150, 150, width=10, fill='green')\n    \n    photo = PhotoImage(file='./gif/lightmachine.png')\n    canvas.create_image(325,25, image=photo, anchor=NW)\n    \n    widget = Label(canvas, text='Spam', fg='white', bg='black')\n    widget.pack()\n    canvas.create_window(100, 100, window=widget)\n    canvas.create_text(100, 280, text='CLOUD CLONE CORP.')\n    \n    # id = canvas.create_line(fromX, fromY, toX, toY)  # 创建直线\n    # id = canvas.create_oval(fromX, fromY, toX, toY) # 创建椭圆\n    # id = canvas.create_arc(fromX, fromY, toX, toY)  # 创建扇形\n    # id =canvas.create_rectangle(fromX, fromY, toX, toY)  # 创建矩形\n    # canvas.move(id, offsetX, offsetY)  # 移动对象\n    # canvas.delete(id)  # 删除对象\n    # canvas.tkraise(id)  # 将对象移动到前端\n    # canvas.lower(id)  # 将对象移动到底部\n    # canvas.itemconfig(id, fill='red')  # 修改对象属性\n    \n    # 画布标签\n    # canvas.create_line(fromX, fromY, toX, toY, tag='bubbles') \n    # canvas.create_line(fromX, fromY, toX, toY, tag='bubbles') \n    # id = canvas.create_line(fromX, fromY, toX, toY)\n    # canvas.addtag_withtag('bubbles', id)\n    # canvas.move('bubbles', diffX, diffY)\n    mainloop()\n    \n\n#### canvas与滚动条\n\n    # gui27.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    \n    class ScrolledCanvas(Frame):\n        def __init__(self, parent=None, color='brown'):\n            Frame.__init__(self, parent)\n            self.pack(expand=YES, fill=BOTH)\n            canv = Canvas(self, bg=color, relief=SUNKEN)\n            canv.config(width=300, height=200)\n            canv.config(scrollregion=(0, 0, 300, 1000))\n            canv.config(highlightthickness=0)\n    \n            sbar = Scrollbar(self)\n            sbar.config(command=canv.yview)\n            canv.config(yscrollcommand=sbar.set)\n            sbar.pack(side=RIGHT, fill=Y)\n            canv.pack(side=LEFT, expand=YES, fill=BOTH)\n    \n            self.fillContent(canv)\n            canv.bind('<Double-1>', self.onDoubleClick)\n            self.canvas = canv\n    \n        def fillContent(self, canv):\n            for i in range(10):\n                canv.create_text(150, 50+(i*100), text='spam'+str(i), fill='beige')\n    \n        def onDoubleClick(self, event):\n            print(event.x, event.y)\n            print(self.canvas.canvasx(event.x), self.canvas.canvasy(event.y))\n    \n    if __name__ == '__main__':\n        ScrolledCanvas().mainloop()\n    \n\n#### canvas绑定事件\n\n    # gui28.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    trace = False\n    \n    class CanvasEventDemo:\n        def __init__(self, parent=None):\n            canvas = Canvas(width=300, height=300, bg='beige')\n            canvas.pack()\n            canvas.bind('<ButtonPress-1>', self.on_start)\n            canvas.bind('<B1-Motion>', self.on_grow)\n            canvas.bind('<Double-1>', self.on_clear)\n            canvas.bind('<ButtonPress-3>', self.on_move)\n            self.canvas = canvas\n            self.drawn = None\n            self.kinds = [canvas.create_oval, canvas.create_rectangle]\n    \n        def on_start(self, event):\n            self.shape =self.kinds[0]\n            self.kinds = self.kinds[1:] + self.kinds[:1]\n            self.start = event\n            self.drawn = None\n    \n        def on_grow(self, event):\n            canvas = event.widget\n            if self.drawn:\n                canvas.delete(self.drawn)\n            object_id = self.shape(self.start.x, self.start.y, event.x, event.y)\n            if trace:\n                print(object_id)\n            self.drawn = object_id\n    \n        def on_clear(self, event):\n            event.widget.delete('all')\n    \n    \n        def on_move(self, event):\n            if self.drawn:\n                if trace:\n                    print(self.drawn)\n                canvas = event.widget\n                diffx, diffy = (event.x - self.start.x), (event.y - self.start.y)\n                canvas.move(self.drawn, diffx, diffy)\n                self.start = event\n    \n    if __name__ == '__main__':\n        CanvasEventDemo()\n        mainloop()\n    \n\n#### grid布局和pack布局实现自动扩展\n\n    # gui29.py\n    # -*- coding: UTF-8 -*-\n    \n    from Tkinter import *\n    colors = ['red', 'green', 'orange', 'white', 'yellow', 'blue']\n    \n    def gridbox(root):\n        Label(root, text='GRID').grid(columnspan=2)  # 跨两列\n        row = 1\n        for color in colors:\n            lab = Label(root, text=color, relief=RIDGE, width=25)\n            ent = Entry(root, bg=color, relief=SUNKEN, width=50)\n            lab.grid(row=row, column=0, sticky=NSEW)  # 向4个方向扩展\n            ent.grid(row=row, column=1, sticky=NSEW)\n            root.rowconfigure(row, weight=1)  # 循环行自动扩展\n            row += 1\n        root.columnconfigure(0, weight=1)  # 第一列自动扩展\n        root.columnconfigure(1, weight=1)  # 第二列自动扩展\n    \n    def packbox(root):\n        Label(root, text='PACK').pack()\n        for color in colors:\n            row = Frame(root)\n            lab = Label(row, text=color, relief=RIDGE, width=25)\n            ent = Entry(row, bg=color, relief=SUNKEN, width=50)\n            row.pack(side=TOP, expand=YES, fill=BOTH)\n            lab.pack(side=LEFT, expand=YES, fill=BOTH)\n            ent.pack(side=RIGHT, expand=YES, fill=BOTH)\n    \n    if __name__ == '__main__':\n        root = Tk()\n        gridbox(Toplevel(root))\n        packbox(Toplevel(root))\n        Button(root, text='Quit', command=root.quit).pack()\n        mainloop()\n    \n\n### PIL：Python Imaging Library\n\n#### 安装\n\n    sudo apt-get install python-imaging\n    或者\n    sudo easy_install PIL\n    \n\nwindow系统选择\n\n    pip install Pillow\n    \n\n图像操作\n\n    import Image\n    # 打开一个jpg图像文件，注意路径要改成你自己的:\n    im = Image.open('/Users/michael/test.jpg')\n    # 获得图像尺寸:\n    w, h = im.size\n    # 缩放到50%:\n    im.thumbnail((w//2, h//2))\n    # 把缩放后的图像用jpeg格式保存:\n    im.save('/Users/michael/thumbnail.jpg', 'jpeg')\n    \n\n模糊效果\n\n    import Image, ImageFilter\n    \n    im = Image.open('/Users/hanchang/test.jpg')\n    im2 = im.filter(ImageFilter.BLUR)\n    im2.save('/Users/hanchang/blur.jpg', 'jpeg')\n    \n\n自定义图像验证码\n\n    import Image, ImageDraw, ImageFont, ImageFilter\n    import random\n    # 随机字母:\n    def rndChar():\n        return chr(random.randint(65, 90))\n    \n    # 随机颜色1:\n    def rndColor():\n        return (random.randint(64, 255), random.randint(64, 255), random.randint(64, 255))\n    \n    # 随机颜色2:\n    def rndColor2():\n        return (random.randint(32, 127), random.randint(32, 127), random.randint(32, 127))\n    \n    # 240 x 60:\n    width = 60 * 4\n    height = 60\n    image = Image.new('RGB', (width, height), (255, 255, 255))\n    # 创建Font对象:\n    font = ImageFont.truetype('Arial.ttf', 36)\n    # 创建Draw对象:\n    draw = ImageDraw.Draw(image)\n    # 填充每个像素:\n    for x in range(width):\n        for y in range(height):\n            draw.point((x, y), fill=rndColor())\n    # 输出文字:\n    for t in range(4):\n        draw.text((60 * t + 10, 10), rndChar(), font=font, fill=rndColor2())\n    # 模糊:\n    image = image.filter(ImageFilter.BLUR)\n    image.save('code.jpg', 'jpeg');\n    自定义字符串生成图片\n    \n\n``` from PIL import Image,ImageDraw,ImageFont,ImageOps <h1>生成图片</h1> def create\\_image(str, line, name, dir): img\\_size = (400, (line*20) + 10) img\\_mode = 'RGB' img\\_font = ImageFont.truetype('UbuntuMono-R.ttf', 14) img\\_bg = '#FFF' img\\_fg = '#000' img = Image.new(mode=img\\_mode, size=img\\_size, color=img\\_bg) draw = ImageDraw.Draw(img) draw.text((10, 10), str, fill=img\\_fg, font=img_font) img.save( dir + name + '.png', 'png') ```","source":"_posts/pythontkinter入门基础.md","raw":"---\ntitle: pythontkinter入门基础\ntags:\n  - python\nurl: 99.html\nid: 99\ncomments: false\ncategories:\n  - 后端\ndate: 2016-11-10 10:58:02\n---\n\npython基础环境\n\n    sudo apt-get install python\n    sudo apt-get install python-pip\n    \n\nTkinter安装\n\n    sudo apt-get install python-tk\n    \n\n配置组件外观\n\n    #!/usr/bin/python\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    root = Tk()\n    # 定义图标\n    if sys.platform == 'win32':\n        root.iconbitmap('favicon.ico')\n    else:\n        icon = PhotoImage(file='phone.gif')\n        root.tk.call('wm', 'iconphoto', root._w, icon)\n    # 定义字体，字号，类型\n    label_font = ('Ubuntu', 20, 'bold underline italic')\n    # 创建组件\n    widget = Label(root, text='Hello,云克隆', padx=100, pady=20)\n    # 配置组件字体\n    widget.config(font=label_font)\n    # 组件宽，高\n    widget.config(height=3, width=20)\n    # 组件背景颜色\n    widget.config(bg='#FF0')\n    # 组件字体颜色\n    widget.config(fg='#F0F')\n    # 组件边框宽度\n    widget.config(bd=3)\n    # 组件边框外形, FLAT扁平, SUNKEN凹陷, RAISED凸起, GROOVE凹槽, SOLID加粗, RIDGE脊状,\n    widget.config(relief=SUNKEN)\n    # 组件鼠标手势, 'gumby', 'watch', 'pencil', 'crdss', hand2\n    widget.config(cursor='gumby')\n    # 组件状态, DISABLE禁用, NORMAL正常, READONLY只读\n    widget.config(state=DISABLED)\n    # 布置组件\n    # expand设置是否可以扩展，fill表示随父组件扩展方向，可以设置BOTH, X, Y\n    # 设置组件padding值\n    # side表示按钮布置窗口的位置\n    widget.pack(expand=True, fill=X, padx=10, pady=50, side=LEFT)\n    root.mainloop()\n    \n\n#### 标准弹出框\n\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from tkMessageBox import *\n    # python3\n    # from Tkinter.messagebox import *\n    def callback():\n        if askyesno('Verify', 'Do you ready want to quit?'):\n            showwarning('Yes', 'Quit not yet')\n        else:\n            showinfo('No', 'Quit has been cancelled')\n    \n    errmsg = 'Sorry, no spam allowed'\n    Button(None, text='Quit', command=callback).pack(fill=X)\n    Button(None, text='spam', command=(lambda: showerror('spam', errmsg))).pack(fill=X)\n    mainloop()\n    \n\n#### 常见弹框\n\n    # gui6.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from tkMessageBox import *\n    from tkFileDialog import *\n    from tkColorChooser import *\n    from tkSimpleDialog import *\n    \n    \n    demos = {\n        'Open': askopenfilename,\n        'Color': askcolor,\n        'Query': lambda: askquestion('Warning', 'You typed \"rm *\"\\nconfirm?'),\n        'Error': lambda: showerror('Error!', 'He is dead'),\n        'Input': lambda: askfloat('Entry', 'Enter credit card number')\n    }\n    \n    \n    class Demo(Frame):\n        def __init__(self, parent=None, **options):\n            Frame.__init__(self, parent, **options)\n            self.pack()\n            Label(self, text='Basic demos').pack()\n            for (key, value) in demos.items():\n                Button(self, text=key, command=value).pack(side=TOP, fill=BOTH)\n    \n    if __name__ == '__main__':\n        Demo().mainloop()\n    自定义弹框\n    \n    # -*- coding: UTF-8 -*-\n    import sys\n    from Tkinter import *\n    makemodal = (len(sys.argv) > 1)\n    \n    def dialog():\n        win = Toplevel()\n        Label(win, text='Hard drive reformatted!').pack()\n        Button(win, text='OK', command=win.destroy).pack()\n        if makemodal:\n            # 获取输入的焦点\n            win.focus_set()\n            # 打开的时候，禁用其他窗口\n            win.grab_set()\n            # 在win销毁之前，继续等待\n            win.wait_window()\n        print 'dialog exit'\n    \n    root = Tk()\n    Button(root, text='popup', command=dialog).pack()\n    root.mainloop()\n    \n\n#### 绑定事件\n\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    \n    \n    def showPosEvent(event):\n        print('Widget=%s, X=%s, Y=%s' % (event.widget, event.x, event.y))\n    \n    \n    def showAllEvent(event):\n        print(event)\n        for attr in dir(event):\n            if not attr.startswith('__'):\n                print(attr, '=>', getattr(event, attr))\n    \n    \n    def onKeyPress(event):\n        print('Got key press: ', event.char)\n    \n    \n    def onArrowKey(event):\n        print('Got up arrow key press')\n    \n    \n    def onReturnKey(event):\n        print('Got return key press')\n    \n    \n    def onLeftClick(event):\n        print('Got left mouse button click: ')\n        showPosEvent(event)\n    \n    \n    def onRightClick(event):\n        print('Got right mouse button click: ')\n        showPosEvent(event)\n    \n    \n    def onMiddleClick(event):\n        print('Got middle mouse button click: ')\n        showPosEvent(event)\n        showAllEvent(event)\n    \n    \n    def onLeftDrag(event):\n        print('Got left mouse drag click: ')\n        showPosEvent(event)\n    \n    \n    def onDoubleLeftClick(event):\n        print('Got double left mouse click: ')\n        showPosEvent(event)\n        tkroot.quit()\n    \n    \n    tkroot = Tk()\n    labelfont = ('courier', 20, 'bold')\n    widget = Label(tkroot, text='Hello bind world')\n    widget.config(bg='red', font=labelfont)\n    widget.config(height=5, width=20)\n    widget.pack(expand=YES, fill=BOTH)\n    # 绑定单击左键\n    widget.bind('<Button-1>', onLeftClick)\n    # 绑定单击右键\n    widget.bind('<Button-3>', onRightClick)\n    # 绑定单击中键\n    widget.bind('<Button-2>', onMiddleClick)\n    # 绑定双击左键\n    widget.bind('<Double-1>', onDoubleLeftClick)\n    # 绑定拖拽 B1表示点击左键，Motion表示拖拽\n    widget.bind('<B1-Motion>', onLeftDrag)\n    # 绑定键盘按键\n    widget.bind('<KeyPress>', onKeyPress)\n    # 绑定按下箭头键\n    widget.bind('<Up>', onArrowKey)\n    # 绑定回车，返回键\n    widget.bind('<Return>', onReturnKey)\n    widget.focus()\n    tkroot.title('CLICK ME')\n    tkroot.mainloop()\n    \n    # <ButtonPress> 按下按钮\n    # <ButtonRelease> 松开按钮\n    # <Motion> 鼠标指针移动\n    # <Configure> 窗口大小，位置改变时候\n    # <Destroy> 销毁窗口\n    # <FocusIn> 获取焦点\n    # <FocusOut> 失去焦点\n    # <Map> 窗口打开\n    # <Unmap> 窗口最小化\n    # <Escape>, <BackSpace>, <Tab> 捕获特点ESC键，回车键，tab键\n    # <Down>, <Up>, <Left>, <Right> 捕获方向键\n    # <B1-Motion> 按下左键并拖拽\n    # <KeyPress-a> 按下按键“a”，大小写敏感\n    \n\n#### 输入框\n\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from quitGui import Quitter\n    \n    fields = 'Name', 'Job', 'Pay'\n    \n    \n    def fetch(entries):\n        for entry in entries:\n            print('Input => %s' % entry.get())  # 获取文本信息\n    \n    \n    def makeform(root, fields):\n        entries = []\n        for field in fields:\n            row = Frame(root)\n            lab = Label(row, width=5, text=field)\n            ent = Entry(row)\n            row.pack(side=TOP, fill=X)\n            lab.pack(side=LEFT)\n            ent.pack(side=RIGHT, expand=YES, fill=X)\n            entries.append(ent)\n        return entries\n    \n    \n    def show(entries, popup):\n        fetch(entries)  # 必须在销毁前取出\n        popup.destroy()  # 如果修改了stmt， order， msgs会随之失败\n    \n    \n    def ask():\n        popup = Toplevel()  # 在模拟对话框窗口中显示表单\n        ents = makeform(popup, fields)\n        Button(popup, text='OK', command=(lambda: show(ents, popup))).pack()\n        popup.grab_set()  # 打开的时候，禁用其他窗口\n        popup.focus_set()  # 获取输入的焦点\n        popup.wait_window()  # 在这里等待销毁\n    \n    \n    if __name__ == '__main__':\n        root = Tk()\n        Button(root, text='Dialog', command=ask).pack()\n        root.mainloop()\n    \n\n#### 复选框\n\n    # gui13.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from gui6 import demos\n    from quitGui import Quitter\n    \n    \n    class Demo(Frame):\n        def __init__(self, parent=None, **options):\n            Frame.__init__(self, parent, **options)\n            self.pack()\n            self.tools()\n            Label(self, text='Ckech demos').pack()\n            self.vars = []\n            for key in demos:\n                var = IntVar()\n                Checkbutton(self, text=key, variable=var, command=demos[key]).pack(side=LEFT)\n                self.vars.append(var)\n    \n        def report(self):\n            for var in self.vars:\n                print(var.get())  # 当前开关设置1或者0\n            print()\n    \n        def tools(self):\n            frm = Frame(self)\n            frm.pack(side=RIGHT)\n            Button(frm, text='State', command=self.report).pack(fill=X)\n            Quitter(frm).pack(fill=X)\n    \n    \n    if __name__ == '__main__':\n        Demo().mainloop()\n    \n    \n\n#### 单选按钮\n\n    #gui14.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from gui6 import demos\n    from quitGui import Quitter\n    \n    \n    class Demo(Frame):\n        def __init__(self, parent=None, **options):\n            Frame.__init__(self, parent, **options)\n            self.pack()\n            Label(self, text='Radio demos').pack(side=TOP)\n            self.var = StringVar()\n            # variable表示单选按钮的变量，相当与html的name标签\n            # value表示单选按钮的变量值，相当与html的value标签\n            for key in demos:\n                Radiobutton(self, text=key, command=self.onPress, variable=self.var, value=key).pack(anchor=NW)\n            self.var.set(key)  # 选中最后一个开始\n            Button(self, text='State', command=self.report).pack(fill=X)\n            Quitter(self).pack(fill=X)\n    \n        def onPress(self):\n            pick = self.var.get()\n            print('you pressed', pick)\n            print('result: ', demos[pick]())  # 按钮使用返回的值\n    \n        def report(self):\n            print(self.var.get())\n    \n    if __name__ == '__main__':\n        Demo().mainloop()\n    \n\n#### 标尺滚动条\n\n    # gui16.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from gui6 import demos\n    from quitGui import Quitter\n    \n    \n    class Demo(Frame):\n        def __init__(self, parent=None, **options):\n            Frame.__init__(self, parent, **options)\n            self.pack()\n            Label(self, text='Scale demos').pack()\n            self.var = IntVar()\n            Scale(self, label='Pick demo number',\n                  command=self.onMove, variable=self.var,\n                  from_=0, to=len(demos)-1).pack()\n            Scale(self, label='Pick demo number',  # 标尺的文本\n                  command=self.onMove,  # 绑定回调\n                  variable=self.var,  # 变量\n                  from_=0,   # 标尺最小值\n                  to=len(demos) - 1,   # 标尺最大值\n                  length = 200,  # 长度\n                  tickinterval = 2,   # 每隔几个单位显示标记单位\n                  showvalue = YES,  # 显示或隐藏标尺滑动条旁边的当前值\n                  orient = 'horizontal'  # 横向展示\n                  ).pack()\n            Quitter(self).pack(side=RIGHT)\n            Button(self, text='Run demo', command=self.onRun).pack(side=LEFT)\n            Button(self, text='State', command=self.report).pack(side=RIGHT)\n    \n        def onMove(self, value):\n            print('in onMove', value)\n    \n        def onRun(self):\n            pos = self.var.get()\n            print('you picked', pos)\n            demo = list(demos.values())[pos]\n            print(demo())\n    \n        def report(self):\n            print(self.var.get())\n    \n    if __name__ == '__main__':\n        print(list(demos.keys()))\n        Demo().mainloop()\n    \n\n#### 创建图片\n\n    # gui17.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    \n    gifdir = './gif/'\n    win = Tk()\n    igm = PhotoImage(file=gifdir + 'logo.png')\n    \n    # 按钮上绑定图片\n    # Button(win, image=igm).pack()\n    # win.mainloop()\n    \n    # 创建画布\n    can = Canvas(win)\n    can.pack(fill=BOTH)\n    can.config(width=igm.width() + 4, height=igm.height() + 4)\n    can.create_image(2,  # x坐标\n                     2,  # y坐标\n                     image=igm, anchor=NW)\n    win.mainloop()\n    \n\n### 按钮随机读取图片\n\n    # gui18.py\n    # -*- coding: UTF-8 -*-\n    from glob import glob\n    from gui13 import *\n    import random\n    \n    gifdir = './gif/'\n    \n    \" 按钮随机读取图片 \"\n    class ButtonPicsDemo(Frame):\n        def __init__(self, gifdir=gifdir, parent=None):\n            Frame.__init__(self, parent)\n            self.pack()\n            self.lbl = Label(self, text='none', bg='blue', fg='red')\n            self.pix = Button(self, text='press me', command=self.draw, bg='white')\n            self.lbl.pack(fill=BOTH)\n            self.pix.pack(pady=10)\n            Demo(self, relief=SUNKEN, bd=2).pack(fill=BOTH)\n            # glob模块， glob方法，返回所有匹配的文件列表\n            files = glob(gifdir + '*.png')\n            self.images = [(x, PhotoImage(file=x)) for x in files]\n            print(files)\n    \n        def draw(self):\n            name, photo = random.choice(self.images)\n            self.lbl.config(text=name)\n            self.pix.config(image=photo)\n    \n    if __name__ == '__main__':\n        if __name__ == '__main__':\n            ButtonPicsDemo().mainloop()\n    \n\n#### 缩略图\n\n    # gui19.py\n    # -*- coding: UTF-8 -*-\n    import os\n    import math\n    import PIL\n    from PIL import Image\n    from Tkinter import *\n    \n    \n    def make_thumbs(img_dir, size=(100, 100), subdir='thumbs'):\n        thumb_dir = os.path.join(img_dir, subdir)\n        if not os.path.exists(thumb_dir):\n            os.mkdir(thumb_dir)\n        thumbs = []\n        for img_file in os.listdir(img_dir):\n            thumb_path = os.path.join(thumb_dir, img_file)\n            if os.path.exists(thumb_path):\n                thumb_obj = PIL.Image.open(thumb_path)\n                thumbs.append((img_file, thumb_obj))\n            else:\n                print('making', thumb_path)\n                img_path = os.path.join(img_dir, img_file)\n                try:\n                    img_obj = PIL.Image.open(img_path)\n                    img_obj.thumbnail(size, PIL.Image.ANTIALIAS)\n                    img_obj.save(thumb_path)\n                    thumbs.append((img_file, img_obj))\n                except Exception, e:\n                    print('skipping: ', img_path)\n                    print e\n        return thumbs\n    \n    \n    class ViewOne(Toplevel):\n        def __init__(self, img_dir, img_file):\n            Toplevel.__init__(self)\n            self.title(img_file)\n            img_path = os.path.join(img_dir, img_file)\n            img_obj = PhotoImage(file=img_path)\n            Label(self, image=img_obj).pack()\n            print(img_path, img_obj.width(), img_obj.height())\n            self.savephoto = img_obj\n    \n    \n    def viewer(img_dir, kind=Toplevel, cols=None):\n        win = kind()\n        win.title('VIEWER: ' + img_dir)\n        thumbs = make_thumbs(img_dir)\n        if not cols:\n            # 固定大小 或者N×N\n            cols = int(math.ceil(math.sqrt(len(thumbs))))\n        savephotos = []\n        while thumbs:\n            thumbs_row, thumbs = thumbs[:cols], thumbs[cols:]\n            row = Frame(win)\n            row.pack(fill=BOTH)\n            for(img_file, img_obj) in thumbs_row:\n                size = max(img_obj.size)\n                photo = PhotoImage(file=os.path.join(img_dir, 'thumbs', img_file))\n                link = Button(row, image=photo)\n            handler = lambda savefile=img_file: ViewOne(img_dir, savefile)\n            link.config(command=handler, width=size, height=size)\n            link.pack(side=LEFT, expand=YES)\n            savephotos.append(photo)\n        Button(win, text='Quit', command=win.quit, bg='beige').pack(fill=X)\n        return win, savephotos\n    \n    if __name__ == '__main__':\n        img_dir = len(sys.argv) > 1 and sys.argv[1] or 'gif'\n        main, save = viewer(img_dir, kind=Tk)\n        main.mainloop()\n    \n\n### 创建基础顶级菜单\n\n    # gui20.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from tkMessageBox import *\n    \n    \n    def not_done():\n        showerror('Not implemented', 'Not yet available')\n    \n    \n    def make_menu(win):\n        top = Menu(win)  # 定义顶级菜单\n        win.config(menu=top)\n        file = Menu(top, tearoff=True)  # 一级菜单 tearoff:设置菜单下的虚线是否显示\n        file.add_command(label='New...', command=not_done, underline=0)\n        file.add_command(label='Open...', command=not_done, underline=0)\n        file.add_command(label='Quit...', command=win.quit,  underline=0)\n        top.add_cascade(label='File', menu=file, underline=0)  # 在顶级菜单中添加一级菜单\n    \n        edit = Menu(top, tearoff=False)  # 一级菜单\n        edit.add_command(label='Cut', command=not_done, underline=0)\n        edit.add_command(label='Paste', command=not_done, underline=0)\n        edit.add_separator()  # 添加下划线\n        top.add_cascade(label='Edit', menu=edit, underline=0)\n    \n        submenu = Menu(edit, tearoff=True)  # 二级菜单\n        submenu.add_command(label='Spam', command=win.quit, underline=0)\n        submenu.add_command(label='Eggs', command=not_done, underline=0)\n        edit.add_cascade(label='Stuff', menu=submenu, underline=0)  # 在一级菜单中添加二级菜单\n    \n    if __name__ == '__main__':\n        root = Tk()\n        root.title('menu_win')\n        make_menu(root)\n        msg = Label(root, text='Window menu basic')\n        msg.pack(expand=YES, fill=BOTH)\n        msg.config(relief=SUNKEN, width=40, height=7, bg='beige')\n        root.mainloop()\n    \n\n#### 创建框架级别菜单\n\n    # gui21.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from tkMessageBox import *\n    \n    \n    def not_done():\n        showerror('Not implemented', 'Not yet available')\n    \n    \n    def make_menu(parent):\n        menu_bar = Frame(parent)\n        menu_bar.pack(side=TOP, fill=X)\n    \n        f_button = Menubutton(menu_bar, text='File', underline=0)\n        f_button.pack(side=LEFT)\n        file = Menu(f_button)\n        file.add_command(label='New...', command=not_done, underline=0)\n        file.add_command(label='Open...', command=not_done, underline=0)\n        file.add_command(label='Quit...', command=parent.quit,  underline=0)\n        f_button.config(menu=file)\n    \n        e_button = Menubutton(menu_bar, text='Edit', underline=0)\n        e_button.pack(side=LEFT)\n        edit = Menu(e_button)\n        edit.add_command(label='Cut', command=not_done, underline=0)\n        edit.add_command(label='Paste', command=not_done, underline=0)\n        edit.add_separator()\n        e_button.config(menu=edit)\n    \n        sub_menu = Menu(edit, tearoff=True)\n        sub_menu.add_command(label='Spam', command=parent.quit, underline=0)\n        sub_menu.add_command(label='Eggs', command=not_done, underline=0)\n        edit.add_cascade(label='Stuff', menu=sub_menu, underline=0)\n        return menu_bar\n    \n    \n    \n    if __name__ == '__main__':\n        root = Tk()\n        root.title('menu_fra')\n        for i in range(2):\n            mnu = make_menu(root)\n            mnu.config(bd=2, relief=RAISED)\n            Label(root, bg='black', height=5, width=25).pack(expand=YES, fill=BOTH)\n        Button(root, text='Bye', command=root.quit).pack()\n        root.mainloop()\n    \n\n#### 图片菜单\n\n    # gui22.py\n    # -*- coding:UTF-8 -*-\n    from Tkinter import *\n    from tkMessageBox import *\n    \n    \n    class NewMenuDemo(Frame):\n        def __init__(self, parent=None):\n            Frame.__init__(self, parent)\n            self.pack(expand=YES, fill=BOTH)\n            self.create_widgets()\n    \n        def create_widgets(self):\n            self.make_menubar()\n            self.make_toolbar()\n            l = Label(self, text='Menu and Toolbar Demo')\n            l.config(relief=SUNKEN, width=40, height=10, bg='white')\n            l.pack(expand=YES, fill=BOTH)\n    \n        def make_toolbar(self, size=(30, 30)):\n            toolbar = Frame(self, cursor='hand2', relief=SUNKEN, bd=2)\n            toolbar.pack(side=BOTTOM, fill=X)\n            Button(toolbar, text='Quit', command=self.quit).pack(side=RIGHT)\n            photo_files = ('at.png', 'bd.png', 'dk.png')\n            self.tool_photo_objs = []\n            for file in photo_files:\n                img = PhotoImage(file='./gif/thumbs/' + file)\n                btn = Button(toolbar, image=img, command=self.greeting)\n                btn.config(bd=5, relief=RIDGE)\n                btn.config(width=size[0], height=size[0])\n                btn.pack(side=LEFT)\n                self.tool_photo_objs.append(img)\n            Button(toolbar, text='Hello', command=self.greeting).pack(side=LEFT)\n    \n        def make_menubar(self):\n            self.menubar = Menu(self.master)\n            self.master.config(menu=self.menubar)\n            self.file_menu()\n            self.edit_menu()\n            self.image_menu()\n    \n        def file_menu(self):\n            pulldown = Menu(self.menubar)\n            pulldown.add_command(label='OPEN...', command=self.notdone)\n            pulldown.add_command(label='QUIT', command=self.quit)\n            self.menubar.add_cascade(label='FILE', underline=0, menu=pulldown)\n    \n        def edit_menu(self):\n            pulldown = Menu(self.menubar)\n            pulldown.add_command(label='PASTE', command=self.notdone)\n            pulldown.add_command(label='SPAM', command=self.greeting)\n            pulldown.add_separator()\n            pulldown.add_command(label='DELETE', command=self.greeting)\n            pulldown.entryconfig(4, state=DISABLED)\n            self.menubar.add_cascade(label='EDIT', underline=0, menu=pulldown)\n    \n        def image_menu(self):\n            photo_files = ('at.png', 'bd.png', 'dk.png')\n            pulldown = Menu(self.menubar)\n            self.photo_objs = []\n            for file in photo_files:\n                img = PhotoImage(file='./gif/' + file)\n                pulldown.add_command(image=img, command=self.notdone)\n                self.photo_objs.append(img)\n            self.menubar.add_cascade(label='IMAGE', underline=0, menu=pulldown)\n    \n        def greeting(self):\n            showinfo('greeting', 'GREETING')\n    \n        def notdone(self):\n            showerror('NOT DONE', 'NOT DONE')\n    \n        def quit(self):\n            if askyesno('Verify quit', 'Sure?'):\n                Frame.quit(self)\n    \n    if __name__ == '__main__':\n        NewMenuDemo().mainloop()\n    \n\n#### 滚动条与列表\n\n    # gui23.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    \n    \n    class ScrolledList(Frame):\n        def __init__(self, options, parent=None):\n            Frame.__init__(self, parent)\n            self.pack(expand=YES, fill=BOTH)\n            self.makeWidgets(options)\n    \n    \n        def handle_list(self, event):\n            index = self.listbox.curselection()  # 鼠标选中的行\n            label = self.listbox.get(index)  # 获取鼠标选中的值\n            self.runCommand(label)  # 打印出值\n    \n    \n        def makeWidgets(self, options):\n            # sbar = Scrollbar(self, orient='horizontal')  # 横向滚动\n            sbar = Scrollbar(self)\n            list = Listbox(self, relief=SUNKEN)\n            sbar.config(command=list.yview)  # 移动滚动条启用回调： 按比例调节列表框的显示，\n            list.config(yscrollcommand=sbar.set)  # 移动列表框启用回调：按比例调节滚动条\n            sbar.pack(side=RIGHT, fill=Y)\n            list.pack(side=LEFT, expand=YES, fill=BOTH)\n            pos = 0\n            for label in options:\n                list.insert(pos, label)\n                pos += 1\n            # selectmode 选择模式SINGLE(单选), BROWSE(默认单选), MULTIPLE(多选), EXTENDED(多选)\n            # 启用多选时， curselection返回列表\n            # 启用单选时， curselection返回字符串\n            list.config(selectmode=EXTENDED, setgrid=1)\n            list.bind('<Double-1>', self.handle_list)\n            self.listbox = list\n    \n        def runCommand(self, selection):\n            print('YOU SELECTED:', selection)\n    \n    \n    if __name__ == '__main__':\n        options = (('Lumberjack-%s' % x) for x in range(20))\n        ScrolledList(options).mainloop()\n    \n\n#### TEXT组件\n\n    gui24.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    \n    \n    class ScrollText(Frame):\n        def __init__(self, parent=None, text='', file=None):\n            Frame.__init__(self, parent)\n            self.pack(expand=YES, fill=BOTH)\n            self.make_widgets()\n            self.set_text(text, file)\n    \n        def make_widgets(self):\n            sbar = Scrollbar(self)\n            text = Text(self, relief=SUNKEN)\n            sbar.config(command=text.yview)\n            text.config(yscrollcommand=sbar.set)\n            sbar.pack(side=RIGHT, fill=Y)\n            text.pack(side=LEFT, expand=YES, fill=BOTH)\n            self.text = text\n    \n        def set_text(self, text='', file=None):\n            if file:\n                text = open(file, 'r').read()\n            # 1.0表示第一行，第0列（行从1开始，列从0开始）\n            # END表示最末一个字符后面第一个位置\n            self.text.delete('1.0', END)  # 删除从第一行第0列开始到最后的字符串，即删除全部\n            self.text.insert('1.0', text)  # 从第一行第0列开始填充数据\n            # mark_set 设置text标志\n            self.text.mark_set(INSERT, '1.0')  # 设置将光标设置在文本开始位置\n            # self.text.mark_set('line_two', '2.2')  # 自定义标志位置 可以用mark_unset取消\n            self.text.focus()\n            # TEXT的tag标签\n            # SEL是内置的标签，表示当前选中的文本\n            # text = self.text.get(SEL_FIRST, SEL_LAST)\n            # text = self.text.get('sel.first', 'sel.last')\n            # self.text.tag_add('alltext', '1.0', END)  # 选中所有文本\n            # self.text.tag_add(SEL, index1, index2)  # 将一定范围内的文本添加到内建的SEL标签\n            # self.text.tag_remove(SEL, '1.0', END)  # 将字符串所有字符从SEL标签中删除\n            # self.text.tag_delete(SEL)  # 删除SEL标签\n            # self.text.tag_add('demo', '1.5', '1.7')\n            # self.text.tag_add('demo', '3.0', '5.7')\n            # self.text.tag_config('demo', background='purple')\n            # self.text.tag_config('demo', fontground='white')\n            # self.text.tag_config('demo', font=('times', 16, 'underline'))\n            # self.text.tag_bind('demo', '<Double-1>', func)\n            # see方法\n            # self.text.see('1.0')  # 滚动到第一行第0列\n            # self.text.see(INSERT)  # 滚动到光标插入处\n            # self.text.see(SEL_FIRST)  # 滚动到选中文本第一个字符串\n        def get_text(self):\n            # -1c 表示往回数一个字符串\n            # +1l 表示往前数一行\n            return self.text.get('1.0', END + '-1c')\n    \n    \n    if __name__ == '__main__':\n        root = Tk()\n        if len(sys.argv) > 1:\n            st = ScrollText(file=sys.argv[1])\n        else:\n            st = ScrollText(text='Words\\ngo here')\n    \n        def show(event):\n            print(repr(st.get_text()))\n    \n        root.bind('<Key-Escape>', show)\n        root.mainloop()\n    \n\n#### 简单的文本编辑器\n\n    # gui25.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    from tkSimpleDialog import askstring\n    from tkFileDialog import asksaveasfilename\n    from quitGui import Quitter\n    from gui24 import ScrollText\n    \n    \n    class SimpleEditor(ScrollText):\n        def __init__(self, parent=None, file=None):\n            frm = Frame(parent)\n            frm.pack(fill=X)\n            Button(frm, text='Save', command=self.on_save).pack(side=LEFT)\n            Button(frm, text='Cut', command=self.on_cut).pack(side=LEFT)\n            Button(frm, text='Paste', command=self.on_paste).pack(side=LEFT)\n            Button(frm, text='Find', command=self.on_find).pack(side=LEFT)\n            Quitter(frm).pack(side=LEFT)\n            ScrollText.__init__(self, parent, file=file)\n            self.text.config(font=('courier', 9, 'normal'))\n    \n        def on_save(self):\n            filename = asksaveasfilename()\n            if filename:\n                alltext = self.get_text()\n                open(filename, 'w').write(alltext)\n    \n    \n        def on_cut(self):\n            text = self.text.get(SEL_FIRST, SEL_LAST)\n            self.text.delete(SEL_FIRST, SEL_LAST)\n            self.clipboard_clear()\n            self.clipboard_append(text)\n    \n    \n        def on_paste(self):\n            try:\n                text = self.selection_get(selection='CLIPBOARD')\n                self.text.insert(INSERT, text)\n            except TclError:\n                pass\n    \n    \n        def on_find(self):\n            target = askstring('SimpleEdit', 'Search string?')\n            if target:\n                where = self.text.search(target, INSERT, END)\n                if where:\n                    print(where)\n                    pastit = where + ('+%dc' % len(target))\n                    self.text.tag_remove(SEL, '1.0', END)\n                    self.text.tag_add(SEL, where, pastit)\n                    self.text.mark_set(INSERT, pastit)\n                    self.text.see(INSERT)\n                    self.text.focus()\n    \n    if __name__ == '__main__':\n        if len(sys.argv) > 1:\n            SimpleEditor(file=sys.argv[1]).mainloop()\n        else:\n            SimpleEditor().mainloop()\n    \n\n#### 创建基础画布\n\n    # gui26.py\n    # -*- coding: UTF-8 -*-\n    \n    from Tkinter import *\n    canvas = Canvas(width=525, height=300, bg='white')\n    canvas.pack(expand=YES, fill=BOTH)\n    \n    canvas.create_line(100, 100, 200, 200)\n    canvas.create_line(100, 200, 200, 300)\n    for i in range(1, 20, 2):\n        canvas.create_line(0, i, 50, i)\n    canvas.create_oval(20, 20, 300, 100, width=10, fill='yellow')\n    d = {1:PIESLICE,2:CHORD,3:ARC}\n    for i in d:\n        canvas.create_arc(\n            (10,10 + 60*i,110,110 + 60*i),\n            style=d[i],   #指定样式\n            start=30,     #指定起始角度\n            extent=30     #指定角度偏移量\n            )\n    canvas.create_arc(0, 0, 100, 200, fill='black')\n    canvas.create_rectangle(200, 200, 300, 300, width=5, fill='red')\n    canvas.create_line(0, 300, 150, 150, width=10, fill='green')\n    \n    photo = PhotoImage(file='./gif/lightmachine.png')\n    canvas.create_image(325,25, image=photo, anchor=NW)\n    \n    widget = Label(canvas, text='Spam', fg='white', bg='black')\n    widget.pack()\n    canvas.create_window(100, 100, window=widget)\n    canvas.create_text(100, 280, text='CLOUD CLONE CORP.')\n    \n    # id = canvas.create_line(fromX, fromY, toX, toY)  # 创建直线\n    # id = canvas.create_oval(fromX, fromY, toX, toY) # 创建椭圆\n    # id = canvas.create_arc(fromX, fromY, toX, toY)  # 创建扇形\n    # id =canvas.create_rectangle(fromX, fromY, toX, toY)  # 创建矩形\n    # canvas.move(id, offsetX, offsetY)  # 移动对象\n    # canvas.delete(id)  # 删除对象\n    # canvas.tkraise(id)  # 将对象移动到前端\n    # canvas.lower(id)  # 将对象移动到底部\n    # canvas.itemconfig(id, fill='red')  # 修改对象属性\n    \n    # 画布标签\n    # canvas.create_line(fromX, fromY, toX, toY, tag='bubbles') \n    # canvas.create_line(fromX, fromY, toX, toY, tag='bubbles') \n    # id = canvas.create_line(fromX, fromY, toX, toY)\n    # canvas.addtag_withtag('bubbles', id)\n    # canvas.move('bubbles', diffX, diffY)\n    mainloop()\n    \n\n#### canvas与滚动条\n\n    # gui27.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    \n    class ScrolledCanvas(Frame):\n        def __init__(self, parent=None, color='brown'):\n            Frame.__init__(self, parent)\n            self.pack(expand=YES, fill=BOTH)\n            canv = Canvas(self, bg=color, relief=SUNKEN)\n            canv.config(width=300, height=200)\n            canv.config(scrollregion=(0, 0, 300, 1000))\n            canv.config(highlightthickness=0)\n    \n            sbar = Scrollbar(self)\n            sbar.config(command=canv.yview)\n            canv.config(yscrollcommand=sbar.set)\n            sbar.pack(side=RIGHT, fill=Y)\n            canv.pack(side=LEFT, expand=YES, fill=BOTH)\n    \n            self.fillContent(canv)\n            canv.bind('<Double-1>', self.onDoubleClick)\n            self.canvas = canv\n    \n        def fillContent(self, canv):\n            for i in range(10):\n                canv.create_text(150, 50+(i*100), text='spam'+str(i), fill='beige')\n    \n        def onDoubleClick(self, event):\n            print(event.x, event.y)\n            print(self.canvas.canvasx(event.x), self.canvas.canvasy(event.y))\n    \n    if __name__ == '__main__':\n        ScrolledCanvas().mainloop()\n    \n\n#### canvas绑定事件\n\n    # gui28.py\n    # -*- coding: UTF-8 -*-\n    from Tkinter import *\n    trace = False\n    \n    class CanvasEventDemo:\n        def __init__(self, parent=None):\n            canvas = Canvas(width=300, height=300, bg='beige')\n            canvas.pack()\n            canvas.bind('<ButtonPress-1>', self.on_start)\n            canvas.bind('<B1-Motion>', self.on_grow)\n            canvas.bind('<Double-1>', self.on_clear)\n            canvas.bind('<ButtonPress-3>', self.on_move)\n            self.canvas = canvas\n            self.drawn = None\n            self.kinds = [canvas.create_oval, canvas.create_rectangle]\n    \n        def on_start(self, event):\n            self.shape =self.kinds[0]\n            self.kinds = self.kinds[1:] + self.kinds[:1]\n            self.start = event\n            self.drawn = None\n    \n        def on_grow(self, event):\n            canvas = event.widget\n            if self.drawn:\n                canvas.delete(self.drawn)\n            object_id = self.shape(self.start.x, self.start.y, event.x, event.y)\n            if trace:\n                print(object_id)\n            self.drawn = object_id\n    \n        def on_clear(self, event):\n            event.widget.delete('all')\n    \n    \n        def on_move(self, event):\n            if self.drawn:\n                if trace:\n                    print(self.drawn)\n                canvas = event.widget\n                diffx, diffy = (event.x - self.start.x), (event.y - self.start.y)\n                canvas.move(self.drawn, diffx, diffy)\n                self.start = event\n    \n    if __name__ == '__main__':\n        CanvasEventDemo()\n        mainloop()\n    \n\n#### grid布局和pack布局实现自动扩展\n\n    # gui29.py\n    # -*- coding: UTF-8 -*-\n    \n    from Tkinter import *\n    colors = ['red', 'green', 'orange', 'white', 'yellow', 'blue']\n    \n    def gridbox(root):\n        Label(root, text='GRID').grid(columnspan=2)  # 跨两列\n        row = 1\n        for color in colors:\n            lab = Label(root, text=color, relief=RIDGE, width=25)\n            ent = Entry(root, bg=color, relief=SUNKEN, width=50)\n            lab.grid(row=row, column=0, sticky=NSEW)  # 向4个方向扩展\n            ent.grid(row=row, column=1, sticky=NSEW)\n            root.rowconfigure(row, weight=1)  # 循环行自动扩展\n            row += 1\n        root.columnconfigure(0, weight=1)  # 第一列自动扩展\n        root.columnconfigure(1, weight=1)  # 第二列自动扩展\n    \n    def packbox(root):\n        Label(root, text='PACK').pack()\n        for color in colors:\n            row = Frame(root)\n            lab = Label(row, text=color, relief=RIDGE, width=25)\n            ent = Entry(row, bg=color, relief=SUNKEN, width=50)\n            row.pack(side=TOP, expand=YES, fill=BOTH)\n            lab.pack(side=LEFT, expand=YES, fill=BOTH)\n            ent.pack(side=RIGHT, expand=YES, fill=BOTH)\n    \n    if __name__ == '__main__':\n        root = Tk()\n        gridbox(Toplevel(root))\n        packbox(Toplevel(root))\n        Button(root, text='Quit', command=root.quit).pack()\n        mainloop()\n    \n\n### PIL：Python Imaging Library\n\n#### 安装\n\n    sudo apt-get install python-imaging\n    或者\n    sudo easy_install PIL\n    \n\nwindow系统选择\n\n    pip install Pillow\n    \n\n图像操作\n\n    import Image\n    # 打开一个jpg图像文件，注意路径要改成你自己的:\n    im = Image.open('/Users/michael/test.jpg')\n    # 获得图像尺寸:\n    w, h = im.size\n    # 缩放到50%:\n    im.thumbnail((w//2, h//2))\n    # 把缩放后的图像用jpeg格式保存:\n    im.save('/Users/michael/thumbnail.jpg', 'jpeg')\n    \n\n模糊效果\n\n    import Image, ImageFilter\n    \n    im = Image.open('/Users/hanchang/test.jpg')\n    im2 = im.filter(ImageFilter.BLUR)\n    im2.save('/Users/hanchang/blur.jpg', 'jpeg')\n    \n\n自定义图像验证码\n\n    import Image, ImageDraw, ImageFont, ImageFilter\n    import random\n    # 随机字母:\n    def rndChar():\n        return chr(random.randint(65, 90))\n    \n    # 随机颜色1:\n    def rndColor():\n        return (random.randint(64, 255), random.randint(64, 255), random.randint(64, 255))\n    \n    # 随机颜色2:\n    def rndColor2():\n        return (random.randint(32, 127), random.randint(32, 127), random.randint(32, 127))\n    \n    # 240 x 60:\n    width = 60 * 4\n    height = 60\n    image = Image.new('RGB', (width, height), (255, 255, 255))\n    # 创建Font对象:\n    font = ImageFont.truetype('Arial.ttf', 36)\n    # 创建Draw对象:\n    draw = ImageDraw.Draw(image)\n    # 填充每个像素:\n    for x in range(width):\n        for y in range(height):\n            draw.point((x, y), fill=rndColor())\n    # 输出文字:\n    for t in range(4):\n        draw.text((60 * t + 10, 10), rndChar(), font=font, fill=rndColor2())\n    # 模糊:\n    image = image.filter(ImageFilter.BLUR)\n    image.save('code.jpg', 'jpeg');\n    自定义字符串生成图片\n    \n\n``` from PIL import Image,ImageDraw,ImageFont,ImageOps <h1>生成图片</h1> def create\\_image(str, line, name, dir): img\\_size = (400, (line*20) + 10) img\\_mode = 'RGB' img\\_font = ImageFont.truetype('UbuntuMono-R.ttf', 14) img\\_bg = '#FFF' img\\_fg = '#000' img = Image.new(mode=img\\_mode, size=img\\_size, color=img\\_bg) draw = ImageDraw.Draw(img) draw.text((10, 10), str, fill=img\\_fg, font=img_font) img.save( dir + name + '.png', 'png') ```","slug":"pythontkinter入门基础","published":1,"updated":"2019-07-24T01:37:19.180Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5sg00569ka4fdd8npwo","content":"<p>python基础环境</p>\n<pre><code>sudo apt-get install python\nsudo apt-get install python-pip</code></pre><p>Tkinter安装</p>\n<pre><code>sudo apt-get install python-tk</code></pre><p>配置组件外观</p>\n<pre><code>#!/usr/bin/python\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nroot = Tk()\n# 定义图标\nif sys.platform == &apos;win32&apos;:\n    root.iconbitmap(&apos;favicon.ico&apos;)\nelse:\n    icon = PhotoImage(file=&apos;phone.gif&apos;)\n    root.tk.call(&apos;wm&apos;, &apos;iconphoto&apos;, root._w, icon)\n# 定义字体，字号，类型\nlabel_font = (&apos;Ubuntu&apos;, 20, &apos;bold underline italic&apos;)\n# 创建组件\nwidget = Label(root, text=&apos;Hello,云克隆&apos;, padx=100, pady=20)\n# 配置组件字体\nwidget.config(font=label_font)\n# 组件宽，高\nwidget.config(height=3, width=20)\n# 组件背景颜色\nwidget.config(bg=&apos;#FF0&apos;)\n# 组件字体颜色\nwidget.config(fg=&apos;#F0F&apos;)\n# 组件边框宽度\nwidget.config(bd=3)\n# 组件边框外形, FLAT扁平, SUNKEN凹陷, RAISED凸起, GROOVE凹槽, SOLID加粗, RIDGE脊状,\nwidget.config(relief=SUNKEN)\n# 组件鼠标手势, &apos;gumby&apos;, &apos;watch&apos;, &apos;pencil&apos;, &apos;crdss&apos;, hand2\nwidget.config(cursor=&apos;gumby&apos;)\n# 组件状态, DISABLE禁用, NORMAL正常, READONLY只读\nwidget.config(state=DISABLED)\n# 布置组件\n# expand设置是否可以扩展，fill表示随父组件扩展方向，可以设置BOTH, X, Y\n# 设置组件padding值\n# side表示按钮布置窗口的位置\nwidget.pack(expand=True, fill=X, padx=10, pady=50, side=LEFT)\nroot.mainloop()</code></pre><h4 id=\"标准弹出框\"><a href=\"#标准弹出框\" class=\"headerlink\" title=\"标准弹出框\"></a>标准弹出框</h4><pre><code># -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom tkMessageBox import *\n# python3\n# from Tkinter.messagebox import *\ndef callback():\n    if askyesno(&apos;Verify&apos;, &apos;Do you ready want to quit?&apos;):\n        showwarning(&apos;Yes&apos;, &apos;Quit not yet&apos;)\n    else:\n        showinfo(&apos;No&apos;, &apos;Quit has been cancelled&apos;)\n\nerrmsg = &apos;Sorry, no spam allowed&apos;\nButton(None, text=&apos;Quit&apos;, command=callback).pack(fill=X)\nButton(None, text=&apos;spam&apos;, command=(lambda: showerror(&apos;spam&apos;, errmsg))).pack(fill=X)\nmainloop()</code></pre><h4 id=\"常见弹框\"><a href=\"#常见弹框\" class=\"headerlink\" title=\"常见弹框\"></a>常见弹框</h4><pre><code># gui6.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom tkMessageBox import *\nfrom tkFileDialog import *\nfrom tkColorChooser import *\nfrom tkSimpleDialog import *\n\n\ndemos = {\n    &apos;Open&apos;: askopenfilename,\n    &apos;Color&apos;: askcolor,\n    &apos;Query&apos;: lambda: askquestion(&apos;Warning&apos;, &apos;You typed &quot;rm *&quot;\\nconfirm?&apos;),\n    &apos;Error&apos;: lambda: showerror(&apos;Error!&apos;, &apos;He is dead&apos;),\n    &apos;Input&apos;: lambda: askfloat(&apos;Entry&apos;, &apos;Enter credit card number&apos;)\n}\n\n\nclass Demo(Frame):\n    def __init__(self, parent=None, **options):\n        Frame.__init__(self, parent, **options)\n        self.pack()\n        Label(self, text=&apos;Basic demos&apos;).pack()\n        for (key, value) in demos.items():\n            Button(self, text=key, command=value).pack(side=TOP, fill=BOTH)\n\nif __name__ == &apos;__main__&apos;:\n    Demo().mainloop()\n自定义弹框\n\n# -*- coding: UTF-8 -*-\nimport sys\nfrom Tkinter import *\nmakemodal = (len(sys.argv) &gt; 1)\n\ndef dialog():\n    win = Toplevel()\n    Label(win, text=&apos;Hard drive reformatted!&apos;).pack()\n    Button(win, text=&apos;OK&apos;, command=win.destroy).pack()\n    if makemodal:\n        # 获取输入的焦点\n        win.focus_set()\n        # 打开的时候，禁用其他窗口\n        win.grab_set()\n        # 在win销毁之前，继续等待\n        win.wait_window()\n    print &apos;dialog exit&apos;\n\nroot = Tk()\nButton(root, text=&apos;popup&apos;, command=dialog).pack()\nroot.mainloop()</code></pre><h4 id=\"绑定事件\"><a href=\"#绑定事件\" class=\"headerlink\" title=\"绑定事件\"></a>绑定事件</h4><pre><code># -*- coding: UTF-8 -*-\nfrom Tkinter import *\n\n\ndef showPosEvent(event):\n    print(&apos;Widget=%s, X=%s, Y=%s&apos; % (event.widget, event.x, event.y))\n\n\ndef showAllEvent(event):\n    print(event)\n    for attr in dir(event):\n        if not attr.startswith(&apos;__&apos;):\n            print(attr, &apos;=&gt;&apos;, getattr(event, attr))\n\n\ndef onKeyPress(event):\n    print(&apos;Got key press: &apos;, event.char)\n\n\ndef onArrowKey(event):\n    print(&apos;Got up arrow key press&apos;)\n\n\ndef onReturnKey(event):\n    print(&apos;Got return key press&apos;)\n\n\ndef onLeftClick(event):\n    print(&apos;Got left mouse button click: &apos;)\n    showPosEvent(event)\n\n\ndef onRightClick(event):\n    print(&apos;Got right mouse button click: &apos;)\n    showPosEvent(event)\n\n\ndef onMiddleClick(event):\n    print(&apos;Got middle mouse button click: &apos;)\n    showPosEvent(event)\n    showAllEvent(event)\n\n\ndef onLeftDrag(event):\n    print(&apos;Got left mouse drag click: &apos;)\n    showPosEvent(event)\n\n\ndef onDoubleLeftClick(event):\n    print(&apos;Got double left mouse click: &apos;)\n    showPosEvent(event)\n    tkroot.quit()\n\n\ntkroot = Tk()\nlabelfont = (&apos;courier&apos;, 20, &apos;bold&apos;)\nwidget = Label(tkroot, text=&apos;Hello bind world&apos;)\nwidget.config(bg=&apos;red&apos;, font=labelfont)\nwidget.config(height=5, width=20)\nwidget.pack(expand=YES, fill=BOTH)\n# 绑定单击左键\nwidget.bind(&apos;&lt;Button-1&gt;&apos;, onLeftClick)\n# 绑定单击右键\nwidget.bind(&apos;&lt;Button-3&gt;&apos;, onRightClick)\n# 绑定单击中键\nwidget.bind(&apos;&lt;Button-2&gt;&apos;, onMiddleClick)\n# 绑定双击左键\nwidget.bind(&apos;&lt;Double-1&gt;&apos;, onDoubleLeftClick)\n# 绑定拖拽 B1表示点击左键，Motion表示拖拽\nwidget.bind(&apos;&lt;B1-Motion&gt;&apos;, onLeftDrag)\n# 绑定键盘按键\nwidget.bind(&apos;&lt;KeyPress&gt;&apos;, onKeyPress)\n# 绑定按下箭头键\nwidget.bind(&apos;&lt;Up&gt;&apos;, onArrowKey)\n# 绑定回车，返回键\nwidget.bind(&apos;&lt;Return&gt;&apos;, onReturnKey)\nwidget.focus()\ntkroot.title(&apos;CLICK ME&apos;)\ntkroot.mainloop()\n\n# &lt;ButtonPress&gt; 按下按钮\n# &lt;ButtonRelease&gt; 松开按钮\n# &lt;Motion&gt; 鼠标指针移动\n# &lt;Configure&gt; 窗口大小，位置改变时候\n# &lt;Destroy&gt; 销毁窗口\n# &lt;FocusIn&gt; 获取焦点\n# &lt;FocusOut&gt; 失去焦点\n# &lt;Map&gt; 窗口打开\n# &lt;Unmap&gt; 窗口最小化\n# &lt;Escape&gt;, &lt;BackSpace&gt;, &lt;Tab&gt; 捕获特点ESC键，回车键，tab键\n# &lt;Down&gt;, &lt;Up&gt;, &lt;Left&gt;, &lt;Right&gt; 捕获方向键\n# &lt;B1-Motion&gt; 按下左键并拖拽\n# &lt;KeyPress-a&gt; 按下按键“a”，大小写敏感</code></pre><h4 id=\"输入框\"><a href=\"#输入框\" class=\"headerlink\" title=\"输入框\"></a>输入框</h4><pre><code># -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom quitGui import Quitter\n\nfields = &apos;Name&apos;, &apos;Job&apos;, &apos;Pay&apos;\n\n\ndef fetch(entries):\n    for entry in entries:\n        print(&apos;Input =&gt; %s&apos; % entry.get())  # 获取文本信息\n\n\ndef makeform(root, fields):\n    entries = []\n    for field in fields:\n        row = Frame(root)\n        lab = Label(row, width=5, text=field)\n        ent = Entry(row)\n        row.pack(side=TOP, fill=X)\n        lab.pack(side=LEFT)\n        ent.pack(side=RIGHT, expand=YES, fill=X)\n        entries.append(ent)\n    return entries\n\n\ndef show(entries, popup):\n    fetch(entries)  # 必须在销毁前取出\n    popup.destroy()  # 如果修改了stmt， order， msgs会随之失败\n\n\ndef ask():\n    popup = Toplevel()  # 在模拟对话框窗口中显示表单\n    ents = makeform(popup, fields)\n    Button(popup, text=&apos;OK&apos;, command=(lambda: show(ents, popup))).pack()\n    popup.grab_set()  # 打开的时候，禁用其他窗口\n    popup.focus_set()  # 获取输入的焦点\n    popup.wait_window()  # 在这里等待销毁\n\n\nif __name__ == &apos;__main__&apos;:\n    root = Tk()\n    Button(root, text=&apos;Dialog&apos;, command=ask).pack()\n    root.mainloop()</code></pre><h4 id=\"复选框\"><a href=\"#复选框\" class=\"headerlink\" title=\"复选框\"></a>复选框</h4><pre><code># gui13.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom gui6 import demos\nfrom quitGui import Quitter\n\n\nclass Demo(Frame):\n    def __init__(self, parent=None, **options):\n        Frame.__init__(self, parent, **options)\n        self.pack()\n        self.tools()\n        Label(self, text=&apos;Ckech demos&apos;).pack()\n        self.vars = []\n        for key in demos:\n            var = IntVar()\n            Checkbutton(self, text=key, variable=var, command=demos[key]).pack(side=LEFT)\n            self.vars.append(var)\n\n    def report(self):\n        for var in self.vars:\n            print(var.get())  # 当前开关设置1或者0\n        print()\n\n    def tools(self):\n        frm = Frame(self)\n        frm.pack(side=RIGHT)\n        Button(frm, text=&apos;State&apos;, command=self.report).pack(fill=X)\n        Quitter(frm).pack(fill=X)\n\n\nif __name__ == &apos;__main__&apos;:\n    Demo().mainloop()</code></pre><h4 id=\"单选按钮\"><a href=\"#单选按钮\" class=\"headerlink\" title=\"单选按钮\"></a>单选按钮</h4><pre><code>#gui14.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom gui6 import demos\nfrom quitGui import Quitter\n\n\nclass Demo(Frame):\n    def __init__(self, parent=None, **options):\n        Frame.__init__(self, parent, **options)\n        self.pack()\n        Label(self, text=&apos;Radio demos&apos;).pack(side=TOP)\n        self.var = StringVar()\n        # variable表示单选按钮的变量，相当与html的name标签\n        # value表示单选按钮的变量值，相当与html的value标签\n        for key in demos:\n            Radiobutton(self, text=key, command=self.onPress, variable=self.var, value=key).pack(anchor=NW)\n        self.var.set(key)  # 选中最后一个开始\n        Button(self, text=&apos;State&apos;, command=self.report).pack(fill=X)\n        Quitter(self).pack(fill=X)\n\n    def onPress(self):\n        pick = self.var.get()\n        print(&apos;you pressed&apos;, pick)\n        print(&apos;result: &apos;, demos[pick]())  # 按钮使用返回的值\n\n    def report(self):\n        print(self.var.get())\n\nif __name__ == &apos;__main__&apos;:\n    Demo().mainloop()</code></pre><h4 id=\"标尺滚动条\"><a href=\"#标尺滚动条\" class=\"headerlink\" title=\"标尺滚动条\"></a>标尺滚动条</h4><pre><code># gui16.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom gui6 import demos\nfrom quitGui import Quitter\n\n\nclass Demo(Frame):\n    def __init__(self, parent=None, **options):\n        Frame.__init__(self, parent, **options)\n        self.pack()\n        Label(self, text=&apos;Scale demos&apos;).pack()\n        self.var = IntVar()\n        Scale(self, label=&apos;Pick demo number&apos;,\n              command=self.onMove, variable=self.var,\n              from_=0, to=len(demos)-1).pack()\n        Scale(self, label=&apos;Pick demo number&apos;,  # 标尺的文本\n              command=self.onMove,  # 绑定回调\n              variable=self.var,  # 变量\n              from_=0,   # 标尺最小值\n              to=len(demos) - 1,   # 标尺最大值\n              length = 200,  # 长度\n              tickinterval = 2,   # 每隔几个单位显示标记单位\n              showvalue = YES,  # 显示或隐藏标尺滑动条旁边的当前值\n              orient = &apos;horizontal&apos;  # 横向展示\n              ).pack()\n        Quitter(self).pack(side=RIGHT)\n        Button(self, text=&apos;Run demo&apos;, command=self.onRun).pack(side=LEFT)\n        Button(self, text=&apos;State&apos;, command=self.report).pack(side=RIGHT)\n\n    def onMove(self, value):\n        print(&apos;in onMove&apos;, value)\n\n    def onRun(self):\n        pos = self.var.get()\n        print(&apos;you picked&apos;, pos)\n        demo = list(demos.values())[pos]\n        print(demo())\n\n    def report(self):\n        print(self.var.get())\n\nif __name__ == &apos;__main__&apos;:\n    print(list(demos.keys()))\n    Demo().mainloop()</code></pre><h4 id=\"创建图片\"><a href=\"#创建图片\" class=\"headerlink\" title=\"创建图片\"></a>创建图片</h4><pre><code># gui17.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\n\ngifdir = &apos;./gif/&apos;\nwin = Tk()\nigm = PhotoImage(file=gifdir + &apos;logo.png&apos;)\n\n# 按钮上绑定图片\n# Button(win, image=igm).pack()\n# win.mainloop()\n\n# 创建画布\ncan = Canvas(win)\ncan.pack(fill=BOTH)\ncan.config(width=igm.width() + 4, height=igm.height() + 4)\ncan.create_image(2,  # x坐标\n                 2,  # y坐标\n                 image=igm, anchor=NW)\nwin.mainloop()</code></pre><h3 id=\"按钮随机读取图片\"><a href=\"#按钮随机读取图片\" class=\"headerlink\" title=\"按钮随机读取图片\"></a>按钮随机读取图片</h3><pre><code># gui18.py\n# -*- coding: UTF-8 -*-\nfrom glob import glob\nfrom gui13 import *\nimport random\n\ngifdir = &apos;./gif/&apos;\n\n&quot; 按钮随机读取图片 &quot;\nclass ButtonPicsDemo(Frame):\n    def __init__(self, gifdir=gifdir, parent=None):\n        Frame.__init__(self, parent)\n        self.pack()\n        self.lbl = Label(self, text=&apos;none&apos;, bg=&apos;blue&apos;, fg=&apos;red&apos;)\n        self.pix = Button(self, text=&apos;press me&apos;, command=self.draw, bg=&apos;white&apos;)\n        self.lbl.pack(fill=BOTH)\n        self.pix.pack(pady=10)\n        Demo(self, relief=SUNKEN, bd=2).pack(fill=BOTH)\n        # glob模块， glob方法，返回所有匹配的文件列表\n        files = glob(gifdir + &apos;*.png&apos;)\n        self.images = [(x, PhotoImage(file=x)) for x in files]\n        print(files)\n\n    def draw(self):\n        name, photo = random.choice(self.images)\n        self.lbl.config(text=name)\n        self.pix.config(image=photo)\n\nif __name__ == &apos;__main__&apos;:\n    if __name__ == &apos;__main__&apos;:\n        ButtonPicsDemo().mainloop()</code></pre><h4 id=\"缩略图\"><a href=\"#缩略图\" class=\"headerlink\" title=\"缩略图\"></a>缩略图</h4><pre><code># gui19.py\n# -*- coding: UTF-8 -*-\nimport os\nimport math\nimport PIL\nfrom PIL import Image\nfrom Tkinter import *\n\n\ndef make_thumbs(img_dir, size=(100, 100), subdir=&apos;thumbs&apos;):\n    thumb_dir = os.path.join(img_dir, subdir)\n    if not os.path.exists(thumb_dir):\n        os.mkdir(thumb_dir)\n    thumbs = []\n    for img_file in os.listdir(img_dir):\n        thumb_path = os.path.join(thumb_dir, img_file)\n        if os.path.exists(thumb_path):\n            thumb_obj = PIL.Image.open(thumb_path)\n            thumbs.append((img_file, thumb_obj))\n        else:\n            print(&apos;making&apos;, thumb_path)\n            img_path = os.path.join(img_dir, img_file)\n            try:\n                img_obj = PIL.Image.open(img_path)\n                img_obj.thumbnail(size, PIL.Image.ANTIALIAS)\n                img_obj.save(thumb_path)\n                thumbs.append((img_file, img_obj))\n            except Exception, e:\n                print(&apos;skipping: &apos;, img_path)\n                print e\n    return thumbs\n\n\nclass ViewOne(Toplevel):\n    def __init__(self, img_dir, img_file):\n        Toplevel.__init__(self)\n        self.title(img_file)\n        img_path = os.path.join(img_dir, img_file)\n        img_obj = PhotoImage(file=img_path)\n        Label(self, image=img_obj).pack()\n        print(img_path, img_obj.width(), img_obj.height())\n        self.savephoto = img_obj\n\n\ndef viewer(img_dir, kind=Toplevel, cols=None):\n    win = kind()\n    win.title(&apos;VIEWER: &apos; + img_dir)\n    thumbs = make_thumbs(img_dir)\n    if not cols:\n        # 固定大小 或者N×N\n        cols = int(math.ceil(math.sqrt(len(thumbs))))\n    savephotos = []\n    while thumbs:\n        thumbs_row, thumbs = thumbs[:cols], thumbs[cols:]\n        row = Frame(win)\n        row.pack(fill=BOTH)\n        for(img_file, img_obj) in thumbs_row:\n            size = max(img_obj.size)\n            photo = PhotoImage(file=os.path.join(img_dir, &apos;thumbs&apos;, img_file))\n            link = Button(row, image=photo)\n        handler = lambda savefile=img_file: ViewOne(img_dir, savefile)\n        link.config(command=handler, width=size, height=size)\n        link.pack(side=LEFT, expand=YES)\n        savephotos.append(photo)\n    Button(win, text=&apos;Quit&apos;, command=win.quit, bg=&apos;beige&apos;).pack(fill=X)\n    return win, savephotos\n\nif __name__ == &apos;__main__&apos;:\n    img_dir = len(sys.argv) &gt; 1 and sys.argv[1] or &apos;gif&apos;\n    main, save = viewer(img_dir, kind=Tk)\n    main.mainloop()</code></pre><h3 id=\"创建基础顶级菜单\"><a href=\"#创建基础顶级菜单\" class=\"headerlink\" title=\"创建基础顶级菜单\"></a>创建基础顶级菜单</h3><pre><code># gui20.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom tkMessageBox import *\n\n\ndef not_done():\n    showerror(&apos;Not implemented&apos;, &apos;Not yet available&apos;)\n\n\ndef make_menu(win):\n    top = Menu(win)  # 定义顶级菜单\n    win.config(menu=top)\n    file = Menu(top, tearoff=True)  # 一级菜单 tearoff:设置菜单下的虚线是否显示\n    file.add_command(label=&apos;New...&apos;, command=not_done, underline=0)\n    file.add_command(label=&apos;Open...&apos;, command=not_done, underline=0)\n    file.add_command(label=&apos;Quit...&apos;, command=win.quit,  underline=0)\n    top.add_cascade(label=&apos;File&apos;, menu=file, underline=0)  # 在顶级菜单中添加一级菜单\n\n    edit = Menu(top, tearoff=False)  # 一级菜单\n    edit.add_command(label=&apos;Cut&apos;, command=not_done, underline=0)\n    edit.add_command(label=&apos;Paste&apos;, command=not_done, underline=0)\n    edit.add_separator()  # 添加下划线\n    top.add_cascade(label=&apos;Edit&apos;, menu=edit, underline=0)\n\n    submenu = Menu(edit, tearoff=True)  # 二级菜单\n    submenu.add_command(label=&apos;Spam&apos;, command=win.quit, underline=0)\n    submenu.add_command(label=&apos;Eggs&apos;, command=not_done, underline=0)\n    edit.add_cascade(label=&apos;Stuff&apos;, menu=submenu, underline=0)  # 在一级菜单中添加二级菜单\n\nif __name__ == &apos;__main__&apos;:\n    root = Tk()\n    root.title(&apos;menu_win&apos;)\n    make_menu(root)\n    msg = Label(root, text=&apos;Window menu basic&apos;)\n    msg.pack(expand=YES, fill=BOTH)\n    msg.config(relief=SUNKEN, width=40, height=7, bg=&apos;beige&apos;)\n    root.mainloop()</code></pre><h4 id=\"创建框架级别菜单\"><a href=\"#创建框架级别菜单\" class=\"headerlink\" title=\"创建框架级别菜单\"></a>创建框架级别菜单</h4><pre><code># gui21.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom tkMessageBox import *\n\n\ndef not_done():\n    showerror(&apos;Not implemented&apos;, &apos;Not yet available&apos;)\n\n\ndef make_menu(parent):\n    menu_bar = Frame(parent)\n    menu_bar.pack(side=TOP, fill=X)\n\n    f_button = Menubutton(menu_bar, text=&apos;File&apos;, underline=0)\n    f_button.pack(side=LEFT)\n    file = Menu(f_button)\n    file.add_command(label=&apos;New...&apos;, command=not_done, underline=0)\n    file.add_command(label=&apos;Open...&apos;, command=not_done, underline=0)\n    file.add_command(label=&apos;Quit...&apos;, command=parent.quit,  underline=0)\n    f_button.config(menu=file)\n\n    e_button = Menubutton(menu_bar, text=&apos;Edit&apos;, underline=0)\n    e_button.pack(side=LEFT)\n    edit = Menu(e_button)\n    edit.add_command(label=&apos;Cut&apos;, command=not_done, underline=0)\n    edit.add_command(label=&apos;Paste&apos;, command=not_done, underline=0)\n    edit.add_separator()\n    e_button.config(menu=edit)\n\n    sub_menu = Menu(edit, tearoff=True)\n    sub_menu.add_command(label=&apos;Spam&apos;, command=parent.quit, underline=0)\n    sub_menu.add_command(label=&apos;Eggs&apos;, command=not_done, underline=0)\n    edit.add_cascade(label=&apos;Stuff&apos;, menu=sub_menu, underline=0)\n    return menu_bar\n\n\n\nif __name__ == &apos;__main__&apos;:\n    root = Tk()\n    root.title(&apos;menu_fra&apos;)\n    for i in range(2):\n        mnu = make_menu(root)\n        mnu.config(bd=2, relief=RAISED)\n        Label(root, bg=&apos;black&apos;, height=5, width=25).pack(expand=YES, fill=BOTH)\n    Button(root, text=&apos;Bye&apos;, command=root.quit).pack()\n    root.mainloop()</code></pre><h4 id=\"图片菜单\"><a href=\"#图片菜单\" class=\"headerlink\" title=\"图片菜单\"></a>图片菜单</h4><pre><code># gui22.py\n# -*- coding:UTF-8 -*-\nfrom Tkinter import *\nfrom tkMessageBox import *\n\n\nclass NewMenuDemo(Frame):\n    def __init__(self, parent=None):\n        Frame.__init__(self, parent)\n        self.pack(expand=YES, fill=BOTH)\n        self.create_widgets()\n\n    def create_widgets(self):\n        self.make_menubar()\n        self.make_toolbar()\n        l = Label(self, text=&apos;Menu and Toolbar Demo&apos;)\n        l.config(relief=SUNKEN, width=40, height=10, bg=&apos;white&apos;)\n        l.pack(expand=YES, fill=BOTH)\n\n    def make_toolbar(self, size=(30, 30)):\n        toolbar = Frame(self, cursor=&apos;hand2&apos;, relief=SUNKEN, bd=2)\n        toolbar.pack(side=BOTTOM, fill=X)\n        Button(toolbar, text=&apos;Quit&apos;, command=self.quit).pack(side=RIGHT)\n        photo_files = (&apos;at.png&apos;, &apos;bd.png&apos;, &apos;dk.png&apos;)\n        self.tool_photo_objs = []\n        for file in photo_files:\n            img = PhotoImage(file=&apos;./gif/thumbs/&apos; + file)\n            btn = Button(toolbar, image=img, command=self.greeting)\n            btn.config(bd=5, relief=RIDGE)\n            btn.config(width=size[0], height=size[0])\n            btn.pack(side=LEFT)\n            self.tool_photo_objs.append(img)\n        Button(toolbar, text=&apos;Hello&apos;, command=self.greeting).pack(side=LEFT)\n\n    def make_menubar(self):\n        self.menubar = Menu(self.master)\n        self.master.config(menu=self.menubar)\n        self.file_menu()\n        self.edit_menu()\n        self.image_menu()\n\n    def file_menu(self):\n        pulldown = Menu(self.menubar)\n        pulldown.add_command(label=&apos;OPEN...&apos;, command=self.notdone)\n        pulldown.add_command(label=&apos;QUIT&apos;, command=self.quit)\n        self.menubar.add_cascade(label=&apos;FILE&apos;, underline=0, menu=pulldown)\n\n    def edit_menu(self):\n        pulldown = Menu(self.menubar)\n        pulldown.add_command(label=&apos;PASTE&apos;, command=self.notdone)\n        pulldown.add_command(label=&apos;SPAM&apos;, command=self.greeting)\n        pulldown.add_separator()\n        pulldown.add_command(label=&apos;DELETE&apos;, command=self.greeting)\n        pulldown.entryconfig(4, state=DISABLED)\n        self.menubar.add_cascade(label=&apos;EDIT&apos;, underline=0, menu=pulldown)\n\n    def image_menu(self):\n        photo_files = (&apos;at.png&apos;, &apos;bd.png&apos;, &apos;dk.png&apos;)\n        pulldown = Menu(self.menubar)\n        self.photo_objs = []\n        for file in photo_files:\n            img = PhotoImage(file=&apos;./gif/&apos; + file)\n            pulldown.add_command(image=img, command=self.notdone)\n            self.photo_objs.append(img)\n        self.menubar.add_cascade(label=&apos;IMAGE&apos;, underline=0, menu=pulldown)\n\n    def greeting(self):\n        showinfo(&apos;greeting&apos;, &apos;GREETING&apos;)\n\n    def notdone(self):\n        showerror(&apos;NOT DONE&apos;, &apos;NOT DONE&apos;)\n\n    def quit(self):\n        if askyesno(&apos;Verify quit&apos;, &apos;Sure?&apos;):\n            Frame.quit(self)\n\nif __name__ == &apos;__main__&apos;:\n    NewMenuDemo().mainloop()</code></pre><h4 id=\"滚动条与列表\"><a href=\"#滚动条与列表\" class=\"headerlink\" title=\"滚动条与列表\"></a>滚动条与列表</h4><pre><code># gui23.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\n\n\nclass ScrolledList(Frame):\n    def __init__(self, options, parent=None):\n        Frame.__init__(self, parent)\n        self.pack(expand=YES, fill=BOTH)\n        self.makeWidgets(options)\n\n\n    def handle_list(self, event):\n        index = self.listbox.curselection()  # 鼠标选中的行\n        label = self.listbox.get(index)  # 获取鼠标选中的值\n        self.runCommand(label)  # 打印出值\n\n\n    def makeWidgets(self, options):\n        # sbar = Scrollbar(self, orient=&apos;horizontal&apos;)  # 横向滚动\n        sbar = Scrollbar(self)\n        list = Listbox(self, relief=SUNKEN)\n        sbar.config(command=list.yview)  # 移动滚动条启用回调： 按比例调节列表框的显示，\n        list.config(yscrollcommand=sbar.set)  # 移动列表框启用回调：按比例调节滚动条\n        sbar.pack(side=RIGHT, fill=Y)\n        list.pack(side=LEFT, expand=YES, fill=BOTH)\n        pos = 0\n        for label in options:\n            list.insert(pos, label)\n            pos += 1\n        # selectmode 选择模式SINGLE(单选), BROWSE(默认单选), MULTIPLE(多选), EXTENDED(多选)\n        # 启用多选时， curselection返回列表\n        # 启用单选时， curselection返回字符串\n        list.config(selectmode=EXTENDED, setgrid=1)\n        list.bind(&apos;&lt;Double-1&gt;&apos;, self.handle_list)\n        self.listbox = list\n\n    def runCommand(self, selection):\n        print(&apos;YOU SELECTED:&apos;, selection)\n\n\nif __name__ == &apos;__main__&apos;:\n    options = ((&apos;Lumberjack-%s&apos; % x) for x in range(20))\n    ScrolledList(options).mainloop()</code></pre><h4 id=\"TEXT组件\"><a href=\"#TEXT组件\" class=\"headerlink\" title=\"TEXT组件\"></a>TEXT组件</h4><pre><code>gui24.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\n\n\nclass ScrollText(Frame):\n    def __init__(self, parent=None, text=&apos;&apos;, file=None):\n        Frame.__init__(self, parent)\n        self.pack(expand=YES, fill=BOTH)\n        self.make_widgets()\n        self.set_text(text, file)\n\n    def make_widgets(self):\n        sbar = Scrollbar(self)\n        text = Text(self, relief=SUNKEN)\n        sbar.config(command=text.yview)\n        text.config(yscrollcommand=sbar.set)\n        sbar.pack(side=RIGHT, fill=Y)\n        text.pack(side=LEFT, expand=YES, fill=BOTH)\n        self.text = text\n\n    def set_text(self, text=&apos;&apos;, file=None):\n        if file:\n            text = open(file, &apos;r&apos;).read()\n        # 1.0表示第一行，第0列（行从1开始，列从0开始）\n        # END表示最末一个字符后面第一个位置\n        self.text.delete(&apos;1.0&apos;, END)  # 删除从第一行第0列开始到最后的字符串，即删除全部\n        self.text.insert(&apos;1.0&apos;, text)  # 从第一行第0列开始填充数据\n        # mark_set 设置text标志\n        self.text.mark_set(INSERT, &apos;1.0&apos;)  # 设置将光标设置在文本开始位置\n        # self.text.mark_set(&apos;line_two&apos;, &apos;2.2&apos;)  # 自定义标志位置 可以用mark_unset取消\n        self.text.focus()\n        # TEXT的tag标签\n        # SEL是内置的标签，表示当前选中的文本\n        # text = self.text.get(SEL_FIRST, SEL_LAST)\n        # text = self.text.get(&apos;sel.first&apos;, &apos;sel.last&apos;)\n        # self.text.tag_add(&apos;alltext&apos;, &apos;1.0&apos;, END)  # 选中所有文本\n        # self.text.tag_add(SEL, index1, index2)  # 将一定范围内的文本添加到内建的SEL标签\n        # self.text.tag_remove(SEL, &apos;1.0&apos;, END)  # 将字符串所有字符从SEL标签中删除\n        # self.text.tag_delete(SEL)  # 删除SEL标签\n        # self.text.tag_add(&apos;demo&apos;, &apos;1.5&apos;, &apos;1.7&apos;)\n        # self.text.tag_add(&apos;demo&apos;, &apos;3.0&apos;, &apos;5.7&apos;)\n        # self.text.tag_config(&apos;demo&apos;, background=&apos;purple&apos;)\n        # self.text.tag_config(&apos;demo&apos;, fontground=&apos;white&apos;)\n        # self.text.tag_config(&apos;demo&apos;, font=(&apos;times&apos;, 16, &apos;underline&apos;))\n        # self.text.tag_bind(&apos;demo&apos;, &apos;&lt;Double-1&gt;&apos;, func)\n        # see方法\n        # self.text.see(&apos;1.0&apos;)  # 滚动到第一行第0列\n        # self.text.see(INSERT)  # 滚动到光标插入处\n        # self.text.see(SEL_FIRST)  # 滚动到选中文本第一个字符串\n    def get_text(self):\n        # -1c 表示往回数一个字符串\n        # +1l 表示往前数一行\n        return self.text.get(&apos;1.0&apos;, END + &apos;-1c&apos;)\n\n\nif __name__ == &apos;__main__&apos;:\n    root = Tk()\n    if len(sys.argv) &gt; 1:\n        st = ScrollText(file=sys.argv[1])\n    else:\n        st = ScrollText(text=&apos;Words\\ngo here&apos;)\n\n    def show(event):\n        print(repr(st.get_text()))\n\n    root.bind(&apos;&lt;Key-Escape&gt;&apos;, show)\n    root.mainloop()</code></pre><h4 id=\"简单的文本编辑器\"><a href=\"#简单的文本编辑器\" class=\"headerlink\" title=\"简单的文本编辑器\"></a>简单的文本编辑器</h4><pre><code># gui25.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom tkSimpleDialog import askstring\nfrom tkFileDialog import asksaveasfilename\nfrom quitGui import Quitter\nfrom gui24 import ScrollText\n\n\nclass SimpleEditor(ScrollText):\n    def __init__(self, parent=None, file=None):\n        frm = Frame(parent)\n        frm.pack(fill=X)\n        Button(frm, text=&apos;Save&apos;, command=self.on_save).pack(side=LEFT)\n        Button(frm, text=&apos;Cut&apos;, command=self.on_cut).pack(side=LEFT)\n        Button(frm, text=&apos;Paste&apos;, command=self.on_paste).pack(side=LEFT)\n        Button(frm, text=&apos;Find&apos;, command=self.on_find).pack(side=LEFT)\n        Quitter(frm).pack(side=LEFT)\n        ScrollText.__init__(self, parent, file=file)\n        self.text.config(font=(&apos;courier&apos;, 9, &apos;normal&apos;))\n\n    def on_save(self):\n        filename = asksaveasfilename()\n        if filename:\n            alltext = self.get_text()\n            open(filename, &apos;w&apos;).write(alltext)\n\n\n    def on_cut(self):\n        text = self.text.get(SEL_FIRST, SEL_LAST)\n        self.text.delete(SEL_FIRST, SEL_LAST)\n        self.clipboard_clear()\n        self.clipboard_append(text)\n\n\n    def on_paste(self):\n        try:\n            text = self.selection_get(selection=&apos;CLIPBOARD&apos;)\n            self.text.insert(INSERT, text)\n        except TclError:\n            pass\n\n\n    def on_find(self):\n        target = askstring(&apos;SimpleEdit&apos;, &apos;Search string?&apos;)\n        if target:\n            where = self.text.search(target, INSERT, END)\n            if where:\n                print(where)\n                pastit = where + (&apos;+%dc&apos; % len(target))\n                self.text.tag_remove(SEL, &apos;1.0&apos;, END)\n                self.text.tag_add(SEL, where, pastit)\n                self.text.mark_set(INSERT, pastit)\n                self.text.see(INSERT)\n                self.text.focus()\n\nif __name__ == &apos;__main__&apos;:\n    if len(sys.argv) &gt; 1:\n        SimpleEditor(file=sys.argv[1]).mainloop()\n    else:\n        SimpleEditor().mainloop()</code></pre><h4 id=\"创建基础画布\"><a href=\"#创建基础画布\" class=\"headerlink\" title=\"创建基础画布\"></a>创建基础画布</h4><pre><code># gui26.py\n# -*- coding: UTF-8 -*-\n\nfrom Tkinter import *\ncanvas = Canvas(width=525, height=300, bg=&apos;white&apos;)\ncanvas.pack(expand=YES, fill=BOTH)\n\ncanvas.create_line(100, 100, 200, 200)\ncanvas.create_line(100, 200, 200, 300)\nfor i in range(1, 20, 2):\n    canvas.create_line(0, i, 50, i)\ncanvas.create_oval(20, 20, 300, 100, width=10, fill=&apos;yellow&apos;)\nd = {1:PIESLICE,2:CHORD,3:ARC}\nfor i in d:\n    canvas.create_arc(\n        (10,10 + 60*i,110,110 + 60*i),\n        style=d[i],   #指定样式\n        start=30,     #指定起始角度\n        extent=30     #指定角度偏移量\n        )\ncanvas.create_arc(0, 0, 100, 200, fill=&apos;black&apos;)\ncanvas.create_rectangle(200, 200, 300, 300, width=5, fill=&apos;red&apos;)\ncanvas.create_line(0, 300, 150, 150, width=10, fill=&apos;green&apos;)\n\nphoto = PhotoImage(file=&apos;./gif/lightmachine.png&apos;)\ncanvas.create_image(325,25, image=photo, anchor=NW)\n\nwidget = Label(canvas, text=&apos;Spam&apos;, fg=&apos;white&apos;, bg=&apos;black&apos;)\nwidget.pack()\ncanvas.create_window(100, 100, window=widget)\ncanvas.create_text(100, 280, text=&apos;CLOUD CLONE CORP.&apos;)\n\n# id = canvas.create_line(fromX, fromY, toX, toY)  # 创建直线\n# id = canvas.create_oval(fromX, fromY, toX, toY) # 创建椭圆\n# id = canvas.create_arc(fromX, fromY, toX, toY)  # 创建扇形\n# id =canvas.create_rectangle(fromX, fromY, toX, toY)  # 创建矩形\n# canvas.move(id, offsetX, offsetY)  # 移动对象\n# canvas.delete(id)  # 删除对象\n# canvas.tkraise(id)  # 将对象移动到前端\n# canvas.lower(id)  # 将对象移动到底部\n# canvas.itemconfig(id, fill=&apos;red&apos;)  # 修改对象属性\n\n# 画布标签\n# canvas.create_line(fromX, fromY, toX, toY, tag=&apos;bubbles&apos;) \n# canvas.create_line(fromX, fromY, toX, toY, tag=&apos;bubbles&apos;) \n# id = canvas.create_line(fromX, fromY, toX, toY)\n# canvas.addtag_withtag(&apos;bubbles&apos;, id)\n# canvas.move(&apos;bubbles&apos;, diffX, diffY)\nmainloop()</code></pre><h4 id=\"canvas与滚动条\"><a href=\"#canvas与滚动条\" class=\"headerlink\" title=\"canvas与滚动条\"></a>canvas与滚动条</h4><pre><code># gui27.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\n\nclass ScrolledCanvas(Frame):\n    def __init__(self, parent=None, color=&apos;brown&apos;):\n        Frame.__init__(self, parent)\n        self.pack(expand=YES, fill=BOTH)\n        canv = Canvas(self, bg=color, relief=SUNKEN)\n        canv.config(width=300, height=200)\n        canv.config(scrollregion=(0, 0, 300, 1000))\n        canv.config(highlightthickness=0)\n\n        sbar = Scrollbar(self)\n        sbar.config(command=canv.yview)\n        canv.config(yscrollcommand=sbar.set)\n        sbar.pack(side=RIGHT, fill=Y)\n        canv.pack(side=LEFT, expand=YES, fill=BOTH)\n\n        self.fillContent(canv)\n        canv.bind(&apos;&lt;Double-1&gt;&apos;, self.onDoubleClick)\n        self.canvas = canv\n\n    def fillContent(self, canv):\n        for i in range(10):\n            canv.create_text(150, 50+(i*100), text=&apos;spam&apos;+str(i), fill=&apos;beige&apos;)\n\n    def onDoubleClick(self, event):\n        print(event.x, event.y)\n        print(self.canvas.canvasx(event.x), self.canvas.canvasy(event.y))\n\nif __name__ == &apos;__main__&apos;:\n    ScrolledCanvas().mainloop()</code></pre><h4 id=\"canvas绑定事件\"><a href=\"#canvas绑定事件\" class=\"headerlink\" title=\"canvas绑定事件\"></a>canvas绑定事件</h4><pre><code># gui28.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\ntrace = False\n\nclass CanvasEventDemo:\n    def __init__(self, parent=None):\n        canvas = Canvas(width=300, height=300, bg=&apos;beige&apos;)\n        canvas.pack()\n        canvas.bind(&apos;&lt;ButtonPress-1&gt;&apos;, self.on_start)\n        canvas.bind(&apos;&lt;B1-Motion&gt;&apos;, self.on_grow)\n        canvas.bind(&apos;&lt;Double-1&gt;&apos;, self.on_clear)\n        canvas.bind(&apos;&lt;ButtonPress-3&gt;&apos;, self.on_move)\n        self.canvas = canvas\n        self.drawn = None\n        self.kinds = [canvas.create_oval, canvas.create_rectangle]\n\n    def on_start(self, event):\n        self.shape =self.kinds[0]\n        self.kinds = self.kinds[1:] + self.kinds[:1]\n        self.start = event\n        self.drawn = None\n\n    def on_grow(self, event):\n        canvas = event.widget\n        if self.drawn:\n            canvas.delete(self.drawn)\n        object_id = self.shape(self.start.x, self.start.y, event.x, event.y)\n        if trace:\n            print(object_id)\n        self.drawn = object_id\n\n    def on_clear(self, event):\n        event.widget.delete(&apos;all&apos;)\n\n\n    def on_move(self, event):\n        if self.drawn:\n            if trace:\n                print(self.drawn)\n            canvas = event.widget\n            diffx, diffy = (event.x - self.start.x), (event.y - self.start.y)\n            canvas.move(self.drawn, diffx, diffy)\n            self.start = event\n\nif __name__ == &apos;__main__&apos;:\n    CanvasEventDemo()\n    mainloop()</code></pre><h4 id=\"grid布局和pack布局实现自动扩展\"><a href=\"#grid布局和pack布局实现自动扩展\" class=\"headerlink\" title=\"grid布局和pack布局实现自动扩展\"></a>grid布局和pack布局实现自动扩展</h4><pre><code># gui29.py\n# -*- coding: UTF-8 -*-\n\nfrom Tkinter import *\ncolors = [&apos;red&apos;, &apos;green&apos;, &apos;orange&apos;, &apos;white&apos;, &apos;yellow&apos;, &apos;blue&apos;]\n\ndef gridbox(root):\n    Label(root, text=&apos;GRID&apos;).grid(columnspan=2)  # 跨两列\n    row = 1\n    for color in colors:\n        lab = Label(root, text=color, relief=RIDGE, width=25)\n        ent = Entry(root, bg=color, relief=SUNKEN, width=50)\n        lab.grid(row=row, column=0, sticky=NSEW)  # 向4个方向扩展\n        ent.grid(row=row, column=1, sticky=NSEW)\n        root.rowconfigure(row, weight=1)  # 循环行自动扩展\n        row += 1\n    root.columnconfigure(0, weight=1)  # 第一列自动扩展\n    root.columnconfigure(1, weight=1)  # 第二列自动扩展\n\ndef packbox(root):\n    Label(root, text=&apos;PACK&apos;).pack()\n    for color in colors:\n        row = Frame(root)\n        lab = Label(row, text=color, relief=RIDGE, width=25)\n        ent = Entry(row, bg=color, relief=SUNKEN, width=50)\n        row.pack(side=TOP, expand=YES, fill=BOTH)\n        lab.pack(side=LEFT, expand=YES, fill=BOTH)\n        ent.pack(side=RIGHT, expand=YES, fill=BOTH)\n\nif __name__ == &apos;__main__&apos;:\n    root = Tk()\n    gridbox(Toplevel(root))\n    packbox(Toplevel(root))\n    Button(root, text=&apos;Quit&apos;, command=root.quit).pack()\n    mainloop()</code></pre><h3 id=\"PIL：Python-Imaging-Library\"><a href=\"#PIL：Python-Imaging-Library\" class=\"headerlink\" title=\"PIL：Python Imaging Library\"></a>PIL：Python Imaging Library</h3><h4 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h4><pre><code>sudo apt-get install python-imaging\n或者\nsudo easy_install PIL</code></pre><p>window系统选择</p>\n<pre><code>pip install Pillow</code></pre><p>图像操作</p>\n<pre><code>import Image\n# 打开一个jpg图像文件，注意路径要改成你自己的:\nim = Image.open(&apos;/Users/michael/test.jpg&apos;)\n# 获得图像尺寸:\nw, h = im.size\n# 缩放到50%:\nim.thumbnail((w//2, h//2))\n# 把缩放后的图像用jpeg格式保存:\nim.save(&apos;/Users/michael/thumbnail.jpg&apos;, &apos;jpeg&apos;)</code></pre><p>模糊效果</p>\n<pre><code>import Image, ImageFilter\n\nim = Image.open(&apos;/Users/hanchang/test.jpg&apos;)\nim2 = im.filter(ImageFilter.BLUR)\nim2.save(&apos;/Users/hanchang/blur.jpg&apos;, &apos;jpeg&apos;)</code></pre><p>自定义图像验证码</p>\n<pre><code>import Image, ImageDraw, ImageFont, ImageFilter\nimport random\n# 随机字母:\ndef rndChar():\n    return chr(random.randint(65, 90))\n\n# 随机颜色1:\ndef rndColor():\n    return (random.randint(64, 255), random.randint(64, 255), random.randint(64, 255))\n\n# 随机颜色2:\ndef rndColor2():\n    return (random.randint(32, 127), random.randint(32, 127), random.randint(32, 127))\n\n# 240 x 60:\nwidth = 60 * 4\nheight = 60\nimage = Image.new(&apos;RGB&apos;, (width, height), (255, 255, 255))\n# 创建Font对象:\nfont = ImageFont.truetype(&apos;Arial.ttf&apos;, 36)\n# 创建Draw对象:\ndraw = ImageDraw.Draw(image)\n# 填充每个像素:\nfor x in range(width):\n    for y in range(height):\n        draw.point((x, y), fill=rndColor())\n# 输出文字:\nfor t in range(4):\n    draw.text((60 * t + 10, 10), rndChar(), font=font, fill=rndColor2())\n# 模糊:\nimage = image.filter(ImageFilter.BLUR)\nimage.save(&apos;code.jpg&apos;, &apos;jpeg&apos;);\n自定义字符串生成图片</code></pre><p><code>from PIL import Image,ImageDraw,ImageFont,ImageOps &lt;h1&gt;生成图片&lt;/h1&gt; def create\\_image(str, line, name, dir): img\\_size = (400, (line*20) + 10) img\\_mode = &#39;RGB&#39; img\\_font = ImageFont.truetype(&#39;UbuntuMono-R.ttf&#39;, 14) img\\_bg = &#39;#FFF&#39; img\\_fg = &#39;#000&#39; img = Image.new(mode=img\\_mode, size=img\\_size, color=img\\_bg) draw = ImageDraw.Draw(img) draw.text((10, 10), str, fill=img\\_fg, font=img_font) img.save( dir + name + &#39;.png&#39;, &#39;png&#39;)</code></p>\n","site":{"data":{}},"excerpt":"","more":"<p>python基础环境</p>\n<pre><code>sudo apt-get install python\nsudo apt-get install python-pip</code></pre><p>Tkinter安装</p>\n<pre><code>sudo apt-get install python-tk</code></pre><p>配置组件外观</p>\n<pre><code>#!/usr/bin/python\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nroot = Tk()\n# 定义图标\nif sys.platform == &apos;win32&apos;:\n    root.iconbitmap(&apos;favicon.ico&apos;)\nelse:\n    icon = PhotoImage(file=&apos;phone.gif&apos;)\n    root.tk.call(&apos;wm&apos;, &apos;iconphoto&apos;, root._w, icon)\n# 定义字体，字号，类型\nlabel_font = (&apos;Ubuntu&apos;, 20, &apos;bold underline italic&apos;)\n# 创建组件\nwidget = Label(root, text=&apos;Hello,云克隆&apos;, padx=100, pady=20)\n# 配置组件字体\nwidget.config(font=label_font)\n# 组件宽，高\nwidget.config(height=3, width=20)\n# 组件背景颜色\nwidget.config(bg=&apos;#FF0&apos;)\n# 组件字体颜色\nwidget.config(fg=&apos;#F0F&apos;)\n# 组件边框宽度\nwidget.config(bd=3)\n# 组件边框外形, FLAT扁平, SUNKEN凹陷, RAISED凸起, GROOVE凹槽, SOLID加粗, RIDGE脊状,\nwidget.config(relief=SUNKEN)\n# 组件鼠标手势, &apos;gumby&apos;, &apos;watch&apos;, &apos;pencil&apos;, &apos;crdss&apos;, hand2\nwidget.config(cursor=&apos;gumby&apos;)\n# 组件状态, DISABLE禁用, NORMAL正常, READONLY只读\nwidget.config(state=DISABLED)\n# 布置组件\n# expand设置是否可以扩展，fill表示随父组件扩展方向，可以设置BOTH, X, Y\n# 设置组件padding值\n# side表示按钮布置窗口的位置\nwidget.pack(expand=True, fill=X, padx=10, pady=50, side=LEFT)\nroot.mainloop()</code></pre><h4 id=\"标准弹出框\"><a href=\"#标准弹出框\" class=\"headerlink\" title=\"标准弹出框\"></a>标准弹出框</h4><pre><code># -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom tkMessageBox import *\n# python3\n# from Tkinter.messagebox import *\ndef callback():\n    if askyesno(&apos;Verify&apos;, &apos;Do you ready want to quit?&apos;):\n        showwarning(&apos;Yes&apos;, &apos;Quit not yet&apos;)\n    else:\n        showinfo(&apos;No&apos;, &apos;Quit has been cancelled&apos;)\n\nerrmsg = &apos;Sorry, no spam allowed&apos;\nButton(None, text=&apos;Quit&apos;, command=callback).pack(fill=X)\nButton(None, text=&apos;spam&apos;, command=(lambda: showerror(&apos;spam&apos;, errmsg))).pack(fill=X)\nmainloop()</code></pre><h4 id=\"常见弹框\"><a href=\"#常见弹框\" class=\"headerlink\" title=\"常见弹框\"></a>常见弹框</h4><pre><code># gui6.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom tkMessageBox import *\nfrom tkFileDialog import *\nfrom tkColorChooser import *\nfrom tkSimpleDialog import *\n\n\ndemos = {\n    &apos;Open&apos;: askopenfilename,\n    &apos;Color&apos;: askcolor,\n    &apos;Query&apos;: lambda: askquestion(&apos;Warning&apos;, &apos;You typed &quot;rm *&quot;\\nconfirm?&apos;),\n    &apos;Error&apos;: lambda: showerror(&apos;Error!&apos;, &apos;He is dead&apos;),\n    &apos;Input&apos;: lambda: askfloat(&apos;Entry&apos;, &apos;Enter credit card number&apos;)\n}\n\n\nclass Demo(Frame):\n    def __init__(self, parent=None, **options):\n        Frame.__init__(self, parent, **options)\n        self.pack()\n        Label(self, text=&apos;Basic demos&apos;).pack()\n        for (key, value) in demos.items():\n            Button(self, text=key, command=value).pack(side=TOP, fill=BOTH)\n\nif __name__ == &apos;__main__&apos;:\n    Demo().mainloop()\n自定义弹框\n\n# -*- coding: UTF-8 -*-\nimport sys\nfrom Tkinter import *\nmakemodal = (len(sys.argv) &gt; 1)\n\ndef dialog():\n    win = Toplevel()\n    Label(win, text=&apos;Hard drive reformatted!&apos;).pack()\n    Button(win, text=&apos;OK&apos;, command=win.destroy).pack()\n    if makemodal:\n        # 获取输入的焦点\n        win.focus_set()\n        # 打开的时候，禁用其他窗口\n        win.grab_set()\n        # 在win销毁之前，继续等待\n        win.wait_window()\n    print &apos;dialog exit&apos;\n\nroot = Tk()\nButton(root, text=&apos;popup&apos;, command=dialog).pack()\nroot.mainloop()</code></pre><h4 id=\"绑定事件\"><a href=\"#绑定事件\" class=\"headerlink\" title=\"绑定事件\"></a>绑定事件</h4><pre><code># -*- coding: UTF-8 -*-\nfrom Tkinter import *\n\n\ndef showPosEvent(event):\n    print(&apos;Widget=%s, X=%s, Y=%s&apos; % (event.widget, event.x, event.y))\n\n\ndef showAllEvent(event):\n    print(event)\n    for attr in dir(event):\n        if not attr.startswith(&apos;__&apos;):\n            print(attr, &apos;=&gt;&apos;, getattr(event, attr))\n\n\ndef onKeyPress(event):\n    print(&apos;Got key press: &apos;, event.char)\n\n\ndef onArrowKey(event):\n    print(&apos;Got up arrow key press&apos;)\n\n\ndef onReturnKey(event):\n    print(&apos;Got return key press&apos;)\n\n\ndef onLeftClick(event):\n    print(&apos;Got left mouse button click: &apos;)\n    showPosEvent(event)\n\n\ndef onRightClick(event):\n    print(&apos;Got right mouse button click: &apos;)\n    showPosEvent(event)\n\n\ndef onMiddleClick(event):\n    print(&apos;Got middle mouse button click: &apos;)\n    showPosEvent(event)\n    showAllEvent(event)\n\n\ndef onLeftDrag(event):\n    print(&apos;Got left mouse drag click: &apos;)\n    showPosEvent(event)\n\n\ndef onDoubleLeftClick(event):\n    print(&apos;Got double left mouse click: &apos;)\n    showPosEvent(event)\n    tkroot.quit()\n\n\ntkroot = Tk()\nlabelfont = (&apos;courier&apos;, 20, &apos;bold&apos;)\nwidget = Label(tkroot, text=&apos;Hello bind world&apos;)\nwidget.config(bg=&apos;red&apos;, font=labelfont)\nwidget.config(height=5, width=20)\nwidget.pack(expand=YES, fill=BOTH)\n# 绑定单击左键\nwidget.bind(&apos;&lt;Button-1&gt;&apos;, onLeftClick)\n# 绑定单击右键\nwidget.bind(&apos;&lt;Button-3&gt;&apos;, onRightClick)\n# 绑定单击中键\nwidget.bind(&apos;&lt;Button-2&gt;&apos;, onMiddleClick)\n# 绑定双击左键\nwidget.bind(&apos;&lt;Double-1&gt;&apos;, onDoubleLeftClick)\n# 绑定拖拽 B1表示点击左键，Motion表示拖拽\nwidget.bind(&apos;&lt;B1-Motion&gt;&apos;, onLeftDrag)\n# 绑定键盘按键\nwidget.bind(&apos;&lt;KeyPress&gt;&apos;, onKeyPress)\n# 绑定按下箭头键\nwidget.bind(&apos;&lt;Up&gt;&apos;, onArrowKey)\n# 绑定回车，返回键\nwidget.bind(&apos;&lt;Return&gt;&apos;, onReturnKey)\nwidget.focus()\ntkroot.title(&apos;CLICK ME&apos;)\ntkroot.mainloop()\n\n# &lt;ButtonPress&gt; 按下按钮\n# &lt;ButtonRelease&gt; 松开按钮\n# &lt;Motion&gt; 鼠标指针移动\n# &lt;Configure&gt; 窗口大小，位置改变时候\n# &lt;Destroy&gt; 销毁窗口\n# &lt;FocusIn&gt; 获取焦点\n# &lt;FocusOut&gt; 失去焦点\n# &lt;Map&gt; 窗口打开\n# &lt;Unmap&gt; 窗口最小化\n# &lt;Escape&gt;, &lt;BackSpace&gt;, &lt;Tab&gt; 捕获特点ESC键，回车键，tab键\n# &lt;Down&gt;, &lt;Up&gt;, &lt;Left&gt;, &lt;Right&gt; 捕获方向键\n# &lt;B1-Motion&gt; 按下左键并拖拽\n# &lt;KeyPress-a&gt; 按下按键“a”，大小写敏感</code></pre><h4 id=\"输入框\"><a href=\"#输入框\" class=\"headerlink\" title=\"输入框\"></a>输入框</h4><pre><code># -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom quitGui import Quitter\n\nfields = &apos;Name&apos;, &apos;Job&apos;, &apos;Pay&apos;\n\n\ndef fetch(entries):\n    for entry in entries:\n        print(&apos;Input =&gt; %s&apos; % entry.get())  # 获取文本信息\n\n\ndef makeform(root, fields):\n    entries = []\n    for field in fields:\n        row = Frame(root)\n        lab = Label(row, width=5, text=field)\n        ent = Entry(row)\n        row.pack(side=TOP, fill=X)\n        lab.pack(side=LEFT)\n        ent.pack(side=RIGHT, expand=YES, fill=X)\n        entries.append(ent)\n    return entries\n\n\ndef show(entries, popup):\n    fetch(entries)  # 必须在销毁前取出\n    popup.destroy()  # 如果修改了stmt， order， msgs会随之失败\n\n\ndef ask():\n    popup = Toplevel()  # 在模拟对话框窗口中显示表单\n    ents = makeform(popup, fields)\n    Button(popup, text=&apos;OK&apos;, command=(lambda: show(ents, popup))).pack()\n    popup.grab_set()  # 打开的时候，禁用其他窗口\n    popup.focus_set()  # 获取输入的焦点\n    popup.wait_window()  # 在这里等待销毁\n\n\nif __name__ == &apos;__main__&apos;:\n    root = Tk()\n    Button(root, text=&apos;Dialog&apos;, command=ask).pack()\n    root.mainloop()</code></pre><h4 id=\"复选框\"><a href=\"#复选框\" class=\"headerlink\" title=\"复选框\"></a>复选框</h4><pre><code># gui13.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom gui6 import demos\nfrom quitGui import Quitter\n\n\nclass Demo(Frame):\n    def __init__(self, parent=None, **options):\n        Frame.__init__(self, parent, **options)\n        self.pack()\n        self.tools()\n        Label(self, text=&apos;Ckech demos&apos;).pack()\n        self.vars = []\n        for key in demos:\n            var = IntVar()\n            Checkbutton(self, text=key, variable=var, command=demos[key]).pack(side=LEFT)\n            self.vars.append(var)\n\n    def report(self):\n        for var in self.vars:\n            print(var.get())  # 当前开关设置1或者0\n        print()\n\n    def tools(self):\n        frm = Frame(self)\n        frm.pack(side=RIGHT)\n        Button(frm, text=&apos;State&apos;, command=self.report).pack(fill=X)\n        Quitter(frm).pack(fill=X)\n\n\nif __name__ == &apos;__main__&apos;:\n    Demo().mainloop()</code></pre><h4 id=\"单选按钮\"><a href=\"#单选按钮\" class=\"headerlink\" title=\"单选按钮\"></a>单选按钮</h4><pre><code>#gui14.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom gui6 import demos\nfrom quitGui import Quitter\n\n\nclass Demo(Frame):\n    def __init__(self, parent=None, **options):\n        Frame.__init__(self, parent, **options)\n        self.pack()\n        Label(self, text=&apos;Radio demos&apos;).pack(side=TOP)\n        self.var = StringVar()\n        # variable表示单选按钮的变量，相当与html的name标签\n        # value表示单选按钮的变量值，相当与html的value标签\n        for key in demos:\n            Radiobutton(self, text=key, command=self.onPress, variable=self.var, value=key).pack(anchor=NW)\n        self.var.set(key)  # 选中最后一个开始\n        Button(self, text=&apos;State&apos;, command=self.report).pack(fill=X)\n        Quitter(self).pack(fill=X)\n\n    def onPress(self):\n        pick = self.var.get()\n        print(&apos;you pressed&apos;, pick)\n        print(&apos;result: &apos;, demos[pick]())  # 按钮使用返回的值\n\n    def report(self):\n        print(self.var.get())\n\nif __name__ == &apos;__main__&apos;:\n    Demo().mainloop()</code></pre><h4 id=\"标尺滚动条\"><a href=\"#标尺滚动条\" class=\"headerlink\" title=\"标尺滚动条\"></a>标尺滚动条</h4><pre><code># gui16.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom gui6 import demos\nfrom quitGui import Quitter\n\n\nclass Demo(Frame):\n    def __init__(self, parent=None, **options):\n        Frame.__init__(self, parent, **options)\n        self.pack()\n        Label(self, text=&apos;Scale demos&apos;).pack()\n        self.var = IntVar()\n        Scale(self, label=&apos;Pick demo number&apos;,\n              command=self.onMove, variable=self.var,\n              from_=0, to=len(demos)-1).pack()\n        Scale(self, label=&apos;Pick demo number&apos;,  # 标尺的文本\n              command=self.onMove,  # 绑定回调\n              variable=self.var,  # 变量\n              from_=0,   # 标尺最小值\n              to=len(demos) - 1,   # 标尺最大值\n              length = 200,  # 长度\n              tickinterval = 2,   # 每隔几个单位显示标记单位\n              showvalue = YES,  # 显示或隐藏标尺滑动条旁边的当前值\n              orient = &apos;horizontal&apos;  # 横向展示\n              ).pack()\n        Quitter(self).pack(side=RIGHT)\n        Button(self, text=&apos;Run demo&apos;, command=self.onRun).pack(side=LEFT)\n        Button(self, text=&apos;State&apos;, command=self.report).pack(side=RIGHT)\n\n    def onMove(self, value):\n        print(&apos;in onMove&apos;, value)\n\n    def onRun(self):\n        pos = self.var.get()\n        print(&apos;you picked&apos;, pos)\n        demo = list(demos.values())[pos]\n        print(demo())\n\n    def report(self):\n        print(self.var.get())\n\nif __name__ == &apos;__main__&apos;:\n    print(list(demos.keys()))\n    Demo().mainloop()</code></pre><h4 id=\"创建图片\"><a href=\"#创建图片\" class=\"headerlink\" title=\"创建图片\"></a>创建图片</h4><pre><code># gui17.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\n\ngifdir = &apos;./gif/&apos;\nwin = Tk()\nigm = PhotoImage(file=gifdir + &apos;logo.png&apos;)\n\n# 按钮上绑定图片\n# Button(win, image=igm).pack()\n# win.mainloop()\n\n# 创建画布\ncan = Canvas(win)\ncan.pack(fill=BOTH)\ncan.config(width=igm.width() + 4, height=igm.height() + 4)\ncan.create_image(2,  # x坐标\n                 2,  # y坐标\n                 image=igm, anchor=NW)\nwin.mainloop()</code></pre><h3 id=\"按钮随机读取图片\"><a href=\"#按钮随机读取图片\" class=\"headerlink\" title=\"按钮随机读取图片\"></a>按钮随机读取图片</h3><pre><code># gui18.py\n# -*- coding: UTF-8 -*-\nfrom glob import glob\nfrom gui13 import *\nimport random\n\ngifdir = &apos;./gif/&apos;\n\n&quot; 按钮随机读取图片 &quot;\nclass ButtonPicsDemo(Frame):\n    def __init__(self, gifdir=gifdir, parent=None):\n        Frame.__init__(self, parent)\n        self.pack()\n        self.lbl = Label(self, text=&apos;none&apos;, bg=&apos;blue&apos;, fg=&apos;red&apos;)\n        self.pix = Button(self, text=&apos;press me&apos;, command=self.draw, bg=&apos;white&apos;)\n        self.lbl.pack(fill=BOTH)\n        self.pix.pack(pady=10)\n        Demo(self, relief=SUNKEN, bd=2).pack(fill=BOTH)\n        # glob模块， glob方法，返回所有匹配的文件列表\n        files = glob(gifdir + &apos;*.png&apos;)\n        self.images = [(x, PhotoImage(file=x)) for x in files]\n        print(files)\n\n    def draw(self):\n        name, photo = random.choice(self.images)\n        self.lbl.config(text=name)\n        self.pix.config(image=photo)\n\nif __name__ == &apos;__main__&apos;:\n    if __name__ == &apos;__main__&apos;:\n        ButtonPicsDemo().mainloop()</code></pre><h4 id=\"缩略图\"><a href=\"#缩略图\" class=\"headerlink\" title=\"缩略图\"></a>缩略图</h4><pre><code># gui19.py\n# -*- coding: UTF-8 -*-\nimport os\nimport math\nimport PIL\nfrom PIL import Image\nfrom Tkinter import *\n\n\ndef make_thumbs(img_dir, size=(100, 100), subdir=&apos;thumbs&apos;):\n    thumb_dir = os.path.join(img_dir, subdir)\n    if not os.path.exists(thumb_dir):\n        os.mkdir(thumb_dir)\n    thumbs = []\n    for img_file in os.listdir(img_dir):\n        thumb_path = os.path.join(thumb_dir, img_file)\n        if os.path.exists(thumb_path):\n            thumb_obj = PIL.Image.open(thumb_path)\n            thumbs.append((img_file, thumb_obj))\n        else:\n            print(&apos;making&apos;, thumb_path)\n            img_path = os.path.join(img_dir, img_file)\n            try:\n                img_obj = PIL.Image.open(img_path)\n                img_obj.thumbnail(size, PIL.Image.ANTIALIAS)\n                img_obj.save(thumb_path)\n                thumbs.append((img_file, img_obj))\n            except Exception, e:\n                print(&apos;skipping: &apos;, img_path)\n                print e\n    return thumbs\n\n\nclass ViewOne(Toplevel):\n    def __init__(self, img_dir, img_file):\n        Toplevel.__init__(self)\n        self.title(img_file)\n        img_path = os.path.join(img_dir, img_file)\n        img_obj = PhotoImage(file=img_path)\n        Label(self, image=img_obj).pack()\n        print(img_path, img_obj.width(), img_obj.height())\n        self.savephoto = img_obj\n\n\ndef viewer(img_dir, kind=Toplevel, cols=None):\n    win = kind()\n    win.title(&apos;VIEWER: &apos; + img_dir)\n    thumbs = make_thumbs(img_dir)\n    if not cols:\n        # 固定大小 或者N×N\n        cols = int(math.ceil(math.sqrt(len(thumbs))))\n    savephotos = []\n    while thumbs:\n        thumbs_row, thumbs = thumbs[:cols], thumbs[cols:]\n        row = Frame(win)\n        row.pack(fill=BOTH)\n        for(img_file, img_obj) in thumbs_row:\n            size = max(img_obj.size)\n            photo = PhotoImage(file=os.path.join(img_dir, &apos;thumbs&apos;, img_file))\n            link = Button(row, image=photo)\n        handler = lambda savefile=img_file: ViewOne(img_dir, savefile)\n        link.config(command=handler, width=size, height=size)\n        link.pack(side=LEFT, expand=YES)\n        savephotos.append(photo)\n    Button(win, text=&apos;Quit&apos;, command=win.quit, bg=&apos;beige&apos;).pack(fill=X)\n    return win, savephotos\n\nif __name__ == &apos;__main__&apos;:\n    img_dir = len(sys.argv) &gt; 1 and sys.argv[1] or &apos;gif&apos;\n    main, save = viewer(img_dir, kind=Tk)\n    main.mainloop()</code></pre><h3 id=\"创建基础顶级菜单\"><a href=\"#创建基础顶级菜单\" class=\"headerlink\" title=\"创建基础顶级菜单\"></a>创建基础顶级菜单</h3><pre><code># gui20.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom tkMessageBox import *\n\n\ndef not_done():\n    showerror(&apos;Not implemented&apos;, &apos;Not yet available&apos;)\n\n\ndef make_menu(win):\n    top = Menu(win)  # 定义顶级菜单\n    win.config(menu=top)\n    file = Menu(top, tearoff=True)  # 一级菜单 tearoff:设置菜单下的虚线是否显示\n    file.add_command(label=&apos;New...&apos;, command=not_done, underline=0)\n    file.add_command(label=&apos;Open...&apos;, command=not_done, underline=0)\n    file.add_command(label=&apos;Quit...&apos;, command=win.quit,  underline=0)\n    top.add_cascade(label=&apos;File&apos;, menu=file, underline=0)  # 在顶级菜单中添加一级菜单\n\n    edit = Menu(top, tearoff=False)  # 一级菜单\n    edit.add_command(label=&apos;Cut&apos;, command=not_done, underline=0)\n    edit.add_command(label=&apos;Paste&apos;, command=not_done, underline=0)\n    edit.add_separator()  # 添加下划线\n    top.add_cascade(label=&apos;Edit&apos;, menu=edit, underline=0)\n\n    submenu = Menu(edit, tearoff=True)  # 二级菜单\n    submenu.add_command(label=&apos;Spam&apos;, command=win.quit, underline=0)\n    submenu.add_command(label=&apos;Eggs&apos;, command=not_done, underline=0)\n    edit.add_cascade(label=&apos;Stuff&apos;, menu=submenu, underline=0)  # 在一级菜单中添加二级菜单\n\nif __name__ == &apos;__main__&apos;:\n    root = Tk()\n    root.title(&apos;menu_win&apos;)\n    make_menu(root)\n    msg = Label(root, text=&apos;Window menu basic&apos;)\n    msg.pack(expand=YES, fill=BOTH)\n    msg.config(relief=SUNKEN, width=40, height=7, bg=&apos;beige&apos;)\n    root.mainloop()</code></pre><h4 id=\"创建框架级别菜单\"><a href=\"#创建框架级别菜单\" class=\"headerlink\" title=\"创建框架级别菜单\"></a>创建框架级别菜单</h4><pre><code># gui21.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom tkMessageBox import *\n\n\ndef not_done():\n    showerror(&apos;Not implemented&apos;, &apos;Not yet available&apos;)\n\n\ndef make_menu(parent):\n    menu_bar = Frame(parent)\n    menu_bar.pack(side=TOP, fill=X)\n\n    f_button = Menubutton(menu_bar, text=&apos;File&apos;, underline=0)\n    f_button.pack(side=LEFT)\n    file = Menu(f_button)\n    file.add_command(label=&apos;New...&apos;, command=not_done, underline=0)\n    file.add_command(label=&apos;Open...&apos;, command=not_done, underline=0)\n    file.add_command(label=&apos;Quit...&apos;, command=parent.quit,  underline=0)\n    f_button.config(menu=file)\n\n    e_button = Menubutton(menu_bar, text=&apos;Edit&apos;, underline=0)\n    e_button.pack(side=LEFT)\n    edit = Menu(e_button)\n    edit.add_command(label=&apos;Cut&apos;, command=not_done, underline=0)\n    edit.add_command(label=&apos;Paste&apos;, command=not_done, underline=0)\n    edit.add_separator()\n    e_button.config(menu=edit)\n\n    sub_menu = Menu(edit, tearoff=True)\n    sub_menu.add_command(label=&apos;Spam&apos;, command=parent.quit, underline=0)\n    sub_menu.add_command(label=&apos;Eggs&apos;, command=not_done, underline=0)\n    edit.add_cascade(label=&apos;Stuff&apos;, menu=sub_menu, underline=0)\n    return menu_bar\n\n\n\nif __name__ == &apos;__main__&apos;:\n    root = Tk()\n    root.title(&apos;menu_fra&apos;)\n    for i in range(2):\n        mnu = make_menu(root)\n        mnu.config(bd=2, relief=RAISED)\n        Label(root, bg=&apos;black&apos;, height=5, width=25).pack(expand=YES, fill=BOTH)\n    Button(root, text=&apos;Bye&apos;, command=root.quit).pack()\n    root.mainloop()</code></pre><h4 id=\"图片菜单\"><a href=\"#图片菜单\" class=\"headerlink\" title=\"图片菜单\"></a>图片菜单</h4><pre><code># gui22.py\n# -*- coding:UTF-8 -*-\nfrom Tkinter import *\nfrom tkMessageBox import *\n\n\nclass NewMenuDemo(Frame):\n    def __init__(self, parent=None):\n        Frame.__init__(self, parent)\n        self.pack(expand=YES, fill=BOTH)\n        self.create_widgets()\n\n    def create_widgets(self):\n        self.make_menubar()\n        self.make_toolbar()\n        l = Label(self, text=&apos;Menu and Toolbar Demo&apos;)\n        l.config(relief=SUNKEN, width=40, height=10, bg=&apos;white&apos;)\n        l.pack(expand=YES, fill=BOTH)\n\n    def make_toolbar(self, size=(30, 30)):\n        toolbar = Frame(self, cursor=&apos;hand2&apos;, relief=SUNKEN, bd=2)\n        toolbar.pack(side=BOTTOM, fill=X)\n        Button(toolbar, text=&apos;Quit&apos;, command=self.quit).pack(side=RIGHT)\n        photo_files = (&apos;at.png&apos;, &apos;bd.png&apos;, &apos;dk.png&apos;)\n        self.tool_photo_objs = []\n        for file in photo_files:\n            img = PhotoImage(file=&apos;./gif/thumbs/&apos; + file)\n            btn = Button(toolbar, image=img, command=self.greeting)\n            btn.config(bd=5, relief=RIDGE)\n            btn.config(width=size[0], height=size[0])\n            btn.pack(side=LEFT)\n            self.tool_photo_objs.append(img)\n        Button(toolbar, text=&apos;Hello&apos;, command=self.greeting).pack(side=LEFT)\n\n    def make_menubar(self):\n        self.menubar = Menu(self.master)\n        self.master.config(menu=self.menubar)\n        self.file_menu()\n        self.edit_menu()\n        self.image_menu()\n\n    def file_menu(self):\n        pulldown = Menu(self.menubar)\n        pulldown.add_command(label=&apos;OPEN...&apos;, command=self.notdone)\n        pulldown.add_command(label=&apos;QUIT&apos;, command=self.quit)\n        self.menubar.add_cascade(label=&apos;FILE&apos;, underline=0, menu=pulldown)\n\n    def edit_menu(self):\n        pulldown = Menu(self.menubar)\n        pulldown.add_command(label=&apos;PASTE&apos;, command=self.notdone)\n        pulldown.add_command(label=&apos;SPAM&apos;, command=self.greeting)\n        pulldown.add_separator()\n        pulldown.add_command(label=&apos;DELETE&apos;, command=self.greeting)\n        pulldown.entryconfig(4, state=DISABLED)\n        self.menubar.add_cascade(label=&apos;EDIT&apos;, underline=0, menu=pulldown)\n\n    def image_menu(self):\n        photo_files = (&apos;at.png&apos;, &apos;bd.png&apos;, &apos;dk.png&apos;)\n        pulldown = Menu(self.menubar)\n        self.photo_objs = []\n        for file in photo_files:\n            img = PhotoImage(file=&apos;./gif/&apos; + file)\n            pulldown.add_command(image=img, command=self.notdone)\n            self.photo_objs.append(img)\n        self.menubar.add_cascade(label=&apos;IMAGE&apos;, underline=0, menu=pulldown)\n\n    def greeting(self):\n        showinfo(&apos;greeting&apos;, &apos;GREETING&apos;)\n\n    def notdone(self):\n        showerror(&apos;NOT DONE&apos;, &apos;NOT DONE&apos;)\n\n    def quit(self):\n        if askyesno(&apos;Verify quit&apos;, &apos;Sure?&apos;):\n            Frame.quit(self)\n\nif __name__ == &apos;__main__&apos;:\n    NewMenuDemo().mainloop()</code></pre><h4 id=\"滚动条与列表\"><a href=\"#滚动条与列表\" class=\"headerlink\" title=\"滚动条与列表\"></a>滚动条与列表</h4><pre><code># gui23.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\n\n\nclass ScrolledList(Frame):\n    def __init__(self, options, parent=None):\n        Frame.__init__(self, parent)\n        self.pack(expand=YES, fill=BOTH)\n        self.makeWidgets(options)\n\n\n    def handle_list(self, event):\n        index = self.listbox.curselection()  # 鼠标选中的行\n        label = self.listbox.get(index)  # 获取鼠标选中的值\n        self.runCommand(label)  # 打印出值\n\n\n    def makeWidgets(self, options):\n        # sbar = Scrollbar(self, orient=&apos;horizontal&apos;)  # 横向滚动\n        sbar = Scrollbar(self)\n        list = Listbox(self, relief=SUNKEN)\n        sbar.config(command=list.yview)  # 移动滚动条启用回调： 按比例调节列表框的显示，\n        list.config(yscrollcommand=sbar.set)  # 移动列表框启用回调：按比例调节滚动条\n        sbar.pack(side=RIGHT, fill=Y)\n        list.pack(side=LEFT, expand=YES, fill=BOTH)\n        pos = 0\n        for label in options:\n            list.insert(pos, label)\n            pos += 1\n        # selectmode 选择模式SINGLE(单选), BROWSE(默认单选), MULTIPLE(多选), EXTENDED(多选)\n        # 启用多选时， curselection返回列表\n        # 启用单选时， curselection返回字符串\n        list.config(selectmode=EXTENDED, setgrid=1)\n        list.bind(&apos;&lt;Double-1&gt;&apos;, self.handle_list)\n        self.listbox = list\n\n    def runCommand(self, selection):\n        print(&apos;YOU SELECTED:&apos;, selection)\n\n\nif __name__ == &apos;__main__&apos;:\n    options = ((&apos;Lumberjack-%s&apos; % x) for x in range(20))\n    ScrolledList(options).mainloop()</code></pre><h4 id=\"TEXT组件\"><a href=\"#TEXT组件\" class=\"headerlink\" title=\"TEXT组件\"></a>TEXT组件</h4><pre><code>gui24.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\n\n\nclass ScrollText(Frame):\n    def __init__(self, parent=None, text=&apos;&apos;, file=None):\n        Frame.__init__(self, parent)\n        self.pack(expand=YES, fill=BOTH)\n        self.make_widgets()\n        self.set_text(text, file)\n\n    def make_widgets(self):\n        sbar = Scrollbar(self)\n        text = Text(self, relief=SUNKEN)\n        sbar.config(command=text.yview)\n        text.config(yscrollcommand=sbar.set)\n        sbar.pack(side=RIGHT, fill=Y)\n        text.pack(side=LEFT, expand=YES, fill=BOTH)\n        self.text = text\n\n    def set_text(self, text=&apos;&apos;, file=None):\n        if file:\n            text = open(file, &apos;r&apos;).read()\n        # 1.0表示第一行，第0列（行从1开始，列从0开始）\n        # END表示最末一个字符后面第一个位置\n        self.text.delete(&apos;1.0&apos;, END)  # 删除从第一行第0列开始到最后的字符串，即删除全部\n        self.text.insert(&apos;1.0&apos;, text)  # 从第一行第0列开始填充数据\n        # mark_set 设置text标志\n        self.text.mark_set(INSERT, &apos;1.0&apos;)  # 设置将光标设置在文本开始位置\n        # self.text.mark_set(&apos;line_two&apos;, &apos;2.2&apos;)  # 自定义标志位置 可以用mark_unset取消\n        self.text.focus()\n        # TEXT的tag标签\n        # SEL是内置的标签，表示当前选中的文本\n        # text = self.text.get(SEL_FIRST, SEL_LAST)\n        # text = self.text.get(&apos;sel.first&apos;, &apos;sel.last&apos;)\n        # self.text.tag_add(&apos;alltext&apos;, &apos;1.0&apos;, END)  # 选中所有文本\n        # self.text.tag_add(SEL, index1, index2)  # 将一定范围内的文本添加到内建的SEL标签\n        # self.text.tag_remove(SEL, &apos;1.0&apos;, END)  # 将字符串所有字符从SEL标签中删除\n        # self.text.tag_delete(SEL)  # 删除SEL标签\n        # self.text.tag_add(&apos;demo&apos;, &apos;1.5&apos;, &apos;1.7&apos;)\n        # self.text.tag_add(&apos;demo&apos;, &apos;3.0&apos;, &apos;5.7&apos;)\n        # self.text.tag_config(&apos;demo&apos;, background=&apos;purple&apos;)\n        # self.text.tag_config(&apos;demo&apos;, fontground=&apos;white&apos;)\n        # self.text.tag_config(&apos;demo&apos;, font=(&apos;times&apos;, 16, &apos;underline&apos;))\n        # self.text.tag_bind(&apos;demo&apos;, &apos;&lt;Double-1&gt;&apos;, func)\n        # see方法\n        # self.text.see(&apos;1.0&apos;)  # 滚动到第一行第0列\n        # self.text.see(INSERT)  # 滚动到光标插入处\n        # self.text.see(SEL_FIRST)  # 滚动到选中文本第一个字符串\n    def get_text(self):\n        # -1c 表示往回数一个字符串\n        # +1l 表示往前数一行\n        return self.text.get(&apos;1.0&apos;, END + &apos;-1c&apos;)\n\n\nif __name__ == &apos;__main__&apos;:\n    root = Tk()\n    if len(sys.argv) &gt; 1:\n        st = ScrollText(file=sys.argv[1])\n    else:\n        st = ScrollText(text=&apos;Words\\ngo here&apos;)\n\n    def show(event):\n        print(repr(st.get_text()))\n\n    root.bind(&apos;&lt;Key-Escape&gt;&apos;, show)\n    root.mainloop()</code></pre><h4 id=\"简单的文本编辑器\"><a href=\"#简单的文本编辑器\" class=\"headerlink\" title=\"简单的文本编辑器\"></a>简单的文本编辑器</h4><pre><code># gui25.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\nfrom tkSimpleDialog import askstring\nfrom tkFileDialog import asksaveasfilename\nfrom quitGui import Quitter\nfrom gui24 import ScrollText\n\n\nclass SimpleEditor(ScrollText):\n    def __init__(self, parent=None, file=None):\n        frm = Frame(parent)\n        frm.pack(fill=X)\n        Button(frm, text=&apos;Save&apos;, command=self.on_save).pack(side=LEFT)\n        Button(frm, text=&apos;Cut&apos;, command=self.on_cut).pack(side=LEFT)\n        Button(frm, text=&apos;Paste&apos;, command=self.on_paste).pack(side=LEFT)\n        Button(frm, text=&apos;Find&apos;, command=self.on_find).pack(side=LEFT)\n        Quitter(frm).pack(side=LEFT)\n        ScrollText.__init__(self, parent, file=file)\n        self.text.config(font=(&apos;courier&apos;, 9, &apos;normal&apos;))\n\n    def on_save(self):\n        filename = asksaveasfilename()\n        if filename:\n            alltext = self.get_text()\n            open(filename, &apos;w&apos;).write(alltext)\n\n\n    def on_cut(self):\n        text = self.text.get(SEL_FIRST, SEL_LAST)\n        self.text.delete(SEL_FIRST, SEL_LAST)\n        self.clipboard_clear()\n        self.clipboard_append(text)\n\n\n    def on_paste(self):\n        try:\n            text = self.selection_get(selection=&apos;CLIPBOARD&apos;)\n            self.text.insert(INSERT, text)\n        except TclError:\n            pass\n\n\n    def on_find(self):\n        target = askstring(&apos;SimpleEdit&apos;, &apos;Search string?&apos;)\n        if target:\n            where = self.text.search(target, INSERT, END)\n            if where:\n                print(where)\n                pastit = where + (&apos;+%dc&apos; % len(target))\n                self.text.tag_remove(SEL, &apos;1.0&apos;, END)\n                self.text.tag_add(SEL, where, pastit)\n                self.text.mark_set(INSERT, pastit)\n                self.text.see(INSERT)\n                self.text.focus()\n\nif __name__ == &apos;__main__&apos;:\n    if len(sys.argv) &gt; 1:\n        SimpleEditor(file=sys.argv[1]).mainloop()\n    else:\n        SimpleEditor().mainloop()</code></pre><h4 id=\"创建基础画布\"><a href=\"#创建基础画布\" class=\"headerlink\" title=\"创建基础画布\"></a>创建基础画布</h4><pre><code># gui26.py\n# -*- coding: UTF-8 -*-\n\nfrom Tkinter import *\ncanvas = Canvas(width=525, height=300, bg=&apos;white&apos;)\ncanvas.pack(expand=YES, fill=BOTH)\n\ncanvas.create_line(100, 100, 200, 200)\ncanvas.create_line(100, 200, 200, 300)\nfor i in range(1, 20, 2):\n    canvas.create_line(0, i, 50, i)\ncanvas.create_oval(20, 20, 300, 100, width=10, fill=&apos;yellow&apos;)\nd = {1:PIESLICE,2:CHORD,3:ARC}\nfor i in d:\n    canvas.create_arc(\n        (10,10 + 60*i,110,110 + 60*i),\n        style=d[i],   #指定样式\n        start=30,     #指定起始角度\n        extent=30     #指定角度偏移量\n        )\ncanvas.create_arc(0, 0, 100, 200, fill=&apos;black&apos;)\ncanvas.create_rectangle(200, 200, 300, 300, width=5, fill=&apos;red&apos;)\ncanvas.create_line(0, 300, 150, 150, width=10, fill=&apos;green&apos;)\n\nphoto = PhotoImage(file=&apos;./gif/lightmachine.png&apos;)\ncanvas.create_image(325,25, image=photo, anchor=NW)\n\nwidget = Label(canvas, text=&apos;Spam&apos;, fg=&apos;white&apos;, bg=&apos;black&apos;)\nwidget.pack()\ncanvas.create_window(100, 100, window=widget)\ncanvas.create_text(100, 280, text=&apos;CLOUD CLONE CORP.&apos;)\n\n# id = canvas.create_line(fromX, fromY, toX, toY)  # 创建直线\n# id = canvas.create_oval(fromX, fromY, toX, toY) # 创建椭圆\n# id = canvas.create_arc(fromX, fromY, toX, toY)  # 创建扇形\n# id =canvas.create_rectangle(fromX, fromY, toX, toY)  # 创建矩形\n# canvas.move(id, offsetX, offsetY)  # 移动对象\n# canvas.delete(id)  # 删除对象\n# canvas.tkraise(id)  # 将对象移动到前端\n# canvas.lower(id)  # 将对象移动到底部\n# canvas.itemconfig(id, fill=&apos;red&apos;)  # 修改对象属性\n\n# 画布标签\n# canvas.create_line(fromX, fromY, toX, toY, tag=&apos;bubbles&apos;) \n# canvas.create_line(fromX, fromY, toX, toY, tag=&apos;bubbles&apos;) \n# id = canvas.create_line(fromX, fromY, toX, toY)\n# canvas.addtag_withtag(&apos;bubbles&apos;, id)\n# canvas.move(&apos;bubbles&apos;, diffX, diffY)\nmainloop()</code></pre><h4 id=\"canvas与滚动条\"><a href=\"#canvas与滚动条\" class=\"headerlink\" title=\"canvas与滚动条\"></a>canvas与滚动条</h4><pre><code># gui27.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\n\nclass ScrolledCanvas(Frame):\n    def __init__(self, parent=None, color=&apos;brown&apos;):\n        Frame.__init__(self, parent)\n        self.pack(expand=YES, fill=BOTH)\n        canv = Canvas(self, bg=color, relief=SUNKEN)\n        canv.config(width=300, height=200)\n        canv.config(scrollregion=(0, 0, 300, 1000))\n        canv.config(highlightthickness=0)\n\n        sbar = Scrollbar(self)\n        sbar.config(command=canv.yview)\n        canv.config(yscrollcommand=sbar.set)\n        sbar.pack(side=RIGHT, fill=Y)\n        canv.pack(side=LEFT, expand=YES, fill=BOTH)\n\n        self.fillContent(canv)\n        canv.bind(&apos;&lt;Double-1&gt;&apos;, self.onDoubleClick)\n        self.canvas = canv\n\n    def fillContent(self, canv):\n        for i in range(10):\n            canv.create_text(150, 50+(i*100), text=&apos;spam&apos;+str(i), fill=&apos;beige&apos;)\n\n    def onDoubleClick(self, event):\n        print(event.x, event.y)\n        print(self.canvas.canvasx(event.x), self.canvas.canvasy(event.y))\n\nif __name__ == &apos;__main__&apos;:\n    ScrolledCanvas().mainloop()</code></pre><h4 id=\"canvas绑定事件\"><a href=\"#canvas绑定事件\" class=\"headerlink\" title=\"canvas绑定事件\"></a>canvas绑定事件</h4><pre><code># gui28.py\n# -*- coding: UTF-8 -*-\nfrom Tkinter import *\ntrace = False\n\nclass CanvasEventDemo:\n    def __init__(self, parent=None):\n        canvas = Canvas(width=300, height=300, bg=&apos;beige&apos;)\n        canvas.pack()\n        canvas.bind(&apos;&lt;ButtonPress-1&gt;&apos;, self.on_start)\n        canvas.bind(&apos;&lt;B1-Motion&gt;&apos;, self.on_grow)\n        canvas.bind(&apos;&lt;Double-1&gt;&apos;, self.on_clear)\n        canvas.bind(&apos;&lt;ButtonPress-3&gt;&apos;, self.on_move)\n        self.canvas = canvas\n        self.drawn = None\n        self.kinds = [canvas.create_oval, canvas.create_rectangle]\n\n    def on_start(self, event):\n        self.shape =self.kinds[0]\n        self.kinds = self.kinds[1:] + self.kinds[:1]\n        self.start = event\n        self.drawn = None\n\n    def on_grow(self, event):\n        canvas = event.widget\n        if self.drawn:\n            canvas.delete(self.drawn)\n        object_id = self.shape(self.start.x, self.start.y, event.x, event.y)\n        if trace:\n            print(object_id)\n        self.drawn = object_id\n\n    def on_clear(self, event):\n        event.widget.delete(&apos;all&apos;)\n\n\n    def on_move(self, event):\n        if self.drawn:\n            if trace:\n                print(self.drawn)\n            canvas = event.widget\n            diffx, diffy = (event.x - self.start.x), (event.y - self.start.y)\n            canvas.move(self.drawn, diffx, diffy)\n            self.start = event\n\nif __name__ == &apos;__main__&apos;:\n    CanvasEventDemo()\n    mainloop()</code></pre><h4 id=\"grid布局和pack布局实现自动扩展\"><a href=\"#grid布局和pack布局实现自动扩展\" class=\"headerlink\" title=\"grid布局和pack布局实现自动扩展\"></a>grid布局和pack布局实现自动扩展</h4><pre><code># gui29.py\n# -*- coding: UTF-8 -*-\n\nfrom Tkinter import *\ncolors = [&apos;red&apos;, &apos;green&apos;, &apos;orange&apos;, &apos;white&apos;, &apos;yellow&apos;, &apos;blue&apos;]\n\ndef gridbox(root):\n    Label(root, text=&apos;GRID&apos;).grid(columnspan=2)  # 跨两列\n    row = 1\n    for color in colors:\n        lab = Label(root, text=color, relief=RIDGE, width=25)\n        ent = Entry(root, bg=color, relief=SUNKEN, width=50)\n        lab.grid(row=row, column=0, sticky=NSEW)  # 向4个方向扩展\n        ent.grid(row=row, column=1, sticky=NSEW)\n        root.rowconfigure(row, weight=1)  # 循环行自动扩展\n        row += 1\n    root.columnconfigure(0, weight=1)  # 第一列自动扩展\n    root.columnconfigure(1, weight=1)  # 第二列自动扩展\n\ndef packbox(root):\n    Label(root, text=&apos;PACK&apos;).pack()\n    for color in colors:\n        row = Frame(root)\n        lab = Label(row, text=color, relief=RIDGE, width=25)\n        ent = Entry(row, bg=color, relief=SUNKEN, width=50)\n        row.pack(side=TOP, expand=YES, fill=BOTH)\n        lab.pack(side=LEFT, expand=YES, fill=BOTH)\n        ent.pack(side=RIGHT, expand=YES, fill=BOTH)\n\nif __name__ == &apos;__main__&apos;:\n    root = Tk()\n    gridbox(Toplevel(root))\n    packbox(Toplevel(root))\n    Button(root, text=&apos;Quit&apos;, command=root.quit).pack()\n    mainloop()</code></pre><h3 id=\"PIL：Python-Imaging-Library\"><a href=\"#PIL：Python-Imaging-Library\" class=\"headerlink\" title=\"PIL：Python Imaging Library\"></a>PIL：Python Imaging Library</h3><h4 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h4><pre><code>sudo apt-get install python-imaging\n或者\nsudo easy_install PIL</code></pre><p>window系统选择</p>\n<pre><code>pip install Pillow</code></pre><p>图像操作</p>\n<pre><code>import Image\n# 打开一个jpg图像文件，注意路径要改成你自己的:\nim = Image.open(&apos;/Users/michael/test.jpg&apos;)\n# 获得图像尺寸:\nw, h = im.size\n# 缩放到50%:\nim.thumbnail((w//2, h//2))\n# 把缩放后的图像用jpeg格式保存:\nim.save(&apos;/Users/michael/thumbnail.jpg&apos;, &apos;jpeg&apos;)</code></pre><p>模糊效果</p>\n<pre><code>import Image, ImageFilter\n\nim = Image.open(&apos;/Users/hanchang/test.jpg&apos;)\nim2 = im.filter(ImageFilter.BLUR)\nim2.save(&apos;/Users/hanchang/blur.jpg&apos;, &apos;jpeg&apos;)</code></pre><p>自定义图像验证码</p>\n<pre><code>import Image, ImageDraw, ImageFont, ImageFilter\nimport random\n# 随机字母:\ndef rndChar():\n    return chr(random.randint(65, 90))\n\n# 随机颜色1:\ndef rndColor():\n    return (random.randint(64, 255), random.randint(64, 255), random.randint(64, 255))\n\n# 随机颜色2:\ndef rndColor2():\n    return (random.randint(32, 127), random.randint(32, 127), random.randint(32, 127))\n\n# 240 x 60:\nwidth = 60 * 4\nheight = 60\nimage = Image.new(&apos;RGB&apos;, (width, height), (255, 255, 255))\n# 创建Font对象:\nfont = ImageFont.truetype(&apos;Arial.ttf&apos;, 36)\n# 创建Draw对象:\ndraw = ImageDraw.Draw(image)\n# 填充每个像素:\nfor x in range(width):\n    for y in range(height):\n        draw.point((x, y), fill=rndColor())\n# 输出文字:\nfor t in range(4):\n    draw.text((60 * t + 10, 10), rndChar(), font=font, fill=rndColor2())\n# 模糊:\nimage = image.filter(ImageFilter.BLUR)\nimage.save(&apos;code.jpg&apos;, &apos;jpeg&apos;);\n自定义字符串生成图片</code></pre><p><code>from PIL import Image,ImageDraw,ImageFont,ImageOps &lt;h1&gt;生成图片&lt;/h1&gt; def create\\_image(str, line, name, dir): img\\_size = (400, (line*20) + 10) img\\_mode = &#39;RGB&#39; img\\_font = ImageFont.truetype(&#39;UbuntuMono-R.ttf&#39;, 14) img\\_bg = &#39;#FFF&#39; img\\_fg = &#39;#000&#39; img = Image.new(mode=img\\_mode, size=img\\_size, color=img\\_bg) draw = ImageDraw.Draw(img) draw.text((10, 10), str, fill=img\\_fg, font=img_font) img.save( dir + name + &#39;.png&#39;, &#39;png&#39;)</code></p>\n"},{"title":"c开发gtk+入门基础","date":"2019-07-24T05:58:51.000Z","_content":"#### gdk+介绍\n\n> gtk+是c语言编写的用于开发图形界面程序的函数库。gtk+来源于gimp（gnu image minipulation program），gtk+在gdk（gimp drawing kit）基础上创建，并进行封装。\n\n#### linux安装\n\n```shell\n# http://ftp.gnome.org/pub/gnome/sources/gtk+/3.24/\n$ wget http://ftp.gnome.org/pub/gnome/sources/gtk+/3.24/gtk+-3.24.10.tar.xz\n$ tar xvfJ gtk+-3.24.10.tar.xz\n$ ./configure --prefix=/user/include/gtk3.24\n$ make && sudo make install\n$ sudo ldconfig\n# 设置LD_LIBRARY_PATH\n$ LD_LIBRARY_PATH=\"/opt/gtk/lib\"\n$ PATH=\"/opt/gtk/bin:$PATH\"\n$ export LD_LIBRARY_PATH PATH\n```\n\n#### 简单的空白窗口\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    gtk_init(&argc, &argv);\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    gtk_widget_show(window);\n    gtk_main();\n    return 0;\n}\n```\n\n```shell\n$ gcc -o main main.c `pkg-config --libs -cflags gtk+-3.0`\n```\n\ngtk_init (&argc, &argv); 所有 GTK应用程序都要调用该函数，而且必须在控件定义之前使用，它为我们设置一些缺省值( 例如视觉和颜色 )映射这个函数将函数库初始化，设置缺省的信号处理函数，并检查通过命令行传递给应用程序的参数，自动完成一些必要的初始化工作。\n\ngtk_main()是在每个Gtk应用程序都要调用的函数。程序运行停在这里等待事件(如键盘事件或鼠标事件)的发生，等待用户来操作窗口\n\ngtk_window_new()的功能创建一个窗口并返回这个窗口的控件指针。GTK_WINDOW_TOPLEVEL指明窗口的类型为最上层的主窗口，它最常用。接着创建一个GtkWidget *类型的window变量来接收。GtkWidget是GTK+控件类型，GtkWidget * 能指向任何控件的指针类型。\n\ngtk_widget_show(window)；用来显示上一步创建的窗口控件。在这个简单例子里，所有事件都被忽略。用鼠标点击窗口右上角的“×”按钮也不能将窗口关闭。我们可以在终端敲 Ctrl + C 关闭程序。\n\n#### 控件\n\nGTK中控件主要分为两类：容器控件，非容器控件。\n\n容器控件：它可以容纳别的控件，我们可以理解为盒子，盒子拿来装东西。容器控件又分为两类，一类只能容纳一个控件，如窗口，按钮；另一类能容纳多个控件，如布局控件。\n\n非容器控件：它不可以容纳别的控件，如标签、行编辑。\n\n前面我们写的空白窗口是能容纳一个控件的控件，现在我们要做的是，给这个窗口添加一个按钮。\n\n首先，我们需要创建一个按钮，然后需要把按钮添加到窗口，接着，显示按钮控件。\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // gtk初始化\n    gtk_init(&argc, &argv);\n    // 创建一个顶层窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建一个button容器\n    GtkWidget *button = gtk_button_new_with_label(\"hello gtk\");\n    // 将button放入窗口中，\n    gtk_container_add(GTK_CONTAINER(window), button);\n    // 显示button\n    gtk_widget_show(button);\n    // 显示window\n    gtk_widget_show(window);\n    gtk_main();\n    return 0;\n}\n```\n\n```c\nvoid gtk_container_add(GtkContainer *container, GtkWidget *widget);\n```\n\n这里我们是把按钮添加到窗口容器里，widget为按钮指针(以上代码的button)，container为窗口指针(以上代码的window)，这里需要注意的是，我们创建的窗口(window)返回值为GtkWidget *类型，而gtk_container_add()的第一个参数为GtkContainer *类型，由于 GtkWidget *类型的变量为指向任何控件的万能指针，所以，在函数传参时，根据参数类型进行相应的转换，如：\n\n```c\ngtk_container_add( (GtkContainer *)window, button);\n```\n\nC语言里，我们常用这种方法转换。在GTK中，很多内部变量指针类型转换都定义了宏定义，如：\n\n```c\n#define GTK_CONTAINER(x) (GtkContainer *)(x)\n```\n\n所以，我们还可以这么写：\n\n```c\ngtk_container_add(GTK_CONTAINER(window), button);\n```\n\n那么，我们如何知道，哪个类型对应哪个宏定义呢？把要转换类型名字全部变为大写，同时，单词和单词之间以下划线“_”连接，然后，这个名字就是哪个宏定义的名字，如，(GtkButton *)x用宏定义的方法为 GTK_BUTTON(x)。\n\n上面的代码，我们是按钮和窗口都得通过gtk_widget_show()显示出来：\n\n```c\ngtk_widget_show(button);// 显示按钮\ngtk_widget_show(window);// 显示窗口\n```\n\n但是，假如，窗口里有100个控件，还是这样一个一个地显示出来会比较麻烦，这时候，我们可以通过gtk_widget_show_all()显示所有的控件，里面需要传的是容纳控件的那个容器(这里为窗口)。这样，容器上的控件也会跟着显示。\n\n```c\ngtk_widget_show_all()\n```\n\n#### 布局容器-水平布局\n\n如果我们希望窗口里多放添加几个控件，直接添加是不成功的，因为窗口只能容纳一个控件的容器。这时候，我们需要借助布局容器，我们先把布局容器添加到窗口里，然后再把所需要添加的控件放在布局容器里。\n\n布局容器的主要分类：水平布局( GtkHBox)、垂直布局(GtkVBox )、表格布局(GtkTable)、固定布局(GtkFixed )。\n\n**创建一个盒子布局**\n\n```c\n// orientation参数: GTK_ORIENTATION_HORIZONTAL GTK_ORIENTATION_VERTICAL 两个可选值 spacing参数是单元格之间的间隙\nint gtk_box_new(int orientation, int spacing);\n```\n\n以下代码显示水平容器布局方式，垂直容器类似\n\n```c \n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // gtk初始化\n    gtk_init(&argc, &argv);\n    // 创建一个顶层窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建水平容器\n    // GtkWidget *hbox = gtk_hbox_new(TRUE, 10);  // gtk+2版本使用\n    GtkWidget *hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 10);  // gtk+3版本使用\n    // 将水平容器添加到窗口\n    gtk_container_add(GTK_CONTAINER(window), hbox);\n    // 创建一个button容器\n    GtkWidget *button1 = gtk_button_new_with_label(\"button1\");\n    // 将button放入水平容器中\n    gtk_container_add(GTK_CONTAINER(hbox), button1);\n    // 重复创建两个\n    GtkWidget *button2 = gtk_button_new_with_label(\"button2\");\n    GtkWidget *button3 = gtk_button_new_with_label(\"button3\");\n    gtk_container_add(GTK_CONTAINER(hbox), button2);\n    gtk_container_add(GTK_CONTAINER(hbox), button3);\n    // 显示全部窗口\n    gtk_widget_show_all(window);\n    gtk_main();\n    return 0;\n}\n```\n\n#### 布局容器-表格布局\n\n**添加表格布局容器**\n\n```c\n// rows: 行数, coumns: 列数, homogeneous：容器内表格的大小是否相等, 返回值：表格布局容器指针\nGtkWidget *gtk_table_new(guint rows, guint columns, gboolean homogeneous);\n```\n\n**布局容器添加控件**\n\n```c\n// table: 容纳控件的容器, widget: 要添加的控件, 后四个参数为控件摆放的坐标，规则如下：\nvoid gtk_table_attach_defaults(GtkTable *table, GtkWidget *widget, guint left_attach, guint right_attach, guint top_attach, guint bottom_attach);\n```\n\n![示意图](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/gtk%E8%A1%A8%E6%A0%BC%E5%B8%83%E5%B1%80%E7%A4%BA%E6%84%8F%E5%9B%BE.png)\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // gtk初始化\n    gtk_init(&argc, &argv);\n    // 创建一个顶层窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建一个表格容器\n    GtkWidget *table = gtk_table_new(2, 2, TRUE); // gtk+2版本\n    gtk_container_add(GTK_CONTAINER(window), table);\n    // 创建button1， button2, button3\n    GtkWidget *button1 = gtk_button_new_with_label(\"button1\");\n    GtkWidget *button2 = gtk_button_new_with_label(\"button2\");\n    GtkWidget *button3 = gtk_button_new_with_label(\"button3\");\n    // 将button放入table中\n    gtk_table_attach_defaults(GTK_TABLE(table), button1, 0, 1, 0, 1);\n    gtk_table_attach_defaults(GTK_TABLE(table), button2, 1, 2, 0, 1);\n    gtk_table_attach_defaults(GTK_TABLE(table), button3, 0, 2, 1, 2);\n    // 显示所有窗口\n    gtk_widget_show_all(window);\n    gtk_main();\n    return 0;\n}\n```\n\n#### 布局容器-固定布局\n\n水平、垂直和表格布局容器，控件会跟着容器大小的变化进行自动适应，而固定布局容器里的控件则不会跟着变化( 则固定不变 )。\n\n**固定布局的创建**\n\n```c\nGtkWidget *gtk_fixed_new(void);\n```\n\n**添加控件**\n\n```c\n// fixed：容纳控件的容器, widget：要添加的控件, x, y：控件摆放位置的起点坐标\nvoid gtk_fixed_put(GtkFixed *fixed, GtkWidget *widget, gint x, gint y );\n```\n\n**设置控件的大小( 宽和高 )**\n\n```c\n// widget：需要设置的控件, width：宽度, height：高度\nvoid gtk_widget_set_size_request(GtkWidget *widget, gint width, gint height);\n```\n\n**移动固定布局里控件的位置**\n\n```c\n// fixed：固定布局容器, widget：需要移动的控件, x, y: 移动的位置\nvoid gtk_fixed_move(GtkFixed *fixed, GtkWidget *widget, gint x, gint y);\n```\n\n示例代码\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // gtk初始化\n    gtk_init(&argc, &argv);\n    // 创建一个顶层窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建一个固定布局容器\n    GtkWidget *fixed = gtk_fixed_new();\n    // 将fixed添加到window中\n    gtk_container_add(GTK_CONTAINER(window), fixed);\n    // 创建button\n    GtkWidget *button1 = gtk_button_new_with_label(\"button1\");\n    GtkWidget *button2 = gtk_button_new_with_label(\"button2\");\n    // 将button添加到fixed\n    gtk_fixed_put(GTK_FIXED(fixed), button1, 0, 0);\n    gtk_fixed_put(GTK_FIXED(fixed), button2, 0, 0);\n    // 移动button位置\n    gtk_fixed_move(GTK_FIXED(fixed), button2, 150, 150);\n    // 设置button大小\n    gtk_widget_set_size_request(button2, 100, 50);\n    // 显示所有窗口\n    gtk_widget_show_all(window);\n    gtk_main();\n    return 0;\n}\n```\n\n#### 容器布局练习-计算器\n\n**编辑控件( GtkEntry )**\n\n```c\n// 创建\nGtkWidget * gtk_entry_new(void);\n// 编辑\nvoid gtk_entry_set_text (GtkEntry *entry,const gchar *text);\n// 设置行编辑是否允许编辑\nvoid gtk_editable_set_editable(GtkEditable *editable, gboolean is_editable);\n```\n\n示例代码\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // 初始化\n    gtk_init(&argc, &argv);\n    // 创建窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建5行4列的表格容器\n    GtkWidget *table = gtk_table_new(5, 4, TRUE);\n    // 将table放入到容器中\n    gtk_container_add(GTK_CONTAINER(window), table);\n    // 创建一个行编辑\n    GtkWidget *entry = gtk_entry_new();\n    // 设置行编辑的内容\n    gtk_entry_set_text(GTK_ENTRY(entry), \"2+2=4\");\n    // 设置行编辑不允许编辑\n    gtk_editable_set_editable(GTK_EDITABLE(entry), FALSE);\n    // 创建0-9数字按钮，+-×/=c功能按钮\n    GtkWidget *button_0 = gtk_button_new_with_label(\"0\");\n    GtkWidget *button_1 = gtk_button_new_with_label(\"1\");\n    GtkWidget *button_2 = gtk_button_new_with_label(\"2\");\n    GtkWidget *button_3 = gtk_button_new_with_label(\"3\");\n    GtkWidget *button_4 = gtk_button_new_with_label(\"4\");\n    GtkWidget *button_5 = gtk_button_new_with_label(\"5\");\n    GtkWidget *button_6 = gtk_button_new_with_label(\"6\");\n    GtkWidget *button_7 = gtk_button_new_with_label(\"7\");\n    GtkWidget *button_8 = gtk_button_new_with_label(\"8\");\n    GtkWidget *button_9 = gtk_button_new_with_label(\"9\");\n    GtkWidget *button_add = gtk_button_new_with_label(\"+\");\n    GtkWidget *button_minus = gtk_button_new_with_label(\"-\");\n    GtkWidget *button_mul = gtk_button_new_with_label(\"*\");\n    GtkWidget *button_div = gtk_button_new_with_label(\"/\");\n    GtkWidget *button_equal = gtk_button_new_with_label(\"=\");\n    GtkWidget *button_delete = gtk_button_new_with_label(\"c\");\n    // 将table放入表格布局中\n    gtk_table_attach_defaults(GTK_TABLE(table), entry, 0, 4, 0, 1);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_0, 0, 1, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_1, 0, 1, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_2, 1, 2, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_3, 2, 3, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_4, 0, 1, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_5, 1, 2, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_6, 2, 3, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_7, 0, 1, 1, 2);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_8, 1, 2, 1, 2);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_9, 2, 3, 1, 2);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_add, 1, 2, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_minus, 2, 3, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_mul , 3, 4, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_div, 3, 4, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_equal, 3, 4, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_delete, 3, 4, 1, 2);\n    // 显示\n    gtk_widget_show_all(window);\n    // 循环\n    gtk_main();\n    return 0;\n}\n```\n\n```shell\ngcc -o main main.c `pkg-config --libs -cflags gtk+-3.0`\n```\n\n运行结果\n\n![计算器](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/gtk%E5%AE%B9%E5%99%A8%E5%B8%83%E5%B1%80-%E8%AE%A1%E7%AE%97%E5%99%A81.png)\n\n#### 信号与回调函数\n\nGTK采用了信号与回调函数来处理窗口外部传来的事件、消息或信号。当信号发生时，程序自动调用为信号连接的回调函数。\n\nGTK中的“信号”实际上是一种软件中断。“中断”在我们生活中经常遇到，譬如，我正在房间里打游戏，突然送快递的来了，把正在玩游戏的我给“中断”了，我去签收快递( 处理中断 )，处理完成后，再继续玩我的游戏。GTK中的“信号”就是属于这么一种“中断”，当用户按下按钮的时候，就产生一个“中断”，相当于产生一个信号，接着就会处理这么一个“中断任务”(程序里体验为调用一个函数)。\n\n“信号”在GTK中可以认为一种中断的标志，如按下按钮的标志为\"pressed\",释放按钮的标志为\"released\"，这些标志就相当于 C语言的关键字一样，我们使用的时候必须完全按照它的名字来写。需要注意的是，每个控件的信号标志不一定都一样，如按钮（GtkButton）里有\"pressed\"信号，窗口(GtkWindow)里就没这个信号，每个控件具体有哪个信号，应该查看帮助文档来确定。\n\n按钮的常用信号：\n\n> \"clicked\" : 单击按钮时触发\n\n> \"pressed\" : 按下按钮时触发\n\n> \"released\" : 释放按钮时触发\n\n**信号注册函数**\n\n```c\n// instance：信号发出者，可以认为我们操作的控件，如按下按钮，这个就为按钮指针\n// detailed_signal：信号标志，如\"pressed\"\n// c_handler：回调函数的名称，需要用G_CALLBACK()进行转换\n// data：给回调函数传的参数，gpointer 相当于C语言的 void *\n// 返回值：注册函数的标志\ngulong g_signal_connect(gpointer instance, const gchar *detailed_signal, GCallback c_handler, gpointer data);\n```\n\n例如\n\n```c\ng_signal_connect(button, \"pressed\",G_CALLBACK(callback), NULL);\n```\n\n当按下button按钮时，就会自动调用回调函数callback(相当于处理中断任务)，回调函数callback可以是任意函数，函数名字我们根据需要自行命名，如果不是库函数，我们还得定义这个回调函数，这里需要注意的是，回调函数的写法(返回值，参数)，不是我们想怎么写就怎么写，帮助文档里已经规定好了回调函数应该如何写，如果不按规定来写，可能产生意想不到的错误。\n\n[文档地址](https://developer.gnome.org/gtk3/stable/GtkWidget.html)\n\n回调函数的定义\n\n```c\nvoid callback(GtkButton *button,gpointer data) {\n\n}\n```\n\n示例\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\n\nvoid deal_pressed(GtkButton *button, gpointer user_data) {\n    const char *text = gtk_button_get_label(button);\n    printf(\"%s----%s\\n\", (char *) user_data, text);\n}\n\n\nint main(int argc, char* argv[]) {\n    // 初始化\n    gtk_init(&argc, &argv);\n    // 创建窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 设置窗口边框与内部控件的间隔为15\n    gtk_container_set_border_width(GTK_CONTAINER(window), 15);\n    // 创建一个button\n    GtkWidget *button = gtk_button_new_with_label(\"button1\");\n    // 将button添加到window中\n    gtk_container_add(GTK_CONTAINER(window), button);\n    // 创建一个按钮信号\n    g_signal_connect(button, \"pressed\", G_CALLBACK(deal_pressed), \"hello, world\");\n    // 显示控件\n    gtk_widget_show_all(window);\n    gtk_main();\n    return 0;\n}\n```\n\n#### 完成计算器计算功能\n\n代码\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n#include <string.h>\n\nchar buf[50] = \"\";\n\nvoid deal_num(GtkButton *button, gpointer data) {\n    const char *text = gtk_button_get_label(button);\n    // 如果是退格键\n    if (0 == strcmp(\"c\", text)) {\n        buf[strlen(buf) - 1] = 0;\n    } else {\n        int a = 0, b = 0;\n        char c;\n        // 连接buf和新传入的字符串\n        strcat(buf, text);\n        if (0 == strcmp(\"=\", text)) {\n            printf(\"text=====##%s##\\n\", text);\n            // 从一个字符串中读进与指定格式相符的数据\n            sscanf(buf, \"%d%c%d\", &a, &c, &b);\n            printf(\"---------001-----%c--\\n\", c);\n            if ('+' == c) {\n                sprintf(buf, \"%d\", a + b);\n            } else if ('-' == c) {\n                sprintf(buf, \"%d\", a - b);\n            } else if ('*' == c) {\n                sprintf(buf, \"%d\", a * b);\n            } else if ('/' == c) {\n                sprintf(buf, \"%d\", a / b);\n            }\n        }\n    }\n    gtk_entry_set_text(GTK_ENTRY(data), buf);\n}\n\n\nint main(int argc, char* argv[]) {\n    // 初始化\n    gtk_init(&argc, &argv);\n    // 创建窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建5行4列的表格容器\n    GtkWidget *table = gtk_table_new(5, 4, TRUE);\n    // 将table放入到容器中\n    gtk_container_add(GTK_CONTAINER(window), table);\n    // 创建一个行编辑\n    GtkWidget *entry = gtk_entry_new();\n    // 设置行编辑的内容\n    gtk_entry_set_text(GTK_ENTRY(entry), \"2+2=4\");\n    // 设置行编辑不允许编辑\n    gtk_editable_set_editable(GTK_EDITABLE(entry), FALSE);\n    // 创建0-9数字按钮，+-×/=c功能按钮\n    GtkWidget *button_0 = gtk_button_new_with_label(\"0\");\n    GtkWidget *button_1 = gtk_button_new_with_label(\"1\");\n    GtkWidget *button_2 = gtk_button_new_with_label(\"2\");\n    GtkWidget *button_3 = gtk_button_new_with_label(\"3\");\n    GtkWidget *button_4 = gtk_button_new_with_label(\"4\");\n    GtkWidget *button_5 = gtk_button_new_with_label(\"5\");\n    GtkWidget *button_6 = gtk_button_new_with_label(\"6\");\n    GtkWidget *button_7 = gtk_button_new_with_label(\"7\");\n    GtkWidget *button_8 = gtk_button_new_with_label(\"8\");\n    GtkWidget *button_9 = gtk_button_new_with_label(\"9\");\n    GtkWidget *button_add = gtk_button_new_with_label(\"+\");\n    GtkWidget *button_minus = gtk_button_new_with_label(\"-\");\n    GtkWidget *button_mul = gtk_button_new_with_label(\"*\");\n    GtkWidget *button_div = gtk_button_new_with_label(\"/\");\n    GtkWidget *button_equal = gtk_button_new_with_label(\"=\");\n    GtkWidget *button_delete = gtk_button_new_with_label(\"c\");\n    // 将table放入表格布局中\n    gtk_table_attach_defaults(GTK_TABLE(table), entry, 0, 4, 0, 1);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_0, 0, 1, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_1, 0, 1, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_2, 1, 2, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_3, 2, 3, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_4, 0, 1, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_5, 1, 2, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_6, 2, 3, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_7, 0, 1, 1, 2);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_8, 1, 2, 1, 2);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_9, 2, 3, 1, 2);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_add, 1, 2, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_minus, 2, 3, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_mul, 3, 4, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_div, 3, 4, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_equal, 3, 4, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_delete, 3, 4, 1, 2);\n\n    //7.注册信号函数，把entry传给回调函数deal_num()\n    g_signal_connect(button_0, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_1, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_2, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_3, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_4, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_5, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_6, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_7, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_8, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_9, \"pressed\", G_CALLBACK(deal_num), entry);\n\n    g_signal_connect(button_add, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_mul, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_div, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_minus, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_equal, \"pressed\", G_CALLBACK(deal_num), entry);\n\n    // 显示\n    gtk_widget_show_all(window);\n    // 循环\n    gtk_main();\n    return 0;\n}\n```\n\n结果(并不完美)\n\n![计算器](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/gtk-%E8%AE%A1%E7%AE%97%E5%99%A8.gif)\n\n#### glade\n\nglade是GTK＋的界面辅助设计工具，可以通过拖放控件的方式快速设计出用户界面，这样的优势在于在设计的同时能直观地看到界面上的控件，并且可以随时调整界面上的设计。\n\n用glade设计的图形用户界面是以XML格式的文件保存，它描述了控件的结构、每个控件的属性。用户可以动态加载这个界面文件。而且，界面和程序逻辑是完全分离，用户修改了界面，也不需要重新编译程序。\n\n**安装**\n\n```shell\n# ubuntu \n$ sudo apt-get install glade libglade2-dev\n```\n\n笔者是在软件中心直接下载安装的\n\n**代码引入**\n\nglade文件\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!-- Generated with glade 3.22.1 -->\n<interface>\n  <requires lib=\"gtk+\" version=\"3.20\"/>\n  <object class=\"GtkWindow\" id=\"window1\">\n    <property name=\"name\">window1</property>\n    <property name=\"can_focus\">False</property>\n    <property name=\"title\" translatable=\"yes\">第一个顶层窗口</property>\n    <child type=\"titlebar\">\n      <placeholder/>\n    </child>\n    <child>\n      <object class=\"GtkLayout\" id=\"layout1\">\n        <property name=\"name\">layout1</property>\n        <property name=\"visible\">True</property>\n        <property name=\"can_focus\">False</property>\n        <child>\n          <object class=\"GtkEntry\" id=\"entry1\">\n            <property name=\"name\">search_input</property>\n            <property name=\"width_request\">200</property>\n            <property name=\"height_request\">40</property>\n            <property name=\"visible\">True</property>\n            <property name=\"can_focus\">True</property>\n            <property name=\"text\" translatable=\"yes\">search_input</property>\n            <property name=\"primary_icon_tooltip_text\" translatable=\"yes\">search_input</property>\n          </object>\n          <packing>\n            <property name=\"x\">10</property>\n            <property name=\"y\">10</property>\n          </packing>\n        </child>\n        <child>\n          <object class=\"GtkButton\" id=\"button1\">\n            <property name=\"label\" translatable=\"yes\">搜索</property>\n            <property name=\"name\">search_button</property>\n            <property name=\"width_request\">100</property>\n            <property name=\"height_request\">40</property>\n            <property name=\"visible\">True</property>\n            <property name=\"can_focus\">True</property>\n            <property name=\"receives_default\">True</property>\n          </object>\n          <packing>\n            <property name=\"x\">220</property>\n            <property name=\"y\">10</property>\n          </packing>\n        </child>\n        <child>\n          <object class=\"GtkButton\" id=\"button2\">\n            <property name=\"label\" translatable=\"yes\">查看</property>\n            <property name=\"name\">show_button</property>\n            <property name=\"width_request\">100</property>\n            <property name=\"height_request\">40</property>\n            <property name=\"visible\">True</property>\n            <property name=\"can_focus\">True</property>\n            <property name=\"receives_default\">True</property>\n          </object>\n          <packing>\n            <property name=\"x\">350</property>\n            <property name=\"y\">10</property>\n          </packing>\n        </child>\n      </object>\n    </child>\n  </object>\n</interface>\n```\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // 初始化\n    gtk_init(&argc, &argv);\n    // 创建GtkBuilder对象\n    GtkBuilder *builder = gtk_builder_new();\n    // 读取glade文件\n    if(!gtk_builder_add_from_file(builder, \"../1.glade\", NULL)) {\n        printf(\"无法打开文件\");\n    }\n    // 获取窗口指针\n    GtkWidget *window1 = GTK_WIDGET(gtk_builder_get_object(builder, \"window1\"));\n\n    // 显示\n    gtk_widget_show_all(window1);\n    // 循环\n    gtk_main();\n    return 0;\n}\n```\n\n#### 图片控件\n\n图片控件的创建：\n\n```c \n// filename：图片的名字，带路径的话需要加上路径( 相对或绝对 )\nGtkWidget *gtk_image_new_from_file( const gchar *filename );\n```\n\n通过上面方法创建的图片控件，以图片默认大小来显示，不能修改其大小。如果要改变图片的大小，我们要借助图片资源对象GdkPixbuf，需要注意的是，GdkPixbuf不属于控件类，它以 Gdk 开头。\n\n图片资源对象pixbuf的创建：\n\n```c\n// filename：图片的名字，带路径的话需要加上路径( 相对或绝对 )\n// error：储存错误的指针\n// 返回值：pixbuf指针\nGdkPixbuf *gdk_pixbuf_new_from_file(const gchar *filename, GError **error);\n```\n\n设置图片的大小：\n\n```c\n// src：gdk_pixbuf_new_from_file()的返回值\n// dest_width：图片的宽度\n// dest_height：图片的高度\n// interp_type：是一个枚举变量，标志图片的加载速度和质量，常用GDK_INTERP_BILINEAR\n// 返回值：指定大小好的pixbuf指针\nGdkPixbuf *gdk_pixbuf_scale_simple(const GdkPixbuf *src, int dest_width, int dest_height, GdkInterpType interp_type);\n```\n\n通过gdk_pixbuf_new_from_file(), gdk_pixbuf_scale_simple()创建的pixbuf，它会动态分配空间，占用资源，用完后，需要人为释放资源。\n\n释放资源：\n\n```c\nvoid g_object_unref(GtkObject *object);\n```\n\n通过pixbuf来创建图片控件：\n\n```c\n// pixbuf：指定好大小的pixbuf\n// 返回值：图片控件指针\nGtkWidget *gtk_image_new_from_pixbuf(GdkPixbuf *pixbuf );\n```\n\n图片控件重新设置一张图片(pixbuf)：\n\n```c\n// image：图片控件指针\n// pixbuf：指定好大小的pixbuf\nvoid gtk_image_set_from_pixbuf(GtkImage *image, GdkPixbuf *pixbuf );\n```\n\n示例代码\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // 初始化\n    gtk_init(&argc, &argv);\n    // 创建一个window\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建水平容器\n    GtkWidget *hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 10);\n    // 添加到window\n    gtk_container_add(GTK_CONTAINER(window), hbox);\n    // 创建图片控件\n    GtkWidget *image1 = gtk_image_new_from_file(\"../img/1.png\");\n    // 将image添加到box\n    gtk_container_add(GTK_CONTAINER(hbox), image1);\n    // 创建pixbuf\n    GdkPixbuf *src = gdk_pixbuf_new_from_file(\"../img/1.png\", NULL);\n    // 修改图片大小\n    GdkPixbuf *dst = gdk_pixbuf_scale_simple(src, 100, 100, GDK_INTERP_BILINEAR);\n    GtkWidget *image2 = gtk_image_new_from_pixbuf(dst);\n    // 释放pxibuf资源\n    g_object_unref(src);\n    g_object_unref(dst);\n    // 将image2添加到box\n    gtk_container_add(GTK_CONTAINER(hbox), image2);\n    // 获取控件里的pixbuf\n    GdkPixbuf *tmp = gtk_image_get_pixbuf(GTK_IMAGE(image2));\n    GtkWidget *image3 = gtk_image_new_from_pixbuf(tmp);\n    g_object_unref(tmp);\n    gtk_container_add(GTK_CONTAINER(hbox), image3);\n    // 给创建的图片控件重新设置图片\n    GtkWidget *image4 = gtk_image_new_from_file(\"../img/1.png\");\n    gtk_container_add(GTK_CONTAINER(hbox), image4);\n    src = gdk_pixbuf_new_from_file(\"../img/2.png\", NULL);\n    dst = gdk_pixbuf_scale_simple(src, 200, 200, GDK_INTERP_BILINEAR);\n    gtk_image_set_from_pixbuf(GTK_IMAGE(image4), dst);\n    g_object_unref(src);\n    g_object_unref(dst);\n    // 显示所有控件\n    gtk_widget_show_all(window);\n    // 循环\n    gtk_main();\n    return 0;\n}\n```\n\n#### 进度条控件\n\n[文档](https://developer.gnome.org/gtk3/stable/GtkProgressBar.html#gtk-progress-bar-get-fraction)\n\n进度条的创建\n\n```c\n// 返回值：进度条指针\nGtkWidget *gtk_progress_bar_new(void);\n```\n\n设置进度条显示的进度比例\n\n```c\n// pbar：需要操作的进度条\n// fraction：0.0到1.0\nvoid gtk_progress_bar_set_fraction(GtkProgressBar *pbar, gdouble fraction);\n```\n\n获取进度条显示的进度比例\n\n```c\n// pbar：需要操作的进度条\n// 返回值：进度比例\ngdouble  gtk_progress_bar_get_fraction (GtkProgressBar *pbar);\n```\n\n设置滑槽上的文本显示\n\n```c\n// pbar：需要操作的进度条\n// text：设置的文本内容\nvoid gtk_progress_bar_set_text(GtkProgressBar *pbar, gchar *text);\n```\n\n设置进度条的移动方向gtk+-2版本\n\n```c\n// pbar：需要操作的进度条\n// orientation：移动方向，它是一个枚举变量\n// GTK_PROGRESS_LEFT_TO_RIGHT：从左向右 \n// GTK_PROGRESS_RIGHT_TO_LEFT：从右向左 \n// GTK_PROGRESS_BOTTOM_TO_TOP：从下向上 \n// GTK_PROGRESS_TOP_TO_BOTTOM：从上向下\nvoid gtk_progress_bar_set_orientation(GtkProgressBar *pbar, GtkProgressBarOrientation orientation);\n```\n\n获取进度条的方向gtk+-2版本\n\n```c\n// pbar：需要操作的进度条\n// 返回值：进度条的方向，它是一个枚举类型\nGtkProgressBarOrientationgtk_progress_bar_get_orientation(GtkProgressBar *pbar);\n```\n\n设置进度条的移动方向gtk+-3版本\n\n```c\nvoid gtk_progress_bar_set_inverted (GtkProgressBar *pbar, gboolean inverted);\n```\n\n```c\ngboolean gtk_progress_bar_get_inverted (GtkProgressBar *pbar);\n```\n\n```c\n#include <gtk/gtk.h>\n\n\n//回调函数，切换进度条的移动方向\nvoid toggle_orientation(GtkWidget *widget, gpointer data)\n{\n    switch (gtk_progress_bar_get_inverted(GTK_PROGRESS_BAR(data)) ) {\n        case TRUE:\n            gtk_progress_bar_set_inverted(GTK_PROGRESS_BAR(data), FALSE);\n            break;\n        case FALSE:\n            gtk_progress_bar_set_inverted(GTK_PROGRESS_BAR(data), TRUE);\n            break;\n        default:\n            break;\n    }\n}\n\n\n//回调函数，更新进度条，这样可以看到进度条的移动\nvoid callback(GtkWidget *widget, gpointer data)\n{\n    gdouble new_val = gtk_progress_bar_get_fraction(GTK_PROGRESS_BAR(data)) +0.05;\n\n    if (new_val > 1.0) {\n        new_val = 0.0;\n    }\n\n    //设置进度条新值\n    gtk_progress_bar_set_fraction(GTK_PROGRESS_BAR(data), new_val);\n\n}\n\nint main(int argc, char *argv[])\n{\n    //1.gtk环境的初始化\n    gtk_init(&argc, &argv);\n\n    //2.创建一个窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    //设置窗口的标题\n    gtk_window_set_title(GTK_WINDOW(window), \"gtk_progress_bar\");\n    //设置窗口边框宽度\n    gtk_container_set_border_width(GTK_CONTAINER(window), 10);\n\n    //3.设置窗口的最小大小\n    gtk_widget_set_size_request(window, 300, 200);\n\n    //4.窗口关联destroy信号到gtk_main_quit\n    g_signal_connect(window, \"destroy\", G_CALLBACK(gtk_main_quit), NULL);\n\n    //5.创建一个垂直容器\n    GtkWidget *vbox = gtk_box_new(GTK_ORIENTATION_VERTICAL, 5);\n    //将vbox添加到window中\n    gtk_container_add(GTK_CONTAINER(window), vbox);\n\n    //6.创建一个进度条\n    GtkWidget *progress = gtk_progress_bar_new();\n    //将progress添加到vbox中\n    gtk_container_add(GTK_CONTAINER(vbox), progress);\n\n    //7.设置进度条的百分比为50%\n    gtk_progress_bar_set_fraction(GTK_PROGRESS_BAR(progress), 0.5);\n\n    //8.设置进度条上显示的文字\n    gtk_progress_bar_set_text(GTK_PROGRESS_BAR(progress), \"some text\");\n\n    //9.添加一个button1按钮,切换方向\n    GtkWidget *button1 = gtk_button_new_with_label(\"right to lift\");\n    gtk_container_add(GTK_CONTAINER(vbox), button1);\n    g_signal_connect(button1, \"clicked\", G_CALLBACK(    toggle_orientation   ), progress);\n\n    //10.添加一个button2，移动进度条\n    GtkWidget *button2 = gtk_button_new_with_label(\"add\");\n    gtk_container_add(GTK_CONTAINER(vbox), button2);\n    g_signal_connect(button2, \"clicked\", G_CALLBACK(callback), progress);\n\n    //11.显示所欲窗口\n    gtk_widget_show_all(window);\n\n    //12.主事件循环\n    gtk_main();\n\n    return 0;\n}\n\n```\n\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/c开发gtk+-入门基础.md","raw":"---\ntitle: c开发gtk+入门基础\ndate: 2019-07-24 13:58:51\ntags:\n---\n#### gdk+介绍\n\n> gtk+是c语言编写的用于开发图形界面程序的函数库。gtk+来源于gimp（gnu image minipulation program），gtk+在gdk（gimp drawing kit）基础上创建，并进行封装。\n\n#### linux安装\n\n```shell\n# http://ftp.gnome.org/pub/gnome/sources/gtk+/3.24/\n$ wget http://ftp.gnome.org/pub/gnome/sources/gtk+/3.24/gtk+-3.24.10.tar.xz\n$ tar xvfJ gtk+-3.24.10.tar.xz\n$ ./configure --prefix=/user/include/gtk3.24\n$ make && sudo make install\n$ sudo ldconfig\n# 设置LD_LIBRARY_PATH\n$ LD_LIBRARY_PATH=\"/opt/gtk/lib\"\n$ PATH=\"/opt/gtk/bin:$PATH\"\n$ export LD_LIBRARY_PATH PATH\n```\n\n#### 简单的空白窗口\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    gtk_init(&argc, &argv);\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    gtk_widget_show(window);\n    gtk_main();\n    return 0;\n}\n```\n\n```shell\n$ gcc -o main main.c `pkg-config --libs -cflags gtk+-3.0`\n```\n\ngtk_init (&argc, &argv); 所有 GTK应用程序都要调用该函数，而且必须在控件定义之前使用，它为我们设置一些缺省值( 例如视觉和颜色 )映射这个函数将函数库初始化，设置缺省的信号处理函数，并检查通过命令行传递给应用程序的参数，自动完成一些必要的初始化工作。\n\ngtk_main()是在每个Gtk应用程序都要调用的函数。程序运行停在这里等待事件(如键盘事件或鼠标事件)的发生，等待用户来操作窗口\n\ngtk_window_new()的功能创建一个窗口并返回这个窗口的控件指针。GTK_WINDOW_TOPLEVEL指明窗口的类型为最上层的主窗口，它最常用。接着创建一个GtkWidget *类型的window变量来接收。GtkWidget是GTK+控件类型，GtkWidget * 能指向任何控件的指针类型。\n\ngtk_widget_show(window)；用来显示上一步创建的窗口控件。在这个简单例子里，所有事件都被忽略。用鼠标点击窗口右上角的“×”按钮也不能将窗口关闭。我们可以在终端敲 Ctrl + C 关闭程序。\n\n#### 控件\n\nGTK中控件主要分为两类：容器控件，非容器控件。\n\n容器控件：它可以容纳别的控件，我们可以理解为盒子，盒子拿来装东西。容器控件又分为两类，一类只能容纳一个控件，如窗口，按钮；另一类能容纳多个控件，如布局控件。\n\n非容器控件：它不可以容纳别的控件，如标签、行编辑。\n\n前面我们写的空白窗口是能容纳一个控件的控件，现在我们要做的是，给这个窗口添加一个按钮。\n\n首先，我们需要创建一个按钮，然后需要把按钮添加到窗口，接着，显示按钮控件。\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // gtk初始化\n    gtk_init(&argc, &argv);\n    // 创建一个顶层窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建一个button容器\n    GtkWidget *button = gtk_button_new_with_label(\"hello gtk\");\n    // 将button放入窗口中，\n    gtk_container_add(GTK_CONTAINER(window), button);\n    // 显示button\n    gtk_widget_show(button);\n    // 显示window\n    gtk_widget_show(window);\n    gtk_main();\n    return 0;\n}\n```\n\n```c\nvoid gtk_container_add(GtkContainer *container, GtkWidget *widget);\n```\n\n这里我们是把按钮添加到窗口容器里，widget为按钮指针(以上代码的button)，container为窗口指针(以上代码的window)，这里需要注意的是，我们创建的窗口(window)返回值为GtkWidget *类型，而gtk_container_add()的第一个参数为GtkContainer *类型，由于 GtkWidget *类型的变量为指向任何控件的万能指针，所以，在函数传参时，根据参数类型进行相应的转换，如：\n\n```c\ngtk_container_add( (GtkContainer *)window, button);\n```\n\nC语言里，我们常用这种方法转换。在GTK中，很多内部变量指针类型转换都定义了宏定义，如：\n\n```c\n#define GTK_CONTAINER(x) (GtkContainer *)(x)\n```\n\n所以，我们还可以这么写：\n\n```c\ngtk_container_add(GTK_CONTAINER(window), button);\n```\n\n那么，我们如何知道，哪个类型对应哪个宏定义呢？把要转换类型名字全部变为大写，同时，单词和单词之间以下划线“_”连接，然后，这个名字就是哪个宏定义的名字，如，(GtkButton *)x用宏定义的方法为 GTK_BUTTON(x)。\n\n上面的代码，我们是按钮和窗口都得通过gtk_widget_show()显示出来：\n\n```c\ngtk_widget_show(button);// 显示按钮\ngtk_widget_show(window);// 显示窗口\n```\n\n但是，假如，窗口里有100个控件，还是这样一个一个地显示出来会比较麻烦，这时候，我们可以通过gtk_widget_show_all()显示所有的控件，里面需要传的是容纳控件的那个容器(这里为窗口)。这样，容器上的控件也会跟着显示。\n\n```c\ngtk_widget_show_all()\n```\n\n#### 布局容器-水平布局\n\n如果我们希望窗口里多放添加几个控件，直接添加是不成功的，因为窗口只能容纳一个控件的容器。这时候，我们需要借助布局容器，我们先把布局容器添加到窗口里，然后再把所需要添加的控件放在布局容器里。\n\n布局容器的主要分类：水平布局( GtkHBox)、垂直布局(GtkVBox )、表格布局(GtkTable)、固定布局(GtkFixed )。\n\n**创建一个盒子布局**\n\n```c\n// orientation参数: GTK_ORIENTATION_HORIZONTAL GTK_ORIENTATION_VERTICAL 两个可选值 spacing参数是单元格之间的间隙\nint gtk_box_new(int orientation, int spacing);\n```\n\n以下代码显示水平容器布局方式，垂直容器类似\n\n```c \n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // gtk初始化\n    gtk_init(&argc, &argv);\n    // 创建一个顶层窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建水平容器\n    // GtkWidget *hbox = gtk_hbox_new(TRUE, 10);  // gtk+2版本使用\n    GtkWidget *hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 10);  // gtk+3版本使用\n    // 将水平容器添加到窗口\n    gtk_container_add(GTK_CONTAINER(window), hbox);\n    // 创建一个button容器\n    GtkWidget *button1 = gtk_button_new_with_label(\"button1\");\n    // 将button放入水平容器中\n    gtk_container_add(GTK_CONTAINER(hbox), button1);\n    // 重复创建两个\n    GtkWidget *button2 = gtk_button_new_with_label(\"button2\");\n    GtkWidget *button3 = gtk_button_new_with_label(\"button3\");\n    gtk_container_add(GTK_CONTAINER(hbox), button2);\n    gtk_container_add(GTK_CONTAINER(hbox), button3);\n    // 显示全部窗口\n    gtk_widget_show_all(window);\n    gtk_main();\n    return 0;\n}\n```\n\n#### 布局容器-表格布局\n\n**添加表格布局容器**\n\n```c\n// rows: 行数, coumns: 列数, homogeneous：容器内表格的大小是否相等, 返回值：表格布局容器指针\nGtkWidget *gtk_table_new(guint rows, guint columns, gboolean homogeneous);\n```\n\n**布局容器添加控件**\n\n```c\n// table: 容纳控件的容器, widget: 要添加的控件, 后四个参数为控件摆放的坐标，规则如下：\nvoid gtk_table_attach_defaults(GtkTable *table, GtkWidget *widget, guint left_attach, guint right_attach, guint top_attach, guint bottom_attach);\n```\n\n![示意图](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/gtk%E8%A1%A8%E6%A0%BC%E5%B8%83%E5%B1%80%E7%A4%BA%E6%84%8F%E5%9B%BE.png)\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // gtk初始化\n    gtk_init(&argc, &argv);\n    // 创建一个顶层窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建一个表格容器\n    GtkWidget *table = gtk_table_new(2, 2, TRUE); // gtk+2版本\n    gtk_container_add(GTK_CONTAINER(window), table);\n    // 创建button1， button2, button3\n    GtkWidget *button1 = gtk_button_new_with_label(\"button1\");\n    GtkWidget *button2 = gtk_button_new_with_label(\"button2\");\n    GtkWidget *button3 = gtk_button_new_with_label(\"button3\");\n    // 将button放入table中\n    gtk_table_attach_defaults(GTK_TABLE(table), button1, 0, 1, 0, 1);\n    gtk_table_attach_defaults(GTK_TABLE(table), button2, 1, 2, 0, 1);\n    gtk_table_attach_defaults(GTK_TABLE(table), button3, 0, 2, 1, 2);\n    // 显示所有窗口\n    gtk_widget_show_all(window);\n    gtk_main();\n    return 0;\n}\n```\n\n#### 布局容器-固定布局\n\n水平、垂直和表格布局容器，控件会跟着容器大小的变化进行自动适应，而固定布局容器里的控件则不会跟着变化( 则固定不变 )。\n\n**固定布局的创建**\n\n```c\nGtkWidget *gtk_fixed_new(void);\n```\n\n**添加控件**\n\n```c\n// fixed：容纳控件的容器, widget：要添加的控件, x, y：控件摆放位置的起点坐标\nvoid gtk_fixed_put(GtkFixed *fixed, GtkWidget *widget, gint x, gint y );\n```\n\n**设置控件的大小( 宽和高 )**\n\n```c\n// widget：需要设置的控件, width：宽度, height：高度\nvoid gtk_widget_set_size_request(GtkWidget *widget, gint width, gint height);\n```\n\n**移动固定布局里控件的位置**\n\n```c\n// fixed：固定布局容器, widget：需要移动的控件, x, y: 移动的位置\nvoid gtk_fixed_move(GtkFixed *fixed, GtkWidget *widget, gint x, gint y);\n```\n\n示例代码\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // gtk初始化\n    gtk_init(&argc, &argv);\n    // 创建一个顶层窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建一个固定布局容器\n    GtkWidget *fixed = gtk_fixed_new();\n    // 将fixed添加到window中\n    gtk_container_add(GTK_CONTAINER(window), fixed);\n    // 创建button\n    GtkWidget *button1 = gtk_button_new_with_label(\"button1\");\n    GtkWidget *button2 = gtk_button_new_with_label(\"button2\");\n    // 将button添加到fixed\n    gtk_fixed_put(GTK_FIXED(fixed), button1, 0, 0);\n    gtk_fixed_put(GTK_FIXED(fixed), button2, 0, 0);\n    // 移动button位置\n    gtk_fixed_move(GTK_FIXED(fixed), button2, 150, 150);\n    // 设置button大小\n    gtk_widget_set_size_request(button2, 100, 50);\n    // 显示所有窗口\n    gtk_widget_show_all(window);\n    gtk_main();\n    return 0;\n}\n```\n\n#### 容器布局练习-计算器\n\n**编辑控件( GtkEntry )**\n\n```c\n// 创建\nGtkWidget * gtk_entry_new(void);\n// 编辑\nvoid gtk_entry_set_text (GtkEntry *entry,const gchar *text);\n// 设置行编辑是否允许编辑\nvoid gtk_editable_set_editable(GtkEditable *editable, gboolean is_editable);\n```\n\n示例代码\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // 初始化\n    gtk_init(&argc, &argv);\n    // 创建窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建5行4列的表格容器\n    GtkWidget *table = gtk_table_new(5, 4, TRUE);\n    // 将table放入到容器中\n    gtk_container_add(GTK_CONTAINER(window), table);\n    // 创建一个行编辑\n    GtkWidget *entry = gtk_entry_new();\n    // 设置行编辑的内容\n    gtk_entry_set_text(GTK_ENTRY(entry), \"2+2=4\");\n    // 设置行编辑不允许编辑\n    gtk_editable_set_editable(GTK_EDITABLE(entry), FALSE);\n    // 创建0-9数字按钮，+-×/=c功能按钮\n    GtkWidget *button_0 = gtk_button_new_with_label(\"0\");\n    GtkWidget *button_1 = gtk_button_new_with_label(\"1\");\n    GtkWidget *button_2 = gtk_button_new_with_label(\"2\");\n    GtkWidget *button_3 = gtk_button_new_with_label(\"3\");\n    GtkWidget *button_4 = gtk_button_new_with_label(\"4\");\n    GtkWidget *button_5 = gtk_button_new_with_label(\"5\");\n    GtkWidget *button_6 = gtk_button_new_with_label(\"6\");\n    GtkWidget *button_7 = gtk_button_new_with_label(\"7\");\n    GtkWidget *button_8 = gtk_button_new_with_label(\"8\");\n    GtkWidget *button_9 = gtk_button_new_with_label(\"9\");\n    GtkWidget *button_add = gtk_button_new_with_label(\"+\");\n    GtkWidget *button_minus = gtk_button_new_with_label(\"-\");\n    GtkWidget *button_mul = gtk_button_new_with_label(\"*\");\n    GtkWidget *button_div = gtk_button_new_with_label(\"/\");\n    GtkWidget *button_equal = gtk_button_new_with_label(\"=\");\n    GtkWidget *button_delete = gtk_button_new_with_label(\"c\");\n    // 将table放入表格布局中\n    gtk_table_attach_defaults(GTK_TABLE(table), entry, 0, 4, 0, 1);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_0, 0, 1, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_1, 0, 1, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_2, 1, 2, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_3, 2, 3, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_4, 0, 1, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_5, 1, 2, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_6, 2, 3, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_7, 0, 1, 1, 2);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_8, 1, 2, 1, 2);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_9, 2, 3, 1, 2);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_add, 1, 2, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_minus, 2, 3, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_mul , 3, 4, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_div, 3, 4, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_equal, 3, 4, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_delete, 3, 4, 1, 2);\n    // 显示\n    gtk_widget_show_all(window);\n    // 循环\n    gtk_main();\n    return 0;\n}\n```\n\n```shell\ngcc -o main main.c `pkg-config --libs -cflags gtk+-3.0`\n```\n\n运行结果\n\n![计算器](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/gtk%E5%AE%B9%E5%99%A8%E5%B8%83%E5%B1%80-%E8%AE%A1%E7%AE%97%E5%99%A81.png)\n\n#### 信号与回调函数\n\nGTK采用了信号与回调函数来处理窗口外部传来的事件、消息或信号。当信号发生时，程序自动调用为信号连接的回调函数。\n\nGTK中的“信号”实际上是一种软件中断。“中断”在我们生活中经常遇到，譬如，我正在房间里打游戏，突然送快递的来了，把正在玩游戏的我给“中断”了，我去签收快递( 处理中断 )，处理完成后，再继续玩我的游戏。GTK中的“信号”就是属于这么一种“中断”，当用户按下按钮的时候，就产生一个“中断”，相当于产生一个信号，接着就会处理这么一个“中断任务”(程序里体验为调用一个函数)。\n\n“信号”在GTK中可以认为一种中断的标志，如按下按钮的标志为\"pressed\",释放按钮的标志为\"released\"，这些标志就相当于 C语言的关键字一样，我们使用的时候必须完全按照它的名字来写。需要注意的是，每个控件的信号标志不一定都一样，如按钮（GtkButton）里有\"pressed\"信号，窗口(GtkWindow)里就没这个信号，每个控件具体有哪个信号，应该查看帮助文档来确定。\n\n按钮的常用信号：\n\n> \"clicked\" : 单击按钮时触发\n\n> \"pressed\" : 按下按钮时触发\n\n> \"released\" : 释放按钮时触发\n\n**信号注册函数**\n\n```c\n// instance：信号发出者，可以认为我们操作的控件，如按下按钮，这个就为按钮指针\n// detailed_signal：信号标志，如\"pressed\"\n// c_handler：回调函数的名称，需要用G_CALLBACK()进行转换\n// data：给回调函数传的参数，gpointer 相当于C语言的 void *\n// 返回值：注册函数的标志\ngulong g_signal_connect(gpointer instance, const gchar *detailed_signal, GCallback c_handler, gpointer data);\n```\n\n例如\n\n```c\ng_signal_connect(button, \"pressed\",G_CALLBACK(callback), NULL);\n```\n\n当按下button按钮时，就会自动调用回调函数callback(相当于处理中断任务)，回调函数callback可以是任意函数，函数名字我们根据需要自行命名，如果不是库函数，我们还得定义这个回调函数，这里需要注意的是，回调函数的写法(返回值，参数)，不是我们想怎么写就怎么写，帮助文档里已经规定好了回调函数应该如何写，如果不按规定来写，可能产生意想不到的错误。\n\n[文档地址](https://developer.gnome.org/gtk3/stable/GtkWidget.html)\n\n回调函数的定义\n\n```c\nvoid callback(GtkButton *button,gpointer data) {\n\n}\n```\n\n示例\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\n\nvoid deal_pressed(GtkButton *button, gpointer user_data) {\n    const char *text = gtk_button_get_label(button);\n    printf(\"%s----%s\\n\", (char *) user_data, text);\n}\n\n\nint main(int argc, char* argv[]) {\n    // 初始化\n    gtk_init(&argc, &argv);\n    // 创建窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 设置窗口边框与内部控件的间隔为15\n    gtk_container_set_border_width(GTK_CONTAINER(window), 15);\n    // 创建一个button\n    GtkWidget *button = gtk_button_new_with_label(\"button1\");\n    // 将button添加到window中\n    gtk_container_add(GTK_CONTAINER(window), button);\n    // 创建一个按钮信号\n    g_signal_connect(button, \"pressed\", G_CALLBACK(deal_pressed), \"hello, world\");\n    // 显示控件\n    gtk_widget_show_all(window);\n    gtk_main();\n    return 0;\n}\n```\n\n#### 完成计算器计算功能\n\n代码\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n#include <string.h>\n\nchar buf[50] = \"\";\n\nvoid deal_num(GtkButton *button, gpointer data) {\n    const char *text = gtk_button_get_label(button);\n    // 如果是退格键\n    if (0 == strcmp(\"c\", text)) {\n        buf[strlen(buf) - 1] = 0;\n    } else {\n        int a = 0, b = 0;\n        char c;\n        // 连接buf和新传入的字符串\n        strcat(buf, text);\n        if (0 == strcmp(\"=\", text)) {\n            printf(\"text=====##%s##\\n\", text);\n            // 从一个字符串中读进与指定格式相符的数据\n            sscanf(buf, \"%d%c%d\", &a, &c, &b);\n            printf(\"---------001-----%c--\\n\", c);\n            if ('+' == c) {\n                sprintf(buf, \"%d\", a + b);\n            } else if ('-' == c) {\n                sprintf(buf, \"%d\", a - b);\n            } else if ('*' == c) {\n                sprintf(buf, \"%d\", a * b);\n            } else if ('/' == c) {\n                sprintf(buf, \"%d\", a / b);\n            }\n        }\n    }\n    gtk_entry_set_text(GTK_ENTRY(data), buf);\n}\n\n\nint main(int argc, char* argv[]) {\n    // 初始化\n    gtk_init(&argc, &argv);\n    // 创建窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建5行4列的表格容器\n    GtkWidget *table = gtk_table_new(5, 4, TRUE);\n    // 将table放入到容器中\n    gtk_container_add(GTK_CONTAINER(window), table);\n    // 创建一个行编辑\n    GtkWidget *entry = gtk_entry_new();\n    // 设置行编辑的内容\n    gtk_entry_set_text(GTK_ENTRY(entry), \"2+2=4\");\n    // 设置行编辑不允许编辑\n    gtk_editable_set_editable(GTK_EDITABLE(entry), FALSE);\n    // 创建0-9数字按钮，+-×/=c功能按钮\n    GtkWidget *button_0 = gtk_button_new_with_label(\"0\");\n    GtkWidget *button_1 = gtk_button_new_with_label(\"1\");\n    GtkWidget *button_2 = gtk_button_new_with_label(\"2\");\n    GtkWidget *button_3 = gtk_button_new_with_label(\"3\");\n    GtkWidget *button_4 = gtk_button_new_with_label(\"4\");\n    GtkWidget *button_5 = gtk_button_new_with_label(\"5\");\n    GtkWidget *button_6 = gtk_button_new_with_label(\"6\");\n    GtkWidget *button_7 = gtk_button_new_with_label(\"7\");\n    GtkWidget *button_8 = gtk_button_new_with_label(\"8\");\n    GtkWidget *button_9 = gtk_button_new_with_label(\"9\");\n    GtkWidget *button_add = gtk_button_new_with_label(\"+\");\n    GtkWidget *button_minus = gtk_button_new_with_label(\"-\");\n    GtkWidget *button_mul = gtk_button_new_with_label(\"*\");\n    GtkWidget *button_div = gtk_button_new_with_label(\"/\");\n    GtkWidget *button_equal = gtk_button_new_with_label(\"=\");\n    GtkWidget *button_delete = gtk_button_new_with_label(\"c\");\n    // 将table放入表格布局中\n    gtk_table_attach_defaults(GTK_TABLE(table), entry, 0, 4, 0, 1);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_0, 0, 1, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_1, 0, 1, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_2, 1, 2, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_3, 2, 3, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_4, 0, 1, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_5, 1, 2, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_6, 2, 3, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_7, 0, 1, 1, 2);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_8, 1, 2, 1, 2);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_9, 2, 3, 1, 2);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_add, 1, 2, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_minus, 2, 3, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_mul, 3, 4, 2, 3);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_div, 3, 4, 3, 4);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_equal, 3, 4, 4, 5);\n    gtk_table_attach_defaults(GTK_TABLE(table), button_delete, 3, 4, 1, 2);\n\n    //7.注册信号函数，把entry传给回调函数deal_num()\n    g_signal_connect(button_0, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_1, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_2, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_3, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_4, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_5, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_6, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_7, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_8, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_9, \"pressed\", G_CALLBACK(deal_num), entry);\n\n    g_signal_connect(button_add, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_mul, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_div, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_minus, \"pressed\", G_CALLBACK(deal_num), entry);\n    g_signal_connect(button_equal, \"pressed\", G_CALLBACK(deal_num), entry);\n\n    // 显示\n    gtk_widget_show_all(window);\n    // 循环\n    gtk_main();\n    return 0;\n}\n```\n\n结果(并不完美)\n\n![计算器](https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/gtk-%E8%AE%A1%E7%AE%97%E5%99%A8.gif)\n\n#### glade\n\nglade是GTK＋的界面辅助设计工具，可以通过拖放控件的方式快速设计出用户界面，这样的优势在于在设计的同时能直观地看到界面上的控件，并且可以随时调整界面上的设计。\n\n用glade设计的图形用户界面是以XML格式的文件保存，它描述了控件的结构、每个控件的属性。用户可以动态加载这个界面文件。而且，界面和程序逻辑是完全分离，用户修改了界面，也不需要重新编译程序。\n\n**安装**\n\n```shell\n# ubuntu \n$ sudo apt-get install glade libglade2-dev\n```\n\n笔者是在软件中心直接下载安装的\n\n**代码引入**\n\nglade文件\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!-- Generated with glade 3.22.1 -->\n<interface>\n  <requires lib=\"gtk+\" version=\"3.20\"/>\n  <object class=\"GtkWindow\" id=\"window1\">\n    <property name=\"name\">window1</property>\n    <property name=\"can_focus\">False</property>\n    <property name=\"title\" translatable=\"yes\">第一个顶层窗口</property>\n    <child type=\"titlebar\">\n      <placeholder/>\n    </child>\n    <child>\n      <object class=\"GtkLayout\" id=\"layout1\">\n        <property name=\"name\">layout1</property>\n        <property name=\"visible\">True</property>\n        <property name=\"can_focus\">False</property>\n        <child>\n          <object class=\"GtkEntry\" id=\"entry1\">\n            <property name=\"name\">search_input</property>\n            <property name=\"width_request\">200</property>\n            <property name=\"height_request\">40</property>\n            <property name=\"visible\">True</property>\n            <property name=\"can_focus\">True</property>\n            <property name=\"text\" translatable=\"yes\">search_input</property>\n            <property name=\"primary_icon_tooltip_text\" translatable=\"yes\">search_input</property>\n          </object>\n          <packing>\n            <property name=\"x\">10</property>\n            <property name=\"y\">10</property>\n          </packing>\n        </child>\n        <child>\n          <object class=\"GtkButton\" id=\"button1\">\n            <property name=\"label\" translatable=\"yes\">搜索</property>\n            <property name=\"name\">search_button</property>\n            <property name=\"width_request\">100</property>\n            <property name=\"height_request\">40</property>\n            <property name=\"visible\">True</property>\n            <property name=\"can_focus\">True</property>\n            <property name=\"receives_default\">True</property>\n          </object>\n          <packing>\n            <property name=\"x\">220</property>\n            <property name=\"y\">10</property>\n          </packing>\n        </child>\n        <child>\n          <object class=\"GtkButton\" id=\"button2\">\n            <property name=\"label\" translatable=\"yes\">查看</property>\n            <property name=\"name\">show_button</property>\n            <property name=\"width_request\">100</property>\n            <property name=\"height_request\">40</property>\n            <property name=\"visible\">True</property>\n            <property name=\"can_focus\">True</property>\n            <property name=\"receives_default\">True</property>\n          </object>\n          <packing>\n            <property name=\"x\">350</property>\n            <property name=\"y\">10</property>\n          </packing>\n        </child>\n      </object>\n    </child>\n  </object>\n</interface>\n```\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // 初始化\n    gtk_init(&argc, &argv);\n    // 创建GtkBuilder对象\n    GtkBuilder *builder = gtk_builder_new();\n    // 读取glade文件\n    if(!gtk_builder_add_from_file(builder, \"../1.glade\", NULL)) {\n        printf(\"无法打开文件\");\n    }\n    // 获取窗口指针\n    GtkWidget *window1 = GTK_WIDGET(gtk_builder_get_object(builder, \"window1\"));\n\n    // 显示\n    gtk_widget_show_all(window1);\n    // 循环\n    gtk_main();\n    return 0;\n}\n```\n\n#### 图片控件\n\n图片控件的创建：\n\n```c \n// filename：图片的名字，带路径的话需要加上路径( 相对或绝对 )\nGtkWidget *gtk_image_new_from_file( const gchar *filename );\n```\n\n通过上面方法创建的图片控件，以图片默认大小来显示，不能修改其大小。如果要改变图片的大小，我们要借助图片资源对象GdkPixbuf，需要注意的是，GdkPixbuf不属于控件类，它以 Gdk 开头。\n\n图片资源对象pixbuf的创建：\n\n```c\n// filename：图片的名字，带路径的话需要加上路径( 相对或绝对 )\n// error：储存错误的指针\n// 返回值：pixbuf指针\nGdkPixbuf *gdk_pixbuf_new_from_file(const gchar *filename, GError **error);\n```\n\n设置图片的大小：\n\n```c\n// src：gdk_pixbuf_new_from_file()的返回值\n// dest_width：图片的宽度\n// dest_height：图片的高度\n// interp_type：是一个枚举变量，标志图片的加载速度和质量，常用GDK_INTERP_BILINEAR\n// 返回值：指定大小好的pixbuf指针\nGdkPixbuf *gdk_pixbuf_scale_simple(const GdkPixbuf *src, int dest_width, int dest_height, GdkInterpType interp_type);\n```\n\n通过gdk_pixbuf_new_from_file(), gdk_pixbuf_scale_simple()创建的pixbuf，它会动态分配空间，占用资源，用完后，需要人为释放资源。\n\n释放资源：\n\n```c\nvoid g_object_unref(GtkObject *object);\n```\n\n通过pixbuf来创建图片控件：\n\n```c\n// pixbuf：指定好大小的pixbuf\n// 返回值：图片控件指针\nGtkWidget *gtk_image_new_from_pixbuf(GdkPixbuf *pixbuf );\n```\n\n图片控件重新设置一张图片(pixbuf)：\n\n```c\n// image：图片控件指针\n// pixbuf：指定好大小的pixbuf\nvoid gtk_image_set_from_pixbuf(GtkImage *image, GdkPixbuf *pixbuf );\n```\n\n示例代码\n\n```c\n#include <stdio.h>\n#include <gtk/gtk.h>\n\nint main(int argc, char* argv[]) {\n    // 初始化\n    gtk_init(&argc, &argv);\n    // 创建一个window\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    // 创建水平容器\n    GtkWidget *hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, 10);\n    // 添加到window\n    gtk_container_add(GTK_CONTAINER(window), hbox);\n    // 创建图片控件\n    GtkWidget *image1 = gtk_image_new_from_file(\"../img/1.png\");\n    // 将image添加到box\n    gtk_container_add(GTK_CONTAINER(hbox), image1);\n    // 创建pixbuf\n    GdkPixbuf *src = gdk_pixbuf_new_from_file(\"../img/1.png\", NULL);\n    // 修改图片大小\n    GdkPixbuf *dst = gdk_pixbuf_scale_simple(src, 100, 100, GDK_INTERP_BILINEAR);\n    GtkWidget *image2 = gtk_image_new_from_pixbuf(dst);\n    // 释放pxibuf资源\n    g_object_unref(src);\n    g_object_unref(dst);\n    // 将image2添加到box\n    gtk_container_add(GTK_CONTAINER(hbox), image2);\n    // 获取控件里的pixbuf\n    GdkPixbuf *tmp = gtk_image_get_pixbuf(GTK_IMAGE(image2));\n    GtkWidget *image3 = gtk_image_new_from_pixbuf(tmp);\n    g_object_unref(tmp);\n    gtk_container_add(GTK_CONTAINER(hbox), image3);\n    // 给创建的图片控件重新设置图片\n    GtkWidget *image4 = gtk_image_new_from_file(\"../img/1.png\");\n    gtk_container_add(GTK_CONTAINER(hbox), image4);\n    src = gdk_pixbuf_new_from_file(\"../img/2.png\", NULL);\n    dst = gdk_pixbuf_scale_simple(src, 200, 200, GDK_INTERP_BILINEAR);\n    gtk_image_set_from_pixbuf(GTK_IMAGE(image4), dst);\n    g_object_unref(src);\n    g_object_unref(dst);\n    // 显示所有控件\n    gtk_widget_show_all(window);\n    // 循环\n    gtk_main();\n    return 0;\n}\n```\n\n#### 进度条控件\n\n[文档](https://developer.gnome.org/gtk3/stable/GtkProgressBar.html#gtk-progress-bar-get-fraction)\n\n进度条的创建\n\n```c\n// 返回值：进度条指针\nGtkWidget *gtk_progress_bar_new(void);\n```\n\n设置进度条显示的进度比例\n\n```c\n// pbar：需要操作的进度条\n// fraction：0.0到1.0\nvoid gtk_progress_bar_set_fraction(GtkProgressBar *pbar, gdouble fraction);\n```\n\n获取进度条显示的进度比例\n\n```c\n// pbar：需要操作的进度条\n// 返回值：进度比例\ngdouble  gtk_progress_bar_get_fraction (GtkProgressBar *pbar);\n```\n\n设置滑槽上的文本显示\n\n```c\n// pbar：需要操作的进度条\n// text：设置的文本内容\nvoid gtk_progress_bar_set_text(GtkProgressBar *pbar, gchar *text);\n```\n\n设置进度条的移动方向gtk+-2版本\n\n```c\n// pbar：需要操作的进度条\n// orientation：移动方向，它是一个枚举变量\n// GTK_PROGRESS_LEFT_TO_RIGHT：从左向右 \n// GTK_PROGRESS_RIGHT_TO_LEFT：从右向左 \n// GTK_PROGRESS_BOTTOM_TO_TOP：从下向上 \n// GTK_PROGRESS_TOP_TO_BOTTOM：从上向下\nvoid gtk_progress_bar_set_orientation(GtkProgressBar *pbar, GtkProgressBarOrientation orientation);\n```\n\n获取进度条的方向gtk+-2版本\n\n```c\n// pbar：需要操作的进度条\n// 返回值：进度条的方向，它是一个枚举类型\nGtkProgressBarOrientationgtk_progress_bar_get_orientation(GtkProgressBar *pbar);\n```\n\n设置进度条的移动方向gtk+-3版本\n\n```c\nvoid gtk_progress_bar_set_inverted (GtkProgressBar *pbar, gboolean inverted);\n```\n\n```c\ngboolean gtk_progress_bar_get_inverted (GtkProgressBar *pbar);\n```\n\n```c\n#include <gtk/gtk.h>\n\n\n//回调函数，切换进度条的移动方向\nvoid toggle_orientation(GtkWidget *widget, gpointer data)\n{\n    switch (gtk_progress_bar_get_inverted(GTK_PROGRESS_BAR(data)) ) {\n        case TRUE:\n            gtk_progress_bar_set_inverted(GTK_PROGRESS_BAR(data), FALSE);\n            break;\n        case FALSE:\n            gtk_progress_bar_set_inverted(GTK_PROGRESS_BAR(data), TRUE);\n            break;\n        default:\n            break;\n    }\n}\n\n\n//回调函数，更新进度条，这样可以看到进度条的移动\nvoid callback(GtkWidget *widget, gpointer data)\n{\n    gdouble new_val = gtk_progress_bar_get_fraction(GTK_PROGRESS_BAR(data)) +0.05;\n\n    if (new_val > 1.0) {\n        new_val = 0.0;\n    }\n\n    //设置进度条新值\n    gtk_progress_bar_set_fraction(GTK_PROGRESS_BAR(data), new_val);\n\n}\n\nint main(int argc, char *argv[])\n{\n    //1.gtk环境的初始化\n    gtk_init(&argc, &argv);\n\n    //2.创建一个窗口\n    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n    //设置窗口的标题\n    gtk_window_set_title(GTK_WINDOW(window), \"gtk_progress_bar\");\n    //设置窗口边框宽度\n    gtk_container_set_border_width(GTK_CONTAINER(window), 10);\n\n    //3.设置窗口的最小大小\n    gtk_widget_set_size_request(window, 300, 200);\n\n    //4.窗口关联destroy信号到gtk_main_quit\n    g_signal_connect(window, \"destroy\", G_CALLBACK(gtk_main_quit), NULL);\n\n    //5.创建一个垂直容器\n    GtkWidget *vbox = gtk_box_new(GTK_ORIENTATION_VERTICAL, 5);\n    //将vbox添加到window中\n    gtk_container_add(GTK_CONTAINER(window), vbox);\n\n    //6.创建一个进度条\n    GtkWidget *progress = gtk_progress_bar_new();\n    //将progress添加到vbox中\n    gtk_container_add(GTK_CONTAINER(vbox), progress);\n\n    //7.设置进度条的百分比为50%\n    gtk_progress_bar_set_fraction(GTK_PROGRESS_BAR(progress), 0.5);\n\n    //8.设置进度条上显示的文字\n    gtk_progress_bar_set_text(GTK_PROGRESS_BAR(progress), \"some text\");\n\n    //9.添加一个button1按钮,切换方向\n    GtkWidget *button1 = gtk_button_new_with_label(\"right to lift\");\n    gtk_container_add(GTK_CONTAINER(vbox), button1);\n    g_signal_connect(button1, \"clicked\", G_CALLBACK(    toggle_orientation   ), progress);\n\n    //10.添加一个button2，移动进度条\n    GtkWidget *button2 = gtk_button_new_with_label(\"add\");\n    gtk_container_add(GTK_CONTAINER(vbox), button2);\n    g_signal_connect(button2, \"clicked\", G_CALLBACK(callback), progress);\n\n    //11.显示所欲窗口\n    gtk_widget_show_all(window);\n\n    //12.主事件循环\n    gtk_main();\n\n    return 0;\n}\n\n```\n\n\n\n\n\n\n\n\n\n\n\n\n","slug":"c开发gtk+-入门基础","published":1,"updated":"2019-07-26T08:07:02.461Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjyu0a5sh00579ka4vpctyflq","content":"<h4 id=\"gdk-介绍\"><a href=\"#gdk-介绍\" class=\"headerlink\" title=\"gdk+介绍\"></a>gdk+介绍</h4><blockquote>\n<p>gtk+是c语言编写的用于开发图形界面程序的函数库。gtk+来源于gimp（gnu image minipulation program），gtk+在gdk（gimp drawing kit）基础上创建，并进行封装。</p>\n</blockquote>\n<h4 id=\"linux安装\"><a href=\"#linux安装\" class=\"headerlink\" title=\"linux安装\"></a>linux安装</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> http://ftp.gnome.org/pub/gnome/sources/gtk+/3.24/</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> wget http://ftp.gnome.org/pub/gnome/sources/gtk+/3.24/gtk+-3.24.10.tar.xz</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> tar xvfJ gtk+-3.24.10.tar.xz</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ./configure --prefix=/user/include/gtk3.24</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> make &amp;&amp; sudo make install</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo ldconfig</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 设置LD_LIBRARY_PATH</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> LD_LIBRARY_PATH=<span class=\"string\">\"/opt/gtk/lib\"</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> PATH=<span class=\"string\">\"/opt/gtk/bin:<span class=\"variable\">$PATH</span>\"</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> <span class=\"built_in\">export</span> LD_LIBRARY_PATH PATH</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"简单的空白窗口\"><a href=\"#简单的空白窗口\" class=\"headerlink\" title=\"简单的空白窗口\"></a>简单的空白窗口</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    gtk_widget_show(window);</span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> gcc -o main main.c `pkg-config --libs -cflags gtk+-3.0`</span></span><br></pre></td></tr></table></figure>\n\n<p>gtk_init (&amp;argc, &amp;argv); 所有 GTK应用程序都要调用该函数，而且必须在控件定义之前使用，它为我们设置一些缺省值( 例如视觉和颜色 )映射这个函数将函数库初始化，设置缺省的信号处理函数，并检查通过命令行传递给应用程序的参数，自动完成一些必要的初始化工作。</p>\n<p>gtk_main()是在每个Gtk应用程序都要调用的函数。程序运行停在这里等待事件(如键盘事件或鼠标事件)的发生，等待用户来操作窗口</p>\n<p>gtk_window_new()的功能创建一个窗口并返回这个窗口的控件指针。GTK_WINDOW_TOPLEVEL指明窗口的类型为最上层的主窗口，它最常用。接着创建一个GtkWidget *类型的window变量来接收。GtkWidget是GTK+控件类型，GtkWidget * 能指向任何控件的指针类型。</p>\n<p>gtk_widget_show(window)；用来显示上一步创建的窗口控件。在这个简单例子里，所有事件都被忽略。用鼠标点击窗口右上角的“×”按钮也不能将窗口关闭。我们可以在终端敲 Ctrl + C 关闭程序。</p>\n<h4 id=\"控件\"><a href=\"#控件\" class=\"headerlink\" title=\"控件\"></a>控件</h4><p>GTK中控件主要分为两类：容器控件，非容器控件。</p>\n<p>容器控件：它可以容纳别的控件，我们可以理解为盒子，盒子拿来装东西。容器控件又分为两类，一类只能容纳一个控件，如窗口，按钮；另一类能容纳多个控件，如布局控件。</p>\n<p>非容器控件：它不可以容纳别的控件，如标签、行编辑。</p>\n<p>前面我们写的空白窗口是能容纳一个控件的控件，现在我们要做的是，给这个窗口添加一个按钮。</p>\n<p>首先，我们需要创建一个按钮，然后需要把按钮添加到窗口，接着，显示按钮控件。</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// gtk初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个顶层窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个button容器</span></span><br><span class=\"line\">    GtkWidget *button = gtk_button_new_with_label(<span class=\"string\">\"hello gtk\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将button放入窗口中，</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), button);</span><br><span class=\"line\">    <span class=\"comment\">// 显示button</span></span><br><span class=\"line\">    gtk_widget_show(button);</span><br><span class=\"line\">    <span class=\"comment\">// 显示window</span></span><br><span class=\"line\">    gtk_widget_show(window);</span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_container_add</span><span class=\"params\">(GtkContainer *container, GtkWidget *widget)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>这里我们是把按钮添加到窗口容器里，widget为按钮指针(以上代码的button)，container为窗口指针(以上代码的window)，这里需要注意的是，我们创建的窗口(window)返回值为GtkWidget *类型，而gtk_container_add()的第一个参数为GtkContainer *类型，由于 GtkWidget *类型的变量为指向任何控件的万能指针，所以，在函数传参时，根据参数类型进行相应的转换，如：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtk_container_add( (GtkContainer *)window, button);</span><br></pre></td></tr></table></figure>\n\n<p>C语言里，我们常用这种方法转换。在GTK中，很多内部变量指针类型转换都定义了宏定义，如：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> GTK_CONTAINER(x) (GtkContainer *)(x)</span></span><br></pre></td></tr></table></figure>\n\n<p>所以，我们还可以这么写：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtk_container_add(GTK_CONTAINER(window), button);</span><br></pre></td></tr></table></figure>\n\n<p>那么，我们如何知道，哪个类型对应哪个宏定义呢？把要转换类型名字全部变为大写，同时，单词和单词之间以下划线“_”连接，然后，这个名字就是哪个宏定义的名字，如，(GtkButton *)x用宏定义的方法为 GTK_BUTTON(x)。</p>\n<p>上面的代码，我们是按钮和窗口都得通过gtk_widget_show()显示出来：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtk_widget_show(button);<span class=\"comment\">// 显示按钮</span></span><br><span class=\"line\">gtk_widget_show(window);<span class=\"comment\">// 显示窗口</span></span><br></pre></td></tr></table></figure>\n\n<p>但是，假如，窗口里有100个控件，还是这样一个一个地显示出来会比较麻烦，这时候，我们可以通过gtk_widget_show_all()显示所有的控件，里面需要传的是容纳控件的那个容器(这里为窗口)。这样，容器上的控件也会跟着显示。</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtk_widget_show_all()</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"布局容器-水平布局\"><a href=\"#布局容器-水平布局\" class=\"headerlink\" title=\"布局容器-水平布局\"></a>布局容器-水平布局</h4><p>如果我们希望窗口里多放添加几个控件，直接添加是不成功的，因为窗口只能容纳一个控件的容器。这时候，我们需要借助布局容器，我们先把布局容器添加到窗口里，然后再把所需要添加的控件放在布局容器里。</p>\n<p>布局容器的主要分类：水平布局( GtkHBox)、垂直布局(GtkVBox )、表格布局(GtkTable)、固定布局(GtkFixed )。</p>\n<p><strong>创建一个盒子布局</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// orientation参数: GTK_ORIENTATION_HORIZONTAL GTK_ORIENTATION_VERTICAL 两个可选值 spacing参数是单元格之间的间隙</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">gtk_box_new</span><span class=\"params\">(<span class=\"keyword\">int</span> orientation, <span class=\"keyword\">int</span> spacing)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>以下代码显示水平容器布局方式，垂直容器类似</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// gtk初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个顶层窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建水平容器</span></span><br><span class=\"line\">    <span class=\"comment\">// GtkWidget *hbox = gtk_hbox_new(TRUE, 10);  // gtk+2版本使用</span></span><br><span class=\"line\">    GtkWidget *hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, <span class=\"number\">10</span>);  <span class=\"comment\">// gtk+3版本使用</span></span><br><span class=\"line\">    <span class=\"comment\">// 将水平容器添加到窗口</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), hbox);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个button容器</span></span><br><span class=\"line\">    GtkWidget *button1 = gtk_button_new_with_label(<span class=\"string\">\"button1\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将button放入水平容器中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), button1);</span><br><span class=\"line\">    <span class=\"comment\">// 重复创建两个</span></span><br><span class=\"line\">    GtkWidget *button2 = gtk_button_new_with_label(<span class=\"string\">\"button2\"</span>);</span><br><span class=\"line\">    GtkWidget *button3 = gtk_button_new_with_label(<span class=\"string\">\"button3\"</span>);</span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), button2);</span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), button3);</span><br><span class=\"line\">    <span class=\"comment\">// 显示全部窗口</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"布局容器-表格布局\"><a href=\"#布局容器-表格布局\" class=\"headerlink\" title=\"布局容器-表格布局\"></a>布局容器-表格布局</h4><p><strong>添加表格布局容器</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// rows: 行数, coumns: 列数, homogeneous：容器内表格的大小是否相等, 返回值：表格布局容器指针</span></span><br><span class=\"line\"><span class=\"function\">GtkWidget *<span class=\"title\">gtk_table_new</span><span class=\"params\">(guint rows, guint columns, gboolean homogeneous)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><strong>布局容器添加控件</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// table: 容纳控件的容器, widget: 要添加的控件, 后四个参数为控件摆放的坐标，规则如下：</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_table_attach_defaults</span><span class=\"params\">(GtkTable *table, GtkWidget *widget, guint left_attach, guint right_attach, guint top_attach, guint bottom_attach)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/gtk%E8%A1%A8%E6%A0%BC%E5%B8%83%E5%B1%80%E7%A4%BA%E6%84%8F%E5%9B%BE.png\" alt=\"示意图\"></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// gtk初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个顶层窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个表格容器</span></span><br><span class=\"line\">    GtkWidget *table = gtk_table_new(<span class=\"number\">2</span>, <span class=\"number\">2</span>, TRUE); <span class=\"comment\">// gtk+2版本</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), table);</span><br><span class=\"line\">    <span class=\"comment\">// 创建button1， button2, button3</span></span><br><span class=\"line\">    GtkWidget *button1 = gtk_button_new_with_label(<span class=\"string\">\"button1\"</span>);</span><br><span class=\"line\">    GtkWidget *button2 = gtk_button_new_with_label(<span class=\"string\">\"button2\"</span>);</span><br><span class=\"line\">    GtkWidget *button3 = gtk_button_new_with_label(<span class=\"string\">\"button3\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将button放入table中</span></span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button1, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button2, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button3, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 显示所有窗口</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"布局容器-固定布局\"><a href=\"#布局容器-固定布局\" class=\"headerlink\" title=\"布局容器-固定布局\"></a>布局容器-固定布局</h4><p>水平、垂直和表格布局容器，控件会跟着容器大小的变化进行自动适应，而固定布局容器里的控件则不会跟着变化( 则固定不变 )。</p>\n<p><strong>固定布局的创建</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">GtkWidget *<span class=\"title\">gtk_fixed_new</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><strong>添加控件</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// fixed：容纳控件的容器, widget：要添加的控件, x, y：控件摆放位置的起点坐标</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_fixed_put</span><span class=\"params\">(GtkFixed *fixed, GtkWidget *widget, gint x, gint y )</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><strong>设置控件的大小( 宽和高 )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// widget：需要设置的控件, width：宽度, height：高度</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_widget_set_size_request</span><span class=\"params\">(GtkWidget *widget, gint width, gint height)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><strong>移动固定布局里控件的位置</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// fixed：固定布局容器, widget：需要移动的控件, x, y: 移动的位置</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_fixed_move</span><span class=\"params\">(GtkFixed *fixed, GtkWidget *widget, gint x, gint y)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>示例代码</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// gtk初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个顶层窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个固定布局容器</span></span><br><span class=\"line\">    GtkWidget *fixed = gtk_fixed_new();</span><br><span class=\"line\">    <span class=\"comment\">// 将fixed添加到window中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), fixed);</span><br><span class=\"line\">    <span class=\"comment\">// 创建button</span></span><br><span class=\"line\">    GtkWidget *button1 = gtk_button_new_with_label(<span class=\"string\">\"button1\"</span>);</span><br><span class=\"line\">    GtkWidget *button2 = gtk_button_new_with_label(<span class=\"string\">\"button2\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将button添加到fixed</span></span><br><span class=\"line\">    gtk_fixed_put(GTK_FIXED(fixed), button1, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    gtk_fixed_put(GTK_FIXED(fixed), button2, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 移动button位置</span></span><br><span class=\"line\">    gtk_fixed_move(GTK_FIXED(fixed), button2, <span class=\"number\">150</span>, <span class=\"number\">150</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 设置button大小</span></span><br><span class=\"line\">    gtk_widget_set_size_request(button2, <span class=\"number\">100</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 显示所有窗口</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"容器布局练习-计算器\"><a href=\"#容器布局练习-计算器\" class=\"headerlink\" title=\"容器布局练习-计算器\"></a>容器布局练习-计算器</h4><p><strong>编辑控件( GtkEntry )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 创建</span></span><br><span class=\"line\"><span class=\"function\">GtkWidget * <span class=\"title\">gtk_entry_new</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">// 编辑</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_entry_set_text</span> <span class=\"params\">(GtkEntry *entry,<span class=\"keyword\">const</span> gchar *text)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">// 设置行编辑是否允许编辑</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_editable_set_editable</span><span class=\"params\">(GtkEditable *editable, gboolean is_editable)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>示例代码</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建5行4列的表格容器</span></span><br><span class=\"line\">    GtkWidget *table = gtk_table_new(<span class=\"number\">5</span>, <span class=\"number\">4</span>, TRUE);</span><br><span class=\"line\">    <span class=\"comment\">// 将table放入到容器中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), table);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个行编辑</span></span><br><span class=\"line\">    GtkWidget *entry = gtk_entry_new();</span><br><span class=\"line\">    <span class=\"comment\">// 设置行编辑的内容</span></span><br><span class=\"line\">    gtk_entry_set_text(GTK_ENTRY(entry), <span class=\"string\">\"2+2=4\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 设置行编辑不允许编辑</span></span><br><span class=\"line\">    gtk_editable_set_editable(GTK_EDITABLE(entry), FALSE);</span><br><span class=\"line\">    <span class=\"comment\">// 创建0-9数字按钮，+-×/=c功能按钮</span></span><br><span class=\"line\">    GtkWidget *button_0 = gtk_button_new_with_label(<span class=\"string\">\"0\"</span>);</span><br><span class=\"line\">    GtkWidget *button_1 = gtk_button_new_with_label(<span class=\"string\">\"1\"</span>);</span><br><span class=\"line\">    GtkWidget *button_2 = gtk_button_new_with_label(<span class=\"string\">\"2\"</span>);</span><br><span class=\"line\">    GtkWidget *button_3 = gtk_button_new_with_label(<span class=\"string\">\"3\"</span>);</span><br><span class=\"line\">    GtkWidget *button_4 = gtk_button_new_with_label(<span class=\"string\">\"4\"</span>);</span><br><span class=\"line\">    GtkWidget *button_5 = gtk_button_new_with_label(<span class=\"string\">\"5\"</span>);</span><br><span class=\"line\">    GtkWidget *button_6 = gtk_button_new_with_label(<span class=\"string\">\"6\"</span>);</span><br><span class=\"line\">    GtkWidget *button_7 = gtk_button_new_with_label(<span class=\"string\">\"7\"</span>);</span><br><span class=\"line\">    GtkWidget *button_8 = gtk_button_new_with_label(<span class=\"string\">\"8\"</span>);</span><br><span class=\"line\">    GtkWidget *button_9 = gtk_button_new_with_label(<span class=\"string\">\"9\"</span>);</span><br><span class=\"line\">    GtkWidget *button_add = gtk_button_new_with_label(<span class=\"string\">\"+\"</span>);</span><br><span class=\"line\">    GtkWidget *button_minus = gtk_button_new_with_label(<span class=\"string\">\"-\"</span>);</span><br><span class=\"line\">    GtkWidget *button_mul = gtk_button_new_with_label(<span class=\"string\">\"*\"</span>);</span><br><span class=\"line\">    GtkWidget *button_div = gtk_button_new_with_label(<span class=\"string\">\"/\"</span>);</span><br><span class=\"line\">    GtkWidget *button_equal = gtk_button_new_with_label(<span class=\"string\">\"=\"</span>);</span><br><span class=\"line\">    GtkWidget *button_delete = gtk_button_new_with_label(<span class=\"string\">\"c\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将table放入表格布局中</span></span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), entry, <span class=\"number\">0</span>, <span class=\"number\">4</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_0, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_1, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_2, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_3, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_4, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_5, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_6, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_7, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_8, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_9, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_add, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_minus, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_mul , <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_div, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_equal, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_delete, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 显示</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    <span class=\"comment\">// 循环</span></span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gcc -o main main.c `pkg-config --libs -cflags gtk+-3.0`</span><br></pre></td></tr></table></figure>\n\n<p>运行结果</p>\n<p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/gtk%E5%AE%B9%E5%99%A8%E5%B8%83%E5%B1%80-%E8%AE%A1%E7%AE%97%E5%99%A81.png\" alt=\"计算器\"></p>\n<h4 id=\"信号与回调函数\"><a href=\"#信号与回调函数\" class=\"headerlink\" title=\"信号与回调函数\"></a>信号与回调函数</h4><p>GTK采用了信号与回调函数来处理窗口外部传来的事件、消息或信号。当信号发生时，程序自动调用为信号连接的回调函数。</p>\n<p>GTK中的“信号”实际上是一种软件中断。“中断”在我们生活中经常遇到，譬如，我正在房间里打游戏，突然送快递的来了，把正在玩游戏的我给“中断”了，我去签收快递( 处理中断 )，处理完成后，再继续玩我的游戏。GTK中的“信号”就是属于这么一种“中断”，当用户按下按钮的时候，就产生一个“中断”，相当于产生一个信号，接着就会处理这么一个“中断任务”(程序里体验为调用一个函数)。</p>\n<p>“信号”在GTK中可以认为一种中断的标志，如按下按钮的标志为”pressed”,释放按钮的标志为”released”，这些标志就相当于 C语言的关键字一样，我们使用的时候必须完全按照它的名字来写。需要注意的是，每个控件的信号标志不一定都一样，如按钮（GtkButton）里有”pressed”信号，窗口(GtkWindow)里就没这个信号，每个控件具体有哪个信号，应该查看帮助文档来确定。</p>\n<p>按钮的常用信号：</p>\n<blockquote>\n<p>“clicked” : 单击按钮时触发</p>\n</blockquote>\n<blockquote>\n<p>“pressed” : 按下按钮时触发</p>\n</blockquote>\n<blockquote>\n<p>“released” : 释放按钮时触发</p>\n</blockquote>\n<p><strong>信号注册函数</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// instance：信号发出者，可以认为我们操作的控件，如按下按钮，这个就为按钮指针</span></span><br><span class=\"line\"><span class=\"comment\">// detailed_signal：信号标志，如\"pressed\"</span></span><br><span class=\"line\"><span class=\"comment\">// c_handler：回调函数的名称，需要用G_CALLBACK()进行转换</span></span><br><span class=\"line\"><span class=\"comment\">// data：给回调函数传的参数，gpointer 相当于C语言的 void *</span></span><br><span class=\"line\"><span class=\"comment\">// 返回值：注册函数的标志</span></span><br><span class=\"line\"><span class=\"function\">gulong <span class=\"title\">g_signal_connect</span><span class=\"params\">(gpointer instance, <span class=\"keyword\">const</span> gchar *detailed_signal, GCallback c_handler, gpointer data)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>例如</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">g_signal_connect(button, <span class=\"string\">\"pressed\"</span>,G_CALLBACK(callback), <span class=\"literal\">NULL</span>);</span><br></pre></td></tr></table></figure>\n\n<p>当按下button按钮时，就会自动调用回调函数callback(相当于处理中断任务)，回调函数callback可以是任意函数，函数名字我们根据需要自行命名，如果不是库函数，我们还得定义这个回调函数，这里需要注意的是，回调函数的写法(返回值，参数)，不是我们想怎么写就怎么写，帮助文档里已经规定好了回调函数应该如何写，如果不按规定来写，可能产生意想不到的错误。</p>\n<p><a href=\"https://developer.gnome.org/gtk3/stable/GtkWidget.html\" target=\"_blank\" rel=\"noopener\">文档地址</a></p>\n<p>回调函数的定义</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">callback</span><span class=\"params\">(GtkButton *button,gpointer data)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>示例</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">deal_pressed</span><span class=\"params\">(GtkButton *button, gpointer user_data)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *text = gtk_button_get_label(button);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"%s----%s\\n\"</span>, (<span class=\"keyword\">char</span> *) user_data, text);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 设置窗口边框与内部控件的间隔为15</span></span><br><span class=\"line\">    gtk_container_set_border_width(GTK_CONTAINER(window), <span class=\"number\">15</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个button</span></span><br><span class=\"line\">    GtkWidget *button = gtk_button_new_with_label(<span class=\"string\">\"button1\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将button添加到window中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), button);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个按钮信号</span></span><br><span class=\"line\">    g_signal_connect(button, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_pressed), <span class=\"string\">\"hello, world\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 显示控件</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"完成计算器计算功能\"><a href=\"#完成计算器计算功能\" class=\"headerlink\" title=\"完成计算器计算功能\"></a>完成计算器计算功能</h4><p>代码</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">char</span> buf[<span class=\"number\">50</span>] = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">deal_num</span><span class=\"params\">(GtkButton *button, gpointer data)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *text = gtk_button_get_label(button);</span><br><span class=\"line\">    <span class=\"comment\">// 如果是退格键</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"number\">0</span> == <span class=\"built_in\">strcmp</span>(<span class=\"string\">\"c\"</span>, text)) &#123;</span><br><span class=\"line\">        buf[<span class=\"built_in\">strlen</span>(buf) - <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> a = <span class=\"number\">0</span>, b = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">char</span> c;</span><br><span class=\"line\">        <span class=\"comment\">// 连接buf和新传入的字符串</span></span><br><span class=\"line\">        <span class=\"built_in\">strcat</span>(buf, text);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"number\">0</span> == <span class=\"built_in\">strcmp</span>(<span class=\"string\">\"=\"</span>, text)) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">\"text=====##%s##\\n\"</span>, text);</span><br><span class=\"line\">            <span class=\"comment\">// 从一个字符串中读进与指定格式相符的数据</span></span><br><span class=\"line\">            <span class=\"built_in\">sscanf</span>(buf, <span class=\"string\">\"%d%c%d\"</span>, &amp;a, &amp;c, &amp;b);</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">\"---------001-----%c--\\n\"</span>, c);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"string\">'+'</span> == c) &#123;</span><br><span class=\"line\">                <span class=\"built_in\">sprintf</span>(buf, <span class=\"string\">\"%d\"</span>, a + b);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"string\">'-'</span> == c) &#123;</span><br><span class=\"line\">                <span class=\"built_in\">sprintf</span>(buf, <span class=\"string\">\"%d\"</span>, a - b);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"string\">'*'</span> == c) &#123;</span><br><span class=\"line\">                <span class=\"built_in\">sprintf</span>(buf, <span class=\"string\">\"%d\"</span>, a * b);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"string\">'/'</span> == c) &#123;</span><br><span class=\"line\">                <span class=\"built_in\">sprintf</span>(buf, <span class=\"string\">\"%d\"</span>, a / b);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    gtk_entry_set_text(GTK_ENTRY(data), buf);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建5行4列的表格容器</span></span><br><span class=\"line\">    GtkWidget *table = gtk_table_new(<span class=\"number\">5</span>, <span class=\"number\">4</span>, TRUE);</span><br><span class=\"line\">    <span class=\"comment\">// 将table放入到容器中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), table);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个行编辑</span></span><br><span class=\"line\">    GtkWidget *entry = gtk_entry_new();</span><br><span class=\"line\">    <span class=\"comment\">// 设置行编辑的内容</span></span><br><span class=\"line\">    gtk_entry_set_text(GTK_ENTRY(entry), <span class=\"string\">\"2+2=4\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 设置行编辑不允许编辑</span></span><br><span class=\"line\">    gtk_editable_set_editable(GTK_EDITABLE(entry), FALSE);</span><br><span class=\"line\">    <span class=\"comment\">// 创建0-9数字按钮，+-×/=c功能按钮</span></span><br><span class=\"line\">    GtkWidget *button_0 = gtk_button_new_with_label(<span class=\"string\">\"0\"</span>);</span><br><span class=\"line\">    GtkWidget *button_1 = gtk_button_new_with_label(<span class=\"string\">\"1\"</span>);</span><br><span class=\"line\">    GtkWidget *button_2 = gtk_button_new_with_label(<span class=\"string\">\"2\"</span>);</span><br><span class=\"line\">    GtkWidget *button_3 = gtk_button_new_with_label(<span class=\"string\">\"3\"</span>);</span><br><span class=\"line\">    GtkWidget *button_4 = gtk_button_new_with_label(<span class=\"string\">\"4\"</span>);</span><br><span class=\"line\">    GtkWidget *button_5 = gtk_button_new_with_label(<span class=\"string\">\"5\"</span>);</span><br><span class=\"line\">    GtkWidget *button_6 = gtk_button_new_with_label(<span class=\"string\">\"6\"</span>);</span><br><span class=\"line\">    GtkWidget *button_7 = gtk_button_new_with_label(<span class=\"string\">\"7\"</span>);</span><br><span class=\"line\">    GtkWidget *button_8 = gtk_button_new_with_label(<span class=\"string\">\"8\"</span>);</span><br><span class=\"line\">    GtkWidget *button_9 = gtk_button_new_with_label(<span class=\"string\">\"9\"</span>);</span><br><span class=\"line\">    GtkWidget *button_add = gtk_button_new_with_label(<span class=\"string\">\"+\"</span>);</span><br><span class=\"line\">    GtkWidget *button_minus = gtk_button_new_with_label(<span class=\"string\">\"-\"</span>);</span><br><span class=\"line\">    GtkWidget *button_mul = gtk_button_new_with_label(<span class=\"string\">\"*\"</span>);</span><br><span class=\"line\">    GtkWidget *button_div = gtk_button_new_with_label(<span class=\"string\">\"/\"</span>);</span><br><span class=\"line\">    GtkWidget *button_equal = gtk_button_new_with_label(<span class=\"string\">\"=\"</span>);</span><br><span class=\"line\">    GtkWidget *button_delete = gtk_button_new_with_label(<span class=\"string\">\"c\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将table放入表格布局中</span></span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), entry, <span class=\"number\">0</span>, <span class=\"number\">4</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_0, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_1, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_2, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_3, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_4, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_5, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_6, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_7, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_8, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_9, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_add, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_minus, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_mul, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_div, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_equal, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_delete, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//7.注册信号函数，把entry传给回调函数deal_num()</span></span><br><span class=\"line\">    g_signal_connect(button_0, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_1, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_2, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_3, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_4, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_5, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_6, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_7, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_8, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_9, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\"></span><br><span class=\"line\">    g_signal_connect(button_add, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_mul, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_div, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_minus, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_equal, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 显示</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    <span class=\"comment\">// 循环</span></span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>结果(并不完美)</p>\n<p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/gtk-%E8%AE%A1%E7%AE%97%E5%99%A8.gif\" alt=\"计算器\"></p>\n<h4 id=\"glade\"><a href=\"#glade\" class=\"headerlink\" title=\"glade\"></a>glade</h4><p>glade是GTK＋的界面辅助设计工具，可以通过拖放控件的方式快速设计出用户界面，这样的优势在于在设计的同时能直观地看到界面上的控件，并且可以随时调整界面上的设计。</p>\n<p>用glade设计的图形用户界面是以XML格式的文件保存，它描述了控件的结构、每个控件的属性。用户可以动态加载这个界面文件。而且，界面和程序逻辑是完全分离，用户修改了界面，也不需要重新编译程序。</p>\n<p><strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> ubuntu </span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo apt-get install glade libglade2-dev</span></span><br></pre></td></tr></table></figure>\n\n<p>笔者是在软件中心直接下载安装的</p>\n<p><strong>代码引入</strong></p>\n<p>glade文件</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- Generated with glade 3.22.1 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">interface</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">requires</span> <span class=\"attr\">lib</span>=<span class=\"string\">\"gtk+\"</span> <span class=\"attr\">version</span>=<span class=\"string\">\"3.20\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">object</span> <span class=\"attr\">class</span>=<span class=\"string\">\"GtkWindow\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"window1\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span>&gt;</span>window1<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"can_focus\"</span>&gt;</span>False<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"title\"</span> <span class=\"attr\">translatable</span>=<span class=\"string\">\"yes\"</span>&gt;</span>第一个顶层窗口<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">child</span> <span class=\"attr\">type</span>=<span class=\"string\">\"titlebar\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">placeholder</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">object</span> <span class=\"attr\">class</span>=<span class=\"string\">\"GtkLayout\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"layout1\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span>&gt;</span>layout1<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"visible\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"can_focus\"</span>&gt;</span>False<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">object</span> <span class=\"attr\">class</span>=<span class=\"string\">\"GtkEntry\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"entry1\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span>&gt;</span>search_input<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"width_request\"</span>&gt;</span>200<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"height_request\"</span>&gt;</span>40<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"visible\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"can_focus\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">translatable</span>=<span class=\"string\">\"yes\"</span>&gt;</span>search_input<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"primary_icon_tooltip_text\"</span> <span class=\"attr\">translatable</span>=<span class=\"string\">\"yes\"</span>&gt;</span>search_input<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">object</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">packing</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"x\"</span>&gt;</span>10<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"y\"</span>&gt;</span>10<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">packing</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">object</span> <span class=\"attr\">class</span>=<span class=\"string\">\"GtkButton\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"button1\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"label\"</span> <span class=\"attr\">translatable</span>=<span class=\"string\">\"yes\"</span>&gt;</span>搜索<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span>&gt;</span>search_button<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"width_request\"</span>&gt;</span>100<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"height_request\"</span>&gt;</span>40<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"visible\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"can_focus\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"receives_default\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">object</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">packing</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"x\"</span>&gt;</span>220<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"y\"</span>&gt;</span>10<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">packing</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">object</span> <span class=\"attr\">class</span>=<span class=\"string\">\"GtkButton\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"button2\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"label\"</span> <span class=\"attr\">translatable</span>=<span class=\"string\">\"yes\"</span>&gt;</span>查看<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span>&gt;</span>show_button<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"width_request\"</span>&gt;</span>100<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"height_request\"</span>&gt;</span>40<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"visible\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"can_focus\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"receives_default\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">object</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">packing</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"x\"</span>&gt;</span>350<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"y\"</span>&gt;</span>10<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">packing</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">object</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">object</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">interface</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建GtkBuilder对象</span></span><br><span class=\"line\">    GtkBuilder *builder = gtk_builder_new();</span><br><span class=\"line\">    <span class=\"comment\">// 读取glade文件</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!gtk_builder_add_from_file(builder, <span class=\"string\">\"../1.glade\"</span>, <span class=\"literal\">NULL</span>)) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"无法打开文件\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 获取窗口指针</span></span><br><span class=\"line\">    GtkWidget *window1 = GTK_WIDGET(gtk_builder_get_object(builder, <span class=\"string\">\"window1\"</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 显示</span></span><br><span class=\"line\">    gtk_widget_show_all(window1);</span><br><span class=\"line\">    <span class=\"comment\">// 循环</span></span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"图片控件\"><a href=\"#图片控件\" class=\"headerlink\" title=\"图片控件\"></a>图片控件</h4><p>图片控件的创建：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// filename：图片的名字，带路径的话需要加上路径( 相对或绝对 )</span></span><br><span class=\"line\"><span class=\"function\">GtkWidget *<span class=\"title\">gtk_image_new_from_file</span><span class=\"params\">( <span class=\"keyword\">const</span> gchar *filename )</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>通过上面方法创建的图片控件，以图片默认大小来显示，不能修改其大小。如果要改变图片的大小，我们要借助图片资源对象GdkPixbuf，需要注意的是，GdkPixbuf不属于控件类，它以 Gdk 开头。</p>\n<p>图片资源对象pixbuf的创建：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// filename：图片的名字，带路径的话需要加上路径( 相对或绝对 )</span></span><br><span class=\"line\"><span class=\"comment\">// error：储存错误的指针</span></span><br><span class=\"line\"><span class=\"comment\">// 返回值：pixbuf指针</span></span><br><span class=\"line\"><span class=\"function\">GdkPixbuf *<span class=\"title\">gdk_pixbuf_new_from_file</span><span class=\"params\">(<span class=\"keyword\">const</span> gchar *filename, GError **error)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>设置图片的大小：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src：gdk_pixbuf_new_from_file()的返回值</span></span><br><span class=\"line\"><span class=\"comment\">// dest_width：图片的宽度</span></span><br><span class=\"line\"><span class=\"comment\">// dest_height：图片的高度</span></span><br><span class=\"line\"><span class=\"comment\">// interp_type：是一个枚举变量，标志图片的加载速度和质量，常用GDK_INTERP_BILINEAR</span></span><br><span class=\"line\"><span class=\"comment\">// 返回值：指定大小好的pixbuf指针</span></span><br><span class=\"line\"><span class=\"function\">GdkPixbuf *<span class=\"title\">gdk_pixbuf_scale_simple</span><span class=\"params\">(<span class=\"keyword\">const</span> GdkPixbuf *src, <span class=\"keyword\">int</span> dest_width, <span class=\"keyword\">int</span> dest_height, GdkInterpType interp_type)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>通过gdk_pixbuf_new_from_file(), gdk_pixbuf_scale_simple()创建的pixbuf，它会动态分配空间，占用资源，用完后，需要人为释放资源。</p>\n<p>释放资源：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">g_object_unref</span><span class=\"params\">(GtkObject *object)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>通过pixbuf来创建图片控件：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pixbuf：指定好大小的pixbuf</span></span><br><span class=\"line\"><span class=\"comment\">// 返回值：图片控件指针</span></span><br><span class=\"line\"><span class=\"function\">GtkWidget *<span class=\"title\">gtk_image_new_from_pixbuf</span><span class=\"params\">(GdkPixbuf *pixbuf )</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>图片控件重新设置一张图片(pixbuf)：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// image：图片控件指针</span></span><br><span class=\"line\"><span class=\"comment\">// pixbuf：指定好大小的pixbuf</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_image_set_from_pixbuf</span><span class=\"params\">(GtkImage *image, GdkPixbuf *pixbuf )</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>示例代码</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个window</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建水平容器</span></span><br><span class=\"line\">    GtkWidget *hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, <span class=\"number\">10</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 添加到window</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), hbox);</span><br><span class=\"line\">    <span class=\"comment\">// 创建图片控件</span></span><br><span class=\"line\">    GtkWidget *image1 = gtk_image_new_from_file(<span class=\"string\">\"../img/1.png\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将image添加到box</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), image1);</span><br><span class=\"line\">    <span class=\"comment\">// 创建pixbuf</span></span><br><span class=\"line\">    GdkPixbuf *src = gdk_pixbuf_new_from_file(<span class=\"string\">\"../img/1.png\"</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 修改图片大小</span></span><br><span class=\"line\">    GdkPixbuf *dst = gdk_pixbuf_scale_simple(src, <span class=\"number\">100</span>, <span class=\"number\">100</span>, GDK_INTERP_BILINEAR);</span><br><span class=\"line\">    GtkWidget *image2 = gtk_image_new_from_pixbuf(dst);</span><br><span class=\"line\">    <span class=\"comment\">// 释放pxibuf资源</span></span><br><span class=\"line\">    g_object_unref(src);</span><br><span class=\"line\">    g_object_unref(dst);</span><br><span class=\"line\">    <span class=\"comment\">// 将image2添加到box</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), image2);</span><br><span class=\"line\">    <span class=\"comment\">// 获取控件里的pixbuf</span></span><br><span class=\"line\">    GdkPixbuf *tmp = gtk_image_get_pixbuf(GTK_IMAGE(image2));</span><br><span class=\"line\">    GtkWidget *image3 = gtk_image_new_from_pixbuf(tmp);</span><br><span class=\"line\">    g_object_unref(tmp);</span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), image3);</span><br><span class=\"line\">    <span class=\"comment\">// 给创建的图片控件重新设置图片</span></span><br><span class=\"line\">    GtkWidget *image4 = gtk_image_new_from_file(<span class=\"string\">\"../img/1.png\"</span>);</span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), image4);</span><br><span class=\"line\">    src = gdk_pixbuf_new_from_file(<span class=\"string\">\"../img/2.png\"</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    dst = gdk_pixbuf_scale_simple(src, <span class=\"number\">200</span>, <span class=\"number\">200</span>, GDK_INTERP_BILINEAR);</span><br><span class=\"line\">    gtk_image_set_from_pixbuf(GTK_IMAGE(image4), dst);</span><br><span class=\"line\">    g_object_unref(src);</span><br><span class=\"line\">    g_object_unref(dst);</span><br><span class=\"line\">    <span class=\"comment\">// 显示所有控件</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    <span class=\"comment\">// 循环</span></span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"进度条控件\"><a href=\"#进度条控件\" class=\"headerlink\" title=\"进度条控件\"></a>进度条控件</h4><p><a href=\"https://developer.gnome.org/gtk3/stable/GtkProgressBar.html#gtk-progress-bar-get-fraction\" target=\"_blank\" rel=\"noopener\">文档</a></p>\n<p>进度条的创建</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 返回值：进度条指针</span></span><br><span class=\"line\"><span class=\"function\">GtkWidget *<span class=\"title\">gtk_progress_bar_new</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>设置进度条显示的进度比例</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pbar：需要操作的进度条</span></span><br><span class=\"line\"><span class=\"comment\">// fraction：0.0到1.0</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_progress_bar_set_fraction</span><span class=\"params\">(GtkProgressBar *pbar, gdouble fraction)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>获取进度条显示的进度比例</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pbar：需要操作的进度条</span></span><br><span class=\"line\"><span class=\"comment\">// 返回值：进度比例</span></span><br><span class=\"line\"><span class=\"function\">gdouble  <span class=\"title\">gtk_progress_bar_get_fraction</span> <span class=\"params\">(GtkProgressBar *pbar)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>设置滑槽上的文本显示</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pbar：需要操作的进度条</span></span><br><span class=\"line\"><span class=\"comment\">// text：设置的文本内容</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_progress_bar_set_text</span><span class=\"params\">(GtkProgressBar *pbar, gchar *text)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>设置进度条的移动方向gtk+-2版本</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pbar：需要操作的进度条</span></span><br><span class=\"line\"><span class=\"comment\">// orientation：移动方向，它是一个枚举变量</span></span><br><span class=\"line\"><span class=\"comment\">// GTK_PROGRESS_LEFT_TO_RIGHT：从左向右 </span></span><br><span class=\"line\"><span class=\"comment\">// GTK_PROGRESS_RIGHT_TO_LEFT：从右向左 </span></span><br><span class=\"line\"><span class=\"comment\">// GTK_PROGRESS_BOTTOM_TO_TOP：从下向上 </span></span><br><span class=\"line\"><span class=\"comment\">// GTK_PROGRESS_TOP_TO_BOTTOM：从上向下</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_progress_bar_set_orientation</span><span class=\"params\">(GtkProgressBar *pbar, GtkProgressBarOrientation orientation)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>获取进度条的方向gtk+-2版本</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pbar：需要操作的进度条</span></span><br><span class=\"line\"><span class=\"comment\">// 返回值：进度条的方向，它是一个枚举类型</span></span><br><span class=\"line\">GtkProgressBarOrientationgtk_progress_bar_get_orientation(GtkProgressBar *pbar);</span><br></pre></td></tr></table></figure>\n\n<p>设置进度条的移动方向gtk+-3版本</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_progress_bar_set_inverted</span> <span class=\"params\">(GtkProgressBar *pbar, gboolean inverted)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">gboolean <span class=\"title\">gtk_progress_bar_get_inverted</span> <span class=\"params\">(GtkProgressBar *pbar)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//回调函数，切换进度条的移动方向</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">toggle_orientation</span><span class=\"params\">(GtkWidget *widget, gpointer data)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">switch</span> (gtk_progress_bar_get_inverted(GTK_PROGRESS_BAR(data)) ) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> TRUE:</span><br><span class=\"line\">            gtk_progress_bar_set_inverted(GTK_PROGRESS_BAR(data), FALSE);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> FALSE:</span><br><span class=\"line\">            gtk_progress_bar_set_inverted(GTK_PROGRESS_BAR(data), TRUE);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">default</span>:</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//回调函数，更新进度条，这样可以看到进度条的移动</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">callback</span><span class=\"params\">(GtkWidget *widget, gpointer data)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    gdouble new_val = gtk_progress_bar_get_fraction(GTK_PROGRESS_BAR(data)) +<span class=\"number\">0.05</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (new_val &gt; <span class=\"number\">1.0</span>) &#123;</span><br><span class=\"line\">        new_val = <span class=\"number\">0.0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//设置进度条新值</span></span><br><span class=\"line\">    gtk_progress_bar_set_fraction(GTK_PROGRESS_BAR(data), new_val);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//1.gtk环境的初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//2.创建一个窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">//设置窗口的标题</span></span><br><span class=\"line\">    gtk_window_set_title(GTK_WINDOW(window), <span class=\"string\">\"gtk_progress_bar\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">//设置窗口边框宽度</span></span><br><span class=\"line\">    gtk_container_set_border_width(GTK_CONTAINER(window), <span class=\"number\">10</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//3.设置窗口的最小大小</span></span><br><span class=\"line\">    gtk_widget_set_size_request(window, <span class=\"number\">300</span>, <span class=\"number\">200</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//4.窗口关联destroy信号到gtk_main_quit</span></span><br><span class=\"line\">    g_signal_connect(window, <span class=\"string\">\"destroy\"</span>, G_CALLBACK(gtk_main_quit), <span class=\"literal\">NULL</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//5.创建一个垂直容器</span></span><br><span class=\"line\">    GtkWidget *vbox = gtk_box_new(GTK_ORIENTATION_VERTICAL, <span class=\"number\">5</span>);</span><br><span class=\"line\">    <span class=\"comment\">//将vbox添加到window中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), vbox);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//6.创建一个进度条</span></span><br><span class=\"line\">    GtkWidget *progress = gtk_progress_bar_new();</span><br><span class=\"line\">    <span class=\"comment\">//将progress添加到vbox中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(vbox), progress);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//7.设置进度条的百分比为50%</span></span><br><span class=\"line\">    gtk_progress_bar_set_fraction(GTK_PROGRESS_BAR(progress), <span class=\"number\">0.5</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//8.设置进度条上显示的文字</span></span><br><span class=\"line\">    gtk_progress_bar_set_text(GTK_PROGRESS_BAR(progress), <span class=\"string\">\"some text\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//9.添加一个button1按钮,切换方向</span></span><br><span class=\"line\">    GtkWidget *button1 = gtk_button_new_with_label(<span class=\"string\">\"right to lift\"</span>);</span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(vbox), button1);</span><br><span class=\"line\">    g_signal_connect(button1, <span class=\"string\">\"clicked\"</span>, G_CALLBACK(    toggle_orientation   ), progress);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//10.添加一个button2，移动进度条</span></span><br><span class=\"line\">    GtkWidget *button2 = gtk_button_new_with_label(<span class=\"string\">\"add\"</span>);</span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(vbox), button2);</span><br><span class=\"line\">    g_signal_connect(button2, <span class=\"string\">\"clicked\"</span>, G_CALLBACK(callback), progress);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//11.显示所欲窗口</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//12.主事件循环</span></span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"gdk-介绍\"><a href=\"#gdk-介绍\" class=\"headerlink\" title=\"gdk+介绍\"></a>gdk+介绍</h4><blockquote>\n<p>gtk+是c语言编写的用于开发图形界面程序的函数库。gtk+来源于gimp（gnu image minipulation program），gtk+在gdk（gimp drawing kit）基础上创建，并进行封装。</p>\n</blockquote>\n<h4 id=\"linux安装\"><a href=\"#linux安装\" class=\"headerlink\" title=\"linux安装\"></a>linux安装</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> http://ftp.gnome.org/pub/gnome/sources/gtk+/3.24/</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> wget http://ftp.gnome.org/pub/gnome/sources/gtk+/3.24/gtk+-3.24.10.tar.xz</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> tar xvfJ gtk+-3.24.10.tar.xz</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> ./configure --prefix=/user/include/gtk3.24</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> make &amp;&amp; sudo make install</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo ldconfig</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 设置LD_LIBRARY_PATH</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> LD_LIBRARY_PATH=<span class=\"string\">\"/opt/gtk/lib\"</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> PATH=<span class=\"string\">\"/opt/gtk/bin:<span class=\"variable\">$PATH</span>\"</span></span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> <span class=\"built_in\">export</span> LD_LIBRARY_PATH PATH</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"简单的空白窗口\"><a href=\"#简单的空白窗口\" class=\"headerlink\" title=\"简单的空白窗口\"></a>简单的空白窗口</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    gtk_widget_show(window);</span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> gcc -o main main.c `pkg-config --libs -cflags gtk+-3.0`</span></span><br></pre></td></tr></table></figure>\n\n<p>gtk_init (&amp;argc, &amp;argv); 所有 GTK应用程序都要调用该函数，而且必须在控件定义之前使用，它为我们设置一些缺省值( 例如视觉和颜色 )映射这个函数将函数库初始化，设置缺省的信号处理函数，并检查通过命令行传递给应用程序的参数，自动完成一些必要的初始化工作。</p>\n<p>gtk_main()是在每个Gtk应用程序都要调用的函数。程序运行停在这里等待事件(如键盘事件或鼠标事件)的发生，等待用户来操作窗口</p>\n<p>gtk_window_new()的功能创建一个窗口并返回这个窗口的控件指针。GTK_WINDOW_TOPLEVEL指明窗口的类型为最上层的主窗口，它最常用。接着创建一个GtkWidget *类型的window变量来接收。GtkWidget是GTK+控件类型，GtkWidget * 能指向任何控件的指针类型。</p>\n<p>gtk_widget_show(window)；用来显示上一步创建的窗口控件。在这个简单例子里，所有事件都被忽略。用鼠标点击窗口右上角的“×”按钮也不能将窗口关闭。我们可以在终端敲 Ctrl + C 关闭程序。</p>\n<h4 id=\"控件\"><a href=\"#控件\" class=\"headerlink\" title=\"控件\"></a>控件</h4><p>GTK中控件主要分为两类：容器控件，非容器控件。</p>\n<p>容器控件：它可以容纳别的控件，我们可以理解为盒子，盒子拿来装东西。容器控件又分为两类，一类只能容纳一个控件，如窗口，按钮；另一类能容纳多个控件，如布局控件。</p>\n<p>非容器控件：它不可以容纳别的控件，如标签、行编辑。</p>\n<p>前面我们写的空白窗口是能容纳一个控件的控件，现在我们要做的是，给这个窗口添加一个按钮。</p>\n<p>首先，我们需要创建一个按钮，然后需要把按钮添加到窗口，接着，显示按钮控件。</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// gtk初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个顶层窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个button容器</span></span><br><span class=\"line\">    GtkWidget *button = gtk_button_new_with_label(<span class=\"string\">\"hello gtk\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将button放入窗口中，</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), button);</span><br><span class=\"line\">    <span class=\"comment\">// 显示button</span></span><br><span class=\"line\">    gtk_widget_show(button);</span><br><span class=\"line\">    <span class=\"comment\">// 显示window</span></span><br><span class=\"line\">    gtk_widget_show(window);</span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_container_add</span><span class=\"params\">(GtkContainer *container, GtkWidget *widget)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>这里我们是把按钮添加到窗口容器里，widget为按钮指针(以上代码的button)，container为窗口指针(以上代码的window)，这里需要注意的是，我们创建的窗口(window)返回值为GtkWidget *类型，而gtk_container_add()的第一个参数为GtkContainer *类型，由于 GtkWidget *类型的变量为指向任何控件的万能指针，所以，在函数传参时，根据参数类型进行相应的转换，如：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtk_container_add( (GtkContainer *)window, button);</span><br></pre></td></tr></table></figure>\n\n<p>C语言里，我们常用这种方法转换。在GTK中，很多内部变量指针类型转换都定义了宏定义，如：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> GTK_CONTAINER(x) (GtkContainer *)(x)</span></span><br></pre></td></tr></table></figure>\n\n<p>所以，我们还可以这么写：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtk_container_add(GTK_CONTAINER(window), button);</span><br></pre></td></tr></table></figure>\n\n<p>那么，我们如何知道，哪个类型对应哪个宏定义呢？把要转换类型名字全部变为大写，同时，单词和单词之间以下划线“_”连接，然后，这个名字就是哪个宏定义的名字，如，(GtkButton *)x用宏定义的方法为 GTK_BUTTON(x)。</p>\n<p>上面的代码，我们是按钮和窗口都得通过gtk_widget_show()显示出来：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtk_widget_show(button);<span class=\"comment\">// 显示按钮</span></span><br><span class=\"line\">gtk_widget_show(window);<span class=\"comment\">// 显示窗口</span></span><br></pre></td></tr></table></figure>\n\n<p>但是，假如，窗口里有100个控件，还是这样一个一个地显示出来会比较麻烦，这时候，我们可以通过gtk_widget_show_all()显示所有的控件，里面需要传的是容纳控件的那个容器(这里为窗口)。这样，容器上的控件也会跟着显示。</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gtk_widget_show_all()</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"布局容器-水平布局\"><a href=\"#布局容器-水平布局\" class=\"headerlink\" title=\"布局容器-水平布局\"></a>布局容器-水平布局</h4><p>如果我们希望窗口里多放添加几个控件，直接添加是不成功的，因为窗口只能容纳一个控件的容器。这时候，我们需要借助布局容器，我们先把布局容器添加到窗口里，然后再把所需要添加的控件放在布局容器里。</p>\n<p>布局容器的主要分类：水平布局( GtkHBox)、垂直布局(GtkVBox )、表格布局(GtkTable)、固定布局(GtkFixed )。</p>\n<p><strong>创建一个盒子布局</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// orientation参数: GTK_ORIENTATION_HORIZONTAL GTK_ORIENTATION_VERTICAL 两个可选值 spacing参数是单元格之间的间隙</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">gtk_box_new</span><span class=\"params\">(<span class=\"keyword\">int</span> orientation, <span class=\"keyword\">int</span> spacing)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>以下代码显示水平容器布局方式，垂直容器类似</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// gtk初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个顶层窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建水平容器</span></span><br><span class=\"line\">    <span class=\"comment\">// GtkWidget *hbox = gtk_hbox_new(TRUE, 10);  // gtk+2版本使用</span></span><br><span class=\"line\">    GtkWidget *hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, <span class=\"number\">10</span>);  <span class=\"comment\">// gtk+3版本使用</span></span><br><span class=\"line\">    <span class=\"comment\">// 将水平容器添加到窗口</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), hbox);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个button容器</span></span><br><span class=\"line\">    GtkWidget *button1 = gtk_button_new_with_label(<span class=\"string\">\"button1\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将button放入水平容器中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), button1);</span><br><span class=\"line\">    <span class=\"comment\">// 重复创建两个</span></span><br><span class=\"line\">    GtkWidget *button2 = gtk_button_new_with_label(<span class=\"string\">\"button2\"</span>);</span><br><span class=\"line\">    GtkWidget *button3 = gtk_button_new_with_label(<span class=\"string\">\"button3\"</span>);</span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), button2);</span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), button3);</span><br><span class=\"line\">    <span class=\"comment\">// 显示全部窗口</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"布局容器-表格布局\"><a href=\"#布局容器-表格布局\" class=\"headerlink\" title=\"布局容器-表格布局\"></a>布局容器-表格布局</h4><p><strong>添加表格布局容器</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// rows: 行数, coumns: 列数, homogeneous：容器内表格的大小是否相等, 返回值：表格布局容器指针</span></span><br><span class=\"line\"><span class=\"function\">GtkWidget *<span class=\"title\">gtk_table_new</span><span class=\"params\">(guint rows, guint columns, gboolean homogeneous)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><strong>布局容器添加控件</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// table: 容纳控件的容器, widget: 要添加的控件, 后四个参数为控件摆放的坐标，规则如下：</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_table_attach_defaults</span><span class=\"params\">(GtkTable *table, GtkWidget *widget, guint left_attach, guint right_attach, guint top_attach, guint bottom_attach)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/gtk%E8%A1%A8%E6%A0%BC%E5%B8%83%E5%B1%80%E7%A4%BA%E6%84%8F%E5%9B%BE.png\" alt=\"示意图\"></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// gtk初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个顶层窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个表格容器</span></span><br><span class=\"line\">    GtkWidget *table = gtk_table_new(<span class=\"number\">2</span>, <span class=\"number\">2</span>, TRUE); <span class=\"comment\">// gtk+2版本</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), table);</span><br><span class=\"line\">    <span class=\"comment\">// 创建button1， button2, button3</span></span><br><span class=\"line\">    GtkWidget *button1 = gtk_button_new_with_label(<span class=\"string\">\"button1\"</span>);</span><br><span class=\"line\">    GtkWidget *button2 = gtk_button_new_with_label(<span class=\"string\">\"button2\"</span>);</span><br><span class=\"line\">    GtkWidget *button3 = gtk_button_new_with_label(<span class=\"string\">\"button3\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将button放入table中</span></span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button1, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button2, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button3, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 显示所有窗口</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"布局容器-固定布局\"><a href=\"#布局容器-固定布局\" class=\"headerlink\" title=\"布局容器-固定布局\"></a>布局容器-固定布局</h4><p>水平、垂直和表格布局容器，控件会跟着容器大小的变化进行自动适应，而固定布局容器里的控件则不会跟着变化( 则固定不变 )。</p>\n<p><strong>固定布局的创建</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">GtkWidget *<span class=\"title\">gtk_fixed_new</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><strong>添加控件</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// fixed：容纳控件的容器, widget：要添加的控件, x, y：控件摆放位置的起点坐标</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_fixed_put</span><span class=\"params\">(GtkFixed *fixed, GtkWidget *widget, gint x, gint y )</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><strong>设置控件的大小( 宽和高 )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// widget：需要设置的控件, width：宽度, height：高度</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_widget_set_size_request</span><span class=\"params\">(GtkWidget *widget, gint width, gint height)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><strong>移动固定布局里控件的位置</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// fixed：固定布局容器, widget：需要移动的控件, x, y: 移动的位置</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_fixed_move</span><span class=\"params\">(GtkFixed *fixed, GtkWidget *widget, gint x, gint y)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>示例代码</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// gtk初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个顶层窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个固定布局容器</span></span><br><span class=\"line\">    GtkWidget *fixed = gtk_fixed_new();</span><br><span class=\"line\">    <span class=\"comment\">// 将fixed添加到window中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), fixed);</span><br><span class=\"line\">    <span class=\"comment\">// 创建button</span></span><br><span class=\"line\">    GtkWidget *button1 = gtk_button_new_with_label(<span class=\"string\">\"button1\"</span>);</span><br><span class=\"line\">    GtkWidget *button2 = gtk_button_new_with_label(<span class=\"string\">\"button2\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将button添加到fixed</span></span><br><span class=\"line\">    gtk_fixed_put(GTK_FIXED(fixed), button1, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    gtk_fixed_put(GTK_FIXED(fixed), button2, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 移动button位置</span></span><br><span class=\"line\">    gtk_fixed_move(GTK_FIXED(fixed), button2, <span class=\"number\">150</span>, <span class=\"number\">150</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 设置button大小</span></span><br><span class=\"line\">    gtk_widget_set_size_request(button2, <span class=\"number\">100</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 显示所有窗口</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"容器布局练习-计算器\"><a href=\"#容器布局练习-计算器\" class=\"headerlink\" title=\"容器布局练习-计算器\"></a>容器布局练习-计算器</h4><p><strong>编辑控件( GtkEntry )</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 创建</span></span><br><span class=\"line\"><span class=\"function\">GtkWidget * <span class=\"title\">gtk_entry_new</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">// 编辑</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_entry_set_text</span> <span class=\"params\">(GtkEntry *entry,<span class=\"keyword\">const</span> gchar *text)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">// 设置行编辑是否允许编辑</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_editable_set_editable</span><span class=\"params\">(GtkEditable *editable, gboolean is_editable)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>示例代码</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建5行4列的表格容器</span></span><br><span class=\"line\">    GtkWidget *table = gtk_table_new(<span class=\"number\">5</span>, <span class=\"number\">4</span>, TRUE);</span><br><span class=\"line\">    <span class=\"comment\">// 将table放入到容器中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), table);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个行编辑</span></span><br><span class=\"line\">    GtkWidget *entry = gtk_entry_new();</span><br><span class=\"line\">    <span class=\"comment\">// 设置行编辑的内容</span></span><br><span class=\"line\">    gtk_entry_set_text(GTK_ENTRY(entry), <span class=\"string\">\"2+2=4\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 设置行编辑不允许编辑</span></span><br><span class=\"line\">    gtk_editable_set_editable(GTK_EDITABLE(entry), FALSE);</span><br><span class=\"line\">    <span class=\"comment\">// 创建0-9数字按钮，+-×/=c功能按钮</span></span><br><span class=\"line\">    GtkWidget *button_0 = gtk_button_new_with_label(<span class=\"string\">\"0\"</span>);</span><br><span class=\"line\">    GtkWidget *button_1 = gtk_button_new_with_label(<span class=\"string\">\"1\"</span>);</span><br><span class=\"line\">    GtkWidget *button_2 = gtk_button_new_with_label(<span class=\"string\">\"2\"</span>);</span><br><span class=\"line\">    GtkWidget *button_3 = gtk_button_new_with_label(<span class=\"string\">\"3\"</span>);</span><br><span class=\"line\">    GtkWidget *button_4 = gtk_button_new_with_label(<span class=\"string\">\"4\"</span>);</span><br><span class=\"line\">    GtkWidget *button_5 = gtk_button_new_with_label(<span class=\"string\">\"5\"</span>);</span><br><span class=\"line\">    GtkWidget *button_6 = gtk_button_new_with_label(<span class=\"string\">\"6\"</span>);</span><br><span class=\"line\">    GtkWidget *button_7 = gtk_button_new_with_label(<span class=\"string\">\"7\"</span>);</span><br><span class=\"line\">    GtkWidget *button_8 = gtk_button_new_with_label(<span class=\"string\">\"8\"</span>);</span><br><span class=\"line\">    GtkWidget *button_9 = gtk_button_new_with_label(<span class=\"string\">\"9\"</span>);</span><br><span class=\"line\">    GtkWidget *button_add = gtk_button_new_with_label(<span class=\"string\">\"+\"</span>);</span><br><span class=\"line\">    GtkWidget *button_minus = gtk_button_new_with_label(<span class=\"string\">\"-\"</span>);</span><br><span class=\"line\">    GtkWidget *button_mul = gtk_button_new_with_label(<span class=\"string\">\"*\"</span>);</span><br><span class=\"line\">    GtkWidget *button_div = gtk_button_new_with_label(<span class=\"string\">\"/\"</span>);</span><br><span class=\"line\">    GtkWidget *button_equal = gtk_button_new_with_label(<span class=\"string\">\"=\"</span>);</span><br><span class=\"line\">    GtkWidget *button_delete = gtk_button_new_with_label(<span class=\"string\">\"c\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将table放入表格布局中</span></span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), entry, <span class=\"number\">0</span>, <span class=\"number\">4</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_0, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_1, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_2, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_3, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_4, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_5, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_6, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_7, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_8, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_9, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_add, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_minus, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_mul , <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_div, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_equal, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_delete, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 显示</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    <span class=\"comment\">// 循环</span></span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gcc -o main main.c `pkg-config --libs -cflags gtk+-3.0`</span><br></pre></td></tr></table></figure>\n\n<p>运行结果</p>\n<p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/gtk%E5%AE%B9%E5%99%A8%E5%B8%83%E5%B1%80-%E8%AE%A1%E7%AE%97%E5%99%A81.png\" alt=\"计算器\"></p>\n<h4 id=\"信号与回调函数\"><a href=\"#信号与回调函数\" class=\"headerlink\" title=\"信号与回调函数\"></a>信号与回调函数</h4><p>GTK采用了信号与回调函数来处理窗口外部传来的事件、消息或信号。当信号发生时，程序自动调用为信号连接的回调函数。</p>\n<p>GTK中的“信号”实际上是一种软件中断。“中断”在我们生活中经常遇到，譬如，我正在房间里打游戏，突然送快递的来了，把正在玩游戏的我给“中断”了，我去签收快递( 处理中断 )，处理完成后，再继续玩我的游戏。GTK中的“信号”就是属于这么一种“中断”，当用户按下按钮的时候，就产生一个“中断”，相当于产生一个信号，接着就会处理这么一个“中断任务”(程序里体验为调用一个函数)。</p>\n<p>“信号”在GTK中可以认为一种中断的标志，如按下按钮的标志为”pressed”,释放按钮的标志为”released”，这些标志就相当于 C语言的关键字一样，我们使用的时候必须完全按照它的名字来写。需要注意的是，每个控件的信号标志不一定都一样，如按钮（GtkButton）里有”pressed”信号，窗口(GtkWindow)里就没这个信号，每个控件具体有哪个信号，应该查看帮助文档来确定。</p>\n<p>按钮的常用信号：</p>\n<blockquote>\n<p>“clicked” : 单击按钮时触发</p>\n</blockquote>\n<blockquote>\n<p>“pressed” : 按下按钮时触发</p>\n</blockquote>\n<blockquote>\n<p>“released” : 释放按钮时触发</p>\n</blockquote>\n<p><strong>信号注册函数</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// instance：信号发出者，可以认为我们操作的控件，如按下按钮，这个就为按钮指针</span></span><br><span class=\"line\"><span class=\"comment\">// detailed_signal：信号标志，如\"pressed\"</span></span><br><span class=\"line\"><span class=\"comment\">// c_handler：回调函数的名称，需要用G_CALLBACK()进行转换</span></span><br><span class=\"line\"><span class=\"comment\">// data：给回调函数传的参数，gpointer 相当于C语言的 void *</span></span><br><span class=\"line\"><span class=\"comment\">// 返回值：注册函数的标志</span></span><br><span class=\"line\"><span class=\"function\">gulong <span class=\"title\">g_signal_connect</span><span class=\"params\">(gpointer instance, <span class=\"keyword\">const</span> gchar *detailed_signal, GCallback c_handler, gpointer data)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>例如</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">g_signal_connect(button, <span class=\"string\">\"pressed\"</span>,G_CALLBACK(callback), <span class=\"literal\">NULL</span>);</span><br></pre></td></tr></table></figure>\n\n<p>当按下button按钮时，就会自动调用回调函数callback(相当于处理中断任务)，回调函数callback可以是任意函数，函数名字我们根据需要自行命名，如果不是库函数，我们还得定义这个回调函数，这里需要注意的是，回调函数的写法(返回值，参数)，不是我们想怎么写就怎么写，帮助文档里已经规定好了回调函数应该如何写，如果不按规定来写，可能产生意想不到的错误。</p>\n<p><a href=\"https://developer.gnome.org/gtk3/stable/GtkWidget.html\" target=\"_blank\" rel=\"noopener\">文档地址</a></p>\n<p>回调函数的定义</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">callback</span><span class=\"params\">(GtkButton *button,gpointer data)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>示例</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">deal_pressed</span><span class=\"params\">(GtkButton *button, gpointer user_data)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *text = gtk_button_get_label(button);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"%s----%s\\n\"</span>, (<span class=\"keyword\">char</span> *) user_data, text);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 设置窗口边框与内部控件的间隔为15</span></span><br><span class=\"line\">    gtk_container_set_border_width(GTK_CONTAINER(window), <span class=\"number\">15</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个button</span></span><br><span class=\"line\">    GtkWidget *button = gtk_button_new_with_label(<span class=\"string\">\"button1\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将button添加到window中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), button);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个按钮信号</span></span><br><span class=\"line\">    g_signal_connect(button, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_pressed), <span class=\"string\">\"hello, world\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 显示控件</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"完成计算器计算功能\"><a href=\"#完成计算器计算功能\" class=\"headerlink\" title=\"完成计算器计算功能\"></a>完成计算器计算功能</h4><p>代码</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">char</span> buf[<span class=\"number\">50</span>] = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">deal_num</span><span class=\"params\">(GtkButton *button, gpointer data)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *text = gtk_button_get_label(button);</span><br><span class=\"line\">    <span class=\"comment\">// 如果是退格键</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"number\">0</span> == <span class=\"built_in\">strcmp</span>(<span class=\"string\">\"c\"</span>, text)) &#123;</span><br><span class=\"line\">        buf[<span class=\"built_in\">strlen</span>(buf) - <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> a = <span class=\"number\">0</span>, b = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">char</span> c;</span><br><span class=\"line\">        <span class=\"comment\">// 连接buf和新传入的字符串</span></span><br><span class=\"line\">        <span class=\"built_in\">strcat</span>(buf, text);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"number\">0</span> == <span class=\"built_in\">strcmp</span>(<span class=\"string\">\"=\"</span>, text)) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">\"text=====##%s##\\n\"</span>, text);</span><br><span class=\"line\">            <span class=\"comment\">// 从一个字符串中读进与指定格式相符的数据</span></span><br><span class=\"line\">            <span class=\"built_in\">sscanf</span>(buf, <span class=\"string\">\"%d%c%d\"</span>, &amp;a, &amp;c, &amp;b);</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">\"---------001-----%c--\\n\"</span>, c);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"string\">'+'</span> == c) &#123;</span><br><span class=\"line\">                <span class=\"built_in\">sprintf</span>(buf, <span class=\"string\">\"%d\"</span>, a + b);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"string\">'-'</span> == c) &#123;</span><br><span class=\"line\">                <span class=\"built_in\">sprintf</span>(buf, <span class=\"string\">\"%d\"</span>, a - b);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"string\">'*'</span> == c) &#123;</span><br><span class=\"line\">                <span class=\"built_in\">sprintf</span>(buf, <span class=\"string\">\"%d\"</span>, a * b);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"string\">'/'</span> == c) &#123;</span><br><span class=\"line\">                <span class=\"built_in\">sprintf</span>(buf, <span class=\"string\">\"%d\"</span>, a / b);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    gtk_entry_set_text(GTK_ENTRY(data), buf);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建5行4列的表格容器</span></span><br><span class=\"line\">    GtkWidget *table = gtk_table_new(<span class=\"number\">5</span>, <span class=\"number\">4</span>, TRUE);</span><br><span class=\"line\">    <span class=\"comment\">// 将table放入到容器中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), table);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个行编辑</span></span><br><span class=\"line\">    GtkWidget *entry = gtk_entry_new();</span><br><span class=\"line\">    <span class=\"comment\">// 设置行编辑的内容</span></span><br><span class=\"line\">    gtk_entry_set_text(GTK_ENTRY(entry), <span class=\"string\">\"2+2=4\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 设置行编辑不允许编辑</span></span><br><span class=\"line\">    gtk_editable_set_editable(GTK_EDITABLE(entry), FALSE);</span><br><span class=\"line\">    <span class=\"comment\">// 创建0-9数字按钮，+-×/=c功能按钮</span></span><br><span class=\"line\">    GtkWidget *button_0 = gtk_button_new_with_label(<span class=\"string\">\"0\"</span>);</span><br><span class=\"line\">    GtkWidget *button_1 = gtk_button_new_with_label(<span class=\"string\">\"1\"</span>);</span><br><span class=\"line\">    GtkWidget *button_2 = gtk_button_new_with_label(<span class=\"string\">\"2\"</span>);</span><br><span class=\"line\">    GtkWidget *button_3 = gtk_button_new_with_label(<span class=\"string\">\"3\"</span>);</span><br><span class=\"line\">    GtkWidget *button_4 = gtk_button_new_with_label(<span class=\"string\">\"4\"</span>);</span><br><span class=\"line\">    GtkWidget *button_5 = gtk_button_new_with_label(<span class=\"string\">\"5\"</span>);</span><br><span class=\"line\">    GtkWidget *button_6 = gtk_button_new_with_label(<span class=\"string\">\"6\"</span>);</span><br><span class=\"line\">    GtkWidget *button_7 = gtk_button_new_with_label(<span class=\"string\">\"7\"</span>);</span><br><span class=\"line\">    GtkWidget *button_8 = gtk_button_new_with_label(<span class=\"string\">\"8\"</span>);</span><br><span class=\"line\">    GtkWidget *button_9 = gtk_button_new_with_label(<span class=\"string\">\"9\"</span>);</span><br><span class=\"line\">    GtkWidget *button_add = gtk_button_new_with_label(<span class=\"string\">\"+\"</span>);</span><br><span class=\"line\">    GtkWidget *button_minus = gtk_button_new_with_label(<span class=\"string\">\"-\"</span>);</span><br><span class=\"line\">    GtkWidget *button_mul = gtk_button_new_with_label(<span class=\"string\">\"*\"</span>);</span><br><span class=\"line\">    GtkWidget *button_div = gtk_button_new_with_label(<span class=\"string\">\"/\"</span>);</span><br><span class=\"line\">    GtkWidget *button_equal = gtk_button_new_with_label(<span class=\"string\">\"=\"</span>);</span><br><span class=\"line\">    GtkWidget *button_delete = gtk_button_new_with_label(<span class=\"string\">\"c\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将table放入表格布局中</span></span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), entry, <span class=\"number\">0</span>, <span class=\"number\">4</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_0, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_1, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_2, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_3, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_4, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_5, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_6, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_7, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_8, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_9, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_add, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_minus, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_mul, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_div, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_equal, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>);</span><br><span class=\"line\">    gtk_table_attach_defaults(GTK_TABLE(table), button_delete, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//7.注册信号函数，把entry传给回调函数deal_num()</span></span><br><span class=\"line\">    g_signal_connect(button_0, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_1, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_2, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_3, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_4, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_5, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_6, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_7, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_8, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_9, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\"></span><br><span class=\"line\">    g_signal_connect(button_add, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_mul, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_div, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_minus, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\">    g_signal_connect(button_equal, <span class=\"string\">\"pressed\"</span>, G_CALLBACK(deal_num), entry);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 显示</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    <span class=\"comment\">// 循环</span></span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>结果(并不完美)</p>\n<p><img src=\"https://zhuohc-com.oss-cn-hangzhou.aliyuncs.com/gtk-%E8%AE%A1%E7%AE%97%E5%99%A8.gif\" alt=\"计算器\"></p>\n<h4 id=\"glade\"><a href=\"#glade\" class=\"headerlink\" title=\"glade\"></a>glade</h4><p>glade是GTK＋的界面辅助设计工具，可以通过拖放控件的方式快速设计出用户界面，这样的优势在于在设计的同时能直观地看到界面上的控件，并且可以随时调整界面上的设计。</p>\n<p>用glade设计的图形用户界面是以XML格式的文件保存，它描述了控件的结构、每个控件的属性。用户可以动态加载这个界面文件。而且，界面和程序逻辑是完全分离，用户修改了界面，也不需要重新编译程序。</p>\n<p><strong>安装</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> ubuntu </span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo apt-get install glade libglade2-dev</span></span><br></pre></td></tr></table></figure>\n\n<p>笔者是在软件中心直接下载安装的</p>\n<p><strong>代码引入</strong></p>\n<p>glade文件</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- Generated with glade 3.22.1 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">interface</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">requires</span> <span class=\"attr\">lib</span>=<span class=\"string\">\"gtk+\"</span> <span class=\"attr\">version</span>=<span class=\"string\">\"3.20\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">object</span> <span class=\"attr\">class</span>=<span class=\"string\">\"GtkWindow\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"window1\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span>&gt;</span>window1<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"can_focus\"</span>&gt;</span>False<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"title\"</span> <span class=\"attr\">translatable</span>=<span class=\"string\">\"yes\"</span>&gt;</span>第一个顶层窗口<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">child</span> <span class=\"attr\">type</span>=<span class=\"string\">\"titlebar\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">placeholder</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">object</span> <span class=\"attr\">class</span>=<span class=\"string\">\"GtkLayout\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"layout1\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span>&gt;</span>layout1<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"visible\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"can_focus\"</span>&gt;</span>False<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">object</span> <span class=\"attr\">class</span>=<span class=\"string\">\"GtkEntry\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"entry1\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span>&gt;</span>search_input<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"width_request\"</span>&gt;</span>200<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"height_request\"</span>&gt;</span>40<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"visible\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"can_focus\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">translatable</span>=<span class=\"string\">\"yes\"</span>&gt;</span>search_input<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"primary_icon_tooltip_text\"</span> <span class=\"attr\">translatable</span>=<span class=\"string\">\"yes\"</span>&gt;</span>search_input<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">object</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">packing</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"x\"</span>&gt;</span>10<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"y\"</span>&gt;</span>10<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">packing</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">object</span> <span class=\"attr\">class</span>=<span class=\"string\">\"GtkButton\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"button1\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"label\"</span> <span class=\"attr\">translatable</span>=<span class=\"string\">\"yes\"</span>&gt;</span>搜索<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span>&gt;</span>search_button<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"width_request\"</span>&gt;</span>100<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"height_request\"</span>&gt;</span>40<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"visible\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"can_focus\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"receives_default\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">object</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">packing</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"x\"</span>&gt;</span>220<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"y\"</span>&gt;</span>10<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">packing</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">object</span> <span class=\"attr\">class</span>=<span class=\"string\">\"GtkButton\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"button2\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"label\"</span> <span class=\"attr\">translatable</span>=<span class=\"string\">\"yes\"</span>&gt;</span>查看<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span>&gt;</span>show_button<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"width_request\"</span>&gt;</span>100<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"height_request\"</span>&gt;</span>40<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"visible\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"can_focus\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"receives_default\"</span>&gt;</span>True<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">object</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">packing</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"x\"</span>&gt;</span>350<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"y\"</span>&gt;</span>10<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">packing</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">object</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">child</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">object</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">interface</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建GtkBuilder对象</span></span><br><span class=\"line\">    GtkBuilder *builder = gtk_builder_new();</span><br><span class=\"line\">    <span class=\"comment\">// 读取glade文件</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!gtk_builder_add_from_file(builder, <span class=\"string\">\"../1.glade\"</span>, <span class=\"literal\">NULL</span>)) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"无法打开文件\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 获取窗口指针</span></span><br><span class=\"line\">    GtkWidget *window1 = GTK_WIDGET(gtk_builder_get_object(builder, <span class=\"string\">\"window1\"</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 显示</span></span><br><span class=\"line\">    gtk_widget_show_all(window1);</span><br><span class=\"line\">    <span class=\"comment\">// 循环</span></span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"图片控件\"><a href=\"#图片控件\" class=\"headerlink\" title=\"图片控件\"></a>图片控件</h4><p>图片控件的创建：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// filename：图片的名字，带路径的话需要加上路径( 相对或绝对 )</span></span><br><span class=\"line\"><span class=\"function\">GtkWidget *<span class=\"title\">gtk_image_new_from_file</span><span class=\"params\">( <span class=\"keyword\">const</span> gchar *filename )</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>通过上面方法创建的图片控件，以图片默认大小来显示，不能修改其大小。如果要改变图片的大小，我们要借助图片资源对象GdkPixbuf，需要注意的是，GdkPixbuf不属于控件类，它以 Gdk 开头。</p>\n<p>图片资源对象pixbuf的创建：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// filename：图片的名字，带路径的话需要加上路径( 相对或绝对 )</span></span><br><span class=\"line\"><span class=\"comment\">// error：储存错误的指针</span></span><br><span class=\"line\"><span class=\"comment\">// 返回值：pixbuf指针</span></span><br><span class=\"line\"><span class=\"function\">GdkPixbuf *<span class=\"title\">gdk_pixbuf_new_from_file</span><span class=\"params\">(<span class=\"keyword\">const</span> gchar *filename, GError **error)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>设置图片的大小：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src：gdk_pixbuf_new_from_file()的返回值</span></span><br><span class=\"line\"><span class=\"comment\">// dest_width：图片的宽度</span></span><br><span class=\"line\"><span class=\"comment\">// dest_height：图片的高度</span></span><br><span class=\"line\"><span class=\"comment\">// interp_type：是一个枚举变量，标志图片的加载速度和质量，常用GDK_INTERP_BILINEAR</span></span><br><span class=\"line\"><span class=\"comment\">// 返回值：指定大小好的pixbuf指针</span></span><br><span class=\"line\"><span class=\"function\">GdkPixbuf *<span class=\"title\">gdk_pixbuf_scale_simple</span><span class=\"params\">(<span class=\"keyword\">const</span> GdkPixbuf *src, <span class=\"keyword\">int</span> dest_width, <span class=\"keyword\">int</span> dest_height, GdkInterpType interp_type)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>通过gdk_pixbuf_new_from_file(), gdk_pixbuf_scale_simple()创建的pixbuf，它会动态分配空间，占用资源，用完后，需要人为释放资源。</p>\n<p>释放资源：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">g_object_unref</span><span class=\"params\">(GtkObject *object)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>通过pixbuf来创建图片控件：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pixbuf：指定好大小的pixbuf</span></span><br><span class=\"line\"><span class=\"comment\">// 返回值：图片控件指针</span></span><br><span class=\"line\"><span class=\"function\">GtkWidget *<span class=\"title\">gtk_image_new_from_pixbuf</span><span class=\"params\">(GdkPixbuf *pixbuf )</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>图片控件重新设置一张图片(pixbuf)：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// image：图片控件指针</span></span><br><span class=\"line\"><span class=\"comment\">// pixbuf：指定好大小的pixbuf</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_image_set_from_pixbuf</span><span class=\"params\">(GtkImage *image, GdkPixbuf *pixbuf )</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>示例代码</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\">    <span class=\"comment\">// 创建一个window</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">// 创建水平容器</span></span><br><span class=\"line\">    GtkWidget *hbox = gtk_box_new(GTK_ORIENTATION_HORIZONTAL, <span class=\"number\">10</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 添加到window</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), hbox);</span><br><span class=\"line\">    <span class=\"comment\">// 创建图片控件</span></span><br><span class=\"line\">    GtkWidget *image1 = gtk_image_new_from_file(<span class=\"string\">\"../img/1.png\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 将image添加到box</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), image1);</span><br><span class=\"line\">    <span class=\"comment\">// 创建pixbuf</span></span><br><span class=\"line\">    GdkPixbuf *src = gdk_pixbuf_new_from_file(<span class=\"string\">\"../img/1.png\"</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 修改图片大小</span></span><br><span class=\"line\">    GdkPixbuf *dst = gdk_pixbuf_scale_simple(src, <span class=\"number\">100</span>, <span class=\"number\">100</span>, GDK_INTERP_BILINEAR);</span><br><span class=\"line\">    GtkWidget *image2 = gtk_image_new_from_pixbuf(dst);</span><br><span class=\"line\">    <span class=\"comment\">// 释放pxibuf资源</span></span><br><span class=\"line\">    g_object_unref(src);</span><br><span class=\"line\">    g_object_unref(dst);</span><br><span class=\"line\">    <span class=\"comment\">// 将image2添加到box</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), image2);</span><br><span class=\"line\">    <span class=\"comment\">// 获取控件里的pixbuf</span></span><br><span class=\"line\">    GdkPixbuf *tmp = gtk_image_get_pixbuf(GTK_IMAGE(image2));</span><br><span class=\"line\">    GtkWidget *image3 = gtk_image_new_from_pixbuf(tmp);</span><br><span class=\"line\">    g_object_unref(tmp);</span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), image3);</span><br><span class=\"line\">    <span class=\"comment\">// 给创建的图片控件重新设置图片</span></span><br><span class=\"line\">    GtkWidget *image4 = gtk_image_new_from_file(<span class=\"string\">\"../img/1.png\"</span>);</span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(hbox), image4);</span><br><span class=\"line\">    src = gdk_pixbuf_new_from_file(<span class=\"string\">\"../img/2.png\"</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    dst = gdk_pixbuf_scale_simple(src, <span class=\"number\">200</span>, <span class=\"number\">200</span>, GDK_INTERP_BILINEAR);</span><br><span class=\"line\">    gtk_image_set_from_pixbuf(GTK_IMAGE(image4), dst);</span><br><span class=\"line\">    g_object_unref(src);</span><br><span class=\"line\">    g_object_unref(dst);</span><br><span class=\"line\">    <span class=\"comment\">// 显示所有控件</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\">    <span class=\"comment\">// 循环</span></span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"进度条控件\"><a href=\"#进度条控件\" class=\"headerlink\" title=\"进度条控件\"></a>进度条控件</h4><p><a href=\"https://developer.gnome.org/gtk3/stable/GtkProgressBar.html#gtk-progress-bar-get-fraction\" target=\"_blank\" rel=\"noopener\">文档</a></p>\n<p>进度条的创建</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 返回值：进度条指针</span></span><br><span class=\"line\"><span class=\"function\">GtkWidget *<span class=\"title\">gtk_progress_bar_new</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>设置进度条显示的进度比例</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pbar：需要操作的进度条</span></span><br><span class=\"line\"><span class=\"comment\">// fraction：0.0到1.0</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_progress_bar_set_fraction</span><span class=\"params\">(GtkProgressBar *pbar, gdouble fraction)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>获取进度条显示的进度比例</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pbar：需要操作的进度条</span></span><br><span class=\"line\"><span class=\"comment\">// 返回值：进度比例</span></span><br><span class=\"line\"><span class=\"function\">gdouble  <span class=\"title\">gtk_progress_bar_get_fraction</span> <span class=\"params\">(GtkProgressBar *pbar)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>设置滑槽上的文本显示</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pbar：需要操作的进度条</span></span><br><span class=\"line\"><span class=\"comment\">// text：设置的文本内容</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_progress_bar_set_text</span><span class=\"params\">(GtkProgressBar *pbar, gchar *text)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>设置进度条的移动方向gtk+-2版本</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pbar：需要操作的进度条</span></span><br><span class=\"line\"><span class=\"comment\">// orientation：移动方向，它是一个枚举变量</span></span><br><span class=\"line\"><span class=\"comment\">// GTK_PROGRESS_LEFT_TO_RIGHT：从左向右 </span></span><br><span class=\"line\"><span class=\"comment\">// GTK_PROGRESS_RIGHT_TO_LEFT：从右向左 </span></span><br><span class=\"line\"><span class=\"comment\">// GTK_PROGRESS_BOTTOM_TO_TOP：从下向上 </span></span><br><span class=\"line\"><span class=\"comment\">// GTK_PROGRESS_TOP_TO_BOTTOM：从上向下</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_progress_bar_set_orientation</span><span class=\"params\">(GtkProgressBar *pbar, GtkProgressBarOrientation orientation)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>获取进度条的方向gtk+-2版本</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// pbar：需要操作的进度条</span></span><br><span class=\"line\"><span class=\"comment\">// 返回值：进度条的方向，它是一个枚举类型</span></span><br><span class=\"line\">GtkProgressBarOrientationgtk_progress_bar_get_orientation(GtkProgressBar *pbar);</span><br></pre></td></tr></table></figure>\n\n<p>设置进度条的移动方向gtk+-3版本</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">gtk_progress_bar_set_inverted</span> <span class=\"params\">(GtkProgressBar *pbar, gboolean inverted)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">gboolean <span class=\"title\">gtk_progress_bar_get_inverted</span> <span class=\"params\">(GtkProgressBar *pbar)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;gtk/gtk.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//回调函数，切换进度条的移动方向</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">toggle_orientation</span><span class=\"params\">(GtkWidget *widget, gpointer data)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">switch</span> (gtk_progress_bar_get_inverted(GTK_PROGRESS_BAR(data)) ) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> TRUE:</span><br><span class=\"line\">            gtk_progress_bar_set_inverted(GTK_PROGRESS_BAR(data), FALSE);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> FALSE:</span><br><span class=\"line\">            gtk_progress_bar_set_inverted(GTK_PROGRESS_BAR(data), TRUE);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">default</span>:</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//回调函数，更新进度条，这样可以看到进度条的移动</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">callback</span><span class=\"params\">(GtkWidget *widget, gpointer data)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    gdouble new_val = gtk_progress_bar_get_fraction(GTK_PROGRESS_BAR(data)) +<span class=\"number\">0.05</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (new_val &gt; <span class=\"number\">1.0</span>) &#123;</span><br><span class=\"line\">        new_val = <span class=\"number\">0.0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//设置进度条新值</span></span><br><span class=\"line\">    gtk_progress_bar_set_fraction(GTK_PROGRESS_BAR(data), new_val);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//1.gtk环境的初始化</span></span><br><span class=\"line\">    gtk_init(&amp;argc, &amp;argv);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//2.创建一个窗口</span></span><br><span class=\"line\">    GtkWidget *window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class=\"line\">    <span class=\"comment\">//设置窗口的标题</span></span><br><span class=\"line\">    gtk_window_set_title(GTK_WINDOW(window), <span class=\"string\">\"gtk_progress_bar\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">//设置窗口边框宽度</span></span><br><span class=\"line\">    gtk_container_set_border_width(GTK_CONTAINER(window), <span class=\"number\">10</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//3.设置窗口的最小大小</span></span><br><span class=\"line\">    gtk_widget_set_size_request(window, <span class=\"number\">300</span>, <span class=\"number\">200</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//4.窗口关联destroy信号到gtk_main_quit</span></span><br><span class=\"line\">    g_signal_connect(window, <span class=\"string\">\"destroy\"</span>, G_CALLBACK(gtk_main_quit), <span class=\"literal\">NULL</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//5.创建一个垂直容器</span></span><br><span class=\"line\">    GtkWidget *vbox = gtk_box_new(GTK_ORIENTATION_VERTICAL, <span class=\"number\">5</span>);</span><br><span class=\"line\">    <span class=\"comment\">//将vbox添加到window中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(window), vbox);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//6.创建一个进度条</span></span><br><span class=\"line\">    GtkWidget *progress = gtk_progress_bar_new();</span><br><span class=\"line\">    <span class=\"comment\">//将progress添加到vbox中</span></span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(vbox), progress);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//7.设置进度条的百分比为50%</span></span><br><span class=\"line\">    gtk_progress_bar_set_fraction(GTK_PROGRESS_BAR(progress), <span class=\"number\">0.5</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//8.设置进度条上显示的文字</span></span><br><span class=\"line\">    gtk_progress_bar_set_text(GTK_PROGRESS_BAR(progress), <span class=\"string\">\"some text\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//9.添加一个button1按钮,切换方向</span></span><br><span class=\"line\">    GtkWidget *button1 = gtk_button_new_with_label(<span class=\"string\">\"right to lift\"</span>);</span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(vbox), button1);</span><br><span class=\"line\">    g_signal_connect(button1, <span class=\"string\">\"clicked\"</span>, G_CALLBACK(    toggle_orientation   ), progress);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//10.添加一个button2，移动进度条</span></span><br><span class=\"line\">    GtkWidget *button2 = gtk_button_new_with_label(<span class=\"string\">\"add\"</span>);</span><br><span class=\"line\">    gtk_container_add(GTK_CONTAINER(vbox), button2);</span><br><span class=\"line\">    g_signal_connect(button2, <span class=\"string\">\"clicked\"</span>, G_CALLBACK(callback), progress);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//11.显示所欲窗口</span></span><br><span class=\"line\">    gtk_widget_show_all(window);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//12.主事件循环</span></span><br><span class=\"line\">    gtk_main();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"wordpress插件开发基础入门","url":"101.html","id":"101","comments":0,"date":"2016-11-10T03:40:48.000Z","_content":"\n#### 创建插件\n\n    ├── hanchang-copyright\n    │   └── hanchang-copyright.php\n    \n    \n\n    # hanchang-copyright.php\n    <?php\n    /*\n    Plugin Name: hanchang-copyright\n    Plugin URI: http://www.zhuohc.com\n    Description: 在页脚显示一段版权信息\n    Version: 1.0\n    Author: hanchang\n    Author URI: http://www.zhuohc.com\n    License: GPLv2\n    */\n    \n\n#### 插件启用和停用初始化\n\n    # hanchang-copyright.php\n    <?php\n    /*\n    Plugin Name: hanchang-copyright\n    Plugin URI: http://www.zhuohc.com\n    Description: 在页脚显示一段版权信息\n    Version: 1.0\n    Author: hanchang\n    Author URI: http://www.zhuohc.com\n    License: GPLv2\n    */\n    \n    //定义插件启动时候调用的方法\n    register_activation_hook( __FILE__, 'hanchang_copyright_install');\n    \n    function hanchang_copyright_install() {\n    \n        //插件启动，添加一个默认的版权信息\n        update_option( \"hanchang_copyright_text\", \"<p style='color:red'>本站点所有文章均为原创，转载请注明出处！</p>\" );\n    \n    }\n    \n    //定义插件停用时候调用的方法\n    register_deactivation_hook( __FILE__, 'hanchang_copyright_deactivation');\n    \n    function hanchang_copyright_deactivation() {\n    \n        //插件停用，设置停用标识为1\n        update_option( \"hanchang_copyright_deactivation\", \"yes\" );\n    \n    }\n    \n\n#### 删除插件\n\n    .\n    ├── hanchang-copyright.php\n    └── uninstall.php # 删除插件执行的文件\n    \n\n    # uninstall.php\n    <?\n    // 如果 uninstall 不是从 WordPress 调用，则退出\n    if( !defined( 'WP_UNINSTALL_PLUGIN' ) )\n    exit();\n    \n    //删除插件创建的项目，以确保不占用数据库资源\n    delete_option( 'hanchang_copyright_deactivation' );\n    delete_option( 'hanchang_copyright_text' );\n    \n\n#### add_action\n\n    add_action(\"$tag钩子名称\", \"$function_to_do执行函数\", $priorrity执行优先级, $accepted_arga带参数函数的参数个数)\n    \n\n    # hanchang-copyright.php\n    \n    //为 wp_footer 钩子挂载一个新的动作 hc_copyright_insert\n    add_action( \"wp_footer\", \"hc_copyright_insert\" );\n    \n    function hc_copyright_insert(){\n    \n        //输出一段字符串\n        echo get_option( \"hc_copyright_text\" );\n    \n    }\n    \n    \n    add_action( \"wp_head\", \"hanchang_copyright_insert_new\" );\n    \n    function hanchang_copyright_insert_new() {\n        echo \"<script>alert(1);</script>\";\n    }\n    \n    add_action( 'save_post', 'save_post_meta', 10, 2 );\n    \n    function save_post_meta( $post_id, $post ) {\n    \n        update_post_meta( $post_id, \"save-time\", \"更新时间：\" . date(\"Y-m-d H:i:s\") );\n    \n    }\n    \n\n#### 常见钩子\n\n    init 加载初始化\n    wp_head 加载添加到head标签中的内容\n    wp_enqueue_scripts 加载css或者js文件\n    wp_foot 加载添加到底部内容\n    \n    save_post 添加保存文章\n    wp_trash_post 将文章添加到回收站\n    delete_post 将文章删除\n    \n    wp_insert_comment 插入评论\n    \n    user_register 用户注册\n    \n\n    # hanchang-copyright.php\n    <?php\n    /*\n    Plugin Name: hanchang-copyright\n    Plugin URI: http://www.zhuohc.com\n    Description: 在页脚显示一段版权信息\n    Version: 1.0\n    Author: hanchang\n    Author URI: http://www.zhuohc.com\n    License: GPLv2\n    */\n    \n    //定义插件启动时候调用的方法\n    register_activation_hook( __FILE__, 'hanchang_copyright_install');\n    \n    function hanchang_copyright_install() {\n    \n        //插件启动，添加一个默认的版权信息\n        update_option( \"hanchang_copyright_text\", \"<p style='color:red'>本站点所有文章均为原创，转载请注明出处！</p>\" );\n    \n    }\n    \n    //定义插件停用时候调用的方法\n    register_deactivation_hook( __FILE__, 'hanchang_copyright_deactivation');\n    \n    function hanchang_copyright_deactivation() {\n    \n        //插件停用，设置停用标识为1\n        update_option( \"hanchang_copyright_deactivation\", \"yes\" );\n    \n    }\n    \n    //为 wp_footer 钩子挂载一个新的动作 hc_copyright_insert\n    add_action( \"wp_footer\", \"hc_copyright_insert\" );\n    \n    function hc_copyright_insert(){\n    \n        //输出一段字符串\n        echo get_option( \"hc_copyright_text\" );\n    \n    }\n    \n    \n    add_action( \"wp_head\", \"hanchang_copyright_insert_new\" );\n    \n    function hanchang_copyright_insert_new() {\n        echo \"<script>alert(1);</script>\";\n    }\n    \n    add_action( 'save_post', 'save_post_meta', 10, 2 );\n    \n    function save_post_meta( $post_id, $post ) {\n    \n        update_post_meta( $post_id, \"save-time\", \"更新时间：\" . date(\"Y-m-d H:i:s\") );\n    \n    }\n    \n    \n    \n    //在输出内容之前，给页面管理添加摘要功能\n    add_action( 'init', 'hc_add_excerpts_to_pages' );\n    \n    function hc_add_excerpts_to_pages() {\n    \n        //给页面管理添加摘要的功能\n        add_post_type_support( 'page', array( 'excerpt' ) );\n    }\n    \n    //wp_head钩子\n    add_action('wp_head','hc_wp_head');\n    \n    function hc_wp_head() {\n    \n        //只有首页输出描述\n        if( is_home() ){ ?>\n            <meta name=\"description\" content=\"<? bloginfo('description'); ?>\" />\n        <? }\n    \n    }\n    \n    \n    //自定义引用样式表\n    function hc_enqueue_style() {\n        wp_enqueue_style( 'core', plugins_url('css/hc_copyrighy.css', __FILE__) , false );\n    }\n    \n    //自定义引用脚本文件\n    function hc_enqueue_script() {\n        wp_enqueue_script( 'my-js', plugins_url('js/hc_copyrighy.js', __FILE__), false );\n    }\n    \n    //引用文件的钩子\n    add_action( 'wp_enqueue_scripts', 'hc_enqueue_style', 5 );\n    add_action( 'wp_enqueue_scripts', 'hc_enqueue_script', 7 );\n    \n    //删除所有挂载在 wp_enqueue_scripts 钩子上的方法\n    remove_all_actions( 'wp_enqueue_scripts', 5 );\n    \n    //评论被添加的时候触发\n    add_action( 'wp_insert_comment', 'comment_inserted', 10, 2 );\n    \n    //移除 wp_insert_comment 钩子上的 comment_inserted 方法\n    remove_action( 'wp_insert_comment', 'comment_inserted', 10 );\n    \n    function comment_inserted($comment_id, $comment_object ) {\n    \n        //获取该评论所在文章的评论总数\n        $comments_count = wp_count_comments( $comment_object->comment_post_ID );\n    \n        $commentarr = array();\n        $commentarr['comment_ID'] = $comment_id;\n    \n        //修改评论的内容，在评论内容前加上 “第{$comments_count->total_comments}个评论：” 这么一段字符串\n        $commentarr['comment_content'] = \"第{$comments_count->total_comments}个评论：\" . $comment_object->comment_content;\n    \n        wp_update_comment( $commentarr );\n    \n    }\n    \n    \n    add_action( 'user_register', 'myplugin_registration_save', 10, 1 );\n    \n    function myplugin_registration_save( $user_id ) {\n    \n        //将新用户的个人说明，设置为注册时间\n        wp_update_user( array( 'ID' => $user_id, 'description' => \"注册时间：\" . date(\"Y-m-d H:i:s\") ) );\n    \n    }\n    ?>\n    \n\n#### 过滤器\n\n    add_filter($tag过滤器名称, $function_to_add需要添加的函数, $priority优先级, $acceptedargs添加的参数数量)\n    \n    \n\n    # hanchang-copyright.php\n    //一开始，我们设置一个变量\n    $value = \"hello\";\n    \n    //给名为 hc_filter 的过滤器，挂载一个 hc_filter_fun 方法，传递给 hc_filter 的变量都会经过 hc_filter_fun 方法进行过滤\n    //add_filter( \"hc_filter\", \"hc_filter_fun\" );\n    \n    //给名为 hc_filter 的过滤器，再挂载一个 hc_filter_fun_add_time 方法，传递给 hc_filter 的变量都会经过 hc_filter_fun、hc_filter_fun_add_time 两个方法进行过滤\n    //add_filter( \"hc_filter\", \"hc_filter_fun_add_time\" );\n    \n    //对 $value 值使用名为 hc_filter 的过滤器进行过滤，这个时候，由于 hc_filter 过滤器只挂载了 hc_filter_fun 方法，因此，只使用 hc_filter_fun 方法 过滤了一次，并且返回给 $myvar 变量\n    //$myvar = apply_filters( \"hc_filter\", $value );\n    \n    add_filter( \"the_content\", \"hc_filter_fun\" );\n    add_filter( \"the_content\", \"hc_filter_fun_add_time\" );\n    \n\n#### 带参数的过滤器\n\n    # hanchang-copyright.php\n    function suppress_if_blurb( $title, $id = null ) {\n    \n        if ( in_category('wpcj', $id ) ) {\n            return '不显示标题';\n        }\n    \n        return $title . \"...\";\n    }\n    \n    //对 the_title 过滤器挂载一个 suppress_if_blurb 方法，优先级为10，传递的参数有2个\n    add_filter( 'the_title', 'suppress_if_blurb', 10, 2 );\n    \n\n#### 常见过滤器\n\n    the_content 文章内容 \n    content_save_pre 文章保存前\n    the_title 文章标题\n    wp_handle_upload_prefilter 上传文件之前\n    \n\n#### 创建菜单\n\n    add_menu_page  # 添加菜单\n    add_submenu_page  # 添加子菜单\n    \n\n    # hanchang-copyright.php\n    // admin_menu钩子挂载创建菜单方法\n    add_action( 'admin_menu', 'hc_create_menu' );\n    function hc_create_menu() {\n    \n        // 创建顶级菜单\n        add_menu_page(\n            'Hanchang的插件首页', // 菜单title标题\n            'hanchang-copyright',  // 菜单名称，显示在后台管理页面侧边栏\n            'manage_options', // 浏览插件所需要的权限=管理员权限\n            'hanchang_copyright' ,  // 菜单别名，不能与其他插件冲突\n            'hanchang_settings_page',  // 菜单需要显示的页面，调用的哪个方法\n            plugins_url( '/images/icon.png', __FILE__ )  // 调用图标\n        );\n    \n        // 创建子菜单\n        add_submenu_page(\n            'hanchang_copyright',  // 父级菜单别名\n            '关于HC的插件',  // 菜单title标题\n            '关于',  //  菜单名称，显示在后台管理页面侧边栏\n            'manage_options',  // 浏览插件所需要的权限=管理员权限\n            'hc_copyright_about',  // 菜单别名，不能与其他插件冲突\n            'hc_create_submenu_menu'  // 调用方法\n        );\n    }\n    \n    function hanchang_settings_page() {\n        ?>\n        <h2>插件顶级菜单</h2>\n        <?\n    }\n    \n    function hc_create_submenu_menu() {\n    \n        ?>\n        <h2>子菜单</h2>\n        <?\n    }\n    \n\n#开发 小工具\n\n    #hanchang-copyright.php\n    // 使用 widgets_init 动作钩子来执行自定义的函数\n    add_action( 'widgets_init', 'hc_register_widgets' );\n    \n    // 注册小工具\n    function hc_register_widgets() {\n        register_widget( 'hc_widget_info' );\n    }\n    \n    //使用 WP_Widget 类来创建小工具\n    class hc_widget_info extends WP_Widget {\n    \n        //构造函数\n        public function __construct() {\n            $widget_ops = array(\n                'classname' => 'hc_widget_info',\n                'description' => '显示作者的个人信息'\n            );\n            $this->WP_Widget( '显示作者个人信息', '作者的小工具', $widget_ops );\n        }\n    \n        //小工具管理界面\n        public function form( $instance ) {\n    \n            $defaults = array( 'title' => '作者的个人信息', 'xingming' => '作者', 'book' => '《作者》' );\n            $instance = wp_parse_args( (array) $instance, $defaults );\n    \n            $title = $instance['title'];\n            $xingming = $instance['xingming'];\n            $book = $instance['book'];\n            ?>\n            <p>标题: <input class=\"widefat\" name=\"<?php echo $this->get_field_name( 'title' ); ?>\" type=\"text\" value=\"<?php echo esc_attr( $title ); ?>\" /></p>\n            <p>姓名: <input class=\"widefat\" name=\"<?php echo $this->get_field_name( 'xingming' ); ?> \"type=\"text\" value=\"<?php echo esc_attr( $xingming ); ?> \" /></p>\n            <p>著作: <textarea class=\"widefat\" name=\" <?php echo $this->get_field_name( 'book' ); ?> \" /><?php echo esc_attr( $book ); ?></textarea> </p>\n            <?php\n        }\n    \n        //保存小工具设置\n        public function update( $new_instance, $old_instance ) {\n    \n            $instance = $old_instance;\n    \n            $instance['title'] = strip_tags( trim( $new_instance['title'] ) );\n            $instance['xingming'] = strip_tags( trim(  $new_instance['xingming'] ) );\n            $instance['book'] = strip_tags( trim( $new_instance['book'] ) );\n            return $instance;\n        }\n    \n        //显示小工具\n        public function widget( $args, $instance ) {\n    \n            extract( $args );\n    \n            $title = apply_filters( 'widget_title', $instance['title'] );\n            $xingming = empty( $instance['xingming'] ) ? ' ' : $instance['xingming'];\n            $book = empty( $instance['book'] ) ? ' ' : $instance['book'];\n    \n            echo '<p> 标题: ' . $title . '</p>';\n            echo '<p> 姓名: ' . $xingming . '</p>';\n            echo '<p> 著作: ' . $book . '</p>';\n        }\n    }\n    \n\n#### 添加元数据框\n\n    # hanchang-copyright.php\n    /**\n     * 添加一个元数据框到 post 和 page 的管理界面中\n     */\n    function myplugin_add_meta_box() {\n    \n        $screens = array( 'post', 'page' );\n    \n        add_meta_box(\n            'myplugin_sectionid',  // 元数据框的html代码中的id值\n            '转载自',  // 元数据框标题\n            'myplugin_meta_box_callback',  // 回调函数名称，输出元数据框中的内容\n            $screens  // 元数据框需要添加在哪个分类内的（文章或者页面）\n        );\n    }\n    \n    //需要给 add_meta_boxes 钩子，挂载一个自定义的方法\n    add_action( 'add_meta_boxes', 'myplugin_add_meta_box' );\n    \n    /**\n     * 元数据框展示代码\n     */\n    function myplugin_meta_box_callback( $post ) {\n    \n        // 添加一个验证信息，这个在保存元数据的时候用到\n        wp_nonce_field( 'myplugin_save_meta_box_data', 'myplugin_meta_box_nonce' );\n    \n        /*\n         * 输出元数据信息\n         */\n        $value = get_post_meta( $post->ID, '_zzurl', true );\n    \n        echo '<label for=\"myplugin_new_field\">';\n        _e( '本文章转载自：' );\n        echo '</label> ';\n        echo '<input type=\"text\" id=\"_zzurl\" name=\"_zzurl\" value=\"' . esc_attr( $value ) . '\" size=\"25\" />';\n    }\n    \n    function myplugin_save_meta_box_data( $post_id ) {\n    \n        //验证是否为有效信息\n        if ( ! isset( $_POST['myplugin_meta_box_nonce'] ) ) {\n            return;\n        }\n    \n        if ( ! wp_verify_nonce( $_POST['myplugin_meta_box_nonce'], 'myplugin_save_meta_box_data' ) ) {\n            return;\n        }\n    \n        if ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) {\n            return;\n        }\n    \n        // Check the user's permissions.\n        if ( isset( $_POST['post_type'] ) && 'page' == $_POST['post_type'] ) {\n    \n            if ( ! current_user_can( 'edit_page', $post_id ) ) {\n                return;\n            }\n    \n        } else {\n    \n            if ( ! current_user_can( 'edit_post', $post_id ) ) {\n                return;\n            }\n        }\n    \n        if ( ! isset( $_POST['_zzurl'] ) ) {\n            return;\n        }\n    \n        $my_data = sanitize_text_field( $_POST['_zzurl'] );\n    \n        update_post_meta( $post_id, '_zzurl', $my_data );\n    }\n    \n    //文章保存的时候，会调用 save_post 钩子，因此我们要借助这个钩子来保存元数据框内的数据\n    add_action( 'save_post', 'myplugin_save_meta_box_data' );\n    \n\n#### 后台常见css样式表\n\n    # copyright.php\n    function hanchang_settings_page() {\n        ?>\n        <div class=\"wrap\">\n            <h2>插件顶级菜单</h2>\n            <div id=\"message\" class=\"updated\">设置保存成功</div>\n            <div id=\"message\" class=\"error\">保存出现错误</div>\n            <p>\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" />\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" class=\"button\" />\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" class=\"button button-primary\" />\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" class=\"button button-secondary\" />\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" class=\"button button-large\" />\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" class=\"button button-small\" />\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" class=\"button button-hero\" />\n            </p>\n            <p>\n                <a href=\"#\">搜索</a>\n                <a href=\"#\" class=\"button\">搜索</a>\n                <a href=\"#\" class=\"button button-primary\">搜索</a>\n                <a href=\"#\" class=\"button button-secondary\">搜索</a>\n                <a href=\"#\" class=\"button button-large\">搜索</a>\n                <a href=\"#\" class=\"button button-small\">搜索</a>\n                <a href=\"#\" class=\"button button-hero\">搜索</a>\n            </p>\n    \n            <form method=\"POST\" action=\"\">\n                <table class=\"form-table\">\n                    <tr valign=\"top\">\n                        <th><label for=\"xingming\">姓名：</label></th>\n                        <td><input id=\"xingming\" name=\"xingming\" /></td>\n                    </tr>\n                    <tr valign=\"top\">\n                        <th><label for=\"shenfen\">身份：</label></th>\n                        <td>\n                            <select name=\"shenfen\">\n                                <option value=\"在校\">在校</option>\n                                <option value=\"毕业\">毕业</option>\n                            </select>\n                        </td>\n                    </tr>\n                    <tr valign=\"top\">\n                        <th><label for=\"tongyi\">同意注册</label></th>\n                        <td><input type=\"checkbox\" name=\"tongyi\" /></td>\n                    </tr>\n                    <tr valign=\"top\">\n                        <th><label for=\"xingbie\">性别</label></th>\n                        <td>\n                            <input type=\"radio\" name=\"xingbie\" value=\"男\" /> 男\n                            <input type=\"radio\" name=\"xingbie\" value=\"女\" /> 女\n                        </td>\n                    </tr>\n                    <tr valign=\"top\">\n                        <th><label for=\"beizhu\">备注</label></th>\n                        <td><textarea name=\"beizhu\"></textarea></td>\n                    </tr>\n                    <tr valign=\"top\">\n                        <td>\n                            <input type=\"submit\" name=\"save\" value=\"保存\" class=\"button-primary\" />\n                            <input type=\"submit\" name=\"reset\" value=\"重置\" class=\"button-secondary\" />\n                        </td>\n                    </tr>\n                </table>\n            </form>\n    \n            <table class=\"widefat striped\">\n                <thead>\n                <tr>\n                    <th>序号</th>\n                    <th>姓名</th>\n                </tr>\n                </thead>\n                <tbody>\n                <tr>\n                    <td>1</td>\n                    <td>黄聪</td>\n                </tr>\n                <tr>\n                    <td>2</td>\n                    <td>黄聪</td>\n                </tr>\n                <tr>\n                    <td>3</td>\n                    <td>黄聪</td>\n                </tr>\n                </tbody>\n                <tfoot>\n                <tr>\n                    <th>序号</th>\n                    <th>姓名</th>\n                </tr>\n                </tfoot>\n            </table>\n    \n            <div class=\"tablenav\">\n                <div class=\"tablenav-pages\">\n                    <span class=\"displaying-num\">第1页，共458页</span>\n                    <span class=\"page-numbers current\">1</span>\n                    <a href=\"#\" class=\"page-numbers\">2</a>\n                    <a href=\"#\" class=\"page-numbers\">3</a>\n                    <a href=\"#\" class=\"page-numbers\">4</a>\n                    <a href=\"#\" class=\"next page-numbers\">»</a>\n                </div>\n            </div>\n        </div>\n        <?\n    }\n    \n\n#### 保存插件设置到数据库中\n\n    ├── hc-test\n    │   ├── css\n    │   ├── hc-test.php\n    │   ├── images\n    │   └── js\n    \n    \n\n    hc-test.php\n    \n    <?php\n    /*\n    Plugin Name: hc-test\n    Plugin URI: http://zhuohc.com\n    Description: 测试插件\n    Version: 1.0\n    Author: hc\n    Author URI: http://zhuohc.com\n    License: GPLv2\n    */\n    \n    //设置时区为 亚洲/上海\n    date_default_timezone_set('Asia/Shanghai');\n    \n    //定义插件启动时候调用的方法\n    register_activation_hook( __FILE__, 'hc_test_install');\n    \n    function hc_test_install() {\n    \n       global $wpdb;\n    \n       if( $wpdb->get_var( \"SHOW TABLES LIKE '{$wpdb->prefix}test'\" ) != \"{$wpdb->prefix}test\" ) \n       {\n          $sql = \"CREATE TABLE IF NOT EXISTS `{$wpdb->prefix}test` (\n               `id` int(11) NOT NULL auto_increment COMMENT '编号',\n               `color` varchar(10) DEFAULT '' COMMENT '字体颜色',\n               `size`  varchar(10) DEFAULT '' COMMENT '字体大小',\n               PRIMARY KEY  (`id`)\n             ) DEFAULT CHARSET=utf8 AUTO_INCREMENT=0;\";\n          $wpdb->query( $sql );\n    \n          $sql = \"REPLACE INTO `{$wpdb->prefix}test` VALUES (1, '#FF0000','20');\";\n          $wpdb->query( $sql );\n       }\n    }\n    \n    add_action( 'admin_menu', 'hc_test_create_menu' );\n    \n    function hc_test_create_menu() {\n    \n       //创建顶级菜单\n       add_menu_page( \n          'HC-TEST', \n          'HC的插件',\n          'manage_options', \n          'hc_test' ,\n          'hc_settings_page',\n          plugins_url( '/images/icon.png', __FILE__ )\n       );\n    }\n    \n    function hc_settings_page() {\n    \n       global $wpdb;\n    \n       //当提交了，并且验证信息正确\n       if( !empty( $_POST ) && check_admin_referer( 'hc_test_nonce' ) ) {\n    \n          //更新设置\n          update_option( 'hc_test_bold', $_POST['hc_test_bold'] );\n    \n          $wpdb->update( \"{$wpdb->prefix}test\", array( 'color' => $_POST['color'], 'size' => $_POST['size'] ), array( 'id' => 1 ) );\n          ?>\n          <div id=\"message\" class=\"updated\">\n             <p><strong>保存成功！</strong></p>\n          </div>\n          <?\n       }\n    \n       $sql = \"SELECT * FROM `{$wpdb->prefix}test`\";\n       $row = $wpdb->get_row( $sql, ARRAY_A );\n    \n       $color = $row['color'];\n       $size = $row['size'];\n       ?>\n       <div class=\"wrap\">\n          <h2>插件顶级菜单</h2>\n          <form action=\"\" method=\"post\">\n             <p><label for=\"color\">字体颜色：</label><input type=\"text\" name=\"color\" value=\"<?php echo $color; ?>\" /></p>\n             <p><label for=\"size\">字体大小：</label>\n             <select name=\"size\">\n                <option value=\"12\" <? selected( '12', $size ); ?>>12</option>\n                <option value=\"14\" <? selected( '14', $size ); ?>>14</option>\n                <option value=\"16\" <? selected( '16', $size ); ?>>16</option>\n                <option value=\"18\" <? selected( '18', $size ); ?>>18</option>\n                <option value=\"20\" <? selected( '20', $size ); ?>>20</option>\n             </select></p>\n             <p><label for=\"hc_test_obold\">字体加粗：</label><input name=\"hc_test_bold\" type=\"checkbox\"  value=\"1\" <? checked( 1, get_option( 'hc_test_bold' ) ); ?> /> 加粗</p>\n             <p><input type=\"submit\" name=\"submit\" value=\"保存设置\" /></p>\n             <?\n                //输出一个验证信息\n                wp_nonce_field('hc_test_nonce');\n             ?>\n          </form>\n       </div>\n       <?\n    }\n    \n    add_action( 'wp_head', 'hc_test_head_fun' );\n    \n    function hc_test_head_fun() {\n    \n       global $wpdb;\n    \n       //获取自定义数据库中的设置\n       $sql = \"SELECT * FROM `{$wpdb->prefix}test`\";\n       $row = $wpdb->get_row( $sql, ARRAY_A );\n    \n       //获取options表中的设置选项\n       $bold = get_option( \"hc_test_bold\" ) == 1 ? \"bold\" : \"normal\";\n    \n       ?><style>body{color:<? echo $row[\"color\"] ?>;font-size:<? echo $row[\"size\"] ?>px;font-weight:<? echo $bold; ?>;}</style><?\n    }\n    \n\n#### 使用wordpress内置api设置插件属性\n\n    # hc-test.php\n    <?php\n    /*\n    Plugin Name: hc-test\n    Plugin URI: http://zhuohc.com\n    Description: 测试插件\n    Version: 1.0\n    Author: hc\n    Author URI: http://zhuohc.com\n    License: GPLv2\n    */\n    \n    //设置时区为 亚洲/上海\n    date_default_timezone_set('Asia/Shanghai');\n    \n    add_action( 'admin_menu', 'test_create_menu' );\n    \n    function test_create_menu() {\n    \n       //创建顶级菜单\n       add_menu_page(\n          'HC的插件首页',\n          'HC的插件',\n          'manage_options',\n          'hc_test' ,\n          'hc_settings_page',\n          plugins_url( '/images/icon.png', __FILE__ )\n       );\n    }\n    \n    add_action( 'admin_init', 'register_hc_test_setting' );\n    \n    //使用register_setting()注册要存储的字段\n    function register_hc_test_setting() {\n    \n       //注册一个选项，用于装载所有插件设置项\n       $option_group = \"hc_test_group\";\n       register_setting( $option_group, 'hc_test_option' );\n    \n       //添加选项设置区域\n       $setting_section = \"hc_test_setting_section\";\n       add_settings_section(\n          $setting_section,\n          '设置',  // 标题\n          'hc_test_setting_section_function',  // 调用方法，自定义输出\n          $option_group\n       );\n    \n       //设置字体颜色\n       add_settings_field(\n          'hc_test_color',  // 字段id\n          '字体颜色',  // 字段标题\n          'hc_test_color_function', // 字段对应函数方法\n          $option_group,  // 字段对应分组\n          $setting_section  // 字段对应设置选项\n       );\n    \n       //设置字体大小\n       add_settings_field(\n          'hc_test_size',\n          '字体大小',\n          'hc_test_size_function',\n          $option_group,\n          $setting_section\n       );\n    \n       //设置字体加粗\n       add_settings_field(\n          'hc_test_bold',\n          '字体加粗',\n          'hc_test_bold_function',\n          $option_group,\n          $setting_section\n       );\n    }\n    \n    function hc_test_bold_function() {\n       $hc_test_option = get_option( \"hc_test_option\" );\n       ?>\n       <input name=\"hc_test_option[bold]\" type=\"checkbox\"  value=\"1\" <? checked( 1, $hc_test_option[\"bold\"] ); ?> /> 加粗\n       <?\n    }\n    \n    function hc_test_size_function() {\n       $hc_test_option = get_option( \"hc_test_option\" );\n       $size = $hc_test_option[\"size\"];\n       ?>\n       <select name=\"hc_test_option[size]\">\n          <option value=\"12\" <? selected( '12', $size ); ?>>12</option>\n          <option value=\"14\" <? selected( '14', $size ); ?>>14</option>\n          <option value=\"16\" <? selected( '16', $size ); ?>>16</option>\n          <option value=\"18\" <? selected( '18', $size ); ?>>18</option>\n          <option value=\"20\" <? selected( '20', $size ); ?>>20</option>\n       </select>\n       <?\n    }\n    \n    function hc_test_color_function() {\n       $hc_test_option = get_option( \"hc_test_option\" );\n       ?>\n       <input name='hc_test_option[color]' type='text' value='<? echo $hc_test_option[\"color\"]; ?>' />\n       <?\n    }\n    \n    function hc_settings_page() {\n       ?>\n       <div class=\"wrap\">\n          <h2>插件顶级菜单</h2>\n          <form action=\"options.php\" method=\"post\">\n             <?\n             $option_group = \"hc_test_group\";\n    \n             //输出一些必要的字段，包括验证信息等\n             settings_fields( $option_group );\n    \n             //输出选项设置区域\n             do_settings_sections( $option_group );\n    \n             //输出按钮\n             submit_button();\n             ?>\n          </form>\n       </div>\n       <?\n    }\n    \n    \n    add_action( 'wp_head', 'hc_test_head_fun' );\n    \n    function hc_test_head_fun() {\n    \n       $hc_test_option = get_option( \"hc_test_option\" );\n    \n       $bold = $hc_test_option[\"bold\"] == 1 ? \"bold\" : \"normal\";\n       ?><style>body{color:<? echo $hc_test_option[\"color\"] ?>;font-size:<? echo $hc_test_option[\"size\"] ?>px;font-weight:<? echo $bold; ?>;}</style><?\n    }\n    \n\n#### 将插件改写成类的形式\n\n    #hc-test.php\n    <?php\n    /*\n    Plugin Name: hc-test\n    Plugin URI: http://zhuohc.com\n    Description: 测试插件\n    Version: 1.0\n    Author: hc\n    Author URI: http://zhuohc.com\n    License: GPLv2\n    */\n    \n    //设置时区为 亚洲/上海\n    date_default_timezone_set('Asia/Shanghai');\n    \n    \n    class hcsem_change_font_style {\n    \n       //声明类里面的属性，用 var 开头\n       var $icon_url = \"/images/icon.png\";\n       var $option_group = \"hc_test_group\";\n    \n       //构造方法，创建类的时候调用\n       function hcsem_change_font_style() {\n    \n          //创建菜单\n          add_action( 'admin_menu', array( $this, 'hc_create_menu' ) );\n          add_action( 'admin_init', array( $this, 'register_hc_test_setting' ) );\n          add_action( 'wp_head',  array( $this,  'hc_test_head_fun' ) );\n       }\n    \n       //使用register_setting()注册要存储的字段\n       function register_hc_test_setting() {\n    \n          //注册一个选项，用于装载所有插件设置项\n          register_setting( $this->option_group, 'hc_test_option' );\n    \n          //添加选项设置区域\n          $setting_section = \"hc_test_setting_section\";\n          add_settings_section(\n             $setting_section,\n             '',\n             '',\n             $this->option_group\n          );\n    \n          //设置字体颜色\n          add_settings_field(\n             'hc_test_color',\n             '字体颜色',\n             array( $this, 'hc_test_color_function' ),\n             $this->option_group,\n             $setting_section\n          );\n    \n          //设置字体大小\n          add_settings_field(\n             'hc_test_size',\n             '字体大小',\n             array( $this, 'hc_test_size_function' ),\n             $this->option_group,\n             $setting_section\n          );\n    \n          //设置字体加粗\n          add_settings_field(\n             'hc_test_bold',\n             '字体加粗',\n             array( $this, 'hc_test_bold_function' ),\n             $this->option_group,\n             $setting_section\n          );\n       }\n    \n       function hc_test_bold_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name=\"hc_test_option[bold]\" type=\"checkbox\"  value=\"1\" <? checked( 1, $hc_test_option[\"bold\"] ); ?> /> 加粗\n          <?\n       }\n    \n       function hc_test_size_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          $size = $hc_test_option[\"size\"];\n          ?>\n          <select name=\"hc_test_option[size]\">\n             <option value=\"12\" <? selected( '12', $size ); ?>>12</option>\n             <option value=\"14\" <? selected( '14', $size ); ?>>14</option>\n             <option value=\"16\" <? selected( '16', $size ); ?>>16</option>\n             <option value=\"18\" <? selected( '18', $size ); ?>>18</option>\n             <option value=\"20\" <? selected( '20', $size ); ?>>20</option>\n          </select>\n          <?\n       }\n    \n       function hc_test_color_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name='hc_test_option[color]' type='text' value='<? echo $hc_test_option[\"color\"]; ?>' />\n          <?\n       }\n    \n       function hc_create_menu() {\n    \n          //创建顶级菜单\n          add_menu_page(\n             'HC的插件首页',\n             'HC的插件',\n             'manage_options',\n             'hc_test' ,\n             array( $this, 'hc_settings_page' ),\n             plugins_url( $this->icon_url, __FILE__ )\n          );\n       }\n    \n       function hc_settings_page() {\n          ?>\n          <div class=\"wrap\">\n             <h2>插件顶级菜单</h2>\n             <form action=\"options.php\" method=\"post\">\n                <?\n                //输出一些必要的字段，包括验证信息等\n                settings_fields( $this->option_group );\n    \n                //输出选项设置区域\n                do_settings_sections( $this->option_group );\n    \n                //输出按钮\n                submit_button();\n                ?>\n             </form>\n          </div>\n          <?\n       }\n    \n       function hc_test_head_fun() {\n    \n          $hc_test_option = get_option( \"hc_test_option\" );\n    \n          $bold = $hc_test_option[\"bold\"] == 1 ? \"bold\" : \"normal\";\n          ?><style>body{color:<? echo $hc_test_option[\"color\"] ?>;font-size:<? echo $hc_test_option[\"size\"] ?>px;font-weight:<? echo $bold; ?>;}</style><?\n       }\n    }\n    \n    new hcsem_change_font_style();\n    \n\n#### 将插件设置内容转移到wordpress设置里\n\n    # hc-test.php\n    \n    class hcsem_change_font_style {\n    \n       var $option_group = \"general\";  // general常规 writing撰写 reading阅读 discussion讨论 media多媒体 permalink固定链接\n    \n       //构造方法，创建类的时候调用\n       function hcsem_change_font_style() {\n    \n          add_action( 'admin_init', array( $this, 'register_hc_test_setting' ) );\n          add_action( 'wp_head',  array( $this,  'hc_test_head_fun' ) );\n       }\n    \n       //使用register_setting()注册要存储的字段\n       function register_hc_test_setting() {\n    \n          //注册一个选项，用于装载所有插件设置项\n          register_setting( $this->option_group, 'hc_test_option' );\n    \n          //设置字体颜色\n          add_settings_field(\n             'hc_test_color',\n             '字体颜色',\n             array( $this, 'hc_test_color_function' ),\n             $this->option_group\n          );\n    \n          //设置字体大小\n          add_settings_field(\n             'hc_test_size',\n             '字体大小',\n             array( $this, 'hc_test_size_function' ),\n             $this->option_group\n          );\n    \n          //设置字体加粗\n          add_settings_field(\n             'hc_test_bold',\n             '字体加粗',\n             array( $this, 'hc_test_bold_function' ),\n             $this->option_group\n          );\n       }\n    \n       function hc_test_bold_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name=\"hc_test_option[bold]\" type=\"checkbox\"  value=\"1\" <? checked( 1, $hc_test_option[\"bold\"] ); ?> /> 加粗\n          <?\n       }\n    \n       function hc_test_size_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          $size = $hc_test_option[\"size\"];\n          ?>\n          <select name=\"hc_test_option[size]\">\n             <option value=\"12\" <? selected( '12', $size ); ?>>12</option>\n             <option value=\"14\" <? selected( '14', $size ); ?>>14</option>\n             <option value=\"16\" <? selected( '16', $size ); ?>>16</option>\n             <option value=\"18\" <? selected( '18', $size ); ?>>18</option>\n             <option value=\"20\" <? selected( '20', $size ); ?>>20</option>\n          </select>\n          <?\n       }\n    \n       function hc_test_color_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name='hc_test_option[color]' type='text' value='<? echo $hc_test_option[\"color\"]; ?>' />\n          <?\n       }\n    \n       function hc_test_head_fun() {\n    \n          $hc_test_option = get_option( \"hc_test_option\" );\n    \n          $bold = $hc_test_option[\"bold\"] == 1 ? \"bold\" : \"normal\";\n          ?><style>body{color:<? echo $hc_test_option[\"color\"] ?>;font-size:<? echo $hc_test_option[\"size\"] ?>px;font-weight:<? echo $bold; ?>;}</style><?\n       }\n    }\n    \n    new hcsem_change_font_style();\n    \n\n#### 调用ajax\n\n    # hc-test.php\n    <?php\n    /*\n    Plugin Name: hc-test\n    Plugin URI: http://zhuohc.com\n    Description: 测试插件\n    Version: 1.0\n    Author: hc\n    Author URI: http://zhuohc.com\n    License: GPLv2\n    */\n    \n    //设置时区为 亚洲/上海\n    date_default_timezone_set('Asia/Shanghai');\n    \n    class hcsem_change_font_style {\n    \n       //声明类里面的属性，用 var 开头\n       var $icon_url = \"/images/icon.png\";\n       var $option_group = \"hc_test_group\";\n    \n       //构造方法，创建类的时候调用\n       function hcsem_change_font_style() {\n    \n          //创建菜单\n          add_action( 'admin_menu', array( $this, 'hc_create_menu' ) );\n          add_action( 'admin_init', array( $this, 'register_hc_test_setting' ) );\n          add_action( 'wp_head',  array( $this,  'hc_test_head_fun' ) );\n    \n          //使用ajax校验信息\n          wp_enqueue_script( 'hc_test', plugins_url('js/hc_test.js', __FILE__), array('jquery') );\n          wp_localize_script( 'hc_test', 'ajax_object', array( 'ajax_url' => admin_url( 'admin-ajax.php' ) ) );\n    \n          add_action( 'wp_ajax_color_check_action' , array( $this, 'color_check_action_fun') );\n          add_action( 'wp_ajax_nopriv_hcsem_description' , array( $this, 'hcsem_description_fun') );\n       }\n    \n       function color_check_action_fun(){\n    \n          if( trim( $_POST['color'] ) != \"\" ){ echo \"ok\"; }\n          wp_die();\n       }\n    \n       function hcsem_description_fun() {\n    \n          echo \"hc的笔记本：\" . $_POST['description'];\n          wp_die();\n    \n       }\n    \n       //使用register_setting()注册要存储的字段\n       function register_hc_test_setting() {\n    \n          //注册一个选项，用于装载所有插件设置项\n          register_setting( $this->option_group, 'hc_test_option' );\n    \n          //添加选项设置区域\n          $setting_section = \"hc_test_setting_section\";\n          add_settings_section(\n             $setting_section,\n             '',\n             '',\n             $this->option_group\n          );\n    \n          //设置字体颜色\n          add_settings_field(\n             'hc_test_color',\n             '字体颜色',\n             array( $this, 'hc_test_color_function' ),\n             $this->option_group,\n             $setting_section\n          );\n    \n          //设置字体大小\n          add_settings_field(\n             'hc_test_size',\n             '字体大小',\n             array( $this, 'hc_test_size_function' ),\n             $this->option_group,\n             $setting_section\n          );\n    \n          //设置字体加粗\n          add_settings_field(\n             'hc_test_bold',\n             '字体加粗',\n             array( $this, 'hc_test_bold_function' ),\n             $this->option_group,\n             $setting_section\n          );\n       }\n    \n       function hc_test_bold_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name=\"hc_test_option[bold]\" type=\"checkbox\"  value=\"1\" <? checked( 1, $hc_test_option[\"bold\"] ); ?> /> 加粗\n          <?\n       }\n    \n       function hc_test_size_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          $size = $hc_test_option[\"size\"];\n          ?>\n          <select name=\"hc_test_option[size]\">\n             <option value=\"12\" <? selected( '12', $size ); ?>>12</option>\n             <option value=\"14\" <? selected( '14', $size ); ?>>14</option>\n             <option value=\"16\" <? selected( '16', $size ); ?>>16</option>\n             <option value=\"18\" <? selected( '18', $size ); ?>>18</option>\n             <option value=\"20\" <? selected( '20', $size ); ?>>20</option>\n          </select>\n          <?\n       }\n    \n       function hc_test_color_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name='hc_test_option[color]' type='text' value='<? echo $hc_test_option[\"color\"]; ?>' />\n          <font id=\"error_color\"></font></div>\n          <?\n       }\n    \n       function hc_create_menu() {\n    \n          //创建顶级菜单\n          add_menu_page(\n             'HC的插件首页',\n             'HC的插件',\n             'manage_options',\n             'hc_test' ,\n             array( $this, 'hc_settings_page' ),\n             plugins_url( $this->icon_url, __FILE__ )\n          );\n       }\n    \n       function hc_settings_page() {\n          ?>\n          <div class=\"wrap\">\n             <h2>插件顶级菜单</h2>\n             <form action=\"options.php\" method=\"post\">\n                <?\n                //输出一些必要的字段，包括验证信息等\n                settings_fields( $this->option_group );\n    \n                //输出选项设置区域\n                do_settings_sections( $this->option_group );\n    \n                //输出按钮\n                submit_button();\n                ?>\n             </form>\n          </div>\n          <?\n       }\n    \n       function hc_test_head_fun() {\n    \n          $hc_test_option = get_option( \"hc_test_option\" );\n    \n          $bold = $hc_test_option[\"bold\"] == 1 ? \"bold\" : \"normal\";\n          ?><style>body{color:<? echo $hc_test_option[\"color\"] ?>;font-size:<? echo $hc_test_option[\"size\"] ?>px;font-weight:<? echo $bold; ?>;}</style><?\n       }\n    }\n    \n    new hcsem_change_font_style();\n    \n\n    # js/hc_test.js\n    jQuery(document).ready( function($) {\n       $(\"input[name='hc_test_option[color]']\").blur( function() {\n          $.ajax({\n             type: \"POST\",\n             data: \"color=\" + $(this).val() + \"&action=hc_color_check\",\n             url: ajax_object.ajax_url,\n             beforeSend: function() {\n                $('#error_color').html('校验中...'); \n             },\n             success: function( $data ) {\n                if( $data == 'ok'){\n                    $('#error_color').html('输入正确');  \n                } else {\n                    $('#error_color').html('颜色不能为空！'); \n                }\n             }\n          });\n       });\n    });\n    \n    \n    jQuery(document).ready( function($) {\n       $(\".description\").click( function() {\n          $.ajax({\n             type: \"POST\",\n             data: \"description=\" + $(this).text() + \"&action=hcsem_description\",\n             url: ajax_object.ajax_url,\n             success : function( $data ) {\n    \n                if( $data != \"0\" ) {\n                   $(\".description\").text( $data );\n                }\n             }\n          });\n       });\n    });\n    \n\n#### 实现插件翻译功能\n\n    .\n    ├── css\n    │   └── hc_copyrighy.css\n    ├── hc-test.php\n    ├── images\n    │   └── icon.png\n    ├── js\n    │   └── hc_test.js\n    └── languages\n        ├── zh_CN.mo\n        └── zh_CN.po\n    \n    \n\n    # hc-test.php\n    <?php\n    /*\n    Plugin Name: hc-test\n    Plugin URI: http://zhuohc.com\n    Description: 测试插件\n    Version: 1.0\n    Author: hc\n    Author URI: http://zhuohc.com\n    License: GPLv2\n    */\n    \n    //设置时区为 亚洲/上海\n    date_default_timezone_set('Asia/Shanghai');\n    \n    class hcsem_change_font_style {\n    \n       //声明类里面的属性，用 var 开头\n       var $icon_url = \"/images/icon.png\";\n       var $option_group = \"hc_test_group\";\n    \n       //构造方法，创建类的时候调用\n       function hcsem_change_font_style() {\n    \n          //创建菜单\n          add_action( 'admin_menu', array( $this, 'hc_create_menu' ) );\n          add_action( 'admin_init', array( $this, 'register_hc_test_setting' ) );\n          add_action( 'wp_head',  array( $this,  'hc_test_head_fun' ) );\n    \n          //使用ajax校验信息\n          wp_enqueue_script( 'hc_test', plugins_url('js/hc_test.js', __FILE__), array('jquery') );\n          wp_localize_script( 'hc_test', 'ajax_object', array( 'ajax_url' => admin_url( 'admin-ajax.php' ) ) );\n    \n          add_action( 'wp_ajax_color_check_action' , array( $this, 'color_check_action_fun') );\n          add_action( 'wp_ajax_nopriv_hcsem_description' , array( $this, 'hcsem_description_fun') );\n    \n          add_action( 'init', array( $this, 'hcsem_load_textdomain' ) );\n       }\n    \n       function hcsem_load_textdomain() {\n    \n          //加载 languages 目录下的翻译文件 zh_CN\n          $currentLocale = get_locale();\n    \n          if( !empty( $currentLocale ) ) {\n    \n             $moFile = dirname(__FILE__) . \"/languages/{$currentLocale}.mo\";\n    \n             if( @file_exists( $moFile ) && is_readable( $moFile ) ) load_textdomain( 'hc-test', $moFile );\n          }\n       }\n    \n       function color_check_action_fun(){\n    \n          if( trim( $_POST['color'] ) != \"\" ){ echo \"ok\"; }\n          wp_die();\n       }\n    \n       function hcsem_description_fun() {\n    \n          echo \"HC的笔记本：\" . $_POST['description'];\n          wp_die();\n    \n       }\n    \n       //使用register_setting()注册要存储的字段\n       function register_hc_test_setting() {\n    \n          //注册一个选项，用于装载所有插件设置项\n          register_setting( $this->option_group, 'hc_test_option' );\n    \n          //添加选项设置区域\n          $setting_section = \"hc_test_setting_section\";\n          add_settings_section(\n             $setting_section,\n             '',\n             '',\n             $this->option_group\n          );\n    \n          //设置字体颜色\n          add_settings_field(\n             'hc_test_color',\n             __( 'color', 'hc-test' ),\n             array( $this, 'hc_test_color_function' ),\n             $this->option_group,\n             $setting_section\n          );\n    \n          //设置字体大小\n          add_settings_field(\n             'hc_test_size',\n             __( 'size', 'hc-test' ),\n             array( $this, 'hc_test_size_function' ),\n             $this->option_group,\n             $setting_section\n          );\n    \n          //设置字体加粗\n          add_settings_field(\n             'hc_test_bold',\n             __( 'bold', 'hc-test' ),\n             array( $this, 'hc_test_bold_function' ),\n             $this->option_group,\n             $setting_section\n          );\n       }\n    \n       function hc_test_bold_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name=\"hc_test_option[bold]\" type=\"checkbox\"  value=\"1\" <? checked( 1, $hc_test_option[\"bold\"] ); ?> /> <? _e( 'set bold', 'hc-test' ); ?>\n          <?\n       }\n    \n       function hc_test_size_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          $size = $hc_test_option[\"size\"];\n          ?>\n          <select name=\"hc_test_option[size]\">\n             <option value=\"12\" <? selected( '12', $size ); ?>>12</option>\n             <option value=\"14\" <? selected( '14', $size ); ?>>14</option>\n             <option value=\"16\" <? selected( '16', $size ); ?>>16</option>\n             <option value=\"18\" <? selected( '18', $size ); ?>>18</option>\n             <option value=\"20\" <? selected( '20', $size ); ?>>20</option>\n          </select>\n          <?\n       }\n    \n       function hc_test_color_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name='hc_test_option[color]' type='text' value='<? echo $hc_test_option[\"color\"]; ?>' />\n          <font id=\"error_color\"></font></div>\n          <?\n       }\n    \n       function hc_create_menu() {\n    \n          //创建顶级菜单\n          add_menu_page(\n             'hc的插件首页',\n             'hc的插件',\n             'manage_options',\n             'hc_test' ,\n             array( $this, 'hc_settings_page' ),\n             plugins_url( $this->icon_url, __FILE__ )\n          );\n       }\n    \n       function hc_settings_page() {\n          ?>\n          <div class=\"wrap\">\n             <h2>插件顶级菜单</h2>\n             <form action=\"options.php\" method=\"post\">\n                <?\n                //输出一些必要的字段，包括验证信息等\n                settings_fields( $this->option_group );\n    \n                //输出选项设置区域\n                do_settings_sections( $this->option_group );\n    \n                //输出按钮\n                submit_button();\n                ?>\n             </form>\n          </div>\n          <?\n       }\n    \n       function hc_test_head_fun() {\n    \n          $hc_test_option = get_option( \"hc_test_option\" );\n    \n          $bold = $hc_test_option[\"bold\"] == 1 ? \"bold\" : \"normal\";\n          ?><style>body{color:<? echo $hc_test_option[\"color\"] ?>;font-size:<? echo $hc_test_option[\"size\"] ?>px;font-weight:<? echo $bold; ?>;}</style><?\n       }\n    }\n    \n    new hcsem_change_font_style();","source":"_posts/wordpress插件开发基础入门.md","raw":"---\ntitle: wordpress插件开发基础入门\ntags:\n  - php\nurl: 101.html\nid: 101\ncomments: false\ncategories:\n  - 后端\ndate: 2016-11-10 11:40:48\n---\n\n#### 创建插件\n\n    ├── hanchang-copyright\n    │   └── hanchang-copyright.php\n    \n    \n\n    # hanchang-copyright.php\n    <?php\n    /*\n    Plugin Name: hanchang-copyright\n    Plugin URI: http://www.zhuohc.com\n    Description: 在页脚显示一段版权信息\n    Version: 1.0\n    Author: hanchang\n    Author URI: http://www.zhuohc.com\n    License: GPLv2\n    */\n    \n\n#### 插件启用和停用初始化\n\n    # hanchang-copyright.php\n    <?php\n    /*\n    Plugin Name: hanchang-copyright\n    Plugin URI: http://www.zhuohc.com\n    Description: 在页脚显示一段版权信息\n    Version: 1.0\n    Author: hanchang\n    Author URI: http://www.zhuohc.com\n    License: GPLv2\n    */\n    \n    //定义插件启动时候调用的方法\n    register_activation_hook( __FILE__, 'hanchang_copyright_install');\n    \n    function hanchang_copyright_install() {\n    \n        //插件启动，添加一个默认的版权信息\n        update_option( \"hanchang_copyright_text\", \"<p style='color:red'>本站点所有文章均为原创，转载请注明出处！</p>\" );\n    \n    }\n    \n    //定义插件停用时候调用的方法\n    register_deactivation_hook( __FILE__, 'hanchang_copyright_deactivation');\n    \n    function hanchang_copyright_deactivation() {\n    \n        //插件停用，设置停用标识为1\n        update_option( \"hanchang_copyright_deactivation\", \"yes\" );\n    \n    }\n    \n\n#### 删除插件\n\n    .\n    ├── hanchang-copyright.php\n    └── uninstall.php # 删除插件执行的文件\n    \n\n    # uninstall.php\n    <?\n    // 如果 uninstall 不是从 WordPress 调用，则退出\n    if( !defined( 'WP_UNINSTALL_PLUGIN' ) )\n    exit();\n    \n    //删除插件创建的项目，以确保不占用数据库资源\n    delete_option( 'hanchang_copyright_deactivation' );\n    delete_option( 'hanchang_copyright_text' );\n    \n\n#### add_action\n\n    add_action(\"$tag钩子名称\", \"$function_to_do执行函数\", $priorrity执行优先级, $accepted_arga带参数函数的参数个数)\n    \n\n    # hanchang-copyright.php\n    \n    //为 wp_footer 钩子挂载一个新的动作 hc_copyright_insert\n    add_action( \"wp_footer\", \"hc_copyright_insert\" );\n    \n    function hc_copyright_insert(){\n    \n        //输出一段字符串\n        echo get_option( \"hc_copyright_text\" );\n    \n    }\n    \n    \n    add_action( \"wp_head\", \"hanchang_copyright_insert_new\" );\n    \n    function hanchang_copyright_insert_new() {\n        echo \"<script>alert(1);</script>\";\n    }\n    \n    add_action( 'save_post', 'save_post_meta', 10, 2 );\n    \n    function save_post_meta( $post_id, $post ) {\n    \n        update_post_meta( $post_id, \"save-time\", \"更新时间：\" . date(\"Y-m-d H:i:s\") );\n    \n    }\n    \n\n#### 常见钩子\n\n    init 加载初始化\n    wp_head 加载添加到head标签中的内容\n    wp_enqueue_scripts 加载css或者js文件\n    wp_foot 加载添加到底部内容\n    \n    save_post 添加保存文章\n    wp_trash_post 将文章添加到回收站\n    delete_post 将文章删除\n    \n    wp_insert_comment 插入评论\n    \n    user_register 用户注册\n    \n\n    # hanchang-copyright.php\n    <?php\n    /*\n    Plugin Name: hanchang-copyright\n    Plugin URI: http://www.zhuohc.com\n    Description: 在页脚显示一段版权信息\n    Version: 1.0\n    Author: hanchang\n    Author URI: http://www.zhuohc.com\n    License: GPLv2\n    */\n    \n    //定义插件启动时候调用的方法\n    register_activation_hook( __FILE__, 'hanchang_copyright_install');\n    \n    function hanchang_copyright_install() {\n    \n        //插件启动，添加一个默认的版权信息\n        update_option( \"hanchang_copyright_text\", \"<p style='color:red'>本站点所有文章均为原创，转载请注明出处！</p>\" );\n    \n    }\n    \n    //定义插件停用时候调用的方法\n    register_deactivation_hook( __FILE__, 'hanchang_copyright_deactivation');\n    \n    function hanchang_copyright_deactivation() {\n    \n        //插件停用，设置停用标识为1\n        update_option( \"hanchang_copyright_deactivation\", \"yes\" );\n    \n    }\n    \n    //为 wp_footer 钩子挂载一个新的动作 hc_copyright_insert\n    add_action( \"wp_footer\", \"hc_copyright_insert\" );\n    \n    function hc_copyright_insert(){\n    \n        //输出一段字符串\n        echo get_option( \"hc_copyright_text\" );\n    \n    }\n    \n    \n    add_action( \"wp_head\", \"hanchang_copyright_insert_new\" );\n    \n    function hanchang_copyright_insert_new() {\n        echo \"<script>alert(1);</script>\";\n    }\n    \n    add_action( 'save_post', 'save_post_meta', 10, 2 );\n    \n    function save_post_meta( $post_id, $post ) {\n    \n        update_post_meta( $post_id, \"save-time\", \"更新时间：\" . date(\"Y-m-d H:i:s\") );\n    \n    }\n    \n    \n    \n    //在输出内容之前，给页面管理添加摘要功能\n    add_action( 'init', 'hc_add_excerpts_to_pages' );\n    \n    function hc_add_excerpts_to_pages() {\n    \n        //给页面管理添加摘要的功能\n        add_post_type_support( 'page', array( 'excerpt' ) );\n    }\n    \n    //wp_head钩子\n    add_action('wp_head','hc_wp_head');\n    \n    function hc_wp_head() {\n    \n        //只有首页输出描述\n        if( is_home() ){ ?>\n            <meta name=\"description\" content=\"<? bloginfo('description'); ?>\" />\n        <? }\n    \n    }\n    \n    \n    //自定义引用样式表\n    function hc_enqueue_style() {\n        wp_enqueue_style( 'core', plugins_url('css/hc_copyrighy.css', __FILE__) , false );\n    }\n    \n    //自定义引用脚本文件\n    function hc_enqueue_script() {\n        wp_enqueue_script( 'my-js', plugins_url('js/hc_copyrighy.js', __FILE__), false );\n    }\n    \n    //引用文件的钩子\n    add_action( 'wp_enqueue_scripts', 'hc_enqueue_style', 5 );\n    add_action( 'wp_enqueue_scripts', 'hc_enqueue_script', 7 );\n    \n    //删除所有挂载在 wp_enqueue_scripts 钩子上的方法\n    remove_all_actions( 'wp_enqueue_scripts', 5 );\n    \n    //评论被添加的时候触发\n    add_action( 'wp_insert_comment', 'comment_inserted', 10, 2 );\n    \n    //移除 wp_insert_comment 钩子上的 comment_inserted 方法\n    remove_action( 'wp_insert_comment', 'comment_inserted', 10 );\n    \n    function comment_inserted($comment_id, $comment_object ) {\n    \n        //获取该评论所在文章的评论总数\n        $comments_count = wp_count_comments( $comment_object->comment_post_ID );\n    \n        $commentarr = array();\n        $commentarr['comment_ID'] = $comment_id;\n    \n        //修改评论的内容，在评论内容前加上 “第{$comments_count->total_comments}个评论：” 这么一段字符串\n        $commentarr['comment_content'] = \"第{$comments_count->total_comments}个评论：\" . $comment_object->comment_content;\n    \n        wp_update_comment( $commentarr );\n    \n    }\n    \n    \n    add_action( 'user_register', 'myplugin_registration_save', 10, 1 );\n    \n    function myplugin_registration_save( $user_id ) {\n    \n        //将新用户的个人说明，设置为注册时间\n        wp_update_user( array( 'ID' => $user_id, 'description' => \"注册时间：\" . date(\"Y-m-d H:i:s\") ) );\n    \n    }\n    ?>\n    \n\n#### 过滤器\n\n    add_filter($tag过滤器名称, $function_to_add需要添加的函数, $priority优先级, $acceptedargs添加的参数数量)\n    \n    \n\n    # hanchang-copyright.php\n    //一开始，我们设置一个变量\n    $value = \"hello\";\n    \n    //给名为 hc_filter 的过滤器，挂载一个 hc_filter_fun 方法，传递给 hc_filter 的变量都会经过 hc_filter_fun 方法进行过滤\n    //add_filter( \"hc_filter\", \"hc_filter_fun\" );\n    \n    //给名为 hc_filter 的过滤器，再挂载一个 hc_filter_fun_add_time 方法，传递给 hc_filter 的变量都会经过 hc_filter_fun、hc_filter_fun_add_time 两个方法进行过滤\n    //add_filter( \"hc_filter\", \"hc_filter_fun_add_time\" );\n    \n    //对 $value 值使用名为 hc_filter 的过滤器进行过滤，这个时候，由于 hc_filter 过滤器只挂载了 hc_filter_fun 方法，因此，只使用 hc_filter_fun 方法 过滤了一次，并且返回给 $myvar 变量\n    //$myvar = apply_filters( \"hc_filter\", $value );\n    \n    add_filter( \"the_content\", \"hc_filter_fun\" );\n    add_filter( \"the_content\", \"hc_filter_fun_add_time\" );\n    \n\n#### 带参数的过滤器\n\n    # hanchang-copyright.php\n    function suppress_if_blurb( $title, $id = null ) {\n    \n        if ( in_category('wpcj', $id ) ) {\n            return '不显示标题';\n        }\n    \n        return $title . \"...\";\n    }\n    \n    //对 the_title 过滤器挂载一个 suppress_if_blurb 方法，优先级为10，传递的参数有2个\n    add_filter( 'the_title', 'suppress_if_blurb', 10, 2 );\n    \n\n#### 常见过滤器\n\n    the_content 文章内容 \n    content_save_pre 文章保存前\n    the_title 文章标题\n    wp_handle_upload_prefilter 上传文件之前\n    \n\n#### 创建菜单\n\n    add_menu_page  # 添加菜单\n    add_submenu_page  # 添加子菜单\n    \n\n    # hanchang-copyright.php\n    // admin_menu钩子挂载创建菜单方法\n    add_action( 'admin_menu', 'hc_create_menu' );\n    function hc_create_menu() {\n    \n        // 创建顶级菜单\n        add_menu_page(\n            'Hanchang的插件首页', // 菜单title标题\n            'hanchang-copyright',  // 菜单名称，显示在后台管理页面侧边栏\n            'manage_options', // 浏览插件所需要的权限=管理员权限\n            'hanchang_copyright' ,  // 菜单别名，不能与其他插件冲突\n            'hanchang_settings_page',  // 菜单需要显示的页面，调用的哪个方法\n            plugins_url( '/images/icon.png', __FILE__ )  // 调用图标\n        );\n    \n        // 创建子菜单\n        add_submenu_page(\n            'hanchang_copyright',  // 父级菜单别名\n            '关于HC的插件',  // 菜单title标题\n            '关于',  //  菜单名称，显示在后台管理页面侧边栏\n            'manage_options',  // 浏览插件所需要的权限=管理员权限\n            'hc_copyright_about',  // 菜单别名，不能与其他插件冲突\n            'hc_create_submenu_menu'  // 调用方法\n        );\n    }\n    \n    function hanchang_settings_page() {\n        ?>\n        <h2>插件顶级菜单</h2>\n        <?\n    }\n    \n    function hc_create_submenu_menu() {\n    \n        ?>\n        <h2>子菜单</h2>\n        <?\n    }\n    \n\n#开发 小工具\n\n    #hanchang-copyright.php\n    // 使用 widgets_init 动作钩子来执行自定义的函数\n    add_action( 'widgets_init', 'hc_register_widgets' );\n    \n    // 注册小工具\n    function hc_register_widgets() {\n        register_widget( 'hc_widget_info' );\n    }\n    \n    //使用 WP_Widget 类来创建小工具\n    class hc_widget_info extends WP_Widget {\n    \n        //构造函数\n        public function __construct() {\n            $widget_ops = array(\n                'classname' => 'hc_widget_info',\n                'description' => '显示作者的个人信息'\n            );\n            $this->WP_Widget( '显示作者个人信息', '作者的小工具', $widget_ops );\n        }\n    \n        //小工具管理界面\n        public function form( $instance ) {\n    \n            $defaults = array( 'title' => '作者的个人信息', 'xingming' => '作者', 'book' => '《作者》' );\n            $instance = wp_parse_args( (array) $instance, $defaults );\n    \n            $title = $instance['title'];\n            $xingming = $instance['xingming'];\n            $book = $instance['book'];\n            ?>\n            <p>标题: <input class=\"widefat\" name=\"<?php echo $this->get_field_name( 'title' ); ?>\" type=\"text\" value=\"<?php echo esc_attr( $title ); ?>\" /></p>\n            <p>姓名: <input class=\"widefat\" name=\"<?php echo $this->get_field_name( 'xingming' ); ?> \"type=\"text\" value=\"<?php echo esc_attr( $xingming ); ?> \" /></p>\n            <p>著作: <textarea class=\"widefat\" name=\" <?php echo $this->get_field_name( 'book' ); ?> \" /><?php echo esc_attr( $book ); ?></textarea> </p>\n            <?php\n        }\n    \n        //保存小工具设置\n        public function update( $new_instance, $old_instance ) {\n    \n            $instance = $old_instance;\n    \n            $instance['title'] = strip_tags( trim( $new_instance['title'] ) );\n            $instance['xingming'] = strip_tags( trim(  $new_instance['xingming'] ) );\n            $instance['book'] = strip_tags( trim( $new_instance['book'] ) );\n            return $instance;\n        }\n    \n        //显示小工具\n        public function widget( $args, $instance ) {\n    \n            extract( $args );\n    \n            $title = apply_filters( 'widget_title', $instance['title'] );\n            $xingming = empty( $instance['xingming'] ) ? ' ' : $instance['xingming'];\n            $book = empty( $instance['book'] ) ? ' ' : $instance['book'];\n    \n            echo '<p> 标题: ' . $title . '</p>';\n            echo '<p> 姓名: ' . $xingming . '</p>';\n            echo '<p> 著作: ' . $book . '</p>';\n        }\n    }\n    \n\n#### 添加元数据框\n\n    # hanchang-copyright.php\n    /**\n     * 添加一个元数据框到 post 和 page 的管理界面中\n     */\n    function myplugin_add_meta_box() {\n    \n        $screens = array( 'post', 'page' );\n    \n        add_meta_box(\n            'myplugin_sectionid',  // 元数据框的html代码中的id值\n            '转载自',  // 元数据框标题\n            'myplugin_meta_box_callback',  // 回调函数名称，输出元数据框中的内容\n            $screens  // 元数据框需要添加在哪个分类内的（文章或者页面）\n        );\n    }\n    \n    //需要给 add_meta_boxes 钩子，挂载一个自定义的方法\n    add_action( 'add_meta_boxes', 'myplugin_add_meta_box' );\n    \n    /**\n     * 元数据框展示代码\n     */\n    function myplugin_meta_box_callback( $post ) {\n    \n        // 添加一个验证信息，这个在保存元数据的时候用到\n        wp_nonce_field( 'myplugin_save_meta_box_data', 'myplugin_meta_box_nonce' );\n    \n        /*\n         * 输出元数据信息\n         */\n        $value = get_post_meta( $post->ID, '_zzurl', true );\n    \n        echo '<label for=\"myplugin_new_field\">';\n        _e( '本文章转载自：' );\n        echo '</label> ';\n        echo '<input type=\"text\" id=\"_zzurl\" name=\"_zzurl\" value=\"' . esc_attr( $value ) . '\" size=\"25\" />';\n    }\n    \n    function myplugin_save_meta_box_data( $post_id ) {\n    \n        //验证是否为有效信息\n        if ( ! isset( $_POST['myplugin_meta_box_nonce'] ) ) {\n            return;\n        }\n    \n        if ( ! wp_verify_nonce( $_POST['myplugin_meta_box_nonce'], 'myplugin_save_meta_box_data' ) ) {\n            return;\n        }\n    \n        if ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) {\n            return;\n        }\n    \n        // Check the user's permissions.\n        if ( isset( $_POST['post_type'] ) && 'page' == $_POST['post_type'] ) {\n    \n            if ( ! current_user_can( 'edit_page', $post_id ) ) {\n                return;\n            }\n    \n        } else {\n    \n            if ( ! current_user_can( 'edit_post', $post_id ) ) {\n                return;\n            }\n        }\n    \n        if ( ! isset( $_POST['_zzurl'] ) ) {\n            return;\n        }\n    \n        $my_data = sanitize_text_field( $_POST['_zzurl'] );\n    \n        update_post_meta( $post_id, '_zzurl', $my_data );\n    }\n    \n    //文章保存的时候，会调用 save_post 钩子，因此我们要借助这个钩子来保存元数据框内的数据\n    add_action( 'save_post', 'myplugin_save_meta_box_data' );\n    \n\n#### 后台常见css样式表\n\n    # copyright.php\n    function hanchang_settings_page() {\n        ?>\n        <div class=\"wrap\">\n            <h2>插件顶级菜单</h2>\n            <div id=\"message\" class=\"updated\">设置保存成功</div>\n            <div id=\"message\" class=\"error\">保存出现错误</div>\n            <p>\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" />\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" class=\"button\" />\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" class=\"button button-primary\" />\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" class=\"button button-secondary\" />\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" class=\"button button-large\" />\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" class=\"button button-small\" />\n                <input type=\"submit\" name=\"Save\" value=\"保存设置\" class=\"button button-hero\" />\n            </p>\n            <p>\n                <a href=\"#\">搜索</a>\n                <a href=\"#\" class=\"button\">搜索</a>\n                <a href=\"#\" class=\"button button-primary\">搜索</a>\n                <a href=\"#\" class=\"button button-secondary\">搜索</a>\n                <a href=\"#\" class=\"button button-large\">搜索</a>\n                <a href=\"#\" class=\"button button-small\">搜索</a>\n                <a href=\"#\" class=\"button button-hero\">搜索</a>\n            </p>\n    \n            <form method=\"POST\" action=\"\">\n                <table class=\"form-table\">\n                    <tr valign=\"top\">\n                        <th><label for=\"xingming\">姓名：</label></th>\n                        <td><input id=\"xingming\" name=\"xingming\" /></td>\n                    </tr>\n                    <tr valign=\"top\">\n                        <th><label for=\"shenfen\">身份：</label></th>\n                        <td>\n                            <select name=\"shenfen\">\n                                <option value=\"在校\">在校</option>\n                                <option value=\"毕业\">毕业</option>\n                            </select>\n                        </td>\n                    </tr>\n                    <tr valign=\"top\">\n                        <th><label for=\"tongyi\">同意注册</label></th>\n                        <td><input type=\"checkbox\" name=\"tongyi\" /></td>\n                    </tr>\n                    <tr valign=\"top\">\n                        <th><label for=\"xingbie\">性别</label></th>\n                        <td>\n                            <input type=\"radio\" name=\"xingbie\" value=\"男\" /> 男\n                            <input type=\"radio\" name=\"xingbie\" value=\"女\" /> 女\n                        </td>\n                    </tr>\n                    <tr valign=\"top\">\n                        <th><label for=\"beizhu\">备注</label></th>\n                        <td><textarea name=\"beizhu\"></textarea></td>\n                    </tr>\n                    <tr valign=\"top\">\n                        <td>\n                            <input type=\"submit\" name=\"save\" value=\"保存\" class=\"button-primary\" />\n                            <input type=\"submit\" name=\"reset\" value=\"重置\" class=\"button-secondary\" />\n                        </td>\n                    </tr>\n                </table>\n            </form>\n    \n            <table class=\"widefat striped\">\n                <thead>\n                <tr>\n                    <th>序号</th>\n                    <th>姓名</th>\n                </tr>\n                </thead>\n                <tbody>\n                <tr>\n                    <td>1</td>\n                    <td>黄聪</td>\n                </tr>\n                <tr>\n                    <td>2</td>\n                    <td>黄聪</td>\n                </tr>\n                <tr>\n                    <td>3</td>\n                    <td>黄聪</td>\n                </tr>\n                </tbody>\n                <tfoot>\n                <tr>\n                    <th>序号</th>\n                    <th>姓名</th>\n                </tr>\n                </tfoot>\n            </table>\n    \n            <div class=\"tablenav\">\n                <div class=\"tablenav-pages\">\n                    <span class=\"displaying-num\">第1页，共458页</span>\n                    <span class=\"page-numbers current\">1</span>\n                    <a href=\"#\" class=\"page-numbers\">2</a>\n                    <a href=\"#\" class=\"page-numbers\">3</a>\n                    <a href=\"#\" class=\"page-numbers\">4</a>\n                    <a href=\"#\" class=\"next page-numbers\">»</a>\n                </div>\n            </div>\n        </div>\n        <?\n    }\n    \n\n#### 保存插件设置到数据库中\n\n    ├── hc-test\n    │   ├── css\n    │   ├── hc-test.php\n    │   ├── images\n    │   └── js\n    \n    \n\n    hc-test.php\n    \n    <?php\n    /*\n    Plugin Name: hc-test\n    Plugin URI: http://zhuohc.com\n    Description: 测试插件\n    Version: 1.0\n    Author: hc\n    Author URI: http://zhuohc.com\n    License: GPLv2\n    */\n    \n    //设置时区为 亚洲/上海\n    date_default_timezone_set('Asia/Shanghai');\n    \n    //定义插件启动时候调用的方法\n    register_activation_hook( __FILE__, 'hc_test_install');\n    \n    function hc_test_install() {\n    \n       global $wpdb;\n    \n       if( $wpdb->get_var( \"SHOW TABLES LIKE '{$wpdb->prefix}test'\" ) != \"{$wpdb->prefix}test\" ) \n       {\n          $sql = \"CREATE TABLE IF NOT EXISTS `{$wpdb->prefix}test` (\n               `id` int(11) NOT NULL auto_increment COMMENT '编号',\n               `color` varchar(10) DEFAULT '' COMMENT '字体颜色',\n               `size`  varchar(10) DEFAULT '' COMMENT '字体大小',\n               PRIMARY KEY  (`id`)\n             ) DEFAULT CHARSET=utf8 AUTO_INCREMENT=0;\";\n          $wpdb->query( $sql );\n    \n          $sql = \"REPLACE INTO `{$wpdb->prefix}test` VALUES (1, '#FF0000','20');\";\n          $wpdb->query( $sql );\n       }\n    }\n    \n    add_action( 'admin_menu', 'hc_test_create_menu' );\n    \n    function hc_test_create_menu() {\n    \n       //创建顶级菜单\n       add_menu_page( \n          'HC-TEST', \n          'HC的插件',\n          'manage_options', \n          'hc_test' ,\n          'hc_settings_page',\n          plugins_url( '/images/icon.png', __FILE__ )\n       );\n    }\n    \n    function hc_settings_page() {\n    \n       global $wpdb;\n    \n       //当提交了，并且验证信息正确\n       if( !empty( $_POST ) && check_admin_referer( 'hc_test_nonce' ) ) {\n    \n          //更新设置\n          update_option( 'hc_test_bold', $_POST['hc_test_bold'] );\n    \n          $wpdb->update( \"{$wpdb->prefix}test\", array( 'color' => $_POST['color'], 'size' => $_POST['size'] ), array( 'id' => 1 ) );\n          ?>\n          <div id=\"message\" class=\"updated\">\n             <p><strong>保存成功！</strong></p>\n          </div>\n          <?\n       }\n    \n       $sql = \"SELECT * FROM `{$wpdb->prefix}test`\";\n       $row = $wpdb->get_row( $sql, ARRAY_A );\n    \n       $color = $row['color'];\n       $size = $row['size'];\n       ?>\n       <div class=\"wrap\">\n          <h2>插件顶级菜单</h2>\n          <form action=\"\" method=\"post\">\n             <p><label for=\"color\">字体颜色：</label><input type=\"text\" name=\"color\" value=\"<?php echo $color; ?>\" /></p>\n             <p><label for=\"size\">字体大小：</label>\n             <select name=\"size\">\n                <option value=\"12\" <? selected( '12', $size ); ?>>12</option>\n                <option value=\"14\" <? selected( '14', $size ); ?>>14</option>\n                <option value=\"16\" <? selected( '16', $size ); ?>>16</option>\n                <option value=\"18\" <? selected( '18', $size ); ?>>18</option>\n                <option value=\"20\" <? selected( '20', $size ); ?>>20</option>\n             </select></p>\n             <p><label for=\"hc_test_obold\">字体加粗：</label><input name=\"hc_test_bold\" type=\"checkbox\"  value=\"1\" <? checked( 1, get_option( 'hc_test_bold' ) ); ?> /> 加粗</p>\n             <p><input type=\"submit\" name=\"submit\" value=\"保存设置\" /></p>\n             <?\n                //输出一个验证信息\n                wp_nonce_field('hc_test_nonce');\n             ?>\n          </form>\n       </div>\n       <?\n    }\n    \n    add_action( 'wp_head', 'hc_test_head_fun' );\n    \n    function hc_test_head_fun() {\n    \n       global $wpdb;\n    \n       //获取自定义数据库中的设置\n       $sql = \"SELECT * FROM `{$wpdb->prefix}test`\";\n       $row = $wpdb->get_row( $sql, ARRAY_A );\n    \n       //获取options表中的设置选项\n       $bold = get_option( \"hc_test_bold\" ) == 1 ? \"bold\" : \"normal\";\n    \n       ?><style>body{color:<? echo $row[\"color\"] ?>;font-size:<? echo $row[\"size\"] ?>px;font-weight:<? echo $bold; ?>;}</style><?\n    }\n    \n\n#### 使用wordpress内置api设置插件属性\n\n    # hc-test.php\n    <?php\n    /*\n    Plugin Name: hc-test\n    Plugin URI: http://zhuohc.com\n    Description: 测试插件\n    Version: 1.0\n    Author: hc\n    Author URI: http://zhuohc.com\n    License: GPLv2\n    */\n    \n    //设置时区为 亚洲/上海\n    date_default_timezone_set('Asia/Shanghai');\n    \n    add_action( 'admin_menu', 'test_create_menu' );\n    \n    function test_create_menu() {\n    \n       //创建顶级菜单\n       add_menu_page(\n          'HC的插件首页',\n          'HC的插件',\n          'manage_options',\n          'hc_test' ,\n          'hc_settings_page',\n          plugins_url( '/images/icon.png', __FILE__ )\n       );\n    }\n    \n    add_action( 'admin_init', 'register_hc_test_setting' );\n    \n    //使用register_setting()注册要存储的字段\n    function register_hc_test_setting() {\n    \n       //注册一个选项，用于装载所有插件设置项\n       $option_group = \"hc_test_group\";\n       register_setting( $option_group, 'hc_test_option' );\n    \n       //添加选项设置区域\n       $setting_section = \"hc_test_setting_section\";\n       add_settings_section(\n          $setting_section,\n          '设置',  // 标题\n          'hc_test_setting_section_function',  // 调用方法，自定义输出\n          $option_group\n       );\n    \n       //设置字体颜色\n       add_settings_field(\n          'hc_test_color',  // 字段id\n          '字体颜色',  // 字段标题\n          'hc_test_color_function', // 字段对应函数方法\n          $option_group,  // 字段对应分组\n          $setting_section  // 字段对应设置选项\n       );\n    \n       //设置字体大小\n       add_settings_field(\n          'hc_test_size',\n          '字体大小',\n          'hc_test_size_function',\n          $option_group,\n          $setting_section\n       );\n    \n       //设置字体加粗\n       add_settings_field(\n          'hc_test_bold',\n          '字体加粗',\n          'hc_test_bold_function',\n          $option_group,\n          $setting_section\n       );\n    }\n    \n    function hc_test_bold_function() {\n       $hc_test_option = get_option( \"hc_test_option\" );\n       ?>\n       <input name=\"hc_test_option[bold]\" type=\"checkbox\"  value=\"1\" <? checked( 1, $hc_test_option[\"bold\"] ); ?> /> 加粗\n       <?\n    }\n    \n    function hc_test_size_function() {\n       $hc_test_option = get_option( \"hc_test_option\" );\n       $size = $hc_test_option[\"size\"];\n       ?>\n       <select name=\"hc_test_option[size]\">\n          <option value=\"12\" <? selected( '12', $size ); ?>>12</option>\n          <option value=\"14\" <? selected( '14', $size ); ?>>14</option>\n          <option value=\"16\" <? selected( '16', $size ); ?>>16</option>\n          <option value=\"18\" <? selected( '18', $size ); ?>>18</option>\n          <option value=\"20\" <? selected( '20', $size ); ?>>20</option>\n       </select>\n       <?\n    }\n    \n    function hc_test_color_function() {\n       $hc_test_option = get_option( \"hc_test_option\" );\n       ?>\n       <input name='hc_test_option[color]' type='text' value='<? echo $hc_test_option[\"color\"]; ?>' />\n       <?\n    }\n    \n    function hc_settings_page() {\n       ?>\n       <div class=\"wrap\">\n          <h2>插件顶级菜单</h2>\n          <form action=\"options.php\" method=\"post\">\n             <?\n             $option_group = \"hc_test_group\";\n    \n             //输出一些必要的字段，包括验证信息等\n             settings_fields( $option_group );\n    \n             //输出选项设置区域\n             do_settings_sections( $option_group );\n    \n             //输出按钮\n             submit_button();\n             ?>\n          </form>\n       </div>\n       <?\n    }\n    \n    \n    add_action( 'wp_head', 'hc_test_head_fun' );\n    \n    function hc_test_head_fun() {\n    \n       $hc_test_option = get_option( \"hc_test_option\" );\n    \n       $bold = $hc_test_option[\"bold\"] == 1 ? \"bold\" : \"normal\";\n       ?><style>body{color:<? echo $hc_test_option[\"color\"] ?>;font-size:<? echo $hc_test_option[\"size\"] ?>px;font-weight:<? echo $bold; ?>;}</style><?\n    }\n    \n\n#### 将插件改写成类的形式\n\n    #hc-test.php\n    <?php\n    /*\n    Plugin Name: hc-test\n    Plugin URI: http://zhuohc.com\n    Description: 测试插件\n    Version: 1.0\n    Author: hc\n    Author URI: http://zhuohc.com\n    License: GPLv2\n    */\n    \n    //设置时区为 亚洲/上海\n    date_default_timezone_set('Asia/Shanghai');\n    \n    \n    class hcsem_change_font_style {\n    \n       //声明类里面的属性，用 var 开头\n       var $icon_url = \"/images/icon.png\";\n       var $option_group = \"hc_test_group\";\n    \n       //构造方法，创建类的时候调用\n       function hcsem_change_font_style() {\n    \n          //创建菜单\n          add_action( 'admin_menu', array( $this, 'hc_create_menu' ) );\n          add_action( 'admin_init', array( $this, 'register_hc_test_setting' ) );\n          add_action( 'wp_head',  array( $this,  'hc_test_head_fun' ) );\n       }\n    \n       //使用register_setting()注册要存储的字段\n       function register_hc_test_setting() {\n    \n          //注册一个选项，用于装载所有插件设置项\n          register_setting( $this->option_group, 'hc_test_option' );\n    \n          //添加选项设置区域\n          $setting_section = \"hc_test_setting_section\";\n          add_settings_section(\n             $setting_section,\n             '',\n             '',\n             $this->option_group\n          );\n    \n          //设置字体颜色\n          add_settings_field(\n             'hc_test_color',\n             '字体颜色',\n             array( $this, 'hc_test_color_function' ),\n             $this->option_group,\n             $setting_section\n          );\n    \n          //设置字体大小\n          add_settings_field(\n             'hc_test_size',\n             '字体大小',\n             array( $this, 'hc_test_size_function' ),\n             $this->option_group,\n             $setting_section\n          );\n    \n          //设置字体加粗\n          add_settings_field(\n             'hc_test_bold',\n             '字体加粗',\n             array( $this, 'hc_test_bold_function' ),\n             $this->option_group,\n             $setting_section\n          );\n       }\n    \n       function hc_test_bold_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name=\"hc_test_option[bold]\" type=\"checkbox\"  value=\"1\" <? checked( 1, $hc_test_option[\"bold\"] ); ?> /> 加粗\n          <?\n       }\n    \n       function hc_test_size_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          $size = $hc_test_option[\"size\"];\n          ?>\n          <select name=\"hc_test_option[size]\">\n             <option value=\"12\" <? selected( '12', $size ); ?>>12</option>\n             <option value=\"14\" <? selected( '14', $size ); ?>>14</option>\n             <option value=\"16\" <? selected( '16', $size ); ?>>16</option>\n             <option value=\"18\" <? selected( '18', $size ); ?>>18</option>\n             <option value=\"20\" <? selected( '20', $size ); ?>>20</option>\n          </select>\n          <?\n       }\n    \n       function hc_test_color_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name='hc_test_option[color]' type='text' value='<? echo $hc_test_option[\"color\"]; ?>' />\n          <?\n       }\n    \n       function hc_create_menu() {\n    \n          //创建顶级菜单\n          add_menu_page(\n             'HC的插件首页',\n             'HC的插件',\n             'manage_options',\n             'hc_test' ,\n             array( $this, 'hc_settings_page' ),\n             plugins_url( $this->icon_url, __FILE__ )\n          );\n       }\n    \n       function hc_settings_page() {\n          ?>\n          <div class=\"wrap\">\n             <h2>插件顶级菜单</h2>\n             <form action=\"options.php\" method=\"post\">\n                <?\n                //输出一些必要的字段，包括验证信息等\n                settings_fields( $this->option_group );\n    \n                //输出选项设置区域\n                do_settings_sections( $this->option_group );\n    \n                //输出按钮\n                submit_button();\n                ?>\n             </form>\n          </div>\n          <?\n       }\n    \n       function hc_test_head_fun() {\n    \n          $hc_test_option = get_option( \"hc_test_option\" );\n    \n          $bold = $hc_test_option[\"bold\"] == 1 ? \"bold\" : \"normal\";\n          ?><style>body{color:<? echo $hc_test_option[\"color\"] ?>;font-size:<? echo $hc_test_option[\"size\"] ?>px;font-weight:<? echo $bold; ?>;}</style><?\n       }\n    }\n    \n    new hcsem_change_font_style();\n    \n\n#### 将插件设置内容转移到wordpress设置里\n\n    # hc-test.php\n    \n    class hcsem_change_font_style {\n    \n       var $option_group = \"general\";  // general常规 writing撰写 reading阅读 discussion讨论 media多媒体 permalink固定链接\n    \n       //构造方法，创建类的时候调用\n       function hcsem_change_font_style() {\n    \n          add_action( 'admin_init', array( $this, 'register_hc_test_setting' ) );\n          add_action( 'wp_head',  array( $this,  'hc_test_head_fun' ) );\n       }\n    \n       //使用register_setting()注册要存储的字段\n       function register_hc_test_setting() {\n    \n          //注册一个选项，用于装载所有插件设置项\n          register_setting( $this->option_group, 'hc_test_option' );\n    \n          //设置字体颜色\n          add_settings_field(\n             'hc_test_color',\n             '字体颜色',\n             array( $this, 'hc_test_color_function' ),\n             $this->option_group\n          );\n    \n          //设置字体大小\n          add_settings_field(\n             'hc_test_size',\n             '字体大小',\n             array( $this, 'hc_test_size_function' ),\n             $this->option_group\n          );\n    \n          //设置字体加粗\n          add_settings_field(\n             'hc_test_bold',\n             '字体加粗',\n             array( $this, 'hc_test_bold_function' ),\n             $this->option_group\n          );\n       }\n    \n       function hc_test_bold_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name=\"hc_test_option[bold]\" type=\"checkbox\"  value=\"1\" <? checked( 1, $hc_test_option[\"bold\"] ); ?> /> 加粗\n          <?\n       }\n    \n       function hc_test_size_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          $size = $hc_test_option[\"size\"];\n          ?>\n          <select name=\"hc_test_option[size]\">\n             <option value=\"12\" <? selected( '12', $size ); ?>>12</option>\n             <option value=\"14\" <? selected( '14', $size ); ?>>14</option>\n             <option value=\"16\" <? selected( '16', $size ); ?>>16</option>\n             <option value=\"18\" <? selected( '18', $size ); ?>>18</option>\n             <option value=\"20\" <? selected( '20', $size ); ?>>20</option>\n          </select>\n          <?\n       }\n    \n       function hc_test_color_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name='hc_test_option[color]' type='text' value='<? echo $hc_test_option[\"color\"]; ?>' />\n          <?\n       }\n    \n       function hc_test_head_fun() {\n    \n          $hc_test_option = get_option( \"hc_test_option\" );\n    \n          $bold = $hc_test_option[\"bold\"] == 1 ? \"bold\" : \"normal\";\n          ?><style>body{color:<? echo $hc_test_option[\"color\"] ?>;font-size:<? echo $hc_test_option[\"size\"] ?>px;font-weight:<? echo $bold; ?>;}</style><?\n       }\n    }\n    \n    new hcsem_change_font_style();\n    \n\n#### 调用ajax\n\n    # hc-test.php\n    <?php\n    /*\n    Plugin Name: hc-test\n    Plugin URI: http://zhuohc.com\n    Description: 测试插件\n    Version: 1.0\n    Author: hc\n    Author URI: http://zhuohc.com\n    License: GPLv2\n    */\n    \n    //设置时区为 亚洲/上海\n    date_default_timezone_set('Asia/Shanghai');\n    \n    class hcsem_change_font_style {\n    \n       //声明类里面的属性，用 var 开头\n       var $icon_url = \"/images/icon.png\";\n       var $option_group = \"hc_test_group\";\n    \n       //构造方法，创建类的时候调用\n       function hcsem_change_font_style() {\n    \n          //创建菜单\n          add_action( 'admin_menu', array( $this, 'hc_create_menu' ) );\n          add_action( 'admin_init', array( $this, 'register_hc_test_setting' ) );\n          add_action( 'wp_head',  array( $this,  'hc_test_head_fun' ) );\n    \n          //使用ajax校验信息\n          wp_enqueue_script( 'hc_test', plugins_url('js/hc_test.js', __FILE__), array('jquery') );\n          wp_localize_script( 'hc_test', 'ajax_object', array( 'ajax_url' => admin_url( 'admin-ajax.php' ) ) );\n    \n          add_action( 'wp_ajax_color_check_action' , array( $this, 'color_check_action_fun') );\n          add_action( 'wp_ajax_nopriv_hcsem_description' , array( $this, 'hcsem_description_fun') );\n       }\n    \n       function color_check_action_fun(){\n    \n          if( trim( $_POST['color'] ) != \"\" ){ echo \"ok\"; }\n          wp_die();\n       }\n    \n       function hcsem_description_fun() {\n    \n          echo \"hc的笔记本：\" . $_POST['description'];\n          wp_die();\n    \n       }\n    \n       //使用register_setting()注册要存储的字段\n       function register_hc_test_setting() {\n    \n          //注册一个选项，用于装载所有插件设置项\n          register_setting( $this->option_group, 'hc_test_option' );\n    \n          //添加选项设置区域\n          $setting_section = \"hc_test_setting_section\";\n          add_settings_section(\n             $setting_section,\n             '',\n             '',\n             $this->option_group\n          );\n    \n          //设置字体颜色\n          add_settings_field(\n             'hc_test_color',\n             '字体颜色',\n             array( $this, 'hc_test_color_function' ),\n             $this->option_group,\n             $setting_section\n          );\n    \n          //设置字体大小\n          add_settings_field(\n             'hc_test_size',\n             '字体大小',\n             array( $this, 'hc_test_size_function' ),\n             $this->option_group,\n             $setting_section\n          );\n    \n          //设置字体加粗\n          add_settings_field(\n             'hc_test_bold',\n             '字体加粗',\n             array( $this, 'hc_test_bold_function' ),\n             $this->option_group,\n             $setting_section\n          );\n       }\n    \n       function hc_test_bold_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name=\"hc_test_option[bold]\" type=\"checkbox\"  value=\"1\" <? checked( 1, $hc_test_option[\"bold\"] ); ?> /> 加粗\n          <?\n       }\n    \n       function hc_test_size_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          $size = $hc_test_option[\"size\"];\n          ?>\n          <select name=\"hc_test_option[size]\">\n             <option value=\"12\" <? selected( '12', $size ); ?>>12</option>\n             <option value=\"14\" <? selected( '14', $size ); ?>>14</option>\n             <option value=\"16\" <? selected( '16', $size ); ?>>16</option>\n             <option value=\"18\" <? selected( '18', $size ); ?>>18</option>\n             <option value=\"20\" <? selected( '20', $size ); ?>>20</option>\n          </select>\n          <?\n       }\n    \n       function hc_test_color_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name='hc_test_option[color]' type='text' value='<? echo $hc_test_option[\"color\"]; ?>' />\n          <font id=\"error_color\"></font></div>\n          <?\n       }\n    \n       function hc_create_menu() {\n    \n          //创建顶级菜单\n          add_menu_page(\n             'HC的插件首页',\n             'HC的插件',\n             'manage_options',\n             'hc_test' ,\n             array( $this, 'hc_settings_page' ),\n             plugins_url( $this->icon_url, __FILE__ )\n          );\n       }\n    \n       function hc_settings_page() {\n          ?>\n          <div class=\"wrap\">\n             <h2>插件顶级菜单</h2>\n             <form action=\"options.php\" method=\"post\">\n                <?\n                //输出一些必要的字段，包括验证信息等\n                settings_fields( $this->option_group );\n    \n                //输出选项设置区域\n                do_settings_sections( $this->option_group );\n    \n                //输出按钮\n                submit_button();\n                ?>\n             </form>\n          </div>\n          <?\n       }\n    \n       function hc_test_head_fun() {\n    \n          $hc_test_option = get_option( \"hc_test_option\" );\n    \n          $bold = $hc_test_option[\"bold\"] == 1 ? \"bold\" : \"normal\";\n          ?><style>body{color:<? echo $hc_test_option[\"color\"] ?>;font-size:<? echo $hc_test_option[\"size\"] ?>px;font-weight:<? echo $bold; ?>;}</style><?\n       }\n    }\n    \n    new hcsem_change_font_style();\n    \n\n    # js/hc_test.js\n    jQuery(document).ready( function($) {\n       $(\"input[name='hc_test_option[color]']\").blur( function() {\n          $.ajax({\n             type: \"POST\",\n             data: \"color=\" + $(this).val() + \"&action=hc_color_check\",\n             url: ajax_object.ajax_url,\n             beforeSend: function() {\n                $('#error_color').html('校验中...'); \n             },\n             success: function( $data ) {\n                if( $data == 'ok'){\n                    $('#error_color').html('输入正确');  \n                } else {\n                    $('#error_color').html('颜色不能为空！'); \n                }\n             }\n          });\n       });\n    });\n    \n    \n    jQuery(document).ready( function($) {\n       $(\".description\").click( function() {\n          $.ajax({\n             type: \"POST\",\n             data: \"description=\" + $(this).text() + \"&action=hcsem_description\",\n             url: ajax_object.ajax_url,\n             success : function( $data ) {\n    \n                if( $data != \"0\" ) {\n                   $(\".description\").text( $data );\n                }\n             }\n          });\n       });\n    });\n    \n\n#### 实现插件翻译功能\n\n    .\n    ├── css\n    │   └── hc_copyrighy.css\n    ├── hc-test.php\n    ├── images\n    │   └── icon.png\n    ├── js\n    │   └── hc_test.js\n    └── languages\n        ├── zh_CN.mo\n        └── zh_CN.po\n    \n    \n\n    # hc-test.php\n    <?php\n    /*\n    Plugin Name: hc-test\n    Plugin URI: http://zhuohc.com\n    Description: 测试插件\n    Version: 1.0\n    Author: hc\n    Author URI: http://zhuohc.com\n    License: GPLv2\n    */\n    \n    //设置时区为 亚洲/上海\n    date_default_timezone_set('Asia/Shanghai');\n    \n    class hcsem_change_font_style {\n    \n       //声明类里面的属性，用 var 开头\n       var $icon_url = \"/images/icon.png\";\n       var $option_group = \"hc_test_group\";\n    \n       //构造方法，创建类的时候调用\n       function hcsem_change_font_style() {\n    \n          //创建菜单\n          add_action( 'admin_menu', array( $this, 'hc_create_menu' ) );\n          add_action( 'admin_init', array( $this, 'register_hc_test_setting' ) );\n          add_action( 'wp_head',  array( $this,  'hc_test_head_fun' ) );\n    \n          //使用ajax校验信息\n          wp_enqueue_script( 'hc_test', plugins_url('js/hc_test.js', __FILE__), array('jquery') );\n          wp_localize_script( 'hc_test', 'ajax_object', array( 'ajax_url' => admin_url( 'admin-ajax.php' ) ) );\n    \n          add_action( 'wp_ajax_color_check_action' , array( $this, 'color_check_action_fun') );\n          add_action( 'wp_ajax_nopriv_hcsem_description' , array( $this, 'hcsem_description_fun') );\n    \n          add_action( 'init', array( $this, 'hcsem_load_textdomain' ) );\n       }\n    \n       function hcsem_load_textdomain() {\n    \n          //加载 languages 目录下的翻译文件 zh_CN\n          $currentLocale = get_locale();\n    \n          if( !empty( $currentLocale ) ) {\n    \n             $moFile = dirname(__FILE__) . \"/languages/{$currentLocale}.mo\";\n    \n             if( @file_exists( $moFile ) && is_readable( $moFile ) ) load_textdomain( 'hc-test', $moFile );\n          }\n       }\n    \n       function color_check_action_fun(){\n    \n          if( trim( $_POST['color'] ) != \"\" ){ echo \"ok\"; }\n          wp_die();\n       }\n    \n       function hcsem_description_fun() {\n    \n          echo \"HC的笔记本：\" . $_POST['description'];\n          wp_die();\n    \n       }\n    \n       //使用register_setting()注册要存储的字段\n       function register_hc_test_setting() {\n    \n          //注册一个选项，用于装载所有插件设置项\n          register_setting( $this->option_group, 'hc_test_option' );\n    \n          //添加选项设置区域\n          $setting_section = \"hc_test_setting_section\";\n          add_settings_section(\n             $setting_section,\n             '',\n             '',\n             $this->option_group\n          );\n    \n          //设置字体颜色\n          add_settings_field(\n             'hc_test_color',\n             __( 'color', 'hc-test' ),\n             array( $this, 'hc_test_color_function' ),\n             $this->option_group,\n             $setting_section\n          );\n    \n          //设置字体大小\n          add_settings_field(\n             'hc_test_size',\n             __( 'size', 'hc-test' ),\n             array( $this, 'hc_test_size_function' ),\n             $this->option_group,\n             $setting_section\n          );\n    \n          //设置字体加粗\n          add_settings_field(\n             'hc_test_bold',\n             __( 'bold', 'hc-test' ),\n             array( $this, 'hc_test_bold_function' ),\n             $this->option_group,\n             $setting_section\n          );\n       }\n    \n       function hc_test_bold_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name=\"hc_test_option[bold]\" type=\"checkbox\"  value=\"1\" <? checked( 1, $hc_test_option[\"bold\"] ); ?> /> <? _e( 'set bold', 'hc-test' ); ?>\n          <?\n       }\n    \n       function hc_test_size_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          $size = $hc_test_option[\"size\"];\n          ?>\n          <select name=\"hc_test_option[size]\">\n             <option value=\"12\" <? selected( '12', $size ); ?>>12</option>\n             <option value=\"14\" <? selected( '14', $size ); ?>>14</option>\n             <option value=\"16\" <? selected( '16', $size ); ?>>16</option>\n             <option value=\"18\" <? selected( '18', $size ); ?>>18</option>\n             <option value=\"20\" <? selected( '20', $size ); ?>>20</option>\n          </select>\n          <?\n       }\n    \n       function hc_test_color_function() {\n          $hc_test_option = get_option( \"hc_test_option\" );\n          ?>\n          <input name='hc_test_option[color]' type='text' value='<? echo $hc_test_option[\"color\"]; ?>' />\n          <font id=\"error_color\"></font></div>\n          <?\n       }\n    \n       function hc_create_menu() {\n    \n          //创建顶级菜单\n          add_menu_page(\n             'hc的插件首页',\n             'hc的插件',\n             'manage_options',\n             'hc_test' ,\n             array( $this, 'hc_settings_page' ),\n             plugins_url( $this->icon_url, __FILE__ )\n          );\n       }\n    \n       function hc_settings_page() {\n          ?>\n          <div class=\"wrap\">\n             <h2>插件顶级菜单</h2>\n             <form action=\"options.php\" method=\"post\">\n                <?\n                //输出一些必要的字段，包括验证信息等\n                settings_fields( $this->option_group );\n    \n                //输出选项设置区域\n                do_settings_sections( $this->option_group );\n    \n                //输出按钮\n                submit_button();\n                ?>\n             </form>\n          </div>\n          <?\n       }\n    \n       function hc_test_head_fun() {\n    \n          $hc_test_option = get_option( \"hc_test_option\" );\n    \n          $bold = $hc_test_option[\"bold\"] == 1 ? \"bold\" : \"normal\";\n          ?><style>body{color:<? echo $hc_test_option[\"color\"] ?>;font-size:<? echo $hc_test_option[\"size\"] ?>px;font-weight:<? echo $bold; ?>;}</style><?\n       }\n    }\n    \n    new hcsem_change_font_style();","slug":"wordpress插件开发基础入门","published":1,"updated":"2019-07-24T01:35:55.020Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5so005a9ka4oiu49t54","content":"<h4 id=\"创建插件\"><a href=\"#创建插件\" class=\"headerlink\" title=\"创建插件\"></a>创建插件</h4><pre><code>├── hanchang-copyright\n│   └── hanchang-copyright.php\n\n\n\n# hanchang-copyright.php\n&lt;?php\n/*\nPlugin Name: hanchang-copyright\nPlugin URI: http://www.zhuohc.com\nDescription: 在页脚显示一段版权信息\nVersion: 1.0\nAuthor: hanchang\nAuthor URI: http://www.zhuohc.com\nLicense: GPLv2\n*/</code></pre><h4 id=\"插件启用和停用初始化\"><a href=\"#插件启用和停用初始化\" class=\"headerlink\" title=\"插件启用和停用初始化\"></a>插件启用和停用初始化</h4><pre><code># hanchang-copyright.php\n&lt;?php\n/*\nPlugin Name: hanchang-copyright\nPlugin URI: http://www.zhuohc.com\nDescription: 在页脚显示一段版权信息\nVersion: 1.0\nAuthor: hanchang\nAuthor URI: http://www.zhuohc.com\nLicense: GPLv2\n*/\n\n//定义插件启动时候调用的方法\nregister_activation_hook( __FILE__, &apos;hanchang_copyright_install&apos;);\n\nfunction hanchang_copyright_install() {\n\n    //插件启动，添加一个默认的版权信息\n    update_option( &quot;hanchang_copyright_text&quot;, &quot;&lt;p style=&apos;color:red&apos;&gt;本站点所有文章均为原创，转载请注明出处！&lt;/p&gt;&quot; );\n\n}\n\n//定义插件停用时候调用的方法\nregister_deactivation_hook( __FILE__, &apos;hanchang_copyright_deactivation&apos;);\n\nfunction hanchang_copyright_deactivation() {\n\n    //插件停用，设置停用标识为1\n    update_option( &quot;hanchang_copyright_deactivation&quot;, &quot;yes&quot; );\n\n}</code></pre><h4 id=\"删除插件\"><a href=\"#删除插件\" class=\"headerlink\" title=\"删除插件\"></a>删除插件</h4><pre><code>.\n├── hanchang-copyright.php\n└── uninstall.php # 删除插件执行的文件\n\n\n# uninstall.php\n&lt;?\n// 如果 uninstall 不是从 WordPress 调用，则退出\nif( !defined( &apos;WP_UNINSTALL_PLUGIN&apos; ) )\nexit();\n\n//删除插件创建的项目，以确保不占用数据库资源\ndelete_option( &apos;hanchang_copyright_deactivation&apos; );\ndelete_option( &apos;hanchang_copyright_text&apos; );</code></pre><h4 id=\"add-action\"><a href=\"#add-action\" class=\"headerlink\" title=\"add_action\"></a>add_action</h4><pre><code>add_action(&quot;$tag钩子名称&quot;, &quot;$function_to_do执行函数&quot;, $priorrity执行优先级, $accepted_arga带参数函数的参数个数)\n\n\n# hanchang-copyright.php\n\n//为 wp_footer 钩子挂载一个新的动作 hc_copyright_insert\nadd_action( &quot;wp_footer&quot;, &quot;hc_copyright_insert&quot; );\n\nfunction hc_copyright_insert(){\n\n    //输出一段字符串\n    echo get_option( &quot;hc_copyright_text&quot; );\n\n}\n\n\nadd_action( &quot;wp_head&quot;, &quot;hanchang_copyright_insert_new&quot; );\n\nfunction hanchang_copyright_insert_new() {\n    echo &quot;&lt;script&gt;alert(1);&lt;/script&gt;&quot;;\n}\n\nadd_action( &apos;save_post&apos;, &apos;save_post_meta&apos;, 10, 2 );\n\nfunction save_post_meta( $post_id, $post ) {\n\n    update_post_meta( $post_id, &quot;save-time&quot;, &quot;更新时间：&quot; . date(&quot;Y-m-d H:i:s&quot;) );\n\n}</code></pre><h4 id=\"常见钩子\"><a href=\"#常见钩子\" class=\"headerlink\" title=\"常见钩子\"></a>常见钩子</h4><pre><code>init 加载初始化\nwp_head 加载添加到head标签中的内容\nwp_enqueue_scripts 加载css或者js文件\nwp_foot 加载添加到底部内容\n\nsave_post 添加保存文章\nwp_trash_post 将文章添加到回收站\ndelete_post 将文章删除\n\nwp_insert_comment 插入评论\n\nuser_register 用户注册\n\n\n# hanchang-copyright.php\n&lt;?php\n/*\nPlugin Name: hanchang-copyright\nPlugin URI: http://www.zhuohc.com\nDescription: 在页脚显示一段版权信息\nVersion: 1.0\nAuthor: hanchang\nAuthor URI: http://www.zhuohc.com\nLicense: GPLv2\n*/\n\n//定义插件启动时候调用的方法\nregister_activation_hook( __FILE__, &apos;hanchang_copyright_install&apos;);\n\nfunction hanchang_copyright_install() {\n\n    //插件启动，添加一个默认的版权信息\n    update_option( &quot;hanchang_copyright_text&quot;, &quot;&lt;p style=&apos;color:red&apos;&gt;本站点所有文章均为原创，转载请注明出处！&lt;/p&gt;&quot; );\n\n}\n\n//定义插件停用时候调用的方法\nregister_deactivation_hook( __FILE__, &apos;hanchang_copyright_deactivation&apos;);\n\nfunction hanchang_copyright_deactivation() {\n\n    //插件停用，设置停用标识为1\n    update_option( &quot;hanchang_copyright_deactivation&quot;, &quot;yes&quot; );\n\n}\n\n//为 wp_footer 钩子挂载一个新的动作 hc_copyright_insert\nadd_action( &quot;wp_footer&quot;, &quot;hc_copyright_insert&quot; );\n\nfunction hc_copyright_insert(){\n\n    //输出一段字符串\n    echo get_option( &quot;hc_copyright_text&quot; );\n\n}\n\n\nadd_action( &quot;wp_head&quot;, &quot;hanchang_copyright_insert_new&quot; );\n\nfunction hanchang_copyright_insert_new() {\n    echo &quot;&lt;script&gt;alert(1);&lt;/script&gt;&quot;;\n}\n\nadd_action( &apos;save_post&apos;, &apos;save_post_meta&apos;, 10, 2 );\n\nfunction save_post_meta( $post_id, $post ) {\n\n    update_post_meta( $post_id, &quot;save-time&quot;, &quot;更新时间：&quot; . date(&quot;Y-m-d H:i:s&quot;) );\n\n}\n\n\n\n//在输出内容之前，给页面管理添加摘要功能\nadd_action( &apos;init&apos;, &apos;hc_add_excerpts_to_pages&apos; );\n\nfunction hc_add_excerpts_to_pages() {\n\n    //给页面管理添加摘要的功能\n    add_post_type_support( &apos;page&apos;, array( &apos;excerpt&apos; ) );\n}\n\n//wp_head钩子\nadd_action(&apos;wp_head&apos;,&apos;hc_wp_head&apos;);\n\nfunction hc_wp_head() {\n\n    //只有首页输出描述\n    if( is_home() ){ ?&gt;\n        &lt;meta name=&quot;description&quot; content=&quot;&lt;? bloginfo(&apos;description&apos;); ?&gt;&quot; /&gt;\n    &lt;? }\n\n}\n\n\n//自定义引用样式表\nfunction hc_enqueue_style() {\n    wp_enqueue_style( &apos;core&apos;, plugins_url(&apos;css/hc_copyrighy.css&apos;, __FILE__) , false );\n}\n\n//自定义引用脚本文件\nfunction hc_enqueue_script() {\n    wp_enqueue_script( &apos;my-js&apos;, plugins_url(&apos;js/hc_copyrighy.js&apos;, __FILE__), false );\n}\n\n//引用文件的钩子\nadd_action( &apos;wp_enqueue_scripts&apos;, &apos;hc_enqueue_style&apos;, 5 );\nadd_action( &apos;wp_enqueue_scripts&apos;, &apos;hc_enqueue_script&apos;, 7 );\n\n//删除所有挂载在 wp_enqueue_scripts 钩子上的方法\nremove_all_actions( &apos;wp_enqueue_scripts&apos;, 5 );\n\n//评论被添加的时候触发\nadd_action( &apos;wp_insert_comment&apos;, &apos;comment_inserted&apos;, 10, 2 );\n\n//移除 wp_insert_comment 钩子上的 comment_inserted 方法\nremove_action( &apos;wp_insert_comment&apos;, &apos;comment_inserted&apos;, 10 );\n\nfunction comment_inserted($comment_id, $comment_object ) {\n\n    //获取该评论所在文章的评论总数\n    $comments_count = wp_count_comments( $comment_object-&gt;comment_post_ID );\n\n    $commentarr = array();\n    $commentarr[&apos;comment_ID&apos;] = $comment_id;\n\n    //修改评论的内容，在评论内容前加上 “第{$comments_count-&gt;total_comments}个评论：” 这么一段字符串\n    $commentarr[&apos;comment_content&apos;] = &quot;第{$comments_count-&gt;total_comments}个评论：&quot; . $comment_object-&gt;comment_content;\n\n    wp_update_comment( $commentarr );\n\n}\n\n\nadd_action( &apos;user_register&apos;, &apos;myplugin_registration_save&apos;, 10, 1 );\n\nfunction myplugin_registration_save( $user_id ) {\n\n    //将新用户的个人说明，设置为注册时间\n    wp_update_user( array( &apos;ID&apos; =&gt; $user_id, &apos;description&apos; =&gt; &quot;注册时间：&quot; . date(&quot;Y-m-d H:i:s&quot;) ) );\n\n}\n?&gt;</code></pre><h4 id=\"过滤器\"><a href=\"#过滤器\" class=\"headerlink\" title=\"过滤器\"></a>过滤器</h4><pre><code>add_filter($tag过滤器名称, $function_to_add需要添加的函数, $priority优先级, $acceptedargs添加的参数数量)\n\n\n\n# hanchang-copyright.php\n//一开始，我们设置一个变量\n$value = &quot;hello&quot;;\n\n//给名为 hc_filter 的过滤器，挂载一个 hc_filter_fun 方法，传递给 hc_filter 的变量都会经过 hc_filter_fun 方法进行过滤\n//add_filter( &quot;hc_filter&quot;, &quot;hc_filter_fun&quot; );\n\n//给名为 hc_filter 的过滤器，再挂载一个 hc_filter_fun_add_time 方法，传递给 hc_filter 的变量都会经过 hc_filter_fun、hc_filter_fun_add_time 两个方法进行过滤\n//add_filter( &quot;hc_filter&quot;, &quot;hc_filter_fun_add_time&quot; );\n\n//对 $value 值使用名为 hc_filter 的过滤器进行过滤，这个时候，由于 hc_filter 过滤器只挂载了 hc_filter_fun 方法，因此，只使用 hc_filter_fun 方法 过滤了一次，并且返回给 $myvar 变量\n//$myvar = apply_filters( &quot;hc_filter&quot;, $value );\n\nadd_filter( &quot;the_content&quot;, &quot;hc_filter_fun&quot; );\nadd_filter( &quot;the_content&quot;, &quot;hc_filter_fun_add_time&quot; );</code></pre><h4 id=\"带参数的过滤器\"><a href=\"#带参数的过滤器\" class=\"headerlink\" title=\"带参数的过滤器\"></a>带参数的过滤器</h4><pre><code># hanchang-copyright.php\nfunction suppress_if_blurb( $title, $id = null ) {\n\n    if ( in_category(&apos;wpcj&apos;, $id ) ) {\n        return &apos;不显示标题&apos;;\n    }\n\n    return $title . &quot;...&quot;;\n}\n\n//对 the_title 过滤器挂载一个 suppress_if_blurb 方法，优先级为10，传递的参数有2个\nadd_filter( &apos;the_title&apos;, &apos;suppress_if_blurb&apos;, 10, 2 );</code></pre><h4 id=\"常见过滤器\"><a href=\"#常见过滤器\" class=\"headerlink\" title=\"常见过滤器\"></a>常见过滤器</h4><pre><code>the_content 文章内容 \ncontent_save_pre 文章保存前\nthe_title 文章标题\nwp_handle_upload_prefilter 上传文件之前</code></pre><h4 id=\"创建菜单\"><a href=\"#创建菜单\" class=\"headerlink\" title=\"创建菜单\"></a>创建菜单</h4><pre><code>add_menu_page  # 添加菜单\nadd_submenu_page  # 添加子菜单\n\n\n# hanchang-copyright.php\n// admin_menu钩子挂载创建菜单方法\nadd_action( &apos;admin_menu&apos;, &apos;hc_create_menu&apos; );\nfunction hc_create_menu() {\n\n    // 创建顶级菜单\n    add_menu_page(\n        &apos;Hanchang的插件首页&apos;, // 菜单title标题\n        &apos;hanchang-copyright&apos;,  // 菜单名称，显示在后台管理页面侧边栏\n        &apos;manage_options&apos;, // 浏览插件所需要的权限=管理员权限\n        &apos;hanchang_copyright&apos; ,  // 菜单别名，不能与其他插件冲突\n        &apos;hanchang_settings_page&apos;,  // 菜单需要显示的页面，调用的哪个方法\n        plugins_url( &apos;/images/icon.png&apos;, __FILE__ )  // 调用图标\n    );\n\n    // 创建子菜单\n    add_submenu_page(\n        &apos;hanchang_copyright&apos;,  // 父级菜单别名\n        &apos;关于HC的插件&apos;,  // 菜单title标题\n        &apos;关于&apos;,  //  菜单名称，显示在后台管理页面侧边栏\n        &apos;manage_options&apos;,  // 浏览插件所需要的权限=管理员权限\n        &apos;hc_copyright_about&apos;,  // 菜单别名，不能与其他插件冲突\n        &apos;hc_create_submenu_menu&apos;  // 调用方法\n    );\n}\n\nfunction hanchang_settings_page() {\n    ?&gt;\n    &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n    &lt;?\n}\n\nfunction hc_create_submenu_menu() {\n\n    ?&gt;\n    &lt;h2&gt;子菜单&lt;/h2&gt;\n    &lt;?\n}</code></pre><p>#开发 小工具</p>\n<pre><code>#hanchang-copyright.php\n// 使用 widgets_init 动作钩子来执行自定义的函数\nadd_action( &apos;widgets_init&apos;, &apos;hc_register_widgets&apos; );\n\n// 注册小工具\nfunction hc_register_widgets() {\n    register_widget( &apos;hc_widget_info&apos; );\n}\n\n//使用 WP_Widget 类来创建小工具\nclass hc_widget_info extends WP_Widget {\n\n    //构造函数\n    public function __construct() {\n        $widget_ops = array(\n            &apos;classname&apos; =&gt; &apos;hc_widget_info&apos;,\n            &apos;description&apos; =&gt; &apos;显示作者的个人信息&apos;\n        );\n        $this-&gt;WP_Widget( &apos;显示作者个人信息&apos;, &apos;作者的小工具&apos;, $widget_ops );\n    }\n\n    //小工具管理界面\n    public function form( $instance ) {\n\n        $defaults = array( &apos;title&apos; =&gt; &apos;作者的个人信息&apos;, &apos;xingming&apos; =&gt; &apos;作者&apos;, &apos;book&apos; =&gt; &apos;《作者》&apos; );\n        $instance = wp_parse_args( (array) $instance, $defaults );\n\n        $title = $instance[&apos;title&apos;];\n        $xingming = $instance[&apos;xingming&apos;];\n        $book = $instance[&apos;book&apos;];\n        ?&gt;\n        &lt;p&gt;标题: &lt;input class=&quot;widefat&quot; name=&quot;&lt;?php echo $this-&gt;get_field_name( &apos;title&apos; ); ?&gt;&quot; type=&quot;text&quot; value=&quot;&lt;?php echo esc_attr( $title ); ?&gt;&quot; /&gt;&lt;/p&gt;\n        &lt;p&gt;姓名: &lt;input class=&quot;widefat&quot; name=&quot;&lt;?php echo $this-&gt;get_field_name( &apos;xingming&apos; ); ?&gt; &quot;type=&quot;text&quot; value=&quot;&lt;?php echo esc_attr( $xingming ); ?&gt; &quot; /&gt;&lt;/p&gt;\n        &lt;p&gt;著作: &lt;textarea class=&quot;widefat&quot; name=&quot; &lt;?php echo $this-&gt;get_field_name( &apos;book&apos; ); ?&gt; &quot; /&gt;&lt;?php echo esc_attr( $book ); ?&gt;&lt;/textarea&gt; &lt;/p&gt;\n        &lt;?php\n    }\n\n    //保存小工具设置\n    public function update( $new_instance, $old_instance ) {\n\n        $instance = $old_instance;\n\n        $instance[&apos;title&apos;] = strip_tags( trim( $new_instance[&apos;title&apos;] ) );\n        $instance[&apos;xingming&apos;] = strip_tags( trim(  $new_instance[&apos;xingming&apos;] ) );\n        $instance[&apos;book&apos;] = strip_tags( trim( $new_instance[&apos;book&apos;] ) );\n        return $instance;\n    }\n\n    //显示小工具\n    public function widget( $args, $instance ) {\n\n        extract( $args );\n\n        $title = apply_filters( &apos;widget_title&apos;, $instance[&apos;title&apos;] );\n        $xingming = empty( $instance[&apos;xingming&apos;] ) ? &apos; &apos; : $instance[&apos;xingming&apos;];\n        $book = empty( $instance[&apos;book&apos;] ) ? &apos; &apos; : $instance[&apos;book&apos;];\n\n        echo &apos;&lt;p&gt; 标题: &apos; . $title . &apos;&lt;/p&gt;&apos;;\n        echo &apos;&lt;p&gt; 姓名: &apos; . $xingming . &apos;&lt;/p&gt;&apos;;\n        echo &apos;&lt;p&gt; 著作: &apos; . $book . &apos;&lt;/p&gt;&apos;;\n    }\n}</code></pre><h4 id=\"添加元数据框\"><a href=\"#添加元数据框\" class=\"headerlink\" title=\"添加元数据框\"></a>添加元数据框</h4><pre><code># hanchang-copyright.php\n/**\n * 添加一个元数据框到 post 和 page 的管理界面中\n */\nfunction myplugin_add_meta_box() {\n\n    $screens = array( &apos;post&apos;, &apos;page&apos; );\n\n    add_meta_box(\n        &apos;myplugin_sectionid&apos;,  // 元数据框的html代码中的id值\n        &apos;转载自&apos;,  // 元数据框标题\n        &apos;myplugin_meta_box_callback&apos;,  // 回调函数名称，输出元数据框中的内容\n        $screens  // 元数据框需要添加在哪个分类内的（文章或者页面）\n    );\n}\n\n//需要给 add_meta_boxes 钩子，挂载一个自定义的方法\nadd_action( &apos;add_meta_boxes&apos;, &apos;myplugin_add_meta_box&apos; );\n\n/**\n * 元数据框展示代码\n */\nfunction myplugin_meta_box_callback( $post ) {\n\n    // 添加一个验证信息，这个在保存元数据的时候用到\n    wp_nonce_field( &apos;myplugin_save_meta_box_data&apos;, &apos;myplugin_meta_box_nonce&apos; );\n\n    /*\n     * 输出元数据信息\n     */\n    $value = get_post_meta( $post-&gt;ID, &apos;_zzurl&apos;, true );\n\n    echo &apos;&lt;label for=&quot;myplugin_new_field&quot;&gt;&apos;;\n    _e( &apos;本文章转载自：&apos; );\n    echo &apos;&lt;/label&gt; &apos;;\n    echo &apos;&lt;input type=&quot;text&quot; id=&quot;_zzurl&quot; name=&quot;_zzurl&quot; value=&quot;&apos; . esc_attr( $value ) . &apos;&quot; size=&quot;25&quot; /&gt;&apos;;\n}\n\nfunction myplugin_save_meta_box_data( $post_id ) {\n\n    //验证是否为有效信息\n    if ( ! isset( $_POST[&apos;myplugin_meta_box_nonce&apos;] ) ) {\n        return;\n    }\n\n    if ( ! wp_verify_nonce( $_POST[&apos;myplugin_meta_box_nonce&apos;], &apos;myplugin_save_meta_box_data&apos; ) ) {\n        return;\n    }\n\n    if ( defined( &apos;DOING_AUTOSAVE&apos; ) &amp;&amp; DOING_AUTOSAVE ) {\n        return;\n    }\n\n    // Check the user&apos;s permissions.\n    if ( isset( $_POST[&apos;post_type&apos;] ) &amp;&amp; &apos;page&apos; == $_POST[&apos;post_type&apos;] ) {\n\n        if ( ! current_user_can( &apos;edit_page&apos;, $post_id ) ) {\n            return;\n        }\n\n    } else {\n\n        if ( ! current_user_can( &apos;edit_post&apos;, $post_id ) ) {\n            return;\n        }\n    }\n\n    if ( ! isset( $_POST[&apos;_zzurl&apos;] ) ) {\n        return;\n    }\n\n    $my_data = sanitize_text_field( $_POST[&apos;_zzurl&apos;] );\n\n    update_post_meta( $post_id, &apos;_zzurl&apos;, $my_data );\n}\n\n//文章保存的时候，会调用 save_post 钩子，因此我们要借助这个钩子来保存元数据框内的数据\nadd_action( &apos;save_post&apos;, &apos;myplugin_save_meta_box_data&apos; );</code></pre><h4 id=\"后台常见css样式表\"><a href=\"#后台常见css样式表\" class=\"headerlink\" title=\"后台常见css样式表\"></a>后台常见css样式表</h4><pre><code># copyright.php\nfunction hanchang_settings_page() {\n    ?&gt;\n    &lt;div class=&quot;wrap&quot;&gt;\n        &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n        &lt;div id=&quot;message&quot; class=&quot;updated&quot;&gt;设置保存成功&lt;/div&gt;\n        &lt;div id=&quot;message&quot; class=&quot;error&quot;&gt;保存出现错误&lt;/div&gt;\n        &lt;p&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-primary&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-secondary&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-large&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-small&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-hero&quot; /&gt;\n        &lt;/p&gt;\n        &lt;p&gt;\n            &lt;a href=&quot;#&quot;&gt;搜索&lt;/a&gt;\n            &lt;a href=&quot;#&quot; class=&quot;button&quot;&gt;搜索&lt;/a&gt;\n            &lt;a href=&quot;#&quot; class=&quot;button button-primary&quot;&gt;搜索&lt;/a&gt;\n            &lt;a href=&quot;#&quot; class=&quot;button button-secondary&quot;&gt;搜索&lt;/a&gt;\n            &lt;a href=&quot;#&quot; class=&quot;button button-large&quot;&gt;搜索&lt;/a&gt;\n            &lt;a href=&quot;#&quot; class=&quot;button button-small&quot;&gt;搜索&lt;/a&gt;\n            &lt;a href=&quot;#&quot; class=&quot;button button-hero&quot;&gt;搜索&lt;/a&gt;\n        &lt;/p&gt;\n\n        &lt;form method=&quot;POST&quot; action=&quot;&quot;&gt;\n            &lt;table class=&quot;form-table&quot;&gt;\n                &lt;tr valign=&quot;top&quot;&gt;\n                    &lt;th&gt;&lt;label for=&quot;xingming&quot;&gt;姓名：&lt;/label&gt;&lt;/th&gt;\n                    &lt;td&gt;&lt;input id=&quot;xingming&quot; name=&quot;xingming&quot; /&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr valign=&quot;top&quot;&gt;\n                    &lt;th&gt;&lt;label for=&quot;shenfen&quot;&gt;身份：&lt;/label&gt;&lt;/th&gt;\n                    &lt;td&gt;\n                        &lt;select name=&quot;shenfen&quot;&gt;\n                            &lt;option value=&quot;在校&quot;&gt;在校&lt;/option&gt;\n                            &lt;option value=&quot;毕业&quot;&gt;毕业&lt;/option&gt;\n                        &lt;/select&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr valign=&quot;top&quot;&gt;\n                    &lt;th&gt;&lt;label for=&quot;tongyi&quot;&gt;同意注册&lt;/label&gt;&lt;/th&gt;\n                    &lt;td&gt;&lt;input type=&quot;checkbox&quot; name=&quot;tongyi&quot; /&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr valign=&quot;top&quot;&gt;\n                    &lt;th&gt;&lt;label for=&quot;xingbie&quot;&gt;性别&lt;/label&gt;&lt;/th&gt;\n                    &lt;td&gt;\n                        &lt;input type=&quot;radio&quot; name=&quot;xingbie&quot; value=&quot;男&quot; /&gt; 男\n                        &lt;input type=&quot;radio&quot; name=&quot;xingbie&quot; value=&quot;女&quot; /&gt; 女\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr valign=&quot;top&quot;&gt;\n                    &lt;th&gt;&lt;label for=&quot;beizhu&quot;&gt;备注&lt;/label&gt;&lt;/th&gt;\n                    &lt;td&gt;&lt;textarea name=&quot;beizhu&quot;&gt;&lt;/textarea&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr valign=&quot;top&quot;&gt;\n                    &lt;td&gt;\n                        &lt;input type=&quot;submit&quot; name=&quot;save&quot; value=&quot;保存&quot; class=&quot;button-primary&quot; /&gt;\n                        &lt;input type=&quot;submit&quot; name=&quot;reset&quot; value=&quot;重置&quot; class=&quot;button-secondary&quot; /&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n            &lt;/table&gt;\n        &lt;/form&gt;\n\n        &lt;table class=&quot;widefat striped&quot;&gt;\n            &lt;thead&gt;\n            &lt;tr&gt;\n                &lt;th&gt;序号&lt;/th&gt;\n                &lt;th&gt;姓名&lt;/th&gt;\n            &lt;/tr&gt;\n            &lt;/thead&gt;\n            &lt;tbody&gt;\n            &lt;tr&gt;\n                &lt;td&gt;1&lt;/td&gt;\n                &lt;td&gt;黄聪&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td&gt;2&lt;/td&gt;\n                &lt;td&gt;黄聪&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td&gt;3&lt;/td&gt;\n                &lt;td&gt;黄聪&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;/tbody&gt;\n            &lt;tfoot&gt;\n            &lt;tr&gt;\n                &lt;th&gt;序号&lt;/th&gt;\n                &lt;th&gt;姓名&lt;/th&gt;\n            &lt;/tr&gt;\n            &lt;/tfoot&gt;\n        &lt;/table&gt;\n\n        &lt;div class=&quot;tablenav&quot;&gt;\n            &lt;div class=&quot;tablenav-pages&quot;&gt;\n                &lt;span class=&quot;displaying-num&quot;&gt;第1页，共458页&lt;/span&gt;\n                &lt;span class=&quot;page-numbers current&quot;&gt;1&lt;/span&gt;\n                &lt;a href=&quot;#&quot; class=&quot;page-numbers&quot;&gt;2&lt;/a&gt;\n                &lt;a href=&quot;#&quot; class=&quot;page-numbers&quot;&gt;3&lt;/a&gt;\n                &lt;a href=&quot;#&quot; class=&quot;page-numbers&quot;&gt;4&lt;/a&gt;\n                &lt;a href=&quot;#&quot; class=&quot;next page-numbers&quot;&gt;»&lt;/a&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;?\n}</code></pre><h4 id=\"保存插件设置到数据库中\"><a href=\"#保存插件设置到数据库中\" class=\"headerlink\" title=\"保存插件设置到数据库中\"></a>保存插件设置到数据库中</h4><pre><code>├── hc-test\n│   ├── css\n│   ├── hc-test.php\n│   ├── images\n│   └── js\n\n\n\nhc-test.php\n\n&lt;?php\n/*\nPlugin Name: hc-test\nPlugin URI: http://zhuohc.com\nDescription: 测试插件\nVersion: 1.0\nAuthor: hc\nAuthor URI: http://zhuohc.com\nLicense: GPLv2\n*/\n\n//设置时区为 亚洲/上海\ndate_default_timezone_set(&apos;Asia/Shanghai&apos;);\n\n//定义插件启动时候调用的方法\nregister_activation_hook( __FILE__, &apos;hc_test_install&apos;);\n\nfunction hc_test_install() {\n\n   global $wpdb;\n\n   if( $wpdb-&gt;get_var( &quot;SHOW TABLES LIKE &apos;{$wpdb-&gt;prefix}test&apos;&quot; ) != &quot;{$wpdb-&gt;prefix}test&quot; ) \n   {\n      $sql = &quot;CREATE TABLE IF NOT EXISTS `{$wpdb-&gt;prefix}test` (\n           `id` int(11) NOT NULL auto_increment COMMENT &apos;编号&apos;,\n           `color` varchar(10) DEFAULT &apos;&apos; COMMENT &apos;字体颜色&apos;,\n           `size`  varchar(10) DEFAULT &apos;&apos; COMMENT &apos;字体大小&apos;,\n           PRIMARY KEY  (`id`)\n         ) DEFAULT CHARSET=utf8 AUTO_INCREMENT=0;&quot;;\n      $wpdb-&gt;query( $sql );\n\n      $sql = &quot;REPLACE INTO `{$wpdb-&gt;prefix}test` VALUES (1, &apos;#FF0000&apos;,&apos;20&apos;);&quot;;\n      $wpdb-&gt;query( $sql );\n   }\n}\n\nadd_action( &apos;admin_menu&apos;, &apos;hc_test_create_menu&apos; );\n\nfunction hc_test_create_menu() {\n\n   //创建顶级菜单\n   add_menu_page( \n      &apos;HC-TEST&apos;, \n      &apos;HC的插件&apos;,\n      &apos;manage_options&apos;, \n      &apos;hc_test&apos; ,\n      &apos;hc_settings_page&apos;,\n      plugins_url( &apos;/images/icon.png&apos;, __FILE__ )\n   );\n}\n\nfunction hc_settings_page() {\n\n   global $wpdb;\n\n   //当提交了，并且验证信息正确\n   if( !empty( $_POST ) &amp;&amp; check_admin_referer( &apos;hc_test_nonce&apos; ) ) {\n\n      //更新设置\n      update_option( &apos;hc_test_bold&apos;, $_POST[&apos;hc_test_bold&apos;] );\n\n      $wpdb-&gt;update( &quot;{$wpdb-&gt;prefix}test&quot;, array( &apos;color&apos; =&gt; $_POST[&apos;color&apos;], &apos;size&apos; =&gt; $_POST[&apos;size&apos;] ), array( &apos;id&apos; =&gt; 1 ) );\n      ?&gt;\n      &lt;div id=&quot;message&quot; class=&quot;updated&quot;&gt;\n         &lt;p&gt;&lt;strong&gt;保存成功！&lt;/strong&gt;&lt;/p&gt;\n      &lt;/div&gt;\n      &lt;?\n   }\n\n   $sql = &quot;SELECT * FROM `{$wpdb-&gt;prefix}test`&quot;;\n   $row = $wpdb-&gt;get_row( $sql, ARRAY_A );\n\n   $color = $row[&apos;color&apos;];\n   $size = $row[&apos;size&apos;];\n   ?&gt;\n   &lt;div class=&quot;wrap&quot;&gt;\n      &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n      &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;\n         &lt;p&gt;&lt;label for=&quot;color&quot;&gt;字体颜色：&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;color&quot; value=&quot;&lt;?php echo $color; ?&gt;&quot; /&gt;&lt;/p&gt;\n         &lt;p&gt;&lt;label for=&quot;size&quot;&gt;字体大小：&lt;/label&gt;\n         &lt;select name=&quot;size&quot;&gt;\n            &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;\n            &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;\n            &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;\n            &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;\n            &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;\n         &lt;/select&gt;&lt;/p&gt;\n         &lt;p&gt;&lt;label for=&quot;hc_test_obold&quot;&gt;字体加粗：&lt;/label&gt;&lt;input name=&quot;hc_test_bold&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, get_option( &apos;hc_test_bold&apos; ) ); ?&gt; /&gt; 加粗&lt;/p&gt;\n         &lt;p&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;保存设置&quot; /&gt;&lt;/p&gt;\n         &lt;?\n            //输出一个验证信息\n            wp_nonce_field(&apos;hc_test_nonce&apos;);\n         ?&gt;\n      &lt;/form&gt;\n   &lt;/div&gt;\n   &lt;?\n}\n\nadd_action( &apos;wp_head&apos;, &apos;hc_test_head_fun&apos; );\n\nfunction hc_test_head_fun() {\n\n   global $wpdb;\n\n   //获取自定义数据库中的设置\n   $sql = &quot;SELECT * FROM `{$wpdb-&gt;prefix}test`&quot;;\n   $row = $wpdb-&gt;get_row( $sql, ARRAY_A );\n\n   //获取options表中的设置选项\n   $bold = get_option( &quot;hc_test_bold&quot; ) == 1 ? &quot;bold&quot; : &quot;normal&quot;;\n\n   ?&gt;&lt;style&gt;body{color:&lt;? echo $row[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $row[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?\n}</code></pre><h4 id=\"使用wordpress内置api设置插件属性\"><a href=\"#使用wordpress内置api设置插件属性\" class=\"headerlink\" title=\"使用wordpress内置api设置插件属性\"></a>使用wordpress内置api设置插件属性</h4><pre><code># hc-test.php\n&lt;?php\n/*\nPlugin Name: hc-test\nPlugin URI: http://zhuohc.com\nDescription: 测试插件\nVersion: 1.0\nAuthor: hc\nAuthor URI: http://zhuohc.com\nLicense: GPLv2\n*/\n\n//设置时区为 亚洲/上海\ndate_default_timezone_set(&apos;Asia/Shanghai&apos;);\n\nadd_action( &apos;admin_menu&apos;, &apos;test_create_menu&apos; );\n\nfunction test_create_menu() {\n\n   //创建顶级菜单\n   add_menu_page(\n      &apos;HC的插件首页&apos;,\n      &apos;HC的插件&apos;,\n      &apos;manage_options&apos;,\n      &apos;hc_test&apos; ,\n      &apos;hc_settings_page&apos;,\n      plugins_url( &apos;/images/icon.png&apos;, __FILE__ )\n   );\n}\n\nadd_action( &apos;admin_init&apos;, &apos;register_hc_test_setting&apos; );\n\n//使用register_setting()注册要存储的字段\nfunction register_hc_test_setting() {\n\n   //注册一个选项，用于装载所有插件设置项\n   $option_group = &quot;hc_test_group&quot;;\n   register_setting( $option_group, &apos;hc_test_option&apos; );\n\n   //添加选项设置区域\n   $setting_section = &quot;hc_test_setting_section&quot;;\n   add_settings_section(\n      $setting_section,\n      &apos;设置&apos;,  // 标题\n      &apos;hc_test_setting_section_function&apos;,  // 调用方法，自定义输出\n      $option_group\n   );\n\n   //设置字体颜色\n   add_settings_field(\n      &apos;hc_test_color&apos;,  // 字段id\n      &apos;字体颜色&apos;,  // 字段标题\n      &apos;hc_test_color_function&apos;, // 字段对应函数方法\n      $option_group,  // 字段对应分组\n      $setting_section  // 字段对应设置选项\n   );\n\n   //设置字体大小\n   add_settings_field(\n      &apos;hc_test_size&apos;,\n      &apos;字体大小&apos;,\n      &apos;hc_test_size_function&apos;,\n      $option_group,\n      $setting_section\n   );\n\n   //设置字体加粗\n   add_settings_field(\n      &apos;hc_test_bold&apos;,\n      &apos;字体加粗&apos;,\n      &apos;hc_test_bold_function&apos;,\n      $option_group,\n      $setting_section\n   );\n}\n\nfunction hc_test_bold_function() {\n   $hc_test_option = get_option( &quot;hc_test_option&quot; );\n   ?&gt;\n   &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; 加粗\n   &lt;?\n}\n\nfunction hc_test_size_function() {\n   $hc_test_option = get_option( &quot;hc_test_option&quot; );\n   $size = $hc_test_option[&quot;size&quot;];\n   ?&gt;\n   &lt;select name=&quot;hc_test_option[size]&quot;&gt;\n      &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;\n      &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;\n      &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;\n      &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;\n      &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;\n   &lt;/select&gt;\n   &lt;?\n}\n\nfunction hc_test_color_function() {\n   $hc_test_option = get_option( &quot;hc_test_option&quot; );\n   ?&gt;\n   &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;\n   &lt;?\n}\n\nfunction hc_settings_page() {\n   ?&gt;\n   &lt;div class=&quot;wrap&quot;&gt;\n      &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n      &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;\n         &lt;?\n         $option_group = &quot;hc_test_group&quot;;\n\n         //输出一些必要的字段，包括验证信息等\n         settings_fields( $option_group );\n\n         //输出选项设置区域\n         do_settings_sections( $option_group );\n\n         //输出按钮\n         submit_button();\n         ?&gt;\n      &lt;/form&gt;\n   &lt;/div&gt;\n   &lt;?\n}\n\n\nadd_action( &apos;wp_head&apos;, &apos;hc_test_head_fun&apos; );\n\nfunction hc_test_head_fun() {\n\n   $hc_test_option = get_option( &quot;hc_test_option&quot; );\n\n   $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;\n   ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?\n}</code></pre><h4 id=\"将插件改写成类的形式\"><a href=\"#将插件改写成类的形式\" class=\"headerlink\" title=\"将插件改写成类的形式\"></a>将插件改写成类的形式</h4><pre><code>#hc-test.php\n&lt;?php\n/*\nPlugin Name: hc-test\nPlugin URI: http://zhuohc.com\nDescription: 测试插件\nVersion: 1.0\nAuthor: hc\nAuthor URI: http://zhuohc.com\nLicense: GPLv2\n*/\n\n//设置时区为 亚洲/上海\ndate_default_timezone_set(&apos;Asia/Shanghai&apos;);\n\n\nclass hcsem_change_font_style {\n\n   //声明类里面的属性，用 var 开头\n   var $icon_url = &quot;/images/icon.png&quot;;\n   var $option_group = &quot;hc_test_group&quot;;\n\n   //构造方法，创建类的时候调用\n   function hcsem_change_font_style() {\n\n      //创建菜单\n      add_action( &apos;admin_menu&apos;, array( $this, &apos;hc_create_menu&apos; ) );\n      add_action( &apos;admin_init&apos;, array( $this, &apos;register_hc_test_setting&apos; ) );\n      add_action( &apos;wp_head&apos;,  array( $this,  &apos;hc_test_head_fun&apos; ) );\n   }\n\n   //使用register_setting()注册要存储的字段\n   function register_hc_test_setting() {\n\n      //注册一个选项，用于装载所有插件设置项\n      register_setting( $this-&gt;option_group, &apos;hc_test_option&apos; );\n\n      //添加选项设置区域\n      $setting_section = &quot;hc_test_setting_section&quot;;\n      add_settings_section(\n         $setting_section,\n         &apos;&apos;,\n         &apos;&apos;,\n         $this-&gt;option_group\n      );\n\n      //设置字体颜色\n      add_settings_field(\n         &apos;hc_test_color&apos;,\n         &apos;字体颜色&apos;,\n         array( $this, &apos;hc_test_color_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n\n      //设置字体大小\n      add_settings_field(\n         &apos;hc_test_size&apos;,\n         &apos;字体大小&apos;,\n         array( $this, &apos;hc_test_size_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n\n      //设置字体加粗\n      add_settings_field(\n         &apos;hc_test_bold&apos;,\n         &apos;字体加粗&apos;,\n         array( $this, &apos;hc_test_bold_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n   }\n\n   function hc_test_bold_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; 加粗\n      &lt;?\n   }\n\n   function hc_test_size_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      $size = $hc_test_option[&quot;size&quot;];\n      ?&gt;\n      &lt;select name=&quot;hc_test_option[size]&quot;&gt;\n         &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;\n         &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;\n         &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;\n         &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;\n         &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;\n      &lt;/select&gt;\n      &lt;?\n   }\n\n   function hc_test_color_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;\n      &lt;?\n   }\n\n   function hc_create_menu() {\n\n      //创建顶级菜单\n      add_menu_page(\n         &apos;HC的插件首页&apos;,\n         &apos;HC的插件&apos;,\n         &apos;manage_options&apos;,\n         &apos;hc_test&apos; ,\n         array( $this, &apos;hc_settings_page&apos; ),\n         plugins_url( $this-&gt;icon_url, __FILE__ )\n      );\n   }\n\n   function hc_settings_page() {\n      ?&gt;\n      &lt;div class=&quot;wrap&quot;&gt;\n         &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n         &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;\n            &lt;?\n            //输出一些必要的字段，包括验证信息等\n            settings_fields( $this-&gt;option_group );\n\n            //输出选项设置区域\n            do_settings_sections( $this-&gt;option_group );\n\n            //输出按钮\n            submit_button();\n            ?&gt;\n         &lt;/form&gt;\n      &lt;/div&gt;\n      &lt;?\n   }\n\n   function hc_test_head_fun() {\n\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n\n      $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;\n      ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?\n   }\n}\n\nnew hcsem_change_font_style();</code></pre><h4 id=\"将插件设置内容转移到wordpress设置里\"><a href=\"#将插件设置内容转移到wordpress设置里\" class=\"headerlink\" title=\"将插件设置内容转移到wordpress设置里\"></a>将插件设置内容转移到wordpress设置里</h4><pre><code># hc-test.php\n\nclass hcsem_change_font_style {\n\n   var $option_group = &quot;general&quot;;  // general常规 writing撰写 reading阅读 discussion讨论 media多媒体 permalink固定链接\n\n   //构造方法，创建类的时候调用\n   function hcsem_change_font_style() {\n\n      add_action( &apos;admin_init&apos;, array( $this, &apos;register_hc_test_setting&apos; ) );\n      add_action( &apos;wp_head&apos;,  array( $this,  &apos;hc_test_head_fun&apos; ) );\n   }\n\n   //使用register_setting()注册要存储的字段\n   function register_hc_test_setting() {\n\n      //注册一个选项，用于装载所有插件设置项\n      register_setting( $this-&gt;option_group, &apos;hc_test_option&apos; );\n\n      //设置字体颜色\n      add_settings_field(\n         &apos;hc_test_color&apos;,\n         &apos;字体颜色&apos;,\n         array( $this, &apos;hc_test_color_function&apos; ),\n         $this-&gt;option_group\n      );\n\n      //设置字体大小\n      add_settings_field(\n         &apos;hc_test_size&apos;,\n         &apos;字体大小&apos;,\n         array( $this, &apos;hc_test_size_function&apos; ),\n         $this-&gt;option_group\n      );\n\n      //设置字体加粗\n      add_settings_field(\n         &apos;hc_test_bold&apos;,\n         &apos;字体加粗&apos;,\n         array( $this, &apos;hc_test_bold_function&apos; ),\n         $this-&gt;option_group\n      );\n   }\n\n   function hc_test_bold_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; 加粗\n      &lt;?\n   }\n\n   function hc_test_size_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      $size = $hc_test_option[&quot;size&quot;];\n      ?&gt;\n      &lt;select name=&quot;hc_test_option[size]&quot;&gt;\n         &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;\n         &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;\n         &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;\n         &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;\n         &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;\n      &lt;/select&gt;\n      &lt;?\n   }\n\n   function hc_test_color_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;\n      &lt;?\n   }\n\n   function hc_test_head_fun() {\n\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n\n      $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;\n      ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?\n   }\n}\n\nnew hcsem_change_font_style();</code></pre><h4 id=\"调用ajax\"><a href=\"#调用ajax\" class=\"headerlink\" title=\"调用ajax\"></a>调用ajax</h4><pre><code># hc-test.php\n&lt;?php\n/*\nPlugin Name: hc-test\nPlugin URI: http://zhuohc.com\nDescription: 测试插件\nVersion: 1.0\nAuthor: hc\nAuthor URI: http://zhuohc.com\nLicense: GPLv2\n*/\n\n//设置时区为 亚洲/上海\ndate_default_timezone_set(&apos;Asia/Shanghai&apos;);\n\nclass hcsem_change_font_style {\n\n   //声明类里面的属性，用 var 开头\n   var $icon_url = &quot;/images/icon.png&quot;;\n   var $option_group = &quot;hc_test_group&quot;;\n\n   //构造方法，创建类的时候调用\n   function hcsem_change_font_style() {\n\n      //创建菜单\n      add_action( &apos;admin_menu&apos;, array( $this, &apos;hc_create_menu&apos; ) );\n      add_action( &apos;admin_init&apos;, array( $this, &apos;register_hc_test_setting&apos; ) );\n      add_action( &apos;wp_head&apos;,  array( $this,  &apos;hc_test_head_fun&apos; ) );\n\n      //使用ajax校验信息\n      wp_enqueue_script( &apos;hc_test&apos;, plugins_url(&apos;js/hc_test.js&apos;, __FILE__), array(&apos;jquery&apos;) );\n      wp_localize_script( &apos;hc_test&apos;, &apos;ajax_object&apos;, array( &apos;ajax_url&apos; =&gt; admin_url( &apos;admin-ajax.php&apos; ) ) );\n\n      add_action( &apos;wp_ajax_color_check_action&apos; , array( $this, &apos;color_check_action_fun&apos;) );\n      add_action( &apos;wp_ajax_nopriv_hcsem_description&apos; , array( $this, &apos;hcsem_description_fun&apos;) );\n   }\n\n   function color_check_action_fun(){\n\n      if( trim( $_POST[&apos;color&apos;] ) != &quot;&quot; ){ echo &quot;ok&quot;; }\n      wp_die();\n   }\n\n   function hcsem_description_fun() {\n\n      echo &quot;hc的笔记本：&quot; . $_POST[&apos;description&apos;];\n      wp_die();\n\n   }\n\n   //使用register_setting()注册要存储的字段\n   function register_hc_test_setting() {\n\n      //注册一个选项，用于装载所有插件设置项\n      register_setting( $this-&gt;option_group, &apos;hc_test_option&apos; );\n\n      //添加选项设置区域\n      $setting_section = &quot;hc_test_setting_section&quot;;\n      add_settings_section(\n         $setting_section,\n         &apos;&apos;,\n         &apos;&apos;,\n         $this-&gt;option_group\n      );\n\n      //设置字体颜色\n      add_settings_field(\n         &apos;hc_test_color&apos;,\n         &apos;字体颜色&apos;,\n         array( $this, &apos;hc_test_color_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n\n      //设置字体大小\n      add_settings_field(\n         &apos;hc_test_size&apos;,\n         &apos;字体大小&apos;,\n         array( $this, &apos;hc_test_size_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n\n      //设置字体加粗\n      add_settings_field(\n         &apos;hc_test_bold&apos;,\n         &apos;字体加粗&apos;,\n         array( $this, &apos;hc_test_bold_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n   }\n\n   function hc_test_bold_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; 加粗\n      &lt;?\n   }\n\n   function hc_test_size_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      $size = $hc_test_option[&quot;size&quot;];\n      ?&gt;\n      &lt;select name=&quot;hc_test_option[size]&quot;&gt;\n         &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;\n         &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;\n         &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;\n         &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;\n         &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;\n      &lt;/select&gt;\n      &lt;?\n   }\n\n   function hc_test_color_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;\n      &lt;font id=&quot;error_color&quot;&gt;&lt;/font&gt;&lt;/div&gt;\n      &lt;?\n   }\n\n   function hc_create_menu() {\n\n      //创建顶级菜单\n      add_menu_page(\n         &apos;HC的插件首页&apos;,\n         &apos;HC的插件&apos;,\n         &apos;manage_options&apos;,\n         &apos;hc_test&apos; ,\n         array( $this, &apos;hc_settings_page&apos; ),\n         plugins_url( $this-&gt;icon_url, __FILE__ )\n      );\n   }\n\n   function hc_settings_page() {\n      ?&gt;\n      &lt;div class=&quot;wrap&quot;&gt;\n         &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n         &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;\n            &lt;?\n            //输出一些必要的字段，包括验证信息等\n            settings_fields( $this-&gt;option_group );\n\n            //输出选项设置区域\n            do_settings_sections( $this-&gt;option_group );\n\n            //输出按钮\n            submit_button();\n            ?&gt;\n         &lt;/form&gt;\n      &lt;/div&gt;\n      &lt;?\n   }\n\n   function hc_test_head_fun() {\n\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n\n      $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;\n      ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?\n   }\n}\n\nnew hcsem_change_font_style();\n\n\n# js/hc_test.js\njQuery(document).ready( function($) {\n   $(&quot;input[name=&apos;hc_test_option[color]&apos;]&quot;).blur( function() {\n      $.ajax({\n         type: &quot;POST&quot;,\n         data: &quot;color=&quot; + $(this).val() + &quot;&amp;action=hc_color_check&quot;,\n         url: ajax_object.ajax_url,\n         beforeSend: function() {\n            $(&apos;#error_color&apos;).html(&apos;校验中...&apos;); \n         },\n         success: function( $data ) {\n            if( $data == &apos;ok&apos;){\n                $(&apos;#error_color&apos;).html(&apos;输入正确&apos;);  \n            } else {\n                $(&apos;#error_color&apos;).html(&apos;颜色不能为空！&apos;); \n            }\n         }\n      });\n   });\n});\n\n\njQuery(document).ready( function($) {\n   $(&quot;.description&quot;).click( function() {\n      $.ajax({\n         type: &quot;POST&quot;,\n         data: &quot;description=&quot; + $(this).text() + &quot;&amp;action=hcsem_description&quot;,\n         url: ajax_object.ajax_url,\n         success : function( $data ) {\n\n            if( $data != &quot;0&quot; ) {\n               $(&quot;.description&quot;).text( $data );\n            }\n         }\n      });\n   });\n});</code></pre><h4 id=\"实现插件翻译功能\"><a href=\"#实现插件翻译功能\" class=\"headerlink\" title=\"实现插件翻译功能\"></a>实现插件翻译功能</h4><pre><code>.\n├── css\n│   └── hc_copyrighy.css\n├── hc-test.php\n├── images\n│   └── icon.png\n├── js\n│   └── hc_test.js\n└── languages\n    ├── zh_CN.mo\n    └── zh_CN.po\n\n\n\n# hc-test.php\n&lt;?php\n/*\nPlugin Name: hc-test\nPlugin URI: http://zhuohc.com\nDescription: 测试插件\nVersion: 1.0\nAuthor: hc\nAuthor URI: http://zhuohc.com\nLicense: GPLv2\n*/\n\n//设置时区为 亚洲/上海\ndate_default_timezone_set(&apos;Asia/Shanghai&apos;);\n\nclass hcsem_change_font_style {\n\n   //声明类里面的属性，用 var 开头\n   var $icon_url = &quot;/images/icon.png&quot;;\n   var $option_group = &quot;hc_test_group&quot;;\n\n   //构造方法，创建类的时候调用\n   function hcsem_change_font_style() {\n\n      //创建菜单\n      add_action( &apos;admin_menu&apos;, array( $this, &apos;hc_create_menu&apos; ) );\n      add_action( &apos;admin_init&apos;, array( $this, &apos;register_hc_test_setting&apos; ) );\n      add_action( &apos;wp_head&apos;,  array( $this,  &apos;hc_test_head_fun&apos; ) );\n\n      //使用ajax校验信息\n      wp_enqueue_script( &apos;hc_test&apos;, plugins_url(&apos;js/hc_test.js&apos;, __FILE__), array(&apos;jquery&apos;) );\n      wp_localize_script( &apos;hc_test&apos;, &apos;ajax_object&apos;, array( &apos;ajax_url&apos; =&gt; admin_url( &apos;admin-ajax.php&apos; ) ) );\n\n      add_action( &apos;wp_ajax_color_check_action&apos; , array( $this, &apos;color_check_action_fun&apos;) );\n      add_action( &apos;wp_ajax_nopriv_hcsem_description&apos; , array( $this, &apos;hcsem_description_fun&apos;) );\n\n      add_action( &apos;init&apos;, array( $this, &apos;hcsem_load_textdomain&apos; ) );\n   }\n\n   function hcsem_load_textdomain() {\n\n      //加载 languages 目录下的翻译文件 zh_CN\n      $currentLocale = get_locale();\n\n      if( !empty( $currentLocale ) ) {\n\n         $moFile = dirname(__FILE__) . &quot;/languages/{$currentLocale}.mo&quot;;\n\n         if( @file_exists( $moFile ) &amp;&amp; is_readable( $moFile ) ) load_textdomain( &apos;hc-test&apos;, $moFile );\n      }\n   }\n\n   function color_check_action_fun(){\n\n      if( trim( $_POST[&apos;color&apos;] ) != &quot;&quot; ){ echo &quot;ok&quot;; }\n      wp_die();\n   }\n\n   function hcsem_description_fun() {\n\n      echo &quot;HC的笔记本：&quot; . $_POST[&apos;description&apos;];\n      wp_die();\n\n   }\n\n   //使用register_setting()注册要存储的字段\n   function register_hc_test_setting() {\n\n      //注册一个选项，用于装载所有插件设置项\n      register_setting( $this-&gt;option_group, &apos;hc_test_option&apos; );\n\n      //添加选项设置区域\n      $setting_section = &quot;hc_test_setting_section&quot;;\n      add_settings_section(\n         $setting_section,\n         &apos;&apos;,\n         &apos;&apos;,\n         $this-&gt;option_group\n      );\n\n      //设置字体颜色\n      add_settings_field(\n         &apos;hc_test_color&apos;,\n         __( &apos;color&apos;, &apos;hc-test&apos; ),\n         array( $this, &apos;hc_test_color_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n\n      //设置字体大小\n      add_settings_field(\n         &apos;hc_test_size&apos;,\n         __( &apos;size&apos;, &apos;hc-test&apos; ),\n         array( $this, &apos;hc_test_size_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n\n      //设置字体加粗\n      add_settings_field(\n         &apos;hc_test_bold&apos;,\n         __( &apos;bold&apos;, &apos;hc-test&apos; ),\n         array( $this, &apos;hc_test_bold_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n   }\n\n   function hc_test_bold_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; &lt;? _e( &apos;set bold&apos;, &apos;hc-test&apos; ); ?&gt;\n      &lt;?\n   }\n\n   function hc_test_size_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      $size = $hc_test_option[&quot;size&quot;];\n      ?&gt;\n      &lt;select name=&quot;hc_test_option[size]&quot;&gt;\n         &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;\n         &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;\n         &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;\n         &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;\n         &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;\n      &lt;/select&gt;\n      &lt;?\n   }\n\n   function hc_test_color_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;\n      &lt;font id=&quot;error_color&quot;&gt;&lt;/font&gt;&lt;/div&gt;\n      &lt;?\n   }\n\n   function hc_create_menu() {\n\n      //创建顶级菜单\n      add_menu_page(\n         &apos;hc的插件首页&apos;,\n         &apos;hc的插件&apos;,\n         &apos;manage_options&apos;,\n         &apos;hc_test&apos; ,\n         array( $this, &apos;hc_settings_page&apos; ),\n         plugins_url( $this-&gt;icon_url, __FILE__ )\n      );\n   }\n\n   function hc_settings_page() {\n      ?&gt;\n      &lt;div class=&quot;wrap&quot;&gt;\n         &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n         &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;\n            &lt;?\n            //输出一些必要的字段，包括验证信息等\n            settings_fields( $this-&gt;option_group );\n\n            //输出选项设置区域\n            do_settings_sections( $this-&gt;option_group );\n\n            //输出按钮\n            submit_button();\n            ?&gt;\n         &lt;/form&gt;\n      &lt;/div&gt;\n      &lt;?\n   }\n\n   function hc_test_head_fun() {\n\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n\n      $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;\n      ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?\n   }\n}\n\nnew hcsem_change_font_style();</code></pre>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"创建插件\"><a href=\"#创建插件\" class=\"headerlink\" title=\"创建插件\"></a>创建插件</h4><pre><code>├── hanchang-copyright\n│   └── hanchang-copyright.php\n\n\n\n# hanchang-copyright.php\n&lt;?php\n/*\nPlugin Name: hanchang-copyright\nPlugin URI: http://www.zhuohc.com\nDescription: 在页脚显示一段版权信息\nVersion: 1.0\nAuthor: hanchang\nAuthor URI: http://www.zhuohc.com\nLicense: GPLv2\n*/</code></pre><h4 id=\"插件启用和停用初始化\"><a href=\"#插件启用和停用初始化\" class=\"headerlink\" title=\"插件启用和停用初始化\"></a>插件启用和停用初始化</h4><pre><code># hanchang-copyright.php\n&lt;?php\n/*\nPlugin Name: hanchang-copyright\nPlugin URI: http://www.zhuohc.com\nDescription: 在页脚显示一段版权信息\nVersion: 1.0\nAuthor: hanchang\nAuthor URI: http://www.zhuohc.com\nLicense: GPLv2\n*/\n\n//定义插件启动时候调用的方法\nregister_activation_hook( __FILE__, &apos;hanchang_copyright_install&apos;);\n\nfunction hanchang_copyright_install() {\n\n    //插件启动，添加一个默认的版权信息\n    update_option( &quot;hanchang_copyright_text&quot;, &quot;&lt;p style=&apos;color:red&apos;&gt;本站点所有文章均为原创，转载请注明出处！&lt;/p&gt;&quot; );\n\n}\n\n//定义插件停用时候调用的方法\nregister_deactivation_hook( __FILE__, &apos;hanchang_copyright_deactivation&apos;);\n\nfunction hanchang_copyright_deactivation() {\n\n    //插件停用，设置停用标识为1\n    update_option( &quot;hanchang_copyright_deactivation&quot;, &quot;yes&quot; );\n\n}</code></pre><h4 id=\"删除插件\"><a href=\"#删除插件\" class=\"headerlink\" title=\"删除插件\"></a>删除插件</h4><pre><code>.\n├── hanchang-copyright.php\n└── uninstall.php # 删除插件执行的文件\n\n\n# uninstall.php\n&lt;?\n// 如果 uninstall 不是从 WordPress 调用，则退出\nif( !defined( &apos;WP_UNINSTALL_PLUGIN&apos; ) )\nexit();\n\n//删除插件创建的项目，以确保不占用数据库资源\ndelete_option( &apos;hanchang_copyright_deactivation&apos; );\ndelete_option( &apos;hanchang_copyright_text&apos; );</code></pre><h4 id=\"add-action\"><a href=\"#add-action\" class=\"headerlink\" title=\"add_action\"></a>add_action</h4><pre><code>add_action(&quot;$tag钩子名称&quot;, &quot;$function_to_do执行函数&quot;, $priorrity执行优先级, $accepted_arga带参数函数的参数个数)\n\n\n# hanchang-copyright.php\n\n//为 wp_footer 钩子挂载一个新的动作 hc_copyright_insert\nadd_action( &quot;wp_footer&quot;, &quot;hc_copyright_insert&quot; );\n\nfunction hc_copyright_insert(){\n\n    //输出一段字符串\n    echo get_option( &quot;hc_copyright_text&quot; );\n\n}\n\n\nadd_action( &quot;wp_head&quot;, &quot;hanchang_copyright_insert_new&quot; );\n\nfunction hanchang_copyright_insert_new() {\n    echo &quot;&lt;script&gt;alert(1);&lt;/script&gt;&quot;;\n}\n\nadd_action( &apos;save_post&apos;, &apos;save_post_meta&apos;, 10, 2 );\n\nfunction save_post_meta( $post_id, $post ) {\n\n    update_post_meta( $post_id, &quot;save-time&quot;, &quot;更新时间：&quot; . date(&quot;Y-m-d H:i:s&quot;) );\n\n}</code></pre><h4 id=\"常见钩子\"><a href=\"#常见钩子\" class=\"headerlink\" title=\"常见钩子\"></a>常见钩子</h4><pre><code>init 加载初始化\nwp_head 加载添加到head标签中的内容\nwp_enqueue_scripts 加载css或者js文件\nwp_foot 加载添加到底部内容\n\nsave_post 添加保存文章\nwp_trash_post 将文章添加到回收站\ndelete_post 将文章删除\n\nwp_insert_comment 插入评论\n\nuser_register 用户注册\n\n\n# hanchang-copyright.php\n&lt;?php\n/*\nPlugin Name: hanchang-copyright\nPlugin URI: http://www.zhuohc.com\nDescription: 在页脚显示一段版权信息\nVersion: 1.0\nAuthor: hanchang\nAuthor URI: http://www.zhuohc.com\nLicense: GPLv2\n*/\n\n//定义插件启动时候调用的方法\nregister_activation_hook( __FILE__, &apos;hanchang_copyright_install&apos;);\n\nfunction hanchang_copyright_install() {\n\n    //插件启动，添加一个默认的版权信息\n    update_option( &quot;hanchang_copyright_text&quot;, &quot;&lt;p style=&apos;color:red&apos;&gt;本站点所有文章均为原创，转载请注明出处！&lt;/p&gt;&quot; );\n\n}\n\n//定义插件停用时候调用的方法\nregister_deactivation_hook( __FILE__, &apos;hanchang_copyright_deactivation&apos;);\n\nfunction hanchang_copyright_deactivation() {\n\n    //插件停用，设置停用标识为1\n    update_option( &quot;hanchang_copyright_deactivation&quot;, &quot;yes&quot; );\n\n}\n\n//为 wp_footer 钩子挂载一个新的动作 hc_copyright_insert\nadd_action( &quot;wp_footer&quot;, &quot;hc_copyright_insert&quot; );\n\nfunction hc_copyright_insert(){\n\n    //输出一段字符串\n    echo get_option( &quot;hc_copyright_text&quot; );\n\n}\n\n\nadd_action( &quot;wp_head&quot;, &quot;hanchang_copyright_insert_new&quot; );\n\nfunction hanchang_copyright_insert_new() {\n    echo &quot;&lt;script&gt;alert(1);&lt;/script&gt;&quot;;\n}\n\nadd_action( &apos;save_post&apos;, &apos;save_post_meta&apos;, 10, 2 );\n\nfunction save_post_meta( $post_id, $post ) {\n\n    update_post_meta( $post_id, &quot;save-time&quot;, &quot;更新时间：&quot; . date(&quot;Y-m-d H:i:s&quot;) );\n\n}\n\n\n\n//在输出内容之前，给页面管理添加摘要功能\nadd_action( &apos;init&apos;, &apos;hc_add_excerpts_to_pages&apos; );\n\nfunction hc_add_excerpts_to_pages() {\n\n    //给页面管理添加摘要的功能\n    add_post_type_support( &apos;page&apos;, array( &apos;excerpt&apos; ) );\n}\n\n//wp_head钩子\nadd_action(&apos;wp_head&apos;,&apos;hc_wp_head&apos;);\n\nfunction hc_wp_head() {\n\n    //只有首页输出描述\n    if( is_home() ){ ?&gt;\n        &lt;meta name=&quot;description&quot; content=&quot;&lt;? bloginfo(&apos;description&apos;); ?&gt;&quot; /&gt;\n    &lt;? }\n\n}\n\n\n//自定义引用样式表\nfunction hc_enqueue_style() {\n    wp_enqueue_style( &apos;core&apos;, plugins_url(&apos;css/hc_copyrighy.css&apos;, __FILE__) , false );\n}\n\n//自定义引用脚本文件\nfunction hc_enqueue_script() {\n    wp_enqueue_script( &apos;my-js&apos;, plugins_url(&apos;js/hc_copyrighy.js&apos;, __FILE__), false );\n}\n\n//引用文件的钩子\nadd_action( &apos;wp_enqueue_scripts&apos;, &apos;hc_enqueue_style&apos;, 5 );\nadd_action( &apos;wp_enqueue_scripts&apos;, &apos;hc_enqueue_script&apos;, 7 );\n\n//删除所有挂载在 wp_enqueue_scripts 钩子上的方法\nremove_all_actions( &apos;wp_enqueue_scripts&apos;, 5 );\n\n//评论被添加的时候触发\nadd_action( &apos;wp_insert_comment&apos;, &apos;comment_inserted&apos;, 10, 2 );\n\n//移除 wp_insert_comment 钩子上的 comment_inserted 方法\nremove_action( &apos;wp_insert_comment&apos;, &apos;comment_inserted&apos;, 10 );\n\nfunction comment_inserted($comment_id, $comment_object ) {\n\n    //获取该评论所在文章的评论总数\n    $comments_count = wp_count_comments( $comment_object-&gt;comment_post_ID );\n\n    $commentarr = array();\n    $commentarr[&apos;comment_ID&apos;] = $comment_id;\n\n    //修改评论的内容，在评论内容前加上 “第{$comments_count-&gt;total_comments}个评论：” 这么一段字符串\n    $commentarr[&apos;comment_content&apos;] = &quot;第{$comments_count-&gt;total_comments}个评论：&quot; . $comment_object-&gt;comment_content;\n\n    wp_update_comment( $commentarr );\n\n}\n\n\nadd_action( &apos;user_register&apos;, &apos;myplugin_registration_save&apos;, 10, 1 );\n\nfunction myplugin_registration_save( $user_id ) {\n\n    //将新用户的个人说明，设置为注册时间\n    wp_update_user( array( &apos;ID&apos; =&gt; $user_id, &apos;description&apos; =&gt; &quot;注册时间：&quot; . date(&quot;Y-m-d H:i:s&quot;) ) );\n\n}\n?&gt;</code></pre><h4 id=\"过滤器\"><a href=\"#过滤器\" class=\"headerlink\" title=\"过滤器\"></a>过滤器</h4><pre><code>add_filter($tag过滤器名称, $function_to_add需要添加的函数, $priority优先级, $acceptedargs添加的参数数量)\n\n\n\n# hanchang-copyright.php\n//一开始，我们设置一个变量\n$value = &quot;hello&quot;;\n\n//给名为 hc_filter 的过滤器，挂载一个 hc_filter_fun 方法，传递给 hc_filter 的变量都会经过 hc_filter_fun 方法进行过滤\n//add_filter( &quot;hc_filter&quot;, &quot;hc_filter_fun&quot; );\n\n//给名为 hc_filter 的过滤器，再挂载一个 hc_filter_fun_add_time 方法，传递给 hc_filter 的变量都会经过 hc_filter_fun、hc_filter_fun_add_time 两个方法进行过滤\n//add_filter( &quot;hc_filter&quot;, &quot;hc_filter_fun_add_time&quot; );\n\n//对 $value 值使用名为 hc_filter 的过滤器进行过滤，这个时候，由于 hc_filter 过滤器只挂载了 hc_filter_fun 方法，因此，只使用 hc_filter_fun 方法 过滤了一次，并且返回给 $myvar 变量\n//$myvar = apply_filters( &quot;hc_filter&quot;, $value );\n\nadd_filter( &quot;the_content&quot;, &quot;hc_filter_fun&quot; );\nadd_filter( &quot;the_content&quot;, &quot;hc_filter_fun_add_time&quot; );</code></pre><h4 id=\"带参数的过滤器\"><a href=\"#带参数的过滤器\" class=\"headerlink\" title=\"带参数的过滤器\"></a>带参数的过滤器</h4><pre><code># hanchang-copyright.php\nfunction suppress_if_blurb( $title, $id = null ) {\n\n    if ( in_category(&apos;wpcj&apos;, $id ) ) {\n        return &apos;不显示标题&apos;;\n    }\n\n    return $title . &quot;...&quot;;\n}\n\n//对 the_title 过滤器挂载一个 suppress_if_blurb 方法，优先级为10，传递的参数有2个\nadd_filter( &apos;the_title&apos;, &apos;suppress_if_blurb&apos;, 10, 2 );</code></pre><h4 id=\"常见过滤器\"><a href=\"#常见过滤器\" class=\"headerlink\" title=\"常见过滤器\"></a>常见过滤器</h4><pre><code>the_content 文章内容 \ncontent_save_pre 文章保存前\nthe_title 文章标题\nwp_handle_upload_prefilter 上传文件之前</code></pre><h4 id=\"创建菜单\"><a href=\"#创建菜单\" class=\"headerlink\" title=\"创建菜单\"></a>创建菜单</h4><pre><code>add_menu_page  # 添加菜单\nadd_submenu_page  # 添加子菜单\n\n\n# hanchang-copyright.php\n// admin_menu钩子挂载创建菜单方法\nadd_action( &apos;admin_menu&apos;, &apos;hc_create_menu&apos; );\nfunction hc_create_menu() {\n\n    // 创建顶级菜单\n    add_menu_page(\n        &apos;Hanchang的插件首页&apos;, // 菜单title标题\n        &apos;hanchang-copyright&apos;,  // 菜单名称，显示在后台管理页面侧边栏\n        &apos;manage_options&apos;, // 浏览插件所需要的权限=管理员权限\n        &apos;hanchang_copyright&apos; ,  // 菜单别名，不能与其他插件冲突\n        &apos;hanchang_settings_page&apos;,  // 菜单需要显示的页面，调用的哪个方法\n        plugins_url( &apos;/images/icon.png&apos;, __FILE__ )  // 调用图标\n    );\n\n    // 创建子菜单\n    add_submenu_page(\n        &apos;hanchang_copyright&apos;,  // 父级菜单别名\n        &apos;关于HC的插件&apos;,  // 菜单title标题\n        &apos;关于&apos;,  //  菜单名称，显示在后台管理页面侧边栏\n        &apos;manage_options&apos;,  // 浏览插件所需要的权限=管理员权限\n        &apos;hc_copyright_about&apos;,  // 菜单别名，不能与其他插件冲突\n        &apos;hc_create_submenu_menu&apos;  // 调用方法\n    );\n}\n\nfunction hanchang_settings_page() {\n    ?&gt;\n    &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n    &lt;?\n}\n\nfunction hc_create_submenu_menu() {\n\n    ?&gt;\n    &lt;h2&gt;子菜单&lt;/h2&gt;\n    &lt;?\n}</code></pre><p>#开发 小工具</p>\n<pre><code>#hanchang-copyright.php\n// 使用 widgets_init 动作钩子来执行自定义的函数\nadd_action( &apos;widgets_init&apos;, &apos;hc_register_widgets&apos; );\n\n// 注册小工具\nfunction hc_register_widgets() {\n    register_widget( &apos;hc_widget_info&apos; );\n}\n\n//使用 WP_Widget 类来创建小工具\nclass hc_widget_info extends WP_Widget {\n\n    //构造函数\n    public function __construct() {\n        $widget_ops = array(\n            &apos;classname&apos; =&gt; &apos;hc_widget_info&apos;,\n            &apos;description&apos; =&gt; &apos;显示作者的个人信息&apos;\n        );\n        $this-&gt;WP_Widget( &apos;显示作者个人信息&apos;, &apos;作者的小工具&apos;, $widget_ops );\n    }\n\n    //小工具管理界面\n    public function form( $instance ) {\n\n        $defaults = array( &apos;title&apos; =&gt; &apos;作者的个人信息&apos;, &apos;xingming&apos; =&gt; &apos;作者&apos;, &apos;book&apos; =&gt; &apos;《作者》&apos; );\n        $instance = wp_parse_args( (array) $instance, $defaults );\n\n        $title = $instance[&apos;title&apos;];\n        $xingming = $instance[&apos;xingming&apos;];\n        $book = $instance[&apos;book&apos;];\n        ?&gt;\n        &lt;p&gt;标题: &lt;input class=&quot;widefat&quot; name=&quot;&lt;?php echo $this-&gt;get_field_name( &apos;title&apos; ); ?&gt;&quot; type=&quot;text&quot; value=&quot;&lt;?php echo esc_attr( $title ); ?&gt;&quot; /&gt;&lt;/p&gt;\n        &lt;p&gt;姓名: &lt;input class=&quot;widefat&quot; name=&quot;&lt;?php echo $this-&gt;get_field_name( &apos;xingming&apos; ); ?&gt; &quot;type=&quot;text&quot; value=&quot;&lt;?php echo esc_attr( $xingming ); ?&gt; &quot; /&gt;&lt;/p&gt;\n        &lt;p&gt;著作: &lt;textarea class=&quot;widefat&quot; name=&quot; &lt;?php echo $this-&gt;get_field_name( &apos;book&apos; ); ?&gt; &quot; /&gt;&lt;?php echo esc_attr( $book ); ?&gt;&lt;/textarea&gt; &lt;/p&gt;\n        &lt;?php\n    }\n\n    //保存小工具设置\n    public function update( $new_instance, $old_instance ) {\n\n        $instance = $old_instance;\n\n        $instance[&apos;title&apos;] = strip_tags( trim( $new_instance[&apos;title&apos;] ) );\n        $instance[&apos;xingming&apos;] = strip_tags( trim(  $new_instance[&apos;xingming&apos;] ) );\n        $instance[&apos;book&apos;] = strip_tags( trim( $new_instance[&apos;book&apos;] ) );\n        return $instance;\n    }\n\n    //显示小工具\n    public function widget( $args, $instance ) {\n\n        extract( $args );\n\n        $title = apply_filters( &apos;widget_title&apos;, $instance[&apos;title&apos;] );\n        $xingming = empty( $instance[&apos;xingming&apos;] ) ? &apos; &apos; : $instance[&apos;xingming&apos;];\n        $book = empty( $instance[&apos;book&apos;] ) ? &apos; &apos; : $instance[&apos;book&apos;];\n\n        echo &apos;&lt;p&gt; 标题: &apos; . $title . &apos;&lt;/p&gt;&apos;;\n        echo &apos;&lt;p&gt; 姓名: &apos; . $xingming . &apos;&lt;/p&gt;&apos;;\n        echo &apos;&lt;p&gt; 著作: &apos; . $book . &apos;&lt;/p&gt;&apos;;\n    }\n}</code></pre><h4 id=\"添加元数据框\"><a href=\"#添加元数据框\" class=\"headerlink\" title=\"添加元数据框\"></a>添加元数据框</h4><pre><code># hanchang-copyright.php\n/**\n * 添加一个元数据框到 post 和 page 的管理界面中\n */\nfunction myplugin_add_meta_box() {\n\n    $screens = array( &apos;post&apos;, &apos;page&apos; );\n\n    add_meta_box(\n        &apos;myplugin_sectionid&apos;,  // 元数据框的html代码中的id值\n        &apos;转载自&apos;,  // 元数据框标题\n        &apos;myplugin_meta_box_callback&apos;,  // 回调函数名称，输出元数据框中的内容\n        $screens  // 元数据框需要添加在哪个分类内的（文章或者页面）\n    );\n}\n\n//需要给 add_meta_boxes 钩子，挂载一个自定义的方法\nadd_action( &apos;add_meta_boxes&apos;, &apos;myplugin_add_meta_box&apos; );\n\n/**\n * 元数据框展示代码\n */\nfunction myplugin_meta_box_callback( $post ) {\n\n    // 添加一个验证信息，这个在保存元数据的时候用到\n    wp_nonce_field( &apos;myplugin_save_meta_box_data&apos;, &apos;myplugin_meta_box_nonce&apos; );\n\n    /*\n     * 输出元数据信息\n     */\n    $value = get_post_meta( $post-&gt;ID, &apos;_zzurl&apos;, true );\n\n    echo &apos;&lt;label for=&quot;myplugin_new_field&quot;&gt;&apos;;\n    _e( &apos;本文章转载自：&apos; );\n    echo &apos;&lt;/label&gt; &apos;;\n    echo &apos;&lt;input type=&quot;text&quot; id=&quot;_zzurl&quot; name=&quot;_zzurl&quot; value=&quot;&apos; . esc_attr( $value ) . &apos;&quot; size=&quot;25&quot; /&gt;&apos;;\n}\n\nfunction myplugin_save_meta_box_data( $post_id ) {\n\n    //验证是否为有效信息\n    if ( ! isset( $_POST[&apos;myplugin_meta_box_nonce&apos;] ) ) {\n        return;\n    }\n\n    if ( ! wp_verify_nonce( $_POST[&apos;myplugin_meta_box_nonce&apos;], &apos;myplugin_save_meta_box_data&apos; ) ) {\n        return;\n    }\n\n    if ( defined( &apos;DOING_AUTOSAVE&apos; ) &amp;&amp; DOING_AUTOSAVE ) {\n        return;\n    }\n\n    // Check the user&apos;s permissions.\n    if ( isset( $_POST[&apos;post_type&apos;] ) &amp;&amp; &apos;page&apos; == $_POST[&apos;post_type&apos;] ) {\n\n        if ( ! current_user_can( &apos;edit_page&apos;, $post_id ) ) {\n            return;\n        }\n\n    } else {\n\n        if ( ! current_user_can( &apos;edit_post&apos;, $post_id ) ) {\n            return;\n        }\n    }\n\n    if ( ! isset( $_POST[&apos;_zzurl&apos;] ) ) {\n        return;\n    }\n\n    $my_data = sanitize_text_field( $_POST[&apos;_zzurl&apos;] );\n\n    update_post_meta( $post_id, &apos;_zzurl&apos;, $my_data );\n}\n\n//文章保存的时候，会调用 save_post 钩子，因此我们要借助这个钩子来保存元数据框内的数据\nadd_action( &apos;save_post&apos;, &apos;myplugin_save_meta_box_data&apos; );</code></pre><h4 id=\"后台常见css样式表\"><a href=\"#后台常见css样式表\" class=\"headerlink\" title=\"后台常见css样式表\"></a>后台常见css样式表</h4><pre><code># copyright.php\nfunction hanchang_settings_page() {\n    ?&gt;\n    &lt;div class=&quot;wrap&quot;&gt;\n        &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n        &lt;div id=&quot;message&quot; class=&quot;updated&quot;&gt;设置保存成功&lt;/div&gt;\n        &lt;div id=&quot;message&quot; class=&quot;error&quot;&gt;保存出现错误&lt;/div&gt;\n        &lt;p&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-primary&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-secondary&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-large&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-small&quot; /&gt;\n            &lt;input type=&quot;submit&quot; name=&quot;Save&quot; value=&quot;保存设置&quot; class=&quot;button button-hero&quot; /&gt;\n        &lt;/p&gt;\n        &lt;p&gt;\n            &lt;a href=&quot;#&quot;&gt;搜索&lt;/a&gt;\n            &lt;a href=&quot;#&quot; class=&quot;button&quot;&gt;搜索&lt;/a&gt;\n            &lt;a href=&quot;#&quot; class=&quot;button button-primary&quot;&gt;搜索&lt;/a&gt;\n            &lt;a href=&quot;#&quot; class=&quot;button button-secondary&quot;&gt;搜索&lt;/a&gt;\n            &lt;a href=&quot;#&quot; class=&quot;button button-large&quot;&gt;搜索&lt;/a&gt;\n            &lt;a href=&quot;#&quot; class=&quot;button button-small&quot;&gt;搜索&lt;/a&gt;\n            &lt;a href=&quot;#&quot; class=&quot;button button-hero&quot;&gt;搜索&lt;/a&gt;\n        &lt;/p&gt;\n\n        &lt;form method=&quot;POST&quot; action=&quot;&quot;&gt;\n            &lt;table class=&quot;form-table&quot;&gt;\n                &lt;tr valign=&quot;top&quot;&gt;\n                    &lt;th&gt;&lt;label for=&quot;xingming&quot;&gt;姓名：&lt;/label&gt;&lt;/th&gt;\n                    &lt;td&gt;&lt;input id=&quot;xingming&quot; name=&quot;xingming&quot; /&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr valign=&quot;top&quot;&gt;\n                    &lt;th&gt;&lt;label for=&quot;shenfen&quot;&gt;身份：&lt;/label&gt;&lt;/th&gt;\n                    &lt;td&gt;\n                        &lt;select name=&quot;shenfen&quot;&gt;\n                            &lt;option value=&quot;在校&quot;&gt;在校&lt;/option&gt;\n                            &lt;option value=&quot;毕业&quot;&gt;毕业&lt;/option&gt;\n                        &lt;/select&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr valign=&quot;top&quot;&gt;\n                    &lt;th&gt;&lt;label for=&quot;tongyi&quot;&gt;同意注册&lt;/label&gt;&lt;/th&gt;\n                    &lt;td&gt;&lt;input type=&quot;checkbox&quot; name=&quot;tongyi&quot; /&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr valign=&quot;top&quot;&gt;\n                    &lt;th&gt;&lt;label for=&quot;xingbie&quot;&gt;性别&lt;/label&gt;&lt;/th&gt;\n                    &lt;td&gt;\n                        &lt;input type=&quot;radio&quot; name=&quot;xingbie&quot; value=&quot;男&quot; /&gt; 男\n                        &lt;input type=&quot;radio&quot; name=&quot;xingbie&quot; value=&quot;女&quot; /&gt; 女\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr valign=&quot;top&quot;&gt;\n                    &lt;th&gt;&lt;label for=&quot;beizhu&quot;&gt;备注&lt;/label&gt;&lt;/th&gt;\n                    &lt;td&gt;&lt;textarea name=&quot;beizhu&quot;&gt;&lt;/textarea&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr valign=&quot;top&quot;&gt;\n                    &lt;td&gt;\n                        &lt;input type=&quot;submit&quot; name=&quot;save&quot; value=&quot;保存&quot; class=&quot;button-primary&quot; /&gt;\n                        &lt;input type=&quot;submit&quot; name=&quot;reset&quot; value=&quot;重置&quot; class=&quot;button-secondary&quot; /&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n            &lt;/table&gt;\n        &lt;/form&gt;\n\n        &lt;table class=&quot;widefat striped&quot;&gt;\n            &lt;thead&gt;\n            &lt;tr&gt;\n                &lt;th&gt;序号&lt;/th&gt;\n                &lt;th&gt;姓名&lt;/th&gt;\n            &lt;/tr&gt;\n            &lt;/thead&gt;\n            &lt;tbody&gt;\n            &lt;tr&gt;\n                &lt;td&gt;1&lt;/td&gt;\n                &lt;td&gt;黄聪&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td&gt;2&lt;/td&gt;\n                &lt;td&gt;黄聪&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td&gt;3&lt;/td&gt;\n                &lt;td&gt;黄聪&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;/tbody&gt;\n            &lt;tfoot&gt;\n            &lt;tr&gt;\n                &lt;th&gt;序号&lt;/th&gt;\n                &lt;th&gt;姓名&lt;/th&gt;\n            &lt;/tr&gt;\n            &lt;/tfoot&gt;\n        &lt;/table&gt;\n\n        &lt;div class=&quot;tablenav&quot;&gt;\n            &lt;div class=&quot;tablenav-pages&quot;&gt;\n                &lt;span class=&quot;displaying-num&quot;&gt;第1页，共458页&lt;/span&gt;\n                &lt;span class=&quot;page-numbers current&quot;&gt;1&lt;/span&gt;\n                &lt;a href=&quot;#&quot; class=&quot;page-numbers&quot;&gt;2&lt;/a&gt;\n                &lt;a href=&quot;#&quot; class=&quot;page-numbers&quot;&gt;3&lt;/a&gt;\n                &lt;a href=&quot;#&quot; class=&quot;page-numbers&quot;&gt;4&lt;/a&gt;\n                &lt;a href=&quot;#&quot; class=&quot;next page-numbers&quot;&gt;»&lt;/a&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;?\n}</code></pre><h4 id=\"保存插件设置到数据库中\"><a href=\"#保存插件设置到数据库中\" class=\"headerlink\" title=\"保存插件设置到数据库中\"></a>保存插件设置到数据库中</h4><pre><code>├── hc-test\n│   ├── css\n│   ├── hc-test.php\n│   ├── images\n│   └── js\n\n\n\nhc-test.php\n\n&lt;?php\n/*\nPlugin Name: hc-test\nPlugin URI: http://zhuohc.com\nDescription: 测试插件\nVersion: 1.0\nAuthor: hc\nAuthor URI: http://zhuohc.com\nLicense: GPLv2\n*/\n\n//设置时区为 亚洲/上海\ndate_default_timezone_set(&apos;Asia/Shanghai&apos;);\n\n//定义插件启动时候调用的方法\nregister_activation_hook( __FILE__, &apos;hc_test_install&apos;);\n\nfunction hc_test_install() {\n\n   global $wpdb;\n\n   if( $wpdb-&gt;get_var( &quot;SHOW TABLES LIKE &apos;{$wpdb-&gt;prefix}test&apos;&quot; ) != &quot;{$wpdb-&gt;prefix}test&quot; ) \n   {\n      $sql = &quot;CREATE TABLE IF NOT EXISTS `{$wpdb-&gt;prefix}test` (\n           `id` int(11) NOT NULL auto_increment COMMENT &apos;编号&apos;,\n           `color` varchar(10) DEFAULT &apos;&apos; COMMENT &apos;字体颜色&apos;,\n           `size`  varchar(10) DEFAULT &apos;&apos; COMMENT &apos;字体大小&apos;,\n           PRIMARY KEY  (`id`)\n         ) DEFAULT CHARSET=utf8 AUTO_INCREMENT=0;&quot;;\n      $wpdb-&gt;query( $sql );\n\n      $sql = &quot;REPLACE INTO `{$wpdb-&gt;prefix}test` VALUES (1, &apos;#FF0000&apos;,&apos;20&apos;);&quot;;\n      $wpdb-&gt;query( $sql );\n   }\n}\n\nadd_action( &apos;admin_menu&apos;, &apos;hc_test_create_menu&apos; );\n\nfunction hc_test_create_menu() {\n\n   //创建顶级菜单\n   add_menu_page( \n      &apos;HC-TEST&apos;, \n      &apos;HC的插件&apos;,\n      &apos;manage_options&apos;, \n      &apos;hc_test&apos; ,\n      &apos;hc_settings_page&apos;,\n      plugins_url( &apos;/images/icon.png&apos;, __FILE__ )\n   );\n}\n\nfunction hc_settings_page() {\n\n   global $wpdb;\n\n   //当提交了，并且验证信息正确\n   if( !empty( $_POST ) &amp;&amp; check_admin_referer( &apos;hc_test_nonce&apos; ) ) {\n\n      //更新设置\n      update_option( &apos;hc_test_bold&apos;, $_POST[&apos;hc_test_bold&apos;] );\n\n      $wpdb-&gt;update( &quot;{$wpdb-&gt;prefix}test&quot;, array( &apos;color&apos; =&gt; $_POST[&apos;color&apos;], &apos;size&apos; =&gt; $_POST[&apos;size&apos;] ), array( &apos;id&apos; =&gt; 1 ) );\n      ?&gt;\n      &lt;div id=&quot;message&quot; class=&quot;updated&quot;&gt;\n         &lt;p&gt;&lt;strong&gt;保存成功！&lt;/strong&gt;&lt;/p&gt;\n      &lt;/div&gt;\n      &lt;?\n   }\n\n   $sql = &quot;SELECT * FROM `{$wpdb-&gt;prefix}test`&quot;;\n   $row = $wpdb-&gt;get_row( $sql, ARRAY_A );\n\n   $color = $row[&apos;color&apos;];\n   $size = $row[&apos;size&apos;];\n   ?&gt;\n   &lt;div class=&quot;wrap&quot;&gt;\n      &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n      &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;\n         &lt;p&gt;&lt;label for=&quot;color&quot;&gt;字体颜色：&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;color&quot; value=&quot;&lt;?php echo $color; ?&gt;&quot; /&gt;&lt;/p&gt;\n         &lt;p&gt;&lt;label for=&quot;size&quot;&gt;字体大小：&lt;/label&gt;\n         &lt;select name=&quot;size&quot;&gt;\n            &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;\n            &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;\n            &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;\n            &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;\n            &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;\n         &lt;/select&gt;&lt;/p&gt;\n         &lt;p&gt;&lt;label for=&quot;hc_test_obold&quot;&gt;字体加粗：&lt;/label&gt;&lt;input name=&quot;hc_test_bold&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, get_option( &apos;hc_test_bold&apos; ) ); ?&gt; /&gt; 加粗&lt;/p&gt;\n         &lt;p&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;保存设置&quot; /&gt;&lt;/p&gt;\n         &lt;?\n            //输出一个验证信息\n            wp_nonce_field(&apos;hc_test_nonce&apos;);\n         ?&gt;\n      &lt;/form&gt;\n   &lt;/div&gt;\n   &lt;?\n}\n\nadd_action( &apos;wp_head&apos;, &apos;hc_test_head_fun&apos; );\n\nfunction hc_test_head_fun() {\n\n   global $wpdb;\n\n   //获取自定义数据库中的设置\n   $sql = &quot;SELECT * FROM `{$wpdb-&gt;prefix}test`&quot;;\n   $row = $wpdb-&gt;get_row( $sql, ARRAY_A );\n\n   //获取options表中的设置选项\n   $bold = get_option( &quot;hc_test_bold&quot; ) == 1 ? &quot;bold&quot; : &quot;normal&quot;;\n\n   ?&gt;&lt;style&gt;body{color:&lt;? echo $row[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $row[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?\n}</code></pre><h4 id=\"使用wordpress内置api设置插件属性\"><a href=\"#使用wordpress内置api设置插件属性\" class=\"headerlink\" title=\"使用wordpress内置api设置插件属性\"></a>使用wordpress内置api设置插件属性</h4><pre><code># hc-test.php\n&lt;?php\n/*\nPlugin Name: hc-test\nPlugin URI: http://zhuohc.com\nDescription: 测试插件\nVersion: 1.0\nAuthor: hc\nAuthor URI: http://zhuohc.com\nLicense: GPLv2\n*/\n\n//设置时区为 亚洲/上海\ndate_default_timezone_set(&apos;Asia/Shanghai&apos;);\n\nadd_action( &apos;admin_menu&apos;, &apos;test_create_menu&apos; );\n\nfunction test_create_menu() {\n\n   //创建顶级菜单\n   add_menu_page(\n      &apos;HC的插件首页&apos;,\n      &apos;HC的插件&apos;,\n      &apos;manage_options&apos;,\n      &apos;hc_test&apos; ,\n      &apos;hc_settings_page&apos;,\n      plugins_url( &apos;/images/icon.png&apos;, __FILE__ )\n   );\n}\n\nadd_action( &apos;admin_init&apos;, &apos;register_hc_test_setting&apos; );\n\n//使用register_setting()注册要存储的字段\nfunction register_hc_test_setting() {\n\n   //注册一个选项，用于装载所有插件设置项\n   $option_group = &quot;hc_test_group&quot;;\n   register_setting( $option_group, &apos;hc_test_option&apos; );\n\n   //添加选项设置区域\n   $setting_section = &quot;hc_test_setting_section&quot;;\n   add_settings_section(\n      $setting_section,\n      &apos;设置&apos;,  // 标题\n      &apos;hc_test_setting_section_function&apos;,  // 调用方法，自定义输出\n      $option_group\n   );\n\n   //设置字体颜色\n   add_settings_field(\n      &apos;hc_test_color&apos;,  // 字段id\n      &apos;字体颜色&apos;,  // 字段标题\n      &apos;hc_test_color_function&apos;, // 字段对应函数方法\n      $option_group,  // 字段对应分组\n      $setting_section  // 字段对应设置选项\n   );\n\n   //设置字体大小\n   add_settings_field(\n      &apos;hc_test_size&apos;,\n      &apos;字体大小&apos;,\n      &apos;hc_test_size_function&apos;,\n      $option_group,\n      $setting_section\n   );\n\n   //设置字体加粗\n   add_settings_field(\n      &apos;hc_test_bold&apos;,\n      &apos;字体加粗&apos;,\n      &apos;hc_test_bold_function&apos;,\n      $option_group,\n      $setting_section\n   );\n}\n\nfunction hc_test_bold_function() {\n   $hc_test_option = get_option( &quot;hc_test_option&quot; );\n   ?&gt;\n   &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; 加粗\n   &lt;?\n}\n\nfunction hc_test_size_function() {\n   $hc_test_option = get_option( &quot;hc_test_option&quot; );\n   $size = $hc_test_option[&quot;size&quot;];\n   ?&gt;\n   &lt;select name=&quot;hc_test_option[size]&quot;&gt;\n      &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;\n      &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;\n      &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;\n      &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;\n      &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;\n   &lt;/select&gt;\n   &lt;?\n}\n\nfunction hc_test_color_function() {\n   $hc_test_option = get_option( &quot;hc_test_option&quot; );\n   ?&gt;\n   &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;\n   &lt;?\n}\n\nfunction hc_settings_page() {\n   ?&gt;\n   &lt;div class=&quot;wrap&quot;&gt;\n      &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n      &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;\n         &lt;?\n         $option_group = &quot;hc_test_group&quot;;\n\n         //输出一些必要的字段，包括验证信息等\n         settings_fields( $option_group );\n\n         //输出选项设置区域\n         do_settings_sections( $option_group );\n\n         //输出按钮\n         submit_button();\n         ?&gt;\n      &lt;/form&gt;\n   &lt;/div&gt;\n   &lt;?\n}\n\n\nadd_action( &apos;wp_head&apos;, &apos;hc_test_head_fun&apos; );\n\nfunction hc_test_head_fun() {\n\n   $hc_test_option = get_option( &quot;hc_test_option&quot; );\n\n   $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;\n   ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?\n}</code></pre><h4 id=\"将插件改写成类的形式\"><a href=\"#将插件改写成类的形式\" class=\"headerlink\" title=\"将插件改写成类的形式\"></a>将插件改写成类的形式</h4><pre><code>#hc-test.php\n&lt;?php\n/*\nPlugin Name: hc-test\nPlugin URI: http://zhuohc.com\nDescription: 测试插件\nVersion: 1.0\nAuthor: hc\nAuthor URI: http://zhuohc.com\nLicense: GPLv2\n*/\n\n//设置时区为 亚洲/上海\ndate_default_timezone_set(&apos;Asia/Shanghai&apos;);\n\n\nclass hcsem_change_font_style {\n\n   //声明类里面的属性，用 var 开头\n   var $icon_url = &quot;/images/icon.png&quot;;\n   var $option_group = &quot;hc_test_group&quot;;\n\n   //构造方法，创建类的时候调用\n   function hcsem_change_font_style() {\n\n      //创建菜单\n      add_action( &apos;admin_menu&apos;, array( $this, &apos;hc_create_menu&apos; ) );\n      add_action( &apos;admin_init&apos;, array( $this, &apos;register_hc_test_setting&apos; ) );\n      add_action( &apos;wp_head&apos;,  array( $this,  &apos;hc_test_head_fun&apos; ) );\n   }\n\n   //使用register_setting()注册要存储的字段\n   function register_hc_test_setting() {\n\n      //注册一个选项，用于装载所有插件设置项\n      register_setting( $this-&gt;option_group, &apos;hc_test_option&apos; );\n\n      //添加选项设置区域\n      $setting_section = &quot;hc_test_setting_section&quot;;\n      add_settings_section(\n         $setting_section,\n         &apos;&apos;,\n         &apos;&apos;,\n         $this-&gt;option_group\n      );\n\n      //设置字体颜色\n      add_settings_field(\n         &apos;hc_test_color&apos;,\n         &apos;字体颜色&apos;,\n         array( $this, &apos;hc_test_color_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n\n      //设置字体大小\n      add_settings_field(\n         &apos;hc_test_size&apos;,\n         &apos;字体大小&apos;,\n         array( $this, &apos;hc_test_size_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n\n      //设置字体加粗\n      add_settings_field(\n         &apos;hc_test_bold&apos;,\n         &apos;字体加粗&apos;,\n         array( $this, &apos;hc_test_bold_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n   }\n\n   function hc_test_bold_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; 加粗\n      &lt;?\n   }\n\n   function hc_test_size_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      $size = $hc_test_option[&quot;size&quot;];\n      ?&gt;\n      &lt;select name=&quot;hc_test_option[size]&quot;&gt;\n         &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;\n         &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;\n         &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;\n         &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;\n         &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;\n      &lt;/select&gt;\n      &lt;?\n   }\n\n   function hc_test_color_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;\n      &lt;?\n   }\n\n   function hc_create_menu() {\n\n      //创建顶级菜单\n      add_menu_page(\n         &apos;HC的插件首页&apos;,\n         &apos;HC的插件&apos;,\n         &apos;manage_options&apos;,\n         &apos;hc_test&apos; ,\n         array( $this, &apos;hc_settings_page&apos; ),\n         plugins_url( $this-&gt;icon_url, __FILE__ )\n      );\n   }\n\n   function hc_settings_page() {\n      ?&gt;\n      &lt;div class=&quot;wrap&quot;&gt;\n         &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n         &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;\n            &lt;?\n            //输出一些必要的字段，包括验证信息等\n            settings_fields( $this-&gt;option_group );\n\n            //输出选项设置区域\n            do_settings_sections( $this-&gt;option_group );\n\n            //输出按钮\n            submit_button();\n            ?&gt;\n         &lt;/form&gt;\n      &lt;/div&gt;\n      &lt;?\n   }\n\n   function hc_test_head_fun() {\n\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n\n      $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;\n      ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?\n   }\n}\n\nnew hcsem_change_font_style();</code></pre><h4 id=\"将插件设置内容转移到wordpress设置里\"><a href=\"#将插件设置内容转移到wordpress设置里\" class=\"headerlink\" title=\"将插件设置内容转移到wordpress设置里\"></a>将插件设置内容转移到wordpress设置里</h4><pre><code># hc-test.php\n\nclass hcsem_change_font_style {\n\n   var $option_group = &quot;general&quot;;  // general常规 writing撰写 reading阅读 discussion讨论 media多媒体 permalink固定链接\n\n   //构造方法，创建类的时候调用\n   function hcsem_change_font_style() {\n\n      add_action( &apos;admin_init&apos;, array( $this, &apos;register_hc_test_setting&apos; ) );\n      add_action( &apos;wp_head&apos;,  array( $this,  &apos;hc_test_head_fun&apos; ) );\n   }\n\n   //使用register_setting()注册要存储的字段\n   function register_hc_test_setting() {\n\n      //注册一个选项，用于装载所有插件设置项\n      register_setting( $this-&gt;option_group, &apos;hc_test_option&apos; );\n\n      //设置字体颜色\n      add_settings_field(\n         &apos;hc_test_color&apos;,\n         &apos;字体颜色&apos;,\n         array( $this, &apos;hc_test_color_function&apos; ),\n         $this-&gt;option_group\n      );\n\n      //设置字体大小\n      add_settings_field(\n         &apos;hc_test_size&apos;,\n         &apos;字体大小&apos;,\n         array( $this, &apos;hc_test_size_function&apos; ),\n         $this-&gt;option_group\n      );\n\n      //设置字体加粗\n      add_settings_field(\n         &apos;hc_test_bold&apos;,\n         &apos;字体加粗&apos;,\n         array( $this, &apos;hc_test_bold_function&apos; ),\n         $this-&gt;option_group\n      );\n   }\n\n   function hc_test_bold_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; 加粗\n      &lt;?\n   }\n\n   function hc_test_size_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      $size = $hc_test_option[&quot;size&quot;];\n      ?&gt;\n      &lt;select name=&quot;hc_test_option[size]&quot;&gt;\n         &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;\n         &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;\n         &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;\n         &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;\n         &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;\n      &lt;/select&gt;\n      &lt;?\n   }\n\n   function hc_test_color_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;\n      &lt;?\n   }\n\n   function hc_test_head_fun() {\n\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n\n      $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;\n      ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?\n   }\n}\n\nnew hcsem_change_font_style();</code></pre><h4 id=\"调用ajax\"><a href=\"#调用ajax\" class=\"headerlink\" title=\"调用ajax\"></a>调用ajax</h4><pre><code># hc-test.php\n&lt;?php\n/*\nPlugin Name: hc-test\nPlugin URI: http://zhuohc.com\nDescription: 测试插件\nVersion: 1.0\nAuthor: hc\nAuthor URI: http://zhuohc.com\nLicense: GPLv2\n*/\n\n//设置时区为 亚洲/上海\ndate_default_timezone_set(&apos;Asia/Shanghai&apos;);\n\nclass hcsem_change_font_style {\n\n   //声明类里面的属性，用 var 开头\n   var $icon_url = &quot;/images/icon.png&quot;;\n   var $option_group = &quot;hc_test_group&quot;;\n\n   //构造方法，创建类的时候调用\n   function hcsem_change_font_style() {\n\n      //创建菜单\n      add_action( &apos;admin_menu&apos;, array( $this, &apos;hc_create_menu&apos; ) );\n      add_action( &apos;admin_init&apos;, array( $this, &apos;register_hc_test_setting&apos; ) );\n      add_action( &apos;wp_head&apos;,  array( $this,  &apos;hc_test_head_fun&apos; ) );\n\n      //使用ajax校验信息\n      wp_enqueue_script( &apos;hc_test&apos;, plugins_url(&apos;js/hc_test.js&apos;, __FILE__), array(&apos;jquery&apos;) );\n      wp_localize_script( &apos;hc_test&apos;, &apos;ajax_object&apos;, array( &apos;ajax_url&apos; =&gt; admin_url( &apos;admin-ajax.php&apos; ) ) );\n\n      add_action( &apos;wp_ajax_color_check_action&apos; , array( $this, &apos;color_check_action_fun&apos;) );\n      add_action( &apos;wp_ajax_nopriv_hcsem_description&apos; , array( $this, &apos;hcsem_description_fun&apos;) );\n   }\n\n   function color_check_action_fun(){\n\n      if( trim( $_POST[&apos;color&apos;] ) != &quot;&quot; ){ echo &quot;ok&quot;; }\n      wp_die();\n   }\n\n   function hcsem_description_fun() {\n\n      echo &quot;hc的笔记本：&quot; . $_POST[&apos;description&apos;];\n      wp_die();\n\n   }\n\n   //使用register_setting()注册要存储的字段\n   function register_hc_test_setting() {\n\n      //注册一个选项，用于装载所有插件设置项\n      register_setting( $this-&gt;option_group, &apos;hc_test_option&apos; );\n\n      //添加选项设置区域\n      $setting_section = &quot;hc_test_setting_section&quot;;\n      add_settings_section(\n         $setting_section,\n         &apos;&apos;,\n         &apos;&apos;,\n         $this-&gt;option_group\n      );\n\n      //设置字体颜色\n      add_settings_field(\n         &apos;hc_test_color&apos;,\n         &apos;字体颜色&apos;,\n         array( $this, &apos;hc_test_color_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n\n      //设置字体大小\n      add_settings_field(\n         &apos;hc_test_size&apos;,\n         &apos;字体大小&apos;,\n         array( $this, &apos;hc_test_size_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n\n      //设置字体加粗\n      add_settings_field(\n         &apos;hc_test_bold&apos;,\n         &apos;字体加粗&apos;,\n         array( $this, &apos;hc_test_bold_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n   }\n\n   function hc_test_bold_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; 加粗\n      &lt;?\n   }\n\n   function hc_test_size_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      $size = $hc_test_option[&quot;size&quot;];\n      ?&gt;\n      &lt;select name=&quot;hc_test_option[size]&quot;&gt;\n         &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;\n         &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;\n         &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;\n         &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;\n         &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;\n      &lt;/select&gt;\n      &lt;?\n   }\n\n   function hc_test_color_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;\n      &lt;font id=&quot;error_color&quot;&gt;&lt;/font&gt;&lt;/div&gt;\n      &lt;?\n   }\n\n   function hc_create_menu() {\n\n      //创建顶级菜单\n      add_menu_page(\n         &apos;HC的插件首页&apos;,\n         &apos;HC的插件&apos;,\n         &apos;manage_options&apos;,\n         &apos;hc_test&apos; ,\n         array( $this, &apos;hc_settings_page&apos; ),\n         plugins_url( $this-&gt;icon_url, __FILE__ )\n      );\n   }\n\n   function hc_settings_page() {\n      ?&gt;\n      &lt;div class=&quot;wrap&quot;&gt;\n         &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n         &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;\n            &lt;?\n            //输出一些必要的字段，包括验证信息等\n            settings_fields( $this-&gt;option_group );\n\n            //输出选项设置区域\n            do_settings_sections( $this-&gt;option_group );\n\n            //输出按钮\n            submit_button();\n            ?&gt;\n         &lt;/form&gt;\n      &lt;/div&gt;\n      &lt;?\n   }\n\n   function hc_test_head_fun() {\n\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n\n      $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;\n      ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?\n   }\n}\n\nnew hcsem_change_font_style();\n\n\n# js/hc_test.js\njQuery(document).ready( function($) {\n   $(&quot;input[name=&apos;hc_test_option[color]&apos;]&quot;).blur( function() {\n      $.ajax({\n         type: &quot;POST&quot;,\n         data: &quot;color=&quot; + $(this).val() + &quot;&amp;action=hc_color_check&quot;,\n         url: ajax_object.ajax_url,\n         beforeSend: function() {\n            $(&apos;#error_color&apos;).html(&apos;校验中...&apos;); \n         },\n         success: function( $data ) {\n            if( $data == &apos;ok&apos;){\n                $(&apos;#error_color&apos;).html(&apos;输入正确&apos;);  \n            } else {\n                $(&apos;#error_color&apos;).html(&apos;颜色不能为空！&apos;); \n            }\n         }\n      });\n   });\n});\n\n\njQuery(document).ready( function($) {\n   $(&quot;.description&quot;).click( function() {\n      $.ajax({\n         type: &quot;POST&quot;,\n         data: &quot;description=&quot; + $(this).text() + &quot;&amp;action=hcsem_description&quot;,\n         url: ajax_object.ajax_url,\n         success : function( $data ) {\n\n            if( $data != &quot;0&quot; ) {\n               $(&quot;.description&quot;).text( $data );\n            }\n         }\n      });\n   });\n});</code></pre><h4 id=\"实现插件翻译功能\"><a href=\"#实现插件翻译功能\" class=\"headerlink\" title=\"实现插件翻译功能\"></a>实现插件翻译功能</h4><pre><code>.\n├── css\n│   └── hc_copyrighy.css\n├── hc-test.php\n├── images\n│   └── icon.png\n├── js\n│   └── hc_test.js\n└── languages\n    ├── zh_CN.mo\n    └── zh_CN.po\n\n\n\n# hc-test.php\n&lt;?php\n/*\nPlugin Name: hc-test\nPlugin URI: http://zhuohc.com\nDescription: 测试插件\nVersion: 1.0\nAuthor: hc\nAuthor URI: http://zhuohc.com\nLicense: GPLv2\n*/\n\n//设置时区为 亚洲/上海\ndate_default_timezone_set(&apos;Asia/Shanghai&apos;);\n\nclass hcsem_change_font_style {\n\n   //声明类里面的属性，用 var 开头\n   var $icon_url = &quot;/images/icon.png&quot;;\n   var $option_group = &quot;hc_test_group&quot;;\n\n   //构造方法，创建类的时候调用\n   function hcsem_change_font_style() {\n\n      //创建菜单\n      add_action( &apos;admin_menu&apos;, array( $this, &apos;hc_create_menu&apos; ) );\n      add_action( &apos;admin_init&apos;, array( $this, &apos;register_hc_test_setting&apos; ) );\n      add_action( &apos;wp_head&apos;,  array( $this,  &apos;hc_test_head_fun&apos; ) );\n\n      //使用ajax校验信息\n      wp_enqueue_script( &apos;hc_test&apos;, plugins_url(&apos;js/hc_test.js&apos;, __FILE__), array(&apos;jquery&apos;) );\n      wp_localize_script( &apos;hc_test&apos;, &apos;ajax_object&apos;, array( &apos;ajax_url&apos; =&gt; admin_url( &apos;admin-ajax.php&apos; ) ) );\n\n      add_action( &apos;wp_ajax_color_check_action&apos; , array( $this, &apos;color_check_action_fun&apos;) );\n      add_action( &apos;wp_ajax_nopriv_hcsem_description&apos; , array( $this, &apos;hcsem_description_fun&apos;) );\n\n      add_action( &apos;init&apos;, array( $this, &apos;hcsem_load_textdomain&apos; ) );\n   }\n\n   function hcsem_load_textdomain() {\n\n      //加载 languages 目录下的翻译文件 zh_CN\n      $currentLocale = get_locale();\n\n      if( !empty( $currentLocale ) ) {\n\n         $moFile = dirname(__FILE__) . &quot;/languages/{$currentLocale}.mo&quot;;\n\n         if( @file_exists( $moFile ) &amp;&amp; is_readable( $moFile ) ) load_textdomain( &apos;hc-test&apos;, $moFile );\n      }\n   }\n\n   function color_check_action_fun(){\n\n      if( trim( $_POST[&apos;color&apos;] ) != &quot;&quot; ){ echo &quot;ok&quot;; }\n      wp_die();\n   }\n\n   function hcsem_description_fun() {\n\n      echo &quot;HC的笔记本：&quot; . $_POST[&apos;description&apos;];\n      wp_die();\n\n   }\n\n   //使用register_setting()注册要存储的字段\n   function register_hc_test_setting() {\n\n      //注册一个选项，用于装载所有插件设置项\n      register_setting( $this-&gt;option_group, &apos;hc_test_option&apos; );\n\n      //添加选项设置区域\n      $setting_section = &quot;hc_test_setting_section&quot;;\n      add_settings_section(\n         $setting_section,\n         &apos;&apos;,\n         &apos;&apos;,\n         $this-&gt;option_group\n      );\n\n      //设置字体颜色\n      add_settings_field(\n         &apos;hc_test_color&apos;,\n         __( &apos;color&apos;, &apos;hc-test&apos; ),\n         array( $this, &apos;hc_test_color_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n\n      //设置字体大小\n      add_settings_field(\n         &apos;hc_test_size&apos;,\n         __( &apos;size&apos;, &apos;hc-test&apos; ),\n         array( $this, &apos;hc_test_size_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n\n      //设置字体加粗\n      add_settings_field(\n         &apos;hc_test_bold&apos;,\n         __( &apos;bold&apos;, &apos;hc-test&apos; ),\n         array( $this, &apos;hc_test_bold_function&apos; ),\n         $this-&gt;option_group,\n         $setting_section\n      );\n   }\n\n   function hc_test_bold_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&quot;hc_test_option[bold]&quot; type=&quot;checkbox&quot;  value=&quot;1&quot; &lt;? checked( 1, $hc_test_option[&quot;bold&quot;] ); ?&gt; /&gt; &lt;? _e( &apos;set bold&apos;, &apos;hc-test&apos; ); ?&gt;\n      &lt;?\n   }\n\n   function hc_test_size_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      $size = $hc_test_option[&quot;size&quot;];\n      ?&gt;\n      &lt;select name=&quot;hc_test_option[size]&quot;&gt;\n         &lt;option value=&quot;12&quot; &lt;? selected( &apos;12&apos;, $size ); ?&gt;&gt;12&lt;/option&gt;\n         &lt;option value=&quot;14&quot; &lt;? selected( &apos;14&apos;, $size ); ?&gt;&gt;14&lt;/option&gt;\n         &lt;option value=&quot;16&quot; &lt;? selected( &apos;16&apos;, $size ); ?&gt;&gt;16&lt;/option&gt;\n         &lt;option value=&quot;18&quot; &lt;? selected( &apos;18&apos;, $size ); ?&gt;&gt;18&lt;/option&gt;\n         &lt;option value=&quot;20&quot; &lt;? selected( &apos;20&apos;, $size ); ?&gt;&gt;20&lt;/option&gt;\n      &lt;/select&gt;\n      &lt;?\n   }\n\n   function hc_test_color_function() {\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n      ?&gt;\n      &lt;input name=&apos;hc_test_option[color]&apos; type=&apos;text&apos; value=&apos;&lt;? echo $hc_test_option[&quot;color&quot;]; ?&gt;&apos; /&gt;\n      &lt;font id=&quot;error_color&quot;&gt;&lt;/font&gt;&lt;/div&gt;\n      &lt;?\n   }\n\n   function hc_create_menu() {\n\n      //创建顶级菜单\n      add_menu_page(\n         &apos;hc的插件首页&apos;,\n         &apos;hc的插件&apos;,\n         &apos;manage_options&apos;,\n         &apos;hc_test&apos; ,\n         array( $this, &apos;hc_settings_page&apos; ),\n         plugins_url( $this-&gt;icon_url, __FILE__ )\n      );\n   }\n\n   function hc_settings_page() {\n      ?&gt;\n      &lt;div class=&quot;wrap&quot;&gt;\n         &lt;h2&gt;插件顶级菜单&lt;/h2&gt;\n         &lt;form action=&quot;options.php&quot; method=&quot;post&quot;&gt;\n            &lt;?\n            //输出一些必要的字段，包括验证信息等\n            settings_fields( $this-&gt;option_group );\n\n            //输出选项设置区域\n            do_settings_sections( $this-&gt;option_group );\n\n            //输出按钮\n            submit_button();\n            ?&gt;\n         &lt;/form&gt;\n      &lt;/div&gt;\n      &lt;?\n   }\n\n   function hc_test_head_fun() {\n\n      $hc_test_option = get_option( &quot;hc_test_option&quot; );\n\n      $bold = $hc_test_option[&quot;bold&quot;] == 1 ? &quot;bold&quot; : &quot;normal&quot;;\n      ?&gt;&lt;style&gt;body{color:&lt;? echo $hc_test_option[&quot;color&quot;] ?&gt;;font-size:&lt;? echo $hc_test_option[&quot;size&quot;] ?&gt;px;font-weight:&lt;? echo $bold; ?&gt;;}&lt;/style&gt;&lt;?\n   }\n}\n\nnew hcsem_change_font_style();</code></pre>"},{"title":"javascript入门基础","url":"86.html","id":"86","comments":0,"date":"2016-11-10T02:19:51.000Z","_content":"\n### 数据类型\n\n> object(包含Function，Array，Date等)  \n> number  \n> string  \n> boolean  \n> null  \n> undefined\n\n### 类型检测\n\ntypeof 基本类型，function， null可以用===判断\n\n    typeof 100           // \"number\"   \n    typeof true          // \"boolean\"    \n    typeof function      // \"function\"    \n    typeof undefined     // \"undefined\"  \n    typeof new Object()  // \"object\"  \n    typeof [1, 2]        // \"object\"  \n    typeof NaN           // \"number\"  \n    typeof null          // \"object\"  \n    \n\ninstanceof\n\n    // 不同window或iframe下返回false\n    [1, 2] instanceof Array === true  \n    new Object instanceof Array === fasle\n    \n\nObject.prototype.toString\n\n    Object.prototype.toString.apply([1, 2, 3]) === \"[object Array]\";  \n    Object.prototype.toString.apply(function(){}) === \"[object Function]\"  \n    Object.prototype.toString.apply(null) === \"[object Null]\"  // ie678返回[object Object]  \n    Object.prototype.toString.apply(undefined) === \"[object Undefined]\"  \n    Object.prototype.toString.apply(12313) === \"[object Number]\"  \n    Object.prototype.toString.apply('12313') === \"[object String]\"\n    \n\nconstructor  \nduck type\n\n### 表达式\n\n表达式是一种js短语，可使js解释器用来产生一个值\n\n    // 原始表达式\n    3.14, \"test\"      // 常量，直接量\n    null, this, true  // 关键字\n    i, j, k;           // 变量\n    \n    // 复合表达式\n    10 * 20;           // 原始表达式+运算符+原始表达式\n    \n    // 初始化表达式\n    [1, 2];\n    [1,,2];\n    {x: 1, y: 2};\n    \n    // 函数表达式\n    var fe = function(){};\n    (function(){console.log('1111');}){};\n    \n    // 属性访问表达式\n    var o = {x:1};\n    o.x;\n    o['x'];\n    \n    // 调用表达式\n    func();\n    \n    // 对象创建表达式\n    new Func(1, 2);\n    new Object;\n    \n\n### 运算符\n\n> 一元（+num）  \n> 二元（a + b）  \n> 三元（c：a：b） 赋值(x += 1)  \n> 比较(a == b)  \n> 算术（a - b）  \n> 位 （a | b）  \n> 逻辑 (exp1 && exp2)  \n> 字符串(\"a\" + \"b\")  \n> 特殊\n\n### 特殊运算符\n\n> c? a:b  \n> var val = (1, 2, 3) // 逗号运算符  \n> delete obj.x // 删除对象属性  \n> 'x' in window; // in 运算符  \n> instanceof, typeof // 判断类型  \n> new Foo(); // new 运算符  \n> this // this运算符  \n> void 0 // undefined\n\n### 语句\n\n块语句block  \n块语句是没有作用域的\n\n    {  \n    var str = 'hi';  \n    console.log(str);  \n    }  \n    \n\n声明语句 var  \nvar a=1, b=1; 函数语句function\n\n    // 函数声明语句  \n    function fd() {  \n        return true;  \n    }    \n    // 函数表达式  \n    var fe = function() {\n        //do sth\n    };\n    \n\nfor in 语句\n\n    var p;  \n    var obj = {x:1, y:2};  \n    for(p in obj) {\n        // 顺序不确定  \n    }\n    \n    \n\nswith语句\n\n    var val = 2;\n    switch (val) {\n        case 1:\n            console.log(1);\n            break;\n        case 2:\n            console.log(2);\n            break;\n        case 3:\n            console.log(3);\n            break;\n        default:\n            console.log(0);\n            break;\n    }\n    \n\n循环语句\n\n    while (isTrue) {\n        // do sth\n    }\n    \n    do {\n        // do sth\n    } while (isTrue)\n    \n    var i;\n    for (i = 0; i < n; i++) {\n        // do sth\n    }\n    \n\nwith语句 // 不使用 try catch语句\n\n    try {\n        try {\n            throw new Error('oops');\n        } catch(ex) {\n            console.error('inner catch', ex.message);\n            throw ex;\n        } finally {\n            console.log('inner  finally');\n        }\n    } catch(ex) {\n        console.error('outer catch', ex.message);\n    } finally {\n        console.log('outer finally');\n    }\n    \n\n结果 内部catch>内部finally>外部catch>外部finally\n\n    inner catch oops  \n    inner  finally  \n    outer catch oops  \n    outer finally  \n    \n\n### 严格模式(待补充）\n\n    function func() {\n        'use strict';\n    }\n    \n\n### 对象\n\n对象创建  \n字面量创建\n\n    var obj = {x: 1};\n    console.log(obj);\n    console.log(obj.y);\n    Object.prototype.y = 2;\n    console.log(obj);\n    console.log(obj.y);\n    obj.y = undefined;\n    console.log(obj);\n    console.log(obj.y);\n    \n\n    { x: 1 }\n    undefined\n    { x: 1 }\n    2\n    { x: 1, y: undefined }\n    undefined\n    \n\nnew构造器创建\n\n    function foo() { this.color = 'red';}\n    foo.prototype.background = '#000';\n    var redColor = new foo();\n    console.log(redColor);\n    console.log(typeof redColor.toString);\n    console.log(redColor.color);\n    console.log(redColor.background);\n    console.log(foo);\n    console.log(foo.prototype);\n    console.log(foo.prototype.prototype);\n    console.log('background' in redColor);\n    redColor.background = '#FFF';\n    console.log(redColor.background);\n    console.log(foo.prototype.background);\n    \n\n    foo { color: 'red' }\n    function\n    red\n    #000\n    [Function: foo]\n    foo { background: '#000' }\n    undefined\n    true\n    #FFF\n    #000\n    \n\nObject.create()创建\n\n    function obj() {\n        this.x = 1;\n    }\n    console.log(obj);\n    var obj1 = new obj();\n    console.log(obj1);\n    var obj2 = Object.create(obj);\n    console.log(obj2);\n    console.log(obj2.x);\n    var obj3 = Object.create(obj1);\n    console.log(obj3);\n    console.log(obj3.x);;\n    \n\n    [Function: obj]\n    obj { x: 1 }\n    Function {}\n    undefined\n    obj {}\n    1\n    \n\n### 对象的内部原型(**proto**)和构造器的原型（prototype）的关系。\n\n一、所有构造器/函数的**proto**都指向Function.prototype，它是一个空函数（Empty function）\n\n    Number.__proto__ === Function.prototype  // true  \n    Boolean.__proto__ === Function.prototype // true  \n    String.__proto__ === Function.prototype  // true  \n    Object.__proto__ === Function.prototype  // true  \n    Function.__proto__ === Function.prototype // true  \n    Array.__proto__ === Function.prototype   // true  \n    RegExp.__proto__ === Function.prototype  // true  \n    Error.__proto__ === Function.prototype   // true  \n    Date.__proto__ === Function.prototype    // true  \n    Math.__proto__ === Object.prototype  // true  \n    JSON.__proto__ === Object.prototype  // true \n    // 函数声明\n    function Person() {}\n    // 函数表达式\n    var Man = function() {}\n    console.log(Person.__proto__ === Function.prototype) // true  \n    console.log(Man.__proto__ === Function.prototype)    // true  \n    \n\n所有的构造器都来自于Function.prototype，甚至包括根构造器Object及Function自身。所有构造器都继承了Function.prototype的属性及方法。如length、call、apply、bind（ES5）\n\n    console.log(typeof Function.prototype) // function\n    console.log(typeof Object.prototype)   // object\n    console.log(typeof Number.prototype)   // object\n    console.log(typeof Boolean.prototype)  // object\n    console.log(typeof String.prototype)   // object\n    console.log(typeof Array.prototype)    // object\n    console.log(typeof RegExp.prototype)   // object\n    console.log(typeof Error.prototype)    // object\n    console.log(typeof Date.prototype)     // object\n    console.log(typeof Object.prototype)   // object  \n    console.log(Function.prototype.__proto__ === Object.prototype) // true    \n    Object.prototype.__proto__ === null  // true  \n    \n\n二、所有对象的**proto**都指向其构造器的prototype  \nJavaScript引擎内置构造器\n\n    var obj = {name: 'jack'}\n    var arr = [1,2,3]\n    var reg = /hello/g\n    var date = new Date\n    var err = new Error('exception')\n    \n    console.log(obj.__proto__ === Object.prototype) // true\n    console.log(arr.__proto__ === Array.prototype)  // true\n    console.log(reg.__proto__ === RegExp.prototype) // true\n    console.log(date.__proto__ === Date.prototype)  // true\n    console.log(err.__proto__ === Error.prototype)  // true\n    \n\n自定义的构造器\n\n    function Person(name) {\n        this.name = name\n    }\n    var p = new Person('jack')\n    console.log(p.__proto__ === Person.prototype) // true\n    \n\n每个对象都有一个constructor属性，可以获取它的构造器\n\n    function Person(name) {\n        this.name = name\n    }\n    var p = new Person('jack')\n    console.log(p.__proto__ === p.constructor.prototype) // true\n    \n\n### 对象属性操作\n\n属性读写\n\n    // 属性读写\n    var obj = {x1: 1, x2: 2};\n    var i = 1, n = 2;\n    for(; i<= n; i++) {\n        console.log(obj['x' + i]);\n    }\n    // 输出1，2\n    \n    var p;\n    for(p in obj) {\n        console.log(obj[p]);\n    }\n    // 输出1，2\n    \n    var obj = {x: 1};\n    // 读写异常\n    console.log(obj.y); // undefined\n    var yz = obj.y.z;  // TypeError: Cannot read property 'z' of undefined\n    obj.y.z = 2;      //TypeError: Cannot set property 'z' of undefined\n    // 正确方式\n    var yz;\n    if(obj.y) {\n        yz = obj.y.z;\n    }\n    // 或者\n    var yz = obj && obj.y && obj.y.z  // 这个会返回undefined\n    \n\n属性删除\n\n    var person = {age: 28, title: 'fe'};\n    console.log(delete person.age);  // true\n    console.log(delete person['age']);  // true\n    console.log(person.age);  // undefined\n    console.log(delete person.age);   // 注意这个也返回true 判断操作结束后该属性是否存在\n    \n    // 有些属性是不能删除的\n    console.log(delete Object.prototype);  // false\n    \n    // 原因\n    var descriptor = Object.getOwnPropertyDescriptor(Object, 'prototype');\n    console.log(descriptor.configurable);  // false\n    \n    // 变量及函数不可删除\n    var globalVal = 1;\n    console.log(delete globalVal);  // false\n    \n    (function() {\n        var localVal = 1;\n        console.log(delete localVal);\n    }());  // false\n    \n    function fd() {}\n    console.log(delete fd);  // false\n    \n    (function() {\n        function fd() {};\n        console.log(delete fd);\n    }());  // false\n    \n    \n    // 隐示定义的变量可以\n    ohNo = 1;\n    console.log(delete ohNo);  // true\n    \n\n对象属性检测\n\n    var cat = new Object();\n    cat.legs = 4;\n    cat.name = 'Kitty';\n    \n    console.log('legs' in cat);  // true\n    console.log('abc' in cat);  // false\n    console.log('toString' in cat);  // true 继承属性\n    \n    console.log(cat.hasOwnProperty('legs'));  // true\n    console.log(cat.hasOwnProperty('toString'));  // false\n    \n    console.log(cat.propertyIsEnumerable('legs'));  // true\n    console.log(cat.propertyIsEnumerable('toString'));  // false\n    \n    \n    Object.defineProperty(cat, 'price', {enumerable: false, value: 1000});\n    // defineProperty是Object的方法，默认的标签enumerable值为false\n    // Object.x创建属性，默认的标签值为true\n    console.log(cat.propertyIsEnumerable('price'));  // false\n    console.log(cat.hasOwnProperty('price'));  // true\n    \n    \n    // 判断属性是否存在\n    if(cat && cat.legs) {\n        cat.legs *= 2;\n    }\n    \n    if(cat.legs != undefined) {\n        // !== undefined 或者 !== null\n    }\n    if(cat.legs !== undefined) {\n        // !== undefined\n    }\n    \n\n对象属性枚举\n\n    var o = {x: 1, y: 2, z: 3};\n    console.log('toString' in o);  // true\n    o.propertyIsEnumerable('toString');  // false\n    \n    var key;\n    console.log(o.x);  // 1\n    console.log(o.y);  // 2\n    console.log(o.z);  // 3\n    for(key in o) {\n        console.log(key);  // x, y, z\n        console.log(o.key);  // undefined\n        console.log(o[key]);  // 1, 2, 3\n    }\n    \n    \n    var obj = Object.create(o);\n    obj.a = 4;\n    var key;\n    for(key in obj) {\n        console.log(key); // a, x, y, z\n    }\n    var key1;\n    for (key1 in obj) {\n        if(obj.hasOwnProperty(key1)) {\n            console.log(key1); // a\n        }\n    }\n    \n\n对象属性的get/set方法\n\n    // 对象属性的get/set方法\n    var man = {\n        name: 'Bug',\n        weibo: 'Bug',\n        get age() {\n            return new Date().getFullYear() - 1988;\n        },\n        set age(val) {\n            console.log('cannot be set ' + val);\n        },\n    };\n    \n    console.log(man.age);  // 调用age的get方法27\n    man.age = 100;  // 调用age的set方法 cannot be set 100\n    console.log(man.age);  // 27\n    \n    \n    var man = {\n        weibo: 'Bug',\n        $age: null,\n        get age() {\n            if(this.$age == undefined) {\n                return new Date().getFullYear() - 1988;\n            } else {\n                return this.$age;\n            }\n        },\n        set age(val) {\n            val = +val; // 转为数字\n            if(!isNaN(val) && val > 0 && val < 150) {\n                this.$age = + val;\n            } else {\n                throw new Error('Incorrect val = ' + val );\n            }\n        }\n    }\n    \n    console.log(man.age);  // 27\n    man.age = 100;\n    console.log(man.age);  // 100\n    //man.age = 'abc';  // Error: Incorrect val = NaN\n    \n    \n    // get/set方法与原型链\n    \n    // 这是错误的定义对象属性get方法方式\n    function foo1() {}\n    foo1.prototype.z = {\n        get: function() {\n            return 2;\n        }\n    };\n    var obj = new foo1();\n    console.log(obj.z);  // 这个会被认为是对象 { get: [Function] }\n    obj.z = 200;\n    console.log(obj.z);  // 200\n    \n    // 正确定义方法\n    function foo() {}\n    Object.defineProperty(foo.prototype, 'z', {\n        get: function() {\n            return 1;\n        },\n        // configurable: true,  // 开启此属于也不会被改变\n        // writable: true,  // 此项不能配置writable/value get/set 二选一\n     });\n    var obj = new foo();\n    console.log(obj.z);   // 1\n    obj.z = 100;\n    console.log(obj.z);  // 但是还是1 并没有被改变\n    \n    Object.defineProperty(obj, 'z', {\n        value: 100,\n        configurable: true\n    });\n    console.log(obj.z);  // 100\n    delete obj.z;\n    console.log(obj.z);  // 返回到1\n    \n    // 另外一个例子\n    var o = {};\n    Object.defineProperty(o, 'x', {\n        value: 1\n    });  // 默认writable: false, configurable: false\n    var obj = Object.create(o);\n    console.log(obj.x);  // 1\n    obj.x = 100;\n    console.log(obj.x);  // 还是1\n    \n    \n    Object.defineProperty(obj, 'x', {\n        writable: true,\n        configurable: true,\n        value: 100\n    });\n    console.log(obj.x);  // 100\n    obj.x = 200;\n    console.log(obj.x); // 200\n    \n\n### 对象属性标签\n\n    person = {};\n    Object.defineProperty(person, 'type', {\n        configurable: false,\n        writable: true,\n        enumerable: false,\n        value: 'Object',\n    });\n    \n    console.log(Object.keys(person));   // [] 返回空数组，不能枚举\n    console.log(Object.getOwnPropertyDescriptor(person, 'type'));   // { value: 'Object', writable: true, enumerable: false, configurable: false }\n    \n    \n    // writable为true，可以通过赋值方法修改value值 [通过赋值修改属性值只和writable标签有关，和configurable无关]\n    person.type = 'Object2';\n    console.log(Object.getOwnPropertyDescriptor(person, 'type'));  // { value: 'Object2', writable: true, enumerable: false, configurable: false }\n    \n    \n    // configurable: false 无法使用delete删除属性， 无法使用get/set方法，  无法重新配置属性标签（除了将writable从true修改为false）\n    console.log(delete person.type);   // 返回false\n    \n    \n    // 只有writable和configurable标签都为false时，不能修改value标签值，其他情况都可以修改value标签值\n    Object.defineProperty(person, 'type', {\n        configurable: false,\n        writable: true,\n        enumerable: false,\n        value: 'Object1',\n    });\n    console.log(Object.getOwnPropertyDescriptor(person, 'type'));   // { value: 'Object1', writable: true, enumerable: false, configurable: false }\n    \n    \n    // 可以重新配置writable标签值(只能重true改为false)\n    Object.defineProperty(person, 'type', {\n        writable: false,\n    });\n    console.log(Object.getOwnPropertyDescriptor(person, 'type'));   // { value: 'Object1', writable: false, enumerable: false, configurable: false }\n    \n    \n    // 无法将writable从false改为true\n    Object.defineProperty(person, 'type', {\n        writable: true,\n    });\n    console.log(Object.getOwnPropertyDescriptor(person, 'type'));   // TypeError: Cannot redefine property: type\n    \n    \n    // 无法重新配置enumerable，configurable属性\n    Object.defineProperty(person, 'type', {\n        enumerable: true,\n    });\n    console.log(Object.getOwnPropertyDescriptor(person, 'type'));   // TypeError: Cannot redefine property: type\n    \n\n### 对象标签\n\n原型标签**proto**\n\n    // 原型标签__proto__\n    \n    function Person(name) {\n        this.name = name;\n    }\n    var p = new Person('jack');\n    console.log(p.__proto__ === Person.prototype);  // true\n    \n\n类型标签\n\n    //  对象class标签，表示对象是哪个类型，没有直接的方法去修改或者获取\n    var toString = Object.prototype.toString;\n    \n    console.log(toString.call(null));  // [object Null]\n    console.log(toString.call(undefined));  // [object Undefined]\n    console.log(toString.call(1));  // [object Number]\n    console.log(toString.call(new Number(1)));  // [object Number]\n    console.log(toString.call(true));  // [object Boolean]\n    console.log(toString.call(new Boolean(true)));  // [object Boolean]\n    \n\n可扩展标签\n\n    // extensible 可扩展标签，表示是否可以继续添加对象属性\n    var obj = {x: 1, y: 2};\n    console.log(Object.isExtensible(obj));  // true 对象可扩展\n    Object.preventExtensions(obj);  // 配置对象不可扩展\n    console.log(Object.isExtensible(obj));  // false 对象不可扩展\n    obj.z =1;\n    console.log(obj.z);  // undefined 添加属性失败\n    console.log(Object.getOwnPropertyDescriptor(obj, 'x'));  // // { value: 1, writable: true, enumerable: true, configurable: true }\n    \n    \n    // Object.seal方法，对象的所有属性configurable值为false\n    Object.seal(obj);\n    console.log(Object.getOwnPropertyDescriptor(obj, 'x'));  // { value: 1, writable: true, enumerable: true, configurable: false }\n    console.log(Object.isSealed(obj)); // true\n    \n    \n    // Object.freeze方法，对象的所有属性configurable，writable标签值为false\n    Object.freeze(obj);\n    console.log(Object.getOwnPropertyDescriptor(obj, 'x'));   // // { value: 1, writable: false, enumerable: true, configurable: false }\n    console.log(Object.isFrozen(obj));  // true\n    \n\n### JS对象与json格式转换\n\n    // 将js对象转为json格式JSON.stringify()\n    var obj = {x: 1, y: true, z: [1, 2, 3], nullVal: null};\n    console.log(JSON.stringify(obj));  // {\"x\":1,\"y\":true,\"z\":[1,2,3],\"nullVal\":null}\n    \n    // undefined,NaN,Infinity等特殊属性值\n    var obj = {val: undefined, a: NaN, b: Infinity, c: new Date()};\n    console.log(JSON.stringify(obj));  // {\"a\":null,\"b\":null,\"c\":\"2015-12-19T12:30:40.456Z\"}\n    \n    // 将json格式转为js对象JSON.parse\n    var obj = JSON.parse('{\"x\": 1}');\n    console.log(obj.x);  // 1\n    \n    //toJSON方法\n    var obj = {\n        x: 1,\n        y: 2,\n        o: {\n            o1: 1,\n            o2: 2,\n            toJSON: function() {\n                return this.o1 + this.o2;\n            }\n        },\n    };\n    console.log(JSON.stringify(obj));  // {\"x\":1,\"y\":2,\"o\":3}\n    \n\n###toString valueOf方法\n\n    // 对象在作为操作数时，解释器总是优先调用valueOf()--(Date类型的对象在二元“+”运算时例外),而其他情况，解释器总是认为我们想要的是字符串，所以会优先调用toString()。\n    var obj = {x: 1, y: 2};\n    console.log(obj.toString());  // [object Object]\n    console.log(+obj.toString());  // NaN\n    console.log(3 + obj.toString());  // 3[object Object] 会被理解为字符串拼接\n    console.log(+obj.valueOf());  // NaN\n    \n    // 重写\n    obj.toString = function() {\n        return this.x + this.y;\n    };\n    console.log(+obj);  // 3\n    obj.valueOf = function() {\n        return this.x + this.y + 100;\n    };\n    console.log(+obj);  // 103\n    \n    // 如果只重写了toString，对象转换时会无视valueOf的存在来进行转换。但是，如果只重写了valueOf方法，在要转换为字符串的时候会优先考虑valueOf方法。在不能调用toString的情况下，只能让valueOf上阵了。\n    \n    var cc = {\n        i: 10,\n        valueOf: function() {\n            console.log('valueOf');\n            return this.i;\n        }\n    };\n    \n    console.log(cc);// 10 { [Number: 10] i: 10, valueOf: [Function] }\n    console.log(+cc); // 10 valueOf\n    console.log(''+cc); // 10 valueOf\n    console.log(String(cc)); // [object Object]\n    console.log(Number(cc)); // 10 valueOf\n    console.log(cc == '10'); // true valueOf\n    \n\n### 数组\n\n创建数组\n\n    // 字面量创建数组 数组的长度不能超过2^23 - 1 = 4,294,967,295\n    var BAT = ['B', 'A', 'T'];\n    var students = [{name: 'B', age: 27}, {name: 'A', age: 30}];\n    var arr = ['T', 123, true, null, undefined];\n    var arrInArr = [[1, 2], [1, 2, 3]];\n    \n    // 对象创建数组 new关键字可以省略\n    var arr = new Array();  // var = [];\n    var arrWithLength = new Array(100);  // undefined * 100\n    var arrLikesLiteral = new Array(true, false, null, 1, 2, 'hi');  // [true, false, null, 1, 2, 'hi']\n    \n\n数组元素操作\n\n    // 数组元素读写\n    \n    // 索引访问\n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr[1]);  // b\n    console.log(arr.length);  // 5\n    arr[5] = 'f';\n    console.log(arr);  // [ 'a', 'b', 'c', 'd', 'e', 'f' ]\n    console.log(arr.length);  // 6\n    \n    // delete方法并不会改变数组长度,delete 和定义为undefined的区别\n    delete arr[0];\n    console.log(arr);  // [ , 'b', 'c', 'd', 'e', 'f' ]\n    console.log(arr.length);  // 6\n    console.log(0 in arr);  // 会返回false\n    arr[1] = undefined;\n    console.log(arr);  // [ , undefined, 'c', 'd', 'e', 'f' ]\n    console.log(arr.length);  // 6\n    console.log(1 in arr);  // true\n    \n    // 数组是动态的，无需指定大小\n    \n    // 指定索引位置，改变数组\n    var arr = [];\n    arr[1] = 'b';\n    console.log(arr.length);  // 2\n    console.log(arr);   // [ , 'b' ]\n    \n    // push方法，在数组尾部添加元素,并返回新的数组长度\n    console.log(arr.push('c'));  // 3\n    console.log(arr);  // [ , 'b', 'c' ]\n    \n    // 在数组尾部添加的另一种方法\n    arr[arr.length] = 'd';\n    console.log(arr);  // [ , 'b', 'c', 'd' ]\n    \n    // unshift方法，在数组头部添加元素，并返回新的数组长度\n    console.log(arr.unshift('a'));  // 5\n    console.log(arr);  // [ 'a', , 'b', 'c', 'd' ]\n    \n    // pop方法，删除数组尾部的元素并返回这个元素\n    console.log(arr.pop());  // 'd'\n    console.log(arr);  // [ 'a', , 'b', 'c' ]\n    \n    // 删除数组尾部元素的另个方法\n    arr.length -= 1;\n    console.log(arr);  // [ 'a', , 'b' ]\n    \n    // shift方法，删除数组头部的元素并返回这个元素\n    console.log(arr.shift());  // 'a'\n    console.log(arr);  // [ , 'b' ]\n    \n\n数组迭代\n\n    // 数组迭代\n    var arr = ['a', 'b', 'c', 'd', 'e', 'f', 'g'];\n    for(var i = 0; i < arr.length; i++) {\n        console.log(arr[i]);\n    }\n    // a b c d e f g\n    \n    for(i in arr) {\n        console.log(arr[i]);\n    }\n    // a b c d e f g\n    \n    // for in 表达式的坑：会迭代原型的元素\n    Array.prototype.x = 'keng';\n    for(i in arr) {\n        console.log(arr[i]);\n    }\n    // a b c d e f g keng\n    \n    for(i in arr) {\n        if(arr.hasOwnProperty(i)) {\n            console.log(arr[i]);\n        }\n    }\n    // a b c d e f g\n    \n\n特殊数组：二维数组和稀疏数组\n\n    // 特殊数组：二维数组，稀疏数组\n    // 二维数组\n    var arr = [['a', 'b'], ['c', 'd'], ['e', 'f']];\n    var i = 0, j = 0;\n    var row;\n    for(; i < arr.length; i++) {\n        row = arr[i];\n        console.log('row' + i);\n        for(j = 0; j < row.length; j++) {\n            console.log(row[j]);\n        }\n    }\n    // row0 a b row1 c d row2 e f\n    \n    // 稀疏数组：并不含有从0开始的连续索引\n    var arr1 = [undefined];\n    var arr2 = new Array(1);\n    console.log(0 in arr1);  // true\n    console.log(0 in arr2);  // false\n    \n\n### 数组的方法\n\nArray.prototype.join(separator)\n\n    // Array.prototype.join(separator)方法：将数组拼接成字符串，返回字符串，不改变原数组\n    var arr = ['a', 'b', 'c'];\n    console.log(arr.join());  // a,b,c\n    console.log(arr.join('_'));  // a,b,c\n    function repeatString(str, n) {\n        return new Array(n + 1).join(str);\n    }\n    console.log(repeatString('a', 3));  // aaa\n    console.log(repeatString('Hi', 5));  // HiHiHiHiHi\n    \n\nArray.prototype.reverse()\n\n    // Array.prototype.reverse() 将数组逆序，返回数组本身，会改变数组本身\n    var arr = ['a', 'b', 'c'];\n    var arr1 = arr;\n    var arr2 = ['a', 'b', 'c'];\n    console.log(arr.reverse());  // [ 'c', 'b', 'a' ]\n    console.log(arr);  // [ 'c', 'b', 'a' ]\n    console.log(arr1);  // [ 'c', 'b', 'a' ]\n    console.log(arr2);  // [ 'a', 'b', 'c' ]\n    \n\nArray.prototype.sort(sortby）\n\n    // Array.prototype.sort(sortby)方法：接受一个函数参数(不传参数默认按字符编码顺序)，返回数组本身，会修改原数组\n    var arr = ['f', 'b', 'd', 'e', 'a'];\n    console.log(arr.sort());  // [ 'a', 'b', 'd', 'e', 'f' ]\n    console.log(arr);  // [ 'a', 'b', 'd', 'e', 'f' ]\n    \n    var arr = [13, 24, 51, 3];\n    console.log(arr.sort());  // [ 13, 24, 3, 51 ]\n    \n    // 传入参数：比较函数(a, b)\n    // 若 a 小于 b，在排序后的数组中 a 应该出现在 b 之前，则返回一个小于 0 的值。\n    // 若 a 等于 b，则返回 0。\n    // 若 a 大于 b，则返回一个大于 0 的值。\n    function sortNumber(a, b) {\n        return a - b;\n    }\n    console.log(arr.sort(sortNumber));  // [ 3, 13, 24, 51 ]\n    \n    var arr = [{age: 25}, {age: 29}, {age: 40}];\n    console.log(arr.sort(function sortAge(a, b) {\n        return a.age - b.age;\n    }));  // [ { age: 25 }, { age: 29 }, { age: 40 } ]\n    \n\nArray.prototype.concat(arrayX, arrayY.....)\n\n    // Array.prototype.concat(arrayX, arrayY.....)方法 连接多个数组，返回一个新的数组，不会改变原数组\n    var arr = ['a', 'b', 'c'];\n    console.log(arr.concat('d', 'e'));  // [ 'a', 'b', 'c', 'd', 'e' ]\n    console.log(arr);  // [ 'a', 'b', 'c' ]\n    console.log(arr.concat(['d', 'e'], 'f'));  // [ 'a', 'b', 'c', 'd', 'e', 'f' ]\n    console.log(arr.concat(['d', 'e'], ['f', 'g']));  // 'b', 'c', 'd', 'e', 'f', 'g' ]\n    console.log(arr.concat([['d', 'e'], 'f']));  // [ 'a', 'b', 'c', [ 'd', 'e' ], 'f' ]\n    console.log(arr.concat([[['d', 'e'], 'f'], 'g']));  // [ 'a', 'b', 'c', [ [ 'd', 'e' ], 'f' ], 'g' ]\n    \n\nArray.prototype.slice(start, end)\n\n    // Array.prototype.slice(start, end)方法：左闭右开截取数组，返回一个新的数组，不改变原数组\n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.slice(1, 3));  // ['b', 'c']\n    console.log(arr.slice(1));  // ['b', 'c', 'd', 'e']\n    console.log(arr.slice(1, -1));  // ['b', 'c', 'd']\n    console.log(arr.slice(-4, -3));  // ['b']\n    \n\nArray.prototype.splice(index, howmany, item1,....itemX)\n\n    // Array.prototype.splice(index, howmany, item1,....itemX)方法：\n    // 向/从数组中添加/删除项目，然后返回被删除的项目。会改变原数组\n    // index参数：必须，整数，添加或删除的位置，左闭合\n    // howmany参数：可选，设置为0，则不会删除\n    // item1,.....itemX：可选，向数组中添加的元素\n    \n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.splice(2));   // [ 'c', 'd', 'e' ]\n    console.log(arr);  // [ 'a', 'b' ]\n    \n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.splice(2, 1));  // [ 'c' ]\n    console.log(arr);  // [ 'a', 'b', 'd', 'e' ]\n    \n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.splice(2, 0));  // []\n    console.log(arr);  // [ 'a', 'b', 'c', 'd', 'e' ]\n    \n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.splice(2, 2, 'f', 'g', ['h', 'i']));  // [ 'c', 'd' ]\n    console.log(arr);  // [ 'a', 'b', 'f', 'g', [ 'h', 'i' ], 'e' ]\n    \n    // 指定位置插入新的元素\n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.splice(2, 0, 'f'));  // []\n    console.log(arr); // [ 'a', 'b', 'f', 'c', 'd', 'e' ]\n    \n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.splice());  // []\n    console.log(arr); // [ 'a', 'b', 'c', 'd', 'e' ]\n    \n\nArray.prototype.forEach()\n\n    // Array.prototype.forEach()方法(ES5)：接收函数参数\n    // 函数的3个参数x: 元素值，index：元素索引，a 数组本身\n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    arr.forEach(function(x, index, a) {\n        console.log(x + '_' + index + '_' + a);\n    });\n    // a_0_a,b,c,d,e b_1_a,b,c,d,e c_2_a,b,c,d,e d_3_a,b,c,d,e e_4_a,b,c,d,e\n    \n\nArray.prototype.map()\n\n    //Array.prototype.map()方法(ES5):接收函数参数,不会修改原数组\n    var arr = ['a', 'b', 'c'];\n    var arr1 = arr.map(function(x) {\n        return x + 'like';\n    });\n    \n    console.log(arr);  // [ 'a', 'b', 'c' ]\n    console.log(arr1);  // [ 'alike', 'blike', 'clike' ]\n    \n\nArray.prototype.filter()\n\n    // Array.prototype.filter()过滤方法(ES5):接收函数参数，不修改原数组\n    var arr = [1,2,3,4,5,6,7,8,9,10];\n    var arr1 = arr.filter(function(x, index) {\n        return index % 3 === 0 || x >= 8;\n    });\n    console.log(arr1);  // [ 1, 4, 7, 8, 9, 10 ]\n    console.log(arr);  // [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ]\n    \n\nArray.prototype.every() & Array.prototype.some()\n\n    // Array.prototype.every() & Array.prototype.some()判断方法(ES5):接收函数参数，不修改原数组\n    // every 全部符合条件  some 只需一个符合条件\n    var arr = [1,2,3,4,5];\n    console.log(arr.every(function(x) {\n        return x < 10;\n    }));  // true\n    console.log(arr.every(function(x) {\n        return x <= 3;\n    }));  // false\n    console.log(arr.some(function(x) {\n        return x === 3;\n    }));  // true\n    console.log(arr.some(function(x) {\n        return x === 100;\n    }));  // false\n    \n\nArray.prototype.reduce(function, index) Array.prototype.reduceRight(function, index)\n\n    // Array.prototype.reduce(function, index) Array.prototype.reduceRight(function, index)方法\n    // 接收一个函数参数和一个数组索引参数，并返回一个值，不修改原数组\n    // 函数参加接收2个参数分别代表2个索引\n    // 索引参数表示从第index个元素开始\n    var arr = [1, 2, 3];\n    var sum = arr.reduce(function(x, y) {\n        return x + y;\n    }, 0);\n    console.log(sum);  // 6  1+2返回3 3+3 返回6\n    \n    var arr = [3, 9, 6];\n    var max = arr.reduce(function(x, y) {\n        console.log(x + '|' + y);\n        return x > y ? x : y;\n    });\n    // 3|9\n    // 9|6\n    console.log(max);  // 9\n    \n    var max = arr.reduceRight(function(x, y) {\n        console.log(x + '|' + y);\n        return x > y ? x : y;\n    });\n    // 6|9\n    // 9|3\n    console.log(max);  // 9\n    \n\nArray.prototype.indexOf(value, index) Array.prototype.lastIndexOf(value, index)\n\n    // Array.prototype.indexOf(value, index) Array.prototype.lastIndexOf(value, index)数字检索方法\n    // value参数表示要查找的元素值，index表示从第几个索引位置开始查找(闭合)\n    var arr = ['a', 'b', 'c', 'b', 'a'];\n    console.log(arr.indexOf('b'));  // 1 在数组中查找是否有元素值为'b'，有则返回这个元素索引\n    console.log(arr.indexOf('f'));  // -1 如果没有则返回-1\n    console.log(arr.indexOf('b', 1));  // 1 从第2个元素开始查找，返回索引1\n    console.log(arr.indexOf('b', 2));  // 3\n    console.log(arr.indexOf('b', -2));  // 3\n    console.log(arr.indexOf('b', -4));  // 1\n    console.log(arr.indexOf('b', -8));  // 1\n    console.log(arr.lastIndexOf('b'));  // 3\n    \n\nArray.isArray()\n\n    // Array.isArray() 判断是否为数组\n    console.log(Array.isArray([]));  // true\n    \n\n### 创建函数\n\n    // 函数声明\n    function add(a, b) {\n        a = +a;\n        b = +b;\n        if (isNaN(a) || isNaN(b)) {\n            return;\n        }\n        return a + b;\n    }\n    \n    // 函数表达式\n    var add = function(a, b) {\n        // do sth\n    };\n    \n    // IEF(立即执行函数表达式)\n    (function() {\n        // do sth\n    })();\n    \n    // 函数表达式\n    return function () {\n        // do sth\n    };\n    \n    // NFE(命名式函数表达式)\n    var add = function foo(a, b) {\n        // do sth\n    };\n    \n\n**函数声明和函数表达式区别：函数声明会前置**\n\n    var num = add(1, 2);\n    console.log(num);\n    \n    function add(a, b) {\n        a = +a;\n        b = +b;\n        if (isNaN(a) || isNaN(b)) {\n            return;\n        }\n        return a + b;\n    }\n    \n    // 结果为3\n    \n\n    var num = add(1, 2);\n    console.log(num);\n    \n    var add = function (a, b) {\n        a = +a;\n        b = +b;\n        if (isNaN(a) || isNaN(b)) {\n            return;\n        }\n        return a + b;\n    };\n    \n    // TypeError: add is not a function\n    \n\n### this\n\n全局下的this\n\n    // 全局下的this(浏览器下)\n    console.log(this.window === document);  // true\n    console.log(this === window);  // true\n    this.a = 37;\n    console.log(window.a);  // 37\n    \n\n一般函数的this\n\n    // 一般函数的this（浏览器下）\n    function f1() {\n        return this;\n    }\n    f1() === window;  // true\n    \n    function f2() {\n        \"use strict\";  // 严格模式下\n        return this\n    }\n    f2() === undefined;  // true\n    \n\n作为对象方法的函数的this\n\n    var o = {\n        prop: 37,\n        f: function() {\n            return this.prop;\n        }\n    };\n    console.log(o.f());  // 37\n    \n    var o = {prop: 37};\n    function  independent() {\n        return this.prop;\n    }\n    o.f = independent;\n    console.log(o.f());  // 37\n    \n\n原型链上的this\n\n    var o = {\n        f: function() {\n            return this.a + this.b;\n        }\n    };\n    var p = Object.create(o); // p为空对象，其原型会指向o\n    p.a = 1;\n    p.b = 4;\n    console.log(p.f())  // 5\n    \n\n构造器中的this\n\n    // 当new的函数构造器没有return返回值或者返回值不是对象时，new返回一个this指向构造器的prototype这样一个空对象\n    // 如果return返回的是对象 new返回的这是这个对象\n    function Myclass() {\n        this.a = 37;\n    }\n    var o = new Myclass();\n    console.log(o.a);  // 37\n    \n    function C2() {\n        this.a = 37;\n        return {a: 38};\n    }\n    o = new C2();\n    console.log(o.a);  // 38\n    \n\ncall和apply的this\n\n    function add(c, d) {\n        return this.a + this.b + c + d;\n    }\n    var o = {a: 1, b: 2};\n    add.call(o, 5, 6);  // 1+3+5+7=16\n    add.apply(o, [10, 20]);  //1+3+10+20=34\n    \n    function bar() {\n        console.log(Object.prototype.toString.call(this));\n    }\n    bar.call(7); // [object Number]\n    \n\nband和this\n\n    //bind是es5后，ie9+使用\n    function f() {\n        return this.a;\n    }\n    var g = f.bind({a: 'test'});\n    console.log(g());  // test\n    var o = {\n        a: 37,\n        f: f,\n        g: g\n    };\n    console.log(o.f(), o.g());  // 37, test\n    \n\n函数arguments属性\n\n    function foo(x, y, z) {\n        arguments.length;  // 2 实际传入的参数数量\n        arguments[0];  // 1 传入第一个参数值\n        arguments[0] = 10;\n        x;  // 10 将第一个参数值修改为10， 严格模式下任然是1\n        arguments[2] = 100;\n        z; // undefined  由于第三个参数没有传入，不会绑定\n        arguments.callee  === foo;  // true   严格模式下不能使用\n    }\n    \n    foo(1, 2);\n    foo.length;  // 3   3个参数\n    foo.name;  // \"foo\" 函数名\n    \n\n### call和apply\n\n    // apply和call方法（浏览器）\n    // 第一个参数是作为this的对象，如果不是对象，会转换为对象\n    // call传入的是扁平传入参数\n    // apply第二个参数树数组\n    function foo(x, y) {\n        console.log(x, y, this);\n    }\n    \n    foo.call(100, 1, 2);  // 1, 2, Number(100)\n    foo.apply(true, [3, 4]);  //3, 4, Boolean(true)\n    foo.apply(null);  // undefined, undefined, window\n    foo.apply(undefined);  // undefined, undefined, window\n    \n\n### bind\n\nbind方法：改变this\n\n    // bind方法\n    this.x = 9;\n    var module = {\n        x: 81,\n        getX: function() {\n            return this.x;\n        }\n    };\n    \n    module.getX();  // 81 this指向module\n    \n    var getX = module.getX;\n    getX();  // 9 this指向全局变量\n    \n    var boundGetX = getX.bind(module);\n    boundGetX();  // 81  bind改变this指向\n    \n\nbind方法：科里化\n\n    // bind方法\n    function add(a, b, c) {\n        return a+b+c;\n    }\n    \n    var func = add.bind(undefined, 100);\n    func(1, 2);  // 103  undefined传给this， 100传给第一个参数a\n    \n    var func2 = func.bind(undefined, 200);\n    func2(10);  // 310 undefined传给this，200传给b\n    \n\nbind与new\n\n    // bind方法与new\n    function foo() {\n        this.b = 100;\n        return this.a;\n    }\n    \n    var func = foo.bind({a: 1});\n    \n    func(); // 1  foo.bind后this指向{a: 1} return this.a = 1\n    new func();  // {b: 100} new调用将返回一个this，this会被初始化一个空对象，并且其原型是foo.prototype,空对象的b属性为100\n    \n    \n\n### 闭包\n\n闭包基本概念\n\n    // 闭包\n    var n = 999;\n    function f1() {\n        console.log(n);\n    }\n    f1();  // 999  函数内部可以访问全局变量\n    \n    function f1() {\n        var n = 999;\n    }\n    console.log(n);  // error  函数外部无法访问函数内部局部变量\n    \n    function f1() {\n        n = 999;\n    }\n    console.log(n); // 999 因为没有使用var语句，相当于定义一个全局变量\n    \n    \n    // 简单的闭包原型\n    function f1() {\n        var n = 999;\n        function f2() {\n            console.log(n);\n        }\n        return f2\n    }\n    var result = f1();\n    result();  // 999\n    \n\n闭包案例\n\n    <!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <title>Title</title>\n        <style>\n            #div1 {\n                background-color: rosybrown;\n            }\n            #div2 {\n                background-color: aquamarine;\n            }\n            #div3 {\n                background-color: yellowgreen;\n            }\n        </style>\n    </head>\n    <body>\n    \n    </body>\n    <script>\n        document.body.innerHTML = '<div id=\"div1\">aaa</div><div id=\"div2\">bbb</div><div id=\"div3\">ccc</div>';\n        for(var i = 1; i < 4; i++) {\n            alert(i);  // 结果为1，2，3\n            document.getElementById('div' + i).\n                    addEventListener('click', function() {\n                alert(i);  // 点击div1，div2，div3结果都是4,因为addEventListener的回调函数执行时i都为4\n            });\n        }\n    </script>\n    </html>\n    \n\n正确写法\n\n    <!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <title>Title</title>\n        <style>\n            #div1 {\n                background-color: rosybrown;\n            }\n            #div2 {\n                background-color: aquamarine;\n            }\n            #div3 {\n                background-color: yellowgreen;\n            }\n        </style>\n    </head>\n    <body>\n    \n    </body>\n    <script>\n        document.body.innerHTML = '<div id=\"div1\">aaa</div><div id=\"div2\">bbb</div><div id=\"div3\">ccc</div>';\n        for(var i = 1; i < 4; i++) {\n            !function(i) {\n                alert(i);  // 1,2,3\n                document.getElementById('div' + i).\n                   addEventListener('click', function() {\n                       alert(i);  // 1, 2,3 \n                });\n            }(i);\n        }\n    </script>\n    </html>\n    \n\n闭包中的封装\n\n    (function() {\n        var _userID = 23245;\n        var _typeID = 'item';\n        var exportID = {};\n    \n        function converter(userID) {\n            return +userID;\n        }\n    \n        exportID.getUserID = function() {\n            return converter(_userID);\n        };\n    \n        exportID.getTypeID = function() {\n            return _typeID;\n        };\n        global.exportID = exportID;\n    }());\n    \n    console.log(exportID.getUserID());  //23245\n    console.log(exportID._userID);  // undefined\n    \n\n### 三种作用域\n\n    // 作用域： 全局作用域，函数作用域，eval作用域\n    var a = 10;\n    (function() {\n        var b = 20;\n    })();\n    console.log(a);  // 10\n    console.log(b);  // error\n    \n    for(var item in {a: 1, b: 2}) {\n        console.log(item);  // a, b\n    }\n    console.log(item); // b\n    \n\n### ES3中的执行上下文\n\nEC = Execution Context 执行上下文  \n变量对象（Variable Object 简写VO）是一个抽象概念，用于存储执行上下文中的变量，函数声明，函数参数\n\n    var a = 10;\n    function test(x) {\n        var b = 20;\n    }\n    test(30);\n    \n\n对应的上下文\n\n    // 整个js环境中的VO\n    VO(globalContext) = {\n        a: 10,\n        test: <ref to function>\n    };\n    // 执行test(30)的VO\n    VO(test functionContext) = {\n        x: 30,\n        b: 20\n    };\n    \n\n全局执行上下文\n\n    VO(globalContext) === [[global]]\n    [[global]] = {\n        Math : <...>,\n        String : <...>,\n        isNaN: function() {[Native Code]},\n        ...\n        ...\n        window: global\n    };\n    \n    String(10);  //[[global]].String(10)\n    window.a = 10;  // [[global]].window.a = 10\n    this.b = 20;  // [[global]].b = 20\n    \n\n变量初始化阶段\n\n    // 1, 函数参数（若没有传入，则其值为undefined）\n    // 2, 函数声明（若函数声明和函数参数冲突，则函数声明会覆盖掉函数参数）\n    // 3，变量声明（初始化变量值为undefined，若何函数参数，函数声明冲突，会被忽略掉）\n    function test(a, b) {\n        var c = 10;\n        function d() {}\n        var e = function _e() {};\n        (function x() {});\n        b = 20;\n    }\n    test(10);\n    \n    \n    AO(test) = {\n        a: 10,\n        b: undefined,\n        c: undefined,\n        d: <ref to func 'd'>,\n        e: undefined,\n    };\n    \n\n变量初始化案例1\n\n    function foo(x, y, z) {\n        function x() {}\n        console.log(x);\n    }\n    \n    foo(100);  // [Function: x]\n    //\n    AO(foo) = {\n        //x: 100,\n        y: undefined,\n        z: undefined,\n        x: <ref to func 'x'>,  // 函数声明x会覆盖掉参数声明 \n    }\n    \n\n变量初始化案例2\n\n    function foo(x, y, z) {\n        function func() {}\n        var func;\n        console.log(func);\n    }\n    foo(100);  // [Function: func]\n    \n    function foo(x, y, z) {\n        function func() {}\n        var func = 1;\n        console.log(func);\n    }\n    foo(100);  // 1  执行阶段会执行func = 1 这个语句\n    \n\n代码执行阶段\n\n    function test(a, b) {\n        var c = 10;\n        function d() {}\n        var e = function _e() {};\n        (function x() {})();\n        b = 20;\n    }\n    \n    // 初始化阶段\n    AO(test) = {\n        a: 10,\n        b: undefined,\n        c: undefined,\n        d: <ref to func 'd'>,\n        e: undefined\n    };\n    // 代码执行阶段\n    AO(test) = {\n        a: 10,\n        b: 20,\n        c: 10,\n        d: <reference to FunctionDeclaration 'd'>,\n        e: function _e()\n    };\n    \n\n全局执行上下文案例\n\n    console.log(x);  // [Function: x]\n    var x = 10;  // 初始化阶段x: 冲突，被忽略\n    console.log(x);  // 10\n    x = 20;\n    function x() {}  // 初始化阶段x: <ref to func 'x'>\n    console.log(x);  // 20\n    if (true) {\n        var a = 1;  // 初始化阶段a: undefined\n    } else {\n        var b = true;  // 初始化阶段b: undefined\n    }\n    \n    console.log(a);  // 1\n    console.log(b);  // undefined\n    \n\n### prototype\n\nprototype是函数对象上的预设的对象属性  \n原型是对象上的原型，通常都是构造器的prototype属性  \n实例\n\n    function Abc() {\n        this.y = 2;\n        var z = 3;\n    }\n    console.log(Abc);  // [Function: Abc]\n    console.log(Abc.prototype);  // Abc {}\n    console.log(typeof Abc.prototype);  // object\n    \n    Abc.prototype.x = 1;\n    console.log(Abc.prototype);  // Abc { x: 1 }\n    \n    var obj1 = new Abc();\n    console.log(obj1.__proto__);  // Abc { x: 1 }\n    console.log(obj1.__proto__ === Abc.prototype);  // true  new构造器创建的对象的原型是构造器的prototype属性\n    console.log(obj1);  // Abc { y: 2 }\n    console.log(obj1.y);  // 2\n    console.log(obj1.x);  // 1\n    \n\n### 继承\n\n实现继承的方法\n\n    // 实现继承的方法\n    function Person() {\n    }\n    \n    function Student() {\n    }\n    \n    Student.prototype = Person.prototype;  // 错误，会影响被继承类的方法\n    Student.prototype = new Person();  // 错误，传参问题，因为Student是类，并不是实例\n    \n    // 正确的方法\n    Student.prototype = Object.create(Person.prototype);\n    Student.prototype.constructor = Student;\n    // Object.create()是es5的方法，下面是fix方法\n    if(!Object.create) {\n        Object.create = function(proto) {\n            function F() {}\n            F.prototype = proto;\n            return new F;\n        };\n    }\n    \n\n原型的继承方法\n\n    function Person(name, age) {\n        this.name = name;\n        this.age = age;\n        this.sayNo = function() {\n            console.log(this.name + ' say no');\n        }\n    }\n    \n    Person.prototype.hi = function() {\n        console.log('Hi, my name is ' + this.name + ',I\\'m ' + this.age + ' years old now');\n    };\n    Person.prototype.LEGS_NUM = 2;\n    Person.prototype.ARMS_NUM = 2;\n    Person.prototype.walk = function() {\n        console.log(this.name + ' is walking...');\n    };\n    \n    console.log(Person);  // [Function: Person]\n    console.log(Person.prototype);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }\n    var Jack = new Person();  // Person构造器没有return对象，所以返回的是this\n    Jack.sayNo();  // undefined say no\n    Jack.hi();  // Hi, my name is undefined,I'm undefined years old now\n    Jack.walk();  // undefined is walking...\n    console.log(Jack);  // Person { name: undefined, age: undefined, sayNo: [Function] }\n    console.log(Jack.__proto__);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }\n    \n    // 以下5行代码是js中对象继承的写法\n    function Student(name, age, className) {\n        Person.call(this, name, age);  // 使用call方法调用父构造器函数\n        this.className = className;\n    }\n    Student.prototype = Object.create(Person.prototype);   // 这个如果直接使用Student.prototype = Person.prototype，改变Student对象方法会改变Person对象的方法，因为他们指向的是同一个对象\n    Student.prototype.constructor = Student;\n    \n    Student.prototype.hi = function() {\n        console.log('Hi, my name is ' + this.name + ', I\\'m' + this.age + ' years old now, and from ' + this.className + '.');\n    };\n    Student.prototype.learn = function(subject) {\n        console.log(this.name + ' is learning ' + subject + ' at ' + this.className + '.');\n    };\n    \n    var Lussi = new Student('Lussi', 27, 'Class Tree');\n    Lussi.sayNo();  // Lussi say no\n    Lussi.hi();  // Hi, my name is Lussi, I'm27 years old now, and from Class Tree.\n    Lussi.walk();  // Lussi is walking...\n    Lussi.learn('math');  // Lussi is learning math at Class Tree.\n    console.log(Lussi);  // Student {name: 'Lussi', age: 27, sayNo: [Function], className: 'Class Tree' }\n    console.log(Lussi.__proto__);  // Student {constructor: [Function: Student], hi: [Function], learn: [Function] }\n    console.log(Lussi.__proto__.__proto__);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }\n    console.log(Lussi.__proto__.__proto__.__proto__);  // {}\n    console.log(Lussi.__proto__.__proto__.__proto__.__proto__);  // null  \n    // 改变prototype\n    Student.prototype.x = 101;  // 会影响已经创建实例的属性\n    console.log(Jack.x);  // undefined\n    console.log(Lussi.x);  // 101\n    \n    Student.prototype = {y: 2};  // 不会影响已经创建实例的属性，但会影响新创建的实例，并且重新修改prototype.y属性也不会改变\n    console.log(Jack.y); // undefined\n    console.log(Lussi.y);  // undefined\n    var Lilei = new Student('Lilei', 24, 'Class three');\n    console.log(Lilei.x);  // undefined\n    console.log(Lilei.y);  // 2\n    Student.prototype.y = 100;\n    console.log(Lilei.y);  // 100\n    console.log(Lussi.y);  // undefined\n    Student.prototype.z = 30;\n    console.log(Lilei.z);  // 30\n    console.log(Lussi.z);  // undefined\n    Person.prototype.z = 40;\n    console.log(Lilei.z);  // 30\n    console.log(Lussi.z);  // 40\n    console.log(Jack.z);  // 40\n    \n\n### instanceof\n\n    // instanceof  左边是对象（如果不是，直接返回false），右边是构造器（如果不是，直接报错），判断构造器的prototype属性是否在对象的原型链上\n    console.log([1, 2] instanceof Array);  // true\n    console.log(1 instanceof Array);  // false\n    console.log(Array.prototype);  // []\n    console.log(new Object() instanceof Array);  //false\n    console.log(Object.prototype);  // {}\n    console.log(new Object() instanceof Object);  // true\n    console.log(new Array() instanceof Object);  // true\n    \n\n### 模拟重载\n\n    function Person() {\n        var args = arguments;\n        // 判断第一个传入的是不是对象，因为args[null]也返回object，所有需要判断是否为null\n        if(typeof args[0] === 'object' && args[0]) {\n            if(args[0].name) {\n                this.name = args[0].name;\n            }\n            if(args[0].age) {\n                this.age = args[0].age;\n            }\n        } else {\n            if(args[0]) {\n                this.name = args[0];\n            }\n            if(args[1]) {\n                this.age = args[1];\n            }\n        }\n    }\n    Person.prototype.toString = function() {\n        console.log('name=' + this.name + ', age=' + this.age);\n    };\n    \n    var LiLei = new Person('LiLei', 23);\n    var Hanmm = new Person({name: 'Hanmm', age: 21});\n    LiLei.toString();  // name=LiLei, age=23\n    Hanmm.toString();  // name=Hanmm, age=21\n    \n\n### 调用子类方法\n\n    function Person(name) {\n        this.name = name;\n    }\n    function Student(name, className) {\n        this.className = className;\n        Person.call(this, name);\n    }\n    \n    Person.prototype.init = function() {\n        console.log('Person.init');\n    };\n    Student.prototype.init = function() {\n        console.log('Student.init');\n        Person.prototype.init.apply(this, arguments);\n    };\n    var LiLei = new Student('LiLei', 'Class four');\n    console.log(LiLei);  // Student { className: 'Class four', name: 'LiLei' }\n    LiLei.init();  // Student.init  Person.init\n    \n\n### 实现链式调用\n\n    function ClassManager() {\n        console.log('ClassManager');\n        this.name = 'ClassName';\n    }\n    ClassManager.prototype.addClass = function(str) {\n        console.log('class: '  + str + ' added.');\n        console.log(this);\n        return this;  // this始终指向ClassManger类的实例\n    };\n    \n    var manager = new ClassManager();\n    manager.addClass('A').addClass('B').addClass('C');  //class: A added. ClassManager { name: 'ClassName' } class: B added. ClassManager { name: 'ClassName' } class: C added. ClassManager { name: 'ClassName' }","source":"_posts/javascript入门基础.md","raw":"---\ntitle: javascript入门基础\ntags:\n  - javascript\nurl: 86.html\nid: 86\ncomments: false\ncategories:\n  - 前端\ndate: 2016-11-10 10:19:51\n---\n\n### 数据类型\n\n> object(包含Function，Array，Date等)  \n> number  \n> string  \n> boolean  \n> null  \n> undefined\n\n### 类型检测\n\ntypeof 基本类型，function， null可以用===判断\n\n    typeof 100           // \"number\"   \n    typeof true          // \"boolean\"    \n    typeof function      // \"function\"    \n    typeof undefined     // \"undefined\"  \n    typeof new Object()  // \"object\"  \n    typeof [1, 2]        // \"object\"  \n    typeof NaN           // \"number\"  \n    typeof null          // \"object\"  \n    \n\ninstanceof\n\n    // 不同window或iframe下返回false\n    [1, 2] instanceof Array === true  \n    new Object instanceof Array === fasle\n    \n\nObject.prototype.toString\n\n    Object.prototype.toString.apply([1, 2, 3]) === \"[object Array]\";  \n    Object.prototype.toString.apply(function(){}) === \"[object Function]\"  \n    Object.prototype.toString.apply(null) === \"[object Null]\"  // ie678返回[object Object]  \n    Object.prototype.toString.apply(undefined) === \"[object Undefined]\"  \n    Object.prototype.toString.apply(12313) === \"[object Number]\"  \n    Object.prototype.toString.apply('12313') === \"[object String]\"\n    \n\nconstructor  \nduck type\n\n### 表达式\n\n表达式是一种js短语，可使js解释器用来产生一个值\n\n    // 原始表达式\n    3.14, \"test\"      // 常量，直接量\n    null, this, true  // 关键字\n    i, j, k;           // 变量\n    \n    // 复合表达式\n    10 * 20;           // 原始表达式+运算符+原始表达式\n    \n    // 初始化表达式\n    [1, 2];\n    [1,,2];\n    {x: 1, y: 2};\n    \n    // 函数表达式\n    var fe = function(){};\n    (function(){console.log('1111');}){};\n    \n    // 属性访问表达式\n    var o = {x:1};\n    o.x;\n    o['x'];\n    \n    // 调用表达式\n    func();\n    \n    // 对象创建表达式\n    new Func(1, 2);\n    new Object;\n    \n\n### 运算符\n\n> 一元（+num）  \n> 二元（a + b）  \n> 三元（c：a：b） 赋值(x += 1)  \n> 比较(a == b)  \n> 算术（a - b）  \n> 位 （a | b）  \n> 逻辑 (exp1 && exp2)  \n> 字符串(\"a\" + \"b\")  \n> 特殊\n\n### 特殊运算符\n\n> c? a:b  \n> var val = (1, 2, 3) // 逗号运算符  \n> delete obj.x // 删除对象属性  \n> 'x' in window; // in 运算符  \n> instanceof, typeof // 判断类型  \n> new Foo(); // new 运算符  \n> this // this运算符  \n> void 0 // undefined\n\n### 语句\n\n块语句block  \n块语句是没有作用域的\n\n    {  \n    var str = 'hi';  \n    console.log(str);  \n    }  \n    \n\n声明语句 var  \nvar a=1, b=1; 函数语句function\n\n    // 函数声明语句  \n    function fd() {  \n        return true;  \n    }    \n    // 函数表达式  \n    var fe = function() {\n        //do sth\n    };\n    \n\nfor in 语句\n\n    var p;  \n    var obj = {x:1, y:2};  \n    for(p in obj) {\n        // 顺序不确定  \n    }\n    \n    \n\nswith语句\n\n    var val = 2;\n    switch (val) {\n        case 1:\n            console.log(1);\n            break;\n        case 2:\n            console.log(2);\n            break;\n        case 3:\n            console.log(3);\n            break;\n        default:\n            console.log(0);\n            break;\n    }\n    \n\n循环语句\n\n    while (isTrue) {\n        // do sth\n    }\n    \n    do {\n        // do sth\n    } while (isTrue)\n    \n    var i;\n    for (i = 0; i < n; i++) {\n        // do sth\n    }\n    \n\nwith语句 // 不使用 try catch语句\n\n    try {\n        try {\n            throw new Error('oops');\n        } catch(ex) {\n            console.error('inner catch', ex.message);\n            throw ex;\n        } finally {\n            console.log('inner  finally');\n        }\n    } catch(ex) {\n        console.error('outer catch', ex.message);\n    } finally {\n        console.log('outer finally');\n    }\n    \n\n结果 内部catch>内部finally>外部catch>外部finally\n\n    inner catch oops  \n    inner  finally  \n    outer catch oops  \n    outer finally  \n    \n\n### 严格模式(待补充）\n\n    function func() {\n        'use strict';\n    }\n    \n\n### 对象\n\n对象创建  \n字面量创建\n\n    var obj = {x: 1};\n    console.log(obj);\n    console.log(obj.y);\n    Object.prototype.y = 2;\n    console.log(obj);\n    console.log(obj.y);\n    obj.y = undefined;\n    console.log(obj);\n    console.log(obj.y);\n    \n\n    { x: 1 }\n    undefined\n    { x: 1 }\n    2\n    { x: 1, y: undefined }\n    undefined\n    \n\nnew构造器创建\n\n    function foo() { this.color = 'red';}\n    foo.prototype.background = '#000';\n    var redColor = new foo();\n    console.log(redColor);\n    console.log(typeof redColor.toString);\n    console.log(redColor.color);\n    console.log(redColor.background);\n    console.log(foo);\n    console.log(foo.prototype);\n    console.log(foo.prototype.prototype);\n    console.log('background' in redColor);\n    redColor.background = '#FFF';\n    console.log(redColor.background);\n    console.log(foo.prototype.background);\n    \n\n    foo { color: 'red' }\n    function\n    red\n    #000\n    [Function: foo]\n    foo { background: '#000' }\n    undefined\n    true\n    #FFF\n    #000\n    \n\nObject.create()创建\n\n    function obj() {\n        this.x = 1;\n    }\n    console.log(obj);\n    var obj1 = new obj();\n    console.log(obj1);\n    var obj2 = Object.create(obj);\n    console.log(obj2);\n    console.log(obj2.x);\n    var obj3 = Object.create(obj1);\n    console.log(obj3);\n    console.log(obj3.x);;\n    \n\n    [Function: obj]\n    obj { x: 1 }\n    Function {}\n    undefined\n    obj {}\n    1\n    \n\n### 对象的内部原型(**proto**)和构造器的原型（prototype）的关系。\n\n一、所有构造器/函数的**proto**都指向Function.prototype，它是一个空函数（Empty function）\n\n    Number.__proto__ === Function.prototype  // true  \n    Boolean.__proto__ === Function.prototype // true  \n    String.__proto__ === Function.prototype  // true  \n    Object.__proto__ === Function.prototype  // true  \n    Function.__proto__ === Function.prototype // true  \n    Array.__proto__ === Function.prototype   // true  \n    RegExp.__proto__ === Function.prototype  // true  \n    Error.__proto__ === Function.prototype   // true  \n    Date.__proto__ === Function.prototype    // true  \n    Math.__proto__ === Object.prototype  // true  \n    JSON.__proto__ === Object.prototype  // true \n    // 函数声明\n    function Person() {}\n    // 函数表达式\n    var Man = function() {}\n    console.log(Person.__proto__ === Function.prototype) // true  \n    console.log(Man.__proto__ === Function.prototype)    // true  \n    \n\n所有的构造器都来自于Function.prototype，甚至包括根构造器Object及Function自身。所有构造器都继承了Function.prototype的属性及方法。如length、call、apply、bind（ES5）\n\n    console.log(typeof Function.prototype) // function\n    console.log(typeof Object.prototype)   // object\n    console.log(typeof Number.prototype)   // object\n    console.log(typeof Boolean.prototype)  // object\n    console.log(typeof String.prototype)   // object\n    console.log(typeof Array.prototype)    // object\n    console.log(typeof RegExp.prototype)   // object\n    console.log(typeof Error.prototype)    // object\n    console.log(typeof Date.prototype)     // object\n    console.log(typeof Object.prototype)   // object  \n    console.log(Function.prototype.__proto__ === Object.prototype) // true    \n    Object.prototype.__proto__ === null  // true  \n    \n\n二、所有对象的**proto**都指向其构造器的prototype  \nJavaScript引擎内置构造器\n\n    var obj = {name: 'jack'}\n    var arr = [1,2,3]\n    var reg = /hello/g\n    var date = new Date\n    var err = new Error('exception')\n    \n    console.log(obj.__proto__ === Object.prototype) // true\n    console.log(arr.__proto__ === Array.prototype)  // true\n    console.log(reg.__proto__ === RegExp.prototype) // true\n    console.log(date.__proto__ === Date.prototype)  // true\n    console.log(err.__proto__ === Error.prototype)  // true\n    \n\n自定义的构造器\n\n    function Person(name) {\n        this.name = name\n    }\n    var p = new Person('jack')\n    console.log(p.__proto__ === Person.prototype) // true\n    \n\n每个对象都有一个constructor属性，可以获取它的构造器\n\n    function Person(name) {\n        this.name = name\n    }\n    var p = new Person('jack')\n    console.log(p.__proto__ === p.constructor.prototype) // true\n    \n\n### 对象属性操作\n\n属性读写\n\n    // 属性读写\n    var obj = {x1: 1, x2: 2};\n    var i = 1, n = 2;\n    for(; i<= n; i++) {\n        console.log(obj['x' + i]);\n    }\n    // 输出1，2\n    \n    var p;\n    for(p in obj) {\n        console.log(obj[p]);\n    }\n    // 输出1，2\n    \n    var obj = {x: 1};\n    // 读写异常\n    console.log(obj.y); // undefined\n    var yz = obj.y.z;  // TypeError: Cannot read property 'z' of undefined\n    obj.y.z = 2;      //TypeError: Cannot set property 'z' of undefined\n    // 正确方式\n    var yz;\n    if(obj.y) {\n        yz = obj.y.z;\n    }\n    // 或者\n    var yz = obj && obj.y && obj.y.z  // 这个会返回undefined\n    \n\n属性删除\n\n    var person = {age: 28, title: 'fe'};\n    console.log(delete person.age);  // true\n    console.log(delete person['age']);  // true\n    console.log(person.age);  // undefined\n    console.log(delete person.age);   // 注意这个也返回true 判断操作结束后该属性是否存在\n    \n    // 有些属性是不能删除的\n    console.log(delete Object.prototype);  // false\n    \n    // 原因\n    var descriptor = Object.getOwnPropertyDescriptor(Object, 'prototype');\n    console.log(descriptor.configurable);  // false\n    \n    // 变量及函数不可删除\n    var globalVal = 1;\n    console.log(delete globalVal);  // false\n    \n    (function() {\n        var localVal = 1;\n        console.log(delete localVal);\n    }());  // false\n    \n    function fd() {}\n    console.log(delete fd);  // false\n    \n    (function() {\n        function fd() {};\n        console.log(delete fd);\n    }());  // false\n    \n    \n    // 隐示定义的变量可以\n    ohNo = 1;\n    console.log(delete ohNo);  // true\n    \n\n对象属性检测\n\n    var cat = new Object();\n    cat.legs = 4;\n    cat.name = 'Kitty';\n    \n    console.log('legs' in cat);  // true\n    console.log('abc' in cat);  // false\n    console.log('toString' in cat);  // true 继承属性\n    \n    console.log(cat.hasOwnProperty('legs'));  // true\n    console.log(cat.hasOwnProperty('toString'));  // false\n    \n    console.log(cat.propertyIsEnumerable('legs'));  // true\n    console.log(cat.propertyIsEnumerable('toString'));  // false\n    \n    \n    Object.defineProperty(cat, 'price', {enumerable: false, value: 1000});\n    // defineProperty是Object的方法，默认的标签enumerable值为false\n    // Object.x创建属性，默认的标签值为true\n    console.log(cat.propertyIsEnumerable('price'));  // false\n    console.log(cat.hasOwnProperty('price'));  // true\n    \n    \n    // 判断属性是否存在\n    if(cat && cat.legs) {\n        cat.legs *= 2;\n    }\n    \n    if(cat.legs != undefined) {\n        // !== undefined 或者 !== null\n    }\n    if(cat.legs !== undefined) {\n        // !== undefined\n    }\n    \n\n对象属性枚举\n\n    var o = {x: 1, y: 2, z: 3};\n    console.log('toString' in o);  // true\n    o.propertyIsEnumerable('toString');  // false\n    \n    var key;\n    console.log(o.x);  // 1\n    console.log(o.y);  // 2\n    console.log(o.z);  // 3\n    for(key in o) {\n        console.log(key);  // x, y, z\n        console.log(o.key);  // undefined\n        console.log(o[key]);  // 1, 2, 3\n    }\n    \n    \n    var obj = Object.create(o);\n    obj.a = 4;\n    var key;\n    for(key in obj) {\n        console.log(key); // a, x, y, z\n    }\n    var key1;\n    for (key1 in obj) {\n        if(obj.hasOwnProperty(key1)) {\n            console.log(key1); // a\n        }\n    }\n    \n\n对象属性的get/set方法\n\n    // 对象属性的get/set方法\n    var man = {\n        name: 'Bug',\n        weibo: 'Bug',\n        get age() {\n            return new Date().getFullYear() - 1988;\n        },\n        set age(val) {\n            console.log('cannot be set ' + val);\n        },\n    };\n    \n    console.log(man.age);  // 调用age的get方法27\n    man.age = 100;  // 调用age的set方法 cannot be set 100\n    console.log(man.age);  // 27\n    \n    \n    var man = {\n        weibo: 'Bug',\n        $age: null,\n        get age() {\n            if(this.$age == undefined) {\n                return new Date().getFullYear() - 1988;\n            } else {\n                return this.$age;\n            }\n        },\n        set age(val) {\n            val = +val; // 转为数字\n            if(!isNaN(val) && val > 0 && val < 150) {\n                this.$age = + val;\n            } else {\n                throw new Error('Incorrect val = ' + val );\n            }\n        }\n    }\n    \n    console.log(man.age);  // 27\n    man.age = 100;\n    console.log(man.age);  // 100\n    //man.age = 'abc';  // Error: Incorrect val = NaN\n    \n    \n    // get/set方法与原型链\n    \n    // 这是错误的定义对象属性get方法方式\n    function foo1() {}\n    foo1.prototype.z = {\n        get: function() {\n            return 2;\n        }\n    };\n    var obj = new foo1();\n    console.log(obj.z);  // 这个会被认为是对象 { get: [Function] }\n    obj.z = 200;\n    console.log(obj.z);  // 200\n    \n    // 正确定义方法\n    function foo() {}\n    Object.defineProperty(foo.prototype, 'z', {\n        get: function() {\n            return 1;\n        },\n        // configurable: true,  // 开启此属于也不会被改变\n        // writable: true,  // 此项不能配置writable/value get/set 二选一\n     });\n    var obj = new foo();\n    console.log(obj.z);   // 1\n    obj.z = 100;\n    console.log(obj.z);  // 但是还是1 并没有被改变\n    \n    Object.defineProperty(obj, 'z', {\n        value: 100,\n        configurable: true\n    });\n    console.log(obj.z);  // 100\n    delete obj.z;\n    console.log(obj.z);  // 返回到1\n    \n    // 另外一个例子\n    var o = {};\n    Object.defineProperty(o, 'x', {\n        value: 1\n    });  // 默认writable: false, configurable: false\n    var obj = Object.create(o);\n    console.log(obj.x);  // 1\n    obj.x = 100;\n    console.log(obj.x);  // 还是1\n    \n    \n    Object.defineProperty(obj, 'x', {\n        writable: true,\n        configurable: true,\n        value: 100\n    });\n    console.log(obj.x);  // 100\n    obj.x = 200;\n    console.log(obj.x); // 200\n    \n\n### 对象属性标签\n\n    person = {};\n    Object.defineProperty(person, 'type', {\n        configurable: false,\n        writable: true,\n        enumerable: false,\n        value: 'Object',\n    });\n    \n    console.log(Object.keys(person));   // [] 返回空数组，不能枚举\n    console.log(Object.getOwnPropertyDescriptor(person, 'type'));   // { value: 'Object', writable: true, enumerable: false, configurable: false }\n    \n    \n    // writable为true，可以通过赋值方法修改value值 [通过赋值修改属性值只和writable标签有关，和configurable无关]\n    person.type = 'Object2';\n    console.log(Object.getOwnPropertyDescriptor(person, 'type'));  // { value: 'Object2', writable: true, enumerable: false, configurable: false }\n    \n    \n    // configurable: false 无法使用delete删除属性， 无法使用get/set方法，  无法重新配置属性标签（除了将writable从true修改为false）\n    console.log(delete person.type);   // 返回false\n    \n    \n    // 只有writable和configurable标签都为false时，不能修改value标签值，其他情况都可以修改value标签值\n    Object.defineProperty(person, 'type', {\n        configurable: false,\n        writable: true,\n        enumerable: false,\n        value: 'Object1',\n    });\n    console.log(Object.getOwnPropertyDescriptor(person, 'type'));   // { value: 'Object1', writable: true, enumerable: false, configurable: false }\n    \n    \n    // 可以重新配置writable标签值(只能重true改为false)\n    Object.defineProperty(person, 'type', {\n        writable: false,\n    });\n    console.log(Object.getOwnPropertyDescriptor(person, 'type'));   // { value: 'Object1', writable: false, enumerable: false, configurable: false }\n    \n    \n    // 无法将writable从false改为true\n    Object.defineProperty(person, 'type', {\n        writable: true,\n    });\n    console.log(Object.getOwnPropertyDescriptor(person, 'type'));   // TypeError: Cannot redefine property: type\n    \n    \n    // 无法重新配置enumerable，configurable属性\n    Object.defineProperty(person, 'type', {\n        enumerable: true,\n    });\n    console.log(Object.getOwnPropertyDescriptor(person, 'type'));   // TypeError: Cannot redefine property: type\n    \n\n### 对象标签\n\n原型标签**proto**\n\n    // 原型标签__proto__\n    \n    function Person(name) {\n        this.name = name;\n    }\n    var p = new Person('jack');\n    console.log(p.__proto__ === Person.prototype);  // true\n    \n\n类型标签\n\n    //  对象class标签，表示对象是哪个类型，没有直接的方法去修改或者获取\n    var toString = Object.prototype.toString;\n    \n    console.log(toString.call(null));  // [object Null]\n    console.log(toString.call(undefined));  // [object Undefined]\n    console.log(toString.call(1));  // [object Number]\n    console.log(toString.call(new Number(1)));  // [object Number]\n    console.log(toString.call(true));  // [object Boolean]\n    console.log(toString.call(new Boolean(true)));  // [object Boolean]\n    \n\n可扩展标签\n\n    // extensible 可扩展标签，表示是否可以继续添加对象属性\n    var obj = {x: 1, y: 2};\n    console.log(Object.isExtensible(obj));  // true 对象可扩展\n    Object.preventExtensions(obj);  // 配置对象不可扩展\n    console.log(Object.isExtensible(obj));  // false 对象不可扩展\n    obj.z =1;\n    console.log(obj.z);  // undefined 添加属性失败\n    console.log(Object.getOwnPropertyDescriptor(obj, 'x'));  // // { value: 1, writable: true, enumerable: true, configurable: true }\n    \n    \n    // Object.seal方法，对象的所有属性configurable值为false\n    Object.seal(obj);\n    console.log(Object.getOwnPropertyDescriptor(obj, 'x'));  // { value: 1, writable: true, enumerable: true, configurable: false }\n    console.log(Object.isSealed(obj)); // true\n    \n    \n    // Object.freeze方法，对象的所有属性configurable，writable标签值为false\n    Object.freeze(obj);\n    console.log(Object.getOwnPropertyDescriptor(obj, 'x'));   // // { value: 1, writable: false, enumerable: true, configurable: false }\n    console.log(Object.isFrozen(obj));  // true\n    \n\n### JS对象与json格式转换\n\n    // 将js对象转为json格式JSON.stringify()\n    var obj = {x: 1, y: true, z: [1, 2, 3], nullVal: null};\n    console.log(JSON.stringify(obj));  // {\"x\":1,\"y\":true,\"z\":[1,2,3],\"nullVal\":null}\n    \n    // undefined,NaN,Infinity等特殊属性值\n    var obj = {val: undefined, a: NaN, b: Infinity, c: new Date()};\n    console.log(JSON.stringify(obj));  // {\"a\":null,\"b\":null,\"c\":\"2015-12-19T12:30:40.456Z\"}\n    \n    // 将json格式转为js对象JSON.parse\n    var obj = JSON.parse('{\"x\": 1}');\n    console.log(obj.x);  // 1\n    \n    //toJSON方法\n    var obj = {\n        x: 1,\n        y: 2,\n        o: {\n            o1: 1,\n            o2: 2,\n            toJSON: function() {\n                return this.o1 + this.o2;\n            }\n        },\n    };\n    console.log(JSON.stringify(obj));  // {\"x\":1,\"y\":2,\"o\":3}\n    \n\n###toString valueOf方法\n\n    // 对象在作为操作数时，解释器总是优先调用valueOf()--(Date类型的对象在二元“+”运算时例外),而其他情况，解释器总是认为我们想要的是字符串，所以会优先调用toString()。\n    var obj = {x: 1, y: 2};\n    console.log(obj.toString());  // [object Object]\n    console.log(+obj.toString());  // NaN\n    console.log(3 + obj.toString());  // 3[object Object] 会被理解为字符串拼接\n    console.log(+obj.valueOf());  // NaN\n    \n    // 重写\n    obj.toString = function() {\n        return this.x + this.y;\n    };\n    console.log(+obj);  // 3\n    obj.valueOf = function() {\n        return this.x + this.y + 100;\n    };\n    console.log(+obj);  // 103\n    \n    // 如果只重写了toString，对象转换时会无视valueOf的存在来进行转换。但是，如果只重写了valueOf方法，在要转换为字符串的时候会优先考虑valueOf方法。在不能调用toString的情况下，只能让valueOf上阵了。\n    \n    var cc = {\n        i: 10,\n        valueOf: function() {\n            console.log('valueOf');\n            return this.i;\n        }\n    };\n    \n    console.log(cc);// 10 { [Number: 10] i: 10, valueOf: [Function] }\n    console.log(+cc); // 10 valueOf\n    console.log(''+cc); // 10 valueOf\n    console.log(String(cc)); // [object Object]\n    console.log(Number(cc)); // 10 valueOf\n    console.log(cc == '10'); // true valueOf\n    \n\n### 数组\n\n创建数组\n\n    // 字面量创建数组 数组的长度不能超过2^23 - 1 = 4,294,967,295\n    var BAT = ['B', 'A', 'T'];\n    var students = [{name: 'B', age: 27}, {name: 'A', age: 30}];\n    var arr = ['T', 123, true, null, undefined];\n    var arrInArr = [[1, 2], [1, 2, 3]];\n    \n    // 对象创建数组 new关键字可以省略\n    var arr = new Array();  // var = [];\n    var arrWithLength = new Array(100);  // undefined * 100\n    var arrLikesLiteral = new Array(true, false, null, 1, 2, 'hi');  // [true, false, null, 1, 2, 'hi']\n    \n\n数组元素操作\n\n    // 数组元素读写\n    \n    // 索引访问\n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr[1]);  // b\n    console.log(arr.length);  // 5\n    arr[5] = 'f';\n    console.log(arr);  // [ 'a', 'b', 'c', 'd', 'e', 'f' ]\n    console.log(arr.length);  // 6\n    \n    // delete方法并不会改变数组长度,delete 和定义为undefined的区别\n    delete arr[0];\n    console.log(arr);  // [ , 'b', 'c', 'd', 'e', 'f' ]\n    console.log(arr.length);  // 6\n    console.log(0 in arr);  // 会返回false\n    arr[1] = undefined;\n    console.log(arr);  // [ , undefined, 'c', 'd', 'e', 'f' ]\n    console.log(arr.length);  // 6\n    console.log(1 in arr);  // true\n    \n    // 数组是动态的，无需指定大小\n    \n    // 指定索引位置，改变数组\n    var arr = [];\n    arr[1] = 'b';\n    console.log(arr.length);  // 2\n    console.log(arr);   // [ , 'b' ]\n    \n    // push方法，在数组尾部添加元素,并返回新的数组长度\n    console.log(arr.push('c'));  // 3\n    console.log(arr);  // [ , 'b', 'c' ]\n    \n    // 在数组尾部添加的另一种方法\n    arr[arr.length] = 'd';\n    console.log(arr);  // [ , 'b', 'c', 'd' ]\n    \n    // unshift方法，在数组头部添加元素，并返回新的数组长度\n    console.log(arr.unshift('a'));  // 5\n    console.log(arr);  // [ 'a', , 'b', 'c', 'd' ]\n    \n    // pop方法，删除数组尾部的元素并返回这个元素\n    console.log(arr.pop());  // 'd'\n    console.log(arr);  // [ 'a', , 'b', 'c' ]\n    \n    // 删除数组尾部元素的另个方法\n    arr.length -= 1;\n    console.log(arr);  // [ 'a', , 'b' ]\n    \n    // shift方法，删除数组头部的元素并返回这个元素\n    console.log(arr.shift());  // 'a'\n    console.log(arr);  // [ , 'b' ]\n    \n\n数组迭代\n\n    // 数组迭代\n    var arr = ['a', 'b', 'c', 'd', 'e', 'f', 'g'];\n    for(var i = 0; i < arr.length; i++) {\n        console.log(arr[i]);\n    }\n    // a b c d e f g\n    \n    for(i in arr) {\n        console.log(arr[i]);\n    }\n    // a b c d e f g\n    \n    // for in 表达式的坑：会迭代原型的元素\n    Array.prototype.x = 'keng';\n    for(i in arr) {\n        console.log(arr[i]);\n    }\n    // a b c d e f g keng\n    \n    for(i in arr) {\n        if(arr.hasOwnProperty(i)) {\n            console.log(arr[i]);\n        }\n    }\n    // a b c d e f g\n    \n\n特殊数组：二维数组和稀疏数组\n\n    // 特殊数组：二维数组，稀疏数组\n    // 二维数组\n    var arr = [['a', 'b'], ['c', 'd'], ['e', 'f']];\n    var i = 0, j = 0;\n    var row;\n    for(; i < arr.length; i++) {\n        row = arr[i];\n        console.log('row' + i);\n        for(j = 0; j < row.length; j++) {\n            console.log(row[j]);\n        }\n    }\n    // row0 a b row1 c d row2 e f\n    \n    // 稀疏数组：并不含有从0开始的连续索引\n    var arr1 = [undefined];\n    var arr2 = new Array(1);\n    console.log(0 in arr1);  // true\n    console.log(0 in arr2);  // false\n    \n\n### 数组的方法\n\nArray.prototype.join(separator)\n\n    // Array.prototype.join(separator)方法：将数组拼接成字符串，返回字符串，不改变原数组\n    var arr = ['a', 'b', 'c'];\n    console.log(arr.join());  // a,b,c\n    console.log(arr.join('_'));  // a,b,c\n    function repeatString(str, n) {\n        return new Array(n + 1).join(str);\n    }\n    console.log(repeatString('a', 3));  // aaa\n    console.log(repeatString('Hi', 5));  // HiHiHiHiHi\n    \n\nArray.prototype.reverse()\n\n    // Array.prototype.reverse() 将数组逆序，返回数组本身，会改变数组本身\n    var arr = ['a', 'b', 'c'];\n    var arr1 = arr;\n    var arr2 = ['a', 'b', 'c'];\n    console.log(arr.reverse());  // [ 'c', 'b', 'a' ]\n    console.log(arr);  // [ 'c', 'b', 'a' ]\n    console.log(arr1);  // [ 'c', 'b', 'a' ]\n    console.log(arr2);  // [ 'a', 'b', 'c' ]\n    \n\nArray.prototype.sort(sortby）\n\n    // Array.prototype.sort(sortby)方法：接受一个函数参数(不传参数默认按字符编码顺序)，返回数组本身，会修改原数组\n    var arr = ['f', 'b', 'd', 'e', 'a'];\n    console.log(arr.sort());  // [ 'a', 'b', 'd', 'e', 'f' ]\n    console.log(arr);  // [ 'a', 'b', 'd', 'e', 'f' ]\n    \n    var arr = [13, 24, 51, 3];\n    console.log(arr.sort());  // [ 13, 24, 3, 51 ]\n    \n    // 传入参数：比较函数(a, b)\n    // 若 a 小于 b，在排序后的数组中 a 应该出现在 b 之前，则返回一个小于 0 的值。\n    // 若 a 等于 b，则返回 0。\n    // 若 a 大于 b，则返回一个大于 0 的值。\n    function sortNumber(a, b) {\n        return a - b;\n    }\n    console.log(arr.sort(sortNumber));  // [ 3, 13, 24, 51 ]\n    \n    var arr = [{age: 25}, {age: 29}, {age: 40}];\n    console.log(arr.sort(function sortAge(a, b) {\n        return a.age - b.age;\n    }));  // [ { age: 25 }, { age: 29 }, { age: 40 } ]\n    \n\nArray.prototype.concat(arrayX, arrayY.....)\n\n    // Array.prototype.concat(arrayX, arrayY.....)方法 连接多个数组，返回一个新的数组，不会改变原数组\n    var arr = ['a', 'b', 'c'];\n    console.log(arr.concat('d', 'e'));  // [ 'a', 'b', 'c', 'd', 'e' ]\n    console.log(arr);  // [ 'a', 'b', 'c' ]\n    console.log(arr.concat(['d', 'e'], 'f'));  // [ 'a', 'b', 'c', 'd', 'e', 'f' ]\n    console.log(arr.concat(['d', 'e'], ['f', 'g']));  // 'b', 'c', 'd', 'e', 'f', 'g' ]\n    console.log(arr.concat([['d', 'e'], 'f']));  // [ 'a', 'b', 'c', [ 'd', 'e' ], 'f' ]\n    console.log(arr.concat([[['d', 'e'], 'f'], 'g']));  // [ 'a', 'b', 'c', [ [ 'd', 'e' ], 'f' ], 'g' ]\n    \n\nArray.prototype.slice(start, end)\n\n    // Array.prototype.slice(start, end)方法：左闭右开截取数组，返回一个新的数组，不改变原数组\n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.slice(1, 3));  // ['b', 'c']\n    console.log(arr.slice(1));  // ['b', 'c', 'd', 'e']\n    console.log(arr.slice(1, -1));  // ['b', 'c', 'd']\n    console.log(arr.slice(-4, -3));  // ['b']\n    \n\nArray.prototype.splice(index, howmany, item1,....itemX)\n\n    // Array.prototype.splice(index, howmany, item1,....itemX)方法：\n    // 向/从数组中添加/删除项目，然后返回被删除的项目。会改变原数组\n    // index参数：必须，整数，添加或删除的位置，左闭合\n    // howmany参数：可选，设置为0，则不会删除\n    // item1,.....itemX：可选，向数组中添加的元素\n    \n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.splice(2));   // [ 'c', 'd', 'e' ]\n    console.log(arr);  // [ 'a', 'b' ]\n    \n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.splice(2, 1));  // [ 'c' ]\n    console.log(arr);  // [ 'a', 'b', 'd', 'e' ]\n    \n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.splice(2, 0));  // []\n    console.log(arr);  // [ 'a', 'b', 'c', 'd', 'e' ]\n    \n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.splice(2, 2, 'f', 'g', ['h', 'i']));  // [ 'c', 'd' ]\n    console.log(arr);  // [ 'a', 'b', 'f', 'g', [ 'h', 'i' ], 'e' ]\n    \n    // 指定位置插入新的元素\n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.splice(2, 0, 'f'));  // []\n    console.log(arr); // [ 'a', 'b', 'f', 'c', 'd', 'e' ]\n    \n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    console.log(arr.splice());  // []\n    console.log(arr); // [ 'a', 'b', 'c', 'd', 'e' ]\n    \n\nArray.prototype.forEach()\n\n    // Array.prototype.forEach()方法(ES5)：接收函数参数\n    // 函数的3个参数x: 元素值，index：元素索引，a 数组本身\n    var arr = ['a', 'b', 'c', 'd', 'e'];\n    arr.forEach(function(x, index, a) {\n        console.log(x + '_' + index + '_' + a);\n    });\n    // a_0_a,b,c,d,e b_1_a,b,c,d,e c_2_a,b,c,d,e d_3_a,b,c,d,e e_4_a,b,c,d,e\n    \n\nArray.prototype.map()\n\n    //Array.prototype.map()方法(ES5):接收函数参数,不会修改原数组\n    var arr = ['a', 'b', 'c'];\n    var arr1 = arr.map(function(x) {\n        return x + 'like';\n    });\n    \n    console.log(arr);  // [ 'a', 'b', 'c' ]\n    console.log(arr1);  // [ 'alike', 'blike', 'clike' ]\n    \n\nArray.prototype.filter()\n\n    // Array.prototype.filter()过滤方法(ES5):接收函数参数，不修改原数组\n    var arr = [1,2,3,4,5,6,7,8,9,10];\n    var arr1 = arr.filter(function(x, index) {\n        return index % 3 === 0 || x >= 8;\n    });\n    console.log(arr1);  // [ 1, 4, 7, 8, 9, 10 ]\n    console.log(arr);  // [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ]\n    \n\nArray.prototype.every() & Array.prototype.some()\n\n    // Array.prototype.every() & Array.prototype.some()判断方法(ES5):接收函数参数，不修改原数组\n    // every 全部符合条件  some 只需一个符合条件\n    var arr = [1,2,3,4,5];\n    console.log(arr.every(function(x) {\n        return x < 10;\n    }));  // true\n    console.log(arr.every(function(x) {\n        return x <= 3;\n    }));  // false\n    console.log(arr.some(function(x) {\n        return x === 3;\n    }));  // true\n    console.log(arr.some(function(x) {\n        return x === 100;\n    }));  // false\n    \n\nArray.prototype.reduce(function, index) Array.prototype.reduceRight(function, index)\n\n    // Array.prototype.reduce(function, index) Array.prototype.reduceRight(function, index)方法\n    // 接收一个函数参数和一个数组索引参数，并返回一个值，不修改原数组\n    // 函数参加接收2个参数分别代表2个索引\n    // 索引参数表示从第index个元素开始\n    var arr = [1, 2, 3];\n    var sum = arr.reduce(function(x, y) {\n        return x + y;\n    }, 0);\n    console.log(sum);  // 6  1+2返回3 3+3 返回6\n    \n    var arr = [3, 9, 6];\n    var max = arr.reduce(function(x, y) {\n        console.log(x + '|' + y);\n        return x > y ? x : y;\n    });\n    // 3|9\n    // 9|6\n    console.log(max);  // 9\n    \n    var max = arr.reduceRight(function(x, y) {\n        console.log(x + '|' + y);\n        return x > y ? x : y;\n    });\n    // 6|9\n    // 9|3\n    console.log(max);  // 9\n    \n\nArray.prototype.indexOf(value, index) Array.prototype.lastIndexOf(value, index)\n\n    // Array.prototype.indexOf(value, index) Array.prototype.lastIndexOf(value, index)数字检索方法\n    // value参数表示要查找的元素值，index表示从第几个索引位置开始查找(闭合)\n    var arr = ['a', 'b', 'c', 'b', 'a'];\n    console.log(arr.indexOf('b'));  // 1 在数组中查找是否有元素值为'b'，有则返回这个元素索引\n    console.log(arr.indexOf('f'));  // -1 如果没有则返回-1\n    console.log(arr.indexOf('b', 1));  // 1 从第2个元素开始查找，返回索引1\n    console.log(arr.indexOf('b', 2));  // 3\n    console.log(arr.indexOf('b', -2));  // 3\n    console.log(arr.indexOf('b', -4));  // 1\n    console.log(arr.indexOf('b', -8));  // 1\n    console.log(arr.lastIndexOf('b'));  // 3\n    \n\nArray.isArray()\n\n    // Array.isArray() 判断是否为数组\n    console.log(Array.isArray([]));  // true\n    \n\n### 创建函数\n\n    // 函数声明\n    function add(a, b) {\n        a = +a;\n        b = +b;\n        if (isNaN(a) || isNaN(b)) {\n            return;\n        }\n        return a + b;\n    }\n    \n    // 函数表达式\n    var add = function(a, b) {\n        // do sth\n    };\n    \n    // IEF(立即执行函数表达式)\n    (function() {\n        // do sth\n    })();\n    \n    // 函数表达式\n    return function () {\n        // do sth\n    };\n    \n    // NFE(命名式函数表达式)\n    var add = function foo(a, b) {\n        // do sth\n    };\n    \n\n**函数声明和函数表达式区别：函数声明会前置**\n\n    var num = add(1, 2);\n    console.log(num);\n    \n    function add(a, b) {\n        a = +a;\n        b = +b;\n        if (isNaN(a) || isNaN(b)) {\n            return;\n        }\n        return a + b;\n    }\n    \n    // 结果为3\n    \n\n    var num = add(1, 2);\n    console.log(num);\n    \n    var add = function (a, b) {\n        a = +a;\n        b = +b;\n        if (isNaN(a) || isNaN(b)) {\n            return;\n        }\n        return a + b;\n    };\n    \n    // TypeError: add is not a function\n    \n\n### this\n\n全局下的this\n\n    // 全局下的this(浏览器下)\n    console.log(this.window === document);  // true\n    console.log(this === window);  // true\n    this.a = 37;\n    console.log(window.a);  // 37\n    \n\n一般函数的this\n\n    // 一般函数的this（浏览器下）\n    function f1() {\n        return this;\n    }\n    f1() === window;  // true\n    \n    function f2() {\n        \"use strict\";  // 严格模式下\n        return this\n    }\n    f2() === undefined;  // true\n    \n\n作为对象方法的函数的this\n\n    var o = {\n        prop: 37,\n        f: function() {\n            return this.prop;\n        }\n    };\n    console.log(o.f());  // 37\n    \n    var o = {prop: 37};\n    function  independent() {\n        return this.prop;\n    }\n    o.f = independent;\n    console.log(o.f());  // 37\n    \n\n原型链上的this\n\n    var o = {\n        f: function() {\n            return this.a + this.b;\n        }\n    };\n    var p = Object.create(o); // p为空对象，其原型会指向o\n    p.a = 1;\n    p.b = 4;\n    console.log(p.f())  // 5\n    \n\n构造器中的this\n\n    // 当new的函数构造器没有return返回值或者返回值不是对象时，new返回一个this指向构造器的prototype这样一个空对象\n    // 如果return返回的是对象 new返回的这是这个对象\n    function Myclass() {\n        this.a = 37;\n    }\n    var o = new Myclass();\n    console.log(o.a);  // 37\n    \n    function C2() {\n        this.a = 37;\n        return {a: 38};\n    }\n    o = new C2();\n    console.log(o.a);  // 38\n    \n\ncall和apply的this\n\n    function add(c, d) {\n        return this.a + this.b + c + d;\n    }\n    var o = {a: 1, b: 2};\n    add.call(o, 5, 6);  // 1+3+5+7=16\n    add.apply(o, [10, 20]);  //1+3+10+20=34\n    \n    function bar() {\n        console.log(Object.prototype.toString.call(this));\n    }\n    bar.call(7); // [object Number]\n    \n\nband和this\n\n    //bind是es5后，ie9+使用\n    function f() {\n        return this.a;\n    }\n    var g = f.bind({a: 'test'});\n    console.log(g());  // test\n    var o = {\n        a: 37,\n        f: f,\n        g: g\n    };\n    console.log(o.f(), o.g());  // 37, test\n    \n\n函数arguments属性\n\n    function foo(x, y, z) {\n        arguments.length;  // 2 实际传入的参数数量\n        arguments[0];  // 1 传入第一个参数值\n        arguments[0] = 10;\n        x;  // 10 将第一个参数值修改为10， 严格模式下任然是1\n        arguments[2] = 100;\n        z; // undefined  由于第三个参数没有传入，不会绑定\n        arguments.callee  === foo;  // true   严格模式下不能使用\n    }\n    \n    foo(1, 2);\n    foo.length;  // 3   3个参数\n    foo.name;  // \"foo\" 函数名\n    \n\n### call和apply\n\n    // apply和call方法（浏览器）\n    // 第一个参数是作为this的对象，如果不是对象，会转换为对象\n    // call传入的是扁平传入参数\n    // apply第二个参数树数组\n    function foo(x, y) {\n        console.log(x, y, this);\n    }\n    \n    foo.call(100, 1, 2);  // 1, 2, Number(100)\n    foo.apply(true, [3, 4]);  //3, 4, Boolean(true)\n    foo.apply(null);  // undefined, undefined, window\n    foo.apply(undefined);  // undefined, undefined, window\n    \n\n### bind\n\nbind方法：改变this\n\n    // bind方法\n    this.x = 9;\n    var module = {\n        x: 81,\n        getX: function() {\n            return this.x;\n        }\n    };\n    \n    module.getX();  // 81 this指向module\n    \n    var getX = module.getX;\n    getX();  // 9 this指向全局变量\n    \n    var boundGetX = getX.bind(module);\n    boundGetX();  // 81  bind改变this指向\n    \n\nbind方法：科里化\n\n    // bind方法\n    function add(a, b, c) {\n        return a+b+c;\n    }\n    \n    var func = add.bind(undefined, 100);\n    func(1, 2);  // 103  undefined传给this， 100传给第一个参数a\n    \n    var func2 = func.bind(undefined, 200);\n    func2(10);  // 310 undefined传给this，200传给b\n    \n\nbind与new\n\n    // bind方法与new\n    function foo() {\n        this.b = 100;\n        return this.a;\n    }\n    \n    var func = foo.bind({a: 1});\n    \n    func(); // 1  foo.bind后this指向{a: 1} return this.a = 1\n    new func();  // {b: 100} new调用将返回一个this，this会被初始化一个空对象，并且其原型是foo.prototype,空对象的b属性为100\n    \n    \n\n### 闭包\n\n闭包基本概念\n\n    // 闭包\n    var n = 999;\n    function f1() {\n        console.log(n);\n    }\n    f1();  // 999  函数内部可以访问全局变量\n    \n    function f1() {\n        var n = 999;\n    }\n    console.log(n);  // error  函数外部无法访问函数内部局部变量\n    \n    function f1() {\n        n = 999;\n    }\n    console.log(n); // 999 因为没有使用var语句，相当于定义一个全局变量\n    \n    \n    // 简单的闭包原型\n    function f1() {\n        var n = 999;\n        function f2() {\n            console.log(n);\n        }\n        return f2\n    }\n    var result = f1();\n    result();  // 999\n    \n\n闭包案例\n\n    <!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <title>Title</title>\n        <style>\n            #div1 {\n                background-color: rosybrown;\n            }\n            #div2 {\n                background-color: aquamarine;\n            }\n            #div3 {\n                background-color: yellowgreen;\n            }\n        </style>\n    </head>\n    <body>\n    \n    </body>\n    <script>\n        document.body.innerHTML = '<div id=\"div1\">aaa</div><div id=\"div2\">bbb</div><div id=\"div3\">ccc</div>';\n        for(var i = 1; i < 4; i++) {\n            alert(i);  // 结果为1，2，3\n            document.getElementById('div' + i).\n                    addEventListener('click', function() {\n                alert(i);  // 点击div1，div2，div3结果都是4,因为addEventListener的回调函数执行时i都为4\n            });\n        }\n    </script>\n    </html>\n    \n\n正确写法\n\n    <!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <title>Title</title>\n        <style>\n            #div1 {\n                background-color: rosybrown;\n            }\n            #div2 {\n                background-color: aquamarine;\n            }\n            #div3 {\n                background-color: yellowgreen;\n            }\n        </style>\n    </head>\n    <body>\n    \n    </body>\n    <script>\n        document.body.innerHTML = '<div id=\"div1\">aaa</div><div id=\"div2\">bbb</div><div id=\"div3\">ccc</div>';\n        for(var i = 1; i < 4; i++) {\n            !function(i) {\n                alert(i);  // 1,2,3\n                document.getElementById('div' + i).\n                   addEventListener('click', function() {\n                       alert(i);  // 1, 2,3 \n                });\n            }(i);\n        }\n    </script>\n    </html>\n    \n\n闭包中的封装\n\n    (function() {\n        var _userID = 23245;\n        var _typeID = 'item';\n        var exportID = {};\n    \n        function converter(userID) {\n            return +userID;\n        }\n    \n        exportID.getUserID = function() {\n            return converter(_userID);\n        };\n    \n        exportID.getTypeID = function() {\n            return _typeID;\n        };\n        global.exportID = exportID;\n    }());\n    \n    console.log(exportID.getUserID());  //23245\n    console.log(exportID._userID);  // undefined\n    \n\n### 三种作用域\n\n    // 作用域： 全局作用域，函数作用域，eval作用域\n    var a = 10;\n    (function() {\n        var b = 20;\n    })();\n    console.log(a);  // 10\n    console.log(b);  // error\n    \n    for(var item in {a: 1, b: 2}) {\n        console.log(item);  // a, b\n    }\n    console.log(item); // b\n    \n\n### ES3中的执行上下文\n\nEC = Execution Context 执行上下文  \n变量对象（Variable Object 简写VO）是一个抽象概念，用于存储执行上下文中的变量，函数声明，函数参数\n\n    var a = 10;\n    function test(x) {\n        var b = 20;\n    }\n    test(30);\n    \n\n对应的上下文\n\n    // 整个js环境中的VO\n    VO(globalContext) = {\n        a: 10,\n        test: <ref to function>\n    };\n    // 执行test(30)的VO\n    VO(test functionContext) = {\n        x: 30,\n        b: 20\n    };\n    \n\n全局执行上下文\n\n    VO(globalContext) === [[global]]\n    [[global]] = {\n        Math : <...>,\n        String : <...>,\n        isNaN: function() {[Native Code]},\n        ...\n        ...\n        window: global\n    };\n    \n    String(10);  //[[global]].String(10)\n    window.a = 10;  // [[global]].window.a = 10\n    this.b = 20;  // [[global]].b = 20\n    \n\n变量初始化阶段\n\n    // 1, 函数参数（若没有传入，则其值为undefined）\n    // 2, 函数声明（若函数声明和函数参数冲突，则函数声明会覆盖掉函数参数）\n    // 3，变量声明（初始化变量值为undefined，若何函数参数，函数声明冲突，会被忽略掉）\n    function test(a, b) {\n        var c = 10;\n        function d() {}\n        var e = function _e() {};\n        (function x() {});\n        b = 20;\n    }\n    test(10);\n    \n    \n    AO(test) = {\n        a: 10,\n        b: undefined,\n        c: undefined,\n        d: <ref to func 'd'>,\n        e: undefined,\n    };\n    \n\n变量初始化案例1\n\n    function foo(x, y, z) {\n        function x() {}\n        console.log(x);\n    }\n    \n    foo(100);  // [Function: x]\n    //\n    AO(foo) = {\n        //x: 100,\n        y: undefined,\n        z: undefined,\n        x: <ref to func 'x'>,  // 函数声明x会覆盖掉参数声明 \n    }\n    \n\n变量初始化案例2\n\n    function foo(x, y, z) {\n        function func() {}\n        var func;\n        console.log(func);\n    }\n    foo(100);  // [Function: func]\n    \n    function foo(x, y, z) {\n        function func() {}\n        var func = 1;\n        console.log(func);\n    }\n    foo(100);  // 1  执行阶段会执行func = 1 这个语句\n    \n\n代码执行阶段\n\n    function test(a, b) {\n        var c = 10;\n        function d() {}\n        var e = function _e() {};\n        (function x() {})();\n        b = 20;\n    }\n    \n    // 初始化阶段\n    AO(test) = {\n        a: 10,\n        b: undefined,\n        c: undefined,\n        d: <ref to func 'd'>,\n        e: undefined\n    };\n    // 代码执行阶段\n    AO(test) = {\n        a: 10,\n        b: 20,\n        c: 10,\n        d: <reference to FunctionDeclaration 'd'>,\n        e: function _e()\n    };\n    \n\n全局执行上下文案例\n\n    console.log(x);  // [Function: x]\n    var x = 10;  // 初始化阶段x: 冲突，被忽略\n    console.log(x);  // 10\n    x = 20;\n    function x() {}  // 初始化阶段x: <ref to func 'x'>\n    console.log(x);  // 20\n    if (true) {\n        var a = 1;  // 初始化阶段a: undefined\n    } else {\n        var b = true;  // 初始化阶段b: undefined\n    }\n    \n    console.log(a);  // 1\n    console.log(b);  // undefined\n    \n\n### prototype\n\nprototype是函数对象上的预设的对象属性  \n原型是对象上的原型，通常都是构造器的prototype属性  \n实例\n\n    function Abc() {\n        this.y = 2;\n        var z = 3;\n    }\n    console.log(Abc);  // [Function: Abc]\n    console.log(Abc.prototype);  // Abc {}\n    console.log(typeof Abc.prototype);  // object\n    \n    Abc.prototype.x = 1;\n    console.log(Abc.prototype);  // Abc { x: 1 }\n    \n    var obj1 = new Abc();\n    console.log(obj1.__proto__);  // Abc { x: 1 }\n    console.log(obj1.__proto__ === Abc.prototype);  // true  new构造器创建的对象的原型是构造器的prototype属性\n    console.log(obj1);  // Abc { y: 2 }\n    console.log(obj1.y);  // 2\n    console.log(obj1.x);  // 1\n    \n\n### 继承\n\n实现继承的方法\n\n    // 实现继承的方法\n    function Person() {\n    }\n    \n    function Student() {\n    }\n    \n    Student.prototype = Person.prototype;  // 错误，会影响被继承类的方法\n    Student.prototype = new Person();  // 错误，传参问题，因为Student是类，并不是实例\n    \n    // 正确的方法\n    Student.prototype = Object.create(Person.prototype);\n    Student.prototype.constructor = Student;\n    // Object.create()是es5的方法，下面是fix方法\n    if(!Object.create) {\n        Object.create = function(proto) {\n            function F() {}\n            F.prototype = proto;\n            return new F;\n        };\n    }\n    \n\n原型的继承方法\n\n    function Person(name, age) {\n        this.name = name;\n        this.age = age;\n        this.sayNo = function() {\n            console.log(this.name + ' say no');\n        }\n    }\n    \n    Person.prototype.hi = function() {\n        console.log('Hi, my name is ' + this.name + ',I\\'m ' + this.age + ' years old now');\n    };\n    Person.prototype.LEGS_NUM = 2;\n    Person.prototype.ARMS_NUM = 2;\n    Person.prototype.walk = function() {\n        console.log(this.name + ' is walking...');\n    };\n    \n    console.log(Person);  // [Function: Person]\n    console.log(Person.prototype);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }\n    var Jack = new Person();  // Person构造器没有return对象，所以返回的是this\n    Jack.sayNo();  // undefined say no\n    Jack.hi();  // Hi, my name is undefined,I'm undefined years old now\n    Jack.walk();  // undefined is walking...\n    console.log(Jack);  // Person { name: undefined, age: undefined, sayNo: [Function] }\n    console.log(Jack.__proto__);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }\n    \n    // 以下5行代码是js中对象继承的写法\n    function Student(name, age, className) {\n        Person.call(this, name, age);  // 使用call方法调用父构造器函数\n        this.className = className;\n    }\n    Student.prototype = Object.create(Person.prototype);   // 这个如果直接使用Student.prototype = Person.prototype，改变Student对象方法会改变Person对象的方法，因为他们指向的是同一个对象\n    Student.prototype.constructor = Student;\n    \n    Student.prototype.hi = function() {\n        console.log('Hi, my name is ' + this.name + ', I\\'m' + this.age + ' years old now, and from ' + this.className + '.');\n    };\n    Student.prototype.learn = function(subject) {\n        console.log(this.name + ' is learning ' + subject + ' at ' + this.className + '.');\n    };\n    \n    var Lussi = new Student('Lussi', 27, 'Class Tree');\n    Lussi.sayNo();  // Lussi say no\n    Lussi.hi();  // Hi, my name is Lussi, I'm27 years old now, and from Class Tree.\n    Lussi.walk();  // Lussi is walking...\n    Lussi.learn('math');  // Lussi is learning math at Class Tree.\n    console.log(Lussi);  // Student {name: 'Lussi', age: 27, sayNo: [Function], className: 'Class Tree' }\n    console.log(Lussi.__proto__);  // Student {constructor: [Function: Student], hi: [Function], learn: [Function] }\n    console.log(Lussi.__proto__.__proto__);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }\n    console.log(Lussi.__proto__.__proto__.__proto__);  // {}\n    console.log(Lussi.__proto__.__proto__.__proto__.__proto__);  // null  \n    // 改变prototype\n    Student.prototype.x = 101;  // 会影响已经创建实例的属性\n    console.log(Jack.x);  // undefined\n    console.log(Lussi.x);  // 101\n    \n    Student.prototype = {y: 2};  // 不会影响已经创建实例的属性，但会影响新创建的实例，并且重新修改prototype.y属性也不会改变\n    console.log(Jack.y); // undefined\n    console.log(Lussi.y);  // undefined\n    var Lilei = new Student('Lilei', 24, 'Class three');\n    console.log(Lilei.x);  // undefined\n    console.log(Lilei.y);  // 2\n    Student.prototype.y = 100;\n    console.log(Lilei.y);  // 100\n    console.log(Lussi.y);  // undefined\n    Student.prototype.z = 30;\n    console.log(Lilei.z);  // 30\n    console.log(Lussi.z);  // undefined\n    Person.prototype.z = 40;\n    console.log(Lilei.z);  // 30\n    console.log(Lussi.z);  // 40\n    console.log(Jack.z);  // 40\n    \n\n### instanceof\n\n    // instanceof  左边是对象（如果不是，直接返回false），右边是构造器（如果不是，直接报错），判断构造器的prototype属性是否在对象的原型链上\n    console.log([1, 2] instanceof Array);  // true\n    console.log(1 instanceof Array);  // false\n    console.log(Array.prototype);  // []\n    console.log(new Object() instanceof Array);  //false\n    console.log(Object.prototype);  // {}\n    console.log(new Object() instanceof Object);  // true\n    console.log(new Array() instanceof Object);  // true\n    \n\n### 模拟重载\n\n    function Person() {\n        var args = arguments;\n        // 判断第一个传入的是不是对象，因为args[null]也返回object，所有需要判断是否为null\n        if(typeof args[0] === 'object' && args[0]) {\n            if(args[0].name) {\n                this.name = args[0].name;\n            }\n            if(args[0].age) {\n                this.age = args[0].age;\n            }\n        } else {\n            if(args[0]) {\n                this.name = args[0];\n            }\n            if(args[1]) {\n                this.age = args[1];\n            }\n        }\n    }\n    Person.prototype.toString = function() {\n        console.log('name=' + this.name + ', age=' + this.age);\n    };\n    \n    var LiLei = new Person('LiLei', 23);\n    var Hanmm = new Person({name: 'Hanmm', age: 21});\n    LiLei.toString();  // name=LiLei, age=23\n    Hanmm.toString();  // name=Hanmm, age=21\n    \n\n### 调用子类方法\n\n    function Person(name) {\n        this.name = name;\n    }\n    function Student(name, className) {\n        this.className = className;\n        Person.call(this, name);\n    }\n    \n    Person.prototype.init = function() {\n        console.log('Person.init');\n    };\n    Student.prototype.init = function() {\n        console.log('Student.init');\n        Person.prototype.init.apply(this, arguments);\n    };\n    var LiLei = new Student('LiLei', 'Class four');\n    console.log(LiLei);  // Student { className: 'Class four', name: 'LiLei' }\n    LiLei.init();  // Student.init  Person.init\n    \n\n### 实现链式调用\n\n    function ClassManager() {\n        console.log('ClassManager');\n        this.name = 'ClassName';\n    }\n    ClassManager.prototype.addClass = function(str) {\n        console.log('class: '  + str + ' added.');\n        console.log(this);\n        return this;  // this始终指向ClassManger类的实例\n    };\n    \n    var manager = new ClassManager();\n    manager.addClass('A').addClass('B').addClass('C');  //class: A added. ClassManager { name: 'ClassName' } class: B added. ClassManager { name: 'ClassName' } class: C added. ClassManager { name: 'ClassName' }","slug":"javascript入门基础","published":1,"updated":"2019-07-24T01:26:26.183Z","layout":"post","photos":[],"link":"","_id":"cjyu0a5sq005d9ka4ivmpr16b","content":"<h3 id=\"数据类型\"><a href=\"#数据类型\" class=\"headerlink\" title=\"数据类型\"></a>数据类型</h3><blockquote>\n<p>object(包含Function，Array，Date等)<br>number<br>string<br>boolean<br>null<br>undefined</p>\n</blockquote>\n<h3 id=\"类型检测\"><a href=\"#类型检测\" class=\"headerlink\" title=\"类型检测\"></a>类型检测</h3><p>typeof 基本类型，function， null可以用===判断</p>\n<pre><code>typeof 100           // &quot;number&quot;   \ntypeof true          // &quot;boolean&quot;    \ntypeof function      // &quot;function&quot;    \ntypeof undefined     // &quot;undefined&quot;  \ntypeof new Object()  // &quot;object&quot;  \ntypeof [1, 2]        // &quot;object&quot;  \ntypeof NaN           // &quot;number&quot;  \ntypeof null          // &quot;object&quot;  </code></pre><p>instanceof</p>\n<pre><code>// 不同window或iframe下返回false\n[1, 2] instanceof Array === true  \nnew Object instanceof Array === fasle</code></pre><p>Object.prototype.toString</p>\n<pre><code>Object.prototype.toString.apply([1, 2, 3]) === &quot;[object Array]&quot;;  \nObject.prototype.toString.apply(function(){}) === &quot;[object Function]&quot;  \nObject.prototype.toString.apply(null) === &quot;[object Null]&quot;  // ie678返回[object Object]  \nObject.prototype.toString.apply(undefined) === &quot;[object Undefined]&quot;  \nObject.prototype.toString.apply(12313) === &quot;[object Number]&quot;  \nObject.prototype.toString.apply(&apos;12313&apos;) === &quot;[object String]&quot;</code></pre><p>constructor<br>duck type</p>\n<h3 id=\"表达式\"><a href=\"#表达式\" class=\"headerlink\" title=\"表达式\"></a>表达式</h3><p>表达式是一种js短语，可使js解释器用来产生一个值</p>\n<pre><code>// 原始表达式\n3.14, &quot;test&quot;      // 常量，直接量\nnull, this, true  // 关键字\ni, j, k;           // 变量\n\n// 复合表达式\n10 * 20;           // 原始表达式+运算符+原始表达式\n\n// 初始化表达式\n[1, 2];\n[1,,2];\n{x: 1, y: 2};\n\n// 函数表达式\nvar fe = function(){};\n(function(){console.log(&apos;1111&apos;);}){};\n\n// 属性访问表达式\nvar o = {x:1};\no.x;\no[&apos;x&apos;];\n\n// 调用表达式\nfunc();\n\n// 对象创建表达式\nnew Func(1, 2);\nnew Object;</code></pre><h3 id=\"运算符\"><a href=\"#运算符\" class=\"headerlink\" title=\"运算符\"></a>运算符</h3><blockquote>\n<p>一元（+num）<br>二元（a + b）<br>三元（c：a：b） 赋值(x += 1)<br>比较(a == b)<br>算术（a - b）<br>位 （a | b）<br>逻辑 (exp1 &amp;&amp; exp2)<br>字符串(“a” + “b”)<br>特殊</p>\n</blockquote>\n<h3 id=\"特殊运算符\"><a href=\"#特殊运算符\" class=\"headerlink\" title=\"特殊运算符\"></a>特殊运算符</h3><blockquote>\n<p>c? a:b<br>var val = (1, 2, 3) // 逗号运算符<br>delete obj.x // 删除对象属性<br>‘x’ in window; // in 运算符<br>instanceof, typeof // 判断类型<br>new Foo(); // new 运算符<br>this // this运算符<br>void 0 // undefined</p>\n</blockquote>\n<h3 id=\"语句\"><a href=\"#语句\" class=\"headerlink\" title=\"语句\"></a>语句</h3><p>块语句block<br>块语句是没有作用域的</p>\n<pre><code>{  \nvar str = &apos;hi&apos;;  \nconsole.log(str);  \n}  </code></pre><p>声明语句 var<br>var a=1, b=1; 函数语句function</p>\n<pre><code>// 函数声明语句  \nfunction fd() {  \n    return true;  \n}    \n// 函数表达式  \nvar fe = function() {\n    //do sth\n};</code></pre><p>for in 语句</p>\n<pre><code>var p;  \nvar obj = {x:1, y:2};  \nfor(p in obj) {\n    // 顺序不确定  \n}</code></pre><p>swith语句</p>\n<pre><code>var val = 2;\nswitch (val) {\n    case 1:\n        console.log(1);\n        break;\n    case 2:\n        console.log(2);\n        break;\n    case 3:\n        console.log(3);\n        break;\n    default:\n        console.log(0);\n        break;\n}</code></pre><p>循环语句</p>\n<pre><code>while (isTrue) {\n    // do sth\n}\n\ndo {\n    // do sth\n} while (isTrue)\n\nvar i;\nfor (i = 0; i &lt; n; i++) {\n    // do sth\n}</code></pre><p>with语句 // 不使用 try catch语句</p>\n<pre><code>try {\n    try {\n        throw new Error(&apos;oops&apos;);\n    } catch(ex) {\n        console.error(&apos;inner catch&apos;, ex.message);\n        throw ex;\n    } finally {\n        console.log(&apos;inner  finally&apos;);\n    }\n} catch(ex) {\n    console.error(&apos;outer catch&apos;, ex.message);\n} finally {\n    console.log(&apos;outer finally&apos;);\n}</code></pre><p>结果 内部catch&gt;内部finally&gt;外部catch&gt;外部finally</p>\n<pre><code>inner catch oops  \ninner  finally  \nouter catch oops  \nouter finally  </code></pre><h3 id=\"严格模式-待补充）\"><a href=\"#严格模式-待补充）\" class=\"headerlink\" title=\"严格模式(待补充）\"></a>严格模式(待补充）</h3><pre><code>function func() {\n    &apos;use strict&apos;;\n}</code></pre><h3 id=\"对象\"><a href=\"#对象\" class=\"headerlink\" title=\"对象\"></a>对象</h3><p>对象创建<br>字面量创建</p>\n<pre><code>var obj = {x: 1};\nconsole.log(obj);\nconsole.log(obj.y);\nObject.prototype.y = 2;\nconsole.log(obj);\nconsole.log(obj.y);\nobj.y = undefined;\nconsole.log(obj);\nconsole.log(obj.y);\n\n\n{ x: 1 }\nundefined\n{ x: 1 }\n2\n{ x: 1, y: undefined }\nundefined</code></pre><p>new构造器创建</p>\n<pre><code>function foo() { this.color = &apos;red&apos;;}\nfoo.prototype.background = &apos;#000&apos;;\nvar redColor = new foo();\nconsole.log(redColor);\nconsole.log(typeof redColor.toString);\nconsole.log(redColor.color);\nconsole.log(redColor.background);\nconsole.log(foo);\nconsole.log(foo.prototype);\nconsole.log(foo.prototype.prototype);\nconsole.log(&apos;background&apos; in redColor);\nredColor.background = &apos;#FFF&apos;;\nconsole.log(redColor.background);\nconsole.log(foo.prototype.background);\n\n\nfoo { color: &apos;red&apos; }\nfunction\nred\n#000\n[Function: foo]\nfoo { background: &apos;#000&apos; }\nundefined\ntrue\n#FFF\n#000</code></pre><p>Object.create()创建</p>\n<pre><code>function obj() {\n    this.x = 1;\n}\nconsole.log(obj);\nvar obj1 = new obj();\nconsole.log(obj1);\nvar obj2 = Object.create(obj);\nconsole.log(obj2);\nconsole.log(obj2.x);\nvar obj3 = Object.create(obj1);\nconsole.log(obj3);\nconsole.log(obj3.x);;\n\n\n[Function: obj]\nobj { x: 1 }\nFunction {}\nundefined\nobj {}\n1</code></pre><h3 id=\"对象的内部原型-proto-和构造器的原型（prototype）的关系。\"><a href=\"#对象的内部原型-proto-和构造器的原型（prototype）的关系。\" class=\"headerlink\" title=\"对象的内部原型(proto)和构造器的原型（prototype）的关系。\"></a>对象的内部原型(<strong>proto</strong>)和构造器的原型（prototype）的关系。</h3><p>一、所有构造器/函数的<strong>proto</strong>都指向Function.prototype，它是一个空函数（Empty function）</p>\n<pre><code>Number.__proto__ === Function.prototype  // true  \nBoolean.__proto__ === Function.prototype // true  \nString.__proto__ === Function.prototype  // true  \nObject.__proto__ === Function.prototype  // true  \nFunction.__proto__ === Function.prototype // true  \nArray.__proto__ === Function.prototype   // true  \nRegExp.__proto__ === Function.prototype  // true  \nError.__proto__ === Function.prototype   // true  \nDate.__proto__ === Function.prototype    // true  \nMath.__proto__ === Object.prototype  // true  \nJSON.__proto__ === Object.prototype  // true \n// 函数声明\nfunction Person() {}\n// 函数表达式\nvar Man = function() {}\nconsole.log(Person.__proto__ === Function.prototype) // true  \nconsole.log(Man.__proto__ === Function.prototype)    // true  </code></pre><p>所有的构造器都来自于Function.prototype，甚至包括根构造器Object及Function自身。所有构造器都继承了Function.prototype的属性及方法。如length、call、apply、bind（ES5）</p>\n<pre><code>console.log(typeof Function.prototype) // function\nconsole.log(typeof Object.prototype)   // object\nconsole.log(typeof Number.prototype)   // object\nconsole.log(typeof Boolean.prototype)  // object\nconsole.log(typeof String.prototype)   // object\nconsole.log(typeof Array.prototype)    // object\nconsole.log(typeof RegExp.prototype)   // object\nconsole.log(typeof Error.prototype)    // object\nconsole.log(typeof Date.prototype)     // object\nconsole.log(typeof Object.prototype)   // object  \nconsole.log(Function.prototype.__proto__ === Object.prototype) // true    \nObject.prototype.__proto__ === null  // true  </code></pre><p>二、所有对象的<strong>proto</strong>都指向其构造器的prototype<br>JavaScript引擎内置构造器</p>\n<pre><code>var obj = {name: &apos;jack&apos;}\nvar arr = [1,2,3]\nvar reg = /hello/g\nvar date = new Date\nvar err = new Error(&apos;exception&apos;)\n\nconsole.log(obj.__proto__ === Object.prototype) // true\nconsole.log(arr.__proto__ === Array.prototype)  // true\nconsole.log(reg.__proto__ === RegExp.prototype) // true\nconsole.log(date.__proto__ === Date.prototype)  // true\nconsole.log(err.__proto__ === Error.prototype)  // true</code></pre><p>自定义的构造器</p>\n<pre><code>function Person(name) {\n    this.name = name\n}\nvar p = new Person(&apos;jack&apos;)\nconsole.log(p.__proto__ === Person.prototype) // true</code></pre><p>每个对象都有一个constructor属性，可以获取它的构造器</p>\n<pre><code>function Person(name) {\n    this.name = name\n}\nvar p = new Person(&apos;jack&apos;)\nconsole.log(p.__proto__ === p.constructor.prototype) // true</code></pre><h3 id=\"对象属性操作\"><a href=\"#对象属性操作\" class=\"headerlink\" title=\"对象属性操作\"></a>对象属性操作</h3><p>属性读写</p>\n<pre><code>// 属性读写\nvar obj = {x1: 1, x2: 2};\nvar i = 1, n = 2;\nfor(; i&lt;= n; i++) {\n    console.log(obj[&apos;x&apos; + i]);\n}\n// 输出1，2\n\nvar p;\nfor(p in obj) {\n    console.log(obj[p]);\n}\n// 输出1，2\n\nvar obj = {x: 1};\n// 读写异常\nconsole.log(obj.y); // undefined\nvar yz = obj.y.z;  // TypeError: Cannot read property &apos;z&apos; of undefined\nobj.y.z = 2;      //TypeError: Cannot set property &apos;z&apos; of undefined\n// 正确方式\nvar yz;\nif(obj.y) {\n    yz = obj.y.z;\n}\n// 或者\nvar yz = obj &amp;&amp; obj.y &amp;&amp; obj.y.z  // 这个会返回undefined</code></pre><p>属性删除</p>\n<pre><code>var person = {age: 28, title: &apos;fe&apos;};\nconsole.log(delete person.age);  // true\nconsole.log(delete person[&apos;age&apos;]);  // true\nconsole.log(person.age);  // undefined\nconsole.log(delete person.age);   // 注意这个也返回true 判断操作结束后该属性是否存在\n\n// 有些属性是不能删除的\nconsole.log(delete Object.prototype);  // false\n\n// 原因\nvar descriptor = Object.getOwnPropertyDescriptor(Object, &apos;prototype&apos;);\nconsole.log(descriptor.configurable);  // false\n\n// 变量及函数不可删除\nvar globalVal = 1;\nconsole.log(delete globalVal);  // false\n\n(function() {\n    var localVal = 1;\n    console.log(delete localVal);\n}());  // false\n\nfunction fd() {}\nconsole.log(delete fd);  // false\n\n(function() {\n    function fd() {};\n    console.log(delete fd);\n}());  // false\n\n\n// 隐示定义的变量可以\nohNo = 1;\nconsole.log(delete ohNo);  // true</code></pre><p>对象属性检测</p>\n<pre><code>var cat = new Object();\ncat.legs = 4;\ncat.name = &apos;Kitty&apos;;\n\nconsole.log(&apos;legs&apos; in cat);  // true\nconsole.log(&apos;abc&apos; in cat);  // false\nconsole.log(&apos;toString&apos; in cat);  // true 继承属性\n\nconsole.log(cat.hasOwnProperty(&apos;legs&apos;));  // true\nconsole.log(cat.hasOwnProperty(&apos;toString&apos;));  // false\n\nconsole.log(cat.propertyIsEnumerable(&apos;legs&apos;));  // true\nconsole.log(cat.propertyIsEnumerable(&apos;toString&apos;));  // false\n\n\nObject.defineProperty(cat, &apos;price&apos;, {enumerable: false, value: 1000});\n// defineProperty是Object的方法，默认的标签enumerable值为false\n// Object.x创建属性，默认的标签值为true\nconsole.log(cat.propertyIsEnumerable(&apos;price&apos;));  // false\nconsole.log(cat.hasOwnProperty(&apos;price&apos;));  // true\n\n\n// 判断属性是否存在\nif(cat &amp;&amp; cat.legs) {\n    cat.legs *= 2;\n}\n\nif(cat.legs != undefined) {\n    // !== undefined 或者 !== null\n}\nif(cat.legs !== undefined) {\n    // !== undefined\n}</code></pre><p>对象属性枚举</p>\n<pre><code>var o = {x: 1, y: 2, z: 3};\nconsole.log(&apos;toString&apos; in o);  // true\no.propertyIsEnumerable(&apos;toString&apos;);  // false\n\nvar key;\nconsole.log(o.x);  // 1\nconsole.log(o.y);  // 2\nconsole.log(o.z);  // 3\nfor(key in o) {\n    console.log(key);  // x, y, z\n    console.log(o.key);  // undefined\n    console.log(o[key]);  // 1, 2, 3\n}\n\n\nvar obj = Object.create(o);\nobj.a = 4;\nvar key;\nfor(key in obj) {\n    console.log(key); // a, x, y, z\n}\nvar key1;\nfor (key1 in obj) {\n    if(obj.hasOwnProperty(key1)) {\n        console.log(key1); // a\n    }\n}</code></pre><p>对象属性的get/set方法</p>\n<pre><code>// 对象属性的get/set方法\nvar man = {\n    name: &apos;Bug&apos;,\n    weibo: &apos;Bug&apos;,\n    get age() {\n        return new Date().getFullYear() - 1988;\n    },\n    set age(val) {\n        console.log(&apos;cannot be set &apos; + val);\n    },\n};\n\nconsole.log(man.age);  // 调用age的get方法27\nman.age = 100;  // 调用age的set方法 cannot be set 100\nconsole.log(man.age);  // 27\n\n\nvar man = {\n    weibo: &apos;Bug&apos;,\n    $age: null,\n    get age() {\n        if(this.$age == undefined) {\n            return new Date().getFullYear() - 1988;\n        } else {\n            return this.$age;\n        }\n    },\n    set age(val) {\n        val = +val; // 转为数字\n        if(!isNaN(val) &amp;&amp; val &gt; 0 &amp;&amp; val &lt; 150) {\n            this.$age = + val;\n        } else {\n            throw new Error(&apos;Incorrect val = &apos; + val );\n        }\n    }\n}\n\nconsole.log(man.age);  // 27\nman.age = 100;\nconsole.log(man.age);  // 100\n//man.age = &apos;abc&apos;;  // Error: Incorrect val = NaN\n\n\n// get/set方法与原型链\n\n// 这是错误的定义对象属性get方法方式\nfunction foo1() {}\nfoo1.prototype.z = {\n    get: function() {\n        return 2;\n    }\n};\nvar obj = new foo1();\nconsole.log(obj.z);  // 这个会被认为是对象 { get: [Function] }\nobj.z = 200;\nconsole.log(obj.z);  // 200\n\n// 正确定义方法\nfunction foo() {}\nObject.defineProperty(foo.prototype, &apos;z&apos;, {\n    get: function() {\n        return 1;\n    },\n    // configurable: true,  // 开启此属于也不会被改变\n    // writable: true,  // 此项不能配置writable/value get/set 二选一\n });\nvar obj = new foo();\nconsole.log(obj.z);   // 1\nobj.z = 100;\nconsole.log(obj.z);  // 但是还是1 并没有被改变\n\nObject.defineProperty(obj, &apos;z&apos;, {\n    value: 100,\n    configurable: true\n});\nconsole.log(obj.z);  // 100\ndelete obj.z;\nconsole.log(obj.z);  // 返回到1\n\n// 另外一个例子\nvar o = {};\nObject.defineProperty(o, &apos;x&apos;, {\n    value: 1\n});  // 默认writable: false, configurable: false\nvar obj = Object.create(o);\nconsole.log(obj.x);  // 1\nobj.x = 100;\nconsole.log(obj.x);  // 还是1\n\n\nObject.defineProperty(obj, &apos;x&apos;, {\n    writable: true,\n    configurable: true,\n    value: 100\n});\nconsole.log(obj.x);  // 100\nobj.x = 200;\nconsole.log(obj.x); // 200</code></pre><h3 id=\"对象属性标签\"><a href=\"#对象属性标签\" class=\"headerlink\" title=\"对象属性标签\"></a>对象属性标签</h3><pre><code>person = {};\nObject.defineProperty(person, &apos;type&apos;, {\n    configurable: false,\n    writable: true,\n    enumerable: false,\n    value: &apos;Object&apos;,\n});\n\nconsole.log(Object.keys(person));   // [] 返回空数组，不能枚举\nconsole.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // { value: &apos;Object&apos;, writable: true, enumerable: false, configurable: false }\n\n\n// writable为true，可以通过赋值方法修改value值 [通过赋值修改属性值只和writable标签有关，和configurable无关]\nperson.type = &apos;Object2&apos;;\nconsole.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));  // { value: &apos;Object2&apos;, writable: true, enumerable: false, configurable: false }\n\n\n// configurable: false 无法使用delete删除属性， 无法使用get/set方法，  无法重新配置属性标签（除了将writable从true修改为false）\nconsole.log(delete person.type);   // 返回false\n\n\n// 只有writable和configurable标签都为false时，不能修改value标签值，其他情况都可以修改value标签值\nObject.defineProperty(person, &apos;type&apos;, {\n    configurable: false,\n    writable: true,\n    enumerable: false,\n    value: &apos;Object1&apos;,\n});\nconsole.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // { value: &apos;Object1&apos;, writable: true, enumerable: false, configurable: false }\n\n\n// 可以重新配置writable标签值(只能重true改为false)\nObject.defineProperty(person, &apos;type&apos;, {\n    writable: false,\n});\nconsole.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // { value: &apos;Object1&apos;, writable: false, enumerable: false, configurable: false }\n\n\n// 无法将writable从false改为true\nObject.defineProperty(person, &apos;type&apos;, {\n    writable: true,\n});\nconsole.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // TypeError: Cannot redefine property: type\n\n\n// 无法重新配置enumerable，configurable属性\nObject.defineProperty(person, &apos;type&apos;, {\n    enumerable: true,\n});\nconsole.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // TypeError: Cannot redefine property: type</code></pre><h3 id=\"对象标签\"><a href=\"#对象标签\" class=\"headerlink\" title=\"对象标签\"></a>对象标签</h3><p>原型标签<strong>proto</strong></p>\n<pre><code>// 原型标签__proto__\n\nfunction Person(name) {\n    this.name = name;\n}\nvar p = new Person(&apos;jack&apos;);\nconsole.log(p.__proto__ === Person.prototype);  // true</code></pre><p>类型标签</p>\n<pre><code>//  对象class标签，表示对象是哪个类型，没有直接的方法去修改或者获取\nvar toString = Object.prototype.toString;\n\nconsole.log(toString.call(null));  // [object Null]\nconsole.log(toString.call(undefined));  // [object Undefined]\nconsole.log(toString.call(1));  // [object Number]\nconsole.log(toString.call(new Number(1)));  // [object Number]\nconsole.log(toString.call(true));  // [object Boolean]\nconsole.log(toString.call(new Boolean(true)));  // [object Boolean]</code></pre><p>可扩展标签</p>\n<pre><code>// extensible 可扩展标签，表示是否可以继续添加对象属性\nvar obj = {x: 1, y: 2};\nconsole.log(Object.isExtensible(obj));  // true 对象可扩展\nObject.preventExtensions(obj);  // 配置对象不可扩展\nconsole.log(Object.isExtensible(obj));  // false 对象不可扩展\nobj.z =1;\nconsole.log(obj.z);  // undefined 添加属性失败\nconsole.log(Object.getOwnPropertyDescriptor(obj, &apos;x&apos;));  // // { value: 1, writable: true, enumerable: true, configurable: true }\n\n\n// Object.seal方法，对象的所有属性configurable值为false\nObject.seal(obj);\nconsole.log(Object.getOwnPropertyDescriptor(obj, &apos;x&apos;));  // { value: 1, writable: true, enumerable: true, configurable: false }\nconsole.log(Object.isSealed(obj)); // true\n\n\n// Object.freeze方法，对象的所有属性configurable，writable标签值为false\nObject.freeze(obj);\nconsole.log(Object.getOwnPropertyDescriptor(obj, &apos;x&apos;));   // // { value: 1, writable: false, enumerable: true, configurable: false }\nconsole.log(Object.isFrozen(obj));  // true</code></pre><h3 id=\"JS对象与json格式转换\"><a href=\"#JS对象与json格式转换\" class=\"headerlink\" title=\"JS对象与json格式转换\"></a>JS对象与json格式转换</h3><pre><code>// 将js对象转为json格式JSON.stringify()\nvar obj = {x: 1, y: true, z: [1, 2, 3], nullVal: null};\nconsole.log(JSON.stringify(obj));  // {&quot;x&quot;:1,&quot;y&quot;:true,&quot;z&quot;:[1,2,3],&quot;nullVal&quot;:null}\n\n// undefined,NaN,Infinity等特殊属性值\nvar obj = {val: undefined, a: NaN, b: Infinity, c: new Date()};\nconsole.log(JSON.stringify(obj));  // {&quot;a&quot;:null,&quot;b&quot;:null,&quot;c&quot;:&quot;2015-12-19T12:30:40.456Z&quot;}\n\n// 将json格式转为js对象JSON.parse\nvar obj = JSON.parse(&apos;{&quot;x&quot;: 1}&apos;);\nconsole.log(obj.x);  // 1\n\n//toJSON方法\nvar obj = {\n    x: 1,\n    y: 2,\n    o: {\n        o1: 1,\n        o2: 2,\n        toJSON: function() {\n            return this.o1 + this.o2;\n        }\n    },\n};\nconsole.log(JSON.stringify(obj));  // {&quot;x&quot;:1,&quot;y&quot;:2,&quot;o&quot;:3}</code></pre><p>###toString valueOf方法</p>\n<pre><code>// 对象在作为操作数时，解释器总是优先调用valueOf()--(Date类型的对象在二元“+”运算时例外),而其他情况，解释器总是认为我们想要的是字符串，所以会优先调用toString()。\nvar obj = {x: 1, y: 2};\nconsole.log(obj.toString());  // [object Object]\nconsole.log(+obj.toString());  // NaN\nconsole.log(3 + obj.toString());  // 3[object Object] 会被理解为字符串拼接\nconsole.log(+obj.valueOf());  // NaN\n\n// 重写\nobj.toString = function() {\n    return this.x + this.y;\n};\nconsole.log(+obj);  // 3\nobj.valueOf = function() {\n    return this.x + this.y + 100;\n};\nconsole.log(+obj);  // 103\n\n// 如果只重写了toString，对象转换时会无视valueOf的存在来进行转换。但是，如果只重写了valueOf方法，在要转换为字符串的时候会优先考虑valueOf方法。在不能调用toString的情况下，只能让valueOf上阵了。\n\nvar cc = {\n    i: 10,\n    valueOf: function() {\n        console.log(&apos;valueOf&apos;);\n        return this.i;\n    }\n};\n\nconsole.log(cc);// 10 { [Number: 10] i: 10, valueOf: [Function] }\nconsole.log(+cc); // 10 valueOf\nconsole.log(&apos;&apos;+cc); // 10 valueOf\nconsole.log(String(cc)); // [object Object]\nconsole.log(Number(cc)); // 10 valueOf\nconsole.log(cc == &apos;10&apos;); // true valueOf</code></pre><h3 id=\"数组\"><a href=\"#数组\" class=\"headerlink\" title=\"数组\"></a>数组</h3><p>创建数组</p>\n<pre><code>// 字面量创建数组 数组的长度不能超过2^23 - 1 = 4,294,967,295\nvar BAT = [&apos;B&apos;, &apos;A&apos;, &apos;T&apos;];\nvar students = [{name: &apos;B&apos;, age: 27}, {name: &apos;A&apos;, age: 30}];\nvar arr = [&apos;T&apos;, 123, true, null, undefined];\nvar arrInArr = [[1, 2], [1, 2, 3]];\n\n// 对象创建数组 new关键字可以省略\nvar arr = new Array();  // var = [];\nvar arrWithLength = new Array(100);  // undefined * 100\nvar arrLikesLiteral = new Array(true, false, null, 1, 2, &apos;hi&apos;);  // [true, false, null, 1, 2, &apos;hi&apos;]</code></pre><p>数组元素操作</p>\n<pre><code>// 数组元素读写\n\n// 索引访问\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr[1]);  // b\nconsole.log(arr.length);  // 5\narr[5] = &apos;f&apos;;\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]\nconsole.log(arr.length);  // 6\n\n// delete方法并不会改变数组长度,delete 和定义为undefined的区别\ndelete arr[0];\nconsole.log(arr);  // [ , &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]\nconsole.log(arr.length);  // 6\nconsole.log(0 in arr);  // 会返回false\narr[1] = undefined;\nconsole.log(arr);  // [ , undefined, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]\nconsole.log(arr.length);  // 6\nconsole.log(1 in arr);  // true\n\n// 数组是动态的，无需指定大小\n\n// 指定索引位置，改变数组\nvar arr = [];\narr[1] = &apos;b&apos;;\nconsole.log(arr.length);  // 2\nconsole.log(arr);   // [ , &apos;b&apos; ]\n\n// push方法，在数组尾部添加元素,并返回新的数组长度\nconsole.log(arr.push(&apos;c&apos;));  // 3\nconsole.log(arr);  // [ , &apos;b&apos;, &apos;c&apos; ]\n\n// 在数组尾部添加的另一种方法\narr[arr.length] = &apos;d&apos;;\nconsole.log(arr);  // [ , &apos;b&apos;, &apos;c&apos;, &apos;d&apos; ]\n\n// unshift方法，在数组头部添加元素，并返回新的数组长度\nconsole.log(arr.unshift(&apos;a&apos;));  // 5\nconsole.log(arr);  // [ &apos;a&apos;, , &apos;b&apos;, &apos;c&apos;, &apos;d&apos; ]\n\n// pop方法，删除数组尾部的元素并返回这个元素\nconsole.log(arr.pop());  // &apos;d&apos;\nconsole.log(arr);  // [ &apos;a&apos;, , &apos;b&apos;, &apos;c&apos; ]\n\n// 删除数组尾部元素的另个方法\narr.length -= 1;\nconsole.log(arr);  // [ &apos;a&apos;, , &apos;b&apos; ]\n\n// shift方法，删除数组头部的元素并返回这个元素\nconsole.log(arr.shift());  // &apos;a&apos;\nconsole.log(arr);  // [ , &apos;b&apos; ]</code></pre><p>数组迭代</p>\n<pre><code>// 数组迭代\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos;];\nfor(var i = 0; i &lt; arr.length; i++) {\n    console.log(arr[i]);\n}\n// a b c d e f g\n\nfor(i in arr) {\n    console.log(arr[i]);\n}\n// a b c d e f g\n\n// for in 表达式的坑：会迭代原型的元素\nArray.prototype.x = &apos;keng&apos;;\nfor(i in arr) {\n    console.log(arr[i]);\n}\n// a b c d e f g keng\n\nfor(i in arr) {\n    if(arr.hasOwnProperty(i)) {\n        console.log(arr[i]);\n    }\n}\n// a b c d e f g</code></pre><p>特殊数组：二维数组和稀疏数组</p>\n<pre><code>// 特殊数组：二维数组，稀疏数组\n// 二维数组\nvar arr = [[&apos;a&apos;, &apos;b&apos;], [&apos;c&apos;, &apos;d&apos;], [&apos;e&apos;, &apos;f&apos;]];\nvar i = 0, j = 0;\nvar row;\nfor(; i &lt; arr.length; i++) {\n    row = arr[i];\n    console.log(&apos;row&apos; + i);\n    for(j = 0; j &lt; row.length; j++) {\n        console.log(row[j]);\n    }\n}\n// row0 a b row1 c d row2 e f\n\n// 稀疏数组：并不含有从0开始的连续索引\nvar arr1 = [undefined];\nvar arr2 = new Array(1);\nconsole.log(0 in arr1);  // true\nconsole.log(0 in arr2);  // false</code></pre><h3 id=\"数组的方法\"><a href=\"#数组的方法\" class=\"headerlink\" title=\"数组的方法\"></a>数组的方法</h3><p>Array.prototype.join(separator)</p>\n<pre><code>// Array.prototype.join(separator)方法：将数组拼接成字符串，返回字符串，不改变原数组\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];\nconsole.log(arr.join());  // a,b,c\nconsole.log(arr.join(&apos;_&apos;));  // a,b,c\nfunction repeatString(str, n) {\n    return new Array(n + 1).join(str);\n}\nconsole.log(repeatString(&apos;a&apos;, 3));  // aaa\nconsole.log(repeatString(&apos;Hi&apos;, 5));  // HiHiHiHiHi</code></pre><p>Array.prototype.reverse()</p>\n<pre><code>// Array.prototype.reverse() 将数组逆序，返回数组本身，会改变数组本身\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];\nvar arr1 = arr;\nvar arr2 = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];\nconsole.log(arr.reverse());  // [ &apos;c&apos;, &apos;b&apos;, &apos;a&apos; ]\nconsole.log(arr);  // [ &apos;c&apos;, &apos;b&apos;, &apos;a&apos; ]\nconsole.log(arr1);  // [ &apos;c&apos;, &apos;b&apos;, &apos;a&apos; ]\nconsole.log(arr2);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos; ]</code></pre><p>Array.prototype.sort(sortby）</p>\n<pre><code>// Array.prototype.sort(sortby)方法：接受一个函数参数(不传参数默认按字符编码顺序)，返回数组本身，会修改原数组\nvar arr = [&apos;f&apos;, &apos;b&apos;, &apos;d&apos;, &apos;e&apos;, &apos;a&apos;];\nconsole.log(arr.sort());  // [ &apos;a&apos;, &apos;b&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]\n\nvar arr = [13, 24, 51, 3];\nconsole.log(arr.sort());  // [ 13, 24, 3, 51 ]\n\n// 传入参数：比较函数(a, b)\n// 若 a 小于 b，在排序后的数组中 a 应该出现在 b 之前，则返回一个小于 0 的值。\n// 若 a 等于 b，则返回 0。\n// 若 a 大于 b，则返回一个大于 0 的值。\nfunction sortNumber(a, b) {\n    return a - b;\n}\nconsole.log(arr.sort(sortNumber));  // [ 3, 13, 24, 51 ]\n\nvar arr = [{age: 25}, {age: 29}, {age: 40}];\nconsole.log(arr.sort(function sortAge(a, b) {\n    return a.age - b.age;\n}));  // [ { age: 25 }, { age: 29 }, { age: 40 } ]</code></pre><p>Array.prototype.concat(arrayX, arrayY…..)</p>\n<pre><code>// Array.prototype.concat(arrayX, arrayY.....)方法 连接多个数组，返回一个新的数组，不会改变原数组\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];\nconsole.log(arr.concat(&apos;d&apos;, &apos;e&apos;));  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos; ]\nconsole.log(arr.concat([&apos;d&apos;, &apos;e&apos;], &apos;f&apos;));  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]\nconsole.log(arr.concat([&apos;d&apos;, &apos;e&apos;], [&apos;f&apos;, &apos;g&apos;]));  // &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos; ]\nconsole.log(arr.concat([[&apos;d&apos;, &apos;e&apos;], &apos;f&apos;]));  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, [ &apos;d&apos;, &apos;e&apos; ], &apos;f&apos; ]\nconsole.log(arr.concat([[[&apos;d&apos;, &apos;e&apos;], &apos;f&apos;], &apos;g&apos;]));  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, [ [ &apos;d&apos;, &apos;e&apos; ], &apos;f&apos; ], &apos;g&apos; ]</code></pre><p>Array.prototype.slice(start, end)</p>\n<pre><code>// Array.prototype.slice(start, end)方法：左闭右开截取数组，返回一个新的数组，不改变原数组\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.slice(1, 3));  // [&apos;b&apos;, &apos;c&apos;]\nconsole.log(arr.slice(1));  // [&apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;]\nconsole.log(arr.slice(1, -1));  // [&apos;b&apos;, &apos;c&apos;, &apos;d&apos;]\nconsole.log(arr.slice(-4, -3));  // [&apos;b&apos;]</code></pre><p>Array.prototype.splice(index, howmany, item1,….itemX)</p>\n<pre><code>// Array.prototype.splice(index, howmany, item1,....itemX)方法：\n// 向/从数组中添加/删除项目，然后返回被删除的项目。会改变原数组\n// index参数：必须，整数，添加或删除的位置，左闭合\n// howmany参数：可选，设置为0，则不会删除\n// item1,.....itemX：可选，向数组中添加的元素\n\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.splice(2));   // [ &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos; ]\n\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.splice(2, 1));  // [ &apos;c&apos; ]\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;d&apos;, &apos;e&apos; ]\n\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.splice(2, 0));  // []\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]\n\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.splice(2, 2, &apos;f&apos;, &apos;g&apos;, [&apos;h&apos;, &apos;i&apos;]));  // [ &apos;c&apos;, &apos;d&apos; ]\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;f&apos;, &apos;g&apos;, [ &apos;h&apos;, &apos;i&apos; ], &apos;e&apos; ]\n\n// 指定位置插入新的元素\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.splice(2, 0, &apos;f&apos;));  // []\nconsole.log(arr); // [ &apos;a&apos;, &apos;b&apos;, &apos;f&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]\n\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.splice());  // []\nconsole.log(arr); // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]</code></pre><p>Array.prototype.forEach()</p>\n<pre><code>// Array.prototype.forEach()方法(ES5)：接收函数参数\n// 函数的3个参数x: 元素值，index：元素索引，a 数组本身\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\narr.forEach(function(x, index, a) {\n    console.log(x + &apos;_&apos; + index + &apos;_&apos; + a);\n});\n// a_0_a,b,c,d,e b_1_a,b,c,d,e c_2_a,b,c,d,e d_3_a,b,c,d,e e_4_a,b,c,d,e</code></pre><p>Array.prototype.map()</p>\n<pre><code>//Array.prototype.map()方法(ES5):接收函数参数,不会修改原数组\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];\nvar arr1 = arr.map(function(x) {\n    return x + &apos;like&apos;;\n});\n\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos; ]\nconsole.log(arr1);  // [ &apos;alike&apos;, &apos;blike&apos;, &apos;clike&apos; ]</code></pre><p>Array.prototype.filter()</p>\n<pre><code>// Array.prototype.filter()过滤方法(ES5):接收函数参数，不修改原数组\nvar arr = [1,2,3,4,5,6,7,8,9,10];\nvar arr1 = arr.filter(function(x, index) {\n    return index % 3 === 0 || x &gt;= 8;\n});\nconsole.log(arr1);  // [ 1, 4, 7, 8, 9, 10 ]\nconsole.log(arr);  // [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ]</code></pre><p>Array.prototype.every() &amp; Array.prototype.some()</p>\n<pre><code>// Array.prototype.every() &amp; Array.prototype.some()判断方法(ES5):接收函数参数，不修改原数组\n// every 全部符合条件  some 只需一个符合条件\nvar arr = [1,2,3,4,5];\nconsole.log(arr.every(function(x) {\n    return x &lt; 10;\n}));  // true\nconsole.log(arr.every(function(x) {\n    return x &lt;= 3;\n}));  // false\nconsole.log(arr.some(function(x) {\n    return x === 3;\n}));  // true\nconsole.log(arr.some(function(x) {\n    return x === 100;\n}));  // false</code></pre><p>Array.prototype.reduce(function, index) Array.prototype.reduceRight(function, index)</p>\n<pre><code>// Array.prototype.reduce(function, index) Array.prototype.reduceRight(function, index)方法\n// 接收一个函数参数和一个数组索引参数，并返回一个值，不修改原数组\n// 函数参加接收2个参数分别代表2个索引\n// 索引参数表示从第index个元素开始\nvar arr = [1, 2, 3];\nvar sum = arr.reduce(function(x, y) {\n    return x + y;\n}, 0);\nconsole.log(sum);  // 6  1+2返回3 3+3 返回6\n\nvar arr = [3, 9, 6];\nvar max = arr.reduce(function(x, y) {\n    console.log(x + &apos;|&apos; + y);\n    return x &gt; y ? x : y;\n});\n// 3|9\n// 9|6\nconsole.log(max);  // 9\n\nvar max = arr.reduceRight(function(x, y) {\n    console.log(x + &apos;|&apos; + y);\n    return x &gt; y ? x : y;\n});\n// 6|9\n// 9|3\nconsole.log(max);  // 9</code></pre><p>Array.prototype.indexOf(value, index) Array.prototype.lastIndexOf(value, index)</p>\n<pre><code>// Array.prototype.indexOf(value, index) Array.prototype.lastIndexOf(value, index)数字检索方法\n// value参数表示要查找的元素值，index表示从第几个索引位置开始查找(闭合)\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;b&apos;, &apos;a&apos;];\nconsole.log(arr.indexOf(&apos;b&apos;));  // 1 在数组中查找是否有元素值为&apos;b&apos;，有则返回这个元素索引\nconsole.log(arr.indexOf(&apos;f&apos;));  // -1 如果没有则返回-1\nconsole.log(arr.indexOf(&apos;b&apos;, 1));  // 1 从第2个元素开始查找，返回索引1\nconsole.log(arr.indexOf(&apos;b&apos;, 2));  // 3\nconsole.log(arr.indexOf(&apos;b&apos;, -2));  // 3\nconsole.log(arr.indexOf(&apos;b&apos;, -4));  // 1\nconsole.log(arr.indexOf(&apos;b&apos;, -8));  // 1\nconsole.log(arr.lastIndexOf(&apos;b&apos;));  // 3</code></pre><p>Array.isArray()</p>\n<pre><code>// Array.isArray() 判断是否为数组\nconsole.log(Array.isArray([]));  // true</code></pre><h3 id=\"创建函数\"><a href=\"#创建函数\" class=\"headerlink\" title=\"创建函数\"></a>创建函数</h3><pre><code>// 函数声明\nfunction add(a, b) {\n    a = +a;\n    b = +b;\n    if (isNaN(a) || isNaN(b)) {\n        return;\n    }\n    return a + b;\n}\n\n// 函数表达式\nvar add = function(a, b) {\n    // do sth\n};\n\n// IEF(立即执行函数表达式)\n(function() {\n    // do sth\n})();\n\n// 函数表达式\nreturn function () {\n    // do sth\n};\n\n// NFE(命名式函数表达式)\nvar add = function foo(a, b) {\n    // do sth\n};</code></pre><p><strong>函数声明和函数表达式区别：函数声明会前置</strong></p>\n<pre><code>var num = add(1, 2);\nconsole.log(num);\n\nfunction add(a, b) {\n    a = +a;\n    b = +b;\n    if (isNaN(a) || isNaN(b)) {\n        return;\n    }\n    return a + b;\n}\n\n// 结果为3\n\n\nvar num = add(1, 2);\nconsole.log(num);\n\nvar add = function (a, b) {\n    a = +a;\n    b = +b;\n    if (isNaN(a) || isNaN(b)) {\n        return;\n    }\n    return a + b;\n};\n\n// TypeError: add is not a function</code></pre><h3 id=\"this\"><a href=\"#this\" class=\"headerlink\" title=\"this\"></a>this</h3><p>全局下的this</p>\n<pre><code>// 全局下的this(浏览器下)\nconsole.log(this.window === document);  // true\nconsole.log(this === window);  // true\nthis.a = 37;\nconsole.log(window.a);  // 37</code></pre><p>一般函数的this</p>\n<pre><code>// 一般函数的this（浏览器下）\nfunction f1() {\n    return this;\n}\nf1() === window;  // true\n\nfunction f2() {\n    &quot;use strict&quot;;  // 严格模式下\n    return this\n}\nf2() === undefined;  // true</code></pre><p>作为对象方法的函数的this</p>\n<pre><code>var o = {\n    prop: 37,\n    f: function() {\n        return this.prop;\n    }\n};\nconsole.log(o.f());  // 37\n\nvar o = {prop: 37};\nfunction  independent() {\n    return this.prop;\n}\no.f = independent;\nconsole.log(o.f());  // 37</code></pre><p>原型链上的this</p>\n<pre><code>var o = {\n    f: function() {\n        return this.a + this.b;\n    }\n};\nvar p = Object.create(o); // p为空对象，其原型会指向o\np.a = 1;\np.b = 4;\nconsole.log(p.f())  // 5</code></pre><p>构造器中的this</p>\n<pre><code>// 当new的函数构造器没有return返回值或者返回值不是对象时，new返回一个this指向构造器的prototype这样一个空对象\n// 如果return返回的是对象 new返回的这是这个对象\nfunction Myclass() {\n    this.a = 37;\n}\nvar o = new Myclass();\nconsole.log(o.a);  // 37\n\nfunction C2() {\n    this.a = 37;\n    return {a: 38};\n}\no = new C2();\nconsole.log(o.a);  // 38</code></pre><p>call和apply的this</p>\n<pre><code>function add(c, d) {\n    return this.a + this.b + c + d;\n}\nvar o = {a: 1, b: 2};\nadd.call(o, 5, 6);  // 1+3+5+7=16\nadd.apply(o, [10, 20]);  //1+3+10+20=34\n\nfunction bar() {\n    console.log(Object.prototype.toString.call(this));\n}\nbar.call(7); // [object Number]</code></pre><p>band和this</p>\n<pre><code>//bind是es5后，ie9+使用\nfunction f() {\n    return this.a;\n}\nvar g = f.bind({a: &apos;test&apos;});\nconsole.log(g());  // test\nvar o = {\n    a: 37,\n    f: f,\n    g: g\n};\nconsole.log(o.f(), o.g());  // 37, test</code></pre><p>函数arguments属性</p>\n<pre><code>function foo(x, y, z) {\n    arguments.length;  // 2 实际传入的参数数量\n    arguments[0];  // 1 传入第一个参数值\n    arguments[0] = 10;\n    x;  // 10 将第一个参数值修改为10， 严格模式下任然是1\n    arguments[2] = 100;\n    z; // undefined  由于第三个参数没有传入，不会绑定\n    arguments.callee  === foo;  // true   严格模式下不能使用\n}\n\nfoo(1, 2);\nfoo.length;  // 3   3个参数\nfoo.name;  // &quot;foo&quot; 函数名</code></pre><h3 id=\"call和apply\"><a href=\"#call和apply\" class=\"headerlink\" title=\"call和apply\"></a>call和apply</h3><pre><code>// apply和call方法（浏览器）\n// 第一个参数是作为this的对象，如果不是对象，会转换为对象\n// call传入的是扁平传入参数\n// apply第二个参数树数组\nfunction foo(x, y) {\n    console.log(x, y, this);\n}\n\nfoo.call(100, 1, 2);  // 1, 2, Number(100)\nfoo.apply(true, [3, 4]);  //3, 4, Boolean(true)\nfoo.apply(null);  // undefined, undefined, window\nfoo.apply(undefined);  // undefined, undefined, window</code></pre><h3 id=\"bind\"><a href=\"#bind\" class=\"headerlink\" title=\"bind\"></a>bind</h3><p>bind方法：改变this</p>\n<pre><code>// bind方法\nthis.x = 9;\nvar module = {\n    x: 81,\n    getX: function() {\n        return this.x;\n    }\n};\n\nmodule.getX();  // 81 this指向module\n\nvar getX = module.getX;\ngetX();  // 9 this指向全局变量\n\nvar boundGetX = getX.bind(module);\nboundGetX();  // 81  bind改变this指向</code></pre><p>bind方法：科里化</p>\n<pre><code>// bind方法\nfunction add(a, b, c) {\n    return a+b+c;\n}\n\nvar func = add.bind(undefined, 100);\nfunc(1, 2);  // 103  undefined传给this， 100传给第一个参数a\n\nvar func2 = func.bind(undefined, 200);\nfunc2(10);  // 310 undefined传给this，200传给b</code></pre><p>bind与new</p>\n<pre><code>// bind方法与new\nfunction foo() {\n    this.b = 100;\n    return this.a;\n}\n\nvar func = foo.bind({a: 1});\n\nfunc(); // 1  foo.bind后this指向{a: 1} return this.a = 1\nnew func();  // {b: 100} new调用将返回一个this，this会被初始化一个空对象，并且其原型是foo.prototype,空对象的b属性为100</code></pre><h3 id=\"闭包\"><a href=\"#闭包\" class=\"headerlink\" title=\"闭包\"></a>闭包</h3><p>闭包基本概念</p>\n<pre><code>// 闭包\nvar n = 999;\nfunction f1() {\n    console.log(n);\n}\nf1();  // 999  函数内部可以访问全局变量\n\nfunction f1() {\n    var n = 999;\n}\nconsole.log(n);  // error  函数外部无法访问函数内部局部变量\n\nfunction f1() {\n    n = 999;\n}\nconsole.log(n); // 999 因为没有使用var语句，相当于定义一个全局变量\n\n\n// 简单的闭包原型\nfunction f1() {\n    var n = 999;\n    function f2() {\n        console.log(n);\n    }\n    return f2\n}\nvar result = f1();\nresult();  // 999</code></pre><p>闭包案例</p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=&quot;en&quot;&gt;\n&lt;head&gt;\n    &lt;meta charset=&quot;UTF-8&quot;&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    &lt;style&gt;\n        #div1 {\n            background-color: rosybrown;\n        }\n        #div2 {\n            background-color: aquamarine;\n        }\n        #div3 {\n            background-color: yellowgreen;\n        }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;/body&gt;\n&lt;script&gt;\n    document.body.innerHTML = &apos;&lt;div id=&quot;div1&quot;&gt;aaa&lt;/div&gt;&lt;div id=&quot;div2&quot;&gt;bbb&lt;/div&gt;&lt;div id=&quot;div3&quot;&gt;ccc&lt;/div&gt;&apos;;\n    for(var i = 1; i &lt; 4; i++) {\n        alert(i);  // 结果为1，2，3\n        document.getElementById(&apos;div&apos; + i).\n                addEventListener(&apos;click&apos;, function() {\n            alert(i);  // 点击div1，div2，div3结果都是4,因为addEventListener的回调函数执行时i都为4\n        });\n    }\n&lt;/script&gt;\n&lt;/html&gt;</code></pre><p>正确写法</p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=&quot;en&quot;&gt;\n&lt;head&gt;\n    &lt;meta charset=&quot;UTF-8&quot;&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    &lt;style&gt;\n        #div1 {\n            background-color: rosybrown;\n        }\n        #div2 {\n            background-color: aquamarine;\n        }\n        #div3 {\n            background-color: yellowgreen;\n        }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;/body&gt;\n&lt;script&gt;\n    document.body.innerHTML = &apos;&lt;div id=&quot;div1&quot;&gt;aaa&lt;/div&gt;&lt;div id=&quot;div2&quot;&gt;bbb&lt;/div&gt;&lt;div id=&quot;div3&quot;&gt;ccc&lt;/div&gt;&apos;;\n    for(var i = 1; i &lt; 4; i++) {\n        !function(i) {\n            alert(i);  // 1,2,3\n            document.getElementById(&apos;div&apos; + i).\n               addEventListener(&apos;click&apos;, function() {\n                   alert(i);  // 1, 2,3 \n            });\n        }(i);\n    }\n&lt;/script&gt;\n&lt;/html&gt;</code></pre><p>闭包中的封装</p>\n<pre><code>(function() {\n    var _userID = 23245;\n    var _typeID = &apos;item&apos;;\n    var exportID = {};\n\n    function converter(userID) {\n        return +userID;\n    }\n\n    exportID.getUserID = function() {\n        return converter(_userID);\n    };\n\n    exportID.getTypeID = function() {\n        return _typeID;\n    };\n    global.exportID = exportID;\n}());\n\nconsole.log(exportID.getUserID());  //23245\nconsole.log(exportID._userID);  // undefined</code></pre><h3 id=\"三种作用域\"><a href=\"#三种作用域\" class=\"headerlink\" title=\"三种作用域\"></a>三种作用域</h3><pre><code>// 作用域： 全局作用域，函数作用域，eval作用域\nvar a = 10;\n(function() {\n    var b = 20;\n})();\nconsole.log(a);  // 10\nconsole.log(b);  // error\n\nfor(var item in {a: 1, b: 2}) {\n    console.log(item);  // a, b\n}\nconsole.log(item); // b</code></pre><h3 id=\"ES3中的执行上下文\"><a href=\"#ES3中的执行上下文\" class=\"headerlink\" title=\"ES3中的执行上下文\"></a>ES3中的执行上下文</h3><p>EC = Execution Context 执行上下文<br>变量对象（Variable Object 简写VO）是一个抽象概念，用于存储执行上下文中的变量，函数声明，函数参数</p>\n<pre><code>var a = 10;\nfunction test(x) {\n    var b = 20;\n}\ntest(30);</code></pre><p>对应的上下文</p>\n<pre><code>// 整个js环境中的VO\nVO(globalContext) = {\n    a: 10,\n    test: &lt;ref to function&gt;\n};\n// 执行test(30)的VO\nVO(test functionContext) = {\n    x: 30,\n    b: 20\n};</code></pre><p>全局执行上下文</p>\n<pre><code>VO(globalContext) === [[global]]\n[[global]] = {\n    Math : &lt;...&gt;,\n    String : &lt;...&gt;,\n    isNaN: function() {[Native Code]},\n    ...\n    ...\n    window: global\n};\n\nString(10);  //[[global]].String(10)\nwindow.a = 10;  // [[global]].window.a = 10\nthis.b = 20;  // [[global]].b = 20</code></pre><p>变量初始化阶段</p>\n<pre><code>// 1, 函数参数（若没有传入，则其值为undefined）\n// 2, 函数声明（若函数声明和函数参数冲突，则函数声明会覆盖掉函数参数）\n// 3，变量声明（初始化变量值为undefined，若何函数参数，函数声明冲突，会被忽略掉）\nfunction test(a, b) {\n    var c = 10;\n    function d() {}\n    var e = function _e() {};\n    (function x() {});\n    b = 20;\n}\ntest(10);\n\n\nAO(test) = {\n    a: 10,\n    b: undefined,\n    c: undefined,\n    d: &lt;ref to func &apos;d&apos;&gt;,\n    e: undefined,\n};</code></pre><p>变量初始化案例1</p>\n<pre><code>function foo(x, y, z) {\n    function x() {}\n    console.log(x);\n}\n\nfoo(100);  // [Function: x]\n//\nAO(foo) = {\n    //x: 100,\n    y: undefined,\n    z: undefined,\n    x: &lt;ref to func &apos;x&apos;&gt;,  // 函数声明x会覆盖掉参数声明 \n}</code></pre><p>变量初始化案例2</p>\n<pre><code>function foo(x, y, z) {\n    function func() {}\n    var func;\n    console.log(func);\n}\nfoo(100);  // [Function: func]\n\nfunction foo(x, y, z) {\n    function func() {}\n    var func = 1;\n    console.log(func);\n}\nfoo(100);  // 1  执行阶段会执行func = 1 这个语句</code></pre><p>代码执行阶段</p>\n<pre><code>function test(a, b) {\n    var c = 10;\n    function d() {}\n    var e = function _e() {};\n    (function x() {})();\n    b = 20;\n}\n\n// 初始化阶段\nAO(test) = {\n    a: 10,\n    b: undefined,\n    c: undefined,\n    d: &lt;ref to func &apos;d&apos;&gt;,\n    e: undefined\n};\n// 代码执行阶段\nAO(test) = {\n    a: 10,\n    b: 20,\n    c: 10,\n    d: &lt;reference to FunctionDeclaration &apos;d&apos;&gt;,\n    e: function _e()\n};</code></pre><p>全局执行上下文案例</p>\n<pre><code>console.log(x);  // [Function: x]\nvar x = 10;  // 初始化阶段x: 冲突，被忽略\nconsole.log(x);  // 10\nx = 20;\nfunction x() {}  // 初始化阶段x: &lt;ref to func &apos;x&apos;&gt;\nconsole.log(x);  // 20\nif (true) {\n    var a = 1;  // 初始化阶段a: undefined\n} else {\n    var b = true;  // 初始化阶段b: undefined\n}\n\nconsole.log(a);  // 1\nconsole.log(b);  // undefined</code></pre><h3 id=\"prototype\"><a href=\"#prototype\" class=\"headerlink\" title=\"prototype\"></a>prototype</h3><p>prototype是函数对象上的预设的对象属性<br>原型是对象上的原型，通常都是构造器的prototype属性<br>实例</p>\n<pre><code>function Abc() {\n    this.y = 2;\n    var z = 3;\n}\nconsole.log(Abc);  // [Function: Abc]\nconsole.log(Abc.prototype);  // Abc {}\nconsole.log(typeof Abc.prototype);  // object\n\nAbc.prototype.x = 1;\nconsole.log(Abc.prototype);  // Abc { x: 1 }\n\nvar obj1 = new Abc();\nconsole.log(obj1.__proto__);  // Abc { x: 1 }\nconsole.log(obj1.__proto__ === Abc.prototype);  // true  new构造器创建的对象的原型是构造器的prototype属性\nconsole.log(obj1);  // Abc { y: 2 }\nconsole.log(obj1.y);  // 2\nconsole.log(obj1.x);  // 1</code></pre><h3 id=\"继承\"><a href=\"#继承\" class=\"headerlink\" title=\"继承\"></a>继承</h3><p>实现继承的方法</p>\n<pre><code>// 实现继承的方法\nfunction Person() {\n}\n\nfunction Student() {\n}\n\nStudent.prototype = Person.prototype;  // 错误，会影响被继承类的方法\nStudent.prototype = new Person();  // 错误，传参问题，因为Student是类，并不是实例\n\n// 正确的方法\nStudent.prototype = Object.create(Person.prototype);\nStudent.prototype.constructor = Student;\n// Object.create()是es5的方法，下面是fix方法\nif(!Object.create) {\n    Object.create = function(proto) {\n        function F() {}\n        F.prototype = proto;\n        return new F;\n    };\n}</code></pre><p>原型的继承方法</p>\n<pre><code>function Person(name, age) {\n    this.name = name;\n    this.age = age;\n    this.sayNo = function() {\n        console.log(this.name + &apos; say no&apos;);\n    }\n}\n\nPerson.prototype.hi = function() {\n    console.log(&apos;Hi, my name is &apos; + this.name + &apos;,I\\&apos;m &apos; + this.age + &apos; years old now&apos;);\n};\nPerson.prototype.LEGS_NUM = 2;\nPerson.prototype.ARMS_NUM = 2;\nPerson.prototype.walk = function() {\n    console.log(this.name + &apos; is walking...&apos;);\n};\n\nconsole.log(Person);  // [Function: Person]\nconsole.log(Person.prototype);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }\nvar Jack = new Person();  // Person构造器没有return对象，所以返回的是this\nJack.sayNo();  // undefined say no\nJack.hi();  // Hi, my name is undefined,I&apos;m undefined years old now\nJack.walk();  // undefined is walking...\nconsole.log(Jack);  // Person { name: undefined, age: undefined, sayNo: [Function] }\nconsole.log(Jack.__proto__);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }\n\n// 以下5行代码是js中对象继承的写法\nfunction Student(name, age, className) {\n    Person.call(this, name, age);  // 使用call方法调用父构造器函数\n    this.className = className;\n}\nStudent.prototype = Object.create(Person.prototype);   // 这个如果直接使用Student.prototype = Person.prototype，改变Student对象方法会改变Person对象的方法，因为他们指向的是同一个对象\nStudent.prototype.constructor = Student;\n\nStudent.prototype.hi = function() {\n    console.log(&apos;Hi, my name is &apos; + this.name + &apos;, I\\&apos;m&apos; + this.age + &apos; years old now, and from &apos; + this.className + &apos;.&apos;);\n};\nStudent.prototype.learn = function(subject) {\n    console.log(this.name + &apos; is learning &apos; + subject + &apos; at &apos; + this.className + &apos;.&apos;);\n};\n\nvar Lussi = new Student(&apos;Lussi&apos;, 27, &apos;Class Tree&apos;);\nLussi.sayNo();  // Lussi say no\nLussi.hi();  // Hi, my name is Lussi, I&apos;m27 years old now, and from Class Tree.\nLussi.walk();  // Lussi is walking...\nLussi.learn(&apos;math&apos;);  // Lussi is learning math at Class Tree.\nconsole.log(Lussi);  // Student {name: &apos;Lussi&apos;, age: 27, sayNo: [Function], className: &apos;Class Tree&apos; }\nconsole.log(Lussi.__proto__);  // Student {constructor: [Function: Student], hi: [Function], learn: [Function] }\nconsole.log(Lussi.__proto__.__proto__);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }\nconsole.log(Lussi.__proto__.__proto__.__proto__);  // {}\nconsole.log(Lussi.__proto__.__proto__.__proto__.__proto__);  // null  \n// 改变prototype\nStudent.prototype.x = 101;  // 会影响已经创建实例的属性\nconsole.log(Jack.x);  // undefined\nconsole.log(Lussi.x);  // 101\n\nStudent.prototype = {y: 2};  // 不会影响已经创建实例的属性，但会影响新创建的实例，并且重新修改prototype.y属性也不会改变\nconsole.log(Jack.y); // undefined\nconsole.log(Lussi.y);  // undefined\nvar Lilei = new Student(&apos;Lilei&apos;, 24, &apos;Class three&apos;);\nconsole.log(Lilei.x);  // undefined\nconsole.log(Lilei.y);  // 2\nStudent.prototype.y = 100;\nconsole.log(Lilei.y);  // 100\nconsole.log(Lussi.y);  // undefined\nStudent.prototype.z = 30;\nconsole.log(Lilei.z);  // 30\nconsole.log(Lussi.z);  // undefined\nPerson.prototype.z = 40;\nconsole.log(Lilei.z);  // 30\nconsole.log(Lussi.z);  // 40\nconsole.log(Jack.z);  // 40</code></pre><h3 id=\"instanceof\"><a href=\"#instanceof\" class=\"headerlink\" title=\"instanceof\"></a>instanceof</h3><pre><code>// instanceof  左边是对象（如果不是，直接返回false），右边是构造器（如果不是，直接报错），判断构造器的prototype属性是否在对象的原型链上\nconsole.log([1, 2] instanceof Array);  // true\nconsole.log(1 instanceof Array);  // false\nconsole.log(Array.prototype);  // []\nconsole.log(new Object() instanceof Array);  //false\nconsole.log(Object.prototype);  // {}\nconsole.log(new Object() instanceof Object);  // true\nconsole.log(new Array() instanceof Object);  // true</code></pre><h3 id=\"模拟重载\"><a href=\"#模拟重载\" class=\"headerlink\" title=\"模拟重载\"></a>模拟重载</h3><pre><code>function Person() {\n    var args = arguments;\n    // 判断第一个传入的是不是对象，因为args[null]也返回object，所有需要判断是否为null\n    if(typeof args[0] === &apos;object&apos; &amp;&amp; args[0]) {\n        if(args[0].name) {\n            this.name = args[0].name;\n        }\n        if(args[0].age) {\n            this.age = args[0].age;\n        }\n    } else {\n        if(args[0]) {\n            this.name = args[0];\n        }\n        if(args[1]) {\n            this.age = args[1];\n        }\n    }\n}\nPerson.prototype.toString = function() {\n    console.log(&apos;name=&apos; + this.name + &apos;, age=&apos; + this.age);\n};\n\nvar LiLei = new Person(&apos;LiLei&apos;, 23);\nvar Hanmm = new Person({name: &apos;Hanmm&apos;, age: 21});\nLiLei.toString();  // name=LiLei, age=23\nHanmm.toString();  // name=Hanmm, age=21</code></pre><h3 id=\"调用子类方法\"><a href=\"#调用子类方法\" class=\"headerlink\" title=\"调用子类方法\"></a>调用子类方法</h3><pre><code>function Person(name) {\n    this.name = name;\n}\nfunction Student(name, className) {\n    this.className = className;\n    Person.call(this, name);\n}\n\nPerson.prototype.init = function() {\n    console.log(&apos;Person.init&apos;);\n};\nStudent.prototype.init = function() {\n    console.log(&apos;Student.init&apos;);\n    Person.prototype.init.apply(this, arguments);\n};\nvar LiLei = new Student(&apos;LiLei&apos;, &apos;Class four&apos;);\nconsole.log(LiLei);  // Student { className: &apos;Class four&apos;, name: &apos;LiLei&apos; }\nLiLei.init();  // Student.init  Person.init</code></pre><h3 id=\"实现链式调用\"><a href=\"#实现链式调用\" class=\"headerlink\" title=\"实现链式调用\"></a>实现链式调用</h3><pre><code>function ClassManager() {\n    console.log(&apos;ClassManager&apos;);\n    this.name = &apos;ClassName&apos;;\n}\nClassManager.prototype.addClass = function(str) {\n    console.log(&apos;class: &apos;  + str + &apos; added.&apos;);\n    console.log(this);\n    return this;  // this始终指向ClassManger类的实例\n};\n\nvar manager = new ClassManager();\nmanager.addClass(&apos;A&apos;).addClass(&apos;B&apos;).addClass(&apos;C&apos;);  //class: A added. ClassManager { name: &apos;ClassName&apos; } class: B added. ClassManager { name: &apos;ClassName&apos; } class: C added. ClassManager { name: &apos;ClassName&apos; }</code></pre>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"数据类型\"><a href=\"#数据类型\" class=\"headerlink\" title=\"数据类型\"></a>数据类型</h3><blockquote>\n<p>object(包含Function，Array，Date等)<br>number<br>string<br>boolean<br>null<br>undefined</p>\n</blockquote>\n<h3 id=\"类型检测\"><a href=\"#类型检测\" class=\"headerlink\" title=\"类型检测\"></a>类型检测</h3><p>typeof 基本类型，function， null可以用===判断</p>\n<pre><code>typeof 100           // &quot;number&quot;   \ntypeof true          // &quot;boolean&quot;    \ntypeof function      // &quot;function&quot;    \ntypeof undefined     // &quot;undefined&quot;  \ntypeof new Object()  // &quot;object&quot;  \ntypeof [1, 2]        // &quot;object&quot;  \ntypeof NaN           // &quot;number&quot;  \ntypeof null          // &quot;object&quot;  </code></pre><p>instanceof</p>\n<pre><code>// 不同window或iframe下返回false\n[1, 2] instanceof Array === true  \nnew Object instanceof Array === fasle</code></pre><p>Object.prototype.toString</p>\n<pre><code>Object.prototype.toString.apply([1, 2, 3]) === &quot;[object Array]&quot;;  \nObject.prototype.toString.apply(function(){}) === &quot;[object Function]&quot;  \nObject.prototype.toString.apply(null) === &quot;[object Null]&quot;  // ie678返回[object Object]  \nObject.prototype.toString.apply(undefined) === &quot;[object Undefined]&quot;  \nObject.prototype.toString.apply(12313) === &quot;[object Number]&quot;  \nObject.prototype.toString.apply(&apos;12313&apos;) === &quot;[object String]&quot;</code></pre><p>constructor<br>duck type</p>\n<h3 id=\"表达式\"><a href=\"#表达式\" class=\"headerlink\" title=\"表达式\"></a>表达式</h3><p>表达式是一种js短语，可使js解释器用来产生一个值</p>\n<pre><code>// 原始表达式\n3.14, &quot;test&quot;      // 常量，直接量\nnull, this, true  // 关键字\ni, j, k;           // 变量\n\n// 复合表达式\n10 * 20;           // 原始表达式+运算符+原始表达式\n\n// 初始化表达式\n[1, 2];\n[1,,2];\n{x: 1, y: 2};\n\n// 函数表达式\nvar fe = function(){};\n(function(){console.log(&apos;1111&apos;);}){};\n\n// 属性访问表达式\nvar o = {x:1};\no.x;\no[&apos;x&apos;];\n\n// 调用表达式\nfunc();\n\n// 对象创建表达式\nnew Func(1, 2);\nnew Object;</code></pre><h3 id=\"运算符\"><a href=\"#运算符\" class=\"headerlink\" title=\"运算符\"></a>运算符</h3><blockquote>\n<p>一元（+num）<br>二元（a + b）<br>三元（c：a：b） 赋值(x += 1)<br>比较(a == b)<br>算术（a - b）<br>位 （a | b）<br>逻辑 (exp1 &amp;&amp; exp2)<br>字符串(“a” + “b”)<br>特殊</p>\n</blockquote>\n<h3 id=\"特殊运算符\"><a href=\"#特殊运算符\" class=\"headerlink\" title=\"特殊运算符\"></a>特殊运算符</h3><blockquote>\n<p>c? a:b<br>var val = (1, 2, 3) // 逗号运算符<br>delete obj.x // 删除对象属性<br>‘x’ in window; // in 运算符<br>instanceof, typeof // 判断类型<br>new Foo(); // new 运算符<br>this // this运算符<br>void 0 // undefined</p>\n</blockquote>\n<h3 id=\"语句\"><a href=\"#语句\" class=\"headerlink\" title=\"语句\"></a>语句</h3><p>块语句block<br>块语句是没有作用域的</p>\n<pre><code>{  \nvar str = &apos;hi&apos;;  \nconsole.log(str);  \n}  </code></pre><p>声明语句 var<br>var a=1, b=1; 函数语句function</p>\n<pre><code>// 函数声明语句  \nfunction fd() {  \n    return true;  \n}    \n// 函数表达式  \nvar fe = function() {\n    //do sth\n};</code></pre><p>for in 语句</p>\n<pre><code>var p;  \nvar obj = {x:1, y:2};  \nfor(p in obj) {\n    // 顺序不确定  \n}</code></pre><p>swith语句</p>\n<pre><code>var val = 2;\nswitch (val) {\n    case 1:\n        console.log(1);\n        break;\n    case 2:\n        console.log(2);\n        break;\n    case 3:\n        console.log(3);\n        break;\n    default:\n        console.log(0);\n        break;\n}</code></pre><p>循环语句</p>\n<pre><code>while (isTrue) {\n    // do sth\n}\n\ndo {\n    // do sth\n} while (isTrue)\n\nvar i;\nfor (i = 0; i &lt; n; i++) {\n    // do sth\n}</code></pre><p>with语句 // 不使用 try catch语句</p>\n<pre><code>try {\n    try {\n        throw new Error(&apos;oops&apos;);\n    } catch(ex) {\n        console.error(&apos;inner catch&apos;, ex.message);\n        throw ex;\n    } finally {\n        console.log(&apos;inner  finally&apos;);\n    }\n} catch(ex) {\n    console.error(&apos;outer catch&apos;, ex.message);\n} finally {\n    console.log(&apos;outer finally&apos;);\n}</code></pre><p>结果 内部catch&gt;内部finally&gt;外部catch&gt;外部finally</p>\n<pre><code>inner catch oops  \ninner  finally  \nouter catch oops  \nouter finally  </code></pre><h3 id=\"严格模式-待补充）\"><a href=\"#严格模式-待补充）\" class=\"headerlink\" title=\"严格模式(待补充）\"></a>严格模式(待补充）</h3><pre><code>function func() {\n    &apos;use strict&apos;;\n}</code></pre><h3 id=\"对象\"><a href=\"#对象\" class=\"headerlink\" title=\"对象\"></a>对象</h3><p>对象创建<br>字面量创建</p>\n<pre><code>var obj = {x: 1};\nconsole.log(obj);\nconsole.log(obj.y);\nObject.prototype.y = 2;\nconsole.log(obj);\nconsole.log(obj.y);\nobj.y = undefined;\nconsole.log(obj);\nconsole.log(obj.y);\n\n\n{ x: 1 }\nundefined\n{ x: 1 }\n2\n{ x: 1, y: undefined }\nundefined</code></pre><p>new构造器创建</p>\n<pre><code>function foo() { this.color = &apos;red&apos;;}\nfoo.prototype.background = &apos;#000&apos;;\nvar redColor = new foo();\nconsole.log(redColor);\nconsole.log(typeof redColor.toString);\nconsole.log(redColor.color);\nconsole.log(redColor.background);\nconsole.log(foo);\nconsole.log(foo.prototype);\nconsole.log(foo.prototype.prototype);\nconsole.log(&apos;background&apos; in redColor);\nredColor.background = &apos;#FFF&apos;;\nconsole.log(redColor.background);\nconsole.log(foo.prototype.background);\n\n\nfoo { color: &apos;red&apos; }\nfunction\nred\n#000\n[Function: foo]\nfoo { background: &apos;#000&apos; }\nundefined\ntrue\n#FFF\n#000</code></pre><p>Object.create()创建</p>\n<pre><code>function obj() {\n    this.x = 1;\n}\nconsole.log(obj);\nvar obj1 = new obj();\nconsole.log(obj1);\nvar obj2 = Object.create(obj);\nconsole.log(obj2);\nconsole.log(obj2.x);\nvar obj3 = Object.create(obj1);\nconsole.log(obj3);\nconsole.log(obj3.x);;\n\n\n[Function: obj]\nobj { x: 1 }\nFunction {}\nundefined\nobj {}\n1</code></pre><h3 id=\"对象的内部原型-proto-和构造器的原型（prototype）的关系。\"><a href=\"#对象的内部原型-proto-和构造器的原型（prototype）的关系。\" class=\"headerlink\" title=\"对象的内部原型(proto)和构造器的原型（prototype）的关系。\"></a>对象的内部原型(<strong>proto</strong>)和构造器的原型（prototype）的关系。</h3><p>一、所有构造器/函数的<strong>proto</strong>都指向Function.prototype，它是一个空函数（Empty function）</p>\n<pre><code>Number.__proto__ === Function.prototype  // true  \nBoolean.__proto__ === Function.prototype // true  \nString.__proto__ === Function.prototype  // true  \nObject.__proto__ === Function.prototype  // true  \nFunction.__proto__ === Function.prototype // true  \nArray.__proto__ === Function.prototype   // true  \nRegExp.__proto__ === Function.prototype  // true  \nError.__proto__ === Function.prototype   // true  \nDate.__proto__ === Function.prototype    // true  \nMath.__proto__ === Object.prototype  // true  \nJSON.__proto__ === Object.prototype  // true \n// 函数声明\nfunction Person() {}\n// 函数表达式\nvar Man = function() {}\nconsole.log(Person.__proto__ === Function.prototype) // true  \nconsole.log(Man.__proto__ === Function.prototype)    // true  </code></pre><p>所有的构造器都来自于Function.prototype，甚至包括根构造器Object及Function自身。所有构造器都继承了Function.prototype的属性及方法。如length、call、apply、bind（ES5）</p>\n<pre><code>console.log(typeof Function.prototype) // function\nconsole.log(typeof Object.prototype)   // object\nconsole.log(typeof Number.prototype)   // object\nconsole.log(typeof Boolean.prototype)  // object\nconsole.log(typeof String.prototype)   // object\nconsole.log(typeof Array.prototype)    // object\nconsole.log(typeof RegExp.prototype)   // object\nconsole.log(typeof Error.prototype)    // object\nconsole.log(typeof Date.prototype)     // object\nconsole.log(typeof Object.prototype)   // object  \nconsole.log(Function.prototype.__proto__ === Object.prototype) // true    \nObject.prototype.__proto__ === null  // true  </code></pre><p>二、所有对象的<strong>proto</strong>都指向其构造器的prototype<br>JavaScript引擎内置构造器</p>\n<pre><code>var obj = {name: &apos;jack&apos;}\nvar arr = [1,2,3]\nvar reg = /hello/g\nvar date = new Date\nvar err = new Error(&apos;exception&apos;)\n\nconsole.log(obj.__proto__ === Object.prototype) // true\nconsole.log(arr.__proto__ === Array.prototype)  // true\nconsole.log(reg.__proto__ === RegExp.prototype) // true\nconsole.log(date.__proto__ === Date.prototype)  // true\nconsole.log(err.__proto__ === Error.prototype)  // true</code></pre><p>自定义的构造器</p>\n<pre><code>function Person(name) {\n    this.name = name\n}\nvar p = new Person(&apos;jack&apos;)\nconsole.log(p.__proto__ === Person.prototype) // true</code></pre><p>每个对象都有一个constructor属性，可以获取它的构造器</p>\n<pre><code>function Person(name) {\n    this.name = name\n}\nvar p = new Person(&apos;jack&apos;)\nconsole.log(p.__proto__ === p.constructor.prototype) // true</code></pre><h3 id=\"对象属性操作\"><a href=\"#对象属性操作\" class=\"headerlink\" title=\"对象属性操作\"></a>对象属性操作</h3><p>属性读写</p>\n<pre><code>// 属性读写\nvar obj = {x1: 1, x2: 2};\nvar i = 1, n = 2;\nfor(; i&lt;= n; i++) {\n    console.log(obj[&apos;x&apos; + i]);\n}\n// 输出1，2\n\nvar p;\nfor(p in obj) {\n    console.log(obj[p]);\n}\n// 输出1，2\n\nvar obj = {x: 1};\n// 读写异常\nconsole.log(obj.y); // undefined\nvar yz = obj.y.z;  // TypeError: Cannot read property &apos;z&apos; of undefined\nobj.y.z = 2;      //TypeError: Cannot set property &apos;z&apos; of undefined\n// 正确方式\nvar yz;\nif(obj.y) {\n    yz = obj.y.z;\n}\n// 或者\nvar yz = obj &amp;&amp; obj.y &amp;&amp; obj.y.z  // 这个会返回undefined</code></pre><p>属性删除</p>\n<pre><code>var person = {age: 28, title: &apos;fe&apos;};\nconsole.log(delete person.age);  // true\nconsole.log(delete person[&apos;age&apos;]);  // true\nconsole.log(person.age);  // undefined\nconsole.log(delete person.age);   // 注意这个也返回true 判断操作结束后该属性是否存在\n\n// 有些属性是不能删除的\nconsole.log(delete Object.prototype);  // false\n\n// 原因\nvar descriptor = Object.getOwnPropertyDescriptor(Object, &apos;prototype&apos;);\nconsole.log(descriptor.configurable);  // false\n\n// 变量及函数不可删除\nvar globalVal = 1;\nconsole.log(delete globalVal);  // false\n\n(function() {\n    var localVal = 1;\n    console.log(delete localVal);\n}());  // false\n\nfunction fd() {}\nconsole.log(delete fd);  // false\n\n(function() {\n    function fd() {};\n    console.log(delete fd);\n}());  // false\n\n\n// 隐示定义的变量可以\nohNo = 1;\nconsole.log(delete ohNo);  // true</code></pre><p>对象属性检测</p>\n<pre><code>var cat = new Object();\ncat.legs = 4;\ncat.name = &apos;Kitty&apos;;\n\nconsole.log(&apos;legs&apos; in cat);  // true\nconsole.log(&apos;abc&apos; in cat);  // false\nconsole.log(&apos;toString&apos; in cat);  // true 继承属性\n\nconsole.log(cat.hasOwnProperty(&apos;legs&apos;));  // true\nconsole.log(cat.hasOwnProperty(&apos;toString&apos;));  // false\n\nconsole.log(cat.propertyIsEnumerable(&apos;legs&apos;));  // true\nconsole.log(cat.propertyIsEnumerable(&apos;toString&apos;));  // false\n\n\nObject.defineProperty(cat, &apos;price&apos;, {enumerable: false, value: 1000});\n// defineProperty是Object的方法，默认的标签enumerable值为false\n// Object.x创建属性，默认的标签值为true\nconsole.log(cat.propertyIsEnumerable(&apos;price&apos;));  // false\nconsole.log(cat.hasOwnProperty(&apos;price&apos;));  // true\n\n\n// 判断属性是否存在\nif(cat &amp;&amp; cat.legs) {\n    cat.legs *= 2;\n}\n\nif(cat.legs != undefined) {\n    // !== undefined 或者 !== null\n}\nif(cat.legs !== undefined) {\n    // !== undefined\n}</code></pre><p>对象属性枚举</p>\n<pre><code>var o = {x: 1, y: 2, z: 3};\nconsole.log(&apos;toString&apos; in o);  // true\no.propertyIsEnumerable(&apos;toString&apos;);  // false\n\nvar key;\nconsole.log(o.x);  // 1\nconsole.log(o.y);  // 2\nconsole.log(o.z);  // 3\nfor(key in o) {\n    console.log(key);  // x, y, z\n    console.log(o.key);  // undefined\n    console.log(o[key]);  // 1, 2, 3\n}\n\n\nvar obj = Object.create(o);\nobj.a = 4;\nvar key;\nfor(key in obj) {\n    console.log(key); // a, x, y, z\n}\nvar key1;\nfor (key1 in obj) {\n    if(obj.hasOwnProperty(key1)) {\n        console.log(key1); // a\n    }\n}</code></pre><p>对象属性的get/set方法</p>\n<pre><code>// 对象属性的get/set方法\nvar man = {\n    name: &apos;Bug&apos;,\n    weibo: &apos;Bug&apos;,\n    get age() {\n        return new Date().getFullYear() - 1988;\n    },\n    set age(val) {\n        console.log(&apos;cannot be set &apos; + val);\n    },\n};\n\nconsole.log(man.age);  // 调用age的get方法27\nman.age = 100;  // 调用age的set方法 cannot be set 100\nconsole.log(man.age);  // 27\n\n\nvar man = {\n    weibo: &apos;Bug&apos;,\n    $age: null,\n    get age() {\n        if(this.$age == undefined) {\n            return new Date().getFullYear() - 1988;\n        } else {\n            return this.$age;\n        }\n    },\n    set age(val) {\n        val = +val; // 转为数字\n        if(!isNaN(val) &amp;&amp; val &gt; 0 &amp;&amp; val &lt; 150) {\n            this.$age = + val;\n        } else {\n            throw new Error(&apos;Incorrect val = &apos; + val );\n        }\n    }\n}\n\nconsole.log(man.age);  // 27\nman.age = 100;\nconsole.log(man.age);  // 100\n//man.age = &apos;abc&apos;;  // Error: Incorrect val = NaN\n\n\n// get/set方法与原型链\n\n// 这是错误的定义对象属性get方法方式\nfunction foo1() {}\nfoo1.prototype.z = {\n    get: function() {\n        return 2;\n    }\n};\nvar obj = new foo1();\nconsole.log(obj.z);  // 这个会被认为是对象 { get: [Function] }\nobj.z = 200;\nconsole.log(obj.z);  // 200\n\n// 正确定义方法\nfunction foo() {}\nObject.defineProperty(foo.prototype, &apos;z&apos;, {\n    get: function() {\n        return 1;\n    },\n    // configurable: true,  // 开启此属于也不会被改变\n    // writable: true,  // 此项不能配置writable/value get/set 二选一\n });\nvar obj = new foo();\nconsole.log(obj.z);   // 1\nobj.z = 100;\nconsole.log(obj.z);  // 但是还是1 并没有被改变\n\nObject.defineProperty(obj, &apos;z&apos;, {\n    value: 100,\n    configurable: true\n});\nconsole.log(obj.z);  // 100\ndelete obj.z;\nconsole.log(obj.z);  // 返回到1\n\n// 另外一个例子\nvar o = {};\nObject.defineProperty(o, &apos;x&apos;, {\n    value: 1\n});  // 默认writable: false, configurable: false\nvar obj = Object.create(o);\nconsole.log(obj.x);  // 1\nobj.x = 100;\nconsole.log(obj.x);  // 还是1\n\n\nObject.defineProperty(obj, &apos;x&apos;, {\n    writable: true,\n    configurable: true,\n    value: 100\n});\nconsole.log(obj.x);  // 100\nobj.x = 200;\nconsole.log(obj.x); // 200</code></pre><h3 id=\"对象属性标签\"><a href=\"#对象属性标签\" class=\"headerlink\" title=\"对象属性标签\"></a>对象属性标签</h3><pre><code>person = {};\nObject.defineProperty(person, &apos;type&apos;, {\n    configurable: false,\n    writable: true,\n    enumerable: false,\n    value: &apos;Object&apos;,\n});\n\nconsole.log(Object.keys(person));   // [] 返回空数组，不能枚举\nconsole.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // { value: &apos;Object&apos;, writable: true, enumerable: false, configurable: false }\n\n\n// writable为true，可以通过赋值方法修改value值 [通过赋值修改属性值只和writable标签有关，和configurable无关]\nperson.type = &apos;Object2&apos;;\nconsole.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));  // { value: &apos;Object2&apos;, writable: true, enumerable: false, configurable: false }\n\n\n// configurable: false 无法使用delete删除属性， 无法使用get/set方法，  无法重新配置属性标签（除了将writable从true修改为false）\nconsole.log(delete person.type);   // 返回false\n\n\n// 只有writable和configurable标签都为false时，不能修改value标签值，其他情况都可以修改value标签值\nObject.defineProperty(person, &apos;type&apos;, {\n    configurable: false,\n    writable: true,\n    enumerable: false,\n    value: &apos;Object1&apos;,\n});\nconsole.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // { value: &apos;Object1&apos;, writable: true, enumerable: false, configurable: false }\n\n\n// 可以重新配置writable标签值(只能重true改为false)\nObject.defineProperty(person, &apos;type&apos;, {\n    writable: false,\n});\nconsole.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // { value: &apos;Object1&apos;, writable: false, enumerable: false, configurable: false }\n\n\n// 无法将writable从false改为true\nObject.defineProperty(person, &apos;type&apos;, {\n    writable: true,\n});\nconsole.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // TypeError: Cannot redefine property: type\n\n\n// 无法重新配置enumerable，configurable属性\nObject.defineProperty(person, &apos;type&apos;, {\n    enumerable: true,\n});\nconsole.log(Object.getOwnPropertyDescriptor(person, &apos;type&apos;));   // TypeError: Cannot redefine property: type</code></pre><h3 id=\"对象标签\"><a href=\"#对象标签\" class=\"headerlink\" title=\"对象标签\"></a>对象标签</h3><p>原型标签<strong>proto</strong></p>\n<pre><code>// 原型标签__proto__\n\nfunction Person(name) {\n    this.name = name;\n}\nvar p = new Person(&apos;jack&apos;);\nconsole.log(p.__proto__ === Person.prototype);  // true</code></pre><p>类型标签</p>\n<pre><code>//  对象class标签，表示对象是哪个类型，没有直接的方法去修改或者获取\nvar toString = Object.prototype.toString;\n\nconsole.log(toString.call(null));  // [object Null]\nconsole.log(toString.call(undefined));  // [object Undefined]\nconsole.log(toString.call(1));  // [object Number]\nconsole.log(toString.call(new Number(1)));  // [object Number]\nconsole.log(toString.call(true));  // [object Boolean]\nconsole.log(toString.call(new Boolean(true)));  // [object Boolean]</code></pre><p>可扩展标签</p>\n<pre><code>// extensible 可扩展标签，表示是否可以继续添加对象属性\nvar obj = {x: 1, y: 2};\nconsole.log(Object.isExtensible(obj));  // true 对象可扩展\nObject.preventExtensions(obj);  // 配置对象不可扩展\nconsole.log(Object.isExtensible(obj));  // false 对象不可扩展\nobj.z =1;\nconsole.log(obj.z);  // undefined 添加属性失败\nconsole.log(Object.getOwnPropertyDescriptor(obj, &apos;x&apos;));  // // { value: 1, writable: true, enumerable: true, configurable: true }\n\n\n// Object.seal方法，对象的所有属性configurable值为false\nObject.seal(obj);\nconsole.log(Object.getOwnPropertyDescriptor(obj, &apos;x&apos;));  // { value: 1, writable: true, enumerable: true, configurable: false }\nconsole.log(Object.isSealed(obj)); // true\n\n\n// Object.freeze方法，对象的所有属性configurable，writable标签值为false\nObject.freeze(obj);\nconsole.log(Object.getOwnPropertyDescriptor(obj, &apos;x&apos;));   // // { value: 1, writable: false, enumerable: true, configurable: false }\nconsole.log(Object.isFrozen(obj));  // true</code></pre><h3 id=\"JS对象与json格式转换\"><a href=\"#JS对象与json格式转换\" class=\"headerlink\" title=\"JS对象与json格式转换\"></a>JS对象与json格式转换</h3><pre><code>// 将js对象转为json格式JSON.stringify()\nvar obj = {x: 1, y: true, z: [1, 2, 3], nullVal: null};\nconsole.log(JSON.stringify(obj));  // {&quot;x&quot;:1,&quot;y&quot;:true,&quot;z&quot;:[1,2,3],&quot;nullVal&quot;:null}\n\n// undefined,NaN,Infinity等特殊属性值\nvar obj = {val: undefined, a: NaN, b: Infinity, c: new Date()};\nconsole.log(JSON.stringify(obj));  // {&quot;a&quot;:null,&quot;b&quot;:null,&quot;c&quot;:&quot;2015-12-19T12:30:40.456Z&quot;}\n\n// 将json格式转为js对象JSON.parse\nvar obj = JSON.parse(&apos;{&quot;x&quot;: 1}&apos;);\nconsole.log(obj.x);  // 1\n\n//toJSON方法\nvar obj = {\n    x: 1,\n    y: 2,\n    o: {\n        o1: 1,\n        o2: 2,\n        toJSON: function() {\n            return this.o1 + this.o2;\n        }\n    },\n};\nconsole.log(JSON.stringify(obj));  // {&quot;x&quot;:1,&quot;y&quot;:2,&quot;o&quot;:3}</code></pre><p>###toString valueOf方法</p>\n<pre><code>// 对象在作为操作数时，解释器总是优先调用valueOf()--(Date类型的对象在二元“+”运算时例外),而其他情况，解释器总是认为我们想要的是字符串，所以会优先调用toString()。\nvar obj = {x: 1, y: 2};\nconsole.log(obj.toString());  // [object Object]\nconsole.log(+obj.toString());  // NaN\nconsole.log(3 + obj.toString());  // 3[object Object] 会被理解为字符串拼接\nconsole.log(+obj.valueOf());  // NaN\n\n// 重写\nobj.toString = function() {\n    return this.x + this.y;\n};\nconsole.log(+obj);  // 3\nobj.valueOf = function() {\n    return this.x + this.y + 100;\n};\nconsole.log(+obj);  // 103\n\n// 如果只重写了toString，对象转换时会无视valueOf的存在来进行转换。但是，如果只重写了valueOf方法，在要转换为字符串的时候会优先考虑valueOf方法。在不能调用toString的情况下，只能让valueOf上阵了。\n\nvar cc = {\n    i: 10,\n    valueOf: function() {\n        console.log(&apos;valueOf&apos;);\n        return this.i;\n    }\n};\n\nconsole.log(cc);// 10 { [Number: 10] i: 10, valueOf: [Function] }\nconsole.log(+cc); // 10 valueOf\nconsole.log(&apos;&apos;+cc); // 10 valueOf\nconsole.log(String(cc)); // [object Object]\nconsole.log(Number(cc)); // 10 valueOf\nconsole.log(cc == &apos;10&apos;); // true valueOf</code></pre><h3 id=\"数组\"><a href=\"#数组\" class=\"headerlink\" title=\"数组\"></a>数组</h3><p>创建数组</p>\n<pre><code>// 字面量创建数组 数组的长度不能超过2^23 - 1 = 4,294,967,295\nvar BAT = [&apos;B&apos;, &apos;A&apos;, &apos;T&apos;];\nvar students = [{name: &apos;B&apos;, age: 27}, {name: &apos;A&apos;, age: 30}];\nvar arr = [&apos;T&apos;, 123, true, null, undefined];\nvar arrInArr = [[1, 2], [1, 2, 3]];\n\n// 对象创建数组 new关键字可以省略\nvar arr = new Array();  // var = [];\nvar arrWithLength = new Array(100);  // undefined * 100\nvar arrLikesLiteral = new Array(true, false, null, 1, 2, &apos;hi&apos;);  // [true, false, null, 1, 2, &apos;hi&apos;]</code></pre><p>数组元素操作</p>\n<pre><code>// 数组元素读写\n\n// 索引访问\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr[1]);  // b\nconsole.log(arr.length);  // 5\narr[5] = &apos;f&apos;;\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]\nconsole.log(arr.length);  // 6\n\n// delete方法并不会改变数组长度,delete 和定义为undefined的区别\ndelete arr[0];\nconsole.log(arr);  // [ , &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]\nconsole.log(arr.length);  // 6\nconsole.log(0 in arr);  // 会返回false\narr[1] = undefined;\nconsole.log(arr);  // [ , undefined, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]\nconsole.log(arr.length);  // 6\nconsole.log(1 in arr);  // true\n\n// 数组是动态的，无需指定大小\n\n// 指定索引位置，改变数组\nvar arr = [];\narr[1] = &apos;b&apos;;\nconsole.log(arr.length);  // 2\nconsole.log(arr);   // [ , &apos;b&apos; ]\n\n// push方法，在数组尾部添加元素,并返回新的数组长度\nconsole.log(arr.push(&apos;c&apos;));  // 3\nconsole.log(arr);  // [ , &apos;b&apos;, &apos;c&apos; ]\n\n// 在数组尾部添加的另一种方法\narr[arr.length] = &apos;d&apos;;\nconsole.log(arr);  // [ , &apos;b&apos;, &apos;c&apos;, &apos;d&apos; ]\n\n// unshift方法，在数组头部添加元素，并返回新的数组长度\nconsole.log(arr.unshift(&apos;a&apos;));  // 5\nconsole.log(arr);  // [ &apos;a&apos;, , &apos;b&apos;, &apos;c&apos;, &apos;d&apos; ]\n\n// pop方法，删除数组尾部的元素并返回这个元素\nconsole.log(arr.pop());  // &apos;d&apos;\nconsole.log(arr);  // [ &apos;a&apos;, , &apos;b&apos;, &apos;c&apos; ]\n\n// 删除数组尾部元素的另个方法\narr.length -= 1;\nconsole.log(arr);  // [ &apos;a&apos;, , &apos;b&apos; ]\n\n// shift方法，删除数组头部的元素并返回这个元素\nconsole.log(arr.shift());  // &apos;a&apos;\nconsole.log(arr);  // [ , &apos;b&apos; ]</code></pre><p>数组迭代</p>\n<pre><code>// 数组迭代\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos;];\nfor(var i = 0; i &lt; arr.length; i++) {\n    console.log(arr[i]);\n}\n// a b c d e f g\n\nfor(i in arr) {\n    console.log(arr[i]);\n}\n// a b c d e f g\n\n// for in 表达式的坑：会迭代原型的元素\nArray.prototype.x = &apos;keng&apos;;\nfor(i in arr) {\n    console.log(arr[i]);\n}\n// a b c d e f g keng\n\nfor(i in arr) {\n    if(arr.hasOwnProperty(i)) {\n        console.log(arr[i]);\n    }\n}\n// a b c d e f g</code></pre><p>特殊数组：二维数组和稀疏数组</p>\n<pre><code>// 特殊数组：二维数组，稀疏数组\n// 二维数组\nvar arr = [[&apos;a&apos;, &apos;b&apos;], [&apos;c&apos;, &apos;d&apos;], [&apos;e&apos;, &apos;f&apos;]];\nvar i = 0, j = 0;\nvar row;\nfor(; i &lt; arr.length; i++) {\n    row = arr[i];\n    console.log(&apos;row&apos; + i);\n    for(j = 0; j &lt; row.length; j++) {\n        console.log(row[j]);\n    }\n}\n// row0 a b row1 c d row2 e f\n\n// 稀疏数组：并不含有从0开始的连续索引\nvar arr1 = [undefined];\nvar arr2 = new Array(1);\nconsole.log(0 in arr1);  // true\nconsole.log(0 in arr2);  // false</code></pre><h3 id=\"数组的方法\"><a href=\"#数组的方法\" class=\"headerlink\" title=\"数组的方法\"></a>数组的方法</h3><p>Array.prototype.join(separator)</p>\n<pre><code>// Array.prototype.join(separator)方法：将数组拼接成字符串，返回字符串，不改变原数组\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];\nconsole.log(arr.join());  // a,b,c\nconsole.log(arr.join(&apos;_&apos;));  // a,b,c\nfunction repeatString(str, n) {\n    return new Array(n + 1).join(str);\n}\nconsole.log(repeatString(&apos;a&apos;, 3));  // aaa\nconsole.log(repeatString(&apos;Hi&apos;, 5));  // HiHiHiHiHi</code></pre><p>Array.prototype.reverse()</p>\n<pre><code>// Array.prototype.reverse() 将数组逆序，返回数组本身，会改变数组本身\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];\nvar arr1 = arr;\nvar arr2 = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];\nconsole.log(arr.reverse());  // [ &apos;c&apos;, &apos;b&apos;, &apos;a&apos; ]\nconsole.log(arr);  // [ &apos;c&apos;, &apos;b&apos;, &apos;a&apos; ]\nconsole.log(arr1);  // [ &apos;c&apos;, &apos;b&apos;, &apos;a&apos; ]\nconsole.log(arr2);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos; ]</code></pre><p>Array.prototype.sort(sortby）</p>\n<pre><code>// Array.prototype.sort(sortby)方法：接受一个函数参数(不传参数默认按字符编码顺序)，返回数组本身，会修改原数组\nvar arr = [&apos;f&apos;, &apos;b&apos;, &apos;d&apos;, &apos;e&apos;, &apos;a&apos;];\nconsole.log(arr.sort());  // [ &apos;a&apos;, &apos;b&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]\n\nvar arr = [13, 24, 51, 3];\nconsole.log(arr.sort());  // [ 13, 24, 3, 51 ]\n\n// 传入参数：比较函数(a, b)\n// 若 a 小于 b，在排序后的数组中 a 应该出现在 b 之前，则返回一个小于 0 的值。\n// 若 a 等于 b，则返回 0。\n// 若 a 大于 b，则返回一个大于 0 的值。\nfunction sortNumber(a, b) {\n    return a - b;\n}\nconsole.log(arr.sort(sortNumber));  // [ 3, 13, 24, 51 ]\n\nvar arr = [{age: 25}, {age: 29}, {age: 40}];\nconsole.log(arr.sort(function sortAge(a, b) {\n    return a.age - b.age;\n}));  // [ { age: 25 }, { age: 29 }, { age: 40 } ]</code></pre><p>Array.prototype.concat(arrayX, arrayY…..)</p>\n<pre><code>// Array.prototype.concat(arrayX, arrayY.....)方法 连接多个数组，返回一个新的数组，不会改变原数组\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];\nconsole.log(arr.concat(&apos;d&apos;, &apos;e&apos;));  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos; ]\nconsole.log(arr.concat([&apos;d&apos;, &apos;e&apos;], &apos;f&apos;));  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos; ]\nconsole.log(arr.concat([&apos;d&apos;, &apos;e&apos;], [&apos;f&apos;, &apos;g&apos;]));  // &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;, &apos;f&apos;, &apos;g&apos; ]\nconsole.log(arr.concat([[&apos;d&apos;, &apos;e&apos;], &apos;f&apos;]));  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, [ &apos;d&apos;, &apos;e&apos; ], &apos;f&apos; ]\nconsole.log(arr.concat([[[&apos;d&apos;, &apos;e&apos;], &apos;f&apos;], &apos;g&apos;]));  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, [ [ &apos;d&apos;, &apos;e&apos; ], &apos;f&apos; ], &apos;g&apos; ]</code></pre><p>Array.prototype.slice(start, end)</p>\n<pre><code>// Array.prototype.slice(start, end)方法：左闭右开截取数组，返回一个新的数组，不改变原数组\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.slice(1, 3));  // [&apos;b&apos;, &apos;c&apos;]\nconsole.log(arr.slice(1));  // [&apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;]\nconsole.log(arr.slice(1, -1));  // [&apos;b&apos;, &apos;c&apos;, &apos;d&apos;]\nconsole.log(arr.slice(-4, -3));  // [&apos;b&apos;]</code></pre><p>Array.prototype.splice(index, howmany, item1,….itemX)</p>\n<pre><code>// Array.prototype.splice(index, howmany, item1,....itemX)方法：\n// 向/从数组中添加/删除项目，然后返回被删除的项目。会改变原数组\n// index参数：必须，整数，添加或删除的位置，左闭合\n// howmany参数：可选，设置为0，则不会删除\n// item1,.....itemX：可选，向数组中添加的元素\n\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.splice(2));   // [ &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos; ]\n\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.splice(2, 1));  // [ &apos;c&apos; ]\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;d&apos;, &apos;e&apos; ]\n\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.splice(2, 0));  // []\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]\n\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.splice(2, 2, &apos;f&apos;, &apos;g&apos;, [&apos;h&apos;, &apos;i&apos;]));  // [ &apos;c&apos;, &apos;d&apos; ]\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;f&apos;, &apos;g&apos;, [ &apos;h&apos;, &apos;i&apos; ], &apos;e&apos; ]\n\n// 指定位置插入新的元素\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.splice(2, 0, &apos;f&apos;));  // []\nconsole.log(arr); // [ &apos;a&apos;, &apos;b&apos;, &apos;f&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]\n\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\nconsole.log(arr.splice());  // []\nconsole.log(arr); // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos; ]</code></pre><p>Array.prototype.forEach()</p>\n<pre><code>// Array.prototype.forEach()方法(ES5)：接收函数参数\n// 函数的3个参数x: 元素值，index：元素索引，a 数组本身\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;, &apos;e&apos;];\narr.forEach(function(x, index, a) {\n    console.log(x + &apos;_&apos; + index + &apos;_&apos; + a);\n});\n// a_0_a,b,c,d,e b_1_a,b,c,d,e c_2_a,b,c,d,e d_3_a,b,c,d,e e_4_a,b,c,d,e</code></pre><p>Array.prototype.map()</p>\n<pre><code>//Array.prototype.map()方法(ES5):接收函数参数,不会修改原数组\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;];\nvar arr1 = arr.map(function(x) {\n    return x + &apos;like&apos;;\n});\n\nconsole.log(arr);  // [ &apos;a&apos;, &apos;b&apos;, &apos;c&apos; ]\nconsole.log(arr1);  // [ &apos;alike&apos;, &apos;blike&apos;, &apos;clike&apos; ]</code></pre><p>Array.prototype.filter()</p>\n<pre><code>// Array.prototype.filter()过滤方法(ES5):接收函数参数，不修改原数组\nvar arr = [1,2,3,4,5,6,7,8,9,10];\nvar arr1 = arr.filter(function(x, index) {\n    return index % 3 === 0 || x &gt;= 8;\n});\nconsole.log(arr1);  // [ 1, 4, 7, 8, 9, 10 ]\nconsole.log(arr);  // [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ]</code></pre><p>Array.prototype.every() &amp; Array.prototype.some()</p>\n<pre><code>// Array.prototype.every() &amp; Array.prototype.some()判断方法(ES5):接收函数参数，不修改原数组\n// every 全部符合条件  some 只需一个符合条件\nvar arr = [1,2,3,4,5];\nconsole.log(arr.every(function(x) {\n    return x &lt; 10;\n}));  // true\nconsole.log(arr.every(function(x) {\n    return x &lt;= 3;\n}));  // false\nconsole.log(arr.some(function(x) {\n    return x === 3;\n}));  // true\nconsole.log(arr.some(function(x) {\n    return x === 100;\n}));  // false</code></pre><p>Array.prototype.reduce(function, index) Array.prototype.reduceRight(function, index)</p>\n<pre><code>// Array.prototype.reduce(function, index) Array.prototype.reduceRight(function, index)方法\n// 接收一个函数参数和一个数组索引参数，并返回一个值，不修改原数组\n// 函数参加接收2个参数分别代表2个索引\n// 索引参数表示从第index个元素开始\nvar arr = [1, 2, 3];\nvar sum = arr.reduce(function(x, y) {\n    return x + y;\n}, 0);\nconsole.log(sum);  // 6  1+2返回3 3+3 返回6\n\nvar arr = [3, 9, 6];\nvar max = arr.reduce(function(x, y) {\n    console.log(x + &apos;|&apos; + y);\n    return x &gt; y ? x : y;\n});\n// 3|9\n// 9|6\nconsole.log(max);  // 9\n\nvar max = arr.reduceRight(function(x, y) {\n    console.log(x + &apos;|&apos; + y);\n    return x &gt; y ? x : y;\n});\n// 6|9\n// 9|3\nconsole.log(max);  // 9</code></pre><p>Array.prototype.indexOf(value, index) Array.prototype.lastIndexOf(value, index)</p>\n<pre><code>// Array.prototype.indexOf(value, index) Array.prototype.lastIndexOf(value, index)数字检索方法\n// value参数表示要查找的元素值，index表示从第几个索引位置开始查找(闭合)\nvar arr = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;b&apos;, &apos;a&apos;];\nconsole.log(arr.indexOf(&apos;b&apos;));  // 1 在数组中查找是否有元素值为&apos;b&apos;，有则返回这个元素索引\nconsole.log(arr.indexOf(&apos;f&apos;));  // -1 如果没有则返回-1\nconsole.log(arr.indexOf(&apos;b&apos;, 1));  // 1 从第2个元素开始查找，返回索引1\nconsole.log(arr.indexOf(&apos;b&apos;, 2));  // 3\nconsole.log(arr.indexOf(&apos;b&apos;, -2));  // 3\nconsole.log(arr.indexOf(&apos;b&apos;, -4));  // 1\nconsole.log(arr.indexOf(&apos;b&apos;, -8));  // 1\nconsole.log(arr.lastIndexOf(&apos;b&apos;));  // 3</code></pre><p>Array.isArray()</p>\n<pre><code>// Array.isArray() 判断是否为数组\nconsole.log(Array.isArray([]));  // true</code></pre><h3 id=\"创建函数\"><a href=\"#创建函数\" class=\"headerlink\" title=\"创建函数\"></a>创建函数</h3><pre><code>// 函数声明\nfunction add(a, b) {\n    a = +a;\n    b = +b;\n    if (isNaN(a) || isNaN(b)) {\n        return;\n    }\n    return a + b;\n}\n\n// 函数表达式\nvar add = function(a, b) {\n    // do sth\n};\n\n// IEF(立即执行函数表达式)\n(function() {\n    // do sth\n})();\n\n// 函数表达式\nreturn function () {\n    // do sth\n};\n\n// NFE(命名式函数表达式)\nvar add = function foo(a, b) {\n    // do sth\n};</code></pre><p><strong>函数声明和函数表达式区别：函数声明会前置</strong></p>\n<pre><code>var num = add(1, 2);\nconsole.log(num);\n\nfunction add(a, b) {\n    a = +a;\n    b = +b;\n    if (isNaN(a) || isNaN(b)) {\n        return;\n    }\n    return a + b;\n}\n\n// 结果为3\n\n\nvar num = add(1, 2);\nconsole.log(num);\n\nvar add = function (a, b) {\n    a = +a;\n    b = +b;\n    if (isNaN(a) || isNaN(b)) {\n        return;\n    }\n    return a + b;\n};\n\n// TypeError: add is not a function</code></pre><h3 id=\"this\"><a href=\"#this\" class=\"headerlink\" title=\"this\"></a>this</h3><p>全局下的this</p>\n<pre><code>// 全局下的this(浏览器下)\nconsole.log(this.window === document);  // true\nconsole.log(this === window);  // true\nthis.a = 37;\nconsole.log(window.a);  // 37</code></pre><p>一般函数的this</p>\n<pre><code>// 一般函数的this（浏览器下）\nfunction f1() {\n    return this;\n}\nf1() === window;  // true\n\nfunction f2() {\n    &quot;use strict&quot;;  // 严格模式下\n    return this\n}\nf2() === undefined;  // true</code></pre><p>作为对象方法的函数的this</p>\n<pre><code>var o = {\n    prop: 37,\n    f: function() {\n        return this.prop;\n    }\n};\nconsole.log(o.f());  // 37\n\nvar o = {prop: 37};\nfunction  independent() {\n    return this.prop;\n}\no.f = independent;\nconsole.log(o.f());  // 37</code></pre><p>原型链上的this</p>\n<pre><code>var o = {\n    f: function() {\n        return this.a + this.b;\n    }\n};\nvar p = Object.create(o); // p为空对象，其原型会指向o\np.a = 1;\np.b = 4;\nconsole.log(p.f())  // 5</code></pre><p>构造器中的this</p>\n<pre><code>// 当new的函数构造器没有return返回值或者返回值不是对象时，new返回一个this指向构造器的prototype这样一个空对象\n// 如果return返回的是对象 new返回的这是这个对象\nfunction Myclass() {\n    this.a = 37;\n}\nvar o = new Myclass();\nconsole.log(o.a);  // 37\n\nfunction C2() {\n    this.a = 37;\n    return {a: 38};\n}\no = new C2();\nconsole.log(o.a);  // 38</code></pre><p>call和apply的this</p>\n<pre><code>function add(c, d) {\n    return this.a + this.b + c + d;\n}\nvar o = {a: 1, b: 2};\nadd.call(o, 5, 6);  // 1+3+5+7=16\nadd.apply(o, [10, 20]);  //1+3+10+20=34\n\nfunction bar() {\n    console.log(Object.prototype.toString.call(this));\n}\nbar.call(7); // [object Number]</code></pre><p>band和this</p>\n<pre><code>//bind是es5后，ie9+使用\nfunction f() {\n    return this.a;\n}\nvar g = f.bind({a: &apos;test&apos;});\nconsole.log(g());  // test\nvar o = {\n    a: 37,\n    f: f,\n    g: g\n};\nconsole.log(o.f(), o.g());  // 37, test</code></pre><p>函数arguments属性</p>\n<pre><code>function foo(x, y, z) {\n    arguments.length;  // 2 实际传入的参数数量\n    arguments[0];  // 1 传入第一个参数值\n    arguments[0] = 10;\n    x;  // 10 将第一个参数值修改为10， 严格模式下任然是1\n    arguments[2] = 100;\n    z; // undefined  由于第三个参数没有传入，不会绑定\n    arguments.callee  === foo;  // true   严格模式下不能使用\n}\n\nfoo(1, 2);\nfoo.length;  // 3   3个参数\nfoo.name;  // &quot;foo&quot; 函数名</code></pre><h3 id=\"call和apply\"><a href=\"#call和apply\" class=\"headerlink\" title=\"call和apply\"></a>call和apply</h3><pre><code>// apply和call方法（浏览器）\n// 第一个参数是作为this的对象，如果不是对象，会转换为对象\n// call传入的是扁平传入参数\n// apply第二个参数树数组\nfunction foo(x, y) {\n    console.log(x, y, this);\n}\n\nfoo.call(100, 1, 2);  // 1, 2, Number(100)\nfoo.apply(true, [3, 4]);  //3, 4, Boolean(true)\nfoo.apply(null);  // undefined, undefined, window\nfoo.apply(undefined);  // undefined, undefined, window</code></pre><h3 id=\"bind\"><a href=\"#bind\" class=\"headerlink\" title=\"bind\"></a>bind</h3><p>bind方法：改变this</p>\n<pre><code>// bind方法\nthis.x = 9;\nvar module = {\n    x: 81,\n    getX: function() {\n        return this.x;\n    }\n};\n\nmodule.getX();  // 81 this指向module\n\nvar getX = module.getX;\ngetX();  // 9 this指向全局变量\n\nvar boundGetX = getX.bind(module);\nboundGetX();  // 81  bind改变this指向</code></pre><p>bind方法：科里化</p>\n<pre><code>// bind方法\nfunction add(a, b, c) {\n    return a+b+c;\n}\n\nvar func = add.bind(undefined, 100);\nfunc(1, 2);  // 103  undefined传给this， 100传给第一个参数a\n\nvar func2 = func.bind(undefined, 200);\nfunc2(10);  // 310 undefined传给this，200传给b</code></pre><p>bind与new</p>\n<pre><code>// bind方法与new\nfunction foo() {\n    this.b = 100;\n    return this.a;\n}\n\nvar func = foo.bind({a: 1});\n\nfunc(); // 1  foo.bind后this指向{a: 1} return this.a = 1\nnew func();  // {b: 100} new调用将返回一个this，this会被初始化一个空对象，并且其原型是foo.prototype,空对象的b属性为100</code></pre><h3 id=\"闭包\"><a href=\"#闭包\" class=\"headerlink\" title=\"闭包\"></a>闭包</h3><p>闭包基本概念</p>\n<pre><code>// 闭包\nvar n = 999;\nfunction f1() {\n    console.log(n);\n}\nf1();  // 999  函数内部可以访问全局变量\n\nfunction f1() {\n    var n = 999;\n}\nconsole.log(n);  // error  函数外部无法访问函数内部局部变量\n\nfunction f1() {\n    n = 999;\n}\nconsole.log(n); // 999 因为没有使用var语句，相当于定义一个全局变量\n\n\n// 简单的闭包原型\nfunction f1() {\n    var n = 999;\n    function f2() {\n        console.log(n);\n    }\n    return f2\n}\nvar result = f1();\nresult();  // 999</code></pre><p>闭包案例</p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=&quot;en&quot;&gt;\n&lt;head&gt;\n    &lt;meta charset=&quot;UTF-8&quot;&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    &lt;style&gt;\n        #div1 {\n            background-color: rosybrown;\n        }\n        #div2 {\n            background-color: aquamarine;\n        }\n        #div3 {\n            background-color: yellowgreen;\n        }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;/body&gt;\n&lt;script&gt;\n    document.body.innerHTML = &apos;&lt;div id=&quot;div1&quot;&gt;aaa&lt;/div&gt;&lt;div id=&quot;div2&quot;&gt;bbb&lt;/div&gt;&lt;div id=&quot;div3&quot;&gt;ccc&lt;/div&gt;&apos;;\n    for(var i = 1; i &lt; 4; i++) {\n        alert(i);  // 结果为1，2，3\n        document.getElementById(&apos;div&apos; + i).\n                addEventListener(&apos;click&apos;, function() {\n            alert(i);  // 点击div1，div2，div3结果都是4,因为addEventListener的回调函数执行时i都为4\n        });\n    }\n&lt;/script&gt;\n&lt;/html&gt;</code></pre><p>正确写法</p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=&quot;en&quot;&gt;\n&lt;head&gt;\n    &lt;meta charset=&quot;UTF-8&quot;&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    &lt;style&gt;\n        #div1 {\n            background-color: rosybrown;\n        }\n        #div2 {\n            background-color: aquamarine;\n        }\n        #div3 {\n            background-color: yellowgreen;\n        }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;/body&gt;\n&lt;script&gt;\n    document.body.innerHTML = &apos;&lt;div id=&quot;div1&quot;&gt;aaa&lt;/div&gt;&lt;div id=&quot;div2&quot;&gt;bbb&lt;/div&gt;&lt;div id=&quot;div3&quot;&gt;ccc&lt;/div&gt;&apos;;\n    for(var i = 1; i &lt; 4; i++) {\n        !function(i) {\n            alert(i);  // 1,2,3\n            document.getElementById(&apos;div&apos; + i).\n               addEventListener(&apos;click&apos;, function() {\n                   alert(i);  // 1, 2,3 \n            });\n        }(i);\n    }\n&lt;/script&gt;\n&lt;/html&gt;</code></pre><p>闭包中的封装</p>\n<pre><code>(function() {\n    var _userID = 23245;\n    var _typeID = &apos;item&apos;;\n    var exportID = {};\n\n    function converter(userID) {\n        return +userID;\n    }\n\n    exportID.getUserID = function() {\n        return converter(_userID);\n    };\n\n    exportID.getTypeID = function() {\n        return _typeID;\n    };\n    global.exportID = exportID;\n}());\n\nconsole.log(exportID.getUserID());  //23245\nconsole.log(exportID._userID);  // undefined</code></pre><h3 id=\"三种作用域\"><a href=\"#三种作用域\" class=\"headerlink\" title=\"三种作用域\"></a>三种作用域</h3><pre><code>// 作用域： 全局作用域，函数作用域，eval作用域\nvar a = 10;\n(function() {\n    var b = 20;\n})();\nconsole.log(a);  // 10\nconsole.log(b);  // error\n\nfor(var item in {a: 1, b: 2}) {\n    console.log(item);  // a, b\n}\nconsole.log(item); // b</code></pre><h3 id=\"ES3中的执行上下文\"><a href=\"#ES3中的执行上下文\" class=\"headerlink\" title=\"ES3中的执行上下文\"></a>ES3中的执行上下文</h3><p>EC = Execution Context 执行上下文<br>变量对象（Variable Object 简写VO）是一个抽象概念，用于存储执行上下文中的变量，函数声明，函数参数</p>\n<pre><code>var a = 10;\nfunction test(x) {\n    var b = 20;\n}\ntest(30);</code></pre><p>对应的上下文</p>\n<pre><code>// 整个js环境中的VO\nVO(globalContext) = {\n    a: 10,\n    test: &lt;ref to function&gt;\n};\n// 执行test(30)的VO\nVO(test functionContext) = {\n    x: 30,\n    b: 20\n};</code></pre><p>全局执行上下文</p>\n<pre><code>VO(globalContext) === [[global]]\n[[global]] = {\n    Math : &lt;...&gt;,\n    String : &lt;...&gt;,\n    isNaN: function() {[Native Code]},\n    ...\n    ...\n    window: global\n};\n\nString(10);  //[[global]].String(10)\nwindow.a = 10;  // [[global]].window.a = 10\nthis.b = 20;  // [[global]].b = 20</code></pre><p>变量初始化阶段</p>\n<pre><code>// 1, 函数参数（若没有传入，则其值为undefined）\n// 2, 函数声明（若函数声明和函数参数冲突，则函数声明会覆盖掉函数参数）\n// 3，变量声明（初始化变量值为undefined，若何函数参数，函数声明冲突，会被忽略掉）\nfunction test(a, b) {\n    var c = 10;\n    function d() {}\n    var e = function _e() {};\n    (function x() {});\n    b = 20;\n}\ntest(10);\n\n\nAO(test) = {\n    a: 10,\n    b: undefined,\n    c: undefined,\n    d: &lt;ref to func &apos;d&apos;&gt;,\n    e: undefined,\n};</code></pre><p>变量初始化案例1</p>\n<pre><code>function foo(x, y, z) {\n    function x() {}\n    console.log(x);\n}\n\nfoo(100);  // [Function: x]\n//\nAO(foo) = {\n    //x: 100,\n    y: undefined,\n    z: undefined,\n    x: &lt;ref to func &apos;x&apos;&gt;,  // 函数声明x会覆盖掉参数声明 \n}</code></pre><p>变量初始化案例2</p>\n<pre><code>function foo(x, y, z) {\n    function func() {}\n    var func;\n    console.log(func);\n}\nfoo(100);  // [Function: func]\n\nfunction foo(x, y, z) {\n    function func() {}\n    var func = 1;\n    console.log(func);\n}\nfoo(100);  // 1  执行阶段会执行func = 1 这个语句</code></pre><p>代码执行阶段</p>\n<pre><code>function test(a, b) {\n    var c = 10;\n    function d() {}\n    var e = function _e() {};\n    (function x() {})();\n    b = 20;\n}\n\n// 初始化阶段\nAO(test) = {\n    a: 10,\n    b: undefined,\n    c: undefined,\n    d: &lt;ref to func &apos;d&apos;&gt;,\n    e: undefined\n};\n// 代码执行阶段\nAO(test) = {\n    a: 10,\n    b: 20,\n    c: 10,\n    d: &lt;reference to FunctionDeclaration &apos;d&apos;&gt;,\n    e: function _e()\n};</code></pre><p>全局执行上下文案例</p>\n<pre><code>console.log(x);  // [Function: x]\nvar x = 10;  // 初始化阶段x: 冲突，被忽略\nconsole.log(x);  // 10\nx = 20;\nfunction x() {}  // 初始化阶段x: &lt;ref to func &apos;x&apos;&gt;\nconsole.log(x);  // 20\nif (true) {\n    var a = 1;  // 初始化阶段a: undefined\n} else {\n    var b = true;  // 初始化阶段b: undefined\n}\n\nconsole.log(a);  // 1\nconsole.log(b);  // undefined</code></pre><h3 id=\"prototype\"><a href=\"#prototype\" class=\"headerlink\" title=\"prototype\"></a>prototype</h3><p>prototype是函数对象上的预设的对象属性<br>原型是对象上的原型，通常都是构造器的prototype属性<br>实例</p>\n<pre><code>function Abc() {\n    this.y = 2;\n    var z = 3;\n}\nconsole.log(Abc);  // [Function: Abc]\nconsole.log(Abc.prototype);  // Abc {}\nconsole.log(typeof Abc.prototype);  // object\n\nAbc.prototype.x = 1;\nconsole.log(Abc.prototype);  // Abc { x: 1 }\n\nvar obj1 = new Abc();\nconsole.log(obj1.__proto__);  // Abc { x: 1 }\nconsole.log(obj1.__proto__ === Abc.prototype);  // true  new构造器创建的对象的原型是构造器的prototype属性\nconsole.log(obj1);  // Abc { y: 2 }\nconsole.log(obj1.y);  // 2\nconsole.log(obj1.x);  // 1</code></pre><h3 id=\"继承\"><a href=\"#继承\" class=\"headerlink\" title=\"继承\"></a>继承</h3><p>实现继承的方法</p>\n<pre><code>// 实现继承的方法\nfunction Person() {\n}\n\nfunction Student() {\n}\n\nStudent.prototype = Person.prototype;  // 错误，会影响被继承类的方法\nStudent.prototype = new Person();  // 错误，传参问题，因为Student是类，并不是实例\n\n// 正确的方法\nStudent.prototype = Object.create(Person.prototype);\nStudent.prototype.constructor = Student;\n// Object.create()是es5的方法，下面是fix方法\nif(!Object.create) {\n    Object.create = function(proto) {\n        function F() {}\n        F.prototype = proto;\n        return new F;\n    };\n}</code></pre><p>原型的继承方法</p>\n<pre><code>function Person(name, age) {\n    this.name = name;\n    this.age = age;\n    this.sayNo = function() {\n        console.log(this.name + &apos; say no&apos;);\n    }\n}\n\nPerson.prototype.hi = function() {\n    console.log(&apos;Hi, my name is &apos; + this.name + &apos;,I\\&apos;m &apos; + this.age + &apos; years old now&apos;);\n};\nPerson.prototype.LEGS_NUM = 2;\nPerson.prototype.ARMS_NUM = 2;\nPerson.prototype.walk = function() {\n    console.log(this.name + &apos; is walking...&apos;);\n};\n\nconsole.log(Person);  // [Function: Person]\nconsole.log(Person.prototype);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }\nvar Jack = new Person();  // Person构造器没有return对象，所以返回的是this\nJack.sayNo();  // undefined say no\nJack.hi();  // Hi, my name is undefined,I&apos;m undefined years old now\nJack.walk();  // undefined is walking...\nconsole.log(Jack);  // Person { name: undefined, age: undefined, sayNo: [Function] }\nconsole.log(Jack.__proto__);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }\n\n// 以下5行代码是js中对象继承的写法\nfunction Student(name, age, className) {\n    Person.call(this, name, age);  // 使用call方法调用父构造器函数\n    this.className = className;\n}\nStudent.prototype = Object.create(Person.prototype);   // 这个如果直接使用Student.prototype = Person.prototype，改变Student对象方法会改变Person对象的方法，因为他们指向的是同一个对象\nStudent.prototype.constructor = Student;\n\nStudent.prototype.hi = function() {\n    console.log(&apos;Hi, my name is &apos; + this.name + &apos;, I\\&apos;m&apos; + this.age + &apos; years old now, and from &apos; + this.className + &apos;.&apos;);\n};\nStudent.prototype.learn = function(subject) {\n    console.log(this.name + &apos; is learning &apos; + subject + &apos; at &apos; + this.className + &apos;.&apos;);\n};\n\nvar Lussi = new Student(&apos;Lussi&apos;, 27, &apos;Class Tree&apos;);\nLussi.sayNo();  // Lussi say no\nLussi.hi();  // Hi, my name is Lussi, I&apos;m27 years old now, and from Class Tree.\nLussi.walk();  // Lussi is walking...\nLussi.learn(&apos;math&apos;);  // Lussi is learning math at Class Tree.\nconsole.log(Lussi);  // Student {name: &apos;Lussi&apos;, age: 27, sayNo: [Function], className: &apos;Class Tree&apos; }\nconsole.log(Lussi.__proto__);  // Student {constructor: [Function: Student], hi: [Function], learn: [Function] }\nconsole.log(Lussi.__proto__.__proto__);  // Person { hi: [Function], LEGS_NUM: 2, ARMS_NUM: 2, walk: [Function] }\nconsole.log(Lussi.__proto__.__proto__.__proto__);  // {}\nconsole.log(Lussi.__proto__.__proto__.__proto__.__proto__);  // null  \n// 改变prototype\nStudent.prototype.x = 101;  // 会影响已经创建实例的属性\nconsole.log(Jack.x);  // undefined\nconsole.log(Lussi.x);  // 101\n\nStudent.prototype = {y: 2};  // 不会影响已经创建实例的属性，但会影响新创建的实例，并且重新修改prototype.y属性也不会改变\nconsole.log(Jack.y); // undefined\nconsole.log(Lussi.y);  // undefined\nvar Lilei = new Student(&apos;Lilei&apos;, 24, &apos;Class three&apos;);\nconsole.log(Lilei.x);  // undefined\nconsole.log(Lilei.y);  // 2\nStudent.prototype.y = 100;\nconsole.log(Lilei.y);  // 100\nconsole.log(Lussi.y);  // undefined\nStudent.prototype.z = 30;\nconsole.log(Lilei.z);  // 30\nconsole.log(Lussi.z);  // undefined\nPerson.prototype.z = 40;\nconsole.log(Lilei.z);  // 30\nconsole.log(Lussi.z);  // 40\nconsole.log(Jack.z);  // 40</code></pre><h3 id=\"instanceof\"><a href=\"#instanceof\" class=\"headerlink\" title=\"instanceof\"></a>instanceof</h3><pre><code>// instanceof  左边是对象（如果不是，直接返回false），右边是构造器（如果不是，直接报错），判断构造器的prototype属性是否在对象的原型链上\nconsole.log([1, 2] instanceof Array);  // true\nconsole.log(1 instanceof Array);  // false\nconsole.log(Array.prototype);  // []\nconsole.log(new Object() instanceof Array);  //false\nconsole.log(Object.prototype);  // {}\nconsole.log(new Object() instanceof Object);  // true\nconsole.log(new Array() instanceof Object);  // true</code></pre><h3 id=\"模拟重载\"><a href=\"#模拟重载\" class=\"headerlink\" title=\"模拟重载\"></a>模拟重载</h3><pre><code>function Person() {\n    var args = arguments;\n    // 判断第一个传入的是不是对象，因为args[null]也返回object，所有需要判断是否为null\n    if(typeof args[0] === &apos;object&apos; &amp;&amp; args[0]) {\n        if(args[0].name) {\n            this.name = args[0].name;\n        }\n        if(args[0].age) {\n            this.age = args[0].age;\n        }\n    } else {\n        if(args[0]) {\n            this.name = args[0];\n        }\n        if(args[1]) {\n            this.age = args[1];\n        }\n    }\n}\nPerson.prototype.toString = function() {\n    console.log(&apos;name=&apos; + this.name + &apos;, age=&apos; + this.age);\n};\n\nvar LiLei = new Person(&apos;LiLei&apos;, 23);\nvar Hanmm = new Person({name: &apos;Hanmm&apos;, age: 21});\nLiLei.toString();  // name=LiLei, age=23\nHanmm.toString();  // name=Hanmm, age=21</code></pre><h3 id=\"调用子类方法\"><a href=\"#调用子类方法\" class=\"headerlink\" title=\"调用子类方法\"></a>调用子类方法</h3><pre><code>function Person(name) {\n    this.name = name;\n}\nfunction Student(name, className) {\n    this.className = className;\n    Person.call(this, name);\n}\n\nPerson.prototype.init = function() {\n    console.log(&apos;Person.init&apos;);\n};\nStudent.prototype.init = function() {\n    console.log(&apos;Student.init&apos;);\n    Person.prototype.init.apply(this, arguments);\n};\nvar LiLei = new Student(&apos;LiLei&apos;, &apos;Class four&apos;);\nconsole.log(LiLei);  // Student { className: &apos;Class four&apos;, name: &apos;LiLei&apos; }\nLiLei.init();  // Student.init  Person.init</code></pre><h3 id=\"实现链式调用\"><a href=\"#实现链式调用\" class=\"headerlink\" title=\"实现链式调用\"></a>实现链式调用</h3><pre><code>function ClassManager() {\n    console.log(&apos;ClassManager&apos;);\n    this.name = &apos;ClassName&apos;;\n}\nClassManager.prototype.addClass = function(str) {\n    console.log(&apos;class: &apos;  + str + &apos; added.&apos;);\n    console.log(this);\n    return this;  // this始终指向ClassManger类的实例\n};\n\nvar manager = new ClassManager();\nmanager.addClass(&apos;A&apos;).addClass(&apos;B&apos;).addClass(&apos;C&apos;);  //class: A added. ClassManager { name: &apos;ClassName&apos; } class: B added. ClassManager { name: &apos;ClassName&apos; } class: C added. ClassManager { name: &apos;ClassName&apos; }</code></pre>"}],"PostAsset":[],"PostCategory":[{"post_id":"cjyu0a5ka00009ka464ljlves","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5kh00039ka4jpb6d4ve"},{"post_id":"cjyu0a5nj00099ka4bp8qf9ch","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5nn000f9ka44ngus14z"},{"post_id":"cjyu0a5ng00049ka46t65trof","category_id":"cjyu0a5ni00079ka4u6dmcnzc","_id":"cjyu0a5np000i9ka4nv1ytv81"},{"post_id":"cjyu0a5nk000a9ka4f622z4yq","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5nq000k9ka4sxdo0sjy"},{"post_id":"cjyu0a5nl000c9ka4abm2fh7s","category_id":"cjyu0a5ni00079ka4u6dmcnzc","_id":"cjyu0a5ns000o9ka4e19ugv15"},{"post_id":"cjyu0a5np000h9ka43sxldmwd","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5ns000q9ka4xqwccmer"},{"post_id":"cjyu0a5nh00069ka4f1xbg3w4","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5nu000v9ka40932jfcf"},{"post_id":"cjyu0a5nh00069ka4f1xbg3w4","category_id":"cjyu0a5nr000l9ka4stwlki2q","_id":"cjyu0a5nw000z9ka4ar2c1rl5"},{"post_id":"cjyu0a5nt000t9ka46swqv94t","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5nw00129ka4grki66f1"},{"post_id":"cjyu0a5nn000e9ka4gejrwyys","category_id":"cjyu0a5nt000r9ka4xc4zkk00","_id":"cjyu0a5nx00169ka4zauazahj"},{"post_id":"cjyu0a5ni00089ka47d7ujt7z","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5ny001a9ka4sfs24209"},{"post_id":"cjyu0a5ni00089ka47d7ujt7z","category_id":"cjyu0a5nr000l9ka4stwlki2q","_id":"cjyu0a5nz001e9ka4ejvj2928"},{"post_id":"cjyu0a5nz001b9ka4h5wc20x8","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5o2001j9ka40isay6av"},{"post_id":"cjyu0a5nz001f9ka4164hzrlu","category_id":"cjyu0a5ni00079ka4u6dmcnzc","_id":"cjyu0a5o3001n9ka41a7iikul"},{"post_id":"cjyu0a5o0001h9ka4kvfhq2zm","category_id":"cjyu0a5nt000r9ka4xc4zkk00","_id":"cjyu0a5o4001q9ka4sde1n5sh"},{"post_id":"cjyu0a5o1001i9ka43srn5zt6","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5o5001t9ka4n10wfjcn"},{"post_id":"cjyu0a5o2001m9ka46hwrdc2s","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5o6001w9ka4gay8cgcz"},{"post_id":"cjyu0a5o5001r9ka4uvk9xe6p","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5o800209ka4jw47vzqa"},{"post_id":"cjyu0a5o6001v9ka4rud5frx1","category_id":"cjyu0a5ni00079ka4u6dmcnzc","_id":"cjyu0a5o900239ka4yvkas5gb"},{"post_id":"cjyu0a5o7001x9ka4igwl8sji","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5oa00259ka472xa5r3y"},{"post_id":"cjyu0a5o8001z9ka4wz0goqmq","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5ob00289ka45d6ii097"},{"post_id":"cjyu0a5o8001z9ka4wz0goqmq","category_id":"cjyu0a5nr000l9ka4stwlki2q","_id":"cjyu0a5oc002c9ka45kdpjdym"},{"post_id":"cjyu0a5o800229ka4dvh06dpg","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5oc002e9ka4xjva6gwk"},{"post_id":"cjyu0a5oa00279ka4n1mxjwtl","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5od002h9ka4b9d1a76c"},{"post_id":"cjyu0a5oa00279ka4n1mxjwtl","category_id":"cjyu0a5nr000l9ka4stwlki2q","_id":"cjyu0a5oe002k9ka4pj8rpsr7"},{"post_id":"cjyu0a5ob002b9ka4jt4mvchv","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5of002o9ka4oewuw00k"},{"post_id":"cjyu0a5oc002d9ka4ub8hgbk9","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5of002r9ka45ejrclv1"},{"post_id":"cjyu0a5oc002d9ka4ub8hgbk9","category_id":"cjyu0a5nr000l9ka4stwlki2q","_id":"cjyu0a5og002v9ka4ln05280o"},{"post_id":"cjyu0a5oc002f9ka4cc1mp0kf","category_id":"cjyu0a5nt000r9ka4xc4zkk00","_id":"cjyu0a5oh002y9ka43rlfr5hk"},{"post_id":"cjyu0a5od002j9ka4g9x9hjzw","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5oi00329ka4nubb40li"},{"post_id":"cjyu0a5of002q9ka45h3lo960","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5oj00359ka4jdmzddam"},{"post_id":"cjyu0a5oh002x9ka4e7hg8gnd","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5ok00389ka4hszancrr"},{"post_id":"cjyu0a5oe002m9ka4tmnb38wv","category_id":"cjyu0a5nt000r9ka4xc4zkk00","_id":"cjyu0a5ol003b9ka4ieao5kph"},{"post_id":"cjyu0a5oe002m9ka4tmnb38wv","category_id":"cjyu0a5og002u9ka4yh6avggh","_id":"cjyu0a5om003f9ka4in0e1qsb"},{"post_id":"cjyu0a5oh00309ka4i24htfsd","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5om003h9ka4fg97aj4z"},{"post_id":"cjyu0a5oi00349ka4dip2p8c1","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5on003j9ka4j5a5ldwf"},{"post_id":"cjyu0a5oj00379ka4jc79sz30","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5op003m9ka4fhdccf7c"},{"post_id":"cjyu0a5ok003a9ka4l4xd80od","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5oq003p9ka4ac9bdg6w"},{"post_id":"cjyu0a5ol003e9ka42oj83xxs","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5oq003r9ka4fxjeomnk"},{"post_id":"cjyu0a5og002t9ka4sp1rcwn4","category_id":"cjyu0a5nt000r9ka4xc4zkk00","_id":"cjyu0a5or003t9ka49z35ylpp"},{"post_id":"cjyu0a5og002t9ka4sp1rcwn4","category_id":"cjyu0a5oi00319ka4m7ahchpb","_id":"cjyu0a5os003w9ka45d4y6c0z"},{"post_id":"cjyu0a5og002t9ka4sp1rcwn4","category_id":"cjyu0a5ol003c9ka4jx12709b","_id":"cjyu0a5ot003x9ka4062j9syl"},{"post_id":"cjyu0a5om003g9ka4k4e292ff","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5ot003z9ka490gj86ep"},{"post_id":"cjyu0a5om003i9ka4n6n5ykwa","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5ou00419ka4wsobq3ck"},{"post_id":"cjyu0a5oo003l9ka45vuvlkxt","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5ou00429ka490sexnr7"},{"post_id":"cjyu0a5op003o9ka4zma2xrav","category_id":"cjyu0a5ni00079ka4u6dmcnzc","_id":"cjyu0a5ou00439ka425l7o5u7"},{"post_id":"cjyu0a5oq003q9ka4188vcr41","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5ou00449ka4g52gu9es"},{"post_id":"cjyu0a5oq003q9ka4188vcr41","category_id":"cjyu0a5nr000l9ka4stwlki2q","_id":"cjyu0a5ou00459ka4gkqvv3cs"},{"post_id":"cjyu0a5oq003s9ka4yfc07ecd","category_id":"cjyu0a5nt000r9ka4xc4zkk00","_id":"cjyu0a5ou00469ka4mjo8t16p"},{"post_id":"cjyu0a5oq003s9ka4yfc07ecd","category_id":"cjyu0a5og002u9ka4yh6avggh","_id":"cjyu0a5ou00479ka4eva87eas"},{"post_id":"cjyu0a5or003v9ka43py7h2e0","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5ou00489ka48f5od38a"},{"post_id":"cjyu0a5pv004a9ka4odap3sia","category_id":"cjyu0a5nt000r9ka4xc4zkk00","_id":"cjyu0a5py004h9ka4hp7dibpu"},{"post_id":"cjyu0a5pv004a9ka4odap3sia","category_id":"cjyu0a5og002u9ka4yh6avggh","_id":"cjyu0a5pz004k9ka458aejc7w"},{"post_id":"cjyu0a5pw004c9ka4iovf3h9n","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5q0004o9ka4jfc1cazc"},{"post_id":"cjyu0a5px004e9ka46n45qwdg","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5q0004r9ka4q92dnjj6"},{"post_id":"cjyu0a5py004g9ka47srf7u61","category_id":"cjyu0a5nt000r9ka4xc4zkk00","_id":"cjyu0a5q1004u9ka4o4uh5nk8"},{"post_id":"cjyu0a5py004g9ka47srf7u61","category_id":"cjyu0a5og002u9ka4yh6avggh","_id":"cjyu0a5q1004w9ka4jmaxhthm"},{"post_id":"cjyu0a5py004j9ka4kigurotu","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5q1004y9ka4k3x16d38"},{"post_id":"cjyu0a5pz004n9ka4y866c03x","category_id":"cjyu0a5nt000r9ka4xc4zkk00","_id":"cjyu0a5q200509ka4ly5b7nxb"},{"post_id":"cjyu0a5q0004q9ka4rtmyky6c","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5q200519ka49rhod1n5"},{"post_id":"cjyu0a5q0004q9ka4rtmyky6c","category_id":"cjyu0a5nr000l9ka4stwlki2q","_id":"cjyu0a5q200529ka4734cjjmv"},{"post_id":"cjyu0a5qa00539ka401o66dzi","category_id":"cjyu0a5kf00029ka47jhjkat6","_id":"cjyu0a5qb00559ka4joavvcpv"},{"post_id":"cjyu0a5sg00569ka4fdd8npwo","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5si00599ka40j5khedw"},{"post_id":"cjyu0a5so005a9ka4oiu49t54","category_id":"cjyu0a5nl000b9ka4hsx99jmk","_id":"cjyu0a5so005c9ka47gmvmrkf"},{"post_id":"cjyu0a5sq005d9ka4ivmpr16b","category_id":"cjyu0a5ni00079ka4u6dmcnzc","_id":"cjyu0a5sr005f9ka4025ghzp9"}],"PostTag":[{"post_id":"cjyu0a5nk000a9ka4f622z4yq","tag_id":"cjyu0a5nm000d9ka4wpzcddyp","_id":"cjyu0a5nr000m9ka4a3lxk4kb"},{"post_id":"cjyu0a5nr000n9ka4onnuduk5","tag_id":"cjyu0a5nt000s9ka4ncox7sad","_id":"cjyu0a5nw00109ka4j5oea2et"},{"post_id":"cjyu0a5nu000x9ka4zt2u7xxo","tag_id":"cjyu0a5nt000s9ka4ncox7sad","_id":"cjyu0a5nx00139ka4b3318og0"},{"post_id":"cjyu0a5nw00119ka49hazqune","tag_id":"cjyu0a5nt000s9ka4ncox7sad","_id":"cjyu0a5ny00179ka49jgkop2m"},{"post_id":"cjyu0a5ns000p9ka4khr05zgg","tag_id":"cjyu0a5nt000s9ka4ncox7sad","_id":"cjyu0a5ny00199ka4nurmobal"},{"post_id":"cjyu0a5nx00149ka4g5i8hyvx","tag_id":"cjyu0a5nt000s9ka4ncox7sad","_id":"cjyu0a5nz001d9ka4t7vzuta0"},{"post_id":"cjyu0a5ny00189ka495a63ohv","tag_id":"cjyu0a5nt000s9ka4ncox7sad","_id":"cjyu0a5o0001g9ka486kesnpv"},{"post_id":"cjyu0a5nt000t9ka46swqv94t","tag_id":"cjyu0a5nx00159ka4uxphlt1m","_id":"cjyu0a5o2001k9ka4ohk6dj2o"},{"post_id":"cjyu0a5nt000t9ka46swqv94t","tag_id":"cjyu0a5nz001c9ka48szalmdn","_id":"cjyu0a5o3001o9ka4hgcg23u0"},{"post_id":"cjyu0a5o0001h9ka4kvfhq2zm","tag_id":"cjyu0a5o2001l9ka4k76zyp2a","_id":"cjyu0a5o6001u9ka4z6mipc0g"},{"post_id":"cjyu0a5o2001m9ka46hwrdc2s","tag_id":"cjyu0a5o5001s9ka4fl7tqm3x","_id":"cjyu0a5o800219ka4bzs5qb88"},{"post_id":"cjyu0a5o800229ka4dvh06dpg","tag_id":"cjyu0a5nz001c9ka48szalmdn","_id":"cjyu0a5oa00269ka4p0uwy0f5"},{"post_id":"cjyu0a5o6001v9ka4rud5frx1","tag_id":"cjyu0a5o7001y9ka4z42s1ttp","_id":"cjyu0a5ob002a9ka417amkngs"},{"post_id":"cjyu0a5o900249ka4v168kr99","tag_id":"cjyu0a5ob00299ka4cz9r8jyj","_id":"cjyu0a5od002i9ka4ejfwld6n"},{"post_id":"cjyu0a5o900249ka4v168kr99","tag_id":"cjyu0a5nm000d9ka4wpzcddyp","_id":"cjyu0a5oe002l9ka4ghrl98nt"},{"post_id":"cjyu0a5oc002f9ka4cc1mp0kf","tag_id":"cjyu0a5o2001l9ka4k76zyp2a","_id":"cjyu0a5of002p9ka4k1az1osf"},{"post_id":"cjyu0a5od002j9ka4g9x9hjzw","tag_id":"cjyu0a5o7001y9ka4z42s1ttp","_id":"cjyu0a5og002s9ka46ez0730n"},{"post_id":"cjyu0a5oe002m9ka4tmnb38wv","tag_id":"cjyu0a5nz001c9ka48szalmdn","_id":"cjyu0a5oh002w9ka4h86k8hv1"},{"post_id":"cjyu0a5of002q9ka45h3lo960","tag_id":"cjyu0a5o5001s9ka4fl7tqm3x","_id":"cjyu0a5oh002z9ka4c4vrto6z"},{"post_id":"cjyu0a5oa00279ka4n1mxjwtl","tag_id":"cjyu0a5od002g9ka43d8x0d9i","_id":"cjyu0a5oi00339ka4oyv5ccd5"},{"post_id":"cjyu0a5oa00279ka4n1mxjwtl","tag_id":"cjyu0a5of002n9ka4uc2eokwz","_id":"cjyu0a5oj00369ka4yysvp7b0"},{"post_id":"cjyu0a5oi00349ka4dip2p8c1","tag_id":"cjyu0a5nz001c9ka48szalmdn","_id":"cjyu0a5ok00399ka4d9jqrfgk"},{"post_id":"cjyu0a5oj00379ka4jc79sz30","tag_id":"cjyu0a5ol003d9ka4ovkjgbga","_id":"cjyu0a5oo003k9ka4aq605s4v"},{"post_id":"cjyu0a5om003i9ka4n6n5ykwa","tag_id":"cjyu0a5ol003d9ka4ovkjgbga","_id":"cjyu0a5op003n9ka407ni5q5q"},{"post_id":"cjyu0a5or003v9ka43py7h2e0","tag_id":"cjyu0a5ol003d9ka4ovkjgbga","_id":"cjyu0a5ot003y9ka48fc9cz6j"},{"post_id":"cjyu0a5oq003q9ka4188vcr41","tag_id":"cjyu0a5or003u9ka4ptqwxjsc","_id":"cjyu0a5ot00409ka43dehfw3d"},{"post_id":"cjyu0a5pv004a9ka4odap3sia","tag_id":"cjyu0a5nz001c9ka48szalmdn","_id":"cjyu0a5px004d9ka456if9xq2"},{"post_id":"cjyu0a5pw004c9ka4iovf3h9n","tag_id":"cjyu0a5nz001c9ka48szalmdn","_id":"cjyu0a5py004f9ka4orhe34y6"},{"post_id":"cjyu0a5px004e9ka46n45qwdg","tag_id":"cjyu0a5ol003d9ka4ovkjgbga","_id":"cjyu0a5py004i9ka44m4l0yl3"},{"post_id":"cjyu0a5pt00499ka4vdcbo0h3","tag_id":"cjyu0a5nm000d9ka4wpzcddyp","_id":"cjyu0a5pz004m9ka427ofsfse"},{"post_id":"cjyu0a5pt00499ka4vdcbo0h3","tag_id":"cjyu0a5pw004b9ka4uodaeejj","_id":"cjyu0a5q0004p9ka4t7ha3blw"},{"post_id":"cjyu0a5pz004n9ka4y866c03x","tag_id":"cjyu0a5ol003d9ka4ovkjgbga","_id":"cjyu0a5q1004s9ka4tuusxfmg"},{"post_id":"cjyu0a5py004g9ka47srf7u61","tag_id":"cjyu0a5nm000d9ka4wpzcddyp","_id":"cjyu0a5q1004v9ka4n9nby1jo"},{"post_id":"cjyu0a5py004g9ka47srf7u61","tag_id":"cjyu0a5pz004l9ka4gcriz407","_id":"cjyu0a5q1004x9ka4xlroj31s"},{"post_id":"cjyu0a5py004j9ka4kigurotu","tag_id":"cjyu0a5pz004l9ka4gcriz407","_id":"cjyu0a5q2004z9ka4rbzfgj1k"},{"post_id":"cjyu0a5qa00539ka401o66dzi","tag_id":"cjyu0a5nm000d9ka4wpzcddyp","_id":"cjyu0a5qb00549ka45fe5wnh8"},{"post_id":"cjyu0a5sg00569ka4fdd8npwo","tag_id":"cjyu0a5nz001c9ka48szalmdn","_id":"cjyu0a5sh00589ka493f18hnt"},{"post_id":"cjyu0a5so005a9ka4oiu49t54","tag_id":"cjyu0a5o7001y9ka4z42s1ttp","_id":"cjyu0a5so005b9ka43xwbgusq"},{"post_id":"cjyu0a5sq005d9ka4ivmpr16b","tag_id":"cjyu0a5sr005e9ka4lmph29i0","_id":"cjyu0a5sr005g9ka437tn9j0s"}],"Tag":[{"name":"linux","_id":"cjyu0a5nm000d9ka4wpzcddyp"},{"name":"ffmpeg","_id":"cjyu0a5nt000s9ka4ncox7sad"},{"name":"django","_id":"cjyu0a5nx00159ka4uxphlt1m"},{"name":"python","_id":"cjyu0a5nz001c9ka48szalmdn"},{"name":"IDE","_id":"cjyu0a5o2001l9ka4k76zyp2a"},{"name":"mysql","_id":"cjyu0a5o5001s9ka4fl7tqm3x"},{"name":"php","_id":"cjyu0a5o7001y9ka4z42s1ttp"},{"name":"manjaro","_id":"cjyu0a5ob00299ka4cz9r8jyj"},{"name":"redis","_id":"cjyu0a5od002g9ka43d8x0d9i"},{"name":"数据库","_id":"cjyu0a5of002n9ka4uc2eokwz"},{"name":"windows","_id":"cjyu0a5ol003d9ka4ovkjgbga"},{"name":"微信","_id":"cjyu0a5or003u9ka4ptqwxjsc"},{"name":"运维","_id":"cjyu0a5pw004b9ka4uodaeejj"},{"name":"ubuntu","_id":"cjyu0a5pz004l9ka4gcriz407"},{"name":"javascript","_id":"cjyu0a5sr005e9ka4lmph29i0"}]}}